cscope 15 $HOME/work/sdk_01/sdk/linux/kernel/linux/drivers/net/ethernet/marvell/octeontx2/af               0001747590
	@cgx.c

8 
	~<löux/a˝i.h
>

9 
	~<löux/moduÀ.h
>

10 
	~<löux/öãºu±.h
>

11 
	~<löux/pci.h
>

12 
	~<löux/√tdevi˚.h
>

13 
	~<löux/ëhîdevi˚.h
>

14 
	~<löux/ëhtoﬁ.h
>

15 
	~<löux/phy.h
>

16 
	~<löux/of.h
>

17 
	~<löux/of_mdio.h
>

18 
	~<löux/of_√t.h
>

20 
	~"cgx.h
"

21 
	~"rvu.h
"

22 
	~"lmac_comm⁄.h
"

24 
	#DRV_NAME
 "M¨vñl-CGX/RPM"

	)

25 
	#DRV_STRING
 "M¨vñ»CGX/RPM Drivî"

	)

27 
	#CGX_RX_STAT_GLOBAL_INDEX
 9

	)

29 
LIST_HEAD
(
cgx_li°
);

32 c⁄° 
u32
 
	gcgx_•ìd_mbps
[
CGX_LINK_SPEED_MAX
] = {

33 [
CGX_LINK_NONE
] = 0,

34 [
CGX_LINK_10M
] = 10,

35 [
CGX_LINK_100M
] = 100,

36 [
CGX_LINK_1G
] = 1000,

37 [
CGX_LINK_2HG
] = 2500,

38 [
CGX_LINK_5G
] = 5000,

39 [
CGX_LINK_10G
] = 10000,

40 [
CGX_LINK_20G
] = 20000,

41 [
CGX_LINK_25G
] = 25000,

42 [
CGX_LINK_40G
] = 40000,

43 [
CGX_LINK_50G
] = 50000,

44 [
CGX_LINK_80G
] = 80000,

45 [
CGX_LINK_100G
] = 100000,

49 c⁄° *
	gcgx_lma˘y≥_°rög
[
LMAC_MODE_MAX
] = {

50 [
LMAC_MODE_SGMII
] = "SGMII",

51 [
LMAC_MODE_XAUI
] = "XAUI",

52 [
LMAC_MODE_RXAUI
] = "RXAUI",

53 [
LMAC_MODE_10G_R
] = "10G_R",

54 [
LMAC_MODE_40G_R
] = "40G_R",

55 [
LMAC_MODE_QSGMII
] = "QSGMII",

56 [
LMAC_MODE_25G_R
] = "25G_R",

57 [
LMAC_MODE_50G_R
] = "50G_R",

58 [
LMAC_MODE_100G_R
] = "100G_R",

59 [
LMAC_MODE_USXGMII
] = "USXGMII",

63 
cgx_fwi_lök_ch™ge
(
cgx
 *cgx, 
lmac_id
, 
boﬁ
 
í
);

66 c⁄° 
pci_devi˚_id
 
	gcgx_id_èbÀ
[] = {

67 { 
PCI_DEVICE
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_OCTEONTX2_CGX
) },

68 { 
PCI_DEVICE
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_CN10K_RPM
) },

69 { 
PCI_DEVICE
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_CN10KB_RPM
) },

73 
MODULE_DEVICE_TABLE
(
pci
, 
cgx_id_èbÀ
);

75 
boﬁ
 
	$is_dev_Ωm
(*
cgxd
)

77 
cgx
 *cgx = 
cgxd
;

79  (
cgx
->
pdev
->
devi˚
 =
PCI_DEVID_CN10K_RPM
) ||

80 (
cgx
->
pdev
->
devi˚
 =
PCI_DEVID_CN10KB_RPM
);

81 
	}
}

83 
boﬁ
 
	$is_lmac_vÆid
(
cgx
 *cgx, 
lmac_id
)

85 i‡(!
cgx
 || 
lmac_id
 < 0 ||Ümac_id >cgx->
max_lmac_≥r_mac
)

86  
Ál£
;

87  
	`ã°_bô
(
lmac_id
, &
cgx
->
lmac_bm≠
);

88 
	}
}

93 
	$gë_£quí˚_id_of_lmac
(
cgx
 *cgx, 
lmac_id
)

95 
tmp
, 
id
 = 0;

97 
	`f‹_óch_£t_bô
(
tmp
, &
cgx
->
lmac_bm≠
, cgx->
max_lmac_≥r_mac
) {

98 i‡(
tmp
 =
lmac_id
)

100 
id
++;

103  
id
;

104 
	}
}

106 
mac_›s
 *
	$gë_mac_›s
(*
cgxd
)

108 i‡(!
cgxd
)

109  
cgxd
;

111  ((
cgx
 *)
cgxd
)->
mac_›s
;

112 
	}
}

114 
	$cgx_wrôe
(
cgx
 *cgx, 
u64
 
lmac
, u64 
off£t
, u64 
vÆ
)

116 
	`wrôeq
(
vÆ
, 
cgx
->
ªg_ba£
 + (
lmac
 << cgx->
mac_›s
->
lmac_off£t
) +

117 
off£t
);

118 
	}
}

120 
u64
 
	$cgx_ªad
(
cgx
 *cgx, 
u64
 
lmac
, u64 
off£t
)

122  
	`ªadq
(
cgx
->
ªg_ba£
 + (
lmac
 << cgx->
mac_›s
->
lmac_off£t
) +

123 
off£t
);

124 
	}
}

126 
lmac
 *
	$lmac_pd©a
(
u8
 
lmac_id
, 
cgx
 *cgx)

128 i‡(!
cgx
 || 
lmac_id
 >cgx->
max_lmac_≥r_mac
)

129  
NULL
;

131  
cgx
->
lmac_idm≠
[
lmac_id
];

132 
	}
}

134 
	$cgx_gë_cgx˙t_max
()

136 
cgx
 *
cgx_dev
;

137 
idmax
 = -
ENODEV
;

139 
	`li°_f‹_óch_íåy
(
cgx_dev
, &
cgx_li°
, cgx_list)

140 i‡(
cgx_dev
->
cgx_id
 > 
idmax
)

141 
idmax
 = 
cgx_dev
->
cgx_id
;

143 i‡(
idmax
 < 0)

146  
idmax
 + 1;

147 
	}
}

149 
	$cgx_gë_lmac_˙t
(*
cgxd
)

151 
cgx
 *cgx = 
cgxd
;

153 i‡(!
cgx
)

154  -
ENODEV
;

156  
cgx
->
lmac_cou¡
;

157 
	}
}

159 *
	$cgx_gë_pd©a
(
cgx_id
)

161 
cgx
 *
cgx_dev
;

163 
	`li°_f‹_óch_íåy
(
cgx_dev
, &
cgx_li°
, cgx_list) {

164 i‡(
cgx_dev
->
cgx_id
 == cgx_id)

165  
cgx_dev
;

167  
NULL
;

168 
	}
}

170 
	$cgx_lmac_wrôe
(
cgx_id
, 
lmac_id
, 
u64
 
off£t
, u64 
vÆ
)

172 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

175 i‡(!
	`is_lmac_vÆid
(
cgx_dev
, 
lmac_id
))

177 
	`cgx_wrôe
(
cgx_dev
, 
lmac_id
, 
off£t
, 
vÆ
);

178 
	}
}

180 
u64
 
	$cgx_lmac_ªad
(
cgx_id
, 
lmac_id
, 
u64
 
off£t
)

182 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

185 i‡(!
	`is_lmac_vÆid
(
cgx_dev
, 
lmac_id
))

187  
	`cgx_ªad
(
cgx_dev
, 
lmac_id
, 
off£t
);

188 
	}
}

190 
	$cgx_gë_cgxid
(*
cgxd
)

192 
cgx
 *cgx = 
cgxd
;

194 i‡(!
cgx
)

195  -
EINVAL
;

197  
cgx
->
cgx_id
;

198 
	}
}

200 
u8
 
	$cgx_lmac_gë_p2x
(
cgx_id
, 
lmac_id
)

202 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

203 
u64
 
cfg
;

205 
cfg
 = 
	`cgx_ªad
(
cgx_dev
, 
lmac_id
, 
CGXX_CMRX_CFG
);

207  (
cfg
 & 
CMR_P2X_SEL_MASK
Ë>> 
CMR_P2X_SEL_SHIFT
;

208 
	}
}

215 
	$cgx_gë_lök_öfo
(*
cgxd
, 
lmac_id
,

216 
cgx_lök_u£r_öfo
 *
löfo
)

218 
lmac
 *lma¯
	`lmac_pd©a
(
lmac_id
, 
cgxd
);

220 i‡(!
lmac
)

221  -
ENODEV
;

223 *
löfo
 = 
lmac
->
lök_öfo
;

225 
	}
}

227 
u64
 
	$mac2u64
 (
u8
 *
mac_addr
)

229 
u64
 
mac
 = 0;

230 
ödex
;

232 
ödex
 = 
ETH_ALEN
 - 1; index >= 0; index--)

233 
mac
 |((
u64
)*
mac_addr
++Ë<< (8 * 
ödex
);

234  
mac
;

235 
	}
}

237 
	$cfg2mac
(
u64
 
cfg
, 
u8
 *
mac_addr
)

239 
i
, 
ödex
 = 0;

241 
i
 = 
ETH_ALEN
 - 1; i >0; i--, 
ödex
++)

242 
mac_addr
[
i
] = (
cfg
 >> (8 * 
ödex
)) & 0xFF;

243 
	}
}

245 
	$cgx_lmac_addr_£t
(
u8
 
cgx_id
, u8 
lmac_id
, u8 *
mac_addr
)

247 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

248 
lmac
 *lma¯
	`lmac_pd©a
(
lmac_id
, 
cgx_dev
);

249 
mac_›s
 *mac_ops;

250 
ödex
, 
id
;

251 
u64
 
cfg
;

253 i‡(!
lmac
)

254  -
ENODEV
;

257 
mac_›s
 = 
cgx_dev
->mac_ops;

262 
cfg
 = 
	`mac2u64
 (
mac_addr
);

264 
id
 = 
	`gë_£quí˚_id_of_lmac
(
cgx_dev
, 
lmac_id
);

266 
ödex
 = 
id
 * 
lmac
->
mac_to_ödex_bm≠
.
max
;

268 
	`cgx_wrôe
(
cgx_dev
, 0, (
CGXX_CMRX_RX_DMAC_CAM0
 + (
ödex
 * 0x8)),

269 
cfg
 | 
CGX_DMAC_CAM_ADDR_ENABLE
 | ((
u64
)
lmac_id
 << 49));

271 
cfg
 = 
	`cgx_ªad
(
cgx_dev
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
);

272 
cfg
 |(
CGX_DMAC_CTL0_CAM_ENABLE
 | 
CGX_DMAC_BCAST_MODE
 |

273 
CGX_DMAC_MCAST_MODE
);

274 
	`cgx_wrôe
(
cgx_dev
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
, 
cfg
);

277 
	}
}

279 
u64
 
	$cgx_ªad_dmac_˘æ
(*
cgxd
, 
lmac_id
)

281 
mac_›s
 *mac_ops;

282 
cgx
 *cgx = 
cgxd
;

284 i‡(!
cgxd
 || !
	`is_lmac_vÆid
(cgxd, 
lmac_id
))

287 
cgx
 = 
cgxd
;

289 
mac_›s
 = 
cgx
->mac_ops;

291  
	`cgx_ªad
(
cgxd
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
);

292 
	}
}

294 
u64
 
	$cgx_ªad_dmac_íåy
(*
cgxd
, 
ödex
)

296 
mac_›s
 *mac_ops;

297 
cgx
 *cgx;

299 i‡(!
cgxd
)

302 
cgx
 = 
cgxd
;

303 
mac_›s
 = 
cgx
->mac_ops;

304  
	`cgx_ªad
(
cgx
, 0, (
CGXX_CMRX_RX_DMAC_CAM0
 + (
ödex
 * 8)));

305 
	}
}

307 
	$cgx_lmac_addr_add
(
u8
 
cgx_id
, u8 
lmac_id
, u8 *
mac_addr
)

309 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

310 
lmac
 *lma¯
	`lmac_pd©a
(
lmac_id
, 
cgx_dev
);

311 
mac_›s
 *mac_ops;

312 
ödex
, 
idx
;

313 
u64
 
cfg
 = 0;

314 
id
;

316 i‡(!
lmac
)

317  -
ENODEV
;

319 
mac_›s
 = 
cgx_dev
->mac_ops;

321 
idx
 = 
	`rvu_Æloc_r§c
(&
lmac
->
mac_to_ödex_bm≠
);

322 i‡(
idx
 < 0)

323  
idx
;

325 
id
 = 
	`gë_£quí˚_id_of_lmac
(
cgx_dev
, 
lmac_id
);

327 
ödex
 = 
id
 * 
lmac
->
mac_to_ödex_bm≠
.
max
 + 
idx
;

329 
cfg
 = 
	`mac2u64
 (
mac_addr
);

330 
cfg
 |
CGX_DMAC_CAM_ADDR_ENABLE
;

331 
cfg
 |((
u64
)
lmac_id
 << 49);

332 
	`cgx_wrôe
(
cgx_dev
, 0, (
CGXX_CMRX_RX_DMAC_CAM0
 + (
ödex
 * 0x8)), 
cfg
);

334 
cfg
 = 
	`cgx_ªad
(
cgx_dev
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
);

335 
cfg
 |(
CGX_DMAC_BCAST_MODE
 | 
CGX_DMAC_CAM_ACCEPT
);

337 i‡(
	`is_mu…iˇ°_ëhî_addr
(
mac_addr
)) {

338 
cfg
 &~
	`GENMASK_ULL
(2, 1);

339 
cfg
 |
CGX_DMAC_MCAST_MODE_CAM
;

340 
lmac
->
mˇ°_fûãrs_cou¡
++;

341 } i‡(!
lmac
->
mˇ°_fûãrs_cou¡
) {

342 
cfg
 |
CGX_DMAC_MCAST_MODE
;

345 
	`cgx_wrôe
(
cgx_dev
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
, 
cfg
);

347  
idx
;

348 
	}
}

349 
EXPORT_SYMBOL
(
cgx_lmac_addr_add
);

351 
	$cgx_lmac_addr_ª£t
(
u8
 
cgx_id
, u8 
lmac_id
)

353 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

354 
lmac
 *lma¯
	`lmac_pd©a
(
lmac_id
, 
cgx_dev
);

355 
mac_›s
 *mac_ops;

356 
u8
 
ödex
 = 0, 
id
;

357 
u64
 
cfg
;

359 i‡(!
lmac
)

360  -
ENODEV
;

362 
mac_›s
 = 
cgx_dev
->mac_ops;

366 
	`£t_bô
(0, 
lmac
->
mac_to_ödex_bm≠
.
bm≠
);

368 
id
 = 
	`gë_£quí˚_id_of_lmac
(
cgx_dev
, 
lmac_id
);

370 
ödex
 = 
id
 * 
lmac
->
mac_to_ödex_bm≠
.
max
 + index;

371 
	`cgx_wrôe
(
cgx_dev
, 0, (
CGXX_CMRX_RX_DMAC_CAM0
 + (
ödex
 * 0x8)), 0);

374 
cfg
 = 
	`cgx_ªad
(
cgx_dev
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
);

375 
cfg
 &~
CGX_DMAC_CAM_ACCEPT
;

376 
cfg
 |(
CGX_DMAC_BCAST_MODE
 | 
CGX_DMAC_MCAST_MODE
);

377 
	`cgx_wrôe
(
cgx_dev
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
, 
cfg
);

380 
	}
}

381 
EXPORT_SYMBOL
(
cgx_lmac_addr_ª£t
);

387 
	$cgx_lmac_addr_upd©e
(
u8
 
cgx_id
, u8 
lmac_id
, u8 *
mac_addr
, u8 
ödex
)

389 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

390 
mac_›s
 *mac_ops;

391 
lmac
 *lmac;

392 
u64
 
cfg
;

393 
id
;

395 
lmac
 = 
	`lmac_pd©a
(
lmac_id
, 
cgx_dev
);

396 i‡(!
lmac
)

397  -
ENODEV
;

399 
mac_›s
 = 
cgx_dev
->mac_ops;

401 i‡(
ödex
 >
lmac
->
mac_to_ödex_bm≠
.
max
)

402  -
EINVAL
;

405 i‡(!
	`ã°_bô
(
ödex
, 
lmac
->
mac_to_ödex_bm≠
.
bm≠
))

406  -
EINVAL
;

408 
id
 = 
	`gë_£quí˚_id_of_lmac
(
cgx_dev
, 
lmac_id
);

410 
ödex
 = 
id
 * 
lmac
->
mac_to_ödex_bm≠
.
max
 + index;

412 
cfg
 = 
	`cgx_ªad
(
cgx_dev
, 0, (
CGXX_CMRX_RX_DMAC_CAM0
 + (
ödex
 * 0x8)));

413 
cfg
 &~
CGX_RX_DMAC_ADR_MASK
;

414 
cfg
 |
	`mac2u64
 (
mac_addr
);

416 
	`cgx_wrôe
(
cgx_dev
, 0, (
CGXX_CMRX_RX_DMAC_CAM0
 + (
ödex
 * 0x8)), 
cfg
);

418 
	}
}

420 
	$cgx_lmac_addr_dñ
(
u8
 
cgx_id
, u8 
lmac_id
, u8 
ödex
)

422 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

423 
lmac
 *lma¯
	`lmac_pd©a
(
lmac_id
, 
cgx_dev
);

424 
mac_›s
 *mac_ops;

425 
u8
 
mac
[
ETH_ALEN
];

426 
u64
 
cfg
;

427 
id
;

429 i‡(!
lmac
)

430  -
ENODEV
;

432 
mac_›s
 = 
cgx_dev
->mac_ops;

434 i‡(
ödex
 >
lmac
->
mac_to_ödex_bm≠
.
max
)

435  -
EINVAL
;

438 i‡(
ödex
 == 0)

441 
	`rvu_‰ì_r§c
(&
lmac
->
mac_to_ödex_bm≠
, 
ödex
);

443 
id
 = 
	`gë_£quí˚_id_of_lmac
(
cgx_dev
, 
lmac_id
);

445 
ödex
 = 
id
 * 
lmac
->
mac_to_ödex_bm≠
.
max
 + index;

448 
cfg
 = 
	`cgx_ªad
(
cgx_dev
, 0, (
CGXX_CMRX_RX_DMAC_CAM0
 + (
ödex
 * 0x8)));

450 
	`cfg2mac
(
cfg
, 
mac
);

451 i‡(
	`is_mu…iˇ°_ëhî_addr
(
mac
))

452 
lmac
->
mˇ°_fûãrs_cou¡
--;

454 i‡(!
lmac
->
mˇ°_fûãrs_cou¡
) {

455 
cfg
 = 
	`cgx_ªad
(
cgx_dev
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
);

456 
cfg
 &~
	`GENMASK_ULL
(2, 1);

457 
cfg
 |
CGX_DMAC_MCAST_MODE
;

458 
	`cgx_wrôe
(
cgx_dev
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
, 
cfg
);

461 
	`cgx_wrôe
(
cgx_dev
, 0, (
CGXX_CMRX_RX_DMAC_CAM0
 + (
ödex
 * 0x8)), 0);

464 
	}
}

465 
EXPORT_SYMBOL
(
cgx_lmac_addr_dñ
);

467 
	$cgx_lmac_addr_max_íåõs_gë
(
u8
 
cgx_id
, u8 
lmac_id
)

469 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

470 
lmac
 *lma¯
	`lmac_pd©a
(
lmac_id
, 
cgx_dev
);

472 i‡(
lmac
)

473  
lmac
->
mac_to_ödex_bm≠
.
max
;

476 
	}
}

477 
EXPORT_SYMBOL
(
cgx_lmac_addr_max_íåõs_gë
);

479 
u64
 
	$cgx_lmac_addr_gë
(
u8
 
cgx_id
, u8 
lmac_id
)

481 
cgx
 *
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

482 
lmac
 *lma¯
	`lmac_pd©a
(
lmac_id
, 
cgx_dev
);

483 
mac_›s
 *mac_ops;

484 
ödex
;

485 
u64
 
cfg
;

486 
id
;

488 
mac_›s
 = 
cgx_dev
->mac_ops;

490 
id
 = 
	`gë_£quí˚_id_of_lmac
(
cgx_dev
, 
lmac_id
);

492 
ödex
 = 
id
 * 
lmac
->
mac_to_ödex_bm≠
.
max
;

494 
cfg
 = 
	`cgx_ªad
(
cgx_dev
, 0, 
CGXX_CMRX_RX_DMAC_CAM0
 + 
ödex
 * 0x8);

495  
cfg
 & 
CGX_RX_DMAC_ADR_MASK
;

496 
	}
}

498 
	$cgx_£t_pköd
(*
cgxd
, 
u8
 
lmac_id
, 
pköd
)

500 
cgx
 *cgx = 
cgxd
;

502 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

503  -
ENODEV
;

505 
	`cgx_wrôe
(
cgx
, 
lmac_id
, cgx->
mac_›s
->
rxid_m≠_off£t
, (
pköd
 & 0x3F));

507 
	}
}

509 
	$cgx_gë_pköd
(*
cgxd
, 
u8
 
lmac_id
, *
pköd
)

511 
cgx
 *cgx = 
cgxd
;

513 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

514  -
ENODEV
;

516 *
pköd
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, cgx->
mac_›s
->
rxid_m≠_off£t
);

517 *
pköd
 = *pkind & 0x3F;

519 
	}
}

521 
u8
 
	$cgx_gë_lmac_ty≥
(*
cgxd
, 
lmac_id
)

523 
cgx
 *cgx = 
cgxd
;

524 
u64
 
cfg
;

526 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_CMRX_CFG
);

527  (
cfg
 >> 
CGX_LMAC_TYPE_SHIFT
Ë& 
CGX_LMAC_TYPE_MASK
;

528 
	}
}

530 
u32
 
	$cgx_gë_lmac_fifo_Àn
(*
cgxd
, 
lmac_id
)

532 
cgx
 *cgx = 
cgxd
;

533 
u8
 
num_lmacs
;

534 
u32
 
fifo_Àn
;

536 
fifo_Àn
 = 
cgx
->
mac_›s
->fifo_len;

537 
num_lmacs
 = 
cgx
->
mac_›s
->
	`gë_ƒ_lmacs
(cgx);

539 
num_lmacs
) {

541  
fifo_Àn
;

543  
fifo_Àn
 / 2;

546 i‡(
lmac_id
 == 0)

547  
fifo_Àn
 / 2;

548  
fifo_Àn
 / 4;

551  
fifo_Àn
 / 4;

554 
	}
}

557 
	$cgx_lmac_öã∫Æ_lo›back
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

559 
cgx
 *cgx = 
cgxd
;

560 
u8
 
lmac_ty≥
;

561 
u64
 
cfg
;

563 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

564  -
ENODEV
;

566 
lmac_ty≥
 = 
cgx
->
mac_›s
->
	`gë_lmac_ty≥
(cgx, 
lmac_id
);

567 i‡(
lmac_ty≥
 =
LMAC_MODE_SGMII
 ||Ümac_ty≥ =
LMAC_MODE_QSGMII
) {

568 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_GMP_PCS_MRX_CTL
);

569 i‡(
íabÀ
)

570 
cfg
 |
CGXX_GMP_PCS_MRX_CTL_LBK
;

572 
cfg
 &~
CGXX_GMP_PCS_MRX_CTL_LBK
;

573 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_GMP_PCS_MRX_CTL
, 
cfg
);

575 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SPUX_CONTROL1
);

576 i‡(
íabÀ
)

577 
cfg
 |
CGXX_SPUX_CONTROL1_LBK
;

579 
cfg
 &~
CGXX_SPUX_CONTROL1_LBK
;

580 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SPUX_CONTROL1
, 
cfg
);

583 
	}
}

585 
	$cgx_lmac_¥omisc_c⁄fig
(
cgx_id
, 
lmac_id
, 
boﬁ
 
íabÀ
)

587 
cgx
 *cgx = 
	`cgx_gë_pd©a
(
cgx_id
);

588 
lmac
 *lma¯
	`lmac_pd©a
(
lmac_id
, 
cgx
);

589 
mac_›s
 *mac_ops;

590 
u16
 
max_dmac
;

591 
ödex
, 
i
;

592 
u64
 
cfg
 = 0;

593 
id
;

595 i‡(!
cgx
 || !
lmac
)

598 
max_dmac
 = 
lmac
->
mac_to_ödex_bm≠
.
max
;

599 
id
 = 
	`gë_£quí˚_id_of_lmac
(
cgx
, 
lmac_id
);

601 
mac_›s
 = 
cgx
->mac_ops;

602 i‡(
íabÀ
) {

604 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
);

605 
cfg
 &~
CGX_DMAC_CAM_ACCEPT
;

606 
cfg
 |(
CGX_DMAC_BCAST_MODE
 | 
CGX_DMAC_MCAST_MODE
);

607 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
, 
cfg
);

609 
i
 = 0; i < 
max_dmac
; i++) {

610 
ödex
 = 
id
 * 
max_dmac
 + 
i
;

611 
cfg
 = 
	`cgx_ªad
(
cgx
, 0,

612 (
CGXX_CMRX_RX_DMAC_CAM0
 + 
ödex
 * 0x8));

613 
cfg
 &~
CGX_DMAC_CAM_ADDR_ENABLE
;

614 
	`cgx_wrôe
(
cgx
, 0,

615 (
CGXX_CMRX_RX_DMAC_CAM0
 + 
ödex
 * 0x8), 
cfg
);

619 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
);

620 
cfg
 |
CGX_DMAC_CAM_ACCEPT
 | 
CGX_DMAC_MCAST_MODE
;

621 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_CMRX_RX_DMAC_CTL0
, 
cfg
);

622 
i
 = 0; i < 
max_dmac
; i++) {

623 
ödex
 = 
id
 * 
max_dmac
 + 
i
;

624 
cfg
 = 
	`cgx_ªad
(
cgx
, 0,

625 (
CGXX_CMRX_RX_DMAC_CAM0
 + 
ödex
 * 0x8));

626 i‡((
cfg
 & 
CGX_RX_DMAC_ADR_MASK
) != 0) {

627 
cfg
 |
CGX_DMAC_CAM_ADDR_ENABLE
;

628 
	`cgx_wrôe
(
cgx
, 0,

629 (
CGXX_CMRX_RX_DMAC_CAM0
 + 
ödex
 * 0x8),

630 
cfg
);

634 
	}
}

637 
	$cgx_lmac_íadis_rx_∑u£_fwdög
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

639 
cgx
 *cgx = 
cgxd
;

640 
u8
 
rx_∑u£
, 
tx_∑u£
;

641 
boﬁ
 
is_pfc_íabÀd
;

642 
lmac
 *lmac;

643 
u64
 
cfg
;

645 i‡(!
cgx
)

648 
lmac
 = 
	`lmac_pd©a
(
lmac_id
, 
cgx
);

649 i‡(!
lmac
)

653 i‡(!
	`bôm≠_weight
(
lmac
->
rx_fc_pfvf_bm≠
.
bm≠
,Ümac->rx_fc_pfvf_bm≠.
max
))

656 
	`cgx_lmac_gë_∑u£_‰m_°©us
(
cgx
, 
lmac_id
, &
rx_∑u£
, &
tx_∑u£
);

657 
is_pfc_íabÀd
 = 
rx_∑u£
 ? 
Ál£
 : 
åue
;

659 i‡(
íabÀ
) {

660 i‡(!
is_pfc_íabÀd
) {

661 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
);

662 
cfg
 |
CGX_GMP_GMI_RXX_FRM_CTL_CTL_BCK
;

663 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
, 
cfg
);

665 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
);

666 
cfg
 |
CGX_SMUX_RX_FRM_CTL_CTL_BCK
;

667 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
, 
cfg
);

669 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_CBFC_CTL
);

670 
cfg
 |
CGXX_SMUX_CBFC_CTL_BCK_EN
;

671 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_CBFC_CTL
, 
cfg
);

675 i‡(!
is_pfc_íabÀd
) {

676 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
);

677 
cfg
 &~
CGX_GMP_GMI_RXX_FRM_CTL_CTL_BCK
;

678 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
, 
cfg
);

680 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
);

681 
cfg
 &~
CGX_SMUX_RX_FRM_CTL_CTL_BCK
;

682 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
, 
cfg
);

684 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_CBFC_CTL
);

685 
cfg
 &~
CGXX_SMUX_CBFC_CTL_BCK_EN
;

686 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_CBFC_CTL
, 
cfg
);

689 
	}
}

691 
	$cgx_gë_rx_°©s
(*
cgxd
, 
lmac_id
, 
idx
, 
u64
 *
rx_°©
)

693 
cgx
 *cgx = 
cgxd
;

695 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

696  -
ENODEV
;

699 i‡(
idx
 >
CGX_RX_STAT_GLOBAL_INDEX
)

700 
lmac_id
 = 0;

702 *
rx_°©
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_CMRX_RX_STAT0
 + (
idx
 * 8));

704 
	}
}

706 
	$cgx_gë_tx_°©s
(*
cgxd
, 
lmac_id
, 
idx
, 
u64
 *
tx_°©
)

708 
cgx
 *cgx = 
cgxd
;

710 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

711  -
ENODEV
;

713 *
tx_°©
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_CMRX_TX_STAT0
 + (
idx
 * 8));

715 
	}
}

717 
u64
 
	$cgx_gë_dmacÊt_dr›≥d_pkt˙t
(*
cgxd
, 
lmac_id
)

719 
cgx
 *cgx = 
cgxd
;

721 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

724  
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_CMRX_RX_STAT4
);

725 
	}
}

727 
	$cgx_°©s_r°
(*
cgxd
, 
lmac_id
)

729 
cgx
 *cgx = 
cgxd
;

730 
°©_id
;

732 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

733  -
ENODEV
;

735 
°©_id
 = 0 ; sèt_id < 
CGX_RX_STATS_COUNT
; stat_id++) {

736 i‡(
°©_id
 >
CGX_RX_STAT_GLOBAL_INDEX
)

738 
	`cgx_wrôe
(
cgx
, 0,

739 (
CGXX_CMRX_RX_STAT0
 + (
°©_id
 * 8)), 0);

741 
	`cgx_wrôe
(
cgx
, 
lmac_id
,

742 (
CGXX_CMRX_RX_STAT0
 + (
°©_id
 * 8)), 0);

745 
°©_id
 = 0 ; sèt_id < 
CGX_TX_STATS_COUNT
; stat_id++)

746 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_CMRX_TX_STAT0
 + (
°©_id
 * 8), 0);

749 
	}
}

751 
u64
 
	$cgx_„©uªs_gë
(*
cgxd
)

753  ((
cgx
 *)
cgxd
)->
hw_„©uªs
;

754 
	}
}

756 
	$cgx_£t_„c_°©s_cou¡
(
cgx_lök_u£r_öfo
 *
löfo
)

758 i‡(!
löfo
->
„c
)

761 
löfo
->
lmac_ty≥_id
) {

762 
LMAC_MODE_SGMII
:

763 
LMAC_MODE_XAUI
:

764 
LMAC_MODE_RXAUI
:

765 
LMAC_MODE_QSGMII
:

767 
LMAC_MODE_10G_R
:

768 
LMAC_MODE_25G_R
:

769 
LMAC_MODE_100G_R
:

770 
LMAC_MODE_USXGMII
:

772 
LMAC_MODE_40G_R
:

774 
LMAC_MODE_50G_R
:

775 i‡(
löfo
->
„c
 =
OTX2_FEC_BASER
)

782 
	}
}

784 
	$cgx_gë_„c_°©s
(*
cgxd
, 
lmac_id
, 
cgx_„c_°©s_r•
 *
r•
)

786 
°©s
, 
„c_°©s_cou¡
 = 0;

787 
c‹r_ªg
, 
unc‹r_ªg
;

788 
cgx
 *cgx = 
cgxd
;

790 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

791  -
ENODEV
;

793 i‡(
cgx
->
lmac_idm≠
[
lmac_id
]->
lök_öfo
.
„c
 =
OTX2_FEC_NONE
)

796 
„c_°©s_cou¡
 =

797 
	`cgx_£t_„c_°©s_cou¡
(&
cgx
->
lmac_idm≠
[
lmac_id
]->
lök_öfo
);

798 i‡(
cgx
->
lmac_idm≠
[
lmac_id
]->
lök_öfo
.
„c
 =
OTX2_FEC_BASER
) {

799 
c‹r_ªg
 = 
CGXX_SPUX_LNX_FEC_CORR_BLOCKS
;

800 
unc‹r_ªg
 = 
CGXX_SPUX_LNX_FEC_UNCORR_BLOCKS
;

802 
c‹r_ªg
 = 
CGXX_SPUX_RSFEC_CORR
;

803 
unc‹r_ªg
 = 
CGXX_SPUX_RSFEC_UNCORR
;

805 
°©s
 = 0; sèt†< 
„c_°©s_cou¡
; stats++) {

806 
r•
->
„c_c‹r_blks
 +=

807 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
c‹r_ªg
 + (
°©s
 * 8));

808 
r•
->
„c_unc‹r_blks
 +=

809 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
unc‹r_ªg
 + (
°©s
 * 8));

812 
	}
}

814 
u64
 
	$cgx_gë_lmac_tx_fifo_°©us
(*
cgxd
, 
lmac_id
)

816 
cgx
 *cgx = 
cgxd
;

818 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

820  
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_CMRX_TX_FIFO_LEN
);

821 
	}
}

822 
EXPORT_SYMBOL
(
cgx_gë_lmac_tx_fifo_°©us
);

824 
	$cgx_lmac_rx_tx_íabÀ
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

826 
cgx
 *cgx = 
cgxd
;

827 
u64
 
cfg
;

829 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

830  -
ENODEV
;

832 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_CMRX_CFG
);

833 i‡(
íabÀ
)

834 
cfg
 |
DATA_PKT_RX_EN
 | 
DATA_PKT_TX_EN
;

836 
cfg
 &~(
DATA_PKT_RX_EN
 | 
DATA_PKT_TX_EN
);

837 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_CMRX_CFG
, 
cfg
);

839 
	}
}

841 
	$cgx_lmac_tx_íabÀ
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

843 
cgx
 *cgx = 
cgxd
;

844 
u64
 
cfg
, 
œ°
;

846 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

847  -
ENODEV
;

849 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_CMRX_CFG
);

850 
œ°
 = 
cfg
;

851 i‡(
íabÀ
)

852 
cfg
 |
DATA_PKT_TX_EN
;

854 
cfg
 &~
DATA_PKT_TX_EN
;

856 i‡(
cfg
 !
œ°
)

857 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_CMRX_CFG
, 
cfg
);

858  !!(
œ°
 & 
DATA_PKT_TX_EN
);

859 
	}
}

861 
	$cgx_lmac_gë_higig2_∑u£_‰m_°©us
(*
cgxd
, 
lmac_id
,

862 
u8
 *
tx_∑u£
, u8 *
rx_∑u£
)

864 
cgx
 *cgx = 
cgxd
;

865 
u64
 
cfg
;

867 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_HG2_CONTROL
);

869 *
rx_∑u£
 = !!(
cfg
 & 
CGXX_SMUX_HG2_CONTROL_RX_ENABLE
);

870 *
tx_∑u£
 = !!(
cfg
 & 
CGXX_SMUX_HG2_CONTROL_TX_ENABLE
);

872 
	}
}

874 
	$cgx_lmac_gë_∑u£_‰m_°©us
(*
cgxd
, 
lmac_id
,

875 
u8
 *
tx_∑u£
, u8 *
rx_∑u£
)

877 
cgx
 *cgx = 
cgxd
;

878 
u64
 
cfg
;

880 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

881  -
ENODEV
;

883 i‡(
	`is_higig2_íabÀd
(
cgxd
, 
lmac_id
))

884  
	`cgx_lmac_gë_higig2_∑u£_‰m_°©us
(
cgxd
, 
lmac_id
,

885 
tx_∑u£
, 
rx_∑u£
);

887 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
);

888 *
rx_∑u£
 = !!(
cfg
 & 
CGX_SMUX_RX_FRM_CTL_CTL_BCK
);

890 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_CTL
);

891 *
tx_∑u£
 = !!(
cfg
 & 
CGX_SMUX_TX_CTL_L2P_BP_CONV
);

893 
	}
}

895 
	$cgx_lmac_íadis_higig2_∑u£_‰m
(*
cgxd
, 
lmac_id
,

896 
u8
 
tx_∑u£
, u8 
rx_∑u£
)

898 
cgx
 *cgx = 
cgxd
;

899 
u64
 
cfg
;

901 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_HG2_CONTROL
);

902 
cfg
 &~
CGXX_SMUX_HG2_CONTROL_RX_ENABLE
;

903 
cfg
 |
rx_∑u£
 ? 
CGXX_SMUX_HG2_CONTROL_RX_ENABLE
 : 0x0;

904 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_HG2_CONTROL
, 
cfg
);

907 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
);

908 
cfg
 &~
CGX_SMUX_RX_FRM_CTL_CTL_BCK
;

909 
cfg
 |
rx_∑u£
 ? 
CGX_SMUX_RX_FRM_CTL_CTL_BCK
 : 0x0;

910 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
, 
cfg
);

912 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_HG2_CONTROL
);

913 
cfg
 &~
CGXX_SMUX_HG2_CONTROL_TX_ENABLE
;

914 
cfg
 |
tx_∑u£
 ? 
CGXX_SMUX_HG2_CONTROL_TX_ENABLE
 : 0x0;

915 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_HG2_CONTROL
, 
cfg
);

918 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_PAUSE_PKT_INTERVAL
);

919 
cfg
 &~
CGXX_SMUX_TX_PAUSE_PKT_HG2_INTRA_EN
;

920 
cfg
 |
tx_∑u£
 ? 
CGXX_SMUX_TX_PAUSE_PKT_HG2_INTRA_EN
 : 0x0;

921 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_PAUSE_PKT_INTERVAL
, 
cfg
);

923 
cfg
 = 
	`cgx_ªad
(
cgx
, 0, 
CGXX_CMR_RX_OVR_BP
);

924 i‡(
tx_∑u£
) {

925 
cfg
 &~
	`CGX_CMR_RX_OVR_BP_EN
(
lmac_id
);

927 
cfg
 |
	`CGX_CMR_RX_OVR_BP_EN
(
lmac_id
);

928 
cfg
 &~
	`CGX_CMR_RX_OVR_BP_BP
(
lmac_id
);

930 
	`cgx_wrôe
(
cgx
, 0, 
CGXX_CMR_RX_OVR_BP
, 
cfg
);

933 
	}
}

935 
	$cgx_lmac_íadis_8023_∑u£_‰m
(*
cgxd
, 
lmac_id
,

936 
u8
 
tx_∑u£
, u8 
rx_∑u£
)

938 
cgx
 *cgx = 
cgxd
;

939 
u64
 
cfg
;

941 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
);

942 
cfg
 &~
CGX_SMUX_RX_FRM_CTL_CTL_BCK
;

943 
cfg
 |
rx_∑u£
 ? 
CGX_SMUX_RX_FRM_CTL_CTL_BCK
 : 0x0;

944 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
, 
cfg
);

946 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_CTL
);

947 
cfg
 &~
CGX_SMUX_TX_CTL_L2P_BP_CONV
;

948 
cfg
 |
tx_∑u£
 ? 
CGX_SMUX_TX_CTL_L2P_BP_CONV
 : 0x0;

949 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_CTL
, 
cfg
);

951 
cfg
 = 
	`cgx_ªad
(
cgx
, 0, 
CGXX_CMR_RX_OVR_BP
);

952 i‡(
tx_∑u£
) {

953 
cfg
 &~
	`CGX_CMR_RX_OVR_BP_EN
(
lmac_id
);

955 
cfg
 |
	`CGX_CMR_RX_OVR_BP_EN
(
lmac_id
);

956 
cfg
 &~
	`CGX_CMR_RX_OVR_BP_BP
(
lmac_id
);

958 
	`cgx_wrôe
(
cgx
, 0, 
CGXX_CMR_RX_OVR_BP
, 
cfg
);

961 
	}
}

963 
	$cgx_lmac_íadis_∑u£_‰m
(*
cgxd
, 
lmac_id
,

964 
u8
 
tx_∑u£
, u8 
rx_∑u£
)

966 
cgx
 *cgx = 
cgxd
;

968 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

969  -
ENODEV
;

971 i‡(
	`is_higig2_íabÀd
(
cgxd
, 
lmac_id
))

972  
	`cgx_lmac_íadis_higig2_∑u£_‰m
(
cgxd
, 
lmac_id
,

973 
tx_∑u£
, 
rx_∑u£
);

975  
	`cgx_lmac_íadis_8023_∑u£_‰m
(
cgxd
, 
lmac_id
,

976 
tx_∑u£
, 
rx_∑u£
);

978 
	}
}

979 
EXPORT_SYMBOL
(
cgx_lmac_íadis_∑u£_‰m
);

981 
	$vîify_lmac_fc_cfg
(*
cgxd
, 
lmac_id
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
,

982 
pfvf_idx
)

984 
cgx
 *cgx = 
cgxd
;

985 
lmac
 *lmac;

987 
lmac
 = 
	`lmac_pd©a
(
lmac_id
, 
cgx
);

988 i‡(!
lmac
)

989  -
ENODEV
;

991 i‡(!
rx_∑u£
)

992 
	`˛ór_bô
(
pfvf_idx
, 
lmac
->
rx_fc_pfvf_bm≠
.
bm≠
);

994 
	`£t_bô
(
pfvf_idx
, 
lmac
->
rx_fc_pfvf_bm≠
.
bm≠
);

996 i‡(!
tx_∑u£
)

997 
	`˛ór_bô
(
pfvf_idx
, 
lmac
->
tx_fc_pfvf_bm≠
.
bm≠
);

999 
	`£t_bô
(
pfvf_idx
, 
lmac
->
tx_fc_pfvf_bm≠
.
bm≠
);

1002 i‡(!
rx_∑u£
 && 
	`bôm≠_weight
(
lmac
->
rx_fc_pfvf_bm≠
.
bm≠
,Ümac->rx_fc_pfvf_bm≠.
max
)) {

1003 
	`dev_w¨n
(&
cgx
->
pdev
->
dev
,

1005  -
EPERM
;

1008 i‡(!
tx_∑u£
 && 
	`bôm≠_weight
(
lmac
->
tx_fc_pfvf_bm≠
.
bm≠
,Ümac->tx_fc_pfvf_bm≠.
max
)) {

1009 
	`dev_w¨n
(&
cgx
->
pdev
->
dev
,

1011  -
EPERM
;

1015 
	}
}

1017 
	$cgx_lmac_pfc_c⁄fig
(*
cgxd
, 
lmac_id
, 
u8
 
tx_∑u£
,

1018 
u8
 
rx_∑u£
, 
u16
 
pfc_í
)

1020 
cgx
 *cgx = 
cgxd
;

1021 
u64
 
cfg
;

1023 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

1024  -
ENODEV
;

1027 i‡(
tx_∑u£
 && !
pfc_í
)

1030 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_CBFC_CTL
);

1031 
pfc_í
 |
	`FIELD_GET
(
CGX_PFC_CLASS_MASK
, 
cfg
);

1033 i‡(
rx_∑u£
) {

1034 
cfg
 |(
CGXX_SMUX_CBFC_CTL_RX_EN
 |

1035 
CGXX_SMUX_CBFC_CTL_BCK_EN
 |

1036 
CGXX_SMUX_CBFC_CTL_DRP_EN
);

1038 
cfg
 &~(
CGXX_SMUX_CBFC_CTL_RX_EN
 |

1039 
CGXX_SMUX_CBFC_CTL_BCK_EN
 |

1040 
CGXX_SMUX_CBFC_CTL_DRP_EN
);

1043 i‡(
tx_∑u£
) {

1044 
cfg
 |
CGXX_SMUX_CBFC_CTL_TX_EN
;

1045 
cfg
 = 
	`FIELD_SET
(
CGX_PFC_CLASS_MASK
, 
pfc_í
, cfg);

1047 
cfg
 &~
CGXX_SMUX_CBFC_CTL_TX_EN
;

1048 
cfg
 = 
	`FIELD_SET
(
CGX_PFC_CLASS_MASK
, 0, cfg);

1051 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_CBFC_CTL
, 
cfg
);

1054 
cfg
 = 
	`cgx_lmac_addr_gë
(
cgx
->
cgx_id
, 
lmac_id
);

1055 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_SMAC
, 
cfg
);

1058 
	}
}

1060 
	$cgx_lmac_gë_pfc_‰m_cfg
(*
cgxd
, 
lmac_id
, 
u8
 *
tx_∑u£
,

1061 
u8
 *
rx_∑u£
)

1063 
cgx
 *cgx = 
cgxd
;

1064 
u64
 
cfg
;

1066 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

1067  -
ENODEV
;

1069 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_CBFC_CTL
);

1071 *
rx_∑u£
 = !!(
cfg
 & 
CGXX_SMUX_CBFC_CTL_RX_EN
);

1072 *
tx_∑u£
 = !!(
cfg
 & 
CGXX_SMUX_CBFC_CTL_TX_EN
);

1075 
	}
}

1077 
	$cgx_lmac_±p_c⁄fig
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

1079 
cgx
 *cgx = 
cgxd
;

1080 
u64
 
cfg
;

1082 i‡(!
cgx
)

1085 i‡(
íabÀ
) {

1087 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
);

1088 
cfg
 |
CGX_GMP_GMI_RXX_FRM_CTL_PTP_MODE
;

1089 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
, 
cfg
);

1091 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
);

1092 
cfg
 |
CGX_SMUX_RX_FRM_CTL_PTP_MODE
;

1093 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
, 
cfg
);

1096 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
);

1097 
cfg
 &~
CGX_GMP_GMI_RXX_FRM_CTL_PTP_MODE
;

1098 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
, 
cfg
);

1100 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
);

1101 
cfg
 &~
CGX_SMUX_RX_FRM_CTL_PTP_MODE
;

1102 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
, 
cfg
);

1104 
	}
}

1105 
EXPORT_SYMBOL
(
cgx_lmac_±p_c⁄fig
);

1107 
	$cgx_lmac_∑u£_‰m_c⁄fig
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

1109 
cgx
 *cgx = 
cgxd
;

1110 
u64
 
cfg
;

1112 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

1115 i‡(
íabÀ
) {

1117 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_PAUSE_PKT_TIME
,

1118 
DEFAULT_PAUSE_TIME
);

1120 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_PAUSE_PKT_INTERVAL
);

1121 
cfg
 &= ~0xFFFFULL;

1122 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_PAUSE_PKT_INTERVAL
,

1123 
cfg
 | (
DEFAULT_PAUSE_TIME
 / 2));

1125 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_PAUSE_PKT_INTERVAL
);

1126 
cfg
 = 
	`FIELD_SET
(
HG2_INTRA_INTERVAL
, (
DEFAULT_PAUSE_TIME
 / 2),

1127 
cfg
);

1128 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_PAUSE_PKT_INTERVAL
,

1129 
cfg
);

1131 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_TX_PAUSE_PKT_TIME
,

1132 
DEFAULT_PAUSE_TIME
);

1134 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
,

1135 
CGXX_GMP_GMI_TX_PAUSE_PKT_INTERVAL
);

1136 
cfg
 &= ~0xFFFFULL;

1137 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_TX_PAUSE_PKT_INTERVAL
,

1138 
cfg
 | (
DEFAULT_PAUSE_TIME
 / 2));

1142 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
);

1143 
cfg
 &~
CGX_SMUX_RX_FRM_CTL_CTL_BCK
;

1144 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_RX_FRM_CTL
, 
cfg
);

1146 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
);

1147 
cfg
 &~
CGX_GMP_GMI_RXX_FRM_CTL_CTL_BCK
;

1148 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_GMP_GMI_RXX_FRM_CTL
, 
cfg
);

1150 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_HG2_CONTROL
);

1151 
cfg
 &~
CGXX_SMUX_HG2_CONTROL_RX_ENABLE
;

1152 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_HG2_CONTROL
, 
cfg
);

1155 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_CTL
);

1156 
cfg
 &~
CGX_SMUX_TX_CTL_L2P_BP_CONV
;

1157 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_CTL
, 
cfg
);

1159 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_HG2_CONTROL
);

1160 
cfg
 &~
CGXX_SMUX_HG2_CONTROL_TX_ENABLE
;

1161 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_HG2_CONTROL
, 
cfg
);

1163 
cfg
 = 
	`cgx_ªad
(
cgx
, 0, 
CGXX_CMR_RX_OVR_BP
);

1164 
cfg
 |
	`CGX_CMR_RX_OVR_BP_EN
(
lmac_id
);

1165 
cfg
 &~
	`CGX_CMR_RX_OVR_BP_BP
(
lmac_id
);

1166 
	`cgx_wrôe
(
cgx
, 0, 
CGXX_CMR_RX_OVR_BP
, 
cfg
);

1169 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_CBFC_CTL
);

1170 
cfg
 = 
	`FIELD_SET
(
CGX_PFC_CLASS_MASK
, 0, cfg);

1171 
	`cgx_wrôe
(
cgx
, 
lmac_id
, 
CGXX_SMUX_CBFC_CTL
, 
cfg
);

1172 
	}
}

1175 
	$cgx_fwi_cmd_£nd
(
u64
 
ªq
, u64 *
ª•
, 
lmac
 *lmac)

1177 
cgx
 *cgx = 
lmac
->cgx;

1178 
devi˚
 *
dev
;

1179 
îr
 = 0;

1180 
u64
 
cmd
;

1183 
îr
 = 
	`muãx_lock_öãºu±ibÀ
(&
lmac
->
cmd_lock
);

1184 i‡(
îr
)

1185  
îr
;

1188 
cmd
 = 
	`cgx_ªad
(
cgx
, 
lmac
->
lmac_id
, 
CGX_COMMAND_REG
);

1189 i‡(
	`FIELD_GET
(
CMDREG_OWN
, 
cmd
Ë!
CGX_CMD_OWN_NS
) {

1190 
îr
 = -
EBUSY
;

1191 
u∆ock
;

1195 
ªq
 = 
	`FIELD_SET
(
CMDREG_OWN
, 
CGX_CMD_OWN_FIRMWARE
,Ñeq);

1198 
lmac
->
cmd_≥nd
 = 
åue
;

1201 
	`cgx_wrôe
(
cgx
, 
lmac
->
lmac_id
, 
CGX_COMMAND_REG
, 
ªq
);

1204 i‡(!
	`waô_evít_timeout
(
lmac
->
wq_cmd_cm∂t
, !lmac->
cmd_≥nd
,

1205 
	`m£cs_to_jiffõs
(
CGX_CMD_TIMEOUT
))) {

1206 
dev
 = &
cgx
->
pdev
->dev;

1207 
	`dev_îr
(
dev
, "cgxÖort %d:%d cmd %lldÅimeout\n",

1208 
cgx
->
cgx_id
, 
lmac
->
lmac_id
, 
	`FIELD_GET
(
CMDREG_ID
, 
ªq
));

1209 
îr
 = 
LMAC_AF_ERR_CMD_TIMEOUT
;

1210 
u∆ock
;

1214 
	`smp_rmb
();

1215 *
ª•
 = 
lmac
->resp;

1217 
u∆ock
:

1218 
	`muãx_u∆ock
(&
lmac
->
cmd_lock
);

1220  
îr
;

1221 
	}
}

1223 
	$cgx_fwi_cmd_gíîic
(
u64
 
ªq
, u64 *
ª•
, 
cgx
 *cgx, 
lmac_id
)

1225 
lmac
 *lmac;

1226 
îr
;

1228 
lmac
 = 
	`lmac_pd©a
(
lmac_id
, 
cgx
);

1229 i‡(!
lmac
)

1230  -
ENODEV
;

1232 
îr
 = 
	`cgx_fwi_cmd_£nd
(
ªq
, 
ª•
, 
lmac
);

1235 i‡(!
îr
) {

1236 i‡(
	`FIELD_GET
(
EVTREG_STAT
, *
ª•
Ë=
CGX_STAT_FAIL
)

1237  -
EIO
;

1242  
îr
;

1243 
	}
}

1245 
	$cgx_lök_u£πabÀ_ödex_m≠
(
•ìd
)

1247 
•ìd
) {

1248 
SPEED_10
:

1249  
CGX_LINK_10M
;

1250 
SPEED_100
:

1251  
CGX_LINK_100M
;

1252 
SPEED_1000
:

1253  
CGX_LINK_1G
;

1254 
SPEED_2500
:

1255  
CGX_LINK_2HG
;

1256 
SPEED_5000
:

1257  
CGX_LINK_5G
;

1258 
SPEED_10000
:

1259  
CGX_LINK_10G
;

1260 
SPEED_20000
:

1261  
CGX_LINK_20G
;

1262 
SPEED_25000
:

1263  
CGX_LINK_25G
;

1264 
SPEED_40000
:

1265  
CGX_LINK_40G
;

1266 
SPEED_50000
:

1267  
CGX_LINK_50G
;

1269  
CGX_LINK_80G
;

1270 
SPEED_100000
:

1271  
CGX_LINK_100G
;

1272 
SPEED_UNKNOWN
:

1273  
CGX_LINK_NONE
;

1275  
CGX_LINK_NONE
;

1276 
	}
}

1278 
	$£t_mod_¨gs
(
cgx_£t_lök_mode_¨gs
 *
¨gs
,

1279 
u32
 
•ìd
, 
u8
 
du∂ex
, u8 
aut⁄eg
, 
u64
 
mode
)

1281 
mode_ba£idx
;

1282 
u8
 
cgx_mode
;

1287 i‡(
¨gs
->
du∂ex
 =
DUPLEX_UNKNOWN
)

1288 
¨gs
->
du∂ex
 = duplex;

1289 i‡(
¨gs
->
•ìd
 =
SPEED_UNKNOWN
)

1290 
¨gs
->
•ìd
 = speed;

1291 i‡(
¨gs
->
™
 =
AUTONEG_UNKNOWN
)

1292 
¨gs
->
™
 = 
aut⁄eg
;

1297 
cgx_mode
 = 
	`föd_fú°_bô
((*)&
mode
,

1298 
CGX_MODE_MAX
);

1299 
¨gs
->
mode
 = mode;

1300 
mode_ba£idx
 = 
cgx_mode
 - 41;

1301 i‡(
mode_ba£idx
 > 0) {

1302 
¨gs
->
mode_ba£idx
 = 1;

1303 
¨gs
->
mode
 = 
	`BIT_ULL
(
mode_ba£idx
);

1305 
	}
}

1307 
	$Ÿx2_m≠_ëhtoﬁ_lök_modes
(
u64
 
bômask
,

1308 
cgx_£t_lök_mode_¨gs
 *
¨gs
)

1310 
bômask
) {

1311 
ETHTOOL_LINK_MODE_10ba£T_HÆf_BIT
:

1312 
	`£t_mod_¨gs
(
¨gs
, 10, 1, 1, 
	`BIT_ULL
(
CGX_MODE_SGMII
));

1314 
ETHTOOL_LINK_MODE_10ba£T_FuŒ_BIT
:

1315 
	`£t_mod_¨gs
(
¨gs
, 10, 0, 1, 
	`BIT_ULL
(
CGX_MODE_SGMII
));

1317 
ETHTOOL_LINK_MODE_100ba£T_HÆf_BIT
:

1318 
	`£t_mod_¨gs
(
¨gs
, 100, 1, 1, 
	`BIT_ULL
(
CGX_MODE_SGMII
));

1320 
ETHTOOL_LINK_MODE_100ba£T_FuŒ_BIT
:

1321 
	`£t_mod_¨gs
(
¨gs
, 100, 0, 1, 
	`BIT_ULL
(
CGX_MODE_SGMII
));

1323 
ETHTOOL_LINK_MODE_1000ba£T_HÆf_BIT
:

1324 
	`£t_mod_¨gs
(
¨gs
, 1000, 1, 1, 
	`BIT_ULL
(
CGX_MODE_SGMII
));

1326 
ETHTOOL_LINK_MODE_1000ba£T_FuŒ_BIT
:

1327 
	`£t_mod_¨gs
(
¨gs
, 1000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_SGMII
));

1329 
ETHTOOL_LINK_MODE_1000ba£X_FuŒ_BIT
:

1330 
	`£t_mod_¨gs
(
¨gs
, 1000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_1000_BASEX
));

1332 
ETHTOOL_LINK_MODE_10000ba£T_FuŒ_BIT
:

1333 
	`£t_mod_¨gs
(
¨gs
, 1000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_QSGMII
));

1335 
ETHTOOL_LINK_MODE_10000ba£SR_FuŒ_BIT
:

1336 
	`£t_mod_¨gs
(
¨gs
, 10000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_10G_C2C
));

1338 
ETHTOOL_LINK_MODE_10000ba£LR_FuŒ_BIT
:

1339 
	`£t_mod_¨gs
(
¨gs
, 10000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_10G_C2M
));

1341 
ETHTOOL_LINK_MODE_10000ba£KR_FuŒ_BIT
:

1342 
	`£t_mod_¨gs
(
¨gs
, 10000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_10G_KR
));

1344 
ETHTOOL_LINK_MODE_20000ba£MLD2_FuŒ_BIT
:

1345 
	`£t_mod_¨gs
(
¨gs
, 20000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_20G_C2C
));

1347 
ETHTOOL_LINK_MODE_25000ba£SR_FuŒ_BIT
:

1348 
	`£t_mod_¨gs
(
¨gs
, 25000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_25G_C2C
));

1350 
ETHTOOL_LINK_MODE_10000ba£R_FEC_BIT
:

1351 
	`£t_mod_¨gs
(
¨gs
, 25000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_25G_C2M
));

1353 
ETHTOOL_LINK_MODE_20000ba£KR2_FuŒ_BIT
:

1354 
	`£t_mod_¨gs
(
¨gs
, 25000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_25G_2_C2C
));

1356 
ETHTOOL_LINK_MODE_25000ba£CR_FuŒ_BIT
:

1357 
	`£t_mod_¨gs
(
¨gs
, 25000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_25G_CR
));

1359 
ETHTOOL_LINK_MODE_25000ba£KR_FuŒ_BIT
:

1360 
	`£t_mod_¨gs
(
¨gs
, 25000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_25G_KR
));

1362 
ETHTOOL_LINK_MODE_40000ba£SR4_FuŒ_BIT
:

1363 
	`£t_mod_¨gs
(
¨gs
, 40000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_40G_C2C
));

1365 
ETHTOOL_LINK_MODE_40000ba£LR4_FuŒ_BIT
:

1366 
	`£t_mod_¨gs
(
¨gs
, 40000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_40G_C2M
));

1368 
ETHTOOL_LINK_MODE_40000ba£CR4_FuŒ_BIT
:

1369 
	`£t_mod_¨gs
(
¨gs
, 40000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_40G_CR4
));

1371 
ETHTOOL_LINK_MODE_40000ba£KR4_FuŒ_BIT
:

1372 
	`£t_mod_¨gs
(
¨gs
, 40000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_40G_KR4
));

1374 
ETHTOOL_LINK_MODE_10000ba£KX4_FuŒ_BIT
:

1375 
	`£t_mod_¨gs
(
¨gs
, 40000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_40GAUI_C2C
));

1377 
ETHTOOL_LINK_MODE_50000ba£SR2_FuŒ_BIT
:

1378 
	`£t_mod_¨gs
(
¨gs
, 50000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_50G_C2C
));

1380 
ETHTOOL_LINK_MODE_56000ba£KR4_FuŒ_BIT
:

1381 
	`£t_mod_¨gs
(
¨gs
, 50000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_50G_4_C2C
));

1383 
ETHTOOL_LINK_MODE_50000ba£DR_FuŒ_BIT
:

1384 
	`£t_mod_¨gs
(
¨gs
, 50000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_50G_C2M
));

1386 
ETHTOOL_LINK_MODE_50000ba£CR2_FuŒ_BIT
:

1387 
	`£t_mod_¨gs
(
¨gs
, 50000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_50G_CR
));

1389 
ETHTOOL_LINK_MODE_50000ba£KR2_FuŒ_BIT
:

1390 
	`£t_mod_¨gs
(
¨gs
, 50000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_50G_KR
));

1392 
ETHTOOL_LINK_MODE_10000ba£LRM_FuŒ_BIT
:

1393 
	`£t_mod_¨gs
(
¨gs
, 80000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_80GAUI_C2C
));

1395 
ETHTOOL_LINK_MODE_100000ba£SR4_FuŒ_BIT
:

1396 
	`£t_mod_¨gs
(
¨gs
, 100000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_100G_C2C
));

1398 
ETHTOOL_LINK_MODE_100000ba£LR4_ER4_FuŒ_BIT
:

1399 
	`£t_mod_¨gs
(
¨gs
, 100000, 0, 0, 
	`BIT_ULL
(
CGX_MODE_100G_C2M
));

1401 
ETHTOOL_LINK_MODE_100000ba£CR4_FuŒ_BIT
:

1402 
	`£t_mod_¨gs
(
¨gs
, 100000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_100G_CR4
));

1404 
ETHTOOL_LINK_MODE_100000ba£KR4_FuŒ_BIT
:

1405 
	`£t_mod_¨gs
(
¨gs
, 100000, 0, 1, 
	`BIT_ULL
(
CGX_MODE_100G_KR4
));

1407 
ETHTOOL_LINK_MODE_50000ba£SR_FuŒ_BIT
:

1408 
	`£t_mod_¨gs
(
¨gs
, 50000, 0, 0,

1409 
	`BIT_ULL
(
CGX_MODE_LAUI_2_C2C_BIT
));

1411 
ETHTOOL_LINK_MODE_50000ba£LR_ER_FR_FuŒ_BIT
:

1412 
	`£t_mod_¨gs
(
¨gs
, 50000, 0, 0,

1413 
	`BIT_ULL
(
CGX_MODE_LAUI_2_C2M_BIT
));

1415 
ETHTOOL_LINK_MODE_50000ba£CR_FuŒ_BIT
:

1416 
	`£t_mod_¨gs
(
¨gs
, 50000, 0, 1,

1417 
	`BIT_ULL
(
CGX_MODE_50GBASE_CR2_C_BIT
));

1419 
ETHTOOL_LINK_MODE_50000ba£KR_FuŒ_BIT
:

1420 
	`£t_mod_¨gs
(
¨gs
, 50000, 0, 1,

1421 
	`BIT_ULL
(
CGX_MODE_50GBASE_KR2_C_BIT
));

1423 
ETHTOOL_LINK_MODE_100000ba£SR2_FuŒ_BIT
:

1424 
	`£t_mod_¨gs
(
¨gs
, 100000, 0, 0,

1425 
	`BIT_ULL
(
CGX_MODE_100GAUI_2_C2C_BIT
));

1427 
ETHTOOL_LINK_MODE_100000ba£LR2_ER2_FR2_FuŒ_BIT
:

1428 
	`£t_mod_¨gs
(
¨gs
, 100000, 0, 0,

1429 
	`BIT_ULL
(
CGX_MODE_100GAUI_2_C2M_BIT
));

1431 
ETHTOOL_LINK_MODE_100000ba£CR2_FuŒ_BIT
:

1432 
	`£t_mod_¨gs
(
¨gs
, 100000, 0, 1,

1433 
	`BIT_ULL
(
CGX_MODE_100GBASE_CR2_BIT
));

1435 
ETHTOOL_LINK_MODE_100000ba£KR2_FuŒ_BIT
:

1436 
	`£t_mod_¨gs
(
¨gs
, 100000, 0, 1,

1437 
	`BIT_ULL
(
CGX_MODE_100GBASE_KR2_BIT
));

1439 
ETHTOOL_LINK_MODE_1000ba£KX_FuŒ_BIT
:

1440 
	`£t_mod_¨gs
(
¨gs
, 1000, 0, 0,

1441 
	`BIT_ULL
(
CGX_MODE_SFI_1G_BIT
));

1443 
ETHTOOL_LINK_MODE_56000ba£CR4_FuŒ_BIT
:

1444 
	`£t_mod_¨gs
(
¨gs
, 25000, 0, 1,

1445 
	`BIT_ULL
(
CGX_MODE_25GBASE_CR_C_BIT
));

1447 
ETHTOOL_LINK_MODE_56000ba£SR4_FuŒ_BIT
:

1448 
	`£t_mod_¨gs
(
¨gs
, 25000, 0, 1,

1449 
	`BIT_ULL
(
CGX_MODE_25GBASE_KR_C_BIT
));

1452 
	`£t_mod_¨gs
(
¨gs
, 0, 1, 0, 
	`BIT_ULL
(
CGX_MODE_MAX
));

1455 
	}
}

1456 
ölöe
 
	$lök_°©us_u£r_f‹m©
(
u64
 
l°©
,

1457 
cgx_lök_u£r_öfo
 *
löfo
,

1458 
cgx
 *cgx, 
u8
 
lmac_id
)

1460 c⁄° *
lmac_°rög
;

1462 
löfo
->
lök_up
 = 
	`FIELD_GET
(
RESP_LINKSTAT_UP
, 
l°©
);

1463 
löfo
->
fuŒ_du∂ex
 = 
	`FIELD_GET
(
RESP_LINKSTAT_FDUPLEX
, 
l°©
);

1464 
löfo
->
•ìd
 = 
cgx_•ìd_mbps
[
	`FIELD_GET
(
RESP_LINKSTAT_SPEED
, 
l°©
)];

1465 
löfo
->
™
 = 
	`FIELD_GET
(
RESP_LINKSTAT_AN
, 
l°©
);

1466 
löfo
->
„c
 = 
	`FIELD_GET
(
RESP_LINKSTAT_FEC
, 
l°©
);

1467 
löfo
->
lmac_ty≥_id
 = 
	`FIELD_GET
(
RESP_LINKSTAT_LMAC_TYPE
, 
l°©
);

1468 
lmac_°rög
 = 
cgx_lma˘y≥_°rög
[
löfo
->
lmac_ty≥_id
];

1469 
	`°∫˝y
(
löfo
->
lmac_ty≥
, 
lmac_°rög
, 
LMACTYPE_STR_LEN
 - 1);

1470 
	}
}

1473 
ölöe
 
	$cgx_lök_ch™ge_h™dÀr
(
u64
 
l°©
,

1474 
lmac
 *lmac)

1476 
cgx_lök_u£r_öfo
 *
löfo
;

1477 
cgx
 *cgx = 
lmac
->cgx;

1478 
cgx_lök_evít
 
evít
;

1479 
devi˚
 *
dev
;

1480 
îr_ty≥
;

1482 
dev
 = &
cgx
->
pdev
->dev;

1484 
	`lök_°©us_u£r_f‹m©
(
l°©
, &
evít
.
lök_uöfo
, 
cgx
, 
lmac
->
lmac_id
);

1485 
îr_ty≥
 = 
	`FIELD_GET
(
RESP_LINKSTAT_ERRTYPE
, 
l°©
);

1487 
evít
.
cgx_id
 = 
cgx
->cgx_id;

1488 
evít
.
lmac_id
 = 
lmac
->lmac_id;

1491 
lmac
->
lök_öfo
 = 
evít
.
lök_uöfo
;

1492 
löfo
 = &
lmac
->
lök_öfo
;

1494 i‡(
îr_ty≥
 =
CGX_ERR_SPEED_CHANGE_INVALID
)

1497 
	`•ö_lock
(&
lmac
->
evít_cb_lock
);

1499 i‡(!
lmac
->
evít_cb
.
nŸify_lök_chg
) {

1500 
	`dev_dbg
(
dev
, "cgxÖort %d:%d Link change handlerÇull",

1501 
cgx
->
cgx_id
, 
lmac
->
lmac_id
);

1502 i‡(
îr_ty≥
 !
CGX_ERR_NONE
) {

1503 
	`dev_îr
(
dev
, "cgxÖort %d:%d LinkÉrror %d\n",

1504 
cgx
->
cgx_id
, 
lmac
->
lmac_id
, 
îr_ty≥
);

1506 
	`dev_öfo
(
dev
, "cgxÖort %d:%d Link is %s %d Mbps\n",

1507 
cgx
->
cgx_id
, 
lmac
->
lmac_id
,

1508 
löfo
->
lök_up
 ? "UP" : "DOWN",Üöfo->
•ìd
);

1509 
îr
;

1512 i‡(
lmac
->
evít_cb
.
	`nŸify_lök_chg
(&
evít
,Ümac->evít_cb.
d©a
))

1513 
	`dev_îr
(
dev
, "eventÇotification failure\n");

1514 
îr
:

1515 
	`•ö_u∆ock
(&
lmac
->
evít_cb_lock
);

1516 
	}
}

1518 
ölöe
 
boﬁ
 
	$cgx_cmdª•_is_lökevít
(
u64
 
evít
)

1520 
u8
 
id
;

1522 
id
 = 
	`FIELD_GET
(
EVTREG_ID
, 
evít
);

1523 i‡(
id
 =
CGX_CMD_LINK_BRING_UP
 ||

1524 
id
 =
CGX_CMD_LINK_BRING_DOWN
 ||

1525 
id
 =
CGX_CMD_MODE_CHANGE
)

1526  
åue
;

1528  
Ál£
;

1529 
	}
}

1531 
ölöe
 
boﬁ
 
	$cgx_evít_is_lökevít
(
u64
 
evít
)

1533 i‡(
	`FIELD_GET
(
EVTREG_ID
, 
evít
Ë=
CGX_EVT_LINK_CHANGE
)

1534  
åue
;

1536  
Ál£
;

1537 
	}
}

1539 
úqªtu∫_t
 
	$cgx_fwi_evít_h™dÀr
(
úq
, *
d©a
)

1541 
u64
 
evít
, 
off£t
, 
˛ór_bô
;

1542 
lmac
 *lma¯
d©a
;

1543 
cgx
 *cgx;

1545 
cgx
 = 
lmac
->cgx;

1548 
off£t
 = 
cgx
->
mac_›s
->
öt_ªgi°î
;

1549 
˛ór_bô
 = 
cgx
->
mac_›s
->
öt_ía_bô
;

1551 
evít
 = 
	`cgx_ªad
(
cgx
, 
lmac
->
lmac_id
, 
CGX_EVENT_REG
);

1553 i‡(!
	`FIELD_GET
(
EVTREG_ACK
, 
evít
))

1554  
IRQ_NONE
;

1556 
	`FIELD_GET
(
EVTREG_EVT_TYPE
, 
evít
)) {

1557 
CGX_EVT_CMD_RESP
:

1561 
lmac
->
ª•
 = 
evít
;

1563 
	`smp_wmb
();

1568 i‡(
	`cgx_cmdª•_is_lökevít
(
evít
))

1569 
	`cgx_lök_ch™ge_h™dÀr
(
evít
, 
lmac
);

1572 
lmac
->
cmd_≥nd
 = 
Ál£
;

1573 
	`wake_up
(&
lmac
->
wq_cmd_cm∂t
);

1575 
CGX_EVT_ASYNC
:

1576 i‡(
	`cgx_evít_is_lökevít
(
evít
))

1577 
	`cgx_lök_ch™ge_h™dÀr
(
evít
, 
lmac
);

1585 
	`cgx_wrôe
(
lmac
->
cgx
,Ümac->
lmac_id
, 
CGX_EVENT_REG
, 0);

1586 
	`cgx_wrôe
(
lmac
->
cgx
,Ümac->
lmac_id
, 
off£t
, 
˛ór_bô
);

1588  
IRQ_HANDLED
;

1589 
	}
}

1594 
	$cgx_lmac_evh_ªgi°î
(
cgx_evít_cb
 *
cb
, *
cgxd
, 
lmac_id
)

1596 
cgx
 *cgx = 
cgxd
;

1597 
lmac
 *lmac;

1599 
lmac
 = 
	`lmac_pd©a
(
lmac_id
, 
cgx
);

1600 i‡(!
lmac
)

1601  -
ENODEV
;

1603 
lmac
->
evít_cb
 = *
cb
;

1606 
	}
}

1608 
	$cgx_lmac_evh_uƒegi°î
(*
cgxd
, 
lmac_id
)

1610 
lmac
 *lmac;

1611 
Êags
;

1612 
cgx
 *cgx = 
cgxd
;

1614 
lmac
 = 
	`lmac_pd©a
(
lmac_id
, 
cgx
);

1615 i‡(!
lmac
)

1616  -
ENODEV
;

1618 
	`•ö_lock_úqßve
(&
lmac
->
evít_cb_lock
, 
Êags
);

1619 
lmac
->
evít_cb
.
nŸify_lök_chg
 = 
NULL
;

1620 
lmac
->
evít_cb
.
d©a
 = 
NULL
;

1621 
	`•ö_u∆ock_úqª°‹e
(&
lmac
->
evít_cb_lock
, 
Êags
);

1624 
	}
}

1626 
	$cgx_gë_fwd©a_ba£
(
u64
 *
ba£
)

1628 
u64
 
ªq
 = 0, 
ª•
;

1629 
cgx
 *cgx;

1630 
fú°_lmac
;

1631 
îr
;

1633 
cgx
 = 
	`li°_fú°_íåy_‹_nuŒ
(&
cgx_li°
, cgx, cgx_list);

1634 i‡(!
cgx
)

1635  -
ENXIO
;

1637 
fú°_lmac
 = 
	`föd_fú°_bô
(&
cgx
->
lmac_bm≠
, cgx->
max_lmac_≥r_mac
);

1638 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_GET_FWD_BASE
,Ñeq);

1639 
îr
 = 
	`cgx_fwi_cmd_gíîic
(
ªq
, &
ª•
, 
cgx
, 
fú°_lmac
);

1640 i‡(!
îr
)

1641 *
ba£
 = 
	`FIELD_GET
(
RESP_FWD_BASE
, 
ª•
);

1643  
îr
;

1644 
	}
}

1646 
	$cgx_£t_lök_mode
(*
cgxd
, 
cgx_£t_lök_mode_¨gs
 
¨gs
,

1647 
cgx_id
, 
lmac_id
)

1649 
cgx
 *cgx = 
cgxd
;

1650 
u64
 
ªq
 = 0, 
ª•
;

1652 i‡(!
cgx
)

1653  -
ENODEV
;

1655 
	`Ÿx2_m≠_ëhtoﬁ_lök_modes
(
¨gs
.
mode
, &args);

1656 i‡(!
¨gs
.
•ìd
 &&árgs.
du∂ex
 && !¨gs.
™
)

1657  -
EINVAL
;

1659 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_MODE_CHANGE
,Ñeq);

1660 
ªq
 = 
	`FIELD_SET
(
CMDMODECHANGE_SPEED
,

1661 
	`cgx_lök_u£πabÀ_ödex_m≠
(
¨gs
.
•ìd
), 
ªq
);

1662 
ªq
 = 
	`FIELD_SET
(
CMDMODECHANGE_DUPLEX
, 
¨gs
.
du∂ex
,Ñeq);

1663 
ªq
 = 
	`FIELD_SET
(
CMDMODECHANGE_AN
, 
¨gs
.
™
,Ñeq);

1664 
ªq
 = 
	`FIELD_SET
(
CMDMODECHANGE_MODE_BASEIDX
, 
¨gs
.
mode_ba£idx
,Ñeq);

1665 
ªq
 = 
	`FIELD_SET
(
CMDMODECHANGE_FLAGS
, 
¨gs
.
mode
,Ñeq);

1667  
	`cgx_fwi_cmd_gíîic
(
ªq
, &
ª•
, 
cgx
, 
lmac_id
);

1668 
	}
}

1670 
	$cgx_£t_„c
(
u64
 
„c
, 
cgx_id
, 
lmac_id
)

1672 
u64
 
ªq
 = 0, 
ª•
;

1673 
cgx
 *cgx;

1674 
îr
 = 0;

1676 
cgx
 = 
	`cgx_gë_pd©a
(
cgx_id
);

1677 i‡(!
cgx
)

1678  -
ENXIO
;

1680 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_SET_FEC
,Ñeq);

1681 
ªq
 = 
	`FIELD_SET
(
CMDSETFEC
, 
„c
,Ñeq);

1682 
îr
 = 
	`cgx_fwi_cmd_gíîic
(
ªq
, &
ª•
, 
cgx
, 
lmac_id
);

1683 i‡(
îr
)

1684  
îr
;

1686 
cgx
->
lmac_idm≠
[
lmac_id
]->
lök_öfo
.
„c
 =

1687 
	`FIELD_GET
(
RESP_LINKSTAT_FEC
, 
ª•
);

1688  
cgx
->
lmac_idm≠
[
lmac_id
]->
lök_öfo
.
„c
;

1689 
	}
}

1691 
	$cgx_gë_phy_„c_°©s
(*
cgxd
, 
lmac_id
)

1693 
cgx
 *cgx = 
cgxd
;

1694 
u64
 
ªq
 = 0, 
ª•
;

1696 i‡(!
cgx
)

1697  -
ENODEV
;

1699 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_GET_PHY_FEC_STATS
,Ñeq);

1700  
	`cgx_fwi_cmd_gíîic
(
ªq
, &
ª•
, 
cgx
, 
lmac_id
);

1701 
	}
}

1703 
	$cgx_£t_phy_mod_ty≥
(
mod
, *
cgxd
, 
lmac_id
)

1705 
cgx
 *cgx = 
cgxd
;

1706 
u64
 
ªq
 = 0, 
ª•
;

1708 i‡(!
cgx
)

1709  -
ENODEV
;

1711 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_SET_PHY_MOD_TYPE
,Ñeq);

1712 
ªq
 = 
	`FIELD_SET
(
CMDSETPHYMODTYPE
, 
mod
,Ñeq);

1713  
	`cgx_fwi_cmd_gíîic
(
ªq
, &
ª•
, 
cgx
, 
lmac_id
);

1714 
	}
}

1716 
	$cgx_gë_phy_mod_ty≥
(*
cgxd
, 
lmac_id
)

1718 
cgx
 *cgx = 
cgxd
;

1719 
u64
 
ªq
 = 0, 
ª•
;

1720 
îr
;

1722 i‡(!
cgx
)

1723  -
ENODEV
;

1725 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_GET_PHY_MOD_TYPE
,Ñeq);

1726 
îr
 = 
	`cgx_fwi_cmd_gíîic
(
ªq
, &
ª•
, 
cgx
, 
lmac_id
);

1727 i‡(!
îr
)

1728  
	`FIELD_GET
(
RESP_GETPHYMODTYPE
, 
ª•
);

1729  
îr
;

1730 
	}
}

1732 
	$cgx_fwi_lök_ch™ge
(
cgx
 *cgx, 
lmac_id
, 
boﬁ
 
íabÀ
)

1734 
u64
 
ªq
 = 0;

1735 
u64
 
ª•
;

1737 i‡(
íabÀ
) {

1738 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_LINK_BRING_UP
,Ñeq);

1744 i‡(!
	`is_dev_Ωm
(
cgx
))

1745 
ªq
 = 
	`FIELD_SET
(
LINKCFG_TIMEOUT
, 1000,Ñeq);

1747 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_LINK_BRING_DOWN
,Ñeq);

1750  
	`cgx_fwi_cmd_gíîic
(
ªq
, &
ª•
, 
cgx
, 
lmac_id
);

1751 
	}
}

1753 
ölöe
 
	$cgx_fwi_ªad_vîsi⁄
(
u64
 *
ª•
, 
cgx
 *cgx)

1755 
fú°_lmac
 = 
	`föd_fú°_bô
(&
cgx
->
lmac_bm≠
, cgx->
max_lmac_≥r_mac
);

1756 
u64
 
ªq
 = 0;

1758 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_GET_FW_VER
,Ñeq);

1759  
	`cgx_fwi_cmd_gíîic
(
ªq
, 
ª•
, 
cgx
, 
fú°_lmac
);

1760 
	}
}

1762 
	$cgx_lmac_vîify_fwi_vîsi⁄
(
cgx
 *cgx)

1764 
devi˚
 *
dev
 = &
cgx
->
pdev
->dev;

1765 
maj‹_vî
, 
mö‹_vî
;

1766 
u64
 
ª•
;

1767 
îr
;

1769 i‡(!
cgx
->
lmac_cou¡
)

1772 
îr
 = 
	`cgx_fwi_ªad_vîsi⁄
(&
ª•
, 
cgx
);

1773 i‡(
îr
)

1774  
îr
;

1776 
maj‹_vî
 = 
	`FIELD_GET
(
RESP_MAJOR_VER
, 
ª•
);

1777 
mö‹_vî
 = 
	`FIELD_GET
(
RESP_MINOR_VER
, 
ª•
);

1778 
	`dev_dbg
(
dev
, "Firmware command interface version = %d.%d\n",

1779 
maj‹_vî
, 
mö‹_vî
);

1780 i‡(
maj‹_vî
 !
CGX_FIRMWARE_MAJOR_VER
)

1781  -
EIO
;

1784 
	}
}

1786 
	$cgx_lmac_lökup_w‹k
(
w‹k_°ru˘
 *
w‹k
)

1788 
cgx
 *cgx = 
	`c⁄èöî_of
(
w‹k
, cgx, 
cgx_cmd_w‹k
);

1789 
devi˚
 *
dev
 = &
cgx
->
pdev
->dev;

1790 
i
, 
îr
;

1793 
	`f‹_óch_£t_bô
(
i
, &
cgx
->
lmac_bm≠
, cgx->
max_lmac_≥r_mac
) {

1794 
îr
 = 
	`cgx_fwi_lök_ch™ge
(
cgx
, 
i
, 
åue
);

1795 i‡(
îr
)

1796 
	`dev_öfo
(
dev
, "cgxÖort %d:%d Link up command failed\n",

1797 
cgx
->
cgx_id
, 
i
);

1799 
	}
}

1801 
	$cgx_£t_lök_°©e
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

1803 
cgx
 *cgx = 
cgxd
;

1805 i‡(!
cgx
)

1806  -
ENODEV
;

1808  
	`cgx_fwi_lök_ch™ge
(
cgx
, 
lmac_id
, 
íabÀ
);

1809 
	}
}

1810 
EXPORT_SYMBOL
(
cgx_£t_lök_°©e
);

1812 
	$cgx_lmac_lökup_°¨t
(*
cgxd
)

1814 
cgx
 *cgx = 
cgxd
;

1816 i‡(!
cgx
)

1817  -
ENODEV
;

1819 
	`queue_w‹k
(
cgx
->
cgx_cmd_w‹kq
, &cgx->
cgx_cmd_w‹k
);

1822 
	}
}

1824 
	$cgx_lmac_ª£t
(*
cgxd
, 
lmac_id
)

1826 
cgx
 *cgx = 
cgxd
;

1827 
u64
 
cfg
;

1829 i‡(!
	`is_lmac_vÆid
(
cgx
, 
lmac_id
))

1830  -
ENODEV
;

1833 
cfg
 = 0xff;

1834 
	`cgx_wrôe
(
cgxd
, 
lmac_id
, 
CGXX_CMRX_RX_LOGL_XON
, 
cfg
);

1837 
	}
}

1839 
	$cgx_lmac_íadis_higig2
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

1841 
cgx
 *cgx = 
cgxd
;

1842 
u64
 
ªq
 = 0, 
ª•
;

1845 i‡(
íabÀ
) {

1846 
	`cgx_lmac_íadis_8023_∑u£_‰m
(
cgxd
, 
lmac_id
, 
Ál£
, false);

1847 
	`cgx_lmac_íadis_higig2_∑u£_‰m
(
cgxd
, 
lmac_id
, 
åue
,Årue);

1850 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_HIGIG
,Ñeq);

1851 
ªq
 = 
	`FIELD_SET
(
CMDREG_ENABLE
, 
íabÀ
,Ñeq);

1852 
	`cgx_fwi_cmd_gíîic
(
ªq
, &
ª•
, 
cgx
, 
lmac_id
);

1855 i‡(!
íabÀ
) {

1856 
	`cgx_lmac_íadis_higig2_∑u£_‰m
(
cgxd
, 
lmac_id
, 
Ál£
, false);

1857 
	`cgx_lmac_íadis_8023_∑u£_‰m
(
cgxd
, 
lmac_id
, 
åue
,Årue);

1859 
	}
}

1861 
boﬁ
 
	$is_higig2_íabÀd
(*
cgxd
, 
lmac_id
)

1863 
cgx
 *cgx = 
cgxd
;

1864 
u64
 
cfg
;

1866 
cfg
 = 
	`cgx_ªad
(
cgx
, 
lmac_id
, 
CGXX_SMUX_TX_CTL
);

1867  (
cfg
 & 
CGXX_SMUX_TX_CTL_HIGIG_EN
);

1868 
	}
}

1870 
	$cgx_c⁄figuª_öãºu±
(
cgx
 *cgx, 
lmac
 *lmac,

1871 
˙t
, 
boﬁ
 
ªq_‰ì
)

1873 
mac_›s
 *mac_›†
cgx
->mac_ops;

1874 
u64
 
off£t
, 
ía_bô
;

1875 
úq
;

1876 
îr
;

1878 
úq
 = 
	`pci_úq_ve˘‹
(
cgx
->
pdev
, 
mac_›s
->
lmac_fwi
 +

1879 
˙t
 * 
mac_›s
->
úq_off£t
);

1880 
off£t
 = 
mac_›s
->
öt_£t_ªg
;

1881 
ía_bô
 = 
mac_›s
->
öt_ía_bô
;

1883 i‡(
ªq_‰ì
) {

1884 
	`‰ì_úq
(
úq
, 
lmac
);

1888 
îr
 = 
	`ªque°_úq
(
úq
, 
cgx_fwi_evít_h™dÀr
, 0, 
lmac
->
«me
,Ümac);

1889 i‡(
îr
)

1890  
îr
;

1893 
	`cgx_wrôe
(
cgx
, 
lmac
->
lmac_id
, 
off£t
, 
ía_bô
);

1895 
	}
}

1897 
	$cgx_gë_ƒ_lmacs
(*
cgxd
)

1899 
cgx
 *cgx = 
cgxd
;

1901  
	`cgx_ªad
(
cgx
, 0, 
CGXX_CMRX_RX_LMACS
) & 0x7ULL;

1902 
	}
}

1904 
u8
 
	$cgx_gë_lmacid
(*
cgxd
, 
u8
 
lmac_ödex
)

1906 
cgx
 *cgx = 
cgxd
;

1908  
cgx
->
lmac_idm≠
[
lmac_ödex
]->
lmac_id
;

1909 
	}
}

1911 
	$cgx_gë_lmac_bm≠
(*
cgxd
)

1913 
cgx
 *cgx = 
cgxd
;

1915  
cgx
->
lmac_bm≠
;

1916 
	}
}

1918 
	$cgx_lmac_öô
(
cgx
 *cgx)

1920 
lmac
 *lmac;

1921 
u64
 
lmac_li°
;

1922 
i
, 
îr
;

1927 i‡(
cgx
->
mac_›s
->
n⁄_c⁄tiguous_£rdes_œ√
) {

1928 i‡(
	`is_dev_Ωm2
(
cgx
))

1929 
lmac_li°
 =

1930 
	`cgx_ªad
(
cgx
, 0, 
RPM2_CMRX_RX_LMACS
) & 0xFFULL;

1932 
lmac_li°
 =

1933 
	`cgx_ªad
(
cgx
, 0, 
CGXX_CMRX_RX_LMACS
) & 0xFULL;

1936 i‡(
cgx
->
lmac_cou¡
 > cgx->
max_lmac_≥r_mac
)

1937 
cgx
->
lmac_cou¡
 = cgx->
max_lmac_≥r_mac
;

1939 
i
 = 0; i < 
cgx
->
lmac_cou¡
; i++) {

1940 
lmac
 = 
	`kzÆloc
((lmac), 
GFP_KERNEL
);

1941 i‡(!
lmac
)

1942  -
ENOMEM
;

1943 
lmac
->
«me
 = 
	`kˇŒoc
(1, ("cgx_fwi_xxx_yyy"), 
GFP_KERNEL
);

1944 i‡(!
lmac
->
«me
) {

1945 
îr
 = -
ENOMEM
;

1946 
îr_lmac_‰ì
;

1948 
	`•rötf
(
lmac
->
«me
, "cgx_fwi_%d_%d", 
cgx
->
cgx_id
, 
i
);

1949 i‡(
cgx
->
mac_›s
->
n⁄_c⁄tiguous_£rdes_œ√
) {

1950 
lmac
->
lmac_id
 = 
	`__ffs64
(
lmac_li°
);

1951 
lmac_li°
 &~
	`BIT_ULL
(
lmac
->
lmac_id
);

1953 
lmac
->
lmac_id
 = 
i
;

1956 
lmac
->
cgx
 = cgx;

1957 
lmac
->
mac_to_ödex_bm≠
.
max
 =

1958 
cgx
->
mac_›s
->
dmac_fûãr_cou¡
 /

1959 
cgx
->
lmac_cou¡
;

1961 
îr
 = 
	`rvu_Æloc_bôm≠
(&
lmac
->
mac_to_ödex_bm≠
);

1962 i‡(
îr
)

1963 
îr_«me_‰ì
;

1966 
	`£t_bô
(0, 
lmac
->
mac_to_ödex_bm≠
.
bm≠
);

1968 
lmac
->
rx_fc_pfvf_bm≠
.
max
 = 128;

1969 
îr
 = 
	`rvu_Æloc_bôm≠
(&
lmac
->
rx_fc_pfvf_bm≠
);

1970 i‡(
îr
)

1971 
îr_dmac_bm≠_‰ì
;

1973 
lmac
->
tx_fc_pfvf_bm≠
.
max
 = 128;

1974 
îr
 = 
	`rvu_Æloc_bôm≠
(&
lmac
->
tx_fc_pfvf_bm≠
);

1975 i‡(
îr
)

1976 
îr_rx_fc_bm≠_‰ì
;

1978 
	`öô_waôqueue_hód
(&
lmac
->
wq_cmd_cm∂t
);

1979 
	`muãx_öô
(&
lmac
->
cmd_lock
);

1980 
	`•ö_lock_öô
(&
lmac
->
evít_cb_lock
);

1982 
îr
 = 
	`cgx_c⁄figuª_öãºu±
(
cgx
, 
lmac
,Ümac->
lmac_id
, 
Ál£
);

1983 i‡(
îr
)

1984 
îr_bôm≠_‰ì
;

1987 
cgx
->
lmac_idm≠
[
lmac
->
lmac_id
] =Ümac;

1988 
	`£t_bô
(
lmac
->
lmac_id
, &
cgx
->
lmac_bm≠
);

1989 
cgx
->
mac_›s
->
	`mac_∑u£_‰m_c⁄fig
(cgx, 
lmac
->
lmac_id
, 
åue
);

1992  
	`cgx_lmac_vîify_fwi_vîsi⁄
(
cgx
);

1994 
îr_bôm≠_‰ì
:

1995 
	`rvu_‰ì_bôm≠
(&
lmac
->
tx_fc_pfvf_bm≠
);

1996 
îr_rx_fc_bm≠_‰ì
:

1997 
	`rvu_‰ì_bôm≠
(&
lmac
->
rx_fc_pfvf_bm≠
);

1998 
îr_dmac_bm≠_‰ì
:

1999 
	`rvu_‰ì_bôm≠
(&
lmac
->
mac_to_ödex_bm≠
);

2000 
îr_«me_‰ì
:

2001 
	`k‰ì
(
lmac
->
«me
);

2002 
îr_lmac_‰ì
:

2003 
	`k‰ì
(
lmac
);

2004  
îr
;

2005 
	}
}

2007 
	$cgx_lmac_exô
(
cgx
 *cgx)

2009 
lmac
 *lmac;

2010 
i
;

2012 i‡(
cgx
->
cgx_cmd_w‹kq
) {

2013 
	`Êush_w‹kqueue
(
cgx
->
cgx_cmd_w‹kq
);

2014 
	`de°roy_w‹kqueue
(
cgx
->
cgx_cmd_w‹kq
);

2015 
cgx
->
cgx_cmd_w‹kq
 = 
NULL
;

2019 
	`f‹_óch_£t_bô
(
i
, &
cgx
->
lmac_bm≠
, cgx->
max_lmac_≥r_mac
) {

2020 
lmac
 = 
cgx
->
lmac_idm≠
[
i
];

2021 i‡(!
lmac
)

2023 
cgx
->
mac_›s
->
	`mac_∑u£_‰m_c⁄fig
(cgx, 
i
, 
Ál£
);

2024 
	`cgx_c⁄figuª_öãºu±
(
cgx
, 
lmac
,Ümac->
lmac_id
, 
åue
);

2025 
	`k‰ì
(
lmac
->
mac_to_ödex_bm≠
.
bm≠
);

2026 
	`k‰ì
(
lmac
->
«me
);

2027 
	`k‰ì
(
lmac
);

2031 
	}
}

2033 
	$cgx_p›uœã_„©uªs
(
cgx
 *cgx)

2035 
u64
 
cfg
;

2037 
cfg
 = 
	`cgx_ªad
(
cgx
, 0, 
CGX_CONST
);

2038 
cgx
->
mac_›s
->
fifo_Àn
 = 
	`FIELD_GET
(
CGX_CONST_RXFIFO_SIZE
, 
cfg
);

2039 
cgx
->
max_lmac_≥r_mac
 = 
	`FIELD_GET
(
CGX_CONST_MAX_LMACS
, 
cfg
);

2041 i‡(
	`is_dev_Ωm
(
cgx
))

2042 
cgx
->
hw_„©uªs
 = (
RVU_LMAC_FEAT_DMACF
 | 
RVU_MAC_RPM
 |

2043 
RVU_LMAC_FEAT_FC
 | 
RVU_LMAC_FEAT_PTP
);

2045 
cgx
->
hw_„©uªs
 = (
RVU_LMAC_FEAT_FC
 | 
RVU_LMAC_FEAT_HIGIG2
 |

2046 
RVU_LMAC_FEAT_PTP
 | 
RVU_LMAC_FEAT_DMACF
);

2047 
	}
}

2049 
u8
 
	$cgx_gë_rxid_m≠off£t
(
cgx
 *cgx)

2051 i‡(
cgx
->
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CNF10KB_RPM
 ||

2052 
	`is_dev_Ωm2
(
cgx
))

2056 
	}
}

2058 
mac_›s
 
	gcgx_mac_›s
 = {

2059 .
«me
 = "cgx",

2060 .
	gc§_off£t
 = 0,

2061 .
	glmac_off£t
 = 18,

2062 .
	göt_ªgi°î
 = 
CGXX_CMRX_INT
,

2063 .
	göt_£t_ªg
 = 
CGXX_CMRX_INT_ENA_W1S
,

2064 .
	gúq_off£t
 = 9,

2065 .
	göt_ía_bô
 = 
FW_CGX_INT
,

2066 .
	glmac_fwi
 = 
CGX_LMAC_FWI
,

2067 .
	gn⁄_c⁄tiguous_£rdes_œ√
 = 
Ál£
,

2068 .
	grx_°©s_˙t
 = 9,

2069 .
	gtx_°©s_˙t
 = 18,

2070 .
	gdmac_fûãr_cou¡
 = 32,

2071 .
	ggë_ƒ_lmacs
 = 
cgx_gë_ƒ_lmacs
,

2072 .
	ggë_lmac_ty≥
 = 
cgx_gë_lmac_ty≥
,

2073 .
	glmac_fifo_Àn
 = 
cgx_gë_lmac_fifo_Àn
,

2074 .
	gmac_lmac_öé_lbk
 = 
cgx_lmac_öã∫Æ_lo›back
,

2075 .
	gmac_gë_rx_°©s
 = 
cgx_gë_rx_°©s
,

2076 .
	gmac_gë_tx_°©s
 = 
cgx_gë_tx_°©s
,

2077 .
	ggë_„c_°©s
 = 
cgx_gë_„c_°©s
,

2078 .
	gmac_íadis_rx_∑u£_fwdög
 = 
cgx_lmac_íadis_rx_∑u£_fwdög
,

2079 .
	gmac_gë_∑u£_‰m_°©us
 = 
cgx_lmac_gë_∑u£_‰m_°©us
,

2080 .
	gmac_íadis_∑u£_‰m
 = 
cgx_lmac_íadis_∑u£_‰m
,

2081 .
	gmac_∑u£_‰m_c⁄fig
 = 
cgx_lmac_∑u£_‰m_c⁄fig
,

2082 .
	gmac_íadis_±p_c⁄fig
 = 
cgx_lmac_±p_c⁄fig
,

2083 .
	gmac_rx_tx_íabÀ
 = 
cgx_lmac_rx_tx_íabÀ
,

2084 .
	gmac_tx_íabÀ
 = 
cgx_lmac_tx_íabÀ
,

2085 .
	gpfc_c⁄fig
 = 
cgx_lmac_pfc_c⁄fig
,

2086 .
	gmac_gë_pfc_‰m_cfg
 = 
cgx_lmac_gë_pfc_‰m_cfg
,

2087 .
	gmac_ª£t
 = 
cgx_lmac_ª£t
,

2088 .
	ggë_dmacÊt_dr›≥d_pkt˙t
 = 
cgx_gë_dmacÊt_dr›≥d_pkt˙t
,

2091 
	$cgx_¥obe
(
pci_dev
 *
pdev
, c⁄° 
pci_devi˚_id
 *
id
)

2093 
devi˚
 *
dev
 = &
pdev
->dev;

2094 
îr
 = 0, 
nvec
;

2095 
cgx
 *cgx;

2097 
cgx
 = 
	`devm_kzÆloc
(
dev
, (*cgx), 
GFP_KERNEL
);

2098 i‡(!
cgx
)

2099  -
ENOMEM
;

2100 
cgx
->
pdev
 =Ödev;

2102 
	`pci_£t_drvd©a
(
pdev
, 
cgx
);

2105 i‡(
	`is_dev_Ωm
(
cgx
))

2106 
cgx
->
mac_›s
 = 
	`Ωm_gë_mac_›s
(cgx);

2108 
cgx
->
mac_›s
 = &
cgx_mac_›s
;

2110 
cgx
->
mac_›s
->
rxid_m≠_off£t
 = 
	`cgx_gë_rxid_m≠off£t
(cgx);

2112 
îr
 = 
	`pci_íabÀ_devi˚
(
pdev
);

2113 i‡(
îr
) {

2114 
	`dev_îr
(
dev
, "FailedÅoÉnable PCI device\n");

2115 
	`pci_£t_drvd©a
(
pdev
, 
NULL
);

2116  
îr
;

2119 
îr
 = 
	`pci_ªque°_ªgi⁄s
(
pdev
, 
DRV_NAME
);

2120 i‡(
îr
) {

2121 
	`dev_îr
(
dev
, "PCIÑeque°Ñegi⁄†Áûed 0x%x\n", 
îr
);

2122 
îr_dißbÀ_devi˚
;

2126 
cgx
->
ªg_ba£
 = 
	`pcim_iom≠
(
pdev
, 
PCI_CFG_REG_BAR_NUM
, 0);

2127 i‡(!
cgx
->
ªg_ba£
) {

2128 
	`dev_îr
(
dev
, "CGX: Cannot map CSR memory space,áborting\n");

2129 
îr
 = -
ENOMEM
;

2130 
îr_ªÀa£_ªgi⁄s
;

2134 
cgx
->
cgx_id
 = (
	`pci_ªsour˚_°¨t
(
pdev
, 
PCI_CFG_REG_BAR_NUM
) >> 24)

2135 & 
CGX_ID_MASK
;

2138 i‡(!
	`is_cgx_m≠≥d_to_nix
(
pdev
->
subsy°em_devi˚
, 
cgx
->
cgx_id
)) {

2139 
	`dev_nŸi˚
(
dev
, "CGX %dÇŸ m≠≥dÅÿNIX, skùpögÖrobe\n", 
cgx
->
cgx_id
);

2140 
îr_ªÀa£_ªgi⁄s
;

2143 
cgx
->
lmac_cou¡
 = cgx->
mac_›s
->
	`gë_ƒ_lmacs
(cgx);

2144 i‡(!
cgx
->
lmac_cou¡
) {

2145 
	`dev_nŸi˚
(
dev
, "CGX %d LMAC cou¡ i†zîo, skùpögÖrobe\n", 
cgx
->
cgx_id
);

2146 
îr
 = -
EOPNOTSUPP
;

2147 
îr_ªÀa£_ªgi⁄s
;

2150 
nvec
 = 
	`pci_msix_vec_cou¡
(
cgx
->
pdev
);

2152 
îr
 = 
	`pci_Æloc_úq_ve˘‹s
(
pdev
, 
nvec
,Çvec, 
PCI_IRQ_MSIX
);

2153 i‡(
îr
 < 0 ||Éº !
nvec
) {

2154 
	`dev_îr
(
dev
, "Request for %d msix vectors failed,Érr %d\n",

2155 
nvec
, 
îr
);

2156 
îr_ªÀa£_ªgi⁄s
;

2160 
	`INIT_WORK
(&
cgx
->
cgx_cmd_w‹k
, 
cgx_lmac_lökup_w‹k
);

2161 
cgx
->
cgx_cmd_w‹kq
 = 
	`Æloc_w‹kqueue
("cgx_cmd_workq", 0, 0);

2162 i‡(!
cgx
->
cgx_cmd_w‹kq
) {

2163 
	`dev_îr
(
dev
, "alloc workqueue failed for cgx cmd");

2164 
îr
 = -
ENOMEM
;

2165 
îr_‰ì_úq_ve˘‹s
;

2168 
	`li°_add
(&
cgx
->
cgx_li°
, &cgx_list);

2171 
	`cgx_p›uœã_„©uªs
(
cgx
);

2173 
	`muãx_öô
(&
cgx
->
lock
);

2175 
îr
 = 
	`cgx_lmac_öô
(
cgx
);

2176 i‡(
îr
)

2177 
îr_ªÀa£_lmac
;

2181 
îr_ªÀa£_lmac
:

2182 
	`cgx_lmac_exô
(
cgx
);

2183 
	`li°_dñ
(&
cgx
->
cgx_li°
);

2184 
îr_‰ì_úq_ve˘‹s
:

2185 
	`pci_‰ì_úq_ve˘‹s
(
pdev
);

2186 
îr_ªÀa£_ªgi⁄s
:

2187 
	`pci_ªÀa£_ªgi⁄s
(
pdev
);

2188 
îr_dißbÀ_devi˚
:

2189 
	`pci_dißbÀ_devi˚
(
pdev
);

2190 
	`pci_£t_drvd©a
(
pdev
, 
NULL
);

2191  
îr
;

2192 
	}
}

2194 
	$cgx_ªmove
(
pci_dev
 *
pdev
)

2196 
cgx
 *cgx = 
	`pci_gë_drvd©a
(
pdev
);

2198 i‡(!
cgx
)

2201 
	`cgx_lmac_exô
(
cgx
);

2202 
	`li°_dñ
(&
cgx
->
cgx_li°
);

2203 
	`pci_‰ì_úq_ve˘‹s
(
pdev
);

2204 
	`pci_ªÀa£_ªgi⁄s
(
pdev
);

2205 
	`pci_dißbÀ_devi˚
(
pdev
);

2206 
	`pci_£t_drvd©a
(
pdev
, 
NULL
);

2207 
	}
}

2209 
pci_drivî
 
	gcgx_drivî
 = {

2210 .
«me
 = 
DRV_NAME
,

2211 .
	gid_èbÀ
 = 
cgx_id_èbÀ
,

2212 .
	g¥obe
 = 
cgx_¥obe
,

2213 .
	gªmove
 = 
cgx_ªmove
,

	@cgx.h

8 #i‚de‡
CGX_H


9 
	#CGX_H


	)

11 
	~"mbox.h
"

12 
	~"cgx_fw_if.h
"

13 
	~"Ωm.h
"

16 
	#PCI_DEVID_OCTEONTX2_CGX
 0xA059

	)

19 
	#PCI_CFG_REG_BAR_NUM
 0

	)

21 
	#CGX_ID_MASK
 0xF

	)

24 
	#CGXX_CMRX_CFG
 0x00

	)

25 
	#CMR_P2X_SEL_MASK
 
	`GENMASK_ULL
(61, 59)

	)

26 
	#CMR_P2X_SEL_SHIFT
 59ULL

	)

27 
	#CMR_P2X_SEL_NIX0
 1ULL

	)

28 
	#CMR_P2X_SEL_NIX1
 2ULL

	)

29 
	#CMR_EN
 
	`BIT_ULL
(55)

	)

30 
	#DATA_PKT_TX_EN
 
	`BIT_ULL
(53)

	)

31 
	#DATA_PKT_RX_EN
 
	`BIT_ULL
(54)

	)

32 
	#CGX_LMAC_TYPE_SHIFT
 40

	)

33 
	#CGX_LMAC_TYPE_MASK
 0xF

	)

34 
	#CGXX_CMRX_INT
 0x040

	)

35 
	#FW_CGX_INT
 
	`BIT_ULL
(1)

	)

36 
	#CGXX_CMRX_INT_ENA_W1S
 0x058

	)

37 
	#CGXX_CMRX_RX_ID_MAP
 0x060

	)

38 
	#CGXX_CMRX_RX_STAT0
 0x070

	)

39 
	#CGXX_CMRX_RX_STAT4
 0x090

	)

40 
	#CGXX_CMRX_RX_LOGL_XON
 0x100

	)

41 
	#CGXX_CMRX_RX_LMACS
 0x128

	)

42 
	#CGXX_CMRX_RX_DMAC_CTL0
 (0x1F8 + 
mac_›s
->
c§_off£t
)

	)

43 
	#CGX_DMAC_CTL0_CAM_ENABLE
 
	`BIT_ULL
(3)

	)

44 
	#CGX_DMAC_CAM_ACCEPT
 
	`BIT_ULL
(3)

	)

45 
	#CGX_DMAC_MCAST_MODE_CAM
 
	`BIT_ULL
(2)

	)

46 
	#CGX_DMAC_MCAST_MODE
 
	`BIT_ULL
(1)

	)

47 
	#CGX_DMAC_BCAST_MODE
 
	`BIT_ULL
(0)

	)

48 
	#CGXX_CMRX_RX_DMAC_CAM0
 (0x200 + 
mac_›s
->
c§_off£t
)

	)

49 
	#CGX_DMAC_CAM_ADDR_ENABLE
 
	`BIT_ULL
(48)

	)

50 
	#CGX_DMAC_CAM_ENTRY_LMACID
 
	`GENMASK_ULL
(50, 49)

	)

51 
	#CGXX_CMRX_RX_DMAC_CAM1
 0x400

	)

52 
	#CGX_RX_DMAC_ADR_MASK
 
	`GENMASK_ULL
(47, 0)

	)

53 
	#CGXX_CMRX_TX_FIFO_LEN
 0x618

	)

54 
	#CGXX_CMRX_TX_LMAC_IDLE
 
	`BIT_ULL
(14)

	)

55 
	#CGXX_CMRX_TX_LMAC_E_IDLE
 
	`BIT_ULL
(29)

	)

56 
	#CGXX_CMRX_TX_STAT0
 0x700

	)

57 
	#CGXX_SCRATCH0_REG
 0x1050

	)

58 
	#CGXX_SCRATCH1_REG
 0x1058

	)

59 
	#CGX_CONST
 0x2000

	)

60 
	#CGX_CONST_RXFIFO_SIZE
 
	`GENMASK_ULL
(55, 32)

	)

61 
	#CGX_CONST_MAX_LMACS
 
	`GENMASK_ULL
(31, 24)

	)

62 
	#CGXX_SPUX_CONTROL1
 0x10000

	)

63 
	#CGXX_SPUX_LNX_FEC_CORR_BLOCKS
 0x10700

	)

64 
	#CGXX_SPUX_LNX_FEC_UNCORR_BLOCKS
 0x10800

	)

65 
	#CGXX_SPUX_RSFEC_CORR
 0x10088

	)

66 
	#CGXX_SPUX_RSFEC_UNCORR
 0x10090

	)

68 
	#CGXX_SPUX_CONTROL1_LBK
 
	`BIT_ULL
(14)

	)

69 
	#CGXX_GMP_PCS_MRX_CTL
 0x30000

	)

70 
	#CGXX_GMP_PCS_MRX_CTL_LBK
 
	`BIT_ULL
(14)

	)

71 
	#CGXX_SMUX_RX_FRM_CTL
 0x20020

	)

72 
	#CGX_SMUX_RX_FRM_CTL_CTL_BCK
 
	`BIT_ULL
(3)

	)

73 
	#CGX_SMUX_RX_FRM_CTL_PTP_MODE
 
	`BIT_ULL
(12)

	)

74 
	#CGXX_GMP_GMI_RXX_FRM_CTL
 0x38028

	)

75 
	#CGX_GMP_GMI_RXX_FRM_CTL_CTL_BCK
 
	`BIT_ULL
(3)

	)

76 
	#CGX_GMP_GMI_RXX_FRM_CTL_PTP_MODE
 
	`BIT_ULL
(12)

	)

77 
	#CGXX_SMUX_TX_CTL
 0x20178

	)

78 
	#CGXX_SMUX_TX_CTL_HIGIG_EN
 
	`BIT_ULL
(8)

	)

79 
	#CGXX_SMUX_TX_PAUSE_PKT_TIME
 0x20110

	)

80 
	#CGXX_SMUX_TX_PAUSE_PKT_INTERVAL
 0x20120

	)

81 
	#CGXX_SMUX_SMAC
 0x20108

	)

82 
	#CGXX_SMUX_CBFC_CTL
 0x20218

	)

83 
	#CGXX_SMUX_CBFC_CTL_RX_EN
 
	`BIT_ULL
(0)

	)

84 
	#CGXX_SMUX_CBFC_CTL_TX_EN
 
	`BIT_ULL
(1)

	)

85 
	#CGXX_SMUX_CBFC_CTL_DRP_EN
 
	`BIT_ULL
(2)

	)

86 
	#CGXX_SMUX_CBFC_CTL_BCK_EN
 
	`BIT_ULL
(3)

	)

87 
	#CGX_PFC_CLASS_MASK
 
	`GENMASK_ULL
(47, 32)

	)

88 
	#CGXX_SMUX_TX_PAUSE_PKT_HG2_INTRA_EN
 
	`BIT_ULL
(32)

	)

89 
	#HG2_INTRA_INTERVAL
 
	`GENMASK_ULL
(31, 16)

	)

90 
	#CGXX_GMP_GMI_TX_PAUSE_PKT_TIME
 0x38230

	)

91 
	#CGXX_GMP_GMI_TX_PAUSE_PKT_INTERVAL
 0x38248

	)

92 
	#CGX_SMUX_TX_CTL_L2P_BP_CONV
 
	`BIT_ULL
(7)

	)

93 
	#CGXX_CMR_RX_OVR_BP
 0x130

	)

94 
	#CGX_CMR_RX_OVR_BP_EN
(
X
Ë
	`BIT_ULL
(((XË+ 8))

	)

95 
	#CGX_CMR_RX_OVR_BP_BP
(
X
Ë
	`BIT_ULL
(((XË+ 4))

	)

96 
	#CGXX_SMUX_HG2_CONTROL
 0x20210

	)

97 
	#CGXX_SMUX_HG2_CONTROL_TX_ENABLE
 
	`BIT_ULL
(18)

	)

98 
	#CGXX_SMUX_HG2_CONTROL_RX_ENABLE
 
	`BIT_ULL
(17)

	)

100 
	#CGX_COMMAND_REG
 
CGXX_SCRATCH1_REG


	)

101 
	#CGX_EVENT_REG
 
CGXX_SCRATCH0_REG


	)

102 
	#CGX_CMD_TIMEOUT
 5000

	)

103 
	#DEFAULT_PAUSE_TIME
 0x7FF

	)

105 
	#CGX_LMAC_FWI
 0

	)

107 
	ecgx_nix_°©_ty≥
 {

108 
	mNIX_STATS_RX
,

109 
	mNIX_STATS_TX
,

112 
	eLMAC_TYPE
 {

113 
	mLMAC_MODE_SGMII
 = 0,

114 
	mLMAC_MODE_XAUI
 = 1,

115 
	mLMAC_MODE_RXAUI
 = 2,

116 
	mLMAC_MODE_10G_R
 = 3,

117 
	mLMAC_MODE_40G_R
 = 4,

118 
	mLMAC_MODE_QSGMII
 = 6,

119 
	mLMAC_MODE_25G_R
 = 7,

120 
	mLMAC_MODE_50G_R
 = 8,

121 
	mLMAC_MODE_100G_R
 = 9,

122 
	mLMAC_MODE_USXGMII
 = 10,

123 
	mLMAC_MODE_MAX
,

126 
	scgx_lök_evít
 {

127 
cgx_lök_u£r_öfo
 
	mlök_uöfo
;

128 
u8
 
	mcgx_id
;

129 
u8
 
	mlmac_id
;

137 
	scgx_evít_cb
 {

138 (*
	mnŸify_lök_chg
)(
cgx_lök_evít
 *
	mevít
, *
	md©a
);

139 *
	md©a
;

142 
pci_drivî
 
cgx_drivî
;

144 
cgx_gë_cgx˙t_max
();

145 
cgx_gë_cgxid
(*
cgxd
);

146 
cgx_gë_lmac_˙t
(*
cgxd
);

147 *
cgx_gë_pd©a
(
cgx_id
);

148 
cgx_£t_pköd
(*
cgxd
, 
u8
 
lmac_id
, 
pköd
);

149 
cgx_lmac_evh_ªgi°î
(
cgx_evít_cb
 *
cb
, *
cgxd
, 
lmac_id
);

150 
cgx_lmac_evh_uƒegi°î
(*
cgxd
, 
lmac_id
);

151 
cgx_gë_tx_°©s
(*
cgxd
, 
lmac_id
, 
idx
, 
u64
 *
tx_°©
);

152 
cgx_gë_rx_°©s
(*
cgxd
, 
lmac_id
, 
idx
, 
u64
 *
rx_°©
);

153 
cgx_°©s_r°
(*
cgxd
, 
lmac_id
);

154 
u64
 
cgx_gë_lmac_tx_fifo_°©us
(*
cgxd
, 
lmac_id
);

155 
cgx_lmac_rx_tx_íabÀ
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

156 
cgx_lmac_tx_íabÀ
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

157 
cgx_lmac_addr_£t
(
u8
 
cgx_id
, u8 
lmac_id
, u8 *
mac_addr
);

158 
cgx_lmac_addr_ª£t
(
u8
 
cgx_id
, u8 
lmac_id
);

159 
u64
 
cgx_lmac_addr_gë
(
u8
 
cgx_id
, u8 
lmac_id
);

160 
cgx_lmac_addr_add
(
u8
 
cgx_id
, u8 
lmac_id
, u8 *
mac_addr
);

161 
cgx_lmac_addr_dñ
(
u8
 
cgx_id
, u8 
lmac_id
, u8 
ödex
);

162 
cgx_lmac_addr_max_íåõs_gë
(
u8
 
cgx_id
, u8 
lmac_id
);

163 
cgx_lmac_¥omisc_c⁄fig
(
cgx_id
, 
lmac_id
, 
boﬁ
 
íabÀ
);

164 
cgx_lmac_íadis_rx_∑u£_fwdög
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

165 
cgx_lmac_öã∫Æ_lo›back
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

166 
cgx_gë_lök_öfo
(*
cgxd
, 
lmac_id
,

167 
cgx_lök_u£r_öfo
 *
löfo
);

168 
cgx_lmac_lökup_°¨t
(*
cgxd
);

169 
cgx_gë_fwd©a_ba£
(
u64
 *
ba£
);

170 
cgx_lmac_gë_∑u£_‰m_°©us
(*
cgxd
, 
lmac_id
,

171 
u8
 *
tx_∑u£
, u8 *
rx_∑u£
);

172 
cgx_lmac_íadis_∑u£_‰m
(*
cgxd
, 
lmac_id
,

173 
u8
 
tx_∑u£
, u8 
rx_∑u£
);

174 
cgx_lmac_∑u£_‰m_c⁄fig
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

175 
cgx_lmac_±p_c⁄fig
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

176 
cgx_£t_lök_°©e
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

177 
cgx_£t_phy_mod_ty≥
(
mod
, *
cgxd
, 
lmac_id
);

178 
cgx_gë_phy_mod_ty≥
(*
cgxd
, 
lmac_id
);

179 
cgx_lmac_íadis_higig2
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

180 
boﬁ
 
is_higig2_íabÀd
(*
cgxd
, 
lmac_id
);

181 
cgx_gë_pköd
(*
cgxd
, 
u8
 
lmac_id
, *
pköd
);

182 
u8
 
cgx_lmac_gë_p2x
(
cgx_id
, 
lmac_id
);

183 
cgx_£t_„c
(
u64
 
„c
, 
cgx_id
, 
lmac_id
);

184 
cgx_gë_„c_°©s
(*
cgxd
, 
lmac_id
, 
cgx_„c_°©s_r•
 *
r•
);

185 
cgx_gë_phy_„c_°©s
(*
cgxd
, 
lmac_id
);

186 
cgx_£t_lök_mode
(*
cgxd
, 
cgx_£t_lök_mode_¨gs
 
¨gs
,

187 
cgx_id
, 
lmac_id
);

188 
u64
 
cgx_„©uªs_gë
(*
cgxd
);

189 
mac_›s
 *
gë_mac_›s
(*
cgxd
);

190 
cgx_gë_ƒ_lmacs
(*
cgxd
);

191 
cgx_lmac_wrôe
(
cgx_id
, 
lmac_id
, 
u64
 
off£t
, u64 
vÆ
);

192 
u64
 
cgx_lmac_ªad
(
cgx_id
, 
lmac_id
, u64 
off£t
);

193 
u8
 
cgx_gë_lmac_ty≥
(*
cgx
, 
lmac_id
);

194 
u8
 
cgx_gë_lmacid
(*
cgxd
, u8 
lmac_ödex
);

195 
cgx_gë_lmac_bm≠
(*
cgxd
);

196 
u64
 
cgx_ªad_dmac_˘æ
(*
cgxd
, 
lmac_id
);

197 
u64
 
cgx_ªad_dmac_íåy
(*
cgxd
, 
ödex
);

198 
cgx_lmac_addr_upd©e
(
u8
 
cgx_id
, u8 
lmac_id
, u8 *
mac_addr
, u8 
ödex
);

199 
cgx_lmac_pfc_c⁄fig
(*
cgxd
, 
lmac_id
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
,

200 
u16
 
pfc_í
);

201 
cgx_lmac_gë_pfc_‰m_cfg
(*
cgxd
, 
lmac_id
, 
u8
 *
tx_∑u£
,

202 
u8
 *
rx_∑u£
);

203 
vîify_lmac_fc_cfg
(*
cgxd
, 
lmac_id
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
,

204 
pfvf_idx
);

205 
cgx_lmac_ª£t
(*
cgxd
, 
lmac_id
);

206 
u64
 
cgx_gë_dmacÊt_dr›≥d_pkt˙t
(*
cgx
, 
lmac_id
);

	@cgx_fw_if.h

8 #i‚de‡
__CGX_FW_INTF_H__


9 
	#__CGX_FW_INTF_H__


	)

11 
	~<löux/bô›s.h
>

12 
	~<löux/bôfõld.h
>

18 
	#CGX_FIRMWARE_MAJOR_VER
 1

	)

19 
	#CGX_FIRMWARE_MINOR_VER
 0

	)

21 
	#CGX_EVENT_ACK
 1UL

	)

24 
	ecgx_îr‹_ty≥
 {

25 
	mCGX_ERR_NONE
,

26 
	mCGX_ERR_LMAC_NOT_ENABLED
,

27 
	mCGX_ERR_LMAC_MODE_INVALID
,

28 
	mCGX_ERR_REQUEST_ID_INVALID
,

29 
	mCGX_ERR_PREV_ACK_NOT_CLEAR
,

30 
	mCGX_ERR_PHY_LINK_DOWN
,

31 
	mCGX_ERR_PCS_RESET_FAIL
,

32 
	mCGX_ERR_AN_CPT_FAIL
,

33 
	mCGX_ERR_TX_NOT_IDLE
,

34 
	mCGX_ERR_RX_NOT_IDLE
,

35 
	mCGX_ERR_SPUX_BR_BLKLOCK_FAIL
,

36 
	mCGX_ERR_SPUX_RX_ALIGN_FAIL
,

37 
	mCGX_ERR_SPUX_TX_FAULT
,

38 
	mCGX_ERR_SPUX_RX_FAULT
,

39 
	mCGX_ERR_SPUX_RESET_FAIL
,

40 
	mCGX_ERR_SPUX_AN_RESET_FAIL
,

41 
	mCGX_ERR_SPUX_USX_AN_RESET_FAIL
,

42 
	mCGX_ERR_SMUX_RX_LINK_NOT_OK
,

43 
	mCGX_ERR_PCS_RECV_LINK_FAIL
,

44 
	mCGX_ERR_TRAINING_FAIL
,

45 
	mCGX_ERR_RX_EQU_FAIL
,

46 
	mCGX_ERR_SPUX_BER_FAIL
,

47 
	mCGX_ERR_SPUX_RSFEC_ALGN_FAIL
,

48 
	mCGX_ERR_SPUX_MARKER_LOCK_FAIL
,

49 
	mCGX_ERR_SET_FEC_INVALID
,

50 
	mCGX_ERR_SET_FEC_FAIL
,

51 
	mCGX_ERR_MODULE_INVALID
,

52 
	mCGX_ERR_MODULE_NOT_PRESENT
,

53 
	mCGX_ERR_SPEED_CHANGE_INVALID
,

57 
	ecgx_lök_•ìd
 {

58 
	mCGX_LINK_NONE
,

59 
	mCGX_LINK_10M
,

60 
	mCGX_LINK_100M
,

61 
	mCGX_LINK_1G
,

62 
	mCGX_LINK_2HG
,

63 
	mCGX_LINK_5G
,

64 
	mCGX_LINK_10G
,

65 
	mCGX_LINK_20G
,

66 
	mCGX_LINK_25G
,

67 
	mCGX_LINK_40G
,

68 
	mCGX_LINK_50G
,

69 
	mCGX_LINK_80G
,

70 
	mCGX_LINK_100G
,

71 
	mCGX_LINK_SPEED_MAX
,

74 
	eCGX_MODE_
 {

75 
	mCGX_MODE_SGMII
,

76 
	mCGX_MODE_1000_BASEX
,

77 
	mCGX_MODE_QSGMII
,

78 
	mCGX_MODE_10G_C2C
,

79 
	mCGX_MODE_10G_C2M
,

80 
	mCGX_MODE_10G_KR
,

81 
	mCGX_MODE_20G_C2C
,

82 
	mCGX_MODE_25G_C2C
,

83 
	mCGX_MODE_25G_C2M
,

84 
	mCGX_MODE_25G_2_C2C
,

85 
	mCGX_MODE_25G_CR
,

86 
	mCGX_MODE_25G_KR
,

87 
	mCGX_MODE_40G_C2C
,

88 
	mCGX_MODE_40G_C2M
,

89 
	mCGX_MODE_40G_CR4
,

90 
	mCGX_MODE_40G_KR4
,

91 
	mCGX_MODE_40GAUI_C2C
,

92 
	mCGX_MODE_50G_C2C
,

93 
	mCGX_MODE_50G_C2M
,

94 
	mCGX_MODE_50G_4_C2C
,

95 
	mCGX_MODE_50G_CR
,

96 
	mCGX_MODE_50G_KR
,

97 
	mCGX_MODE_80GAUI_C2C
,

98 
	mCGX_MODE_100G_C2C
,

99 
	mCGX_MODE_100G_C2M
,

100 
	mCGX_MODE_100G_CR4
,

101 
	mCGX_MODE_100G_KR4
,

102 
	mCGX_MODE_LAUI_2_C2C_BIT
,

103 
	mCGX_MODE_LAUI_2_C2M_BIT
,

104 
	mCGX_MODE_50GBASE_CR2_C_BIT
,

105 
	mCGX_MODE_50GBASE_KR2_C_BIT
,

106 
	mCGX_MODE_100GAUI_2_C2C_BIT
,

107 
	mCGX_MODE_100GAUI_2_C2M_BIT
,

108 
	mCGX_MODE_100GBASE_CR2_BIT
,

109 
	mCGX_MODE_100GBASE_KR2_BIT
,

110 
	mCGX_MODE_SFI_1G_BIT
,

111 
	mCGX_MODE_25GBASE_CR_C_BIT
,

112 
	mCGX_MODE_25GBASE_KR_C_BIT
,

113 
	mCGX_MODE_MAX


117 
	ecgx_cmd_id
 {

118 
	mCGX_CMD_NONE
,

119 
	mCGX_CMD_GET_FW_VER
,

120 
	mCGX_CMD_GET_MAC_ADDR
,

121 
	mCGX_CMD_SET_MTU
,

122 
	mCGX_CMD_GET_LINK_STS
,

123 
	mCGX_CMD_LINK_BRING_UP
,

124 
	mCGX_CMD_LINK_BRING_DOWN
,

125 
	mCGX_CMD_INTERNAL_LBK
,

126 
	mCGX_CMD_EXTERNAL_LBK
,

127 
	mCGX_CMD_HIGIG
,

128 
	mCGX_CMD_LINK_STAT_CHANGE
,

129 
	mCGX_CMD_MODE_CHANGE
,

130 
	mCGX_CMD_INTF_SHUTDOWN
,

131 
	mCGX_CMD_GET_MKEX_PRFL_SIZE
,

132 
	mCGX_CMD_GET_MKEX_PRFL_ADDR
,

133 
	mCGX_CMD_GET_FWD_BASE
,

134 
	mCGX_CMD_GET_LINK_MODES
,

135 
	mCGX_CMD_SET_LINK_MODE
,

136 
	mCGX_CMD_GET_SUPPORTED_FEC
,

137 
	mCGX_CMD_SET_FEC
,

138 
	mCGX_CMD_GET_AN
,

139 
	mCGX_CMD_SET_AN
,

140 
	mCGX_CMD_GET_ADV_LINK_MODES
,

141 
	mCGX_CMD_GET_ADV_FEC
,

142 
	mCGX_CMD_GET_PHY_MOD_TYPE
,

143 
	mCGX_CMD_SET_PHY_MOD_TYPE
,

144 
	mCGX_CMD_PRBS
,

145 
	mCGX_CMD_DISPLAY_EYE
,

146 
	mCGX_CMD_GET_PHY_FEC_STATS
,

150 
	ecgx_evt_id
 {

151 
	mCGX_EVT_NONE
,

152 
	mCGX_EVT_LINK_CHANGE
,

156 
	ecgx_evt_ty≥
 {

157 
	mCGX_EVT_ASYNC
,

158 
	mCGX_EVT_CMD_RESP


161 
	ecgx_°©
 {

162 
	mCGX_STAT_SUCCESS
,

163 
	mCGX_STAT_FAIL


166 
	ecgx_cmd_own
 {

167 
	mCGX_CMD_OWN_NS
,

168 
	mCGX_CMD_OWN_FIRMWARE
,

175 
	#FIELD_SET
(
m
, 
y
, 
x
) \

176 (((
x
Ë& ~(
m
)) | \

177 
	`FIELD_PREP
((
m
), (
y
)))

	)

183 
	#EVTREG_ACK
 
	`BIT_ULL
(0)

	)

184 
	#EVTREG_EVT_TYPE
 
	`BIT_ULL
(1)

	)

185 
	#EVTREG_STAT
 
	`BIT_ULL
(2)

	)

186 
	#EVTREG_ID
 
	`GENMASK_ULL
(8, 3)

	)

193 
	#EVTREG_ERRTYPE
 
	`GENMASK_ULL
(18, 9)

	)

198 
	#RESP_MAJOR_VER
 
	`GENMASK_ULL
(12, 9)

	)

199 
	#RESP_MINOR_VER
 
	`GENMASK_ULL
(16, 13)

	)

204 
	#RESP_MAC_ADDR
 
	`GENMASK_ULL
(56, 9)

	)

209 
	#RESP_MKEX_PRFL_SIZE
 
	`GENMASK_ULL
(63, 9)

	)

214 
	#RESP_MKEX_PRFL_ADDR
 
	`GENMASK_ULL
(63, 9)

	)

219 
	#RESP_FWD_BASE
 
	`GENMASK_ULL
(56, 9)

	)

231 
	scgx_ k_°s
 {

232 
uöt64_t
 
	mª£rved1
:9;

233 
uöt64_t
 
	mlök_up
:1;

234 
uöt64_t
 
	mfuŒ_du∂ex
:1;

235 
uöt64_t
 
	m•ìd
:4;

236 
uöt64_t
 
	mîr_ty≥
:10;

237 
uöt64_t
 
	m™
:1;

238 
uöt64_t
 
	m„c
:2;

239 
uöt64_t
 
	mlmac_ty≥
:8;

240 
uöt64_t
 
	mmode
:8;

241 
uöt64_t
 
	mª£rved2
:20;

244 
	#RESP_LINKSTAT_UP
 
	`GENMASK_ULL
(9, 9)

	)

245 
	#RESP_LINKSTAT_FDUPLEX
 
	`GENMASK_ULL
(10, 10)

	)

246 
	#RESP_LINKSTAT_SPEED
 
	`GENMASK_ULL
(14, 11)

	)

247 
	#RESP_LINKSTAT_ERRTYPE
 
	`GENMASK_ULL
(24, 15)

	)

248 
	#RESP_LINKSTAT_AN
 
	`GENMASK_ULL
(25, 25)

	)

249 
	#RESP_LINKSTAT_FEC
 
	`GENMASK_ULL
(27, 26)

	)

250 
	#RESP_LINKSTAT_LMAC_TYPE
 
	`GENMASK_ULL
(35, 28)

	)

255 
	#CMDREG_OWN
 
	`BIT_ULL
(0)

	)

256 
	#CMDREG_ID
 
	`GENMASK_ULL
(7, 2)

	)

262 
	#CMDREG_ENABLE
 
	`BIT_ULL
(8)

	)

265 
	#CMDMTU_SIZE
 
	`GENMASK_ULL
(23, 8)

	)

268 
	#CMDLINKCHANGE_LINKUP
 
	`BIT_ULL
(8)

	)

269 
	#CMDLINKCHANGE_FULLDPLX
 
	`BIT_ULL
(9)

	)

270 
	#CMDLINKCHANGE_SPEED
 
	`GENMASK_ULL
(13, 10)

	)

272 
	#CMDSETFEC
 
	`GENMASK_ULL
(9, 8)

	)

274 
	#CMDMODECHANGE_SPEED
 
	`GENMASK_ULL
(11, 8)

	)

275 
	#CMDMODECHANGE_DUPLEX
 
	`GENMASK_ULL
(12, 12)

	)

276 
	#CMDMODECHANGE_AN
 
	`GENMASK_ULL
(13, 13)

	)

282 
	#CMDMODECHANGE_MODE_BASEIDX
 
	`GENMASK_ULL
(21, 20)

	)

283 
	#CMDMODECHANGE_FLAGS
 
	`GENMASK_ULL
(63, 22)

	)

286 
	#CMDSETPHYMODTYPE
 
	`GENMASK_ULL
(8, 8)

	)

289 
	#RESP_GETPHYMODTYPE
 
	`GENMASK_ULL
(9, 9)

	)

292 
	#LINKCFG_TIMEOUT
 
	`GENMASK_ULL
(21, 8)

	)

	@common.h

7 #i‚de‡
COMMON_H


8 
	#COMMON_H


	)

10 
	~"rvu_°ru˘.h
"

12 
	#OTX2_ALIGN
 128

	)

14 
	#Q_SIZE_16
 0ULL

	)

15 
	#Q_SIZE_64
 1ULL

	)

16 
	#Q_SIZE_256
 2ULL

	)

17 
	#Q_SIZE_1K
 3ULL

	)

18 
	#Q_SIZE_4K
 4ULL

	)

19 
	#Q_SIZE_16K
 5ULL

	)

20 
	#Q_SIZE_64K
 6ULL

	)

21 
	#Q_SIZE_256K
 7ULL

	)

22 
	#Q_SIZE_1M
 8ULL

	)

23 
	#Q_SIZE_MIN
 
Q_SIZE_16


	)

24 
	#Q_SIZE_MAX
 
Q_SIZE_1M


	)

26 
	#Q_COUNT
(
x
Ë(16ULL << (2 * x))

	)

27 
	#Q_SIZE
(
x
, 
n
Ë((
	`ûog2
(xË- (n)Ë/ 2)

	)

34 
	#AQ_SIZE
 
Q_SIZE_16


	)

36 
	#AQ_PTR_MASK
 0xFFFFF

	)

38 
	sqmem
 {

39 *
	mba£
;

40 
dma_addr_t
 
	miova
;

41 
	mÆloc_sz
;

42 
u16
 
	míåy_sz
;

43 
u8
 
	mÆign
;

44 
u32
 
	mqsize
;

47 
ölöe
 
	$qmem_Æloc
(
devi˚
 *
dev
, 
qmem
 **
q
,

48 
qsize
, 
íåy_sz
)

50 
qmem
 *qmem;

51 
Æig√d_addr
;

53 i‡(!
qsize
)

54  -
EINVAL
;

56 *
q
 = 
	`devm_kzÆloc
(
dev
, (*
qmem
), 
GFP_KERNEL
);

57 i‡(!*
q
)

58  -
ENOMEM
;

59 
qmem
 = *
q
;

61 
qmem
->
íåy_sz
 =Éntry_sz;

62 
qmem
->
Æloc_sz
 = (
qsize
 * 
íåy_sz
Ë+ 
OTX2_ALIGN
;

63 
qmem
->
ba£
 = 
	`dma_Æloc_©ås
(
dev
, qmem->
Æloc_sz
, &qmem->
iova
,

64 
GFP_ATOMIC
, 
DMA_ATTR_FORCE_CONTIGUOUS
);

65 i‡(!
qmem
->
ba£
)

66  -
ENOMEM
;

68 
qmem
->
qsize
 = qsize;

70 
Æig√d_addr
 = 
	`ALIGN
((
u64
)
qmem
->
iova
, 
OTX2_ALIGN
);

71 
qmem
->
Æign
 = (
Æig√d_addr
 - qmem->
iova
);

72 
qmem
->
ba£
 +qmem->
Æign
;

73 
qmem
->
iova
 +qmem->
Æign
;

75 
	}
}

77 
ölöe
 
	$qmem_‰ì
(
devi˚
 *
dev
, 
qmem
 *qmem)

79 i‡(!
qmem
)

82 i‡(
qmem
->
ba£
)

83 
	`dma_‰ì_©ås
(
dev
, 
qmem
->
Æloc_sz
,

84 
qmem
->
ba£
 - qmem->
Æign
,

85 
qmem
->
iova
 - qmem->
Æign
,

86 
DMA_ATTR_FORCE_CONTIGUOUS
);

87 
	`devm_k‰ì
(
dev
, 
qmem
);

88 
	}
}

90 
	sadmö_queue
 {

91 
qmem
 *
	mö°
;

92 
qmem
 *
	mªs
;

93 
•ölock_t
 
	mlock
;

97 
	e≈a_auø_sz
 {

98 
	mNPA_AURA_SZ_0
,

99 
	mNPA_AURA_SZ_128
,

100 
	mNPA_AURA_SZ_256
,

101 
	mNPA_AURA_SZ_512
,

102 
	mNPA_AURA_SZ_1K
,

103 
	mNPA_AURA_SZ_2K
,

104 
	mNPA_AURA_SZ_4K
,

105 
	mNPA_AURA_SZ_8K
,

106 
	mNPA_AURA_SZ_16K
,

107 
	mNPA_AURA_SZ_32K
,

108 
	mNPA_AURA_SZ_64K
,

109 
	mNPA_AURA_SZ_128K
,

110 
	mNPA_AURA_SZ_256K
,

111 
	mNPA_AURA_SZ_512K
,

112 
	mNPA_AURA_SZ_1M
,

113 
	mNPA_AURA_SZ_MAX
,

116 
	#NPA_AURA_COUNT
(
x
Ë(1ULL << ((xË+ 6))

	)

119 
	s≈a_aq_auø_ªs
 {

120 
≈a_aq_ªs_s
 
	mªs
;

121 
≈a_auø_s
 
	mauø_˘x
;

122 
≈a_auø_s
 
	m˘x_mask
;

126 
	s≈a_aq_poﬁ_ªs
 {

127 
≈a_aq_ªs_s
 
	mªs
;

128 
≈a_poﬁ_s
 
	mpoﬁ_˘x
;

129 
≈a_poﬁ_s
 
	m˘x_mask
;

133 
	enix_scheduÀr
 {

134 
	mNIX_TXSCH_LVL_SMQ
 = 0x0,

135 
	mNIX_TXSCH_LVL_MDQ
 = 0x0,

136 
	mNIX_TXSCH_LVL_TL4
 = 0x1,

137 
	mNIX_TXSCH_LVL_TL3
 = 0x2,

138 
	mNIX_TXSCH_LVL_TL2
 = 0x3,

139 
	mNIX_TXSCH_LVL_TL1
 = 0x4,

140 
	mNIX_TXSCH_LVL_CNT
 = 0x5,

143 
	#TXSCH_RR_QTM_MAX
 ((1 << 24Ë- 1)

	)

144 
	#TXSCH_TL1_DFLT_RR_QTM
 
TXSCH_RR_QTM_MAX


	)

145 
	#TXSCH_TL1_DFLT_RR_PRIO
 (0x7uŒ)

	)

146 
	#CN10K_MAX_DWRR_WEIGHT
 16384

	)

151 
	#SMQ_LINK_TYPE_RPM
 0

	)

152 
	#SMQ_LINK_TYPE_SDP
 1

	)

153 
	#SMQ_LINK_TYPE_LBK
 2

	)

156 
	#NIC_HW_MIN_FRS
 40

	)

157 
	#NIC_HW_MAX_FRS
 9212

	)

158 
	#SDP_HW_MAX_FRS
 65535

	)

159 
	#CN10K_LMAC_LINK_MAX_FRS
 16380

	)

160 
	#CN10K_LBK_LINK_MAX_FRS
 65535

	)

163 
	#NIX_RX_ACTIONOP_DROP
 (0x0uŒ)

	)

164 
	#NIX_RX_ACTIONOP_UCAST
 (0x1uŒ)

	)

165 
	#NIX_RX_ACTIONOP_UCAST_IPSEC
 (0x2uŒ)

	)

166 
	#NIX_RX_ACTIONOP_MCAST
 (0x3uŒ)

	)

167 
	#NIX_RX_ACTIONOP_RSS
 (0x4uŒ)

	)

169 
	#NIX_RX_ACTION_DEFAULT
 (0xfuŒ)

	)

172 
	#NIX_TX_ACTIONOP_DROP
 (0x0uŒ)

	)

173 
	#NIX_TX_ACTIONOP_UCAST_DEFAULT
 (0x1uŒ)

	)

174 
	#NIX_TX_ACTIONOP_UCAST_CHAN
 (0x2uŒ)

	)

175 
	#NIX_TX_ACTIONOP_MCAST
 (0x3uŒ)

	)

176 
	#NIX_TX_ACTIONOP_DROP_VIOL
 (0x5uŒ)

	)

178 
	#NPC_MCAM_KEY_X1
 0

	)

179 
	#NPC_MCAM_KEY_X2
 1

	)

180 
	#NPC_MCAM_KEY_X4
 2

	)

182 
	#NIX_INTFX_RX
(
a
Ë(0x0uŒ | (aË<< 1)

	)

183 
	#NIX_INTFX_TX
(
a
Ë(0x1uŒ | (aË<< 1)

	)

186 
	#NIX_INTF_RX
 
	`NIX_INTFX_RX
(0)

	)

187 
	#NIX_INTF_TX
 
	`NIX_INTFX_TX
(0)

	)

189 
	#NIX_INTF_TYPE_CGX
 0

	)

190 
	#NIX_INTF_TYPE_LBK
 1

	)

191 
	#NIX_INTF_TYPE_SDP
 2

	)

193 
	#MAX_LMAC_PKIND
 12

	)

194 
	#NIX_LINK_CGX_LMAC
(
a
, 
b
Ë(0 + 4 * (aË+ (b))

	)

195 
	#NIX_LINK_LBK
(
a
Ë(12 + (a))

	)

196 
	#NIX_CHAN_CGX_LMAC_CHX
(
a
, 
b
, 
c
Ë(0x800 + 0x100 * (aË+ 0x10 * (bË+ (c))

	)

197 
	#NIX_CHAN_LBK_CHX
(
a
, 
b
Ë(0 + 0x100 * (aË+ (b))

	)

198 
	#NIX_CHAN_SDP_CH_START
 (0x700uŒ)

	)

199 
	#NIX_CHAN_SDP_CHX
(
a
Ë(
NIX_CHAN_SDP_CH_START
 + (a))

	)

200 
	#NIX_CHAN_SDP_NUM_CHANS
 256

	)

201 
	#NIX_CHAN_CPT_CH_START
 (0x800uŒ)

	)

206 
	#NIX_CHAN_CPT_X2P_MASK
 (0x3ffuŒ)

	)

211 
	#NIX_LSO_FORMAT_IDX_TSOV4
 0

	)

212 
	#NIX_LSO_FORMAT_IDX_TSOV6
 1

	)

215 
	#MAX_RSS_GROUPS
 8

	)

220 
	#DEFAULT_RSS_CONTEXT_GROUP
 0

	)

221 
	#MAX_RSS_INDIR_TBL_SIZE
 256

	)

224 
	endc_idx_e
 {

225 
	mNIX0_RX
 = 0x0,

226 
	mNIX0_TX
 = 0x1,

227 
	mNPA0_U
 = 0x2,

228 
	mNIX1_RX
 = 0x4,

229 
	mNIX1_TX
 = 0x5,

232 
	endc_˘y≥_e
 {

233 
	mCACHING
 = 0x0,

234 
	mBYPASS
 = 0x1,

237 
	#NDC_MAX_PORT
 6

	)

238 
	#NDC_READ_TRANS
 0

	)

239 
	#NDC_WRITE_TRANS
 1

	)

242 
	#SSO_FLUSH_TMO_MAX
 60000

	)

	@lmac_common.h

8 
	~"rvu.h
"

9 
	~"cgx.h
"

28 
	slmac
 {

29 
waô_queue_hód_t
 
	mwq_cmd_cm∂t
;

31 
muãx
 
	mcmd_lock
;

32 
u64
 
	mª•
;

33 
cgx_lök_u£r_öfo
 
	mlök_öfo
;

34 
r§c_bm≠
 
	mmac_to_ödex_bm≠
;

35 
r§c_bm≠
 
	mrx_fc_pfvf_bm≠
;

36 
r§c_bm≠
 
	mtx_fc_pfvf_bm≠
;

37 
cgx_evít_cb
 
	mevít_cb
;

39 
•ölock_t
 
	mevít_cb_lock
;

40 
cgx
 *
	mcgx
;

41 
u8
 
	mmˇ°_fûãrs_cou¡
;

42 
u8
 
	mlmac_id
;

43 
boﬁ
 
	mcmd_≥nd
;

44 *
	m«me
;

50 
	smac_›s
 {

51 *
	m«me
;

57 
u64
 
	mc§_off£t
;

63 
u64
 
	möt_ªgi°î
;

64 
u64
 
	möt_£t_ªg
;

66 
u8
 
	mlmac_off£t
;

67 
u8
 
	múq_off£t
;

68 
u8
 
	möt_ía_bô
;

69 
u8
 
	mlmac_fwi
;

70 
u32
 
	mfifo_Àn
;

71 
boﬁ
 
	mn⁄_c⁄tiguous_£rdes_œ√
;

73 
u8
 
	mrx_°©s_˙t
;

74 
u8
 
	mtx_°©s_˙t
;

78 
u64
 
	mrxid_m≠_off£t
;

79 
u8
 
	mdmac_fûãr_cou¡
;

85 (*
	mgë_ƒ_lmacs
)(*
	mcgx
);

86 
u8
 (*
gë_lmac_ty≥
)(*
	mcgx
, 
	mlmac_id
);

87 
u32
 (*
lmac_fifo_Àn
)(*
	mcgx
, 
	mlmac_id
);

88 (*
	mmac_lmac_öé_lbk
)(*
	mcgx
, 
	mlmac_id
,

89 
boﬁ
 
	míabÀ
);

91 (*
	mmac_gë_rx_°©s
)(*
	mcgx
, 
	mlmac_id
,

92 
	midx
, 
u64
 *
	mrx_°©
);

93 (*
	mmac_gë_tx_°©s
)(*
	mcgx
, 
	mlmac_id
,

94 
	midx
, 
u64
 *
	mtx_°©
);

96 (*
	mmac_íadis_rx_∑u£_fwdög
)(*
	mcgxd
,

97 
	mlmac_id
,

98 
boﬁ
 
	míabÀ
);

99 (*
	mmac_gë_∑u£_‰m_°©us
)(*
	mcgxd
,

100 
	mlmac_id
,

101 
u8
 *
	mtx_∑u£
,

102 
u8
 *
	mrx_∑u£
);

103 (*
	mmac_íadis_∑u£_‰m
)(*
	mcgxd
,

104 
	mlmac_id
,

105 
u8
 
	mtx_∑u£
,

106 
u8
 
	mrx_∑u£
);

107 (*
	mmac_∑u£_‰m_c⁄fig
)(*
	mcgxd
,

108 
	mlmac_id
,

109 
boﬁ
 
	míabÀ
);

111 (*
	mmac_íadis_±p_c⁄fig
)(*
	mcgxd
,

112 
	mlmac_id
,

113 
boﬁ
 
	míabÀ
);

114 (*
	mmac_rx_tx_íabÀ
)(*
	mcgxd
, 
	mlmac_id
, 
boﬁ
 
	míabÀ
);

115 (*
	mmac_tx_íabÀ
)(*
	mcgxd
, 
	mlmac_id
, 
boﬁ
 
	míabÀ
);

117 (*
	mpfc_c⁄fig
)(*
	mcgxd
, 
	mlmac_id
,

118 
u8
 
	mtx_∑u£
, u8 
	mrx_∑u£
, 
u16
 
	mpfc_í
);

120 (*
	mmac_gë_pfc_‰m_cfg
)(*
	mcgxd
, 
	mlmac_id
,

121 
u8
 *
	mtx_∑u£
, u8 *
	mrx_∑u£
);

122 (*
	mmac_ª£t
)(*
	mcgxd
, 
	mlmac_id
);

123 
u64
 (*
gë_dmacÊt_dr›≥d_pkt˙t
)(*
	mcgxd
, 
	mlmac_id
);

126 (*
	mgë_„c_°©s
)(*
	mcgxd
, 
	mlmac_id
,

127 
cgx_„c_°©s_r•
 *
	mr•
);

130 
	scgx
 {

131 
__iomem
 *
	mªg_ba£
;

132 
pci_dev
 *
	mpdev
;

133 
u8
 
	mcgx_id
;

134 
u8
 
	mlmac_cou¡
;

136 
u8
 
	mmax_lmac_≥r_mac
;

137 
	#MAX_LMAC_COUNT
 8

	)

138 
lmac
 *
	mlmac_idm≠
[
MAX_LMAC_COUNT
];

139 
w‹k_°ru˘
 
	mcgx_cmd_w‹k
;

140 
w‹kqueue_°ru˘
 *
	mcgx_cmd_w‹kq
;

141 
li°_hód
 
	mcgx_li°
;

142 
u64
 
	mhw_„©uªs
;

143 
mac_›s
 *
	mmac_›s
;

147 
muãx
 
	mlock
;

148 
	mlmac_bm≠
;

151 
cgx
 
	tΩm_t
;

154 
cgx_wrôe
(
cgx
 *cgx, 
u64
 
lmac
, u64 
off£t
, u64 
vÆ
);

155 
u64
 
cgx_ªad
(
cgx
 *cgx, u64 
lmac
, u64 
off£t
);

156 
lmac
 *
lmac_pd©a
(
u8
 
lmac_id
, 
cgx
 *cgx);

157 
cgx_fwi_cmd_£nd
(
u64
 
ªq
, u64 *
ª•
, 
lmac
 *lmac);

158 
cgx_fwi_cmd_gíîic
(
u64
 
ªq
, u64 *
ª•
, 
cgx
 *cgx, 
lmac_id
);

159 
boﬁ
 
is_lmac_vÆid
(
cgx
 *cgx, 
lmac_id
);

160 
mac_›s
 *
Ωm_gë_mac_›s
(
cgx
 *cgx);

	@mbox.c

8 
	~<löux/moduÀ.h
>

9 
	~<löux/öãºu±.h
>

10 
	~<löux/pci.h
>

12 
	~"rvu_ªg.h
"

13 
	~"mbox.h
"

14 
	~"rvu_åa˚.h
"

16 c⁄° 
u16
 
	gmsgs_off£t
 = 
ALIGN
((
mbox_hdr
), 
MBOX_MSG_ALIGN
);

18 
	$__Ÿx2_mbox_ª£t
(
Ÿx2_mbox
 *
mbox
, 
devid
)

20 
Ÿx2_mbox_dev
 *
mdev
 = &
mbox
->
dev
[
devid
];

21 
mbox_hdr
 *
tx_hdr
, *
rx_hdr
;

22 *
hw_mba£
 = 
mdev
->
hwba£
;

24 
tx_hdr
 = 
hw_mba£
 + 
mbox
->
tx_°¨t
;

25 
rx_hdr
 = 
hw_mba£
 + 
mbox
->
rx_°¨t
;

27 
mdev
->
msg_size
 = 0;

28 
mdev
->
r•_size
 = 0;

29 
tx_hdr
->
num_msgs
 = 0;

30 
tx_hdr
->
msg_size
 = 0;

31 
rx_hdr
->
num_msgs
 = 0;

32 
rx_hdr
->
msg_size
 = 0;

33 
	}
}

34 
EXPORT_SYMBOL
(
__Ÿx2_mbox_ª£t
);

36 
	$Ÿx2_mbox_ª£t
(
Ÿx2_mbox
 *
mbox
, 
devid
)

38 
Ÿx2_mbox_dev
 *
mdev
 = &
mbox
->
dev
[
devid
];

40 
	`•ö_lock
(&
mdev
->
mbox_lock
);

41 
	`__Ÿx2_mbox_ª£t
(
mbox
, 
devid
);

42 
	`•ö_u∆ock
(&
mdev
->
mbox_lock
);

43 
	}
}

44 
EXPORT_SYMBOL
(
Ÿx2_mbox_ª£t
);

46 
	$Ÿx2_mbox_de°roy
(
Ÿx2_mbox
 *
mbox
)

48 
mbox
->
ªg_ba£
 = 
NULL
;

49 
mbox
->
hwba£
 = 
NULL
;

51 
	`k‰ì
(
mbox
->
dev
);

52 
mbox
->
dev
 = 
NULL
;

53 
	}
}

54 
EXPORT_SYMBOL
(
Ÿx2_mbox_de°roy
);

56 
	$Ÿx2_mbox_£tup
(
Ÿx2_mbox
 *
mbox
, 
pci_dev
 *
pdev
,

57 *
ªg_ba£
, 
dúe˘i⁄
, 
ndevs
)

59 
dúe˘i⁄
) {

60 
MBOX_DIR_AFPF
:

61 
MBOX_DIR_PFVF
:

62 
mbox
->
tx_°¨t
 = 
MBOX_DOWN_TX_START
;

63 
mbox
->
rx_°¨t
 = 
MBOX_DOWN_RX_START
;

64 
mbox
->
tx_size
 = 
MBOX_DOWN_TX_SIZE
;

65 
mbox
->
rx_size
 = 
MBOX_DOWN_RX_SIZE
;

67 
MBOX_DIR_PFAF
:

68 
MBOX_DIR_VFPF
:

69 
mbox
->
tx_°¨t
 = 
MBOX_DOWN_RX_START
;

70 
mbox
->
rx_°¨t
 = 
MBOX_DOWN_TX_START
;

71 
mbox
->
tx_size
 = 
MBOX_DOWN_RX_SIZE
;

72 
mbox
->
rx_size
 = 
MBOX_DOWN_TX_SIZE
;

74 
MBOX_DIR_AFPF_UP
:

75 
MBOX_DIR_PFVF_UP
:

76 
mbox
->
tx_°¨t
 = 
MBOX_UP_TX_START
;

77 
mbox
->
rx_°¨t
 = 
MBOX_UP_RX_START
;

78 
mbox
->
tx_size
 = 
MBOX_UP_TX_SIZE
;

79 
mbox
->
rx_size
 = 
MBOX_UP_RX_SIZE
;

81 
MBOX_DIR_PFAF_UP
:

82 
MBOX_DIR_VFPF_UP
:

83 
mbox
->
tx_°¨t
 = 
MBOX_UP_RX_START
;

84 
mbox
->
rx_°¨t
 = 
MBOX_UP_TX_START
;

85 
mbox
->
tx_size
 = 
MBOX_UP_RX_SIZE
;

86 
mbox
->
rx_size
 = 
MBOX_UP_TX_SIZE
;

89  -
ENODEV
;

92 
dúe˘i⁄
) {

93 
MBOX_DIR_AFPF
:

94 
MBOX_DIR_AFPF_UP
:

95 
mbox
->
åiggî
 = 
RVU_AF_AFPF_MBOX0
;

96 
mbox
->
å_shi·
 = 4;

98 
MBOX_DIR_PFAF
:

99 
MBOX_DIR_PFAF_UP
:

100 
mbox
->
åiggî
 = 
RVU_PF_PFAF_MBOX1
;

101 
mbox
->
å_shi·
 = 0;

103 
MBOX_DIR_PFVF
:

104 
MBOX_DIR_PFVF_UP
:

105 
mbox
->
åiggî
 = 
RVU_PF_VFX_PFVF_MBOX0
;

106 
mbox
->
å_shi·
 = 12;

108 
MBOX_DIR_VFPF
:

109 
MBOX_DIR_VFPF_UP
:

110 
mbox
->
åiggî
 = 
RVU_VF_VFPF_MBOX1
;

111 
mbox
->
å_shi·
 = 0;

114  -
ENODEV
;

117 
mbox
->
ªg_ba£
 =Ñeg_base;

118 
mbox
->
pdev
 =Ödev;

120 
mbox
->
dev
 = 
	`kˇŒoc
(
ndevs
, (
Ÿx2_mbox_dev
), 
GFP_KERNEL
);

121 i‡(!
mbox
->
dev
) {

122 
	`Ÿx2_mbox_de°roy
(
mbox
);

123  -
ENOMEM
;

125 
mbox
->
ndevs
 =Çdevs;

128 
	}
}

130 
	$Ÿx2_mbox_öô
(
Ÿx2_mbox
 *
mbox
, *
hwba£
, 
pci_dev
 *
pdev
,

131 *
ªg_ba£
, 
dúe˘i⁄
, 
ndevs
)

133 
Ÿx2_mbox_dev
 *
mdev
;

134 
devid
, 
îr
;

136 
îr
 = 
	`Ÿx2_mbox_£tup
(
mbox
, 
pdev
, 
ªg_ba£
, 
dúe˘i⁄
, 
ndevs
);

137 i‡(
îr
)

138  
îr
;

140 
mbox
->
hwba£
 = hwbase;

142 
devid
 = 0; devid < 
ndevs
; devid++) {

143 
mdev
 = &
mbox
->
dev
[
devid
];

144 
mdev
->
mba£
 = 
mbox
->
hwba£
 + (
devid
 * 
MBOX_SIZE
);

145 
mdev
->
hwba£
 = mdev->
mba£
;

146 
	`•ö_lock_öô
(&
mdev
->
mbox_lock
);

148 
	`Ÿx2_mbox_ª£t
(
mbox
, 
devid
);

152 
	}
}

153 
EXPORT_SYMBOL
(
Ÿx2_mbox_öô
);

158 
	$Ÿx2_mbox_ªgi⁄s_öô
(
Ÿx2_mbox
 *
mbox
, **
hwba£
,

159 
pci_dev
 *
pdev
, *
ªg_ba£
,

160 
dúe˘i⁄
, 
ndevs
, *
pf_bm≠
)

162 
Ÿx2_mbox_dev
 *
mdev
;

163 
devid
, 
îr
;

165 
îr
 = 
	`Ÿx2_mbox_£tup
(
mbox
, 
pdev
, 
ªg_ba£
, 
dúe˘i⁄
, 
ndevs
);

166 i‡(
îr
)

167  
îr
;

169 
mbox
->
hwba£
 = hwbase[0];

171 
devid
 = 0; devid < 
ndevs
; devid++) {

172 i‡(!
	`ã°_bô
(
devid
, 
pf_bm≠
))

175 
mdev
 = &
mbox
->
dev
[
devid
];

176 
mdev
->
mba£
 = 
hwba£
[
devid
];

177 
mdev
->
hwba£
 = hwba£[
devid
];

178 
	`•ö_lock_öô
(&
mdev
->
mbox_lock
);

180 
	`Ÿx2_mbox_ª£t
(
mbox
, 
devid
);

184 
	}
}

185 
EXPORT_SYMBOL
(
Ÿx2_mbox_ªgi⁄s_öô
);

187 
	$Ÿx2_mbox_waô_f‹_r•
(
Ÿx2_mbox
 *
mbox
, 
devid
)

189 
timeout
 = 
jiffõs
 + 
	`m£cs_to_jiffõs
(
MBOX_RSP_TIMEOUT
);

190 
Ÿx2_mbox_dev
 *
mdev
 = &
mbox
->
dev
[
devid
];

192 !
	`time_a·î
(
jiffõs
, 
timeout
)) {

193 i‡(
mdev
->
num_msgs
 =mdev->
msgs_acked
)

195 
	`u¶ìp_ønge
(800, 1000);

197 
	`åa˚_Ÿx2_msg_waô_r•
(
mbox
->
pdev
);

198  -
EIO
;

199 
	}
}

200 
EXPORT_SYMBOL
(
Ÿx2_mbox_waô_f‹_r•
);

202 
	$Ÿx2_mbox_busy_pﬁl_f‹_r•
(
Ÿx2_mbox
 *
mbox
, 
devid
)

204 
Ÿx2_mbox_dev
 *
mdev
 = &
mbox
->
dev
[
devid
];

205 
timeout
 = 
jiffõs
 + 1 * 
HZ
;

207 !
	`time_a·î
(
jiffõs
, 
timeout
)) {

208 i‡(
mdev
->
num_msgs
 =mdev->
msgs_acked
)

210 
	`˝u_ªœx
();

212  -
EIO
;

213 
	}
}

214 
EXPORT_SYMBOL
(
Ÿx2_mbox_busy_pﬁl_f‹_r•
);

216 
	$Ÿx2_mbox_msg_£nd
(
Ÿx2_mbox
 *
mbox
, 
devid
)

218 
Ÿx2_mbox_dev
 *
mdev
 = &
mbox
->
dev
[
devid
];

219 
mbox_hdr
 *
tx_hdr
, *
rx_hdr
;

220 *
hw_mba£
 = 
mdev
->
hwba£
;

222 
tx_hdr
 = 
hw_mba£
 + 
mbox
->
tx_°¨t
;

223 
rx_hdr
 = 
hw_mba£
 + 
mbox
->
rx_°¨t
;

228 i‡(
mdev
->
mba£
 !
hw_mba£
)

229 
	`mem˝y
(
hw_mba£
 + 
mbox
->
tx_°¨t
 + 
msgs_off£t
,

230 
mdev
->
mba£
 + 
mbox
->
tx_°¨t
 + 
msgs_off£t
,

231 
mdev
->
msg_size
);

233 
	`•ö_lock
(&
mdev
->
mbox_lock
);

235 
tx_hdr
->
msg_size
 = 
mdev
->msg_size;

238 
mdev
->
msg_size
 = 0;

239 
mdev
->
r•_size
 = 0;

240 
mdev
->
msgs_acked
 = 0;

243 
	`smp_wmb
();

249 
tx_hdr
->
num_msgs
 = 
mdev
->num_msgs;

250 
rx_hdr
->
num_msgs
 = 0;

252 
	`åa˚_Ÿx2_msg_£nd
(
mbox
->
pdev
, 
tx_hdr
->
num_msgs
,Åx_hdr->
msg_size
);

254 
	`•ö_u∆ock
(&
mdev
->
mbox_lock
);

259 
	`wrôeq
(1, (
__iomem
 *)
mbox
->
ªg_ba£
 +

260 (
mbox
->
åiggî
 | (
devid
 << mbox->
å_shi·
)));

261 
	}
}

262 
EXPORT_SYMBOL
(
Ÿx2_mbox_msg_£nd
);

264 
mbox_msghdr
 *
	$Ÿx2_mbox_Æloc_msg_r•
(
Ÿx2_mbox
 *
mbox
, 
devid
,

265 
size
, 
size_r•
)

267 
Ÿx2_mbox_dev
 *
mdev
 = &
mbox
->
dev
[
devid
];

268 
mbox_msghdr
 *
msghdr
 = 
NULL
;

270 
	`•ö_lock
(&
mdev
->
mbox_lock
);

271 
size
 = 
	`ALIGN
(size, 
MBOX_MSG_ALIGN
);

272 
size_r•
 = 
	`ALIGN
(size_r•, 
MBOX_MSG_ALIGN
);

274 i‡((
mdev
->
msg_size
 + 
size
Ë> 
mbox
->
tx_size
 - 
msgs_off£t
)

275 
exô
;

276 i‡((
mdev
->
r•_size
 + 
size_r•
Ë> 
mbox
->
rx_size
 - 
msgs_off£t
)

277 
exô
;

279 i‡(
mdev
->
msg_size
 == 0)

280 
mdev
->
num_msgs
 = 0;

281 
mdev
->
num_msgs
++;

283 
msghdr
 = 
mdev
->
mba£
 + 
mbox
->
tx_°¨t
 + 
msgs_off£t
 + mdev->
msg_size
;

286 
	`mem£t
(
msghdr
, 0, 
size
);

288 
msghdr
->
vî
 = 
OTX2_MBOX_VERSION
;

289 
mdev
->
msg_size
 +
size
;

290 
mdev
->
r•_size
 +
size_r•
;

291 
msghdr
->
√xt_msgoff
 = 
mdev
->
msg_size
 + 
msgs_off£t
;

292 
exô
:

293 
	`•ö_u∆ock
(&
mdev
->
mbox_lock
);

295  
msghdr
;

296 
	}
}

297 
EXPORT_SYMBOL
(
Ÿx2_mbox_Æloc_msg_r•
);

299 
mbox_msghdr
 *
	$Ÿx2_mbox_gë_r•
(
Ÿx2_mbox
 *
mbox
, 
devid
,

300 
mbox_msghdr
 *
msg
)

302 
imsg
 = 
mbox
->
tx_°¨t
 + 
msgs_off£t
;

303 
ú•
 = 
mbox
->
rx_°¨t
 + 
msgs_off£t
;

304 
Ÿx2_mbox_dev
 *
mdev
 = &
mbox
->
dev
[
devid
];

305 
u16
 
msgs
;

307 
	`•ö_lock
(&
mdev
->
mbox_lock
);

309 i‡(
mdev
->
num_msgs
 !mdev->
msgs_acked
)

310 
îr‹
;

312 
msgs
 = 0; msg†< 
mdev
->
msgs_acked
; msgs++) {

313 
mbox_msghdr
 *
pmsg
 = 
mdev
->
mba£
 + 
imsg
;

314 
mbox_msghdr
 *
¥•
 = 
mdev
->
mba£
 + 
ú•
;

316 i‡(
msg
 =
pmsg
) {

317 i‡(
pmsg
->
id
 !
¥•
->id)

318 
îr‹
;

319 
	`•ö_u∆ock
(&
mdev
->
mbox_lock
);

320  
¥•
;

323 
imsg
 = 
mbox
->
tx_°¨t
 + 
pmsg
->
√xt_msgoff
;

324 
ú•
 = 
mbox
->
rx_°¨t
 + 
¥•
->
√xt_msgoff
;

327 
îr‹
:

328 
	`•ö_u∆ock
(&
mdev
->
mbox_lock
);

329  
	`ERR_PTR
(-
ENODEV
);

330 
	}
}

331 
EXPORT_SYMBOL
(
Ÿx2_mbox_gë_r•
);

333 
	$Ÿx2_mbox_check_r•_msgs
(
Ÿx2_mbox
 *
mbox
, 
devid
)

335 
úeq
 = 
mbox
->
tx_°¨t
 + 
msgs_off£t
;

336 
ú•
 = 
mbox
->
rx_°¨t
 + 
msgs_off£t
;

337 
Ÿx2_mbox_dev
 *
mdev
 = &
mbox
->
dev
[
devid
];

338 
rc
 = -
ENODEV
;

339 
u16
 
msgs
;

341 
	`•ö_lock
(&
mdev
->
mbox_lock
);

343 i‡(
mdev
->
num_msgs
 !mdev->
msgs_acked
)

344 
exô
;

346 
msgs
 = 0; msg†< 
mdev
->
msgs_acked
; msgs++) {

347 
mbox_msghdr
 *
¥eq
 = 
mdev
->
mba£
 + 
úeq
;

348 
mbox_msghdr
 *
¥•
 = 
mdev
->
mba£
 + 
ú•
;

350 i‡(
¥eq
->
id
 !
¥•
->id) {

351 
	`åa˚_Ÿx2_msg_check
(
mbox
->
pdev
, 
¥eq
->
id
,

352 
¥•
->
id
,Ör•->
rc
);

353 
exô
;

355 i‡(
¥•
->
rc
) {

356 
rc
 = 
¥•
->rc;

357 
	`åa˚_Ÿx2_msg_check
(
mbox
->
pdev
, 
¥eq
->
id
,

358 
¥•
->
id
,Ör•->
rc
);

359 
exô
;

362 
úeq
 = 
mbox
->
tx_°¨t
 + 
¥eq
->
√xt_msgoff
;

363 
ú•
 = 
mbox
->
rx_°¨t
 + 
¥•
->
√xt_msgoff
;

365 
rc
 = 0;

366 
exô
:

367 
	`•ö_u∆ock
(&
mdev
->
mbox_lock
);

368  
rc
;

369 
	}
}

370 
EXPORT_SYMBOL
(
Ÿx2_mbox_check_r•_msgs
);

373 
	$Ÿx2_ª∂y_övÆid_msg
(
Ÿx2_mbox
 *
mbox
, 
devid
, 
u16
 
pcifunc
, u16 
id
)

375 
msg_r•
 *
r•
;

377 
r•
 = (
msg_r•
 *)

378 
	`Ÿx2_mbox_Æloc_msg
(
mbox
, 
devid
, (*
r•
));

379 i‡(!
r•
)

380  -
ENOMEM
;

381 
r•
->
hdr
.
id
 = id;

382 
r•
->
hdr
.
sig
 = 
OTX2_MBOX_RSP_SIG
;

383 
r•
->
hdr
.
rc
 = 
MBOX_MSG_INVALID
;

384 
r•
->
hdr
.
pcifunc
 =Öcifunc;

386 
	}
}

387 
EXPORT_SYMBOL
(
Ÿx2_ª∂y_övÆid_msg
);

389 
boﬁ
 
	$Ÿx2_mbox_n⁄em±y
(
Ÿx2_mbox
 *
mbox
, 
devid
)

391 
Ÿx2_mbox_dev
 *
mdev
 = &
mbox
->
dev
[
devid
];

392 
boﬁ
 
ªt
;

394 
	`•ö_lock
(&
mdev
->
mbox_lock
);

395 
ªt
 = 
mdev
->
num_msgs
 != 0;

396 
	`•ö_u∆ock
(&
mdev
->
mbox_lock
);

398  
ªt
;

399 
	}
}

400 
EXPORT_SYMBOL
(
Ÿx2_mbox_n⁄em±y
);

402 c⁄° *
	$Ÿx2_mbox_id2«me
(
u16
 
id
)

404 
id
) {

405 
	#M
(
_«me
, 
_id
, 
_1
, 
_2
, 
_3
Ë_id:  #_«me;

	)

406 
MBOX_MESSAGES


407 #unde‡
M


409 
	#M
(
_«me
, 
_id
, 
_1
, 
_2
, 
_3
Ë_id:  #_«me;

	)

410 
MBOX_UP_CGX_MESSAGES


411 #unde‡
M


413 
	#M
(
_«me
, 
_id
, 
_1
, 
_2
, 
_3
Ë_id:  #_«me;

	)

414 
MBOX_UP_CPT_MESSAGES


415 #unde‡
M


419 
	}
}

420 
EXPORT_SYMBOL
(
Ÿx2_mbox_id2«me
);

422 
MODULE_AUTHOR
("Marvell.");

423 
MODULE_LICENSE
("GPL v2");

	@mbox.h

8 #i‚de‡
MBOX_H


9 
	#MBOX_H


	)

11 
	~<löux/ëhîdevi˚.h
>

12 
	~<löux/sizes.h
>

14 
	~"rvu_°ru˘.h
"

15 
	~"comm⁄.h
"

17 
	#MBOX_SIZE
 
SZ_64K


	)

20 
	#MBOX_DOWN_RX_START
 0

	)

21 
	#MBOX_DOWN_RX_SIZE
 (46 * 
SZ_1K
)

	)

22 
	#MBOX_DOWN_TX_START
 (
MBOX_DOWN_RX_START
 + 
MBOX_DOWN_RX_SIZE
)

	)

23 
	#MBOX_DOWN_TX_SIZE
 (16 * 
SZ_1K
)

	)

25 
	#MBOX_UP_RX_START
 (
MBOX_DOWN_TX_START
 + 
MBOX_DOWN_TX_SIZE
)

	)

26 
	#MBOX_UP_RX_SIZE
 
SZ_1K


	)

27 
	#MBOX_UP_TX_START
 (
MBOX_UP_RX_START
 + 
MBOX_UP_RX_SIZE
)

	)

28 
	#MBOX_UP_TX_SIZE
 
SZ_1K


	)

30 #i‡
MBOX_UP_TX_SIZE
 + 
MBOX_UP_TX_START
 !
MBOX_SIZE


34 
	#INTR_MASK
(
pfvfs
Ë(’fvf†< 64Ë? (
	`BIT_ULL
’fvfsË- 1Ë: (~0uŒ))

	)

36 
	#MBOX_RSP_TIMEOUT
 6000

	)

38 
	#MBOX_MSG_ALIGN
 16

	)

41 
	#MBOX_DIR_AFPF
 0

	)

42 
	#MBOX_DIR_PFAF
 1

	)

43 
	#MBOX_DIR_PFVF
 2

	)

44 
	#MBOX_DIR_VFPF
 3

	)

45 
	#MBOX_DIR_AFPF_UP
 4

	)

46 
	#MBOX_DIR_PFAF_UP
 5

	)

47 
	#MBOX_DIR_PFVF_UP
 6

	)

48 
	#MBOX_DIR_VFPF_UP
 7

	)

50 
	sŸx2_mbox_dev
 {

51 *
	mmba£
;

52 *
	mhwba£
;

53 
•ölock_t
 
	mmbox_lock
;

54 
u16
 
	mmsg_size
;

55 
u16
 
	mr•_size
;

56 
u16
 
	mnum_msgs
;

57 
u16
 
	mmsgs_acked
;

60 
	sŸx2_mbox
 {

61 
pci_dev
 *
	mpdev
;

62 *
	mhwba£
;

63 *
	mªg_ba£
;

64 
u64
 
	måiggî
;

65 
u16
 
	må_shi·
;

66 
u64
 
	mrx_°¨t
;

67 
u64
 
	mtx_°¨t
;

68 
u16
 
	mrx_size
;

69 
u16
 
	mtx_size
;

70 
u16
 
	mndevs
;

71 
Ÿx2_mbox_dev
 *
	mdev
;

75 
	smbox_hdr
 {

76 
u64
 
	mmsg_size
;

77 
u16
 
	mnum_msgs
;

81 
	smbox_msghdr
 {

82 
u16
 
	mpcifunc
;

83 
u16
 
	mid
;

84 
	#OTX2_MBOX_REQ_SIG
 (0xdód)

	)

85 
	#OTX2_MBOX_RSP_SIG
 (0xbìf)

	)

86 
u16
 
	msig
;

87 
	#OTX2_MBOX_VERSION
 (0x000b)

	)

88 
u16
 
	mvî
;

89 
u16
 
	m√xt_msgoff
;

90 
	mrc
;

93 
Ÿx2_mbox_ª£t
(
Ÿx2_mbox
 *
mbox
, 
devid
);

94 
__Ÿx2_mbox_ª£t
(
Ÿx2_mbox
 *
mbox
, 
devid
);

95 
Ÿx2_mbox_de°roy
(
Ÿx2_mbox
 *
mbox
);

96 
Ÿx2_mbox_öô
(
Ÿx2_mbox
 *
mbox
, 
__f‹˚
 *
hwba£
,

97 
pci_dev
 *
pdev
, 
__f‹˚
 *
ªg_ba£
,

98 
dúe˘i⁄
, 
ndevs
);

100 
Ÿx2_mbox_ªgi⁄s_öô
(
Ÿx2_mbox
 *
mbox
, 
__f‹˚
 **
hwba£
,

101 
pci_dev
 *
pdev
, 
__f‹˚
 *
ªg_ba£
,

102 
dúe˘i⁄
, 
ndevs
, *
bm≠
);

103 
Ÿx2_mbox_msg_£nd
(
Ÿx2_mbox
 *
mbox
, 
devid
);

104 
Ÿx2_mbox_waô_f‹_r•
(
Ÿx2_mbox
 *
mbox
, 
devid
);

105 
Ÿx2_mbox_busy_pﬁl_f‹_r•
(
Ÿx2_mbox
 *
mbox
, 
devid
);

106 
mbox_msghdr
 *
Ÿx2_mbox_Æloc_msg_r•
(
Ÿx2_mbox
 *
mbox
, 
devid
,

107 
size
, 
size_r•
);

108 
mbox_msghdr
 *
Ÿx2_mbox_gë_r•
(
Ÿx2_mbox
 *
mbox
, 
devid
,

109 
mbox_msghdr
 *
msg
);

110 
Ÿx2_mbox_check_r•_msgs
(
Ÿx2_mbox
 *
mbox
, 
devid
);

111 
Ÿx2_ª∂y_övÆid_msg
(
Ÿx2_mbox
 *
mbox
, 
devid
,

112 
u16
 
pcifunc
, u16 
id
);

113 
boﬁ
 
Ÿx2_mbox_n⁄em±y
(
Ÿx2_mbox
 *
mbox
, 
devid
);

114 c⁄° *
Ÿx2_mbox_id2«me
(
u16
 
id
);

115 
ölöe
 
mbox_msghdr
 *
	$Ÿx2_mbox_Æloc_msg
(
Ÿx2_mbox
 *
mbox
,

116 
devid
, 
size
)

118  
	`Ÿx2_mbox_Æloc_msg_r•
(
mbox
, 
devid
, 
size
, 0);

119 
	}
}

122 
	#MBOX_MSG_MASK
 0xFFFF

	)

123 
	#MBOX_MSG_INVALID
 0xFFFE

	)

124 
	#MBOX_MSG_MAX
 0xFFFF

	)

126 
	#MBOX_MESSAGES
 \

128 
	`M
(
READY
, 0x001, 
ªady
, 
msg_ªq
, 
ªady_msg_r•
) \

129 
	`M
(
ATTACH_RESOURCES
, 0x002, 
©èch_ªsour˚s
, 
r§c_©èch
, 
msg_r•
) \

130 
	`M
(
DETACH_RESOURCES
, 0x003, 
dëach_ªsour˚s
, 
r§c_dëach
, 
msg_r•
) \

131 
	`M
(
FREE_RSRC_CNT
, 0x004, 
‰ì_r§c_˙t
, 
msg_ªq
, 
‰ì_r§cs_r•
) \

132 
	`M
(
MSIX_OFFSET
, 0x005, 
msix_off£t
, 
msg_ªq
, 
msix_off£t_r•
) \

133 
	`M
(
VF_FLR
, 0x006, 
vf_Êr
, 
msg_ªq
, 
msg_r•
) \

134 
	`M
(
PTP_OP
, 0x007, 
±p_›
, 
±p_ªq
, 
±p_r•
) \

135 
	`M
(
GET_HW_CAP
, 0x008, 
gë_hw_ˇp
, 
msg_ªq
, 
gë_hw_ˇp_r•
) \

136 
	`M
(
NDC_SYNC_OP
, 0x009, 
ndc_sync_›
,Çdc_sync_›, 
msg_r•
) \

137 
	`M
(
LMTST_TBL_SETUP
, 0x00a, 
lmt°_tbl_£tup
, 
lmt°_tbl_£tup_ªq
, \

138 
msg_r•
) \

139 
	`M
(
SET_VF_PERM
, 0x00b, 
£t_vf_≥rm
, së_vf_≥rm, 
msg_r•
) \

141 
	`M
(
CGX_START_RXTX
, 0x200, 
cgx_°¨t_rxtx
, 
msg_ªq
, 
msg_r•
) \

142 
	`M
(
CGX_STOP_RXTX
, 0x201, 
cgx_°›_rxtx
, 
msg_ªq
, 
msg_r•
) \

143 
	`M
(
CGX_STATS
, 0x202, 
cgx_°©s
, 
msg_ªq
, 
cgx_°©s_r•
) \

144 
	`M
(
CGX_MAC_ADDR_SET
, 0x203, 
cgx_mac_addr_£t
, 
cgx_mac_addr_£t_‹_gë
, \

145 
cgx_mac_addr_£t_‹_gë
) \

146 
	`M
(
CGX_MAC_ADDR_GET
, 0x204, 
cgx_mac_addr_gë
, 
cgx_mac_addr_£t_‹_gë
, \

147 
cgx_mac_addr_£t_‹_gë
) \

148 
	`M
(
CGX_PROMISC_ENABLE
, 0x205, 
cgx_¥omisc_íabÀ
, 
msg_ªq
, 
msg_r•
) \

149 
	`M
(
CGX_PROMISC_DISABLE
, 0x206, 
cgx_¥omisc_dißbÀ
, 
msg_ªq
, 
msg_r•
) \

150 
	`M
(
CGX_START_LINKEVENTS
, 0x207, 
cgx_°¨t_lökevíts
, 
msg_ªq
, 
msg_r•
) \

151 
	`M
(
CGX_STOP_LINKEVENTS
, 0x208, 
cgx_°›_lökevíts
, 
msg_ªq
, 
msg_r•
) \

152 
	`M
(
CGX_GET_LINKINFO
, 0x209, 
cgx_gë_lököfo
, 
msg_ªq
, 
cgx_lök_öfo_msg
) \

153 
	`M
(
CGX_INTLBK_ENABLE
, 0x20A, 
cgx_öébk_íabÀ
, 
msg_ªq
, 
msg_r•
) \

154 
	`M
(
CGX_INTLBK_DISABLE
, 0x20B, 
cgx_öébk_dißbÀ
, 
msg_ªq
, 
msg_r•
) \

155 
	`M
(
CGX_PTP_RX_ENABLE
, 0x20C, 
cgx_±p_rx_íabÀ
, 
msg_ªq
, 
msg_r•
) \

156 
	`M
(
CGX_PTP_RX_DISABLE
, 0x20D, 
cgx_±p_rx_dißbÀ
, 
msg_ªq
, 
msg_r•
) \

157 
	`M
(
CGX_CFG_PAUSE_FRM
, 0x20E, 
cgx_cfg_∑u£_‰m
, 
cgx_∑u£_‰m_cfg
, \

158 
cgx_∑u£_‰m_cfg
) \

159 
	`M
(
CGX_FW_DATA_GET
, 0x20F, 
cgx_gë_aux_lök_öfo
, 
msg_ªq
, 
cgx_fw_d©a
) \

160 
	`M
(
CGX_FEC_SET
, 0x210, 
cgx_£t_„c_∑øm
, 
„c_mode
, fec_mode) \

161 
	`M
(
CGX_MAC_ADDR_ADD
, 0x211, 
cgx_mac_addr_add
, 
cgx_mac_addr_add_ªq
, \

162 
cgx_mac_addr_add_r•
) \

163 
	`M
(
CGX_MAC_ADDR_DEL
, 0x212, 
cgx_mac_addr_dñ
, 
cgx_mac_addr_dñ_ªq
, \

164 
msg_r•
) \

165 
	`M
(
CGX_MAC_MAX_ENTRIES_GET
, 0x213, 
cgx_mac_max_íåõs_gë
, 
msg_ªq
, \

166 
cgx_max_dmac_íåõs_gë_r•
) \

167 
	`M
(
CGX_SET_LINK_STATE
, 0x214, 
cgx_£t_lök_°©e
, \

168 
cgx_£t_lök_°©e_msg
, 
msg_r•
) \

169 
	`M
(
CGX_GET_PHY_MOD_TYPE
, 0x215, 
cgx_gë_phy_mod_ty≥
, 
msg_ªq
, \

170 
cgx_phy_mod_ty≥
) \

171 
	`M
(
CGX_SET_PHY_MOD_TYPE
, 0x216, 
cgx_£t_phy_mod_ty≥
, 
cgx_phy_mod_ty≥
, \

172 
msg_r•
) \

173 
	`M
(
CGX_FEC_STATS
, 0x217, 
cgx_„c_°©s
, 
msg_ªq
, 
cgx_„c_°©s_r•
) \

174 
	`M
(
CGX_SET_LINK_MODE
, 0x218, 
cgx_£t_lök_mode
, 
cgx_£t_lök_mode_ªq
,\

175 
cgx_£t_lök_mode_r•
) \

176 
	`M
(
CGX_GET_PHY_FEC_STATS
, 0x219, 
cgx_gë_phy_„c_°©s
, 
msg_ªq
, 
msg_r•
) \

177 
	`M
(
CGX_STATS_RST
, 0x21A, 
cgx_°©s_r°
, 
msg_ªq
, 
msg_r•
) \

178 
	`M
(
CGX_FEATURES_GET
, 0x21B, 
cgx_„©uªs_gë
, 
msg_ªq
, \

179 
cgx_„©uªs_öfo_msg
) \

180 
	`M
(
RPM_STATS
, 0x21C, 
Ωm_°©s
, 
msg_ªq
, 
Ωm_°©s_r•
) \

181 
	`M
(
CGX_MAC_ADDR_RESET
, 0x21D, 
cgx_mac_addr_ª£t
, 
cgx_mac_addr_ª£t_ªq
, \

182 
msg_r•
) \

183 
	`M
(
CGX_MAC_ADDR_UPDATE
, 0x21E, 
cgx_mac_addr_upd©e
, 
cgx_mac_addr_upd©e_ªq
, \

184 
cgx_mac_addr_upd©e_r•
) \

185 
	`M
(
CGX_PRIO_FLOW_CTRL_CFG
, 0x21F, 
cgx_¥io_Êow_˘æ_cfg
, 
cgx_pfc_cfg
, \

186 
cgx_pfc_r•
) \

188 
	`M
(
NPA_LF_ALLOC
, 0x400, 
≈a_lf_Æloc
, \

189 
≈a_lf_Æloc_ªq
, 
≈a_lf_Æloc_r•
) \

190 
	`M
(
NPA_LF_FREE
, 0x401, 
≈a_lf_‰ì
, 
msg_ªq
, 
msg_r•
) \

191 
	`M
(
NPA_AQ_ENQ
, 0x402, 
≈a_aq_íq
, 
≈a_aq_íq_ªq
, 
≈a_aq_íq_r•
) \

192 
	`M
(
NPA_HWCTX_DISABLE
, 0x403, 
≈a_hw˘x_dißbÀ
, 
hw˘x_dißbÀ_ªq
, 
msg_r•
)\

194 
	`M
(
SSO_LF_ALLOC
, 0x600, 
sso_lf_Æloc
, \

195 
sso_lf_Æloc_ªq
, 
sso_lf_Æloc_r•
) \

196 
	`M
(
SSO_LF_FREE
, 0x601, 
sso_lf_‰ì
, \

197 
sso_lf_‰ì_ªq
, 
msg_r•
) \

198 
	`M
(
SSOW_LF_ALLOC
, 0x602, 
ssow_lf_Æloc
, \

199 
ssow_lf_Æloc_ªq
, 
msg_r•
) \

200 
	`M
(
SSOW_LF_FREE
, 0x603, 
ssow_lf_‰ì
, \

201 
ssow_lf_‰ì_ªq
, 
msg_r•
) \

202 
	`M
(
SSO_HW_SETCONFIG
, 0x604, 
sso_hw_£tc⁄fig
, \

203 
sso_hw_£tc⁄fig
, 
msg_r•
) \

204 
	`M
(
SSO_GRP_SET_PRIORITY
, 0x605, 
sso_gΩ_£t_¥i‹ôy
, \

205 
sso_gΩ_¥i‹ôy
, 
msg_r•
) \

206 
	`M
(
SSO_GRP_GET_PRIORITY
, 0x606, 
sso_gΩ_gë_¥i‹ôy
, \

207 
sso_öfo_ªq
, 
sso_gΩ_¥i‹ôy
) \

208 
	`M
(
SSO_WS_CACHE_INV
, 0x607, 
sso_ws_ˇche_öv
, 
ssow_lf_öv_ªq
, 
msg_r•
)\

209 
	`M
(
SSO_GRP_QOS_CONFIG
, 0x608, 
sso_gΩ_qos_c⁄fig
, 
sso_gΩ_qos_cfg
, 
msg_r•
)\

210 
	`M
(
SSO_GRP_GET_STATS
, 0x609, 
sso_gΩ_gë_°©s
, 
sso_öfo_ªq
, 
sso_gΩ_°©s
)\

211 
	`M
(
SSO_HWS_GET_STATS
, 0x610, 
sso_hws_gë_°©s
, 
sso_öfo_ªq
, 
sso_hws_°©s
)\

212 
	`M
(
SSO_HW_RELEASE_XAQ
, 0x611, 
sso_hw_ªÀa£_xaq_auø
, \

213 
sso_ªÀa£_xaq
, 
msg_r•
) \

214 
	`M
(
SSO_CONFIG_LSW
, 0x612, 
ssow_c⁄fig_lsw
, \

215 
ssow_c⁄fig_lsw
, 
msg_r•
) \

216 
	`M
(
SSO_HWS_CHNG_MSHIP
, 0x613, 
ssow_chng_mshù
, ssow_chng_mshù, 
msg_r•
)\

217 
	`M
(
SSO_GRP_STASH_CONFIG
, 0x614, 
sso_gΩ_°ash_c⁄fig
, 
sso_gΩ_°ash_cfg
, \

218 
msg_r•
) \

220 
	`M
(
TIM_LF_ALLOC
, 0x800, 
tim_lf_Æloc
, \

221 
tim_lf_Æloc_ªq
, 
tim_lf_Æloc_r•
) \

222 
	`M
(
TIM_LF_FREE
, 0x801, 
tim_lf_‰ì
, 
tim_rög_ªq
, 
msg_r•
) \

223 
	`M
(
TIM_CONFIG_RING
, 0x802, 
tim_c⁄fig_rög
, 
tim_c⁄fig_ªq
, 
msg_r•
)\

224 
	`M
(
TIM_ENABLE_RING
, 0x803, 
tim_íabÀ_rög
, 
tim_rög_ªq
, 
tim_íabÀ_r•
)\

225 
	`M
(
TIM_DISABLE_RING
, 0x804, 
tim_dißbÀ_rög
, 
tim_rög_ªq
, 
msg_r•
) \

226 
	`M
(
TIM_GET_MIN_INTVL
, 0x805, 
tim_gë_mö_ötvl
, 
tim_ötvl_ªq
, \

227 
tim_ötvl_r•
) \

229 
	`M
(
CPT_LF_ALLOC
, 0xA00, 
˝t_lf_Æloc
, 
˝t_lf_Æloc_ªq_msg
, \

230 
msg_r•
) \

231 
	`M
(
CPT_LF_FREE
, 0xA01, 
˝t_lf_‰ì
, 
msg_ªq
, 
msg_r•
) \

232 
	`M
(
CPT_RD_WR_REGISTER
, 0xA02, 
˝t_rd_wr_ªgi°î
, 
˝t_rd_wr_ªg_msg
, \

233 
˝t_rd_wr_ªg_msg
) \

234 
	`M
(
CPT_INLINE_IPSEC_CFG
, 0xA04, 
˝t_ölöe_ù£c_cfg
, \

235 
˝t_ölöe_ù£c_cfg_msg
, 
msg_r•
) \

236 
	`M
(
CPT_STATS
, 0xA05, 
˝t_°s
, 
˝t_°s_ªq
, 
˝t_°s_r•
) \

237 
	`M
(
CPT_RXC_TIME_CFG
, 0xA06, 
˝t_rxc_time_cfg
, 
˝t_rxc_time_cfg_ªq
, \

238 
msg_r•
) \

239 
	`M
(
CPT_CTX_CACHE_SYNC
, 0xA07, 
˝t_˘x_ˇche_sync
, 
msg_ªq
, 
msg_r•
) \

240 
	`M
(
CPT_LF_RESET
, 0xA08, 
˝t_lf_ª£t
, 
˝t_lf_r°_ªq
, 
msg_r•
) \

241 
	`M
(
CPT_FLT_ENG_INFO
, 0xA09, 
˝t_Êt_íg_öfo
, 
˝t_Êt_íg_öfo_ªq
, \

242 
˝t_Êt_íg_öfo_r•
) \

244 
	`M
(
REE_CONFIG_LF
, 0xE01, 
ªe_c⁄fig_lf
, 
ªe_lf_ªq_msg
, \

245 
msg_r•
) \

246 
	`M
(
REE_RD_WR_REGISTER
, 0xE02, 
ªe_rd_wr_ªgi°î
, 
ªe_rd_wr_ªg_msg
, \

247 
ªe_rd_wr_ªg_msg
) \

248 
	`M
(
REE_RULE_DB_PROG
, 0xE03, 
ªe_ruÀ_db_¥og
, \

249 
ªe_ruÀ_db_¥og_ªq_msg
, \

250 
msg_r•
) \

251 
	`M
(
REE_RULE_DB_LEN_GET
, 0xE04, 
ªe_ruÀ_db_Àn_gë
, 
ªe_ªq_msg
, \

252 
ªe_ruÀ_db_Àn_r•_msg
) \

253 
	`M
(
REE_RULE_DB_GET
, 0xE05, 
ªe_ruÀ_db_gë
, \

254 
ªe_ruÀ_db_gë_ªq_msg
, \

255 
ªe_ruÀ_db_gë_r•_msg
) \

257 
	`M
(
SET_SDP_CHAN_INFO
, 0x1000, 
£t_sdp_ch™_öfo
, 
sdp_ch™_öfo_msg
, 
msg_r•
) \

258 
	`M
(
GET_SDP_CHAN_INFO
, 0x1001, 
gë_sdp_ch™_öfo
, 
msg_ªq
, 
sdp_gë_ch™_öfo_msg
) \

260 
	`M
(
NPC_MCAM_ALLOC_ENTRY
, 0x6000, 
≈c_mˇm_Æloc_íåy
, 
≈c_mˇm_Æloc_íåy_ªq
,\

261 
≈c_mˇm_Æloc_íåy_r•
) \

262 
	`M
(
NPC_MCAM_FREE_ENTRY
, 0x6001, 
≈c_mˇm_‰ì_íåy
, \

263 
≈c_mˇm_‰ì_íåy_ªq
, 
msg_r•
) \

264 
	`M
(
NPC_MCAM_WRITE_ENTRY
, 0x6002, 
≈c_mˇm_wrôe_íåy
, \

265 
≈c_mˇm_wrôe_íåy_ªq
, 
msg_r•
) \

266 
	`M
(
NPC_MCAM_ENA_ENTRY
, 0x6003, 
≈c_mˇm_ía_íåy
, \

267 
≈c_mˇm_ía_dis_íåy_ªq
, 
msg_r•
) \

268 
	`M
(
NPC_MCAM_DIS_ENTRY
, 0x6004, 
≈c_mˇm_dis_íåy
, \

269 
≈c_mˇm_ía_dis_íåy_ªq
, 
msg_r•
) \

270 
	`M
(
NPC_MCAM_SHIFT_ENTRY
, 0x6005, 
≈c_mˇm_shi·_íåy
, 
≈c_mˇm_shi·_íåy_ªq
,\

271 
≈c_mˇm_shi·_íåy_r•
) \

272 
	`M
(
NPC_MCAM_ALLOC_COUNTER
, 0x6006, 
≈c_mˇm_Æloc_cou¡î
, \

273 
≈c_mˇm_Æloc_cou¡î_ªq
, \

274 
≈c_mˇm_Æloc_cou¡î_r•
) \

275 
	`M
(
NPC_MCAM_FREE_COUNTER
, 0x6007, 
≈c_mˇm_‰ì_cou¡î
, \

276 
≈c_mˇm_›î_cou¡î_ªq
, 
msg_r•
) \

277 
	`M
(
NPC_MCAM_UNMAP_COUNTER
, 0x6008, 
≈c_mˇm_unm≠_cou¡î
, \

278 
≈c_mˇm_unm≠_cou¡î_ªq
, 
msg_r•
) \

279 
	`M
(
NPC_MCAM_CLEAR_COUNTER
, 0x6009, 
≈c_mˇm_˛ór_cou¡î
, \

280 
≈c_mˇm_›î_cou¡î_ªq
, 
msg_r•
) \

281 
	`M
(
NPC_MCAM_COUNTER_STATS
, 0x600a, 
≈c_mˇm_cou¡î_°©s
, \

282 
≈c_mˇm_›î_cou¡î_ªq
, \

283 
≈c_mˇm_›î_cou¡î_r•
) \

284 
	`M
(
NPC_MCAM_ALLOC_AND_WRITE_ENTRY
, 0x600b, 
≈c_mˇm_Æloc_™d_wrôe_íåy
, \

285 
≈c_mˇm_Æloc_™d_wrôe_íåy_ªq
, \

286 
≈c_mˇm_Æloc_™d_wrôe_íåy_r•
) \

287 
	`M
(
NPC_GET_KEX_CFG
, 0x600c, 
≈c_gë_kex_cfg
, \

288 
msg_ªq
, 
≈c_gë_kex_cfg_r•
) \

289 
	`M
(
NPC_INSTALL_FLOW
, 0x600d, 
≈c_ö°Æl_Êow
, \

290 
≈c_ö°Æl_Êow_ªq
, 
≈c_ö°Æl_Êow_r•
) \

291 
	`M
(
NPC_DELETE_FLOW
, 0x600e, 
≈c_dñëe_Êow
, \

292 
≈c_dñëe_Êow_ªq
, 
msg_r•
) \

293 
	`M
(
NPC_MCAM_READ_ENTRY
, 0x600f, 
≈c_mˇm_ªad_íåy
, \

294 
≈c_mˇm_ªad_íåy_ªq
, \

295 
≈c_mˇm_ªad_íåy_r•
) \

296 
	`M
(
NPC_SET_PKIND
, 0x6010, 
≈c_£t_pköd
, \

297 
≈c_£t_pköd
, 
msg_r•
) \

298 
	`M
(
NPC_MCAM_READ_BASE_RULE
, 0x6011, 
≈c_ªad_ba£_°ìr_ruÀ
, \

299 
msg_ªq
, 
≈c_mˇm_ªad_ba£_ruÀ_r•
) \

300 
	`M
(
NPC_MCAM_GET_STATS
, 0x6012, 
≈c_mˇm_íåy_°©s
, \

301 
≈c_mˇm_gë_°©s_ªq
, \

302 
≈c_mˇm_gë_°©s_r•
) \

303 
	`M
(
NPC_GET_SECRET_KEY
, 0x6013, 
≈c_gë_£¸ë_key
, \

304 
≈c_gë_£¸ë_key_ªq
, \

305 
≈c_gë_£¸ë_key_r•
) \

306 
	`M
(
NPC_GET_FIELD_STATUS
, 0x6014, 
≈c_gë_fõld_°©us
, \

307 
≈c_gë_fõld_°©us_ªq
, \

308 
≈c_gë_fõld_°©us_r•
) \

310 
	`M
(
NIX_LF_ALLOC
, 0x8000, 
nix_lf_Æloc
, \

311 
nix_lf_Æloc_ªq
, 
nix_lf_Æloc_r•
) \

312 
	`M
(
NIX_LF_FREE
, 0x8001, 
nix_lf_‰ì
, 
nix_lf_‰ì_ªq
, 
msg_r•
) \

313 
	`M
(
NIX_AQ_ENQ
, 0x8002, 
nix_aq_íq
, 
nix_aq_íq_ªq
, 
nix_aq_íq_r•
) \

314 
	`M
(
NIX_HWCTX_DISABLE
, 0x8003, 
nix_hw˘x_dißbÀ
, \

315 
hw˘x_dißbÀ_ªq
, 
msg_r•
) \

316 
	`M
(
NIX_TXSCH_ALLOC
, 0x8004, 
nix_txsch_Æloc
, \

317 
nix_txsch_Æloc_ªq
, 
nix_txsch_Æloc_r•
) \

318 
	`M
(
NIX_TXSCH_FREE
, 0x8005, 
nix_txsch_‰ì
, 
nix_txsch_‰ì_ªq
, 
msg_r•
) \

319 
	`M
(
NIX_TXSCHQ_CFG
, 0x8006, 
nix_txschq_cfg
, 
nix_txschq_c⁄fig
, \

320 
nix_txschq_c⁄fig
) \

321 
	`M
(
NIX_STATS_RST
, 0x8007, 
nix_°©s_r°
, 
msg_ªq
, 
msg_r•
) \

322 
	`M
(
NIX_VTAG_CFG
, 0x8008, 
nix_vèg_cfg
, 
nix_vèg_c⁄fig
, \

323 
nix_vèg_c⁄fig_r•
) \

324 
	`M
(
NIX_RSS_FLOWKEY_CFG
, 0x8009, 
nix_rss_Êowkey_cfg
, \

325 
nix_rss_Êowkey_cfg
, \

326 
nix_rss_Êowkey_cfg_r•
) \

327 
	`M
(
NIX_SET_MAC_ADDR
, 0x800a, 
nix_£t_mac_addr
,Çix_£t_mac_addr, 
msg_r•
) \

328 
	`M
(
NIX_SET_RX_MODE
, 0x800b, 
nix_£t_rx_mode
, 
nix_rx_mode
, 
msg_r•
) \

329 
	`M
(
NIX_SET_HW_FRS
, 0x800c, 
nix_£t_hw_‰s
, 
nix_‰s_cfg
, 
msg_r•
) \

330 
	`M
(
NIX_LF_START_RX
, 0x800d, 
nix_lf_°¨t_rx
, 
msg_ªq
, 
msg_r•
) \

331 
	`M
(
NIX_LF_STOP_RX
, 0x800e, 
nix_lf_°›_rx
, 
msg_ªq
, 
msg_r•
) \

332 
	`M
(
NIX_MARK_FORMAT_CFG
, 0x800f, 
nix_m¨k_f‹m©_cfg
, \

333 
nix_m¨k_f‹m©_cfg
, \

334 
nix_m¨k_f‹m©_cfg_r•
) \

335 
	`M
(
NIX_SET_RX_CFG
, 0x8010, 
nix_£t_rx_cfg
, 
nix_rx_cfg
, 
msg_r•
) \

336 
	`M
(
NIX_LSO_FORMAT_CFG
, 0x8011, 
nix_lso_f‹m©_cfg
, \

337 
nix_lso_f‹m©_cfg
, \

338 
nix_lso_f‹m©_cfg_r•
) \

339 
	`M
(
NIX_LF_PTP_TX_ENABLE
, 0x8013, 
nix_lf_±p_tx_íabÀ
, 
msg_ªq
, 
msg_r•
) \

340 
	`M
(
NIX_LF_PTP_TX_DISABLE
, 0x8014, 
nix_lf_±p_tx_dißbÀ
, 
msg_ªq
, 
msg_r•
) \

341 
	`M
(
NIX_SET_VLAN_TPID
, 0x8015, 
nix_£t_vœn_çid
,Çix_£t_vœn_çid, 
msg_r•
) \

342 
	`M
(
NIX_BP_ENABLE
, 0x8016, 
nix_bp_íabÀ
, 
nix_bp_cfg_ªq
, \

343 
nix_bp_cfg_r•
) \

344 
	`M
(
NIX_BP_DISABLE
, 0x8017, 
nix_bp_dißbÀ
, 
nix_bp_cfg_ªq
, 
msg_r•
) \

345 
	`M
(
NIX_GET_MAC_ADDR
, 0x8018, 
nix_gë_mac_addr
, 
msg_ªq
, 
nix_gë_mac_addr_r•
) \

346 
	`M
(
NIX_INLINE_IPSEC_CFG
, 0x8019, 
nix_ölöe_ù£c_cfg
, \

347 
nix_ölöe_ù£c_cfg
, 
msg_r•
) \

348 
	`M
(
NIX_INLINE_IPSEC_LF_CFG
, 0x801a, 
nix_ölöe_ù£c_lf_cfg
, \

349 
nix_ölöe_ù£c_lf_cfg
, 
msg_r•
) \

350 
	`M
(
NIX_CN10K_AQ_ENQ
, 0x801b, 
nix_˙10k_aq_íq
, 
nix_˙10k_aq_íq_ªq
, \

351 
nix_˙10k_aq_íq_r•
) \

352 
	`M
(
NIX_GET_HW_INFO
, 0x801c, 
nix_gë_hw_öfo
, 
msg_ªq
, 
nix_hw_öfo
) \

353 
	`M
(
NIX_BANDPROF_ALLOC
, 0x801d, 
nix_b™d¥of_Æloc
, 
nix_b™d¥of_Æloc_ªq
, \

354 
nix_b™d¥of_Æloc_r•
) \

355 
	`M
(
NIX_BANDPROF_FREE
, 0x801e, 
nix_b™d¥of_‰ì
, 
nix_b™d¥of_‰ì_ªq
, \

356 
msg_r•
) \

357 
	`M
(
NIX_BANDPROF_GET_HWINFO
, 0x801f, 
nix_b™d¥of_gë_hwöfo
, 
msg_ªq
, \

358 
nix_b™d¥of_gë_hwöfo_r•
) \

359 
	`M
(
NIX_CPT_BP_ENABLE
, 0x8020, 
nix_˝t_bp_íabÀ
, 
nix_bp_cfg_ªq
, \

360 
nix_bp_cfg_r•
) \

361 
	`M
(
NIX_CPT_BP_DISABLE
, 0x8021, 
nix_˝t_bp_dißbÀ
, 
nix_bp_cfg_ªq
, \

362 
msg_r•
) \

363 
	`M
(
NIX_RX_SW_SYNC
, 0x8022, 
nix_rx_sw_sync
, 
msg_ªq
, 
msg_r•
) \

364 
	`M
(
NIX_READ_INLINE_IPSEC_CFG
, 0x8023, 
nix_ªad_ölöe_ù£c_cfg
, \

365 
msg_ªq
, 
nix_ölöe_ù£c_cfg
) \

366 
	`M
(
NIX_LF_INLINE_RQ_CFG
, 0x8024, 
nix_lf_ölöe_rq_cfg
, \

367 
nix_rq_˝t_fõld_mask_cfg_ªq
, \

368 
msg_r•
) \

369 
	`M
(
NIX_TL1_RR_PRIO
, 0x8025, 
nix_é1_º_¥io
, 
nix_é1_º_¥io_ªq
, 
msg_r•
) \

370 
	`M
(
NIX_SPI_TO_SA_ADD
, 0x8026, 
nix_•i_to_ß_add
, 
nix_•i_to_ß_add_ªq
, \

371 
nix_•i_to_ß_add_r•
) \

372 
	`M
(
NIX_SPI_TO_SA_DELETE
, 0x8027, 
nix_•i_to_ß_dñëe
, 
nix_•i_to_ß_dñëe_ªq
, \

373 
msg_r•
) \

375 
	`M
(
MCS_ALLOC_RESOURCES
, 0xa000, 
mcs_Æloc_ªsour˚s
, 
mcs_Æloc_r§c_ªq
, \

376 
mcs_Æloc_r§c_r•
) \

377 
	`M
(
MCS_FREE_RESOURCES
, 0xa001, 
mcs_‰ì_ªsour˚s
, 
mcs_‰ì_r§c_ªq
, 
msg_r•
) \

378 
	`M
(
MCS_FLOWID_ENTRY_WRITE
, 0xa002, 
mcs_Êowid_íåy_wrôe
, 
mcs_Êowid_íåy_wrôe_ªq
, \

379 
msg_r•
) \

380 
	`M
(
MCS_SECY_PLCY_WRITE
, 0xa003, 
mcs_£cy_∂cy_wrôe
, 
mcs_£cy_∂cy_wrôe_ªq
, \

381 
msg_r•
) \

382 
	`M
(
MCS_RX_SC_CAM_WRITE
, 0xa004, 
mcs_rx_sc_ˇm_wrôe
, 
mcs_rx_sc_ˇm_wrôe_ªq
, \

383 
msg_r•
) \

384 
	`M
(
MCS_SA_PLCY_WRITE
, 0xa005, 
mcs_ß_∂cy_wrôe
, 
mcs_ß_∂cy_wrôe_ªq
, \

385 
msg_r•
) \

386 
	`M
(
MCS_TX_SC_SA_MAP_WRITE
, 0xa006, 
mcs_tx_sc_ß_m≠_wrôe
, 
mcs_tx_sc_ß_m≠
, \

387 
msg_r•
) \

388 
	`M
(
MCS_RX_SC_SA_MAP_WRITE
, 0xa007, 
mcs_rx_sc_ß_m≠_wrôe
, 
mcs_rx_sc_ß_m≠
, \

389 
msg_r•
) \

390 
	`M
(
MCS_FLOWID_ENA_ENTRY
, 0xa008, 
mcs_Êowid_ía_íåy
, 
mcs_Êowid_ía_dis_íåy
, \

391 
msg_r•
) \

392 
	`M
(
MCS_PN_TABLE_WRITE
, 0xa009, 
mcs_≤_èbÀ_wrôe
, 
mcs_≤_èbÀ_wrôe_ªq
, \

393 
msg_r•
) \

394 
	`M
(
MCS_SET_ACTIVE_LMAC
, 0xa00a, 
mcs_£t_a˘ive_lmac
, mcs_set_active_lmac, \

395 
msg_r•
) \

396 
	`M
(
MCS_GET_HW_INFO
, 0xa00b, 
mcs_gë_hw_öfo
, 
msg_ªq
, 
mcs_hw_öfo
) \

397 
	`M
(
MCS_GET_FLOWID_STATS
, 0xa00c, 
mcs_gë_Êowid_°©s
, 
mcs_°©s_ªq
, \

398 
mcs_Êowid_°©s
) \

399 
	`M
(
MCS_GET_SECY_STATS
, 0xa00d, 
mcs_gë_£cy_°©s
, 
mcs_°©s_ªq
, \

400 
mcs_£cy_°©s
) \

401 
	`M
(
MCS_GET_SC_STATS
, 0xa00e, 
mcs_gë_sc_°©s
, 
mcs_°©s_ªq
, 
mcs_sc_°©s
) \

402 
	`M
(
MCS_GET_SA_STATS
, 0xa00f, 
mcs_gë_ß_°©s
, 
mcs_°©s_ªq
, 
mcs_ß_°©s
) \

403 
	`M
(
MCS_GET_PORT_STATS
, 0xa010, 
mcs_gë_p‹t_°©s
, 
mcs_°©s_ªq
, \

404 
mcs_p‹t_°©s
) \

405 
	`M
(
MCS_CLEAR_STATS
, 0xa011, 
mcs_˛ór_°©s
, mcs_˛ór_°©s, 
msg_r•
) \

406 
	`M
(
MCS_INTR_CFG
, 0xa012, 
mcs_öå_cfg
, mcs_öå_cfg, 
msg_r•
) \

407 
	`M
(
MCS_SET_LMAC_MODE
, 0xa013, 
mcs_£t_lmac_mode
, mcs_£t_lmac_mode, 
msg_r•
) \

408 
	`M
(
MCS_SET_PN_THRESHOLD
, 0xa014, 
mcs_£t_≤_thªshﬁd
, mcs_set_pn_threshold, \

409 
msg_r•
) \

410 
	`M
(
MCS_ALLOC_CTRL_PKT_RULE
, 0xa015, 
mcs_Æloc_˘æ_pkt_ruÀ
, \

411 
mcs_Æloc_˘æ_pkt_ruÀ_ªq
, \

412 
mcs_Æloc_˘æ_pkt_ruÀ_r•
) \

413 
	`M
(
MCS_FREE_CTRL_PKT_RULE
, 0xa016, 
mcs_‰ì_˘æ_pkt_ruÀ
, \

414 
mcs_‰ì_˘æ_pkt_ruÀ_ªq
, 
msg_r•
) \

415 
	`M
(
MCS_CTRL_PKT_RULE_WRITE
, 0xa017, 
mcs_˘æ_pkt_ruÀ_wrôe
, \

416 
mcs_˘æ_pkt_ruÀ_wrôe_ªq
, 
msg_r•
) \

417 
	`M
(
MCS_PORT_RESET
, 0xa018, 
mcs_p‹t_ª£t
, 
mcs_p‹t_ª£t_ªq
, 
msg_r•
) \

418 
	`M
(
MCS_PORT_CFG_SET
, 0xa019, 
mcs_p‹t_cfg_£t
, 
mcs_p‹t_cfg_£t_ªq
, 
msg_r•
) \

419 
	`M
(
MCS_PORT_CFG_GET
, 0xa020, 
mcs_p‹t_cfg_gë
, 
mcs_p‹t_cfg_gë_ªq
, \

420 
mcs_p‹t_cfg_gë_r•
) \

421 
	`M
(
MCS_CUSTOM_TAG_CFG_GET
, 0xa021, 
mcs_cu°om_èg_cfg_gë
, \

422 
mcs_cu°om_èg_cfg_gë_ªq
, \

423 
mcs_cu°om_èg_cfg_gë_r•
) \

424 

	)

427 
	#MBOX_UP_CGX_MESSAGES
 \

428 
	`M
(
CGX_LINK_EVENT
, 0xC00, 
cgx_lök_evít
, 
cgx_lök_öfo_msg
, 
msg_r•
) \

429 
	`M
(
CGX_PTP_RX_INFO
, 0xC01, 
cgx_±p_rx_öfo
, 
cgx_±p_rx_öfo_msg
, 
msg_r•
)

	)

431 
	#MBOX_UP_CPT_MESSAGES
 \

432 
	`M
(
CPT_INST_LMTST
, 0xD00, 
˝t_ö°_lmt°
, 
˝t_ö°_lmt°_ªq
, 
msg_r•
)

	)

434 
	#MBOX_UP_MCS_MESSAGES
 \

435 
	`M
(
MCS_INTR_NOTIFY
, 0xE00, 
mcs_öå_nŸify
, 
mcs_öå_öfo
, 
msg_r•
)

	)

438 
	#M
(
_«me
, 
_id
, 
_1
, 
_2
, 
_3
Ë
MBOX_MSG_
 ## _«mê_id,

	)

439 
MBOX_MESSAGES


440 
MBOX_UP_CGX_MESSAGES


441 
MBOX_UP_CPT_MESSAGES


442 
	mMBOX_UP_MCS_MESSAGES


443 #unde‡
M


448 
	#RVU_DEFAULT_PF_FUNC
 0xFFFF

	)

453 
	smsg_ªq
 {

454 
mbox_msghdr
 
	mhdr
;

460 
	smsg_r•
 {

461 
mbox_msghdr
 
	mhdr
;

467 
	ervu_af_°©us
 {

468 
	mRVU_INVALID_VF_ID
 = -256,

471 
	sªady_msg_r•
 {

472 
mbox_msghdr
 
	mhdr
;

473 
u16
 
	ms˛k_‰eq
;

474 
u16
 
	mr˛k_‰eq
;

494 
	sr§c_©èch
 {

495 
mbox_msghdr
 
	mhdr
;

496 
u8
 
	mmodify
:1;

497 
u8
 
	m≈Æf
:1;

498 
u8
 
	mnixlf
:1;

499 
u16
 
	msso
;

500 
u16
 
	mssow
;

501 
u16
 
	mtimlfs
;

502 
u16
 
	m˝éfs
;

503 
u16
 
	mªñfs
;

504 
	m˝t_blkaddr
;

505 
	mªe_blkaddr
;

513 
	sr§c_dëach
 {

514 
mbox_msghdr
 
	mhdr
;

515 
u8
 
	m∑πül
:1;

516 
u8
 
	m≈Æf
:1;

517 
u8
 
	mnixlf
:1;

518 
u8
 
	msso
:1;

519 
u8
 
	mssow
:1;

520 
u8
 
	mtimlfs
:1;

521 
u8
 
	m˝éfs
:1;

522 
u8
 
	mªñfs
:1;

529 
	s‰ì_r§cs_r•
 {

530 
mbox_msghdr
 
	mhdr
;

531 
u16
 
	mschq
[
NIX_TXSCH_LVL_CNT
];

532 
u16
 
	msso
;

533 
u16
 
	mtim
;

534 
u16
 
	mssow
;

535 
u16
 
	m˝t
;

536 
u8
 
	m≈a
;

537 
u8
 
	mnix
;

538 
u16
 
	mschq_nix1
[
NIX_TXSCH_LVL_CNT
];

539 
u8
 
	mnix1
;

540 
u8
 
	m˝t1
;

541 
u8
 
	mªe0
;

542 
u8
 
	mªe1
;

545 
	#MSIX_VECTOR_INVALID
 0xFFFF

	)

546 
	#MAX_RVU_BLKLF_CNT
 256

	)

548 
	smsix_off£t_r•
 {

549 
mbox_msghdr
 
	mhdr
;

550 
u16
 
	m≈a_msixoff
;

551 
u16
 
	mnix_msixoff
;

552 
u16
 
	msso
;

553 
u16
 
	mssow
;

554 
u16
 
	mtimlfs
;

555 
u16
 
	m˝éfs
;

556 
u16
 
	msso_msixoff
[
MAX_RVU_BLKLF_CNT
];

557 
u16
 
	mssow_msixoff
[
MAX_RVU_BLKLF_CNT
];

558 
u16
 
	mtimlf_msixoff
[
MAX_RVU_BLKLF_CNT
];

559 
u16
 
	m˝éf_msixoff
[
MAX_RVU_BLKLF_CNT
];

560 
u16
 
	m˝t1_lfs
;

561 
u16
 
	mªe0_lfs
;

562 
u16
 
	mªe1_lfs
;

563 
u16
 
	m˝t1_lf_msixoff
[
MAX_RVU_BLKLF_CNT
];

564 
u16
 
	mªe0_lf_msixoff
[
MAX_RVU_BLKLF_CNT
];

565 
u16
 
	mªe1_lf_msixoff
[
MAX_RVU_BLKLF_CNT
];

570 
	scgx_°©s_r•
 {

571 
mbox_msghdr
 
	mhdr
;

572 
	#CGX_RX_STATS_COUNT
 9

	)

573 
	#CGX_TX_STATS_COUNT
 18

	)

574 
u64
 
	mrx_°©s
[
CGX_RX_STATS_COUNT
];

575 
u64
 
	mtx_°©s
[
CGX_TX_STATS_COUNT
];

578 
	scgx_„c_°©s_r•
 {

579 
mbox_msghdr
 
	mhdr
;

580 
u64
 
	m„c_c‹r_blks
;

581 
u64
 
	m„c_unc‹r_blks
;

586 
	scgx_mac_addr_£t_‹_gë
 {

587 
mbox_msghdr
 
	mhdr
;

588 
u8
 
	mmac_addr
[
ETH_ALEN
];

589 
u32
 
	mödex
;

595 
	scgx_mac_addr_add_ªq
 {

596 
mbox_msghdr
 
	mhdr
;

597 
u8
 
	mmac_addr
[
ETH_ALEN
];

603 
	scgx_mac_addr_add_r•
 {

604 
mbox_msghdr
 
	mhdr
;

605 
u32
 
	mödex
;

611 
	scgx_mac_addr_dñ_ªq
 {

612 
mbox_msghdr
 
	mhdr
;

613 
u32
 
	mödex
;

619 
	scgx_max_dmac_íåõs_gë_r•
 {

620 
mbox_msghdr
 
	mhdr
;

621 
u32
 
	mmax_dmac_fûãrs
;

624 
	scgx_lök_u£r_öfo
 {

625 
uöt64_t
 
	mlök_up
:1;

626 
uöt64_t
 
	mfuŒ_du∂ex
:1;

627 
uöt64_t
 
	mlmac_ty≥_id
:4;

628 
uöt64_t
 
	m•ìd
:20;

629 
uöt64_t
 
	m™
:1;

630 
uöt64_t
 
	m„c
:2;

631 
	#LMACTYPE_STR_LEN
 16

	)

632 
	mlmac_ty≥
[
LMACTYPE_STR_LEN
];

635 
	scgx_lök_öfo_msg
 {

636 
mbox_msghdr
 
	mhdr
;

637 
cgx_lök_u£r_öfo
 
	mlök_öfo
;

640 
	scgx_±p_rx_öfo_msg
 {

641 
mbox_msghdr
 
	mhdr
;

642 
u8
 
	m±p_í
;

645 
	scgx_∑u£_‰m_cfg
 {

646 
mbox_msghdr
 
	mhdr
;

647 
u8
 
	m£t
;

650 
u8
 
	mrx_∑u£
;

651 
u8
 
	mtx_∑u£
;

654 
	e„c_ty≥
 {

655 
	mOTX2_FEC_NONE
,

656 
	mOTX2_FEC_BASER
,

657 
	mOTX2_FEC_RS
,

658 
	mOTX2_FEC_STATS_CNT
 = 2,

659 
	mOTX2_FEC_OFF
,

662 
	s„c_mode
 {

663 
mbox_msghdr
 
	mhdr
;

664 
	m„c
;

667 
	ssÂ_ì¥om_s
 {

668 
	#SFP_EEPROM_SIZE
 256

	)

669 
u16
 
	msff_id
;

670 
u8
 
	mbuf
[
SFP_EEPROM_SIZE
];

671 
u64
 
	mª£rved
;

674 
	sphy_s
 {

676 
u64
 
	mˇn_ch™ge_mod_ty≥
:1;

677 
u64
 
	mmod_ty≥
:1;

678 
u64
 
	mhas_„c_°©s
:1;

679 } 
	mmisc
;

680 
	s„c_°©s_s
 {

681 
u32
 
	mrs„c_c‹r_cws
;

682 
u32
 
	mrs„c_unc‹r_cws
;

683 
u32
 
	mbr„c_c‹r_blks
;

684 
u32
 
	mbr„c_unc‹r_blks
;

685 } 
	m„c_°©s
;

688 
	scgx_lmac_fwd©a_s
 {

689 
u16
 
	mrw_vÆid
;

690 
u64
 
	msuµ‹ãd_„c
;

691 
u64
 
	msuµ‹ãd_™
;

692 
u64
 
	msuµ‹ãd_lök_modes
;

694 
u64
 
	madvîti£d_„c
;

695 
u64
 
	madvîti£d_lök_modes
;

697 
sÂ_ì¥om_s
 
	msÂ_ì¥om
;

698 
phy_s
 
	mphy
;

699 
	#LMAC_FWDATA_RESERVED_MEM
 1021

	)

700 
u64
 
	mª£rved
[
LMAC_FWDATA_RESERVED_MEM
];

703 
	scgx_fw_d©a
 {

704 
mbox_msghdr
 
	mhdr
;

705 
cgx_lmac_fwd©a_s
 
	mfwd©a
;

708 
	scgx_£t_lök_mode_¨gs
 {

709 
u32
 
	m•ìd
;

710 
u8
 
	mdu∂ex
;

711 
u8
 
	m™
;

712 
u8
 
	mmode_ba£idx
;

713 
u64
 
	mmode
;

716 
	scgx_£t_lök_mode_ªq
 {

717 
	#AUTONEG_UNKNOWN
 0xff

	)

718 
mbox_msghdr
 
	mhdr
;

719 
cgx_£t_lök_mode_¨gs
 
	m¨gs
;

722 
	scgx_£t_lök_mode_r•
 {

723 
mbox_msghdr
 
	mhdr
;

724 
	m°©us
;

727 
	scgx_£t_lök_°©e_msg
 {

728 
mbox_msghdr
 
	mhdr
;

729 
u8
 
	míabÀ
;

732 
	scgx_phy_mod_ty≥
 {

733 
mbox_msghdr
 
	mhdr
;

734 
	mmod
;

737 
	scgx_mac_addr_ª£t_ªq
 {

738 
mbox_msghdr
 
	mhdr
;

739 
u32
 
	mödex
;

742 
	scgx_mac_addr_upd©e_ªq
 {

743 
mbox_msghdr
 
	mhdr
;

744 
u8
 
	mmac_addr
[
ETH_ALEN
];

745 
u32
 
	mödex
;

748 
	scgx_mac_addr_upd©e_r•
 {

749 
mbox_msghdr
 
	mhdr
;

750 
u32
 
	mödex
;

753 
	#RVU_LMAC_FEAT_FC
 
	`BIT_ULL
(0Ë

	)

754 
	#RVU_LMAC_FEAT_HIGIG2
 
	`BIT_ULL
(1)

	)

756 
	#RVU_LMAC_FEAT_PTP
 
	`BIT_ULL
(2Ë

	)

757 
	#RVU_LMAC_FEAT_DMACF
 
	`BIT_ULL
(3Ë

	)

758 
	#RVU_MAC_VERSION
 
	`BIT_ULL
(4)

	)

759 
	#RVU_MAC_CGX
 
	`BIT_ULL
(5)

	)

760 
	#RVU_MAC_RPM
 
	`BIT_ULL
(6)

	)

762 
	scgx_„©uªs_öfo_msg
 {

763 
mbox_msghdr
 
	mhdr
;

764 
u64
 
	mlmac_„©uªs
;

767 
	sΩm_°©s_r•
 {

768 
mbox_msghdr
 
	mhdr
;

769 
	#RPM_RX_STATS_COUNT
 43

	)

770 
	#RPM_TX_STATS_COUNT
 34

	)

771 
u64
 
	mrx_°©s
[
RPM_RX_STATS_COUNT
];

772 
u64
 
	mtx_°©s
[
RPM_TX_STATS_COUNT
];

775 
	scgx_pfc_cfg
 {

776 
mbox_msghdr
 
	mhdr
;

777 
u8
 
	mrx_∑u£
;

778 
u8
 
	mtx_∑u£
;

779 
u16
 
	mpfc_í
;

782 
	scgx_pfc_r•
 {

783 
mbox_msghdr
 
	mhdr
;

784 
u8
 
	mrx_∑u£
;

785 
u8
 
	mtx_∑u£
;

790 
	s≈c_£t_pköd
 {

791 
mbox_msghdr
 
	mhdr
;

792 
	#OTX2_PRIV_FLAGS_DEFAULT
 
	`BIT_ULL
(0)

	)

793 
	#OTX2_PRIV_FLAGS_EDSA
 
	`BIT_ULL
(1)

	)

794 
	#OTX2_PRIV_FLAGS_HIGIG
 
	`BIT_ULL
(2)

	)

795 
	#OTX2_PRIV_FLAGS_FDSA
 
	`BIT_ULL
(3)

	)

796 
	#OTX2_PRIV_FLAGS_CUSTOM
 
	`BIT_ULL
(63)

	)

797 
u64
 
	mmode
;

798 
	#PKIND_TX
 
	`BIT_ULL
(0)

	)

799 
	#PKIND_RX
 
	`BIT_ULL
(1)

	)

800 
u8
 
	mdú
;

801 
u8
 
	mpköd
;

802 
u8
 
	mv¨_Àn_off
;

805 
u8
 
	mv¨_Àn_off_mask
;

806 
u8
 
	mshi·_dú
;

814 
	e≈a_af_°©us
 {

815 
	mNPA_AF_ERR_PARAM
 = -301,

816 
	mNPA_AF_ERR_AQ_FULL
 = -302,

817 
	mNPA_AF_ERR_AQ_ENQUEUE
 = -303,

818 
	mNPA_AF_ERR_AF_LF_INVALID
 = -304,

819 
	mNPA_AF_ERR_AF_LF_ALLOC
 = -305,

820 
	mNPA_AF_ERR_LF_RESET
 = -306,

824 
	s≈a_lf_Æloc_ªq
 {

825 
mbox_msghdr
 
	mhdr
;

826 
	mnode
;

827 
	mauø_sz
;

828 
u32
 
	mƒ_poﬁs
;

829 
u64
 
	mway_mask
;

832 
	s≈a_lf_Æloc_r•
 {

833 
mbox_msghdr
 
	mhdr
;

834 
u32
 
	m°ack_pg_±rs
;

835 
u32
 
	m°ack_pg_byãs
;

836 
u16
 
	mqöts
;

837 
u8
 
	mˇche_löes
;

841 
	s≈a_aq_íq_ªq
 {

842 
mbox_msghdr
 
	mhdr
;

843 
u32
 
	mauø_id
;

844 
u8
 
	m˘y≥
;

845 
u8
 
	m›
;

851 
≈a_auø_s
 
	mauø
;

853 
≈a_poﬁ_s
 
	mpoﬁ
;

858 
≈a_auø_s
 
	mauø_mask
;

860 
≈a_poﬁ_s
 
	mpoﬁ_mask
;

864 
	s≈a_aq_íq_r•
 {

865 
mbox_msghdr
 
	mhdr
;

868 
≈a_auø_s
 
	mauø
;

870 
≈a_poﬁ_s
 
	mpoﬁ
;

875 
	shw˘x_dißbÀ_ªq
 {

876 
mbox_msghdr
 
	mhdr
;

877 
u8
 
	m˘y≥
;

885 
	enix_af_°©us
 {

886 
	mNIX_AF_ERR_PARAM
 = -401,

887 
	mNIX_AF_ERR_AQ_FULL
 = -402,

888 
	mNIX_AF_ERR_AQ_ENQUEUE
 = -403,

889 
	mNIX_AF_ERR_AF_LF_INVALID
 = -404,

890 
	mNIX_AF_ERR_AF_LF_ALLOC
 = -405,

891 
	mNIX_AF_ERR_TLX_ALLOC_FAIL
 = -406,

892 
	mNIX_AF_ERR_TLX_INVALID
 = -407,

893 
	mNIX_AF_ERR_RSS_SIZE_INVALID
 = -408,

894 
	mNIX_AF_ERR_RSS_GRPS_INVALID
 = -409,

895 
	mNIX_AF_ERR_FRS_INVALID
 = -410,

896 
	mNIX_AF_ERR_RX_LINK_INVALID
 = -411,

897 
	mNIX_AF_INVAL_TXSCHQ_CFG
 = -412,

898 
	mNIX_AF_SMQ_FLUSH_FAILED
 = -413,

899 
	mNIX_AF_ERR_LF_RESET
 = -414,

900 
	mNIX_AF_ERR_RSS_NOSPC_FIELD
 = -415,

901 
	mNIX_AF_ERR_RSS_NOSPC_ALGO
 = -416,

902 
	mNIX_AF_ERR_MARK_CFG_FAIL
 = -417,

903 
	mNIX_AF_ERR_LSO_CFG_FAIL
 = -418,

904 
	mNIX_AF_INVAL_NPA_PF_FUNC
 = -419,

905 
	mNIX_AF_INVAL_SSO_PF_FUNC
 = -420,

906 
	mNIX_AF_ERR_TX_VTAG_NOSPC
 = -421,

907 
	mNIX_AF_ERR_RX_VTAG_INUSE
 = -422,

908 
	mNIX_AF_ERR_PTP_CONFIG_FAIL
 = -423,

909 
	mNIX_AF_ERR_NPC_KEY_NOT_SUPP
 = -424,

910 
	mNIX_AF_ERR_INVALID_NIXBLK
 = -425,

911 
	mNIX_AF_ERR_INVALID_BANDPROF
 = -426,

912 
	mNIX_AF_ERR_IPOLICER_NOTSUPP
 = -427,

913 
	mNIX_AF_ERR_BANDPROF_INVAL_REQ
 = -428,

914 
	mNIX_AF_ERR_CQ_CTX_WRITE_ERR
 = -429,

915 
	mNIX_AF_ERR_AQ_CTX_RETRY_WRITE
 = -430,

916 
	mNIX_AF_ERR_LINK_CREDITS
 = -431,

917 
	mNIX_AF_ERR_RQ_CPT_MASK
 = -432,

918 
	mNIX_AF_ERR_TL1_RR_PRIO_PERM_DENIED
 = -433,

922 
	enix_rx_vèg0_ty≥
 {

923 
	mNIX_AF_LFX_RX_VTAG_TYPE0
,

924 
	mNIX_AF_LFX_RX_VTAG_TYPE1
,

925 
	mNIX_AF_LFX_RX_VTAG_TYPE2
,

926 
	mNIX_AF_LFX_RX_VTAG_TYPE3
,

927 
	mNIX_AF_LFX_RX_VTAG_TYPE4
,

928 
	mNIX_AF_LFX_RX_VTAG_TYPE5
,

929 
	mNIX_AF_LFX_RX_VTAG_TYPE6
,

930 
	mNIX_AF_LFX_RX_VTAG_TYPE7
,

934 
	snix_•i_to_ß_add_ªq
 {

935 
mbox_msghdr
 
	mhdr
;

936 
u32
 
	mß_ödex
;

937 
u32
 
	m•i_ödex
;

938 
u16
 
	mm©ch_id
;

939 
boﬁ
 
	mvÆid
;

942 
	snix_•i_to_ß_add_r•
 {

943 
mbox_msghdr
 
	mhdr
;

944 
u16
 
	mhash_ödex
;

945 
u8
 
	mway
;

946 
u8
 
	mis_du∂iˇã
;

950 
	snix_•i_to_ß_dñëe_ªq
 {

951 
mbox_msghdr
 
	mhdr
;

952 
u16
 
	mhash_ödex
;

953 
u8
 
	mway
;

957 
	snix_lf_Æloc_ªq
 {

958 
mbox_msghdr
 
	mhdr
;

959 
	mnode
;

960 
u32
 
	mrq_˙t
;

961 
u32
 
	msq_˙t
;

962 
u32
 
	mcq_˙t
;

963 
u8
 
	mxqe_sz
;

964 
u16
 
	mrss_sz
;

965 
u8
 
	mrss_gΩs
;

966 
u16
 
	m≈a_func
;

967 
u16
 
	msso_func
;

968 
u64
 
	mrx_cfg
;

969 
u64
 
	mway_mask
;

970 
	#NIX_LF_RSS_TAG_LSB_AS_ADDER
 
	`BIT_ULL
(0)

	)

971 
	#NIX_LF_LBK_BLK_SEL
 
	`BIT_ULL
(1)

	)

972 
u64
 
	mÊags
;

975 
	snix_lf_Æloc_r•
 {

976 
mbox_msghdr
 
	mhdr
;

977 
u16
 
	msqb_size
;

978 
u16
 
	mrx_ch™_ba£
;

979 
u16
 
	mtx_ch™_ba£
;

980 
u8
 
	mrx_ch™_˙t
;

981 
u8
 
	mtx_ch™_˙t
;

982 
u8
 
	mlso_tsov4_idx
;

983 
u8
 
	mlso_tsov6_idx
;

984 
u8
 
	mmac_addr
[
ETH_ALEN
];

985 
u8
 
	mlf_rx_°©s
;

986 
u8
 
	mlf_tx_°©s
;

987 
u16
 
	mcöts
;

988 
u16
 
	mqöts
;

989 
u8
 
	mhw_rx_t°amp_í
;

990 
u8
 
	mcgx_löks
;

991 
u8
 
	mlbk_löks
;

992 
u8
 
	msdp_löks
;

993 
u8
 
	mtx_lök
;

996 
	snix_lf_‰ì_ªq
 {

997 
mbox_msghdr
 
	mhdr
;

998 
	#NIX_LF_DISABLE_FLOWS
 
	`BIT_ULL
(0)

	)

999 
	#NIX_LF_DONT_FREE_TX_VTAG
 
	`BIT_ULL
(1)

	)

1000 
u64
 
	mÊags
;

1004 
	snix_˙10k_aq_íq_ªq
 {

1005 
mbox_msghdr
 
	mhdr
;

1006 
u32
 
	mqidx
;

1007 
u8
 
	m˘y≥
;

1008 
u8
 
	m›
;

1010 
nix_˙10k_rq_˘x_s
 
	mrq
;

1011 
nix_˙10k_sq_˘x_s
 
	msq
;

1012 
nix_cq_˘x_s
 
	mcq
;

1013 
nix_rs£_s
 
	mrss
;

1014 
nix_rx_m˚_s
 
	mm˚
;

1015 
nix_b™d¥of_s
 
	m¥of
;

1018 
nix_˙10k_rq_˘x_s
 
	mrq_mask
;

1019 
nix_˙10k_sq_˘x_s
 
	msq_mask
;

1020 
nix_cq_˘x_s
 
	mcq_mask
;

1021 
nix_rs£_s
 
	mrss_mask
;

1022 
nix_rx_m˚_s
 
	mm˚_mask
;

1023 
nix_b™d¥of_s
 
	m¥of_mask
;

1027 
	snix_˙10k_aq_íq_r•
 {

1028 
mbox_msghdr
 
	mhdr
;

1030 
nix_˙10k_rq_˘x_s
 
	mrq
;

1031 
nix_˙10k_sq_˘x_s
 
	msq
;

1032 
nix_cq_˘x_s
 
	mcq
;

1033 
nix_rs£_s
 
	mrss
;

1034 
nix_rx_m˚_s
 
	mm˚
;

1035 
nix_b™d¥of_s
 
	m¥of
;

1040 
	snix_aq_íq_ªq
 {

1041 
mbox_msghdr
 
	mhdr
;

1042 
u32
 
	mqidx
;

1043 
u8
 
	m˘y≥
;

1044 
u8
 
	m›
;

1046 
nix_rq_˘x_s
 
	mrq
;

1047 
nix_sq_˘x_s
 
	msq
;

1048 
nix_cq_˘x_s
 
	mcq
;

1049 
nix_rs£_s
 
	mrss
;

1050 
nix_rx_m˚_s
 
	mm˚
;

1051 
u64
 
	m¥of
;

1054 
nix_rq_˘x_s
 
	mrq_mask
;

1055 
nix_sq_˘x_s
 
	msq_mask
;

1056 
nix_cq_˘x_s
 
	mcq_mask
;

1057 
nix_rs£_s
 
	mrss_mask
;

1058 
nix_rx_m˚_s
 
	mm˚_mask
;

1059 
u64
 
	m¥of_mask
;

1063 
	snix_aq_íq_r•
 {

1064 
mbox_msghdr
 
	mhdr
;

1066 
nix_rq_˘x_s
 
	mrq
;

1067 
nix_sq_˘x_s
 
	msq
;

1068 
nix_cq_˘x_s
 
	mcq
;

1069 
nix_rs£_s
 
	mrss
;

1070 
nix_rx_m˚_s
 
	mm˚
;

1071 
nix_b™d¥of_s
 
	m¥of
;

1077 
	#MAX_TXSCHQ_PER_FUNC
 128

	)

1079 
	snix_txsch_Æloc_ªq
 {

1080 
mbox_msghdr
 
	mhdr
;

1082 
u16
 
	mschq_c⁄tig
[
NIX_TXSCH_LVL_CNT
];

1083 
u16
 
	mschq
[
NIX_TXSCH_LVL_CNT
];

1086 
	snix_txsch_Æloc_r•
 {

1087 
mbox_msghdr
 
	mhdr
;

1089 
u16
 
	mschq_c⁄tig
[
NIX_TXSCH_LVL_CNT
];

1090 
u16
 
	mschq
[
NIX_TXSCH_LVL_CNT
];

1092 
u16
 
	mschq_c⁄tig_li°
[
NIX_TXSCH_LVL_CNT
][
MAX_TXSCHQ_PER_FUNC
];

1093 
u16
 
	mschq_li°
[
NIX_TXSCH_LVL_CNT
][
MAX_TXSCHQ_PER_FUNC
];

1094 
u8
 
	maggr_Àvñ
;

1095 
u8
 
	maggr_lvl_º_¥io
;

1096 
u8
 
	mlök_cfg_lvl
;

1099 
	snix_txsch_‰ì_ªq
 {

1100 
mbox_msghdr
 
	mhdr
;

1101 
	#TXSCHQ_FREE_ALL
 
	`BIT_ULL
(0)

	)

1102 
u16
 
	mÊags
;

1104 
u16
 
	mschq_lvl
;

1106 
u16
 
	mschq
;

1109 
	snix_txschq_c⁄fig
 {

1110 
mbox_msghdr
 
	mhdr
;

1111 
u8
 
	mlvl
;

1112 
u8
 
	mªad
;

1113 
	#TXSCHQ_IDX_SHIFT
 16

	)

1114 
	#TXSCHQ_IDX_MASK
 (
	`BIT_ULL
(10Ë- 1)

	)

1115 
	#TXSCHQ_IDX
(
ªg
, 
shi·
Ë((‘egË>> (shi·)Ë& 
TXSCHQ_IDX_MASK
)

	)

1116 
u8
 
	mnum_ªgs
;

1117 
	#MAX_REGS_PER_MBOX_MSG
 20

	)

1118 
u64
 
	mªg
[
MAX_REGS_PER_MBOX_MSG
];

1119 
u64
 
	mªgvÆ
[
MAX_REGS_PER_MBOX_MSG
];

1121 
u64
 
	mªgvÆ_mask
[
MAX_REGS_PER_MBOX_MSG
];

1124 
	snix_vèg_c⁄fig
 {

1125 
mbox_msghdr
 
	mhdr
;

1127 
u8
 
	mvèg_size
;

1131 
u8
 
	mcfg_ty≥
;

1135 
u64
 
	mvèg0
;

1136 
u64
 
	mvèg1
;

1142 
u8
 
	mcfg_vèg0
 :1;

1144 
u8
 
	mcfg_vèg1
 :1;

1155 
	mvèg0_idx
;

1156 
	mvèg1_idx
;

1164 
u8
 
	m‰ì_vèg0
 :1;

1168 
u8
 
	m‰ì_vèg1
 :1;

1169 } 
	mtx
;

1174 
u8
 
	mvèg_ty≥
;

1176 
u8
 
	m°rù_vèg
 :1;

1178 
u8
 
	mˇ±uª_vèg
 :1;

1179 } 
	mrx
;

1183 
	snix_vèg_c⁄fig_r•
 {

1184 
mbox_msghdr
 
	mhdr
;

1185 
	mvèg0_idx
;

1186 
	mvèg1_idx
;

1194 
	#NIX_FLOW_KEY_TYPE_L3_L4_MASK
 (~(0x‡<< 28))

	)

1196 
	snix_rss_Êowkey_cfg
 {

1197 
mbox_msghdr
 
	mhdr
;

1198 
	mmˇm_ödex
;

1199 
	#NIX_FLOW_KEY_TYPE_PORT
 
	`BIT
(0)

	)

1200 
	#NIX_FLOW_KEY_TYPE_IPV4
 
	`BIT
(1)

	)

1201 
	#NIX_FLOW_KEY_TYPE_IPV6
 
	`BIT
(2)

	)

1202 
	#NIX_FLOW_KEY_TYPE_TCP
 
	`BIT
(3)

	)

1203 
	#NIX_FLOW_KEY_TYPE_UDP
 
	`BIT
(4)

	)

1204 
	#NIX_FLOW_KEY_TYPE_SCTP
 
	`BIT
(5)

	)

1205 
	#NIX_FLOW_KEY_TYPE_NVGRE
 
	`BIT
(6)

	)

1206 
	#NIX_FLOW_KEY_TYPE_VXLAN
 
	`BIT
(7)

	)

1207 
	#NIX_FLOW_KEY_TYPE_GENEVE
 
	`BIT
(8)

	)

1208 
	#NIX_FLOW_KEY_TYPE_ETH_DMAC
 
	`BIT
(9)

	)

1209 
	#NIX_FLOW_KEY_TYPE_IPV6_EXT
 
	`BIT
(10)

	)

1210 
	#NIX_FLOW_KEY_TYPE_GTPU
 
	`BIT
(11)

	)

1211 
	#NIX_FLOW_KEY_TYPE_INNR_IPV4
 
	`BIT
(12)

	)

1212 
	#NIX_FLOW_KEY_TYPE_INNR_IPV6
 
	`BIT
(13)

	)

1213 
	#NIX_FLOW_KEY_TYPE_INNR_TCP
 
	`BIT
(14)

	)

1214 
	#NIX_FLOW_KEY_TYPE_INNR_UDP
 
	`BIT
(15)

	)

1215 
	#NIX_FLOW_KEY_TYPE_INNR_SCTP
 
	`BIT
(16)

	)

1216 
	#NIX_FLOW_KEY_TYPE_INNR_ETH_DMAC
 
	`BIT
(17)

	)

1217 
	#NIX_FLOW_KEY_TYPE_CH_LEN_90B
 
	`BIT
(18)

	)

1218 
	#NIX_FLOW_KEY_TYPE_CUSTOM0
 
	`BIT
(19)

	)

1219 
	#NIX_FLOW_KEY_TYPE_VLAN
 
	`BIT
(20)

	)

1220 
	#NIX_FLOW_KEY_TYPE_IPV4_PROTO
 
	`BIT
(21)

	)

1221 
	#NIX_FLOW_KEY_TYPE_AH
 
	`BIT
(22)

	)

1222 
	#NIX_FLOW_KEY_TYPE_ESP
 
	`BIT
(23)

	)

1223 
	#NIX_FLOW_KEY_TYPE_L4_DST_ONLY
 
	`BIT
(28)

	)

1224 
	#NIX_FLOW_KEY_TYPE_L4_SRC_ONLY
 
	`BIT
(29)

	)

1225 
	#NIX_FLOW_KEY_TYPE_L3_DST_ONLY
 
	`BIT
(30)

	)

1226 
	#NIX_FLOW_KEY_TYPE_L3_SRC_ONLY
 
	`BIT
(31)

	)

1227 
u32
 
	mÊowkey_cfg
;

1228 
u8
 
	mgroup
;

1231 
	snix_rss_Êowkey_cfg_r•
 {

1232 
mbox_msghdr
 
	mhdr
;

1233 
u8
 
	mÆg_idx
;

1236 
	snix_£t_mac_addr
 {

1237 
mbox_msghdr
 
	mhdr
;

1238 
u8
 
	mmac_addr
[
ETH_ALEN
];

1241 
	snix_gë_mac_addr_r•
 {

1242 
mbox_msghdr
 
	mhdr
;

1243 
u8
 
	mmac_addr
[
ETH_ALEN
];

1246 
	snix_m¨k_f‹m©_cfg
 {

1247 
mbox_msghdr
 
	mhdr
;

1248 
u8
 
	moff£t
;

1249 
u8
 
	my_mask
;

1250 
u8
 
	my_vÆ
;

1251 
u8
 
	mr_mask
;

1252 
u8
 
	mr_vÆ
;

1255 
	snix_m¨k_f‹m©_cfg_r•
 {

1256 
mbox_msghdr
 
	mhdr
;

1257 
u8
 
	mm¨k_f‹m©_idx
;

1260 
	snix_rq_˝t_fõld_mask_cfg_ªq
 {

1261 
mbox_msghdr
 
	mhdr
;

1262 
	#RQ_CTX_MASK_MAX
 6

	)

1264 
u64
 
	mrq_˘x_w‹d_£t
[
RQ_CTX_MASK_MAX
];

1265 
nix_˙10k_rq_˘x_s
 
	mrq_£t
;

1268 
u64
 
	mrq_˘x_w‹d_mask
[
RQ_CTX_MASK_MAX
];

1269 
nix_˙10k_rq_˘x_s
 
	mrq_mask
;

1271 
	snix_lf_rx_ùec_cfg1_ªq
 {

1272 
u32
 
	m•b_˝t_auø
;

1273 
u8
 
	mrq_mask_íabÀ
;

1274 
u8
 
	m•b_˝t_sizem1
;

1275 
u8
 
	m•b_˝t_íabÀ
;

1276 } 
	mù£c_cfg1
;

1279 
	snix_rx_mode
 {

1280 
mbox_msghdr
 
	mhdr
;

1281 
	#NIX_RX_MODE_UCAST
 
	`BIT
(0)

	)

1282 
	#NIX_RX_MODE_PROMISC
 
	`BIT
(1)

	)

1283 
	#NIX_RX_MODE_ALLMULTI
 
	`BIT
(2)

	)

1284 
	#NIX_RX_MODE_USE_MCE
 
	`BIT
(3)

	)

1285 
u16
 
	mmode
;

1288 
	snix_rx_cfg
 {

1289 
mbox_msghdr
 
	mhdr
;

1290 
	#NIX_RX_OL3_VERIFY
 
	`BIT
(0)

	)

1291 
	#NIX_RX_OL4_VERIFY
 
	`BIT
(1)

	)

1292 
	#NIX_RX_DROP_RE
 
	`BIT
(2)

	)

1293 
u8
 
	mÀn_vîify
;

1294 
	#NIX_RX_CSUM_OL4_VERIFY
 
	`BIT
(0)

	)

1295 
u8
 
	mcsum_vîify
;

1298 
	snix_‰s_cfg
 {

1299 
mbox_msghdr
 
	mhdr
;

1300 
u8
 
	mupd©e_smq
;

1301 
u8
 
	mupd©e_möÀn
;

1302 
u8
 
	msdp_lök
;

1303 
u16
 
	mmaxÀn
;

1304 
u16
 
	mmöÀn
;

1307 
	snix_lso_f‹m©_cfg
 {

1308 
mbox_msghdr
 
	mhdr
;

1309 
u64
 
	mfõld_mask
;

1310 
	#NIX_LSO_FIELD_MAX
 8

	)

1311 
u64
 
	mfõlds
[
NIX_LSO_FIELD_MAX
];

1314 
	snix_lso_f‹m©_cfg_r•
 {

1315 
mbox_msghdr
 
	mhdr
;

1316 
u8
 
	mlso_f‹m©_idx
;

1319 
	snix_£t_vœn_çid
 {

1320 
mbox_msghdr
 
	mhdr
;

1321 
	#NIX_VLAN_TYPE_INNER
 0

	)

1322 
	#NIX_VLAN_TYPE_OUTER
 1

	)

1323 
u8
 
	mvœn_ty≥
;

1324 
u16
 
	mçid
;

1327 
	snix_bp_cfg_ªq
 {

1328 
mbox_msghdr
 
	mhdr
;

1329 
u16
 
	mch™_ba£
;

1330 
u8
 
	mch™_˙t
;

1331 
u8
 
	mbpid_≥r_ch™
;

1339 
	#NIX_MAX_BPID_CHAN
 256

	)

1340 
	snix_bp_cfg_r•
 {

1341 
mbox_msghdr
 
	mhdr
;

1342 
u16
 
	mch™_bpid
[
NIX_MAX_BPID_CHAN
];

1343 
u8
 
	mch™_˙t
;

1347 
	snix_ölöe_ù£c_cfg
 {

1348 
mbox_msghdr
 
	mhdr
;

1349 
u32
 
	m˝t_¸edô
;

1351 
u8
 
	megΩ
;

1352 
u16
 
	m›code
;

1353 
u16
 
	m∑øm1
;

1354 
u16
 
	m∑øm2
;

1355 } 
	mgí_cfg
;

1357 
u16
 
	m˝t_pf_func
;

1358 
u8
 
	m˝t_¶Ÿ
;

1359 } 
	mö°_q£l
;

1360 
u8
 
	míabÀ
;

1364 
	snix_ölöe_ù£c_lf_cfg
 {

1365 
mbox_msghdr
 
	mhdr
;

1366 
u64
 
	mß_ba£_addr
;

1368 
u32
 
	mèg_c⁄°
;

1369 
u16
 
	mÀnm1_max
;

1370 
u8
 
	mß_pow2_size
;

1371 
u8
 
	mâ
;

1372 } 
	mù£c_cfg0
;

1374 
u32
 
	mß_idx_max
;

1375 
u8
 
	mß_idx_w
;

1376 } 
	mù£c_cfg1
;

1377 
u8
 
	míabÀ
;

1380 
	snix_hw_öfo
 {

1381 
mbox_msghdr
 
	mhdr
;

1382 
u16
 
	mvwqe_dñay
;

1383 
u16
 
	mmax_mtu
;

1384 
u16
 
	mmö_mtu
;

1385 
u32
 
	mΩm_dwº_mtu
;

1386 
u32
 
	msdp_dwº_mtu
;

1387 
u32
 
	mlbk_dwº_mtu
;

1388 
u32
 
	mrsvd32
[1];

1389 
u64
 
	mrsvd
[15];

1392 
	snix_b™d¥of_Æloc_ªq
 {

1393 
mbox_msghdr
 
	mhdr
;

1395 
u16
 
	m¥of_cou¡
[
BAND_PROF_NUM_LAYERS
];

1398 
	snix_b™d¥of_Æloc_r•
 {

1399 
mbox_msghdr
 
	mhdr
;

1400 
u16
 
	m¥of_cou¡
[
BAND_PROF_NUM_LAYERS
];

1406 
	#MAX_BANDPROF_PER_PFFUNC
 64

	)

1407 
u16
 
	m¥of_idx
[
BAND_PROF_NUM_LAYERS
][
MAX_BANDPROF_PER_PFFUNC
];

1410 
	snix_b™d¥of_‰ì_ªq
 {

1411 
mbox_msghdr
 
	mhdr
;

1412 
u8
 
	m‰ì_Æl
;

1413 
u16
 
	m¥of_cou¡
[
BAND_PROF_NUM_LAYERS
];

1414 
u16
 
	m¥of_idx
[
BAND_PROF_NUM_LAYERS
][
MAX_BANDPROF_PER_PFFUNC
];

1417 
	snix_b™d¥of_gë_hwöfo_r•
 {

1418 
mbox_msghdr
 
	mhdr
;

1419 
u16
 
	m¥of_cou¡
[
BAND_PROF_NUM_LAYERS
];

1420 
u32
 
	mpﬁi˚r_timeunô
;

1423 
	snix_é1_º_¥io_ªq
 {

1424 
mbox_msghdr
 
	mhdr
;

1425 
u8
 
	mé1_º_¥io
;

1431 
	esso_af_°©us
 {

1432 
	mSSO_AF_ERR_PARAM
 = -501,

1433 
	mSSO_AF_ERR_LF_INVALID
 = -502,

1434 
	mSSO_AF_ERR_AF_LF_ALLOC
 = -503,

1435 
	mSSO_AF_ERR_GRP_EBUSY
 = -504,

1436 
	mSSO_AF_INVAL_NPA_PF_FUNC
 = -505,

1437 
	mSSO_AF_ERR_INVALID_CFG
 = -506,

1440 
	ssso_lf_Æloc_ªq
 {

1441 
mbox_msghdr
 
	mhdr
;

1442 
	mnode
;

1443 
u16
 
	mhwgΩs
;

1446 
	ssso_lf_Æloc_r•
 {

1447 
mbox_msghdr
 
	mhdr
;

1448 
u32
 
	mxaq_buf_size
;

1449 
u32
 
	mxaq_wq_íåõs
;

1450 
u32
 
	mö_unô_íåõs
;

1451 
u16
 
	mhwgΩs
;

1454 
	ssso_lf_‰ì_ªq
 {

1455 
mbox_msghdr
 
	mhdr
;

1456 
	mnode
;

1457 
u16
 
	mhwgΩs
;

1460 
	ssso_hw_£tc⁄fig
 {

1461 
mbox_msghdr
 
	mhdr
;

1462 
u32
 
	m≈a_auø_id
;

1463 
u16
 
	m≈a_pf_func
;

1464 
u16
 
	mhwgΩs
;

1467 
	ssso_ªÀa£_xaq
 {

1468 
mbox_msghdr
 
	mhdr
;

1469 
u16
 
	mhwgΩs
;

1472 
	ssso_öfo_ªq
 {

1473 
mbox_msghdr
 
	mhdr
;

1475 
u16
 
	mgΩ
;

1476 
u16
 
	mhws
;

1480 
	ssso_gΩ_¥i‹ôy
 {

1481 
mbox_msghdr
 
	mhdr
;

1482 
u16
 
	mgΩ
;

1483 
u8
 
	m¥i‹ôy
;

1484 
u8
 
	mafföôy
;

1485 
u8
 
	mweight
;

1491 
	essow_af_°©us
 {

1492 
	mSSOW_AF_ERR_PARAM
 = -601,

1493 
	mSSOW_AF_ERR_LF_INVALID
 = -602,

1494 
	mSSOW_AF_ERR_AF_LF_ALLOC
 = -603,

1495 
	mSSOW_AF_ERR_INVALID_CFG
 = -604,

1498 
	sssow_lf_Æloc_ªq
 {

1499 
mbox_msghdr
 
	mhdr
;

1500 
	mnode
;

1501 
u16
 
	mhws
;

1504 
	sssow_lf_‰ì_ªq
 {

1505 
mbox_msghdr
 
	mhdr
;

1506 
	mnode
;

1507 
u16
 
	mhws
;

1510 
	sssow_lf_öv_ªq
 {

1511 
mbox_msghdr
 
	mhdr
;

1512 
u16
 
	mnb_hws
;

1513 
u16
 
	mhws
[
MAX_RVU_BLKLF_CNT
];

1516 
	sssow_c⁄fig_lsw
 {

1517 
mbox_msghdr
 
	mhdr
;

1518 
	#SSOW_LSW_DIS
 0

	)

1519 
	#SSOW_LSW_GW_WAIT
 1

	)

1520 
	#SSOW_LSW_GW_IMM
 2

	)

1521 
u8
 
	mlsw_mode
;

1522 
	#SSOW_WQE_REL_LSW_WAIT
 0

	)

1523 
	#SSOW_WQE_REL_IMM
 1

	)

1524 
u8
 
	mwqe_ªÀa£
;

1527 
	sssow_chng_mshù
 {

1528 
mbox_msghdr
 
	mhdr
;

1529 
u8
 
	m£t
;

1530 
u8
 
	míabÀ
;

1531 
u8
 
	mhws
;

1532 
u16
 
	mnb_hwgΩs
;

1533 
u16
 
	mhwgΩs
[
MAX_RVU_BLKLF_CNT
];

1536 
	ssso_gΩ_qos_cfg
 {

1537 
mbox_msghdr
 
	mhdr
;

1538 
u16
 
	mgΩ
;

1539 
u32
 
	mrsvd
;

1540 
u16
 
	mèq_thr
;

1541 
u16
 
	müq_thr
;

1544 
	ssso_gΩ_°ash_cfg
 {

1545 
mbox_msghdr
 
	mhdr
;

1546 
u16
 
	mgΩ
;

1547 
u8
 
	mía
;

1548 
u8
 
	moff£t
:4;

1549 
u8
 
	mnum_löesm1
:4;

1552 
	ssso_gΩ_°©s
 {

1553 
mbox_msghdr
 
	mhdr
;

1554 
u16
 
	mgΩ
;

1555 
u64
 
	mws_pc
;

1556 
u64
 
	mext_pc
;

1557 
u64
 
	mwa_pc
;

1558 
u64
 
	mts_pc
;

1559 
u64
 
	mds_pc
;

1560 
u64
 
	mdq_pc
;

1561 
u64
 
	maw_°©us
;

1562 
u64
 
	m∑ge_˙t
;

1565 
	ssso_hws_°©s
 {

1566 
mbox_msghdr
 
	mhdr
;

1567 
u16
 
	mhws
;

1568 
u64
 
	m¨bôøti⁄
;

1573 
	#NPC_MCAM_ENTRY_INVALID
 0xFFFF

	)

1574 
	#NPC_MCAM_INVALID_MAP
 0xFFFF

	)

1579 
	e≈c_af_°©us
 {

1580 
	mNPC_MCAM_INVALID_REQ
 = -701,

1581 
	mNPC_MCAM_ALLOC_DENIED
 = -702,

1582 
	mNPC_MCAM_ALLOC_FAILED
 = -703,

1583 
	mNPC_MCAM_PERM_DENIED
 = -704,

1584 
	mNPC_AF_ERR_HIGIG_CONFIG_FAIL
 = -705,

1585 
	mNPC_AF_ERR_HIGIG_NOT_SUPPORTED
 = -706,

1586 
	mNPC_FLOW_INTF_INVALID
 = -707,

1587 
	mNPC_FLOW_CHAN_INVALID
 = -708,

1588 
	mNPC_FLOW_NO_NIXLF
 = -709,

1589 
	mNPC_FLOW_NOT_SUPPORTED
 = -710,

1590 
	mNPC_FLOW_VF_PERM_DENIED
 = -711,

1591 
	mNPC_FLOW_VF_NOT_INIT
 = -712,

1592 
	mNPC_FLOW_VF_OVERLAP
 = -713,

1595 
	s≈c_mˇm_Æloc_íåy_ªq
 {

1596 
mbox_msghdr
 
	mhdr
;

1597 
	#NPC_MAX_NONCONTIG_ENTRIES
 256

	)

1598 
u8
 
	mc⁄tig
;

1599 
	#NPC_MCAM_ANY_PRIO
 0

	)

1600 
	#NPC_MCAM_LOWER_PRIO
 1

	)

1601 
	#NPC_MCAM_HIGHER_PRIO
 2

	)

1602 
u8
 
	m¥i‹ôy
;

1603 
u16
 
	mªf_íåy
;

1604 
u16
 
	mcou¡
;

1607 
	s≈c_mˇm_Æloc_íåy_r•
 {

1608 
mbox_msghdr
 
	mhdr
;

1609 
u16
 
	míåy
;

1612 
u16
 
	mcou¡
;

1613 
u16
 
	m‰ì_cou¡
;

1614 
u16
 
	míåy_li°
[
NPC_MAX_NONCONTIG_ENTRIES
];

1617 
	s≈c_mˇm_‰ì_íåy_ªq
 {

1618 
mbox_msghdr
 
	mhdr
;

1619 
u16
 
	míåy
;

1620 
u8
 
	mÆl
;

1623 
	smˇm_íåy
 {

1624 
	#NPC_MAX_KWS_IN_KEY
 7

	)

1625 
u64
 
	mkw
[
NPC_MAX_KWS_IN_KEY
];

1626 
u64
 
	mkw_mask
[
NPC_MAX_KWS_IN_KEY
];

1627 
u64
 
	ma˘i⁄
;

1628 
u64
 
	mvèg_a˘i⁄
;

1631 
	s≈c_mˇm_wrôe_íåy_ªq
 {

1632 
mbox_msghdr
 
	mhdr
;

1633 
mˇm_íåy
 
	míåy_d©a
;

1634 
u16
 
	míåy
;

1635 
u16
 
	m˙å
;

1636 
u8
 
	mötf
;

1637 
u8
 
	míabÀ_íåy
;

1638 
u8
 
	m£t_˙å
;

1642 
	s≈c_mˇm_ía_dis_íåy_ªq
 {

1643 
mbox_msghdr
 
	mhdr
;

1644 
u16
 
	míåy
;

1647 
	s≈c_mˇm_shi·_íåy_ªq
 {

1648 
mbox_msghdr
 
	mhdr
;

1649 
	#NPC_MCAM_MAX_SHIFTS
 64

	)

1650 
u16
 
	mcuº_íåy
[
NPC_MCAM_MAX_SHIFTS
];

1651 
u16
 
	m√w_íåy
[
NPC_MCAM_MAX_SHIFTS
];

1652 
u16
 
	mshi·_cou¡
;

1655 
	s≈c_mˇm_shi·_íåy_r•
 {

1656 
mbox_msghdr
 
	mhdr
;

1657 
u16
 
	mÁûed_íåy_idx
;

1660 
	s≈c_mˇm_Æloc_cou¡î_ªq
 {

1661 
mbox_msghdr
 
	mhdr
;

1662 
u8
 
	mc⁄tig
;

1663 
	#NPC_MAX_NONCONTIG_COUNTERS
 64

	)

1664 
u16
 
	mcou¡
;

1667 
	s≈c_mˇm_Æloc_cou¡î_r•
 {

1668 
mbox_msghdr
 
	mhdr
;

1669 
u16
 
	m˙å
;

1672 
u16
 
	mcou¡
;

1673 
u16
 
	m˙å_li°
[
NPC_MAX_NONCONTIG_COUNTERS
];

1676 
	s≈c_mˇm_›î_cou¡î_ªq
 {

1677 
mbox_msghdr
 
	mhdr
;

1678 
u16
 
	m˙å
;

1681 
	s≈c_mˇm_›î_cou¡î_r•
 {

1682 
mbox_msghdr
 
	mhdr
;

1683 
u64
 
	m°©
;

1686 
	s≈c_mˇm_unm≠_cou¡î_ªq
 {

1687 
mbox_msghdr
 
	mhdr
;

1688 
u16
 
	m˙å
;

1689 
u16
 
	míåy
;

1690 
u8
 
	mÆl
;

1693 
	s≈c_mˇm_Æloc_™d_wrôe_íåy_ªq
 {

1694 
mbox_msghdr
 
	mhdr
;

1695 
mˇm_íåy
 
	míåy_d©a
;

1696 
u16
 
	mªf_íåy
;

1697 
u8
 
	m¥i‹ôy
;

1698 
u8
 
	mötf
;

1699 
u8
 
	míabÀ_íåy
;

1700 
u8
 
	mÆloc_˙å
;

1703 
	s≈c_mˇm_Æloc_™d_wrôe_íåy_r•
 {

1704 
mbox_msghdr
 
	mhdr
;

1705 
u16
 
	míåy
;

1706 
u16
 
	m˙å
;

1709 
	s≈c_gë_kex_cfg_r•
 {

1710 
mbox_msghdr
 
	mhdr
;

1711 
u64
 
	mrx_keyx_cfg
;

1712 
u64
 
	mtx_keyx_cfg
;

1713 
	#NPC_MAX_INTF
 2

	)

1714 
	#NPC_MAX_LID
 8

	)

1715 
	#NPC_MAX_LT
 16

	)

1716 
	#NPC_MAX_LD
 2

	)

1717 
	#NPC_MAX_LFL
 16

	)

1719 
u64
 
	mkex_ld_Êags
[
NPC_MAX_LD
];

1721 
u64
 
	mötf_lid_…_ld
[
NPC_MAX_INTF
][
NPC_MAX_LID
][
NPC_MAX_LT
][
NPC_MAX_LD
];

1723 
u64
 
	mötf_ld_Êags
[
NPC_MAX_INTF
][
NPC_MAX_LD
][
NPC_MAX_LFL
];

1724 
	#MKEX_NAME_LEN
 128

	)

1725 
u8
 
	mmkex_pÊ_«me
[
MKEX_NAME_LEN
];

1728 
	e±p_›
 {

1729 
	mPTP_OP_ADJFINE
 = 0,

1730 
	mPTP_OP_GET_CLOCK
 = 1,

1731 
	mPTP_OP_GET_TSTMP
 = 2,

1732 
	mPTP_OP_SET_THRESH
 = 3,

1733 
	mPTP_OP_EXTTS_ON
 = 4,

1736 
	s±p_ªq
 {

1737 
mbox_msghdr
 
	mhdr
;

1738 
u8
 
	m›
;

1739 
s64
 
	msˇÀd_µm
;

1740 
u8
 
	mis_pmu
;

1741 
u64
 
	mthªsh
;

1742 
	mexâs_⁄
;

1745 
	s±p_r•
 {

1746 
mbox_msghdr
 
	mhdr
;

1747 
u64
 
	m˛k
;

1748 
u64
 
	mtsc
;

1751 
	sÊow_msg
 {

1752 
	mdmac
[6];

1753 
	msmac
[6];

1754 
__be16
 
	mëy≥
;

1755 
__be16
 
	mvœn_ëy≥
;

1756 
__be16
 
	mvœn_tci
;

1758 
__be32
 
	mù4§c
;

1759 
__be32
 
	mù6§c
[4];

1762 
__be32
 
	mù4d°
;

1763 
__be32
 
	mù6d°
[4];

1765 
u8
 
	mtos
;

1766 
u8
 
	mù_vî
;

1767 
u8
 
	mù_¥Ÿo
;

1768 
u8
 
	mtc
;

1769 
__be16
 
	m•‹t
;

1770 
__be16
 
	mdp‹t
;

1772 
u8
 
	mù_Êag
;

1773 
u8
 
	m√xt_hódî
;

1777 
	s≈c_ö°Æl_Êow_ªq
 {

1778 
mbox_msghdr
 
	mhdr
;

1779 
Êow_msg
 
	m∑ckë
;

1780 
Êow_msg
 
	mmask
;

1781 
u64
 
	m„©uªs
;

1782 
u16
 
	míåy
;

1783 
u16
 
	mch™√l
;

1784 
u16
 
	mch™_mask
;

1785 
u8
 
	mötf
;

1786 
u8
 
	m£t_˙å
;

1787 
u8
 
	mdeÁu…_ruÀ
;

1788 
u8
 
	m≠≥nd
;

1789 
u16
 
	mvf
;

1791 
u32
 
	mödex
;

1792 
u16
 
	mm©ch_id
;

1793 
u8
 
	mÊow_key_Æg
;

1794 
u8
 
	m›
;

1796 
u8
 
	mvèg0_ty≥
;

1797 
u8
 
	mvèg0_vÆid
;

1798 
u8
 
	mvèg1_ty≥
;

1799 
u8
 
	mvèg1_vÆid
;

1801 
u16
 
	mvèg0_def
;

1802 
u8
 
	mvèg0_›
;

1803 
u16
 
	mvèg1_def
;

1804 
u8
 
	mvèg1_›
;

1807 
	s≈c_ö°Æl_Êow_r•
 {

1808 
mbox_msghdr
 
	mhdr
;

1809 
	mcou¡î
;

1812 
	s≈c_dñëe_Êow_ªq
 {

1813 
mbox_msghdr
 
	mhdr
;

1814 
u16
 
	míåy
;

1815 
u16
 
	m°¨t
;

1816 
u16
 
	míd
;

1817 
u8
 
	mÆl
;

1820 
	s≈c_mˇm_ªad_íåy_ªq
 {

1821 
mbox_msghdr
 
	mhdr
;

1822 
u16
 
	míåy
;

1825 
	s≈c_mˇm_ªad_íåy_r•
 {

1826 
mbox_msghdr
 
	mhdr
;

1827 
mˇm_íåy
 
	míåy_d©a
;

1828 
u8
 
	mötf
;

1829 
u8
 
	míabÀ
;

1832 
	s≈c_mˇm_ªad_ba£_ruÀ_r•
 {

1833 
mbox_msghdr
 
	mhdr
;

1834 
mˇm_íåy
 
	míåy
;

1837 
	s≈c_mˇm_gë_°©s_ªq
 {

1838 
mbox_msghdr
 
	mhdr
;

1839 
u16
 
	míåy
;

1842 
	s≈c_mˇm_gë_°©s_r•
 {

1843 
mbox_msghdr
 
	mhdr
;

1844 
u64
 
	m°©
;

1845 
u8
 
	m°©_ía
;

1851 
	etim_af_°©us
 {

1852 
	mTIM_AF_NO_RINGS_LEFT
 = -801,

1853 
	mTIM_AF_INVAL_NPA_PF_FUNC
 = -802,

1854 
	mTIM_AF_INVAL_SSO_PF_FUNC
 = -803,

1855 
	mTIM_AF_RING_STILL_RUNNING
 = -804,

1856 
	mTIM_AF_LF_INVALID
 = -805,

1857 
	mTIM_AF_CSIZE_NOT_ALIGNED
 = -806,

1858 
	mTIM_AF_CSIZE_TOO_SMALL
 = -807,

1859 
	mTIM_AF_CSIZE_TOO_BIG
 = -808,

1860 
	mTIM_AF_INTERVAL_TOO_SMALL
 = -809,

1861 
	mTIM_AF_INVALID_BIG_ENDIAN_VALUE
 = -810,

1862 
	mTIM_AF_INVALID_CLOCK_SOURCE
 = -811,

1863 
	mTIM_AF_GPIO_CLK_SRC_NOT_ENABLED
 = -812,

1864 
	mTIM_AF_INVALID_BSIZE
 = -813,

1865 
	mTIM_AF_INVALID_ENABLE_PERIODIC
 = -814,

1866 
	mTIM_AF_INVALID_ENABLE_DONTFREE
 = -815,

1867 
	mTIM_AF_ENA_DONTFRE_NSET_PERIODIC
 = -816,

1868 
	mTIM_AF_RING_ALREADY_DISABLED
 = -817,

1869 
	mTIM_AF_LF_START_SYNC_FAIL
 = -818,

1872 
	s≈c_gë_£¸ë_key_ªq
 {

1873 
mbox_msghdr
 
	mhdr
;

1874 
u8
 
	mötf
;

1877 
	s≈c_gë_£¸ë_key_r•
 {

1878 
mbox_msghdr
 
	mhdr
;

1879 
u64
 
	m£¸ë_key
[3];

1882 
	s≈c_gë_fõld_°©us_ªq
 {

1883 
mbox_msghdr
 
	mhdr
;

1884 
u8
 
	mötf
;

1885 
u8
 
	mfõld
;

1888 
	s≈c_gë_fõld_°©us_r•
 {

1889 
mbox_msghdr
 
	mhdr
;

1890 
u8
 
	míabÀ
;

1893 
	etim_˛k_§cs
 {

1894 
	mTIM_CLK_SRCS_TENNS
 = 0,

1895 
	mTIM_CLK_SRCS_GPIO
 = 1,

1896 
	mTIM_CLK_SRCS_GTI
 = 2,

1897 
	mTIM_CLK_SRCS_PTP
 = 3,

1898 
	mTIM_CLK_SRCS_SYNCE
 = 4,

1899 
	mTIM_CLK_SRCS_BTS
 = 5,

1900 
	mTIM_CLK_SRSC_INVALID
,

1903 
	etim_gpio_edge
 {

1904 
	mTIM_GPIO_NO_EDGE
 = 0,

1905 
	mTIM_GPIO_LTOH_TRANS
 = 1,

1906 
	mTIM_GPIO_HTOL_TRANS
 = 2,

1907 
	mTIM_GPIO_BOTH_TRANS
 = 3,

1908 
	mTIM_GPIO_INVALID
,

1911 
	stim_lf_Æloc_ªq
 {

1912 
mbox_msghdr
 
	mhdr
;

1913 
u16
 
	mrög
;

1914 
u16
 
	m≈a_pf_func
;

1915 
u16
 
	msso_pf_func
;

1918 
	stim_rög_ªq
 {

1919 
mbox_msghdr
 
	mhdr
;

1920 
u16
 
	mrög
;

1923 
	stim_c⁄fig_ªq
 {

1924 
mbox_msghdr
 
	mhdr
;

1925 
u16
 
	mrög
;

1926 
u8
 
	mbigídün
;

1927 
u8
 
	m˛ocksour˚
;

1928 
u8
 
	míabÀ≥riodic
;

1929 
u8
 
	míabÀd⁄t‰ìbuf„r
;

1930 
u32
 
	mbuckësize
;

1931 
u32
 
	mchunksize
;

1932 
u32
 
	möãrvÆ
;

1933 
u8
 
	mgpi€dge
;

1934 
u8
 
	mrsvd
[7];

1935 
u64
 
	möãrvÆns
;

1936 
u64
 
	m˛ock‰eq
;

1939 
	stim_lf_Æloc_r•
 {

1940 
mbox_msghdr
 
	mhdr
;

1941 
u64
 
	mã¬s_˛k
;

1944 
	stim_íabÀ_r•
 {

1945 
mbox_msghdr
 
	mhdr
;

1946 
u64
 
	mtime°¨ãd
;

1947 
u32
 
	mcuºítbuckë
;

1950 
	stim_ötvl_ªq
 {

1951 
mbox_msghdr
 
	mhdr
;

1952 
u8
 
	m˛ocksour˚
;

1953 
u64
 
	m˛ock‰eq
;

1956 
	stim_ötvl_r•
 {

1957 
mbox_msghdr
 
	mhdr
;

1958 
u64
 
	mötvl_cyc
;

1959 
u64
 
	mötvl_ns
;

1962 
	sgë_hw_ˇp_r•
 {

1963 
mbox_msghdr
 
	mhdr
;

1964 
u8
 
	mnix_fixed_txschq_m≠pög
;

1965 
u8
 
	mnix_sh≠ög
;

1966 
u8
 
	m≈c_hash_exåa˘
;

1969 
	sndc_sync_›
 {

1970 
mbox_msghdr
 
	mhdr
;

1971 
u8
 
	mnix_lf_tx_sync
;

1972 
u8
 
	mnix_lf_rx_sync
;

1973 
u8
 
	m≈a_lf_sync
;

1976 
	slmt°_tbl_£tup_ªq
 {

1977 
mbox_msghdr
 
	mhdr
;

1978 
u64
 
	mdis_sched_óæy_comp
 :1;

1979 
u64
 
	msch_ía
 :1;

1980 
u64
 
	mdis_löe_¥ef
 :1;

1981 
u64
 
	mssow_pf_func
 :13;

1982 
u16
 
	mba£_pcifunc
;

1983 
u8
 
	mu£_loˇl_lmt_ªgi⁄
;

1984 
u64
 
	mlmt_iova
;

1985 
u64
 
	mrsvd
[4];

1988 
	s£t_vf_≥rm
 {

1989 
mbox_msghdr
 
	mhdr
;

1990 
u16
 
	mvf
;

1991 
	#RESET_VF_PERM
 
	`BIT_ULL
(0)

	)

1992 
	#VF_TRUSTED
 
	`BIT_ULL
(1)

	)

1993 
u64
 
	mÊags
;

1999 
	e˝t_af_°©us
 {

2000 
	mCPT_AF_ERR_PARAM
 = -901,

2001 
	mCPT_AF_ERR_GRP_INVALID
 = -902,

2002 
	mCPT_AF_ERR_LF_INVALID
 = -903,

2003 
	mCPT_AF_ERR_ACCESS_DENIED
 = -904,

2004 
	mCPT_AF_ERR_SSO_PF_FUNC_INVALID
 = -905,

2005 
	mCPT_AF_ERR_NIX_PF_FUNC_INVALID
 = -906,

2006 
	mCPT_AF_ERR_INLINE_IPSEC_INB_ENA
 = -907,

2007 
	mCPT_AF_ERR_INLINE_IPSEC_OUT_ENA
 = -908

2012 
	s˝t_rd_wr_ªg_msg
 {

2013 
mbox_msghdr
 
	mhdr
;

2014 
u64
 
	mªg_off£t
;

2015 
u64
 *
	mªt_vÆ
;

2016 
u64
 
	mvÆ
;

2017 
u8
 
	mis_wrôe
;

2018 
u8
 
	mblkaddr
;

2021 
	s˝t_lf_Æloc_ªq_msg
 {

2022 
mbox_msghdr
 
	mhdr
;

2023 
u16
 
	mnix_pf_func
;

2024 
u16
 
	msso_pf_func
;

2025 
u16
 
	míg_gΩmsk
;

2026 
u8
 
	mblkaddr
;

2029 
	#CPT_INLINE_INBOUND
 0

	)

2030 
	#CPT_INLINE_OUTBOUND
 1

	)

2031 
	s˝t_ölöe_ù£c_cfg_msg
 {

2032 
mbox_msghdr
 
	mhdr
;

2033 
u8
 
	míabÀ
;

2034 
u8
 
	m¶Ÿ
;

2035 
u8
 
	mdú
;

2036 
u8
 
	msso_pf_func_ovrd
;

2037 
u16
 
	msso_pf_func
;

2038 
u16
 
	mnix_pf_func
;

2042 
	s˝t_°s_ªq
 {

2043 
mbox_msghdr
 
	mhdr
;

2044 
u8
 
	mblkaddr
;

2047 
	s˝t_°s_r•
 {

2048 
mbox_msghdr
 
	mhdr
;

2049 
u64
 
	mö°_ªq_pc
;

2050 
u64
 
	mö°_œt_pc
;

2051 
u64
 
	mrd_ªq_pc
;

2052 
u64
 
	mrd_œt_pc
;

2053 
u64
 
	mrd_uc_pc
;

2054 
u64
 
	ma˘ive_cy˛es_pc
;

2055 
u64
 
	m˘x_mis_pc
;

2056 
u64
 
	m˘x_hô_pc
;

2057 
u64
 
	m˘x_a›_pc
;

2058 
u64
 
	m˘x_a›_œt_pc
;

2059 
u64
 
	m˘x_i„tch_pc
;

2060 
u64
 
	m˘x_i„tch_œt_pc
;

2061 
u64
 
	m˘x_f„tch_pc
;

2062 
u64
 
	m˘x_f„tch_œt_pc
;

2063 
u64
 
	m˘x_wback_pc
;

2064 
u64
 
	m˘x_wback_œt_pc
;

2065 
u64
 
	m˘x_psh_pc
;

2066 
u64
 
	m˘x_psh_œt_pc
;

2067 
u64
 
	m˘x_îr
;

2068 
u64
 
	m˘x_íc_id
;

2069 
u64
 
	m˘x_Êush_timî
;

2070 
u64
 
	mrxc_time
;

2071 
u64
 
	mrxc_time_cfg
;

2072 
u64
 
	mrxc_a˘ive_°s
;

2073 
u64
 
	mrxc_zombõ_°s
;

2074 
u64
 
	mbusy_°s_´
;

2075 
u64
 
	m‰ì_°s_´
;

2076 
u64
 
	mbusy_°s_£
;

2077 
u64
 
	m‰ì_°s_£
;

2078 
u64
 
	mbusy_°s_õ
;

2079 
u64
 
	m‰ì_°s_õ
;

2080 
u64
 
	mexe_îr_öfo
;

2081 
u64
 
	m˝t˛k_˙t
;

2082 
u64
 
	mdüg
;

2083 
u64
 
	mrxc_d‰g
;

2084 
u64
 
	mx2p_lök_cfg0
;

2085 
u64
 
	mx2p_lök_cfg1
;

2089 
	s˝t_rxc_time_cfg_ªq
 {

2090 
mbox_msghdr
 
	mhdr
;

2091 
	mblkaddr
;

2092 
u32
 
	m°ï
;

2093 
u16
 
	mzombõ_thªs
;

2094 
u16
 
	mzombõ_limô
;

2095 
u16
 
	ma˘ive_thªs
;

2096 
u16
 
	ma˘ive_limô
;

2100 
	s˝t_ö°_lmt°_ªq
 {

2101 
mbox_msghdr
 
	mhdr
;

2102 
u64
 
	mö°
[8];

2103 
u64
 
	mrsvd
;

2107 
	s˝t_lf_r°_ªq
 {

2108 
mbox_msghdr
 
	mhdr
;

2109 
u32
 
	m¶Ÿ
;

2110 
u32
 
	mrsvd
;

2114 
	s˝t_Êt_íg_öfo_ªq
 {

2115 
mbox_msghdr
 
	mhdr
;

2116 
	mblkaddr
;

2117 
boﬁ
 
	mª£t
;

2118 
u32
 
	mrsvd
;

2121 
	s˝t_Êt_íg_öfo_r•
 {

2122 
mbox_msghdr
 
	mhdr
;

2123 
u64
 
	mÊt_íg_m≠
[
CPT_10K_AF_INT_VEC_RVU
];

2124 
u64
 
	mrcvrd_íg_m≠
[
CPT_10K_AF_INT_VEC_RVU
];

2125 
u64
 
	mrsvd
;

2131 
	eªe_af_°©us
 {

2132 
	mREE_AF_ERR_RULE_UNKNOWN_VALUE
 = -1001,

2133 
	mREE_AF_ERR_LF_NO_MORE_RESOURCES
 = -1002,

2134 
	mREE_AF_ERR_LF_INVALID
 = -1003,

2135 
	mREE_AF_ERR_ACCESS_DENIED
 = -1004,

2136 
	mREE_AF_ERR_RULE_DB_PARTIAL
 = -1005,

2137 
	mREE_AF_ERR_RULE_DB_EQ_BAD_VALUE
 = -1006,

2138 
	mREE_AF_ERR_RULE_DB_BLOCK_ALLOC_FAILED
 = -1007,

2139 
	mREE_AF_ERR_BLOCK_NOT_IMPLEMENTED
 = -1008,

2140 
	mREE_AF_ERR_RULE_DB_INC_OFFSET_TOO_BIG
 = -1009,

2141 
	mREE_AF_ERR_RULE_DB_OFFSET_TOO_BIG
 = -1010,

2142 
	mREE_AF_ERR_Q_IS_GRACEFUL_DIS
 = -1011,

2143 
	mREE_AF_ERR_Q_NOT_GRACEFUL_DIS
 = -1012,

2144 
	mREE_AF_ERR_RULE_DB_ALLOC_FAILED
 = -1013,

2145 
	mREE_AF_ERR_RULE_DB_TOO_BIG
 = -1014,

2146 
	mREE_AF_ERR_RULE_DB_GEQ_BAD_VALUE
 = -1015,

2147 
	mREE_AF_ERR_RULE_DB_LEQ_BAD_VALUE
 = -1016,

2148 
	mREE_AF_ERR_RULE_DB_WRONG_LENGTH
 = -1017,

2149 
	mREE_AF_ERR_RULE_DB_WRONG_OFFSET
 = -1018,

2150 
	mREE_AF_ERR_RULE_DB_BLOCK_TOO_BIG
 = -1019,

2151 
	mREE_AF_ERR_RULE_DB_SHOULD_FILL_REQUEST
 = -1020,

2152 
	mREE_AF_ERR_RULE_DBI_ALLOC_FAILED
 = -1021,

2153 
	mREE_AF_ERR_LF_WRONG_PRIORITY
 = -1022,

2154 
	mREE_AF_ERR_LF_SIZE_TOO_BIG
 = -1023,

2155 
	mREE_AF_ERR_GRAPH_ADDRESS_TOO_BIG
 = -1024,

2156 
	mREE_AF_ERR_BAD_RULE_TYPE
 = -1025,

2161 
	sªe_ªq_msg
 {

2162 
mbox_msghdr
 
	mhdr
;

2163 
u32
 
	mblkaddr
;

2166 
	sªe_lf_ªq_msg
 {

2167 
mbox_msghdr
 
	mhdr
;

2168 
u32
 
	mblkaddr
;

2169 
u32
 
	msize
;

2170 
u8
 
	mlf
;

2171 
u8
 
	m¥i
;

2174 
	sªe_ruÀ_db_¥og_ªq_msg
 {

2175 
mbox_msghdr
 
	mhdr
;

2179 
	#REE_RULE_DB_REQ_BLOCK_SIZE
 (
MBOX_SIZE
 >> 1)

	)

2180 
u8
 
	mruÀ_db
[
REE_RULE_DB_REQ_BLOCK_SIZE
];

2181 
u32
 
	mblkaddr
;

2182 
u32
 
	mtŸÆ_Àn
;

2183 
u32
 
	moff£t
;

2184 
u16
 
	mÀn
;

2185 
u8
 
	mis_œ°
;

2186 
u8
 
	mis_ö¸emíèl
;

2187 
u8
 
	mis_dbi
;

2190 
	sªe_ruÀ_db_gë_ªq_msg
 {

2191 
mbox_msghdr
 
	mhdr
;

2192 
u32
 
	mblkaddr
;

2193 
u32
 
	moff£t
;

2194 
u8
 
	mis_dbi
;

2197 
	sªe_rd_wr_ªg_msg
 {

2198 
mbox_msghdr
 
	mhdr
;

2199 
u64
 
	mªg_off£t
;

2200 
u64
 *
	mªt_vÆ
;

2201 
u64
 
	mvÆ
;

2202 
u32
 
	mblkaddr
;

2203 
u8
 
	mis_wrôe
;

2206 
	sªe_ruÀ_db_Àn_r•_msg
 {

2207 
mbox_msghdr
 
	mhdr
;

2208 
u32
 
	mblkaddr
;

2209 
u32
 
	mÀn
;

2210 
u32
 
	möc_Àn
;

2213 
	sªe_ruÀ_db_gë_r•_msg
 {

2214 
mbox_msghdr
 
	mhdr
;

2215 
	#REE_RULE_DB_RSP_BLOCK_SIZE
 (
MBOX_DOWN_TX_SIZE
 - 
SZ_1K
)

	)

2216 
u8
 
	mruÀ_db
[
REE_RULE_DB_RSP_BLOCK_SIZE
];

2217 
u32
 
	mtŸÆ_Àn
;

2218 
u32
 
	moff£t
;

2219 
u16
 
	mÀn
;

2220 
u8
 
	mis_œ°
;

2223 
	ssdp_node_öfo
 {

2225 
u8
 
	mnode_id
;

2226 
u8
 
	mmax_rvu_vfs
;

2227 
u8
 
	mnum_pf_rögs
;

2228 
u8
 
	mpf_§n
;

2229 
	#RVU_SDP_MAX_VFS
 128

	)

2230 
u8
 
	mvf_rögs
[
RVU_SDP_MAX_VFS
];

2233 
	ssdp_ch™_öfo_msg
 {

2234 
mbox_msghdr
 
	mhdr
;

2235 
sdp_node_öfo
 
	möfo
;

2238 
	ssdp_gë_ch™_öfo_msg
 {

2239 
mbox_msghdr
 
	mhdr
;

2240 
u16
 
	mch™_ba£
;

2241 
u16
 
	mnum_ch™
;

2247 
	ecgx_af_°©us
 {

2248 
	mLMAC_AF_ERR_INVALID_PARAM
 = -1101,

2249 
	mLMAC_AF_ERR_PF_NOT_MAPPED
 = -1102,

2250 
	mLMAC_AF_ERR_PERM_DENIED
 = -1103,

2251 
	mLMAC_AF_ERR_PFC_ENADIS_PERM_DENIED
 = -1104,

2252 
	mLMAC_AF_ERR_8023PAUSE_ENADIS_PERM_DENIED
 = -1105,

2253 
	mLMAC_AF_ERR_CMD_TIMEOUT
 = -1106,

2254 
	mLMAC_AF_ERR_FIRMWARE_DATA_NOT_MAPPED
 = -1107,

2255 
	mLMAC_AF_ERR_EXACT_MATCH_TBL_ADD_FAILED
 = -1108,

2256 
	mLMAC_AF_ERR_EXACT_MATCH_TBL_DEL_FAILED
 = -1109,

2257 
	mLMAC_AF_ERR_EXACT_MATCH_TBL_LOOK_UP_FAILED
 = -1110,

2261 
	emcs_dúe˘i⁄
 {

2262 
	mMCS_RX
,

2263 
	mMCS_TX
,

2266 
	emcs_r§c_ty≥
 {

2267 
	mMCS_RSRC_TYPE_FLOWID
,

2268 
	mMCS_RSRC_TYPE_SECY
,

2269 
	mMCS_RSRC_TYPE_SC
,

2270 
	mMCS_RSRC_TYPE_SA
,

2273 
	smcs_Æloc_r§c_ªq
 {

2274 
mbox_msghdr
 
	mhdr
;

2275 
u8
 
	mr§c_ty≥
;

2276 
u8
 
	mr§c_˙t
;

2277 
u8
 
	mmcs_id
;

2278 
u8
 
	mdú
;

2279 
u8
 
	mÆl
;

2280 
u64
 
	mrsvd
;

2283 
	smcs_Æloc_r§c_r•
 {

2284 
mbox_msghdr
 
	mhdr
;

2285 
u8
 
	mÊow_ids
[128];

2286 
u8
 
	m£cy_ids
[128];

2287 
u8
 
	msc_ids
[128];

2288 
u8
 
	mß_ids
[256];

2289 
u8
 
	mr§c_ty≥
;

2290 
u8
 
	mr§c_˙t
;

2291 
u8
 
	mmcs_id
;

2292 
u8
 
	mdú
;

2293 
u8
 
	mÆl
;

2294 
u8
 
	mrsvd
[256];

2297 
	smcs_‰ì_r§c_ªq
 {

2298 
mbox_msghdr
 
	mhdr
;

2299 
u8
 
	mr§c_id
;

2300 
u8
 
	mr§c_ty≥
;

2301 
u8
 
	mmcs_id
;

2302 
u8
 
	mdú
;

2303 
u8
 
	mÆl
;

2304 
u64
 
	mrsvd
;

2307 
	smcs_Êowid_íåy_wrôe_ªq
 {

2308 
mbox_msghdr
 
	mhdr
;

2309 
u64
 
	md©a
[4];

2310 
u64
 
	mmask
[4];

2311 
u64
 
	msci
;

2312 
u8
 
	mÊow_id
;

2313 
u8
 
	m£cy_id
;

2314 
u8
 
	msc_id
;

2315 
u8
 
	mía
;

2316 
u8
 
	m˘æ_pkt
;

2317 
u8
 
	mmcs_id
;

2318 
u8
 
	mdú
;

2319 
u64
 
	mrsvd
;

2322 
	smcs_£cy_∂cy_wrôe_ªq
 {

2323 
mbox_msghdr
 
	mhdr
;

2324 
u64
 
	m∂cy
;

2325 
u8
 
	m£cy_id
;

2326 
u8
 
	mmcs_id
;

2327 
u8
 
	mdú
;

2328 
u64
 
	mrsvd
;

2332 
	smcs_rx_sc_ˇm_wrôe_ªq
 {

2333 
mbox_msghdr
 
	mhdr
;

2334 
u64
 
	msci
;

2335 
u64
 
	m£cy_id
;

2336 
u8
 
	msc_id
;

2337 
u8
 
	mmcs_id
;

2338 
u64
 
	mrsvd
;

2341 
	smcs_ß_∂cy_wrôe_ªq
 {

2342 
mbox_msghdr
 
	mhdr
;

2343 
u64
 
	m∂cy
[2][9];

2344 
u8
 
	mß_ödex
[2];

2345 
u8
 
	mß_˙t
;

2346 
u8
 
	mmcs_id
;

2347 
u8
 
	mdú
;

2348 
u64
 
	mrsvd
;

2351 
	smcs_tx_sc_ß_m≠
 {

2352 
mbox_msghdr
 
	mhdr
;

2353 
u8
 
	mß_ödex0
;

2354 
u8
 
	mß_ödex1
;

2355 
u8
 
	mªkey_ía
;

2356 
u8
 
	mß_ödex0_vld
;

2357 
u8
 
	mß_ödex1_vld
;

2358 
u8
 
	mtx_ß_a˘ive
;

2359 
u64
 
	m£˘ag_sci
;

2360 
u8
 
	msc_id
;

2361 
u8
 
	mmcs_id
;

2362 
u64
 
	mrsvd
;

2365 
	smcs_rx_sc_ß_m≠
 {

2366 
mbox_msghdr
 
	mhdr
;

2367 
u8
 
	mß_ödex
;

2368 
u8
 
	mß_ö_u£
;

2369 
u8
 
	msc_id
;

2370 
u8
 
	m™
;

2371 
u8
 
	mmcs_id
;

2372 
u64
 
	mrsvd
;

2375 
	smcs_Êowid_ía_dis_íåy
 {

2376 
mbox_msghdr
 
	mhdr
;

2377 
u8
 
	mÊow_id
;

2378 
u8
 
	mía
;

2379 
u8
 
	mmcs_id
;

2380 
u8
 
	mdú
;

2381 
u64
 
	mrsvd
;

2384 
	smcs_≤_èbÀ_wrôe_ªq
 {

2385 
mbox_msghdr
 
	mhdr
;

2386 
u64
 
	m√xt_≤
;

2387 
u8
 
	m≤_id
;

2388 
u8
 
	mmcs_id
;

2389 
u8
 
	mdú
;

2390 
u64
 
	mrsvd
;

2393 
	smcs_hw_öfo
 {

2394 
mbox_msghdr
 
	mhdr
;

2395 
u8
 
	mnum_mcs_blks
;

2396 
u8
 
	mtˇm_íåõs
;

2397 
u8
 
	m£cy_íåõs
;

2398 
u8
 
	msc_íåõs
;

2399 
u8
 
	mß_íåõs
;

2400 
u64
 
	mrsvd
[16];

2403 
	smcs_£t_a˘ive_lmac
 {

2404 
mbox_msghdr
 
	mhdr
;

2405 
u32
 
	mlmac_bm≠
;

2406 
u8
 
	mmcs_id
;

2407 
u16
 
	mch™_ba£
;

2408 
u64
 
	mrsvd
;

2411 
	smcs_£t_lmac_mode
 {

2412 
mbox_msghdr
 
	mhdr
;

2413 
u8
 
	mmode
;

2414 
u8
 
	mlmac_id
;

2415 
u8
 
	mmcs_id
;

2416 
u64
 
	mrsvd
;

2419 
	smcs_p‹t_ª£t_ªq
 {

2420 
mbox_msghdr
 
	mhdr
;

2421 
u8
 
	mª£t
;

2422 
u8
 
	mmcs_id
;

2423 
u8
 
	mp‹t_id
;

2424 
u64
 
	mrsvd
;

2427 
	smcs_p‹t_cfg_£t_ªq
 {

2428 
mbox_msghdr
 
	mhdr
;

2429 
u8
 
	mc°m_èg_ªl_mode_£l
;

2430 
u8
 
	mcu°om_hdr_íb
;

2431 
u8
 
	mfifo_skid
;

2432 
u8
 
	mp‹t_mode
;

2433 
u8
 
	mp‹t_id
;

2434 
u8
 
	mmcs_id
;

2435 
u64
 
	mrsvd
;

2438 
	smcs_p‹t_cfg_gë_ªq
 {

2439 
mbox_msghdr
 
	mhdr
;

2440 
u8
 
	mp‹t_id
;

2441 
u8
 
	mmcs_id
;

2442 
u64
 
	mrsvd
;

2445 
	smcs_p‹t_cfg_gë_r•
 {

2446 
mbox_msghdr
 
	mhdr
;

2447 
u8
 
	mc°m_èg_ªl_mode_£l
;

2448 
u8
 
	mcu°om_hdr_íb
;

2449 
u8
 
	mfifo_skid
;

2450 
u8
 
	mp‹t_mode
;

2451 
u8
 
	mp‹t_id
;

2452 
u8
 
	mmcs_id
;

2453 
u64
 
	mrsvd
;

2456 
	smcs_cu°om_èg_cfg_gë_ªq
 {

2457 
mbox_msghdr
 
	mhdr
;

2458 
u8
 
	mmcs_id
;

2459 
u8
 
	mdú
;

2460 
u64
 
	mrsvd
;

2463 
	smcs_cu°om_èg_cfg_gë_r•
 {

2464 
mbox_msghdr
 
	mhdr
;

2465 
u16
 
	mc°m_ëy≥
[8];

2466 
u8
 
	mc°m_ödx
[8];

2467 
u8
 
	mc°m_ëy≥_í
;

2468 
u8
 
	mmcs_id
;

2469 
u8
 
	mdú
;

2470 
u64
 
	mrsvd
;

2476 
	emcs_af_°©us
 {

2477 
	mMCS_AF_ERR_INVALID_MCSID
 = -1201,

2478 
	mMCS_AF_ERR_NOT_MAPPED
 = -1202,

2481 
	smcs_£t_≤_thªshﬁd
 {

2482 
mbox_msghdr
 
	mhdr
;

2483 
u64
 
	mthªshﬁd
;

2484 
u8
 
	mx≤
;

2485 
u8
 
	mmcs_id
;

2486 
u8
 
	mdú
;

2487 
u64
 
	mrsvd
;

2490 
	emcs_˘æ_pkt_ruÀw_ty≥
 {

2491 
	mMCS_CTRL_PKT_RULE_TYPE_ETH
,

2492 
	mMCS_CTRL_PKT_RULE_TYPE_DA
,

2493 
	mMCS_CTRL_PKT_RULE_TYPE_RANGE
,

2494 
	mMCS_CTRL_PKT_RULE_TYPE_COMBO
,

2495 
	mMCS_CTRL_PKT_RULE_TYPE_MAC
,

2498 
	smcs_Æloc_˘æ_pkt_ruÀ_ªq
 {

2499 
mbox_msghdr
 
	mhdr
;

2500 
u8
 
	mruÀ_ty≥
;

2501 
u8
 
	mmcs_id
;

2502 
u8
 
	mdú
;

2503 
u64
 
	mrsvd
;

2506 
	smcs_Æloc_˘æ_pkt_ruÀ_r•
 {

2507 
mbox_msghdr
 
	mhdr
;

2508 
u8
 
	mruÀ_idx
;

2509 
u8
 
	mruÀ_ty≥
;

2510 
u8
 
	mmcs_id
;

2511 
u8
 
	mdú
;

2512 
u64
 
	mrsvd
;

2515 
	smcs_‰ì_˘æ_pkt_ruÀ_ªq
 {

2516 
mbox_msghdr
 
	mhdr
;

2517 
u8
 
	mruÀ_idx
;

2518 
u8
 
	mruÀ_ty≥
;

2519 
u8
 
	mmcs_id
;

2520 
u8
 
	mdú
;

2521 
u8
 
	mÆl
;

2522 
u64
 
	mrsvd
;

2525 
	smcs_˘æ_pkt_ruÀ_wrôe_ªq
 {

2526 
mbox_msghdr
 
	mhdr
;

2527 
u64
 
	md©a0
;

2528 
u64
 
	md©a1
;

2529 
u64
 
	md©a2
;

2530 
u8
 
	mruÀ_idx
;

2531 
u8
 
	mruÀ_ty≥
;

2532 
u8
 
	mmcs_id
;

2533 
u8
 
	mdú
;

2534 
u64
 
	mrsvd
;

2537 
	smcs_°©s_ªq
 {

2538 
mbox_msghdr
 
	mhdr
;

2539 
u8
 
	mid
;

2540 
u8
 
	mmcs_id
;

2541 
u8
 
	mdú
;

2542 
u64
 
	mrsvd
;

2545 
	smcs_Êowid_°©s
 {

2546 
mbox_msghdr
 
	mhdr
;

2547 
u64
 
	mtˇm_hô_˙t
;

2548 
u64
 
	mrsvd
;

2551 
	smcs_£cy_°©s
 {

2552 
mbox_msghdr
 
	mhdr
;

2553 
u64
 
	m˘l_pkt_bˇ°_˙t
;

2554 
u64
 
	m˘l_pkt_mˇ°_˙t
;

2555 
u64
 
	m˘l_pkt_uˇ°_˙t
;

2556 
u64
 
	m˘l_o˘ë_˙t
;

2557 
u64
 
	mun˘l_pkt_bˇ°_˙t
;

2558 
u64
 
	mun˘l_pkt_mˇ°_˙t
;

2559 
u64
 
	mun˘l_pkt_uˇ°_˙t
;

2560 
u64
 
	mun˘l_o˘ë_˙t
;

2562 
u64
 
	mo˘ë_de¸y±ed_˙t
;

2563 
u64
 
	mo˘ë_vÆid©ed_˙t
;

2564 
u64
 
	mpkt_p‹t_dißbÀd_˙t
;

2565 
u64
 
	mpkt_badèg_˙t
;

2566 
u64
 
	mpkt_noß_˙t
;

2567 
u64
 
	mpkt_noßîr‹_˙t
;

2568 
u64
 
	mpkt_ègged_˘l_˙t
;

2569 
u64
 
	mpkt_u¡aged_˙t
;

2570 
u64
 
	mpkt_˘l_˙t
;

2571 
u64
 
	mpkt_nŸag_˙t
;

2573 
u64
 
	mo˘ë_í¸y±ed_˙t
;

2574 
u64
 
	mo˘ë_¥Ÿe˘ed_˙t
;

2575 
u64
 
	mpkt_nﬂ˘iveß_˙t
;

2576 
u64
 
	mpkt_toﬁ⁄g_˙t
;

2577 
u64
 
	mpkt_u¡agged_˙t
;

2578 
u64
 
	mrsvd
[4];

2581 
	smcs_p‹t_°©s
 {

2582 
mbox_msghdr
 
	mhdr
;

2583 
u64
 
	mtˇm_miss_˙t
;

2584 
u64
 
	m∑r£r_îr_˙t
;

2585 
u64
 
	m¥ìm±_îr_˙t
;

2586 
u64
 
	m£˘ag_ö£π_îr_˙t
;

2587 
u64
 
	mrsvd
[4];

2591 
	smcs_ß_°©s
 {

2592 
mbox_msghdr
 
	mhdr
;

2594 
u64
 
	mpkt_övÆid_˙t
;

2595 
u64
 
	mpkt_noßîr‹_˙t
;

2596 
u64
 
	mpkt_nŸvÆid_˙t
;

2597 
u64
 
	mpkt_ok_˙t
;

2598 
u64
 
	mpkt_noß_˙t
;

2600 
u64
 
	mpkt_í¸y±_˙t
;

2601 
u64
 
	mpkt_¥Ÿe˘ed_˙t
;

2602 
u64
 
	mrsvd
[4];

2605 
	smcs_sc_°©s
 {

2606 
mbox_msghdr
 
	mhdr
;

2608 
u64
 
	mhô_˙t
;

2609 
u64
 
	mpkt_övÆid_˙t
;

2610 
u64
 
	mpkt_œã_˙t
;

2611 
u64
 
	mpkt_nŸvÆid_˙t
;

2612 
u64
 
	mpkt_unchecked_˙t
;

2613 
u64
 
	mpkt_dñay_˙t
;

2614 
u64
 
	mpkt_ok_˙t
;

2615 
u64
 
	mo˘ë_de¸y±_˙t
;

2616 
u64
 
	mo˘ë_vÆid©e_˙t
;

2618 
u64
 
	mpkt_í¸y±_˙t
;

2619 
u64
 
	mpkt_¥Ÿe˘ed_˙t
;

2620 
u64
 
	mo˘ë_í¸y±_˙t
;

2621 
u64
 
	mo˘ë_¥Ÿe˘ed_˙t
;

2622 
u64
 
	mrsvd
[4];

2625 
	smcs_˛ór_°©s
 {

2626 
mbox_msghdr
 
	mhdr
;

2627 
	#MCS_FLOWID_STATS
 0

	)

2628 
	#MCS_SECY_STATS
 1

	)

2629 
	#MCS_SC_STATS
 2

	)

2630 
	#MCS_SA_STATS
 3

	)

2631 
	#MCS_PORT_STATS
 4

	)

2632 
u8
 
	mty≥
;

2633 
u8
 
	mid
;

2634 
u8
 
	mmcs_id
;

2635 
u8
 
	mdú
;

2636 
u8
 
	mÆl
;

2639 
	smcs_öå_cfg
 {

2640 
mbox_msghdr
 
	mhdr
;

2641 
	#MCS_CPM_RX_SECTAG_V_EQ1_INT
 
	`BIT_ULL
(0)

	)

2642 
	#MCS_CPM_RX_SECTAG_E_EQ0_C_EQ1_INT
 
	`BIT_ULL
(1)

	)

2643 
	#MCS_CPM_RX_SECTAG_SL_GTE48_INT
 
	`BIT_ULL
(2)

	)

2644 
	#MCS_CPM_RX_SECTAG_ES_EQ1_SC_EQ1_INT
 
	`BIT_ULL
(3)

	)

2645 
	#MCS_CPM_RX_SECTAG_SC_EQ1_SCB_EQ1_INT
 
	`BIT_ULL
(4)

	)

2646 
	#MCS_CPM_RX_PACKET_XPN_EQ0_INT
 
	`BIT_ULL
(5)

	)

2647 
	#MCS_CPM_RX_PN_THRESH_REACHED_INT
 
	`BIT_ULL
(6)

	)

2648 
	#MCS_CPM_TX_PACKET_XPN_EQ0_INT
 
	`BIT_ULL
(7)

	)

2649 
	#MCS_CPM_TX_PN_THRESH_REACHED_INT
 
	`BIT_ULL
(8)

	)

2650 
	#MCS_CPM_TX_SA_NOT_VALID_INT
 
	`BIT_ULL
(9)

	)

2651 
	#MCS_BBE_RX_DFIFO_OVERFLOW_INT
 
	`BIT_ULL
(10)

	)

2652 
	#MCS_BBE_RX_PLFIFO_OVERFLOW_INT
 
	`BIT_ULL
(11)

	)

2653 
	#MCS_BBE_TX_DFIFO_OVERFLOW_INT
 
	`BIT_ULL
(12)

	)

2654 
	#MCS_BBE_TX_PLFIFO_OVERFLOW_INT
 
	`BIT_ULL
(13)

	)

2655 
	#MCS_PAB_RX_CHAN_OVERFLOW_INT
 
	`BIT_ULL
(14)

	)

2656 
	#MCS_PAB_TX_CHAN_OVERFLOW_INT
 
	`BIT_ULL
(15)

	)

2657 
u64
 
	möå_mask
;

2658 
u8
 
	mmcs_id
;

2661 
	smcs_öå_öfo
 {

2662 
mbox_msghdr
 
	mhdr
;

2663 
u64
 
	möå_mask
;

2664 
	mß_id
;

2665 
u8
 
	mmcs_id
;

2666 
u8
 
	mlmac_id
;

2667 
u64
 
	mrsvd
;

	@mcs.c

7 
	~<löux/bôfõld.h
>

8 
	~<löux/dñay.h
>

9 
	~<löux/devi˚.h
>

10 
	~<löux/moduÀ.h
>

11 
	~<löux/pci.h
>

13 
	~"mcs.h
"

14 
	~"mcs_ªg.h
"

16 
	#DRV_NAME
 "M¨vñ»MCS Drivî"

	)

18 
	#PCI_CFG_REG_BAR_NUM
 0

	)

20 c⁄° 
pci_devi˚_id
 
	gmcs_id_èbÀ
[] = {

21 { 
PCI_DEVICE
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_CN10K_MCS
) },

25 
LIST_HEAD
(
mcs_li°
);

27 
	$mcs_gë_tx_£cy_°©s
(
mcs
 *mcs, 
mcs_£cy_°©s
 *
°©s
, 
id
)

29 
u64
 
ªg
;

31 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_IFOUTCTLBCPKTSX
(
id
);

32 
°©s
->
˘l_pkt_bˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

34 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_IFOUTCTLMCPKTSX
(
id
);

35 
°©s
->
˘l_pkt_mˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

37 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_IFOUTCTLOCTETSX
(
id
);

38 
°©s
->
˘l_o˘ë_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

40 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_IFOUTCTLUCPKTSX
(
id
);

41 
°©s
->
˘l_pkt_uˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

43 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_IFOUTUNCTLBCPKTSX
(
id
);

44 
°©s
->
un˘l_pkt_bˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

46 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_IFOUTUNCTLMCPKTSX
(
id
);

47 
°©s
->
un˘l_pkt_mˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

49 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_IFOUTUNCTLOCTETSX
(
id
);

50 
°©s
->
un˘l_o˘ë_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

52 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_IFOUTUNCTLUCPKTSX
(
id
);

53 
°©s
->
un˘l_pkt_uˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

55 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTOCTETSSECYENCRYPTEDX
(
id
);

56 
°©s
->
o˘ë_í¸y±ed_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

58 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTOCTETSSECYPROTECTEDX
(
id
);

59 
°©s
->
o˘ë_¥Ÿe˘ed_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

61 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSECYNOACTIVESAX
(
id
);

62 
°©s
->
pkt_nﬂ˘iveß_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

64 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSECYTOOLONGX
(
id
);

65 
°©s
->
pkt_toﬁ⁄g_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

67 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSECYUNTAGGEDX
(
id
);

68 
°©s
->
pkt_u¡agged_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

69 
	}
}

71 
	$mcs_gë_rx_£cy_°©s
(
mcs
 *mcs, 
mcs_£cy_°©s
 *
°©s
, 
id
)

73 
u64
 
ªg
;

75 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_IFINCTLBCPKTSX
(
id
);

76 
°©s
->
˘l_pkt_bˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

78 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_IFINCTLMCPKTSX
(
id
);

79 
°©s
->
˘l_pkt_mˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

81 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_IFINCTLOCTETSX
(
id
);

82 
°©s
->
˘l_o˘ë_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

84 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_IFINCTLUCPKTSX
(
id
);

85 
°©s
->
˘l_pkt_uˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

87 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_IFINUNCTLBCPKTSX
(
id
);

88 
°©s
->
un˘l_pkt_bˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

90 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_IFINUNCTLMCPKTSX
(
id
);

91 
°©s
->
un˘l_pkt_mˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

93 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_IFINUNCTLOCTETSX
(
id
);

94 
°©s
->
un˘l_o˘ë_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

96 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_IFINUNCTLUCPKTSX
(
id
);

97 
°©s
->
un˘l_pkt_uˇ°_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

99 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INOCTETSSECYDECRYPTEDX
(
id
);

100 
°©s
->
o˘ë_de¸y±ed_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

102 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INOCTETSSECYVALIDATEX
(
id
);

103 
°©s
->
o˘ë_vÆid©ed_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

105 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSCTRLPORTDISABLEDX
(
id
);

106 
°©s
->
pkt_p‹t_dißbÀd_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

108 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYBADTAGX
(
id
);

109 
°©s
->
pkt_badèg_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

111 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYNOSAX
(
id
);

112 
°©s
->
pkt_noß_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

114 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYNOSAERRORX
(
id
);

115 
°©s
->
pkt_noßîr‹_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

117 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYTAGGEDCTLX
(
id
);

118 
°©s
->
pkt_ègged_˘l_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

120 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYUNTAGGEDX
(
id
);

121 
°©s
->
pkt_u¡aged_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

123 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYCTLX
(
id
);

124 
°©s
->
pkt_˘l_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

126 i‡(
mcs
->
hw
->
mcs_blks
 > 1) {

127 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYNOTAGX
(
id
);

128 
°©s
->
pkt_nŸag_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

130 
	}
}

132 
	$mcs_gë_Êowid_°©s
(
mcs
 *mcs, 
mcs_Êowid_°©s
 *
°©s
,

133 
id
, 
dú
)

135 
u64
 
ªg
;

137 i‡(
dú
 =
MCS_RX
)

138 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSFLOWIDTCAMHITX
(
id
);

140 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSFLOWIDTCAMHITX
(
id
);

142 
°©s
->
tˇm_hô_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

143 
	}
}

145 
	$mcs_gë_p‹t_°©s
(
mcs
 *mcs, 
mcs_p‹t_°©s
 *
°©s
,

146 
id
, 
dú
)

148 
u64
 
ªg
;

150 i‡(
dú
 =
MCS_RX
) {

151 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSFLOWIDTCAMMISSX
(
id
);

152 
°©s
->
tˇm_miss_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

154 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSPARSEERRX
(
id
);

155 
°©s
->
∑r£r_îr_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

156 i‡(
mcs
->
hw
->
mcs_blks
 > 1) {

157 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSEARLYPREEMPTERRX
(
id
);

158 
°©s
->
¥ìm±_îr_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

161 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSFLOWIDTCAMMISSX
(
id
);

162 
°©s
->
tˇm_miss_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

164 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSPARSEERRX
(
id
);

165 
°©s
->
∑r£r_îr_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

167 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSECTAGINSERTIONERRX
(
id
);

168 
°©s
->
£˘ag_ö£π_îr_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

170 
	}
}

172 
	$mcs_gë_ß_°©s
(
mcs
 *mcs, 
mcs_ß_°©s
 *
°©s
, 
id
, 
dú
)

174 
u64
 
ªg
;

176 i‡(
dú
 =
MCS_RX
) {

177 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSAINVALIDX
(
id
);

178 
°©s
->
pkt_övÆid_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

180 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSANOTUSINGSAERRORX
(
id
);

181 
°©s
->
pkt_noßîr‹_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

183 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSANOTVALIDX
(
id
);

184 
°©s
->
pkt_nŸvÆid_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

186 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSAOKX
(
id
);

187 
°©s
->
pkt_ok_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

189 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSAUNUSEDSAX
(
id
);

190 
°©s
->
pkt_noß_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

192 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSAENCRYPTEDX
(
id
);

193 
°©s
->
pkt_í¸y±_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

195 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSAPROTECTEDX
(
id
);

196 
°©s
->
pkt_¥Ÿe˘ed_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

198 
	}
}

200 
	$mcs_gë_sc_°©s
(
mcs
 *mcs, 
mcs_sc_°©s
 *
°©s
,

201 
id
, 
dú
)

203 
u64
 
ªg
;

205 i‡(
dú
 =
MCS_RX
) {

206 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSCCAMHITX
(
id
);

207 
°©s
->
hô_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

209 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSCINVALIDX
(
id
);

210 
°©s
->
pkt_övÆid_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

212 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSCLATEORDELAYEDX
(
id
);

213 
°©s
->
pkt_œã_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

215 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSCNOTVALIDX
(
id
);

216 
°©s
->
pkt_nŸvÆid_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

218 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSCUNCHECKEDX
(
id
);

219 
°©s
->
pkt_unchecked_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

221 i‡(
mcs
->
hw
->
mcs_blks
 > 1) {

222 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSCDELAYEDX
(
id
);

223 
°©s
->
pkt_dñay_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

225 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INPKTSSCOKX
(
id
);

226 
°©s
->
pkt_ok_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

228 i‡(
mcs
->
hw
->
mcs_blks
 == 1) {

229 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INOCTETSSCDECRYPTEDX
(
id
);

230 
°©s
->
o˘ë_de¸y±_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

232 
ªg
 = 
	`MCSX_CSE_RX_MEM_SLAVE_INOCTETSSCVALIDATEX
(
id
);

233 
°©s
->
o˘ë_vÆid©e_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

236 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSCENCRYPTEDX
(
id
);

237 
°©s
->
pkt_í¸y±_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

239 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSCPROTECTEDX
(
id
);

240 
°©s
->
pkt_¥Ÿe˘ed_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

242 i‡(
mcs
->
hw
->
mcs_blks
 == 1) {

243 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTOCTETSSCENCRYPTEDX
(
id
);

244 
°©s
->
o˘ë_í¸y±_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

246 
ªg
 = 
	`MCSX_CSE_TX_MEM_SLAVE_OUTOCTETSSCPROTECTEDX
(
id
);

247 
°©s
->
o˘ë_¥Ÿe˘ed_˙t
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

250 
	}
}

252 
	$mcs_˛ór_°©s
(
mcs
 *mcs, 
u8
 
ty≥
, u8 
id
, 
dú
)

254 
mcs_Êowid_°©s
 
Êowid_°
;

255 
mcs_p‹t_°©s
 
p‹t_°
;

256 
mcs_£cy_°©s
 
£cy_°
;

257 
mcs_sc_°©s
 
sc_°
;

258 
mcs_ß_°©s
 
ß_°
;

259 
u64
 
ªg
;

261 i‡(
dú
 =
MCS_RX
)

262 
ªg
 = 
MCSX_CSE_RX_SLAVE_CTRL
;

264 
ªg
 = 
MCSX_CSE_TX_SLAVE_CTRL
;

266 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
	`BIT_ULL
(0));

268 
ty≥
) {

269 
MCS_FLOWID_STATS
:

270 
	`mcs_gë_Êowid_°©s
(
mcs
, &
Êowid_°
, 
id
, 
dú
);

272 
MCS_SECY_STATS
:

273 i‡(
dú
 =
MCS_RX
)

274 
	`mcs_gë_rx_£cy_°©s
(
mcs
, &
£cy_°
, 
id
);

276 
	`mcs_gë_tx_£cy_°©s
(
mcs
, &
£cy_°
, 
id
);

278 
MCS_SC_STATS
:

279 
	`mcs_gë_sc_°©s
(
mcs
, &
sc_°
, 
id
, 
dú
);

281 
MCS_SA_STATS
:

282 
	`mcs_gë_ß_°©s
(
mcs
, &
ß_°
, 
id
, 
dú
);

284 
MCS_PORT_STATS
:

285 
	`mcs_gë_p‹t_°©s
(
mcs
, &
p‹t_°
, 
id
, 
dú
);

289 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 0x0);

290 
	}
}

292 
	$mcs_˛ór_Æl_°©s
(
mcs
 *mcs, 
u16
 
pcifunc
, 
dú
)

294 
mcs_r§c_m≠
 *
m≠
;

295 
id
;

297 i‡(
dú
 =
MCS_RX
)

298 
m≠
 = &
mcs
->
rx
;

300 
m≠
 = &
mcs
->
tx
;

303 
id
 = 0; id < 
m≠
->
Êow_ids
.
max
; id++) {

304 i‡(
m≠
->
Êowid2pf_m≠
[
id
] !
pcifunc
)

306 
	`mcs_˛ór_°©s
(
mcs
, 
MCS_FLOWID_STATS
, 
id
, 
dú
);

310 
id
 = 0; id < 
m≠
->
£cy
.
max
; id++) {

311 i‡(
m≠
->
£cy2pf_m≠
[
id
] !
pcifunc
)

313 
	`mcs_˛ór_°©s
(
mcs
, 
MCS_SECY_STATS
, 
id
, 
dú
);

317 
id
 = 0; id < 
m≠
->
£cy
.
max
; id++) {

318 i‡(
m≠
->
sc2pf_m≠
[
id
] !
pcifunc
)

320 
	`mcs_˛ór_°©s
(
mcs
, 
MCS_SC_STATS
, 
id
, 
dú
);

324 
id
 = 0; id < 
m≠
->
ß
.
max
; id++) {

325 i‡(
m≠
->
ß2pf_m≠
[
id
] !
pcifunc
)

327 
	`mcs_˛ór_°©s
(
mcs
, 
MCS_SA_STATS
, 
id
, 
dú
);

330 
	}
}

332 
	$mcs_≤_èbÀ_wrôe
(
mcs
 *mcs, 
u8
 
≤_id
, 
u64
 
√xt_≤
, u8 
dú
)

334 
u64
 
ªg
;

336 i‡(
dú
 =
MCS_RX
)

337 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_SA_PN_TABLE_MEMX
(
≤_id
);

339 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_SA_PN_TABLE_MEMX
(
≤_id
);

340 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
√xt_≤
);

341 
	}
}

343 
	$˙10kb_mcs_tx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_tx_sc_ß_m≠
 *
m≠
)

345 
u64
 
ªg
, 
vÆ
;

347 
vÆ
 = (
m≠
->
ß_ödex0
 & 0xFF) |

348 (
m≠
->
ß_ödex1
 & 0xFF) << 9 |

349 (
m≠
->
ªkey_ía
 & 0x1) << 18 |

350 (
m≠
->
ß_ödex0_vld
 & 0x1) << 19 |

351 (
m≠
->
ß_ödex1_vld
 & 0x1) << 20 |

352 (
m≠
->
tx_ß_a˘ive
 & 0x1) << 21 |

353 
m≠
->
£˘ag_sci
 << 22;

354 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_SA_MAP_MEM_0X
(
m≠
->
sc_id
);

355 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

357 
vÆ
 = 
m≠
->
£˘ag_sci
 >> 42;

358 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_SA_MAP_MEM_1X
(
m≠
->
sc_id
);

359 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

360 
	}
}

362 
	$˙10kb_mcs_rx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_rx_sc_ß_m≠
 *
m≠
)

364 
u64
 
vÆ
, 
ªg
;

366 
vÆ
 = (
m≠
->
ß_ödex
 & 0xFFË| m≠->
ß_ö_u£
 << 9;

368 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_SA_MAP_MEMX
((4 * 
m≠
->
sc_id
Ë+ m≠->
™
);

369 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

370 
	}
}

372 
	$mcs_ß_∂cy_wrôe
(
mcs
 *mcs, 
u64
 *
∂cy
, 
ß_id
, 
dú
)

374 
ªg_id
;

375 
u64
 
ªg
;

377 i‡(
dú
 =
MCS_RX
) {

378 
ªg_id
 = 0;Ñeg_id < 8;Ñeg_id++) {

379 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_SA_PLCY_MEMX
(
ªg_id
, 
ß_id
);

380 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
∂cy
[
ªg_id
]);

383 
ªg_id
 = 0;Ñeg_id < 9;Ñeg_id++) {

384 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_SA_PLCY_MEMX
(
ªg_id
, 
ß_id
);

385 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
∂cy
[
ªg_id
]);

388 
	}
}

390 
	$mcs_ía_dis_sc_ˇm_íåy
(
mcs
 *mcs, 
sc_id
, 
ía
)

392 
u64
 
ªg
, 
vÆ
;

394 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_SC_CAM_ENA
(0);

395 i‡(
sc_id
 > 63)

396 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_SC_CAM_ENA
(1);

398 i‡(
ía
)

399 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
Ë| 
	`BIT_ULL
(
sc_id
);

401 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
Ë& ~
	`BIT_ULL
(
sc_id
);

403 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

404 
	}
}

406 
	$mcs_rx_sc_ˇm_wrôe
(
mcs
 *mcs, 
u64
 
sci
, u64 
£cy
, 
sc_id
)

408 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_CPM_RX_SLAVE_SC_CAMX
(0, 
sc_id
), 
sci
);

409 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_CPM_RX_SLAVE_SC_CAMX
(1, 
sc_id
), 
£cy
);

411 
	`mcs_ía_dis_sc_ˇm_íåy
(
mcs
, 
sc_id
, 
åue
);

412 
	}
}

414 
	$mcs_£cy_∂cy_wrôe
(
mcs
 *mcs, 
u64
 
∂cy
, 
£cy_id
, 
dú
)

416 
u64
 
ªg
;

418 i‡(
dú
 =
MCS_RX
)

419 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_SECY_PLCY_MEM_0X
(
£cy_id
);

421 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_SECY_PLCY_MEMX
(
£cy_id
);

423 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
∂cy
);

425 i‡(
mcs
->
hw
->
mcs_blks
 =1 && 
dú
 =
MCS_RX
)

426 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_CPM_RX_SLAVE_SECY_PLCY_MEM_1X
(
£cy_id
), 0x0ull);

427 
	}
}

429 
	$˙10kb_mcs_Êowid_£cy_m≠
(
mcs
 *mcs, 
£cy_mem_m≠
 *
m≠
, 
dú
)

431 
u64
 
ªg
, 
vÆ
;

433 
vÆ
 = (
m≠
->
£cy
 & 0x7FË| (m≠->
˘æ_pkt
 & 0x1) << 8;

434 i‡(
dú
 =
MCS_RX
) {

435 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_SECY_MAP_MEMX
(
m≠
->
Êow_id
);

437 
vÆ
 |(
m≠
->
sc
 & 0x7F) << 9;

438 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_SECY_MAP_MEM_0X
(
m≠
->
Êow_id
);

441 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

442 
	}
}

444 
	$mcs_ía_dis_Êowid_íåy
(
mcs
 *mcs, 
Êow_id
, 
dú
, 
ía
)

446 
u64
 
ªg
, 
vÆ
;

448 i‡(
dú
 =
MCS_RX
) {

449 
ªg
 = 
MCSX_CPM_RX_SLAVE_FLOWID_TCAM_ENA_0
;

450 i‡(
Êow_id
 > 63)

451 
ªg
 = 
MCSX_CPM_RX_SLAVE_FLOWID_TCAM_ENA_1
;

453 
ªg
 = 
MCSX_CPM_TX_SLAVE_FLOWID_TCAM_ENA_0
;

454 i‡(
Êow_id
 > 63)

455 
ªg
 = 
MCSX_CPM_TX_SLAVE_FLOWID_TCAM_ENA_1
;

459 i‡(
ía
)

460 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
Ë| 
	`BIT_ULL
(
Êow_id
);

462 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
Ë& ~
	`BIT_ULL
(
Êow_id
);

464 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

465 
	}
}

467 
	$mcs_Êowid_íåy_wrôe
(
mcs
 *mcs, 
u64
 *
d©a
, u64 *
mask
, 
Êow_id
, 
dú
)

469 
ªg_id
;

470 
u64
 
ªg
;

472 i‡(
dú
 =
MCS_RX
) {

473 
ªg_id
 = 0;Ñeg_id < 4;Ñeg_id++) {

474 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_FLOWID_TCAM_DATAX
(
ªg_id
, 
Êow_id
);

475 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
d©a
[
ªg_id
]);

476 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_FLOWID_TCAM_MASKX
(
ªg_id
, 
Êow_id
);

477 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
mask
[
ªg_id
]);

480 
ªg_id
 = 0;Ñeg_id < 4;Ñeg_id++) {

481 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_FLOWID_TCAM_DATAX
(
ªg_id
, 
Êow_id
);

482 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
d©a
[
ªg_id
]);

483 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_FLOWID_TCAM_MASKX
(
ªg_id
, 
Êow_id
);

484 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
mask
[
ªg_id
]);

487 
	}
}

489 
	$mcs_ö°Æl_Êowid_by∑ss_íåy
(
mcs
 *mcs)

491 
Êow_id
, 
£cy_id
, 
ªg_id
;

492 
£cy_mem_m≠
 
m≠
;

493 
u64
 
ªg
, 
∂cy
 = 0;

496 
Êow_id
 = 
mcs
->
hw
->
tˇm_íåõs
 - 
MCS_RSRC_RSVD_CNT
;

497 
ªg_id
 = 0;Ñeg_id < 4;Ñeg_id++) {

498 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_FLOWID_TCAM_MASKX
(
ªg_id
, 
Êow_id
);

499 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
	`GENMASK_ULL
(63, 0));

501 
ªg_id
 = 0;Ñeg_id < 4;Ñeg_id++) {

502 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_FLOWID_TCAM_MASKX
(
ªg_id
, 
Êow_id
);

503 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
	`GENMASK_ULL
(63, 0));

506 
£cy_id
 = 
mcs
->
hw
->
£cy_íåõs
 - 
MCS_RSRC_RSVD_CNT
;

509 
∂cy
 = 0x7ull;

510 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

511 
∂cy
 = 
	`BIT_ULL
(0) | 0x3ull << 4;

512 
	`mcs_£cy_∂cy_wrôe
(
mcs
, 
∂cy
, 
£cy_id
, 
MCS_RX
);

515 
∂cy
 = 
	`BIT_ULL
(0Ë| 
	`GENMASK_ULL
(43, 28);

516 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

517 
∂cy
 = 
	`BIT_ULL
(0Ë| 
	`GENMASK_ULL
(63, 48);

518 
	`mcs_£cy_∂cy_wrôe
(
mcs
, 
∂cy
, 
£cy_id
, 
MCS_TX
);

521 
m≠
.
£cy
 = 
£cy_id
;

522 
m≠
.
˘æ_pkt
 = 0;

523 
m≠
.
Êow_id
 = flow_id;

524 
mcs
->
mcs_›s
->
	`mcs_Êowid_£cy_m≠
(mcs, &
m≠
, 
MCS_RX
);

525 
m≠
.
sc
 = 
£cy_id
;

526 
mcs
->
mcs_›s
->
	`mcs_Êowid_£cy_m≠
(mcs, &
m≠
, 
MCS_TX
);

529 
	`mcs_ía_dis_Êowid_íåy
(
mcs
, 
Êow_id
, 
MCS_RX
, 
åue
);

530 
	`mcs_ía_dis_Êowid_íåy
(
mcs
, 
Êow_id
, 
MCS_TX
, 
åue
);

532 
	}
}

534 
	$mcs_˛ór_£cy_∂cy
(
mcs
 *mcs, 
£cy_id
, 
dú
)

536 
mcs_r§c_m≠
 *
m≠
;

537 
Êow_id
;

539 i‡(
dú
 =
MCS_RX
)

540 
m≠
 = &
mcs
->
rx
;

542 
m≠
 = &
mcs
->
tx
;

545 
	`mcs_£cy_∂cy_wrôe
(
mcs
, 0, 
£cy_id
, 
dú
);

548 
Êow_id
 = 0; flow_id < 
m≠
->
Êow_ids
.
max
; flow_id++) {

549 i‡(
m≠
->
Êowid2£cy_m≠
[
Êow_id
] !
£cy_id
)

551 
	`mcs_ía_dis_Êowid_íåy
(
mcs
, 
Êow_id
, 
dú
, 
Ál£
);

553 
	}
}

555 
	$mcs_Æloc_˘æpkåuÀ
(
r§c_bm≠
 *
r§c
, 
u16
 *
pf_m≠
, u16 
off£t
, u16 
pcifunc
)

557 
r§c_id
;

559 i‡(!
r§c
->
bm≠
)

560  -
EINVAL
;

562 
r§c_id
 = 
	`bôm≠_föd_√xt_zîo_¨ó
(
r§c
->
bm≠
,Ñ§c->
max
, 
off£t
, 1, 0);

563 i‡(
r§c_id
 >
r§c
->
max
)

564  -
ENOSPC
;

566 
	`bôm≠_£t
(
r§c
->
bm≠
, 
r§c_id
, 1);

567 
pf_m≠
[
r§c_id
] = 
pcifunc
;

569  
r§c_id
;

570 
	}
}

572 
	$mcs_‰ì_˘æpkåuÀ
(
mcs
 *mcs, 
mcs_‰ì_˘æ_pkt_ruÀ_ªq
 *
ªq
)

574 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

575 
mcs_r§c_m≠
 *
m≠
;

576 
u64
 
dis
, 
ªg
;

577 
id
, 
rc
;

579 
ªg
 = (
ªq
->
dú
 =
MCS_RX
Ë? 
MCSX_PEX_RX_SLAVE_RULE_ENABLE
 : 
MCSX_PEX_TX_SLAVE_RULE_ENABLE
;

580 
m≠
 = (
ªq
->
dú
 =
MCS_RX
Ë? &
mcs
->
rx
 : &mcs->
tx
;

582 i‡(
ªq
->
Æl
) {

583 
id
 = 0; id < 
m≠
->
˘æpkåuÀ
.
max
; id++) {

584 i‡(
m≠
->
˘æpkåuÀ2pf_m≠
[
id
] !
pcifunc
)

586 
	`mcs_‰ì_r§c
(&
m≠
->
˘æpkåuÀ
, m≠->
˘æpkåuÀ2pf_m≠
, 
id
, 
pcifunc
);

587 
dis
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

588 
dis
 &~
	`BIT_ULL
(
id
);

589 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
dis
);

594 
rc
 = 
	`mcs_‰ì_r§c
(&
m≠
->
˘æpkåuÀ
, m≠->
˘æpkåuÀ2pf_m≠
, 
ªq
->
ruÀ_idx
, 
pcifunc
);

595 
dis
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

596 
dis
 &~
	`BIT_ULL
(
ªq
->
ruÀ_idx
);

597 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
dis
);

599  
rc
;

600 
	}
}

602 
	$mcs_˘æpkåuÀ_wrôe
(
mcs
 *mcs, 
mcs_˘æ_pkt_ruÀ_wrôe_ªq
 *
ªq
)

604 
u64
 
ªg
, 
íb
;

605 
u64
 
idx
;

607 
ªq
->
ruÀ_ty≥
) {

608 
MCS_CTRL_PKT_RULE_TYPE_ETH
:

609 
ªq
->
d©a0
 &
	`GENMASK
(15, 0);

610 i‡(
ªq
->
d©a0
 !
ETH_P_PAE
)

611  -
EINVAL
;

613 
idx
 = 
ªq
->
ruÀ_idx
 - 
MCS_CTRLPKT_ETYPE_RULE_OFFSET
;

614 
ªg
 = (
ªq
->
dú
 =
MCS_RX
Ë? 
	`MCSX_PEX_RX_SLAVE_RULE_ETYPE_CFGX
(
idx
) :

615 
	`MCSX_PEX_TX_SLAVE_RULE_ETYPE_CFGX
(
idx
);

617 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a0
);

619 
MCS_CTRL_PKT_RULE_TYPE_DA
:

620 i‡(!(
ªq
->
d©a0
 & 
	`BIT_ULL
(40)))

621  -
EINVAL
;

623 
idx
 = 
ªq
->
ruÀ_idx
 - 
MCS_CTRLPKT_DA_RULE_OFFSET
;

624 
ªg
 = (
ªq
->
dú
 =
MCS_RX
Ë? 
	`MCSX_PEX_RX_SLAVE_RULE_DAX
(
idx
) :

625 
	`MCSX_PEX_TX_SLAVE_RULE_DAX
(
idx
);

627 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a0
 & 
	`GENMASK_ULL
(47, 0));

629 
MCS_CTRL_PKT_RULE_TYPE_RANGE
:

630 i‡(!(
ªq
->
d©a0
 & 
	`BIT_ULL
(40)Ë|| !‘eq->
d©a1
 & BIT_ULL(40)))

631  -
EINVAL
;

633 
idx
 = 
ªq
->
ruÀ_idx
 - 
MCS_CTRLPKT_DA_RANGE_RULE_OFFSET
;

634 i‡(
ªq
->
dú
 =
MCS_RX
) {

635 
ªg
 = 
	`MCSX_PEX_RX_SLAVE_RULE_DA_RANGE_MINX
(
idx
);

636 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a0
 & 
	`GENMASK_ULL
(47, 0));

637 
ªg
 = 
	`MCSX_PEX_RX_SLAVE_RULE_DA_RANGE_MAXX
(
idx
);

638 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a1
 & 
	`GENMASK_ULL
(47, 0));

640 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_RULE_DA_RANGE_MINX
(
idx
);

641 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a0
 & 
	`GENMASK_ULL
(47, 0));

642 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_RULE_DA_RANGE_MAXX
(
idx
);

643 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a1
 & 
	`GENMASK_ULL
(47, 0));

646 
MCS_CTRL_PKT_RULE_TYPE_COMBO
:

647 
ªq
->
d©a2
 &
	`GENMASK
(15, 0);

648 i‡(
ªq
->
d©a2
 !
ETH_P_PAE
 || !‘eq->
d©a0
 & 
	`BIT_ULL
(40)) ||

649 !(
ªq
->
d©a1
 & 
	`BIT_ULL
(40)))

650  -
EINVAL
;

652 
idx
 = 
ªq
->
ruÀ_idx
 - 
MCS_CTRLPKT_COMBO_RULE_OFFSET
;

653 i‡(
ªq
->
dú
 =
MCS_RX
) {

654 
ªg
 = 
	`MCSX_PEX_RX_SLAVE_RULE_COMBO_MINX
(
idx
);

655 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a0
 & 
	`GENMASK_ULL
(47, 0));

656 
ªg
 = 
	`MCSX_PEX_RX_SLAVE_RULE_COMBO_MAXX
(
idx
);

657 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a1
 & 
	`GENMASK_ULL
(47, 0));

658 
ªg
 = 
	`MCSX_PEX_RX_SLAVE_RULE_COMBO_ETX
(
idx
);

659 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a2
);

661 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_RULE_COMBO_MINX
(
idx
);

662 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a0
 & 
	`GENMASK_ULL
(47, 0));

663 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_RULE_COMBO_MAXX
(
idx
);

664 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a1
 & 
	`GENMASK_ULL
(47, 0));

665 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_RULE_COMBO_ETX
(
idx
);

666 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a2
);

669 
MCS_CTRL_PKT_RULE_TYPE_MAC
:

670 i‡(!(
ªq
->
d©a0
 & 
	`BIT_ULL
(40)))

671  -
EINVAL
;

673 
idx
 = 
ªq
->
ruÀ_idx
 - 
MCS_CTRLPKT_MAC_EN_RULE_OFFSET
;

674 
ªg
 = (
ªq
->
dú
 =
MCS_RX
Ë? 
MCSX_PEX_RX_SLAVE_RULE_MAC
 :

675 
MCSX_PEX_TX_SLAVE_RULE_MAC
;

677 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ªq
->
d©a0
 & 
	`GENMASK_ULL
(47, 0));

681 
ªg
 = (
ªq
->
dú
 =
MCS_RX
Ë? 
MCSX_PEX_RX_SLAVE_RULE_ENABLE
 : 
MCSX_PEX_TX_SLAVE_RULE_ENABLE
;

683 
íb
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

684 
íb
 |
	`BIT_ULL
(
ªq
->
ruÀ_idx
);

685 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
íb
);

688 
	}
}

690 
	$mcs_‰ì_r§c
(
r§c_bm≠
 *
r§c
, 
u16
 *
pf_m≠
, 
r§c_id
, u16 
pcifunc
)

693 i‡(
pf_m≠
[
r§c_id
] !
pcifunc
)

694  -
EINVAL
;

696 
	`rvu_‰ì_r§c
(
r§c
, 
r§c_id
);

697 
pf_m≠
[
r§c_id
] = 0;

699 
	}
}

702 
	$mcs_‰ì_Æl_r§c
(
mcs
 *mcs, 
dú
, 
u16
 
pcifunc
)

704 
mcs_r§c_m≠
 *
m≠
;

705 
id
;

707 i‡(
dú
 =
MCS_RX
)

708 
m≠
 = &
mcs
->
rx
;

710 
m≠
 = &
mcs
->
tx
;

713 
id
 = 0; id < 
m≠
->
Êow_ids
.
max
; id++) {

714 i‡(
m≠
->
Êowid2pf_m≠
[
id
] !
pcifunc
)

716 
	`mcs_‰ì_r§c
(&
m≠
->
Êow_ids
, m≠->
Êowid2pf_m≠
,

717 
id
, 
pcifunc
);

718 
	`mcs_ía_dis_Êowid_íåy
(
mcs
, 
id
, 
dú
, 
Ál£
);

722 
id
 = 0; id < 
m≠
->
£cy
.
max
; id++) {

723 i‡(
m≠
->
£cy2pf_m≠
[
id
] !
pcifunc
)

725 
	`mcs_‰ì_r§c
(&
m≠
->
£cy
, m≠->
£cy2pf_m≠
,

726 
id
, 
pcifunc
);

727 
	`mcs_˛ór_£cy_∂cy
(
mcs
, 
id
, 
dú
);

731 
id
 = 0; id < 
m≠
->
£cy
.
max
; id++) {

732 i‡(
m≠
->
sc2pf_m≠
[
id
] !
pcifunc
)

734 
	`mcs_‰ì_r§c
(&
m≠
->
sc
, m≠->
sc2pf_m≠
, 
id
, 
pcifunc
);

737 i‡(
dú
 =
MCS_RX
)

738 
	`mcs_ía_dis_sc_ˇm_íåy
(
mcs
, 
id
, 
Ál£
);

742 
id
 = 0; id < 
m≠
->
ß
.
max
; id++) {

743 i‡(
m≠
->
ß2pf_m≠
[
id
] !
pcifunc
)

745 
	`mcs_‰ì_r§c
(&
m≠
->
ß
, m≠->
ß2pf_m≠
, 
id
, 
pcifunc
);

748 
	}
}

750 
	$mcs_Æloc_r§c
(
r§c_bm≠
 *
r§c
, 
u16
 *
pf_m≠
, u16 
pcifunc
)

752 
r§c_id
;

754 
r§c_id
 = 
	`rvu_Æloc_r§c
(
r§c
);

755 i‡(
r§c_id
 < 0)

756  -
ENOMEM
;

757 
pf_m≠
[
r§c_id
] = 
pcifunc
;

758  
r§c_id
;

759 
	}
}

761 
	$mcs_Æloc_Æl_r§c
(
mcs
 *mcs, 
u8
 *
Êow_id
, u8 *
£cy_id
,

762 
u8
 *
sc_id
, u8 *
ß1_id
, u8 *
ß2_id
, 
u16
 
pcifunc
, 
dú
)

764 
mcs_r§c_m≠
 *
m≠
;

765 
id
;

767 i‡(
dú
 =
MCS_RX
)

768 
m≠
 = &
mcs
->
rx
;

770 
m≠
 = &
mcs
->
tx
;

772 
id
 = 
	`mcs_Æloc_r§c
(&
m≠
->
Êow_ids
, m≠->
Êowid2pf_m≠
, 
pcifunc
);

773 i‡(
id
 < 0)

774  -
ENOMEM
;

775 *
Êow_id
 = 
id
;

777 
id
 = 
	`mcs_Æloc_r§c
(&
m≠
->
£cy
, m≠->
£cy2pf_m≠
, 
pcifunc
);

778 i‡(
id
 < 0)

779  -
ENOMEM
;

780 *
£cy_id
 = 
id
;

782 
id
 = 
	`mcs_Æloc_r§c
(&
m≠
->
sc
, m≠->
sc2pf_m≠
, 
pcifunc
);

783 i‡(
id
 < 0)

784  -
ENOMEM
;

785 *
sc_id
 = 
id
;

787 
id
 = 
	`mcs_Æloc_r§c
(&
m≠
->
ß
, m≠->
ß2pf_m≠
, 
pcifunc
);

788 i‡(
id
 < 0)

789  -
ENOMEM
;

790 *
ß1_id
 = 
id
;

792 
id
 = 
	`mcs_Æloc_r§c
(&
m≠
->
ß
, m≠->
ß2pf_m≠
, 
pcifunc
);

793 i‡(
id
 < 0)

794  -
ENOMEM
;

795 *
ß2_id
 = 
id
;

798 
	}
}

800 
	$˙10kb_mcs_tx_≤_wøµed_h™dÀr
(
mcs
 *mcs)

802 
mcs_öå_evít
 
evít
 = { 0 };

803 
r§c_bm≠
 *
sc_bm≠
;

804 
u64
 
vÆ
;

805 
sc
;

807 
sc_bm≠
 = &
mcs
->
tx
.
sc
;

809 
evít
.
mcs_id
 = 
mcs
->mcs_id;

810 
evít
.
öå_mask
 = 
MCS_CPM_TX_PACKET_XPN_EQ0_INT
;

812 
	`f‹_óch_£t_bô
(
sc
, 
sc_bm≠
->
bm≠
, 
mcs
->
hw
->
sc_íåõs
) {

813 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
	`MCSX_CPM_TX_SLAVE_SA_MAP_MEM_0X
(
sc
));

815 i‡(
mcs
->
tx_ß_a˘ive
[
sc
])

817 
evít
.
ß_id
 = (
vÆ
 >> 9) & 0xFF;

820 
evít
.
ß_id
 = 
vÆ
 & 0xFF;

822 
evít
.
pcifunc
 = 
mcs
->
tx
.
ß2pf_m≠
[evít.
ß_id
];

823 
	`mcs_add_öå_wq_íåy
(
mcs
, &
evít
);

825 
	}
}

827 
	$˙10kb_mcs_tx_≤_thªsh_ªached_h™dÀr
(
mcs
 *mcs)

829 
mcs_öå_evít
 
evít
 = { 0 };

830 
r§c_bm≠
 *
sc_bm≠
;

831 
u64
 
vÆ
, 
°©us
;

832 
sc
;

834 
sc_bm≠
 = &
mcs
->
tx
.
sc
;

836 
evít
.
mcs_id
 = 
mcs
->mcs_id;

837 
evít
.
öå_mask
 = 
MCS_CPM_TX_PN_THRESH_REACHED_INT
;

844 
	`f‹_óch_£t_bô
(
sc
, 
sc_bm≠
->
bm≠
, 
mcs
->
hw
->
sc_íåõs
) {

845 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
	`MCSX_CPM_TX_SLAVE_SA_MAP_MEM_0X
(
sc
));

847 i‡(!((
vÆ
 >> 18) & 0x1))

850 
°©us
 = (
vÆ
 >> 21) & 0x1;

853 i‡(
°©us
 =
mcs
->
tx_ß_a˘ive
[
sc
])

856 i‡(
°©us
)

857 
evít
.
ß_id
 = 
vÆ
 & 0xFF;

859 
evít
.
ß_id
 = (
vÆ
 >> 9) & 0xFF;

861 
evít
.
pcifunc
 = 
mcs
->
tx
.
ß2pf_m≠
[evít.
ß_id
];

862 
	`mcs_add_öå_wq_íåy
(
mcs
, &
evít
);

864 
	}
}

866 
	$mcs_rx_≤_thªsh_ªached_h™dÀr
(
mcs
 *mcs)

868 
mcs_öå_evít
 
evít
 = { 0 };

869 
ß
, 
ªg
;

870 
u64
 
öå
;

873 
ªg
 = 0;Ñeg < (
mcs
->
hw
->
ß_íåõs
 / 64);Ñeg++) {

877 
öå
 = 
	`mcs_ªg_ªad
(
mcs
, 
	`MCSX_CPM_RX_SLAVE_PN_THRESH_REACHEDX
(
ªg
));

878 
ß
 = 0; sa < 64; sa++) {

879 i‡(!(
öå
 & 
	`BIT_ULL
(
ß
)))

882 
evít
.
mcs_id
 = 
mcs
->mcs_id;

883 
evít
.
öå_mask
 = 
MCS_CPM_RX_PN_THRESH_REACHED_INT
;

884 
evít
.
ß_id
 = 
ß
 + (
ªg
 * 64);

885 
evít
.
pcifunc
 = 
mcs
->
rx
.
ß2pf_m≠
[evít.
ß_id
];

886 
	`mcs_add_öå_wq_íåy
(
mcs
, &
evít
);

889 
	}
}

891 
	$mcs_rx_misc_öå_h™dÀr
(
mcs
 *mcs, 
u64
 
öå
)

893 
mcs_öå_evít
 
evít
 = { 0 };

895 
evít
.
mcs_id
 = 
mcs
->mcs_id;

896 
evít
.
pcifunc
 = 
mcs
->
pf_m≠
[0];

898 i‡(
öå
 & 
MCS_CPM_RX_INT_SECTAG_V_EQ1
)

899 
evít
.
öå_mask
 = 
MCS_CPM_RX_SECTAG_V_EQ1_INT
;

900 i‡(
öå
 & 
MCS_CPM_RX_INT_SECTAG_E_EQ0_C_EQ1
)

901 
evít
.
öå_mask
 |
MCS_CPM_RX_SECTAG_E_EQ0_C_EQ1_INT
;

902 i‡(
öå
 & 
MCS_CPM_RX_INT_SL_GTE48
)

903 
evít
.
öå_mask
 |
MCS_CPM_RX_SECTAG_SL_GTE48_INT
;

904 i‡(
öå
 & 
MCS_CPM_RX_INT_ES_EQ1_SC_EQ1
)

905 
evít
.
öå_mask
 |
MCS_CPM_RX_SECTAG_ES_EQ1_SC_EQ1_INT
;

906 i‡(
öå
 & 
MCS_CPM_RX_INT_SC_EQ1_SCB_EQ1
)

907 
evít
.
öå_mask
 |
MCS_CPM_RX_SECTAG_SC_EQ1_SCB_EQ1_INT
;

908 i‡(
öå
 & 
MCS_CPM_RX_INT_PACKET_XPN_EQ0
)

909 
evít
.
öå_mask
 |
MCS_CPM_RX_PACKET_XPN_EQ0_INT
;

911 
	`mcs_add_öå_wq_íåy
(
mcs
, &
evít
);

912 
	}
}

914 
	$mcs_tx_misc_öå_h™dÀr
(
mcs
 *mcs, 
u64
 
öå
)

916 
mcs_öå_evít
 
evít
 = { 0 };

918 i‡(!(
öå
 & 
MCS_CPM_TX_INT_SA_NOT_VALID
))

921 
evít
.
mcs_id
 = 
mcs
->mcs_id;

922 
evít
.
pcifunc
 = 
mcs
->
pf_m≠
[0];

924 
evít
.
öå_mask
 = 
MCS_CPM_TX_SA_NOT_VALID_INT
;

926 
	`mcs_add_öå_wq_íåy
(
mcs
, &
evít
);

927 
	}
}

929 
	$mcs_bbe_öå_h™dÀr
(
mcs
 *mcs, 
u64
 
öå
, 
mcs_dúe˘i⁄
 
dú
)

931 
mcs_öå_evít
 
evít
 = { 0 };

932 
i
;

934 i‡(!(
öå
 & 
MCS_BBE_INT_MASK
))

937 
evít
.
mcs_id
 = 
mcs
->mcs_id;

938 
evít
.
pcifunc
 = 
mcs
->
pf_m≠
[0];

940 
i
 = 0; i < 
MCS_MAX_BBE_INT
; i++) {

941 i‡(!(
öå
 & 
	`BIT_ULL
(
i
)))

947 i‡(
öå
 & 0xFULL)

948 
evít
.
öå_mask
 = (
dú
 =
MCS_RX
) ?

949 
MCS_BBE_RX_DFIFO_OVERFLOW_INT
 :

950 
MCS_BBE_TX_DFIFO_OVERFLOW_INT
;

952 
evít
.
öå_mask
 = (
dú
 =
MCS_RX
) ?

953 
MCS_BBE_RX_PLFIFO_OVERFLOW_INT
 :

954 
MCS_BBE_RX_PLFIFO_OVERFLOW_INT
;

957 
evít
.
lmac_id
 = 
i
 & 0x3ULL;

958 
	`mcs_add_öå_wq_íåy
(
mcs
, &
evít
);

960 
	}
}

962 
	$mcs_∑b_öå_h™dÀr
(
mcs
 *mcs, 
u64
 
öå
, 
mcs_dúe˘i⁄
 
dú
)

964 
mcs_öå_evít
 
evít
 = { 0 };

965 
i
;

967 i‡(!(
öå
 & 
MCS_PAB_INT_MASK
))

970 
evít
.
mcs_id
 = 
mcs
->mcs_id;

971 
evít
.
pcifunc
 = 
mcs
->
pf_m≠
[0];

973 
i
 = 0; i < 
MCS_MAX_PAB_INT
; i++) {

974 i‡(!(
öå
 & 
	`BIT_ULL
(
i
)))

977 
evít
.
öå_mask
 = (
dú
 =
MCS_RX
Ë? 
MCS_PAB_RX_CHAN_OVERFLOW_INT
 :

978 
MCS_PAB_TX_CHAN_OVERFLOW_INT
;

981 
evít
.
lmac_id
 = 
i
;

982 
	`mcs_add_öå_wq_íåy
(
mcs
, &
evít
);

984 
	}
}

986 
úqªtu∫_t
 
	$mcs_ù_öå_h™dÀr
(
úq
, *
mcs_úq
)

988 
mcs
 *mc†(mc†*)
mcs_úq
;

989 
u64
 
öå
, 
˝m_öå
, 
bbe_öå
, 
∑b_öå
;

992 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_IP_INT_ENA_W1C
, 
	`BIT_ULL
(0));

993 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_IP_INT
, 
	`BIT_ULL
(0));

996 
öå
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_TOP_SLAVE_INT_SUM
);

999 i‡(
öå
 & 
MCS_CPM_RX_INT_ENA
) {

1001 
˝m_öå
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_CPM_RX_SLAVE_RX_INT
);

1003 i‡(
˝m_öå
 & 
MCS_CPM_RX_INT_PN_THRESH_REACHED
)

1004 
	`mcs_rx_≤_thªsh_ªached_h™dÀr
(
mcs
);

1006 i‡(
˝m_öå
 & 
MCS_CPM_RX_INT_ALL
)

1007 
	`mcs_rx_misc_öå_h™dÀr
(
mcs
, 
˝m_öå
);

1010 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_CPM_RX_SLAVE_RX_INT
, 
˝m_öå
);

1014 i‡(
öå
 & 
MCS_CPM_TX_INT_ENA
) {

1015 
˝m_öå
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_CPM_TX_SLAVE_TX_INT
);

1017 i‡(
˝m_öå
 & 
MCS_CPM_TX_INT_PN_THRESH_REACHED
) {

1018 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

1019 
	`˙f10kb_mcs_tx_≤_thªsh_ªached_h™dÀr
(
mcs
);

1021 
	`˙10kb_mcs_tx_≤_thªsh_ªached_h™dÀr
(
mcs
);

1024 i‡(
˝m_öå
 & 
MCS_CPM_TX_INT_SA_NOT_VALID
)

1025 
	`mcs_tx_misc_öå_h™dÀr
(
mcs
, 
˝m_öå
);

1027 i‡(
˝m_öå
 & 
MCS_CPM_TX_INT_PACKET_XPN_EQ0
) {

1028 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

1029 
	`˙f10kb_mcs_tx_≤_wøµed_h™dÀr
(
mcs
);

1031 
	`˙10kb_mcs_tx_≤_wøµed_h™dÀr
(
mcs
);

1034 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_CPM_TX_SLAVE_TX_INT
, 
˝m_öå
);

1038 i‡(
öå
 & 
MCS_BBE_RX_INT_ENA
) {

1039 
bbe_öå
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_BBE_RX_SLAVE_BBE_INT
);

1040 
	`mcs_bbe_öå_h™dÀr
(
mcs
, 
bbe_öå
, 
MCS_RX
);

1043 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_BBE_INT_INTR_RW
, 0);

1044 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_BBE_INT
, 
bbe_öå
);

1048 i‡(
öå
 & 
MCS_BBE_TX_INT_ENA
) {

1049 
bbe_öå
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_BBE_TX_SLAVE_BBE_INT
);

1050 
	`mcs_bbe_öå_h™dÀr
(
mcs
, 
bbe_öå
, 
MCS_TX
);

1053 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_TX_SLAVE_BBE_INT_INTR_RW
, 0);

1054 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_TX_SLAVE_BBE_INT
, 
bbe_öå
);

1058 i‡(
öå
 & 
MCS_PAB_RX_INT_ENA
) {

1059 
∑b_öå
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_PAB_RX_SLAVE_PAB_INT
);

1060 
	`mcs_∑b_öå_h™dÀr
(
mcs
, 
∑b_öå
, 
MCS_RX
);

1063 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_PAB_RX_SLAVE_PAB_INT_INTR_RW
, 0);

1064 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_PAB_RX_SLAVE_PAB_INT
, 
∑b_öå
);

1068 i‡(
öå
 & 
MCS_PAB_TX_INT_ENA
) {

1069 
∑b_öå
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_PAB_TX_SLAVE_PAB_INT
);

1070 
	`mcs_∑b_öå_h™dÀr
(
mcs
, 
∑b_öå
, 
MCS_TX
);

1073 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_PAB_TX_SLAVE_PAB_INT_INTR_RW
, 0);

1074 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_PAB_TX_SLAVE_PAB_INT
, 
∑b_öå
);

1078 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_IP_INT_ENA_W1S
, 
	`BIT_ULL
(0));

1080  
IRQ_HANDLED
;

1081 
	}
}

1083 *
	$Æloc_mem
(
mcs
 *mcs, 
n
)

1085  
	`devm_kˇŒoc
(
mcs
->
dev
, 
n
, (
u16
), 
GFP_KERNEL
);

1086 
	}
}

1088 
	$mcs_Æloc_°ru˘_mem
(
mcs
 *mcs, 
mcs_r§c_m≠
 *
ªs
)

1090 
hwöfo
 *
hw
 = 
mcs
->hw;

1091 
îr
;

1093 
ªs
->
Êowid2pf_m≠
 = 
	`Æloc_mem
(
mcs
, 
hw
->
tˇm_íåõs
);

1094 i‡(!
ªs
->
Êowid2pf_m≠
)

1095  -
ENOMEM
;

1097 
ªs
->
£cy2pf_m≠
 = 
	`Æloc_mem
(
mcs
, 
hw
->
£cy_íåõs
);

1098 i‡(!
ªs
->
£cy2pf_m≠
)

1099  -
ENOMEM
;

1101 
ªs
->
sc2pf_m≠
 = 
	`Æloc_mem
(
mcs
, 
hw
->
sc_íåõs
);

1102 i‡(!
ªs
->
sc2pf_m≠
)

1103  -
ENOMEM
;

1105 
ªs
->
ß2pf_m≠
 = 
	`Æloc_mem
(
mcs
, 
hw
->
ß_íåõs
);

1106 i‡(!
ªs
->
ß2pf_m≠
)

1107  -
ENOMEM
;

1109 
ªs
->
Êowid2£cy_m≠
 = 
	`Æloc_mem
(
mcs
, 
hw
->
tˇm_íåõs
);

1110 i‡(!
ªs
->
Êowid2£cy_m≠
)

1111  -
ENOMEM
;

1113 
ªs
->
˘æpkåuÀ2pf_m≠
 = 
	`Æloc_mem
(
mcs
, 
MCS_MAX_CTRLPKT_RULES
);

1114 i‡(!
ªs
->
˘æpkåuÀ2pf_m≠
)

1115  -
ENOMEM
;

1117 
ªs
->
Êow_ids
.
max
 = 
hw
->
tˇm_íåõs
 - 
MCS_RSRC_RSVD_CNT
;

1118 
îr
 = 
	`rvu_Æloc_bôm≠
(&
ªs
->
Êow_ids
);

1119 i‡(
îr
)

1120  
îr
;

1122 
ªs
->
£cy
.
max
 = 
hw
->
£cy_íåõs
 - 
MCS_RSRC_RSVD_CNT
;

1123 
îr
 = 
	`rvu_Æloc_bôm≠
(&
ªs
->
£cy
);

1124 i‡(
îr
)

1125  
îr
;

1127 
ªs
->
sc
.
max
 = 
hw
->
sc_íåõs
;

1128 
îr
 = 
	`rvu_Æloc_bôm≠
(&
ªs
->
sc
);

1129 i‡(
îr
)

1130  
îr
;

1132 
ªs
->
ß
.
max
 = 
hw
->
ß_íåõs
;

1133 
îr
 = 
	`rvu_Æloc_bôm≠
(&
ªs
->
ß
);

1134 i‡(
îr
)

1135  
îr
;

1137 
ªs
->
˘æpkåuÀ
.
max
 = 
MCS_MAX_CTRLPKT_RULES
;

1138 
îr
 = 
	`rvu_Æloc_bôm≠
(&
ªs
->
˘æpkåuÀ
);

1139 i‡(
îr
)

1140  
îr
;

1143 
	}
}

1145 
	$mcs_ªgi°î_öãºu±s
(
mcs
 *mcs)

1147 
ªt
 = 0;

1149 
mcs
->
num_vec
 = 
	`pci_msix_vec_cou¡
(mcs->
pdev
);

1151 
ªt
 = 
	`pci_Æloc_úq_ve˘‹s
(
mcs
->
pdev
, mcs->
num_vec
,

1152 
mcs
->
num_vec
, 
PCI_IRQ_MSIX
);

1153 i‡(
ªt
 < 0) {

1154 
	`dev_îr
(
mcs
->
dev
, "MCS Request for %d msix vector failedÉrr:%d\n",

1155 
mcs
->
num_vec
, 
ªt
);

1156  
ªt
;

1159 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
mcs
->
pdev
, 
MCS_INT_VEC_IP
),

1160 
mcs_ù_öå_h™dÀr
, 0, "MCS_IP", 
mcs
);

1161 i‡(
ªt
) {

1162 
	`dev_îr
(
mcs
->
dev
, "MCS IP irqÑegistration failed\n");

1163 
exô
;

1167 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_IP_INT_ENA_W1S
, 
	`BIT_ULL
(0));

1170 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_TOP_SLAVE_INT_SUM_ENB
,

1171 
MCS_CPM_RX_INT_ENA
 | 
MCS_CPM_TX_INT_ENA
 |

1172 
MCS_BBE_RX_INT_ENA
 | 
MCS_BBE_TX_INT_ENA
 |

1173 
MCS_PAB_RX_INT_ENA
 | 
MCS_PAB_TX_INT_ENA
);

1175 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_CPM_TX_SLAVE_TX_INT_ENB
, 0x7ULL);

1176 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_CPM_RX_SLAVE_RX_INT_ENB
, 0x7FULL);

1178 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_BBE_INT_ENB
, 0xff);

1179 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_TX_SLAVE_BBE_INT_ENB
, 0xff);

1181 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_PAB_RX_SLAVE_PAB_INT_ENB
, 0xff);

1182 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_PAB_TX_SLAVE_PAB_INT_ENB
, 0xff);

1184 
mcs
->
tx_ß_a˘ive
 = 
	`Æloc_mem
(mcs, mcs->
hw
->
sc_íåõs
);

1185 i‡(!
mcs
->
tx_ß_a˘ive
) {

1186 
ªt
 = -
ENOMEM
;

1187 
exô
;

1190  
ªt
;

1191 
exô
:

1192 
	`pci_‰ì_úq_ve˘‹s
(
mcs
->
pdev
);

1193 
mcs
->
num_vec
 = 0;

1194  
ªt
;

1195 
	}
}

1197 
	$mcs_gë_blk˙t
()

1199 
mcs
 *mcs;

1200 
idmax
 = -
ENODEV
;

1203 i‡(!
	`pci_dev_¥e£¡
(
mcs_id_èbÀ
))

1206 
	`li°_f‹_óch_íåy
(
mcs
, &
mcs_li°
, mcs_list)

1207 i‡(
mcs
->
mcs_id
 > 
idmax
)

1208 
idmax
 = 
mcs
->
mcs_id
;

1210 i‡(
idmax
 < 0)

1213  
idmax
 + 1;

1214 
	}
}

1216 
mcs
 *
	$mcs_gë_pd©a
(
mcs_id
)

1218 
mcs
 *
mcs_dev
;

1220 
	`li°_f‹_óch_íåy
(
mcs_dev
, &
mcs_li°
, mcs_list) {

1221 i‡(
mcs_dev
->
mcs_id
 == mcs_id)

1222  
mcs_dev
;

1224  
NULL
;

1225 
	}
}

1227 
	$mcs_£t_p‹t_cfg
(
mcs
 *mcs, 
mcs_p‹t_cfg_£t_ªq
 *
ªq
)

1229 
u64
 
vÆ
 = 0;

1231 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_PAB_RX_SLAVE_PORT_CFGX
(
ªq
->
p‹t_id
),

1232 
ªq
->
p‹t_mode
 & 
MCS_PORT_MODE_MASK
);

1234 i‡(
ªq
->
p‹t_mode
 == 2) {

1235 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_CAL_ENTRY
, 0);

1236 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_CAL_LEN
, 1);

1237 } i‡(
ªq
->
p‹t_mode
 == 1) {

1238 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_CAL_ENTRY
, 0x8);

1239 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_CAL_LEN
, 2);

1241 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_CAL_ENTRY
, 0xe4);

1242 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_CAL_LEN
, 4);

1245 
ªq
->
c°m_èg_ªl_mode_£l
 &= 0x3;

1247 i‡(
mcs
->
hw
->
mcs_blks
 > 1) {

1248 
ªq
->
fifo_skid
 &
MCS_PORT_FIFO_SKID_MASK
;

1249 
vÆ
 = (
u32
)
ªq
->
fifo_skid
 << 0x10;

1250 
vÆ
 |
ªq
->
fifo_skid
;

1251 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_PAB_RX_SLAVE_FIFO_SKID_CFGX
(
ªq
->
p‹t_id
), 
vÆ
);

1252 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_PEX_TX_SLAVE_CUSTOM_TAG_REL_MODE_SEL
(
ªq
->
p‹t_id
),

1253 
ªq
->
c°m_èg_ªl_mode_£l
);

1254 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_PEX_RX_SLAVE_PEX_CONFIGURATION
);

1256 i‡(
ªq
->
cu°om_hdr_íb
)

1257 
vÆ
 |
	`BIT_ULL
(
ªq
->
p‹t_id
);

1259 
vÆ
 &~
	`BIT_ULL
(
ªq
->
p‹t_id
);

1261 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_PEX_RX_SLAVE_PEX_CONFIGURATION
, 
vÆ
);

1263 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
	`MCSX_PEX_TX_SLAVE_PORT_CONFIG
(
ªq
->
p‹t_id
));

1264 
vÆ
 |(
ªq
->
c°m_èg_ªl_mode_£l
 << 2);

1265 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_PEX_TX_SLAVE_PORT_CONFIG
(
ªq
->
p‹t_id
), 
vÆ
);

1267 
	}
}

1269 
	$mcs_gë_p‹t_cfg
(
mcs
 *mcs, 
mcs_p‹t_cfg_gë_ªq
 *
ªq
,

1270 
mcs_p‹t_cfg_gë_r•
 *
r•
)

1272 
u64
 
ªg
 = 0;

1274 
r•
->
p‹t_mode
 = 
	`mcs_ªg_ªad
(
mcs
, 
	`MCSX_PAB_RX_SLAVE_PORT_CFGX
(
ªq
->
p‹t_id
)) &

1275 
MCS_PORT_MODE_MASK
;

1277 i‡(
mcs
->
hw
->
mcs_blks
 > 1) {

1278 
ªg
 = 
	`MCSX_PAB_RX_SLAVE_FIFO_SKID_CFGX
(
ªq
->
p‹t_id
);

1279 
r•
->
fifo_skid
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
Ë& 
MCS_PORT_FIFO_SKID_MASK
;

1280 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_CUSTOM_TAG_REL_MODE_SEL
(
ªq
->
p‹t_id
);

1281 
r•
->
c°m_èg_ªl_mode_£l
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
) & 0x3;

1282 i‡(
	`mcs_ªg_ªad
(
mcs
, 
MCSX_PEX_RX_SLAVE_PEX_CONFIGURATION
Ë& 
	`BIT_ULL
(
ªq
->
p‹t_id
))

1283 
r•
->
cu°om_hdr_íb
 = 1;

1285 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_PORT_CONFIG
(
ªq
->
p‹t_id
);

1286 
r•
->
c°m_èg_ªl_mode_£l
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
) >> 2;

1289 
r•
->
p‹t_id
 = 
ªq
->port_id;

1290 
r•
->
mcs_id
 = 
ªq
->mcs_id;

1291 
	}
}

1293 
	$mcs_gë_cu°om_èg_cfg
(
mcs
 *mcs, 
mcs_cu°om_èg_cfg_gë_ªq
 *
ªq
,

1294 
mcs_cu°om_èg_cfg_gë_r•
 *
r•
)

1296 
u64
 
ªg
 = 0, 
vÆ
 = 0;

1297 
u8
 
idx
;

1299 
idx
 = 0; idx < 
MCS_MAX_CUSTOM_TAGS
; idx++) {

1300 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

1301 
ªg
 = (
ªq
->
dú
 =
MCS_RX
Ë? 
	`MCSX_PEX_RX_SLAVE_CUSTOM_TAGX
(
idx
) :

1302 
	`MCSX_PEX_TX_SLAVE_CUSTOM_TAGX
(
idx
);

1304 
ªg
 = (
ªq
->
dú
 =
MCS_RX
Ë? 
	`MCSX_PEX_RX_SLAVE_VLAN_CFGX
(
idx
) :

1305 
	`MCSX_PEX_TX_SLAVE_VLAN_CFGX
(
idx
);

1307 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

1308 i‡(
mcs
->
hw
->
mcs_blks
 > 1) {

1309 
r•
->
c°m_ëy≥
[
idx
] = 
vÆ
 & 
	`GENMASK
(15, 0);

1310 
r•
->
c°m_ödx
[
idx
] = (
vÆ
 >> 0x16) & 0x3;

1311 
ªg
 = (
ªq
->
dú
 =
MCS_RX
Ë? 
MCSX_PEX_RX_SLAVE_ETYPE_ENABLE
 :

1312 
MCSX_PEX_TX_SLAVE_ETYPE_ENABLE
;

1313 
r•
->
c°m_ëy≥_í
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
) & 0xFF;

1315 
r•
->
c°m_ëy≥
[
idx
] = (
vÆ
 >> 0x1Ë& 
	`GENMASK
(15, 0);

1316 
r•
->
c°m_ödx
[
idx
] = (
vÆ
 >> 0x11) & 0x3;

1317 
r•
->
c°m_ëy≥_í
 |(
vÆ
 & 0x1Ë<< 
idx
;

1321 
r•
->
mcs_id
 = 
ªq
->mcs_id;

1322 
r•
->
dú
 = 
ªq
->dir;

1323 
	}
}

1325 
	$mcs_ª£t_p‹t
(
mcs
 *mcs, 
u8
 
p‹t_id
, u8 
ª£t
)

1327 
u64
 
ªg
 = 
	`MCSX_MCS_TOP_SLAVE_PORT_RESET
(
p‹t_id
);

1329 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
ª£t
 & 0x1);

1330 
	}
}

1333 
	$mcs_£t_lmac_mode
(
mcs
 *mcs, 
lmac_id
, 
u8
 
mode
)

1335 
u64
 
ªg
;

1337 
ªg
 = 
	`MCSX_MCS_TOP_SLAVE_CHANNEL_CFG
(
lmac_id
 * 2);

1338 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, (
u64
)
mode
);

1339 
	}
}

1341 
	$mcs_≤_thªshﬁd_£t
(
mcs
 *mcs, 
mcs_£t_≤_thªshﬁd
 *
≤
)

1343 
u64
 
ªg
;

1345 i‡(
≤
->
dú
 =
MCS_RX
)

1346 
ªg
 = 
≤
->
x≤
 ? 
MCSX_CPM_RX_SLAVE_XPN_THRESHOLD
 : 
MCSX_CPM_RX_SLAVE_PN_THRESHOLD
;

1348 
ªg
 = 
≤
->
x≤
 ? 
MCSX_CPM_TX_SLAVE_XPN_THRESHOLD
 : 
MCSX_CPM_TX_SLAVE_PN_THRESHOLD
;

1350 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
≤
->
thªshﬁd
);

1351 
	}
}

1353 
	$˙10kb_mcs_∑r£r_cfg
(
mcs
 *mcs)

1355 
u64
 
ªg
, 
vÆ
;

1358 
vÆ
 = 
	`BIT_ULL
(0) | (0x8100ull & 0xFFFF) << 1 | BIT_ULL(17);

1360 
ªg
 = 
	`MCSX_PEX_RX_SLAVE_VLAN_CFGX
(0);

1361 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

1364 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_VLAN_CFGX
(0);

1365 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

1368 
vÆ
 = 
	`BIT_ULL
(0) | (0x88a8ull & 0xFFFF) << 1 | BIT_ULL(18);

1370 
ªg
 = 
	`MCSX_PEX_RX_SLAVE_VLAN_CFGX
(1);

1371 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

1374 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_VLAN_CFGX
(1);

1375 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

1376 
	}
}

1378 
	$mcs_lmac_öô
(
mcs
 *mcs, 
lmac_id
)

1380 
u64
 
ªg
;

1383 
ªg
 = 
	`MCSX_PAB_RX_SLAVE_PORT_CFGX
(
lmac_id
);

1384 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 0);

1386 i‡(
mcs
->
hw
->
mcs_blks
 > 1) {

1387 
ªg
 = 
	`MCSX_PAB_RX_SLAVE_FIFO_SKID_CFGX
(
lmac_id
);

1388 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 0xe000e);

1392 
ªg
 = 
	`MCSX_PAB_TX_SLAVE_PORT_CFGX
(
lmac_id
);

1393 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 0);

1394 
	}
}

1396 
	$mcs_£t_lmac_ch™√ls
(
mcs_id
, 
u16
 
ba£
)

1398 
mcs
 *mcs;

1399 
lmac
;

1400 
u64
 
cfg
;

1402 
mcs
 = 
	`mcs_gë_pd©a
(
mcs_id
);

1403 i‡(!
mcs
)

1404  -
ENODEV
;

1405 
lmac
 = 0;Üma¯< 
mcs
->
hw
->
lmac_˙t
;Ümac++) {

1406 
cfg
 = 
	`mcs_ªg_ªad
(
mcs
, 
	`MCSX_LINK_LMACX_CFG
(
lmac
));

1407 
cfg
 &~(
MCSX_LINK_LMAC_BASE_MASK
 | 
MCSX_LINK_LMAC_RANGE_MASK
);

1408 
cfg
 |
	`FIELD_PREP
(
MCSX_LINK_LMAC_RANGE_MASK
, 
	`ûog2
(16));

1409 
cfg
 |
	`FIELD_PREP
(
MCSX_LINK_LMAC_BASE_MASK
, 
ba£
);

1410 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_LINK_LMACX_CFG
(
lmac
), 
cfg
);

1411 
ba£
 += 16;

1414 
	}
}

1416 
	$mcs_x2p_ˇlibøti⁄
(
mcs
 *mcs)

1418 
timeout
 = 
jiffõs
 + 
	`u£cs_to_jiffõs
(20000);

1419 
i
, 
îr
 = 0;

1420 
u64
 
vÆ
;

1423 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_MIL_GLOBAL
);

1424 
vÆ
 |
	`BIT_ULL
(5);

1425 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_MIL_GLOBAL
, 
vÆ
);

1428 !(
	`mcs_ªg_ªad
(
mcs
, 
MCSX_MIL_RX_GBL_STATUS
Ë& 
	`BIT_ULL
(0))) {

1429 i‡(
	`time_bef‹e
(
jiffõs
, 
timeout
)) {

1430 
	`u¶ìp_ønge
(80, 100);

1433 
îr
 = -
EBUSY
;

1434 
	`dev_îr
(
mcs
->
dev
, "MCS X2P calibration failed..ignoring\n");

1435  
îr
;

1439 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_MIL_RX_GBL_STATUS
);

1440 
i
 = 0; i < 
mcs
->
hw
->
mcs_x2p_ötf
; i++) {

1441 i‡(
vÆ
 & 
	`BIT_ULL
(1 + 
i
))

1443 
îr
 = -
EBUSY
;

1444 
	`dev_îr
(
mcs
->
dev
, "MCS:%d didn'àª•⁄dÅÿX2P cÆibøti⁄\n", 
i
);

1447 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_MIL_GLOBAL
, 
	`mcs_ªg_ªad
(mcs, MCSX_MIL_GLOBALË& ~
	`BIT_ULL
(5));

1449  
îr
;

1450 
	}
}

1452 
	$mcs_£t_exã∫Æ_by∑ss
(
mcs
 *mcs, 
u8
 
by∑ss
)

1454 
u64
 
vÆ
;

1457 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_MIL_GLOBAL
);

1458 i‡(
by∑ss
)

1459 
vÆ
 |
	`BIT_ULL
(6);

1461 
vÆ
 &~
	`BIT_ULL
(6);

1462 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_MIL_GLOBAL
, 
vÆ
);

1463 
	}
}

1465 
	$mcs_globÆ_cfg
(
mcs
 *mcs)

1468 
	`mcs_£t_exã∫Æ_by∑ss
(
mcs
, 
Ál£
);

1471 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_CSE_RX_SLAVE_STATS_CLEAR
, 0x1F);

1472 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_CSE_TX_SLAVE_STATS_CLEAR
, 0x1F);

1475 i‡(
mcs
->
hw
->
mcs_blks
 == 1) {

1476 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_IP_MODE
, 
	`BIT_ULL
(3));

1480 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_CAL_ENTRY
, 0xe4);

1481 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_BBE_RX_SLAVE_CAL_LEN
, 4);

1482 
	}
}

1484 
	$˙10kb_mcs_£t_hw_ˇ∑bûôõs
(
mcs
 *mcs)

1486 
hwöfo
 *
hw
 = 
mcs
->hw;

1488 
hw
->
tˇm_íåõs
 = 128;

1489 
hw
->
£cy_íåõs
 = 128;

1490 
hw
->
sc_íåõs
 = 128;

1491 
hw
->
ß_íåõs
 = 256;

1492 
hw
->
lmac_˙t
 = 20;

1493 
hw
->
mcs_x2p_ötf
 = 5;

1494 
hw
->
mcs_blks
 = 1;

1495 
	}
}

1497 
mcs_›s
 
	g˙10kb_mcs_›s
 = {

1498 .
mcs_£t_hw_ˇ∑bûôõs
 = 
˙10kb_mcs_£t_hw_ˇ∑bûôõs
,

1499 .
	gmcs_∑r£r_cfg
 = 
˙10kb_mcs_∑r£r_cfg
,

1500 .
	gmcs_tx_ß_mem_m≠_wrôe
 = 
˙10kb_mcs_tx_ß_mem_m≠_wrôe
,

1501 .
	gmcs_rx_ß_mem_m≠_wrôe
 = 
˙10kb_mcs_rx_ß_mem_m≠_wrôe
,

1502 .
	gmcs_Êowid_£cy_m≠
 = 
˙10kb_mcs_Êowid_£cy_m≠
,

1505 
	$mcs_¥obe
(
pci_dev
 *
pdev
, c⁄° 
pci_devi˚_id
 *
id
)

1507 
devi˚
 *
dev
 = &
pdev
->dev;

1508 
lmac
, 
îr
 = 0;

1509 
mcs
 *mcs;

1511 
mcs
 = 
	`devm_kzÆloc
(
dev
, (*mcs), 
GFP_KERNEL
);

1512 i‡(!
mcs
)

1513  -
ENOMEM
;

1515 
mcs
->
hw
 = 
	`devm_kzÆloc
(
dev
, (
hwöfo
), 
GFP_KERNEL
);

1516 i‡(!
mcs
->
hw
)

1517  -
ENOMEM
;

1519 
îr
 = 
	`pci_íabÀ_devi˚
(
pdev
);

1520 i‡(
îr
) {

1521 
	`dev_îr
(
dev
, "FailedÅoÉnable PCI device\n");

1522 
	`pci_£t_drvd©a
(
pdev
, 
NULL
);

1523  
îr
;

1526 
îr
 = 
	`pci_ªque°_ªgi⁄s
(
pdev
, 
DRV_NAME
);

1527 i‡(
îr
) {

1528 
	`dev_îr
(
dev
, "PCIÑeque°Ñegi⁄†Áûed 0x%x\n", 
îr
);

1529 
exô
;

1532 
mcs
->
ªg_ba£
 = 
	`pcim_iom≠
(
pdev
, 
PCI_CFG_REG_BAR_NUM
, 0);

1533 i‡(!
mcs
->
ªg_ba£
) {

1534 
	`dev_îr
(
dev
, "mcs: Cannot map CSR memory space,áborting\n");

1535 
îr
 = -
ENOMEM
;

1536 
exô
;

1539 
	`pci_£t_drvd©a
(
pdev
, 
mcs
);

1540 
mcs
->
pdev
 =Ödev;

1541 
mcs
->
dev
 = &
pdev
->dev;

1543 i‡(
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CN10K_B
)

1544 
mcs
->
mcs_›s
 = &
˙10kb_mcs_›s
;

1546 
mcs
->
mcs_›s
 = 
	`˙f10kb_gë_mac_›s
();

1549 
mcs
->
mcs_›s
->
	`mcs_£t_hw_ˇ∑bûôõs
(mcs);

1551 
	`mcs_globÆ_cfg
(
mcs
);

1554 
îr
 = 
	`mcs_x2p_ˇlibøti⁄
(
mcs
);

1555 i‡(
îr
)

1556 
îr_x2p
;

1558 
mcs
->
mcs_id
 = (
	`pci_ªsour˚_°¨t
(
pdev
, 
PCI_CFG_REG_BAR_NUM
) >> 24)

1559 & 
MCS_ID_MASK
;

1562 
îr
 = 
	`mcs_Æloc_°ru˘_mem
(
mcs
, &mcs->
tx
);

1563 i‡(
îr
)

1564 
îr_x2p
;

1567 
îr
 = 
	`mcs_Æloc_°ru˘_mem
(
mcs
, &mcs->
rx
);

1568 i‡(
îr
)

1569 
îr_x2p
;

1572 
lmac
 = 0;Üma¯< 
mcs
->
hw
->
lmac_˙t
;Ümac++)

1573 
	`mcs_lmac_öô
(
mcs
, 
lmac
);

1576 
mcs
->
mcs_›s
->
	`mcs_∑r£r_cfg
(mcs);

1578 
îr
 = 
	`mcs_ªgi°î_öãºu±s
(
mcs
);

1579 i‡(
îr
)

1580 
exô
;

1582 
	`li°_add
(&
mcs
->
mcs_li°
, &mcs_list);

1583 
	`muãx_öô
(&
mcs
->
°©s_lock
);

1587 
îr_x2p
:

1589 
	`mcs_£t_exã∫Æ_by∑ss
(
mcs
, 
åue
);

1590 
exô
:

1591 
	`pci_ªÀa£_ªgi⁄s
(
pdev
);

1592 
	`pci_dißbÀ_devi˚
(
pdev
);

1593 
	`pci_£t_drvd©a
(
pdev
, 
NULL
);

1594  
îr
;

1595 
	}
}

1597 
	$mcs_ªmove
(
pci_dev
 *
pdev
)

1599 
mcs
 *mc†
	`pci_gë_drvd©a
(
pdev
);

1602 
	`mcs_£t_exã∫Æ_by∑ss
(
mcs
, 
åue
);

1603 
	`pci_‰ì_úq_ve˘‹s
(
pdev
);

1604 
	`pci_ªÀa£_ªgi⁄s
(
pdev
);

1605 
	`pci_dißbÀ_devi˚
(
pdev
);

1606 
	`pci_£t_drvd©a
(
pdev
, 
NULL
);

1607 
	}
}

1609 
pci_drivî
 
	gmcs_drivî
 = {

1610 .
«me
 = 
DRV_NAME
,

1611 .
	gid_èbÀ
 = 
mcs_id_èbÀ
,

1612 .
	g¥obe
 = 
mcs_¥obe
,

1613 .
	gªmove
 = 
mcs_ªmove
,

	@mcs.h

7 #i‚de‡
MCS_H


8 
	#MCS_H


	)

10 
	~<löux/bôs.h
>

11 
	~"rvu.h
"

13 
	#PCI_DEVID_CN10K_MCS
 0xA096

	)

15 
	#MCSX_LINK_LMAC_RANGE_MASK
 
	`GENMASK_ULL
(19, 16)

	)

16 
	#MCSX_LINK_LMAC_BASE_MASK
 
	`GENMASK_ULL
(11, 0)

	)

18 
	#MCS_ID_MASK
 0x7

	)

19 
	#MCS_MAX_PFS
 128

	)

21 
	#MCS_PORT_MODE_MASK
 0x3

	)

22 
	#MCS_PORT_FIFO_SKID_MASK
 0x3F

	)

23 
	#MCS_MAX_CUSTOM_TAGS
 0x8

	)

25 
	#MCS_CTRLPKT_ETYPE_RULE_MAX
 8

	)

26 
	#MCS_CTRLPKT_DA_RULE_MAX
 8

	)

27 
	#MCS_CTRLPKT_DA_RANGE_RULE_MAX
 4

	)

28 
	#MCS_CTRLPKT_COMBO_RULE_MAX
 4

	)

29 
	#MCS_CTRLPKT_MAC_RULE_MAX
 1

	)

31 
	#MCS_MAX_CTRLPKT_RULES
 (
MCS_CTRLPKT_ETYPE_RULE_MAX
 + \

32 
MCS_CTRLPKT_DA_RULE_MAX
 + \

33 
MCS_CTRLPKT_DA_RANGE_RULE_MAX
 + \

34 
MCS_CTRLPKT_COMBO_RULE_MAX
 + \

35 
MCS_CTRLPKT_MAC_RULE_MAX
)

	)

37 
	#MCS_CTRLPKT_ETYPE_RULE_OFFSET
 0

	)

38 
	#MCS_CTRLPKT_DA_RULE_OFFSET
 8

	)

39 
	#MCS_CTRLPKT_DA_RANGE_RULE_OFFSET
 16

	)

40 
	#MCS_CTRLPKT_COMBO_RULE_OFFSET
 20

	)

41 
	#MCS_CTRLPKT_MAC_EN_RULE_OFFSET
 24

	)

44 
	#MCS_RSRC_RSVD_CNT
 1

	)

47 
	emcs_öt_vec_e
 {

48 
	mMCS_INT_VEC_MIL_RX_GBL
 = 0x0,

49 
	mMCS_INT_VEC_MIL_RX_LMACX
 = 0x1,

50 
	mMCS_INT_VEC_MIL_TX_LMACX
 = 0x5,

51 
	mMCS_INT_VEC_HIL_RX_GBL
 = 0x9,

52 
	mMCS_INT_VEC_HIL_RX_LMACX
 = 0xa,

53 
	mMCS_INT_VEC_HIL_TX_GBL
 = 0xe,

54 
	mMCS_INT_VEC_HIL_TX_LMACX
 = 0xf,

55 
	mMCS_INT_VEC_IP
 = 0x13,

56 
	mMCS_INT_VEC_CNT
 = 0x14,

59 
	#MCS_MAX_BBE_INT
 8ULL

	)

60 
	#MCS_BBE_INT_MASK
 0xFFULL

	)

62 
	#MCS_MAX_PAB_INT
 4ULL

	)

63 
	#MCS_PAB_INT_MASK
 0xFULL

	)

65 
	#MCS_BBE_RX_INT_ENA
 
	`BIT_ULL
(0)

	)

66 
	#MCS_BBE_TX_INT_ENA
 
	`BIT_ULL
(1)

	)

67 
	#MCS_CPM_RX_INT_ENA
 
	`BIT_ULL
(2)

	)

68 
	#MCS_CPM_TX_INT_ENA
 
	`BIT_ULL
(3)

	)

69 
	#MCS_PAB_RX_INT_ENA
 
	`BIT_ULL
(4)

	)

70 
	#MCS_PAB_TX_INT_ENA
 
	`BIT_ULL
(5)

	)

72 
	#MCS_CPM_TX_INT_PACKET_XPN_EQ0
 
	`BIT_ULL
(0)

	)

73 
	#MCS_CPM_TX_INT_PN_THRESH_REACHED
 
	`BIT_ULL
(1)

	)

74 
	#MCS_CPM_TX_INT_SA_NOT_VALID
 
	`BIT_ULL
(2)

	)

76 
	#MCS_CPM_RX_INT_SECTAG_V_EQ1
 
	`BIT_ULL
(0)

	)

77 
	#MCS_CPM_RX_INT_SECTAG_E_EQ0_C_EQ1
 
	`BIT_ULL
(1)

	)

78 
	#MCS_CPM_RX_INT_SL_GTE48
 
	`BIT_ULL
(2)

	)

79 
	#MCS_CPM_RX_INT_ES_EQ1_SC_EQ1
 
	`BIT_ULL
(3)

	)

80 
	#MCS_CPM_RX_INT_SC_EQ1_SCB_EQ1
 
	`BIT_ULL
(4)

	)

81 
	#MCS_CPM_RX_INT_PACKET_XPN_EQ0
 
	`BIT_ULL
(5)

	)

82 
	#MCS_CPM_RX_INT_PN_THRESH_REACHED
 
	`BIT_ULL
(6)

	)

84 
	#MCS_CPM_RX_INT_ALL
 (
MCS_CPM_RX_INT_SECTAG_V_EQ1
 | \

85 
MCS_CPM_RX_INT_SECTAG_E_EQ0_C_EQ1
 | \

86 
MCS_CPM_RX_INT_SL_GTE48
 | \

87 
MCS_CPM_RX_INT_ES_EQ1_SC_EQ1
 | \

88 
MCS_CPM_RX_INT_SC_EQ1_SCB_EQ1
 | \

89 
MCS_CPM_RX_INT_PACKET_XPN_EQ0
 | \

90 
MCS_CPM_RX_INT_PN_THRESH_REACHED
)

	)

92 
	smcs_pfvf
 {

93 
u64
 
	möå_mask
;

96 
	smcs_öå_evít
 {

97 
u16
 
	mpcifunc
;

98 
u64
 
	möå_mask
;

99 
u64
 
	mß_id
;

100 
u8
 
	mmcs_id
;

101 
u8
 
	mlmac_id
;

104 
	smcs_öåq_íåy
 {

105 
li°_hód
 
	mnode
;

106 
mcs_öå_evít
 
	möå_evít
;

109 
	s£cy_mem_m≠
 {

110 
u8
 
	mÊow_id
;

111 
u8
 
	m£cy
;

112 
u8
 
	m˘æ_pkt
;

113 
u8
 
	msc
;

114 
u64
 
	msci
;

117 
	smcs_r§c_m≠
 {

118 
u16
 *
	mÊowid2pf_m≠
;

119 
u16
 *
	m£cy2pf_m≠
;

120 
u16
 *
	msc2pf_m≠
;

121 
u16
 *
	mß2pf_m≠
;

122 
u16
 *
	mÊowid2£cy_m≠
;

123 
u16
 *
	m˘æpkåuÀ2pf_m≠
;

124 
r§c_bm≠
 
	mÊow_ids
;

125 
r§c_bm≠
 
	m£cy
;

126 
r§c_bm≠
 
	msc
;

127 
r§c_bm≠
 
	mß
;

128 
r§c_bm≠
 
	m˘æpkåuÀ
;

131 
	shwöfo
 {

132 
u8
 
	mtˇm_íåõs
;

133 
u8
 
	m£cy_íåõs
;

134 
u8
 
	msc_íåõs
;

135 
u16
 
	mß_íåõs
;

136 
u8
 
	mmcs_x2p_ötf
;

137 
u8
 
	mlmac_˙t
;

138 
u8
 
	mmcs_blks
;

139 
	mlmac_bm≠
;

142 
	smcs
 {

143 
__iomem
 *
	mªg_ba£
;

144 
pci_dev
 *
	mpdev
;

145 
devi˚
 *
	mdev
;

146 
hwöfo
 *
	mhw
;

147 
mcs_r§c_m≠
 
	mtx
;

148 
mcs_r§c_m≠
 
	mrx
;

149 
u16
 
	mpf_m≠
[
MCS_MAX_PFS
];

150 
u8
 
	mmcs_id
;

151 
mcs_›s
 *
	mmcs_›s
;

152 
li°_hód
 
	mmcs_li°
;

154 
muãx
 
	m°©s_lock
;

155 
mcs_pfvf
 *
	mpf
;

156 
mcs_pfvf
 *
	mvf
;

157 
u16
 
	mnum_vec
;

158 *
	mrvu
;

159 
u16
 *
	mtx_ß_a˘ive
;

162 
	smcs_›s
 {

163 (*
	mmcs_£t_hw_ˇ∑bûôõs
)(
mcs
 *
	mmcs
);

164 (*
	mmcs_∑r£r_cfg
)(
mcs
 *
	mmcs
);

165 (*
	mmcs_tx_ß_mem_m≠_wrôe
)(
mcs
 *
	mmcs
, 
mcs_tx_sc_ß_m≠
 *
	mm≠
);

166 (*
	mmcs_rx_ß_mem_m≠_wrôe
)(
mcs
 *
	mmcs
, 
mcs_rx_sc_ß_m≠
 *
	mm≠
);

167 (*
	mmcs_Êowid_£cy_m≠
)(
mcs
 *
	mmcs
, 
£cy_mem_m≠
 *
	mm≠
, 
	mdú
);

170 
pci_drivî
 
mcs_drivî
;

172 
ölöe
 
	$mcs_ªg_wrôe
(
mcs
 *mcs, 
u64
 
off£t
, u64 
vÆ
)

174 
	`wrôeq
(
vÆ
, 
mcs
->
ªg_ba£
 + 
off£t
);

175 
	}
}

177 
ölöe
 
u64
 
	$mcs_ªg_ªad
(
mcs
 *mcs, 
u64
 
off£t
)

179  
	`ªadq
(
mcs
->
ªg_ba£
 + 
off£t
);

180 
	}
}

183 
mcs
 *
mcs_gë_pd©a
(
mcs_id
);

184 
mcs_gë_blk˙t
();

185 
mcs_£t_lmac_ch™√ls
(
mcs_id
, 
u16
 
ba£
);

186 
mcs_Æloc_r§c
(
r§c_bm≠
 *
r§c
, 
u16
 *
pf_m≠
, u16 
pcifunc
);

187 
mcs_‰ì_r§c
(
r§c_bm≠
 *
r§c
, 
u16
 *
pf_m≠
, 
r§c_id
, u16 
pcifunc
);

188 
mcs_Æloc_Æl_r§c
(
mcs
 *mcs, 
u8
 *
Êowid
, u8 *
£cy_id
,

189 
u8
 *
sc_id
, u8 *
ß1_id
, u8 *
ß2_id
, 
u16
 
pcifunc
, 
dú
);

190 
mcs_‰ì_Æl_r§c
(
mcs
 *mcs, 
dú
, 
u16
 
pcifunc
);

191 
mcs_˛ór_£cy_∂cy
(
mcs
 *mcs, 
£cy_id
, 
dú
);

192 
mcs_ía_dis_Êowid_íåy
(
mcs
 *mcs, 
id
, 
dú
, 
ía
);

193 
mcs_ía_dis_sc_ˇm_íåy
(
mcs
 *mcs, 
id
, 
ía
);

194 
mcs_Êowid_íåy_wrôe
(
mcs
 *mcs, 
u64
 *
d©a
, u64 *
mask
, 
id
, 
dú
);

195 
mcs_£cy_∂cy_wrôe
(
mcs
 *mcs, 
u64
 
∂cy
, 
id
, 
dú
);

196 
mcs_rx_sc_ˇm_wrôe
(
mcs
 *mcs, 
u64
 
sci
, u64 
£cy
, 
sc_id
);

197 
mcs_ß_∂cy_wrôe
(
mcs
 *mcs, 
u64
 *
∂cy
, 
ß
, 
dú
);

198 
mcs_m≠_sc_to_ß
(
mcs
 *mcs, 
u64
 *
ß_m≠
, 
sc
, 
dú
);

199 
mcs_≤_èbÀ_wrôe
(
mcs
 *mcs, 
u8
 
≤_id
, 
u64
 
√xt_≤
, u8 
dú
);

200 
mcs_tx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_tx_sc_ß_m≠
 *
m≠
);

201 
mcs_Êowid_£cy_m≠
(
mcs
 *mcs, 
£cy_mem_m≠
 *
m≠
, 
dú
);

202 
mcs_rx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_rx_sc_ß_m≠
 *
m≠
);

203 
mcs_≤_thªshﬁd_£t
(
mcs
 *mcs, 
mcs_£t_≤_thªshﬁd
 *
≤
);

204 
mcs_ö°Æl_Êowid_by∑ss_íåy
(
mcs
 *mcs);

205 
mcs_£t_lmac_mode
(
mcs
 *mcs, 
lmac_id
, 
u8
 
mode
);

206 
mcs_ª£t_p‹t
(
mcs
 *mcs, 
u8
 
p‹t_id
, u8 
ª£t
);

207 
mcs_£t_p‹t_cfg
(
mcs
 *mcs, 
mcs_p‹t_cfg_£t_ªq
 *
ªq
);

208 
mcs_gë_p‹t_cfg
(
mcs
 *mcs, 
mcs_p‹t_cfg_gë_ªq
 *
ªq
,

209 
mcs_p‹t_cfg_gë_r•
 *
r•
);

210 
mcs_gë_cu°om_èg_cfg
(
mcs
 *mcs, 
mcs_cu°om_èg_cfg_gë_ªq
 *
ªq
,

211 
mcs_cu°om_èg_cfg_gë_r•
 *
r•
);

212 
mcs_Æloc_˘æpkåuÀ
(
r§c_bm≠
 *
r§c
, 
u16
 *
pf_m≠
, u16 
off£t
, u16 
pcifunc
);

213 
mcs_‰ì_˘æpkåuÀ
(
mcs
 *mcs, 
mcs_‰ì_˘æ_pkt_ruÀ_ªq
 *
ªq
);

214 
mcs_˘æpkåuÀ_wrôe
(
mcs
 *mcs, 
mcs_˘æ_pkt_ruÀ_wrôe_ªq
 *
ªq
);

217 
˙10kb_mcs_£t_hw_ˇ∑bûôõs
(
mcs
 *mcs);

218 
˙10kb_mcs_tx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_tx_sc_ß_m≠
 *
m≠
);

219 
˙10kb_mcs_Êowid_£cy_m≠
(
mcs
 *mcs, 
£cy_mem_m≠
 *
m≠
, 
dú
);

220 
˙10kb_mcs_rx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_rx_sc_ß_m≠
 *
m≠
);

221 
˙10kb_mcs_∑r£r_cfg
(
mcs
 *mcs);

224 
mcs_›s
 *
˙f10kb_gë_mac_›s
();

225 
˙f10kb_mcs_£t_hw_ˇ∑bûôõs
(
mcs
 *mcs);

226 
˙f10kb_mcs_tx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_tx_sc_ß_m≠
 *
m≠
);

227 
˙f10kb_mcs_Êowid_£cy_m≠
(
mcs
 *mcs, 
£cy_mem_m≠
 *
m≠
, 
dú
);

228 
˙f10kb_mcs_rx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_rx_sc_ß_m≠
 *
m≠
);

229 
˙f10kb_mcs_∑r£r_cfg
(
mcs
 *mcs);

230 
˙f10kb_mcs_tx_≤_thªsh_ªached_h™dÀr
(
mcs
 *mcs);

231 
˙f10kb_mcs_tx_≤_wøµed_h™dÀr
(
mcs
 *mcs);

234 
mcs_gë_sc_°©s
(
mcs
 *mcs, 
mcs_sc_°©s
 *
°©s
, 
id
, 
dú
);

235 
mcs_gë_ß_°©s
(
mcs
 *mcs, 
mcs_ß_°©s
 *
°©s
, 
id
, 
dú
);

236 
mcs_gë_p‹t_°©s
(
mcs
 *mcs, 
mcs_p‹t_°©s
 *
°©s
, 
id
, 
dú
);

237 
mcs_gë_Êowid_°©s
(
mcs
 *mcs, 
mcs_Êowid_°©s
 *
°©s
, 
id
, 
dú
);

238 
mcs_gë_rx_£cy_°©s
(
mcs
 *mcs, 
mcs_£cy_°©s
 *
°©s
, 
id
);

239 
mcs_gë_tx_£cy_°©s
(
mcs
 *mcs, 
mcs_£cy_°©s
 *
°©s
, 
id
);

240 
mcs_˛ór_°©s
(
mcs
 *mcs, 
u8
 
ty≥
, u8 
id
, 
dú
);

241 
mcs_˛ór_Æl_°©s
(
mcs
 *mcs, 
u16
 
pcifunc
, 
dú
);

242 
mcs_£t_f‹˚_˛k_í
(
mcs
 *mcs, 
boﬁ
 
£t
);

244 
mcs_add_öå_wq_íåy
(
mcs
 *mcs, 
mcs_öå_evít
 *
evít
);

	@mcs_cnf10kb.c

7 
	~"mcs.h
"

8 
	~"mcs_ªg.h
"

10 
mcs_›s
 
	g˙f10kb_mcs_›s
 = {

11 .
mcs_£t_hw_ˇ∑bûôõs
 = 
˙f10kb_mcs_£t_hw_ˇ∑bûôõs
,

12 .
	gmcs_∑r£r_cfg
 = 
˙f10kb_mcs_∑r£r_cfg
,

13 .
	gmcs_tx_ß_mem_m≠_wrôe
 = 
˙f10kb_mcs_tx_ß_mem_m≠_wrôe
,

14 .
	gmcs_rx_ß_mem_m≠_wrôe
 = 
˙f10kb_mcs_rx_ß_mem_m≠_wrôe
,

15 .
	gmcs_Êowid_£cy_m≠
 = 
˙f10kb_mcs_Êowid_£cy_m≠
,

18 
mcs_›s
 *
	$˙f10kb_gë_mac_›s
()

20  &
˙f10kb_mcs_›s
;

21 
	}
}

23 
	$˙f10kb_mcs_£t_hw_ˇ∑bûôõs
(
mcs
 *mcs)

25 
hwöfo
 *
hw
 = 
mcs
->hw;

27 
hw
->
tˇm_íåõs
 = 64;

28 
hw
->
£cy_íåõs
 = 64;

29 
hw
->
sc_íåõs
 = 64;

30 
hw
->
ß_íåõs
 = 128;

31 
hw
->
lmac_˙t
 = 4;

32 
hw
->
mcs_x2p_ötf
 = 1;

33 
hw
->
mcs_blks
 = 7;

34 
	}
}

36 
	$˙f10kb_mcs_∑r£r_cfg
(
mcs
 *mcs)

38 
u64
 
ªg
, 
vÆ
;

41 
vÆ
 = (0x8100uŒ & 0xFFFFË| 
	`BIT_ULL
(20) | BIT_ULL(22);

43 
ªg
 = 
	`MCSX_PEX_RX_SLAVE_CUSTOM_TAGX
(0);

44 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

46 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_CUSTOM_TAGX
(0);

47 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

50 
vÆ
 = (0x88a8uŒ & 0xFFFFË| 
	`BIT_ULL
(20) | BIT_ULL(23);

53 
ªg
 = 
	`MCSX_PEX_RX_SLAVE_CUSTOM_TAGX
(1);

54 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

57 
ªg
 = 
	`MCSX_PEX_TX_SLAVE_CUSTOM_TAGX
(1);

58 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

61 
vÆ
 = 
	`BIT_ULL
(0) | BIT_ULL(1) | BIT_ULL(12);

63 
ªg
 = 
MCSX_PEX_RX_SLAVE_ETYPE_ENABLE
;

64 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

66 
ªg
 = 
MCSX_PEX_TX_SLAVE_ETYPE_ENABLE
;

67 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

68 
	}
}

70 
	$˙f10kb_mcs_Êowid_£cy_m≠
(
mcs
 *mcs, 
£cy_mem_m≠
 *
m≠
, 
dú
)

72 
u64
 
ªg
, 
vÆ
;

74 
vÆ
 = (
m≠
->
£cy
 & 0x3FË| (m≠->
˘æ_pkt
 & 0x1) << 6;

75 i‡(
dú
 =
MCS_RX
) {

76 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_SECY_MAP_MEMX
(
m≠
->
Êow_id
);

78 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_SECY_MAP_MEM_0X
(
m≠
->
Êow_id
);

79 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
m≠
->
sci
);

80 
vÆ
 |(
m≠
->
sc
 & 0x3F) << 7;

81 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_SECY_MAP_MEM_1X
(
m≠
->
Êow_id
);

84 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

85 
	}
}

87 
	$˙f10kb_mcs_tx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_tx_sc_ß_m≠
 *
m≠
)

89 
u64
 
ªg
, 
vÆ
;

91 
vÆ
 = (
m≠
->
ß_ödex0
 & 0x7FË| (m≠->
ß_ödex1
 & 0x7F) << 7;

93 
ªg
 = 
	`MCSX_CPM_TX_SLAVE_SA_MAP_MEM_0X
(
m≠
->
sc_id
);

94 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

96 
ªg
 = 
MCSX_CPM_TX_SLAVE_AUTO_REKEY_ENABLE_0
;

97 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
ªg
);

99 i‡(
m≠
->
ªkey_ía
)

100 
vÆ
 |
	`BIT_ULL
(
m≠
->
sc_id
);

102 
vÆ
 &~
	`BIT_ULL
(
m≠
->
sc_id
);

104 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

106 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_CPM_TX_SLAVE_SA_INDEX0_VLDX
(
m≠
->
sc_id
), m≠->
ß_ödex0_vld
);

107 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_CPM_TX_SLAVE_SA_INDEX1_VLDX
(
m≠
->
sc_id
), m≠->
ß_ödex1_vld
);

109 
	`mcs_ªg_wrôe
(
mcs
, 
	`MCSX_CPM_TX_SLAVE_TX_SA_ACTIVEX
(
m≠
->
sc_id
), m≠->
tx_ß_a˘ive
);

110 
	}
}

112 
	$˙f10kb_mcs_rx_ß_mem_m≠_wrôe
(
mcs
 *mcs, 
mcs_rx_sc_ß_m≠
 *
m≠
)

114 
u64
 
vÆ
, 
ªg
;

116 
vÆ
 = (
m≠
->
ß_ödex
 & 0x7FË| (m≠->
ß_ö_u£
 << 7);

118 
ªg
 = 
	`MCSX_CPM_RX_SLAVE_SA_MAP_MEMX
((4 * 
m≠
->
sc_id
Ë+ m≠->
™
);

119 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
vÆ
);

120 
	}
}

122 
	$mcs_£t_f‹˚_˛k_í
(
mcs
 *mcs, 
boﬁ
 
£t
)

124 
timeout
 = 
jiffõs
 + 
	`u£cs_to_jiffõs
(2000);

125 
u64
 
vÆ
;

127 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_MIL_GLOBAL
);

129 i‡(
£t
) {

130 
vÆ
 |
	`BIT_ULL
(4);

131 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_MIL_GLOBAL
, 
vÆ
);

134 !(
	`mcs_ªg_ªad
(
mcs
, 
MCSX_MIL_IP_GBL_STATUS
Ë& 
	`BIT_ULL
(0))) {

135 i‡(
	`time_a·î
(
jiffõs
, 
timeout
)) {

136 
	`dev_îr
(
mcs
->
dev
, "MCS set force clkÉnable failed\n");

141 
vÆ
 &~
	`BIT_ULL
(4);

142 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_MIL_GLOBAL
, 
vÆ
);

146 
	}
}

153 
	$˙f10kb_mcs_tx_≤_thªsh_ªached_h™dÀr
(
mcs
 *mcs)

155 
mcs_öå_evít
 
evít
;

156 
r§c_bm≠
 *
sc_bm≠
;

157 
ªkey_ía
;

158 
u64
 
vÆ
, 
ß_°©us
;

159 
sc
;

161 
sc_bm≠
 = &
mcs
->
tx
.
sc
;

163 
evít
.
mcs_id
 = 
mcs
->mcs_id;

164 
evít
.
öå_mask
 = 
MCS_CPM_TX_PN_THRESH_REACHED_INT
;

166 
ªkey_ía
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_CPM_TX_SLAVE_AUTO_REKEY_ENABLE_0
);

168 
	`f‹_óch_£t_bô
(
sc
, 
sc_bm≠
->
bm≠
, 
mcs
->
hw
->
sc_íåõs
) {

170 i‡(!
	`ã°_bô
(
sc
, &
ªkey_ía
))

172 
ß_°©us
 = 
	`mcs_ªg_ªad
(
mcs
, 
	`MCSX_CPM_TX_SLAVE_TX_SA_ACTIVEX
(
sc
));

174 i‡(
ß_°©us
 =
mcs
->
tx_ß_a˘ive
[
sc
])

178 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
	`MCSX_CPM_TX_SLAVE_SA_MAP_MEM_0X
(
sc
));

179 i‡(
ß_°©us
)

180 
evít
.
ß_id
 = 
vÆ
 & 0x7F;

182 
evít
.
ß_id
 = (
vÆ
 >> 7) & 0x7F;

184 
evít
.
pcifunc
 = 
mcs
->
tx
.
ß2pf_m≠
[evít.
ß_id
];

185 
	`mcs_add_öå_wq_íåy
(
mcs
, &
evít
);

187 
	}
}

189 
	$˙f10kb_mcs_tx_≤_wøµed_h™dÀr
(
mcs
 *mcs)

191 
mcs_öå_evít
 
evít
 = { 0 };

192 
r§c_bm≠
 *
sc_bm≠
;

193 
u64
 
vÆ
;

194 
sc
;

196 
sc_bm≠
 = &
mcs
->
tx
.
sc
;

198 
evít
.
mcs_id
 = 
mcs
->mcs_id;

199 
evít
.
öå_mask
 = 
MCS_CPM_TX_PACKET_XPN_EQ0_INT
;

201 
	`f‹_óch_£t_bô
(
sc
, 
sc_bm≠
->
bm≠
, 
mcs
->
hw
->
sc_íåõs
) {

202 
vÆ
 = 
	`mcs_ªg_ªad
(
mcs
, 
	`MCSX_CPM_TX_SLAVE_SA_MAP_MEM_0X
(
sc
));

204 i‡(
mcs
->
tx_ß_a˘ive
[
sc
])

206 
evít
.
ß_id
 = (
vÆ
 >> 7) & 0x7F;

209 
evít
.
ß_id
 = 
vÆ
 & 0x7F;

211 
evít
.
pcifunc
 = 
mcs
->
tx
.
ß2pf_m≠
[evít.
ß_id
];

212 
	`mcs_add_öå_wq_íåy
(
mcs
, &
evít
);

214 
	}
}

	@mcs_fips.c

8 
	~"mcs.h
"

9 
	~"mcs_fùs_ªg.h
"

11 
	#MCS_AES_GCM_256_KEYLEN
 32

	)

13 
	emcs_fùs_af_°©us
 {

14 
	mMCS_AF_ERR_TIMEOUT
 = -1203,

17 
	$mcs_fùs_ª£t
(
mcs
 *mcs, 
mcs_fùs_ªq
 *
ªq
)

19 
timeout
 = 
jiffõs
 + 
	`u£cs_to_jiffõs
(2000);

20 
ªt
 = 0;

21 
u64
 
ªg
;

23 i‡(
ªq
->
dú
 =
MCS_RX
)

24 
ªg
 = 
MCSX_GAE_RX_SLAVE_FIPS_RESET
;

26 
ªg
 = 
MCSX_GAE_TX_SLAVE_FIPS_RESET
;

28 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
	`BIT_ULL
(0));

30 
	`mcs_ªg_ªad
(
mcs
, 
ªg
Ë& 
	`BIT_ULL
(0)) {

31 i‡(
	`time_a·î
(
jiffõs
, 
timeout
)) {

32 
	`dev_îr
(
mcs
->
dev
, "MCS fipsÑeset failed\n");

33 
ªt
 = 
MCS_AF_ERR_TIMEOUT
;

38  
ªt
;

39 
	}
}

41 
	$mcs_fùs_°¨t
(
mcs
 *mcs, 
mcs_fùs_ªq
 *
ªq
)

43 
timeout
 = 
jiffõs
 + 
	`u£cs_to_jiffõs
(2000);

44 
ªt
 = 0;

45 
u64
 
ªg
;

47 i‡(
ªq
->
dú
 =
MCS_RX
)

48 
ªg
 = 
MCSX_GAE_RX_SLAVE_FIPS_START
;

50 
ªg
 = 
MCSX_GAE_TX_SLAVE_FIPS_START
;

52 
	`mcs_ªg_wrôe
(
mcs
, 
ªg
, 
	`BIT_ULL
(0));

54 
	`mcs_ªg_ªad
(
mcs
, 
ªg
Ë& 
	`BIT_ULL
(0)) {

55 i‡(
	`time_a·î
(
jiffõs
, 
timeout
)) {

56 
	`dev_îr
(
mcs
->
dev
, "MCS fips start failed\n");

57 
ªt
 = 
MCS_AF_ERR_TIMEOUT
;

62  
ªt
;

63 
	}
}

65 
	$rvu_mbox_h™dÀr_mcs_fùs_ª£t
(
rvu
 *rvu,

66 
mcs_fùs_ªq
 *
ªq
,

67 
msg_r•
 *
r•
)

69 
mcs
 *mcs;

71 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

72  
MCS_AF_ERR_INVALID_MCSID
;

74 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

76  
	`mcs_fùs_ª£t
(
mcs
, 
ªq
);

77 
	}
}

79 
	$rvu_mbox_h™dÀr_mcs_fùs_mode_£t
(
rvu
 *rvu,

80 
mcs_fùs_mode_ªq
 *
ªq
,

81 
msg_r•
 *
r•
)

83 
mcs
 *mcs;

85 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

86  
MCS_AF_ERR_INVALID_MCSID
;

88 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

90 i‡(
ªq
->
dú
 =
MCS_RX
)

91 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_MODE
, 
ªq
->
mode
);

93 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_MODE
, 
ªq
->
mode
);

96 
	}
}

98 
	$rvu_mbox_h™dÀr_mcs_fùs_˘l_£t
(
rvu
 *rvu,

99 
mcs_fùs_˘l_ªq
 *
ªq
,

100 
msg_r•
 *
r•
)

102 
mcs
 *mcs;

104 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

105  
MCS_AF_ERR_INVALID_MCSID
;

107 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

109 i‡(
ªq
->
dú
 =
MCS_RX
)

110 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_CTL
, 
ªq
->
˘l
);

112 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_CTL
, 
ªq
->
˘l
);

115 
	}
}

117 
	$rvu_mbox_h™dÀr_mcs_fùs_iv_£t
(
rvu
 *rvu, 
mcs_fùs_iv_ªq
 *
ªq
,

118 
msg_r•
 *
r•
)

120 
mcs
 *mcs;

122 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

123  
MCS_AF_ERR_INVALID_MCSID
;

125 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

127 i‡(
ªq
->
dú
 =
MCS_RX
) {

128 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_IV_BITS95_64
, 
ªq
->
iv_bôs95_64
);

129 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_IV_BITS63_0
, 
ªq
->
iv_bôs63_0
);

131 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_IV_BITS95_64
, 
ªq
->
iv_bôs95_64
);

132 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_IV_BITS63_0
, 
ªq
->
iv_bôs63_0
);

136 
	}
}

138 
	$rvu_mbox_h™dÀr_mcs_fùs_˘r_£t
(
rvu
 *rvu, 
mcs_fùs_˘r_ªq
 *
ªq
,

139 
msg_r•
 *
r•
)

141 
mcs
 *mcs;

143 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

144  
MCS_AF_ERR_INVALID_MCSID
;

146 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

148 i‡(
ªq
->
dú
 =
MCS_RX
)

149 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_CTR
, 
ªq
->
fùs_˘r
);

151 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_CTR
, 
ªq
->
fùs_˘r
);

154 
	}
}

156 
	$rvu_mbox_h™dÀr_mcs_fùs_key_£t
(
rvu
 *rvu, 
mcs_fùs_key_ªq
 *
ªq
,

157 
msg_r•
 *
r•
)

159 
mcs
 *mcs;

161 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

162  
MCS_AF_ERR_INVALID_MCSID
;

164 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

166 i‡(
ªq
->
dú
 =
MCS_RX
) {

167 i‡(
ªq
->
ßk_Àn
 =
MCS_AES_GCM_256_KEYLEN
) {

168 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_SAK_BITS255_192
,

169 
ªq
->
ßk_bôs255_192
);

170 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_SAK_BITS191_128
,

171 
ªq
->
ßk_bôs191_128
);

173 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_SAK_BITS127_64
,

174 
ªq
->
ßk_bôs127_64
);

175 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_SAK_BITS63_0
, 
ªq
->
ßk_bôs63_0
);

176 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_HASHKEY_BITS127_64
,

177 
ªq
->
hashkey_bôs127_64
);

178 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_HASHKEY_BITS63_0
,

179 
ªq
->
hashkey_bôs63_0
);

181 i‡(
ªq
->
ßk_Àn
 =
MCS_AES_GCM_256_KEYLEN
) {

182 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_SAK_BITS255_192
,

183 
ªq
->
ßk_bôs255_192
);

184 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_SAK_BITS191_128
,

185 
ªq
->
ßk_bôs191_128
);

187 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_SAK_BITS127_64
,

188 
ªq
->
ßk_bôs127_64
);

189 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_SAK_BITS63_0
, 
ªq
->
ßk_bôs63_0
);

190 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_HASHKEY_BITS127_64
,

191 
ªq
->
hashkey_bôs127_64
);

192 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_HASHKEY_BITS63_0
,

193 
ªq
->
hashkey_bôs63_0
);

197 
	}
}

199 
	$rvu_mbox_h™dÀr_mcs_fùs_block_£t
(
rvu
 *rvu, 
mcs_fùs_block_ªq
 *
ªq
,

200 
msg_r•
 *
r•
)

202 
mcs
 *mcs;

204 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

205  
MCS_AF_ERR_INVALID_MCSID
;

207 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

209 i‡(
ªq
->
dú
 =
MCS_RX
) {

210 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

211 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_BLOCK_BITS127_64
,

212 
ªq
->
blk_bôs127_64
);

214 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_BLOCK_BITS63_0
, 
ªq
->
blk_bôs63_0
);

216 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

217 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_BLOCK_BITS127_64
,

218 
ªq
->
blk_bôs127_64
);

220 
	`mcs_ªg_wrôe
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_BLOCK_BITS63_0
, 
ªq
->
blk_bôs63_0
);

224 
	}
}

226 
	$rvu_mbox_h™dÀr_mcs_fùs_°¨t
(
rvu
 *rvu, 
mcs_fùs_ªq
 *
ªq
,

227 
msg_r•
 *
r•
)

229 
mcs
 *mcs;

231 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

232  
MCS_AF_ERR_INVALID_MCSID
;

234 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

236  
	`mcs_fùs_°¨t
(
mcs
, 
ªq
);

237 
	}
}

239 
	$rvu_mbox_h™dÀr_mcs_fùs_ªsu…_gë
(
rvu
 *rvu, 
mcs_fùs_ªq
 *
ªq
,

240 
mcs_fùs_ªsu…_r•
 *
r•
)

242 
mcs
 *mcs;

244 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

245  
MCS_AF_ERR_INVALID_MCSID
;

247 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

249 i‡(
ªq
->
dú
 =
MCS_RX
) {

250 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

251 
r•
->
blk_bôs127_64
 =

252 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_RESULT_BLOCK_BITS127_64
);

254 
r•
->
blk_bôs63_0
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_RESULT_BLOCK_BITS63_0
);

255 
r•
->
icv_bôs63_0
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_RESULT_ICV_BITS63_0
);

256 
r•
->
icv_bôs127_64
 = 
	`mcs_ªg_ªad
(
mcs
,

257 
MCSX_GAE_RX_SLAVE_FIPS_RESULT_ICV_BITS127_64
);

258 
r•
->
ªsu…_∑ss
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_GAE_RX_SLAVE_FIPS_RESULT_PASS
);

260 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

261 
r•
->
blk_bôs127_64
 =

262 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_RESULT_BLOCK_BITS127_64
);

264 
r•
->
blk_bôs63_0
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_RESULT_BLOCK_BITS63_0
);

265 
r•
->
icv_bôs63_0
 = 
	`mcs_ªg_ªad
(
mcs
, 
MCSX_GAE_TX_SLAVE_FIPS_RESULT_ICV_BITS63_0
);

266 
r•
->
icv_bôs127_64
 = 
	`mcs_ªg_ªad
(
mcs
,

267 
MCSX_GAE_TX_SLAVE_FIPS_RESULT_ICV_BITS127_64
);

271 
	}
}

	@mcs_fips_mbox.h

8 
	~"mbox.h
"

10 
	#MBOX_MCS_FIPS_MESSAGES
 \

11 
	`M
(
MCS_FIPS_RESET
, 0xa040, 
mcs_fùs_ª£t
, 
mcs_fùs_ªq
, 
msg_r•
) \

12 
	`M
(
MCS_FIPS_MODE_SET
, 0xa041, 
mcs_fùs_mode_£t
, 
mcs_fùs_mode_ªq
, 
msg_r•
) \

13 
	`M
(
MCS_FIPS_CTL_SET
, 0xa042, 
mcs_fùs_˘l_£t
, 
mcs_fùs_˘l_ªq
, 
msg_r•
) \

14 
	`M
(
MCS_FIPS_IV_SET
, 0xa043, 
mcs_fùs_iv_£t
, 
mcs_fùs_iv_ªq
, 
msg_r•
) \

15 
	`M
(
MCS_FIPS_CTR_SET
, 0xa044, 
mcs_fùs_˘r_£t
, 
mcs_fùs_˘r_ªq
, 
msg_r•
) \

16 
	`M
(
MCS_FIPS_KEY_SET
, 0xa045, 
mcs_fùs_key_£t
, 
mcs_fùs_key_ªq
, 
msg_r•
) \

17 
	`M
(
MCS_FIPS_BLOCK_SET
, 0xa046, 
mcs_fùs_block_£t
, 
mcs_fùs_block_ªq
, \

18 
msg_r•
) \

19 
	`M
(
MCS_FIPS_START
, 0xa047, 
mcs_fùs_°¨t
, 
mcs_fùs_ªq
, 
msg_r•
) \

20 
	`M
(
MCS_FIPS_RESULT_GET
, 0xa048, 
mcs_fùs_ªsu…_gë
, 
mcs_fùs_ªq
, \

21 
mcs_fùs_ªsu…_r•
) \

22 

	)

23 
	smcs_fùs_ªq
 {

24 
mbox_msghdr
 
	mhdr
;

25 
u8
 
	mmcs_id
;

26 
u8
 
	mdú
;

29 
	smcs_fùs_mode_ªq
 {

30 
mbox_msghdr
 
	mhdr
;

31 
u64
 
	mmode
;

32 
u8
 
	mmcs_id
;

33 
u8
 
	mdú
;

36 
	smcs_fùs_˘l_ªq
 {

37 
mbox_msghdr
 
	mhdr
;

38 
u64
 
	m˘l
;

39 
u8
 
	mmcs_id
;

40 
u8
 
	mdú
;

43 
	smcs_fùs_iv_ªq
 {

44 
mbox_msghdr
 
	mhdr
;

45 
u32
 
	miv_bôs95_64
;

46 
u64
 
	miv_bôs63_0
;

47 
u8
 
	mmcs_id
;

48 
u8
 
	mdú
;

51 
	smcs_fùs_˘r_ªq
 {

52 
mbox_msghdr
 
	mhdr
;

53 
u32
 
	mfùs_˘r
;

54 
u8
 
	mmcs_id
;

55 
u8
 
	mdú
;

58 
	smcs_fùs_key_ªq
 {

59 
mbox_msghdr
 
	mhdr
;

60 
u64
 
	mßk_bôs255_192
;

61 
u64
 
	mßk_bôs191_128
;

62 
u64
 
	mßk_bôs127_64
;

63 
u64
 
	mßk_bôs63_0
;

64 
u64
 
	mhashkey_bôs127_64
;

65 
u64
 
	mhashkey_bôs63_0
;

66 
u8
 
	mßk_Àn
;

67 
u8
 
	mmcs_id
;

68 
u8
 
	mdú
;

71 
	smcs_fùs_block_ªq
 {

72 
mbox_msghdr
 
	mhdr
;

73 
u64
 
	mblk_bôs127_64
;

74 
u64
 
	mblk_bôs63_0
;

75 
u8
 
	mmcs_id
;

76 
u8
 
	mdú
;

79 
	smcs_fùs_ªsu…_r•
 {

80 
mbox_msghdr
 
	mhdr
;

81 
u64
 
	mblk_bôs127_64
;

82 
u64
 
	mblk_bôs63_0
;

83 
u64
 
	micv_bôs127_64
;

84 
u64
 
	micv_bôs63_0
;

85 
u8
 
	mªsu…_∑ss
;

	@mcs_fips_reg.h

8 
	#MCSX_GAE_RX_SLAVE_FIPS_RESET
 ({ \

9 
u64
 
off£t
; \

11 
off£t
 = 0x18ull; \

12 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

13 
off£t
 = 0x0ull; \

14 
off£t
; })

	)

16 
	#MCSX_GAE_TX_SLAVE_FIPS_RESET
 ({ \

17 
u64
 
off£t
; \

19 
off£t
 = 0x218ull; \

20 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

21 
off£t
 = 0xB0ull; \

22 
off£t
; })

	)

24 
	#MCSX_GAE_RX_SLAVE_FIPS_MODE
 ({ \

25 
u64
 
off£t
; \

27 
off£t
 = 0x28ull; \

28 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

29 
off£t
 = 0x8ull; \

30 
off£t
; })

	)

32 
	#MCSX_GAE_TX_SLAVE_FIPS_MODE
 ({ \

33 
u64
 
off£t
; \

35 
off£t
 = 0x228ull; \

36 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

37 
off£t
 = 0xB8ull; \

38 
off£t
; })

	)

40 
	#MCSX_GAE_RX_SLAVE_FIPS_CTL
 ({ \

41 
u64
 
off£t
; \

43 
off£t
 = 0x30ull; \

44 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

45 
off£t
 = 0x10ull; \

46 
off£t
; })

	)

48 
	#MCSX_GAE_TX_SLAVE_FIPS_CTL
 ({ \

49 
u64
 
off£t
; \

51 
off£t
 = 0x230ull; \

52 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

53 
off£t
 = 0xC0ull; \

54 
off£t
; })

	)

56 
	#MCSX_GAE_RX_SLAVE_FIPS_IV_BITS95_64
 ({ \

57 
u64
 
off£t
; \

59 
off£t
 = 0x40ull; \

60 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

61 
off£t
 = 0x18ull; \

62 
off£t
; })

	)

64 
	#MCSX_GAE_RX_SLAVE_FIPS_IV_BITS63_0
 ({ \

65 
u64
 
off£t
; \

67 
off£t
 = 0x48ull; \

68 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

69 
off£t
 = 0x20ull; \

70 
off£t
; })

	)

72 
	#MCSX_GAE_TX_SLAVE_FIPS_IV_BITS95_64
 ({ \

73 
u64
 
off£t
; \

75 
off£t
 = 0x240ull; \

76 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

77 
off£t
 = 0xC8ull; \

78 
off£t
; })

	)

80 
	#MCSX_GAE_TX_SLAVE_FIPS_IV_BITS63_0
 ({ \

81 
u64
 
off£t
; \

83 
off£t
 = 0x248ull; \

84 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

85 
off£t
 = 0xD0ull; \

86 
off£t
; })

	)

88 
	#MCSX_GAE_RX_SLAVE_FIPS_CTR
 ({ \

89 
u64
 
off£t
; \

91 
off£t
 = 0x50ull; \

92 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

93 
off£t
 = 0x28ull; \

94 
off£t
; })

	)

96 
	#MCSX_GAE_TX_SLAVE_FIPS_CTR
 ({ \

97 
u64
 
off£t
; \

99 
off£t
 = 0x250ull; \

100 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

101 
off£t
 = 0xD8ull; \

102 
off£t
; })

	)

104 
	#MCSX_GAE_RX_SLAVE_FIPS_SAK_BITS255_192
 ({ \

105 
u64
 
off£t
; \

107 
off£t
 = 0x58ull; \

108 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

109 
off£t
 = 0x30ull; \

110 
off£t
; })

	)

112 
	#MCSX_GAE_RX_SLAVE_FIPS_SAK_BITS191_128
 ({ \

113 
u64
 
off£t
; \

115 
off£t
 = 0x60ull; \

116 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

117 
off£t
 = 0x38ull; \

118 
off£t
; })

	)

120 
	#MCSX_GAE_RX_SLAVE_FIPS_SAK_BITS127_64
 ({ \

121 
u64
 
off£t
; \

123 
off£t
 = 0x68ull; \

124 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

125 
off£t
 = 0x40ull; \

126 
off£t
; })

	)

128 
	#MCSX_GAE_RX_SLAVE_FIPS_SAK_BITS63_0
 ({ \

129 
u64
 
off£t
; \

131 
off£t
 = 0x70ull; \

132 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

133 
off£t
 = 0x48ull; \

134 
off£t
; })

	)

136 
	#MCSX_GAE_TX_SLAVE_FIPS_SAK_BITS255_192
 ({ \

137 
u64
 
off£t
; \

139 
off£t
 = 0x258ull; \

140 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

141 
off£t
 = 0xE0ull; \

142 
off£t
; })

	)

144 
	#MCSX_GAE_TX_SLAVE_FIPS_SAK_BITS191_128
 ({ \

145 
u64
 
off£t
; \

147 
off£t
 = 0x260ull; \

148 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

149 
off£t
 = 0xE8ull; \

150 
off£t
; })

	)

152 
	#MCSX_GAE_TX_SLAVE_FIPS_SAK_BITS127_64
 ({ \

153 
u64
 
off£t
; \

155 
off£t
 = 0x268ull; \

156 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

157 
off£t
 = 0xF0ull; \

158 
off£t
; })

	)

160 
	#MCSX_GAE_TX_SLAVE_FIPS_SAK_BITS63_0
 ({ \

161 
u64
 
off£t
; \

163 
off£t
 = 0x270ull; \

164 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

165 
off£t
 = 0xF8ull; \

166 
off£t
; })

	)

168 
	#MCSX_GAE_RX_SLAVE_FIPS_HASHKEY_BITS127_64
 ({ \

169 
u64
 
off£t
; \

171 
off£t
 = 0x78ull; \

172 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

173 
off£t
 = 0x50ull; \

174 
off£t
; })

	)

176 
	#MCSX_GAE_RX_SLAVE_FIPS_HASHKEY_BITS63_0
 ({ \

177 
u64
 
off£t
; \

179 
off£t
 = 0x80ull; \

180 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

181 
off£t
 = 0x58ull; \

182 
off£t
; })

	)

184 
	#MCSX_GAE_TX_SLAVE_FIPS_HASHKEY_BITS127_64
 ({ \

185 
u64
 
off£t
; \

187 
off£t
 = 0x278ull; \

188 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

189 
off£t
 = 0x100ull; \

190 
off£t
; })

	)

192 
	#MCSX_GAE_TX_SLAVE_FIPS_HASHKEY_BITS63_0
 ({ \

193 
u64
 
off£t
; \

195 
off£t
 = 0x280ull; \

196 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

197 
off£t
 = 0x108ull; \

198 
off£t
; })

	)

200 
	#MCSX_GAE_RX_SLAVE_FIPS_BLOCK_BITS127_64
 ({ \

201 
u64
 
off£t
; \

203 
off£t
 = 0x60ull; \

204 
off£t
; })

	)

206 
	#MCSX_GAE_RX_SLAVE_FIPS_BLOCK_BITS63_0
 ({ \

207 
u64
 
off£t
; \

209 
off£t
 = 0x88ull; \

210 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

211 
off£t
 = 0x68ull; \

212 
off£t
; })

	)

214 
	#MCSX_GAE_TX_SLAVE_FIPS_BLOCK_BITS127_64
 ({ \

215 
u64
 
off£t
; \

217 
off£t
 = 0x110ull; \

218 
off£t
; })

	)

220 
	#MCSX_GAE_TX_SLAVE_FIPS_BLOCK_BITS63_0
 ({ \

221 
u64
 
off£t
; \

223 
off£t
 = 0x288ull; \

224 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

225 
off£t
 = 0x118ull; \

226 
off£t
; })

	)

228 
	#MCSX_GAE_RX_SLAVE_FIPS_START
 ({ \

229 
u64
 
off£t
; \

231 
off£t
 = 0x20ull; \

232 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

233 
off£t
 = 0x70ull; \

234 
off£t
; })

	)

236 
	#MCSX_GAE_TX_SLAVE_FIPS_START
 ({ \

237 
u64
 
off£t
; \

239 
off£t
 = 0x220ull; \

240 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

241 
off£t
 = 0x120ull; \

242 
off£t
; })

	)

244 
	#MCSX_GAE_RX_SLAVE_FIPS_RESULT_BLOCK_BITS127_64
 ({ \

245 
u64
 
off£t
; \

247 
off£t
 = 0x78ull; \

248 
off£t
; })

	)

250 
	#MCSX_GAE_RX_SLAVE_FIPS_RESULT_BLOCK_BITS63_0
 ({ \

251 
u64
 
off£t
; \

253 
off£t
 = 0xA0ull; \

254 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

255 
off£t
 = 0x80ull; \

256 
off£t
; })

	)

258 
	#MCSX_GAE_RX_SLAVE_FIPS_RESULT_PASS
 ({ \

259 
u64
 
off£t
; \

261 
off£t
 = 0xA8ull; \

262 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

263 
off£t
 = 0x88ull; \

264 
off£t
; })

	)

266 
	#MCSX_GAE_RX_SLAVE_FIPS_RESULT_ICV_BITS127_64
 ({ \

267 
u64
 
off£t
; \

269 
off£t
 = 0xB0ull; \

270 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

271 
off£t
 = 0x90ull; \

272 
off£t
; })

	)

274 
	#MCSX_GAE_RX_SLAVE_FIPS_RESULT_ICV_BITS63_0
 ({ \

275 
u64
 
off£t
; \

277 
off£t
 = 0xB8ull; \

278 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

279 
off£t
 = 0x98ull; \

280 
off£t
; })

	)

282 
	#MCSX_GAE_TX_SLAVE_FIPS_RESULT_BLOCK_BITS127_64
 ({ \

283 
u64
 
off£t
; \

285 
off£t
 = 0x128ull; \

286 
off£t
; })

	)

288 
	#MCSX_GAE_TX_SLAVE_FIPS_RESULT_BLOCK_BITS63_0
 ({ \

289 
u64
 
off£t
; \

291 
off£t
 = 0x2A0ull; \

292 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

293 
off£t
 = 0x130ull; \

294 
off£t
; })

	)

296 
	#MCSX_GAE_TX_SLAVE_FIPS_RESULT_ICV_BITS127_64
 ({ \

297 
u64
 
off£t
; \

299 
off£t
 = 0x2B0ull; \

300 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

301 
off£t
 = 0x140ull; \

302 
off£t
; })

	)

304 
	#MCSX_GAE_TX_SLAVE_FIPS_RESULT_ICV_BITS63_0
 ({ \

305 
u64
 
off£t
; \

307 
off£t
 = 0x2B8ull; \

308 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

309 
off£t
 = 0x148ull; \

310 
off£t
; })

	)

	@mcs_reg.h

7 #i‚de‡
MCS_REG_H


8 
	#MCS_REG_H


	)

10 
	~<löux/bôs.h
>

13 
	#MCSX_IP_MODE
 0x900c8uŒ

	)

14 
	#MCSX_MCS_TOP_SLAVE_PORT_RESET
(
a
) ({ \

15 
u64
 
off£t
; \

17 
off£t
 = 0x408ull; \

18 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

19 
off£t
 = 0xa28ull; \

20 
off£t
 +(
a
) * 0x8ull; \

21 
off£t
; })

	)

24 
	#MCSX_MCS_TOP_SLAVE_CHANNEL_CFG
(
a
) ({ \

25 
u64
 
off£t
; \

27 
off£t
 = 0x808ull; \

28 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

29 
off£t
 = 0xa68ull; \

30 
off£t
 +(
a
) * 0x8ull; \

31 
off£t
; })

	)

33 
	#MCSX_MIL_GLOBAL
 ({ \

34 
u64
 
off£t
; \

36 
off£t
 = 0x80000ull; \

37 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

38 
off£t
 = 0x60000ull; \

39 
off£t
; })

	)

41 
	#MCSX_MIL_RX_LMACX_CFG
(
a
) ({ \

42 
u64
 
off£t
; \

44 
off£t
 = 0x900a8ull; \

45 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

46 
off£t
 = 0x700a8ull; \

47 
off£t
 +(
a
) * 0x800ull; \

48 
off£t
; })

	)

50 
	#MCSX_HIL_GLOBAL
 ({ \

51 
u64
 
off£t
; \

53 
off£t
 = 0xc0000ull; \

54 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

55 
off£t
 = 0xa0000ull; \

56 
off£t
; })

	)

58 
	#MCSX_LINK_LMACX_CFG
(
a
) ({ \

59 
u64
 
off£t
; \

61 
off£t
 = 0x90000ull; \

62 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

63 
off£t
 = 0x70000ull; \

64 
off£t
 +(
a
) * 0x800ull; \

65 
off£t
; })

	)

67 
	#MCSX_MIL_RX_GBL_STATUS
 ({ \

68 
u64
 
off£t
; \

70 
off£t
 = 0x800c8ull; \

71 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

72 
off£t
 = 0x600c8ull; \

73 
off£t
; })

	)

75 
	#MCSX_MIL_IP_GBL_STATUS
 ({ \

76 
u64
 
off£t
; \

78 
off£t
 = 0x800d0ull; \

79 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

80 
off£t
 = 0x600d0ull; \

81 
off£t
; })

	)

84 
	#MCSX_PAB_RX_SLAVE_PORT_CFGX
(
a
) ({ \

85 
u64
 
off£t
; \

87 
off£t
 = 0x1718ull; \

88 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

89 
off£t
 = 0x280ull; \

90 
off£t
 +(
a
) * 0x40ull; \

91 
off£t
; })

	)

93 
	#MCSX_PAB_TX_SLAVE_PORT_CFGX
(
a
Ë(0x2930uŒ + (aË* 0x40uŒ)

	)

96 
	#MCSX_PEX_RX_SLAVE_VLAN_CFGX
(
a
Ë(0x3b58uŒ + (aË* 0x8uŒ)

	)

97 
	#MCSX_PEX_TX_SLAVE_VLAN_CFGX
(
a
Ë(0x46f8uŒ + (aË* 0x8uŒ)

	)

98 
	#MCSX_PEX_TX_SLAVE_CUSTOM_TAG_REL_MODE_SEL
(
a
Ë(0x788uŒ + (aË* 0x8uŒ)

	)

99 
	#MCSX_PEX_TX_SLAVE_PORT_CONFIG
(
a
Ë(0x4738uŒ + (aË* 0x8uŒ)

	)

100 
	#MCSX_PEX_RX_SLAVE_RULE_ETYPE_CFGX
(
a
) ({ \

101 
u64
 
off£t
; \

103 
off£t
 = 0x3fc0ull; \

104 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

105 
off£t
 = 0x558ull; \

106 
off£t
 +(
a
) * 0x8ull; \

107 
off£t
; })

	)

109 
	#MCSX_PEX_RX_SLAVE_RULE_DAX
(
a
) ({ \

110 
u64
 
off£t
; \

112 
off£t
 = 0x4000ull; \

113 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

114 
off£t
 = 0x598ull; \

115 
off£t
 +(
a
) * 0x8ull; \

116 
off£t
; })

	)

118 
	#MCSX_PEX_RX_SLAVE_RULE_DA_RANGE_MINX
(
a
) ({ \

119 
u64
 
off£t
; \

121 
off£t
 = 0x4040ull; \

122 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

123 
off£t
 = 0x5d8ull; \

124 
off£t
 +(
a
) * 0x8ull; \

125 
off£t
; })

	)

127 
	#MCSX_PEX_RX_SLAVE_RULE_DA_RANGE_MAXX
(
a
) ({ \

128 
u64
 
off£t
; \

130 
off£t
 = 0x4048ull; \

131 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

132 
off£t
 = 0x5e0ull; \

133 
off£t
 +(
a
) * 0x8ull; \

134 
off£t
; })

	)

136 
	#MCSX_PEX_RX_SLAVE_RULE_COMBO_MINX
(
a
) ({ \

137 
u64
 
off£t
; \

139 
off£t
 = 0x4080ull; \

140 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

141 
off£t
 = 0x648ull; \

142 
off£t
 +(
a
) * 0x8ull; \

143 
off£t
; })

	)

145 
	#MCSX_PEX_RX_SLAVE_RULE_COMBO_MAXX
(
a
) ({ \

146 
u64
 
off£t
; \

148 
off£t
 = 0x4088ull; \

149 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

150 
off£t
 = 0x650ull; \

151 
off£t
 +(
a
) * 0x8ull; \

152 
off£t
; })

	)

154 
	#MCSX_PEX_RX_SLAVE_RULE_COMBO_ETX
(
a
) ({ \

155 
u64
 
off£t
; \

157 
off£t
 = 0x4090ull; \

158 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

159 
off£t
 = 0x658ull; \

160 
off£t
 +(
a
) * 0x8ull; \

161 
off£t
; })

	)

163 
	#MCSX_PEX_RX_SLAVE_RULE_MAC
 ({ \

164 
u64
 
off£t
; \

166 
off£t
 = 0x40e0ull; \

167 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

168 
off£t
 = 0x6d8ull; \

169 
off£t
; })

	)

171 
	#MCSX_PEX_RX_SLAVE_RULE_ENABLE
 ({ \

172 
u64
 
off£t
; \

174 
off£t
 = 0x40e8ull; \

175 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

176 
off£t
 = 0x6e0ull; \

177 
off£t
; })

	)

179 
	#MCSX_PEX_TX_SLAVE_RULE_ETYPE_CFGX
(
a
) ({ \

180 
u64
 
off£t
; \

182 
off£t
 = 0x4b60ull; \

183 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

184 
off£t
 = 0x7d8ull; \

185 
off£t
 +(
a
) * 0x8ull; \

186 
off£t
; })

	)

188 
	#MCSX_PEX_TX_SLAVE_RULE_DAX
(
a
) ({ \

189 
u64
 
off£t
; \

191 
off£t
 = 0x4ba0ull; \

192 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

193 
off£t
 = 0x818ull; \

194 
off£t
 +(
a
) * 0x8ull; \

195 
off£t
; })

	)

197 
	#MCSX_PEX_TX_SLAVE_RULE_DA_RANGE_MINX
(
a
) ({ \

198 
u64
 
off£t
; \

200 
off£t
 = 0x4be0ull; \

201 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

202 
off£t
 = 0x858ull; \

203 
off£t
 +(
a
) * 0x8ull; \

204 
off£t
; })

	)

206 
	#MCSX_PEX_TX_SLAVE_RULE_DA_RANGE_MAXX
(
a
) ({ \

207 
u64
 
off£t
; \

209 
off£t
 = 0x4be8ull; \

210 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

211 
off£t
 = 0x860ull; \

212 
off£t
 +(
a
) * 0x8ull; \

213 
off£t
; })

	)

215 
	#MCSX_PEX_TX_SLAVE_RULE_COMBO_MINX
(
a
) ({ \

216 
u64
 
off£t
; \

218 
off£t
 = 0x4c20ull; \

219 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

220 
off£t
 = 0x8c8ull; \

221 
off£t
 +(
a
) * 0x8ull; \

222 
off£t
; })

	)

224 
	#MCSX_PEX_TX_SLAVE_RULE_COMBO_MAXX
(
a
) ({ \

225 
u64
 
off£t
; \

227 
off£t
 = 0x4c28ull; \

228 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

229 
off£t
 = 0x8d0ull; \

230 
off£t
 +(
a
) * 0x8ull; \

231 
off£t
; })

	)

233 
	#MCSX_PEX_TX_SLAVE_RULE_COMBO_ETX
(
a
) ({ \

234 
u64
 
off£t
; \

236 
off£t
 = 0x4c30ull; \

237 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

238 
off£t
 = 0x8d8ull; \

239 
off£t
 +(
a
) * 0x8ull; \

240 
off£t
; })

	)

242 
	#MCSX_PEX_TX_SLAVE_RULE_MAC
 ({ \

243 
u64
 
off£t
; \

245 
off£t
 = 0x4c80ull; \

246 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

247 
off£t
 = 0x958ull; \

248 
off£t
; })

	)

250 
	#MCSX_PEX_TX_SLAVE_RULE_ENABLE
 ({ \

251 
u64
 
off£t
; \

253 
off£t
 = 0x4c88ull; \

254 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

255 
off£t
 = 0x960ull; \

256 
off£t
; })

	)

258 
	#MCSX_PEX_RX_SLAVE_PEX_CONFIGURATION
 ({ \

259 
u64
 
off£t
; \

261 
off£t
 = 0x3b50ull; \

262 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

263 
off£t
 = 0x4c0ull; \

264 
off£t
; })

	)

267 
	#MCSX_PEX_RX_SLAVE_CUSTOM_TAGX
(
a
Ë(0x4c8uŒ + (aË* 0x8uŒ)

	)

268 
	#MCSX_PEX_TX_SLAVE_CUSTOM_TAGX
(
a
Ë(0x748uŒ + (aË* 0x8uŒ)

	)

269 
	#MCSX_PEX_RX_SLAVE_ETYPE_ENABLE
 0x6e8uŒ

	)

270 
	#MCSX_PEX_TX_SLAVE_ETYPE_ENABLE
 0x968uŒ

	)

273 
	#MCSX_BBE_RX_SLAVE_PADDING_CTL
 0xe08uŒ

	)

274 
	#MCSX_BBE_TX_SLAVE_PADDING_CTL
 0x12f8uŒ

	)

275 
	#MCSX_BBE_RX_SLAVE_CAL_ENTRY
 0x180uŒ

	)

276 
	#MCSX_BBE_RX_SLAVE_CAL_LEN
 0x188uŒ

	)

277 
	#MCSX_PAB_RX_SLAVE_FIFO_SKID_CFGX
(
a
Ë(0x290uŒ + (aË* 0x40uŒ)

	)

279 
	#MCSX_BBE_RX_SLAVE_BBE_INT
 ({ \

280 
u64
 
off£t
; \

282 
off£t
 = 0xe00ull; \

283 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

284 
off£t
 = 0x160ull; \

285 
off£t
; })

	)

287 
	#MCSX_BBE_RX_SLAVE_BBE_INT_ENB
 ({ \

288 
u64
 
off£t
; \

290 
off£t
 = 0xe08ull; \

291 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

292 
off£t
 = 0x168ull; \

293 
off£t
; })

	)

295 
	#MCSX_BBE_RX_SLAVE_BBE_INT_INTR_RW
 ({ \

296 
u64
 
off£t
; \

298 
off£t
 = 0xe08ull; \

299 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

300 
off£t
 = 0x178ull; \

301 
off£t
; })

	)

303 
	#MCSX_BBE_TX_SLAVE_BBE_INT
 ({ \

304 
u64
 
off£t
; \

306 
off£t
 = 0x1278ull; \

307 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

308 
off£t
 = 0x1e0ull; \

309 
off£t
; })

	)

311 
	#MCSX_BBE_TX_SLAVE_BBE_INT_INTR_RW
 ({ \

312 
u64
 
off£t
; \

314 
off£t
 = 0x1278ull; \

315 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

316 
off£t
 = 0x1f8ull; \

317 
off£t
; })

	)

319 
	#MCSX_BBE_TX_SLAVE_BBE_INT_ENB
 ({ \

320 
u64
 
off£t
; \

322 
off£t
 = 0x1280ull; \

323 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

324 
off£t
 = 0x1e8ull; \

325 
off£t
; })

	)

327 
	#MCSX_PAB_RX_SLAVE_PAB_INT
 ({ \

328 
u64
 
off£t
; \

330 
off£t
 = 0x16f0ull; \

331 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

332 
off£t
 = 0x260ull; \

333 
off£t
; })

	)

335 
	#MCSX_PAB_RX_SLAVE_PAB_INT_ENB
 ({ \

336 
u64
 
off£t
; \

338 
off£t
 = 0x16f8ull; \

339 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

340 
off£t
 = 0x268ull; \

341 
off£t
; })

	)

343 
	#MCSX_PAB_RX_SLAVE_PAB_INT_INTR_RW
 ({ \

344 
u64
 
off£t
; \

346 
off£t
 = 0x16f8ull; \

347 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

348 
off£t
 = 0x278ull; \

349 
off£t
; })

	)

351 
	#MCSX_PAB_TX_SLAVE_PAB_INT
 ({ \

352 
u64
 
off£t
; \

354 
off£t
 = 0x2908ull; \

355 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

356 
off£t
 = 0x380ull; \

357 
off£t
; })

	)

359 
	#MCSX_PAB_TX_SLAVE_PAB_INT_ENB
 ({ \

360 
u64
 
off£t
; \

362 
off£t
 = 0x2910ull; \

363 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

364 
off£t
 = 0x388ull; \

365 
off£t
; })

	)

367 
	#MCSX_PAB_TX_SLAVE_PAB_INT_INTR_RW
 ({ \

368 
u64
 
off£t
; \

370 
off£t
 = 0x16f8ull; \

371 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

372 
off£t
 = 0x398ull; \

373 
off£t
; })

	)

376 
	#MCSX_CPM_RX_SLAVE_FLOWID_TCAM_DATAX
(
a
, 
b
) ({ \

377 
u64
 
off£t
; \

379 
off£t
 = 0x30740ull; \

380 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

381 
off£t
 = 0x3bf8ull; \

382 
off£t
 +(
a
Ë* 0x8uŒ + (
b
) * 0x20ull; \

383 
off£t
; })

	)

385 
	#MCSX_CPM_RX_SLAVE_FLOWID_TCAM_MASKX
(
a
, 
b
) ({ \

386 
u64
 
off£t
; \

388 
off£t
 = 0x34740ull; \

389 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

390 
off£t
 = 0x43f8ull; \

391 
off£t
 +(
a
Ë* 0x8uŒ + (
b
) * 0x20ull; \

392 
off£t
; })

	)

394 
	#MCSX_CPM_RX_SLAVE_FLOWID_TCAM_ENA_0
 ({ \

395 
u64
 
off£t
; \

397 
off£t
 = 0x30700ull; \

398 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

399 
off£t
 = 0x3bd8ull; \

400 
off£t
; })

	)

402 
	#MCSX_CPM_RX_SLAVE_SC_CAMX
(
a
, 
b
) ({ \

403 
u64
 
off£t
; \

405 
off£t
 = 0x38780ull; \

406 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

407 
off£t
 = 0x4c08ull; \

408 
off£t
 +(
a
Ë* 0x8uŒ + (
b
) * 0x10ull; \

409 
off£t
; })

	)

411 
	#MCSX_CPM_RX_SLAVE_SC_CAM_ENA
(
a
) ({ \

412 
u64
 
off£t
; \

414 
off£t
 = 0x38740uŒ + (
a
) * 0x8ull; \

415 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

416 
off£t
 = 0x4bf8ull; \

417 
off£t
; })

	)

419 
	#MCSX_CPM_RX_SLAVE_SECY_MAP_MEMX
(
a
) ({ \

420 
u64
 
off£t
; \

422 
off£t
 = 0x23ee0ull; \

423 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

424 
off£t
 = 0xbd0ull; \

425 
off£t
 +(
a
) * 0x8ull; \

426 
off£t
; })

	)

428 
	#MCSX_CPM_RX_SLAVE_SECY_PLCY_MEM_0X
(
a
) ({ \

429 
u64
 
off£t
; \

431 
off£t
 = (0x246e0uŒ + (
a
) * 0x10ull); \

432 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

433 
off£t
 = (0xdd0uŒ + (
a
) * 0x8ull); \

434 
off£t
; })

	)

436 
	#MCSX_CPM_RX_SLAVE_SA_KEY_LOCKOUTX
(
a
) ({ \

437 
u64
 
off£t
; \

439 
off£t
 = 0x23E90ull; \

440 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

441 
off£t
 = 0xbb0ull; \

442 
off£t
 +(
a
) * 0x8ull; \

443 
off£t
; })

	)

445 
	#MCSX_CPM_RX_SLAVE_SA_MAP_MEMX
(
a
) ({ \

446 
u64
 
off£t
; \

448 
off£t
 = 0x256e0ull; \

449 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

450 
off£t
 = 0xfd0ull; \

451 
off£t
 +(
a
) * 0x8ull; \

452 
off£t
; })

	)

454 
	#MCSX_CPM_RX_SLAVE_SA_PLCY_MEMX
(
a
, 
b
) ({ \

455 
u64
 
off£t
; \

457 
off£t
 = 0x27700ull; \

458 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

459 
off£t
 = 0x17d8ull; \

460 
off£t
 +(
a
Ë* 0x8uŒ + (
b
) * 0x40ull; \

461 
off£t
; })

	)

463 
	#MCSX_CPM_RX_SLAVE_SA_PN_TABLE_MEMX
(
a
) ({ \

464 
u64
 
off£t
; \

466 
off£t
 = 0x2f700ull; \

467 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

468 
off£t
 = 0x37d8; \

469 
off£t
 +(
a
) * 0x8ull; \

470 
off£t
; })

	)

472 
	#MCSX_CPM_RX_SLAVE_XPN_THRESHOLD
 ({ \

473 
u64
 
off£t
; \

475 
off£t
 = 0x23e40ull; \

476 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

477 
off£t
 = 0xb90ull; \

478 
off£t
; })

	)

480 
	#MCSX_CPM_RX_SLAVE_PN_THRESHOLD
 ({ \

481 
u64
 
off£t
; \

483 
off£t
 = 0x23e48ull; \

484 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

485 
off£t
 = 0xb98ull; \

486 
off£t
; })

	)

488 
	#MCSX_CPM_RX_SLAVE_PN_THRESH_REACHEDX
(
a
) ({ \

489 
u64
 
off£t
; \

491 
off£t
 = 0x23e50ull; \

492 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

493 
off£t
 = 0xba0ull; \

494 
off£t
 +(
a
) * 0x8ull; \

495 
off£t
; })

	)

497 
	#MCSX_CPM_RX_SLAVE_FLOWID_TCAM_ENA_1
 0x30708uŒ

	)

498 
	#MCSX_CPM_RX_SLAVE_SECY_PLCY_MEM_1X
(
a
Ë(0x246e8uŒ + (aË* 0x10uŒ)

	)

501 
	#MCSX_CPM_TX_SLAVE_FLOWID_TCAM_DATAX
(
a
, 
b
) ({ \

502 
u64
 
off£t
; \

504 
off£t
 = 0x51d50ull; \

505 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

506 
off£t
 = 0xa7c0ull; \

507 
off£t
 +(
a
Ë* 0x8uŒ + (
b
) * 0x20ull; \

508 
off£t
; })

	)

510 
	#MCSX_CPM_TX_SLAVE_FLOWID_TCAM_MASKX
(
a
, 
b
) ({ \

511 
u64
 
off£t
; \

513 
off£t
 = 0x55d50ull; \

514 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

515 
off£t
 = 0xafc0ull; \

516 
off£t
 +(
a
Ë* 0x8uŒ + (
b
) * 0x20ull; \

517 
off£t
; })

	)

519 
	#MCSX_CPM_TX_SLAVE_FLOWID_TCAM_ENA_0
 ({ \

520 
u64
 
off£t
; \

522 
off£t
 = 0x51d10ull; \

523 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

524 
off£t
 = 0xa7a0ull; \

525 
off£t
; })

	)

527 
	#MCSX_CPM_TX_SLAVE_SECY_MAP_MEM_0X
(
a
) ({ \

528 
u64
 
off£t
; \

530 
off£t
 = 0x3e508uŒ + (
a
) * 0x8ull; \

531 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

532 
off£t
 = 0x5550uŒ + (
a
) * 0x10ull; \

533 
off£t
; })

	)

535 
	#MCSX_CPM_TX_SLAVE_SECY_PLCY_MEMX
(
a
) ({ \

536 
u64
 
off£t
; \

538 
off£t
 = 0x3ed08ull; \

539 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

540 
off£t
 = 0x5950ull; \

541 
off£t
 +(
a
) * 0x8ull; \

542 
off£t
; })

	)

544 
	#MCSX_CPM_TX_SLAVE_SA_KEY_LOCKOUTX
(
a
) ({ \

545 
u64
 
off£t
; \

547 
off£t
 = 0x3e4c0ull; \

548 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

549 
off£t
 = 0x5538ull; \

550 
off£t
 +(
a
) * 0x8ull; \

551 
off£t
; })

	)

553 
	#MCSX_CPM_TX_SLAVE_SA_MAP_MEM_0X
(
a
) ({ \

554 
u64
 
off£t
; \

556 
off£t
 = 0x3fd10uŒ + (
a
) * 0x10ull; \

557 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

558 
off£t
 = 0x6150uŒ + (
a
) * 0x8ull; \

559 
off£t
; })

	)

561 
	#MCSX_CPM_TX_SLAVE_SA_PLCY_MEMX
(
a
, 
b
) ({ \

562 
u64
 
off£t
; \

564 
off£t
 = 0x40d10ull; \

565 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

566 
off£t
 = 0x63a0ull; \

567 
off£t
 +(
a
Ë* 0x8uŒ + (
b
) * 0x80ull; \

568 
off£t
; })

	)

570 
	#MCSX_CPM_TX_SLAVE_SA_PN_TABLE_MEMX
(
a
) ({ \

571 
u64
 
off£t
; \

573 
off£t
 = 0x50d10ull; \

574 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

575 
off£t
 = 0xa3a0ull; \

576 
off£t
 +(
a
) * 0x8ull; \

577 
off£t
; })

	)

579 
	#MCSX_CPM_TX_SLAVE_XPN_THRESHOLD
 ({ \

580 
u64
 
off£t
; \

582 
off£t
 = 0x3e4b0ull; \

583 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

584 
off£t
 = 0x5528ull; \

585 
off£t
; })

	)

587 
	#MCSX_CPM_TX_SLAVE_PN_THRESHOLD
 ({ \

588 
u64
 
off£t
; \

590 
off£t
 = 0x3e4b8ull; \

591 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

592 
off£t
 = 0x5530ull; \

593 
off£t
; })

	)

595 
	#MCSX_CPM_TX_SLAVE_SA_MAP_MEM_1X
(
a
Ë(0x3fd18uŒ + (aË* 0x10uŒ)

	)

596 
	#MCSX_CPM_TX_SLAVE_SECY_MAP_MEM_1X
(
a
Ë(0x5558uŒ + (aË* 0x10uŒ)

	)

597 
	#MCSX_CPM_TX_SLAVE_FLOWID_TCAM_ENA_1
 0x51d18uŒ

	)

598 
	#MCSX_CPM_TX_SLAVE_TX_SA_ACTIVEX
(
a
Ë(0x5b50 + (aË* 0x8uŒ)

	)

599 
	#MCSX_CPM_TX_SLAVE_SA_INDEX0_VLDX
(
a
Ë(0x5d50 + (aË* 0x8uŒ)

	)

600 
	#MCSX_CPM_TX_SLAVE_SA_INDEX1_VLDX
(
a
Ë(0x5f50 + (aË* 0x8uŒ)

	)

601 
	#MCSX_CPM_TX_SLAVE_AUTO_REKEY_ENABLE_0
 0x5500uŒ

	)

604 
	#MCSX_CSE_RX_MEM_SLAVE_IFINCTLBCPKTSX
(
a
) ({ \

605 
u64
 
off£t
; \

607 
off£t
 = 0x9e80ull; \

608 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

609 
off£t
 = 0xc218ull; \

610 
off£t
 +(
a
) * 0x8ull; \

611 
off£t
; })

	)

613 
	#MCSX_CSE_RX_MEM_SLAVE_IFINCTLMCPKTSX
(
a
) ({ \

614 
u64
 
off£t
; \

616 
off£t
 = 0x9680ull; \

617 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

618 
off£t
 = 0xc018ull; \

619 
off£t
 +(
a
) * 0x8ull; \

620 
off£t
; })

	)

622 
	#MCSX_CSE_RX_MEM_SLAVE_IFINCTLOCTETSX
(
a
) ({ \

623 
u64
 
off£t
; \

625 
off£t
 = 0x6e80ull; \

626 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

627 
off£t
 = 0xbc18ull; \

628 
off£t
 +(
a
) * 0x8ull; \

629 
off£t
; })

	)

631 
	#MCSX_CSE_RX_MEM_SLAVE_IFINCTLUCPKTSX
(
a
) ({ \

632 
u64
 
off£t
; \

634 
off£t
 = 0x8e80ull; \

635 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

636 
off£t
 = 0xbe18ull; \

637 
off£t
 +(
a
) * 0x8ull; \

638 
off£t
; })

	)

640 
	#MCSX_CSE_RX_MEM_SLAVE_IFINUNCTLBCPKTSX
(
a
) ({ \

641 
u64
 
off£t
; \

643 
off£t
 = 0x8680ull; \

644 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

645 
off£t
 = 0xca18ull; \

646 
off£t
 +(
a
) * 0x8ull; \

647 
off£t
; })

	)

649 
	#MCSX_CSE_RX_MEM_SLAVE_IFINUNCTLMCPKTSX
(
a
) ({ \

650 
u64
 
off£t
; \

652 
off£t
 = 0x7e80ull; \

653 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

654 
off£t
 = 0xc818ull; \

655 
off£t
 +(
a
) * 0x8ull; \

656 
off£t
; })

	)

658 
	#MCSX_CSE_RX_MEM_SLAVE_IFINUNCTLOCTETSX
(
a
) ({ \

659 
u64
 
off£t
; \

661 
off£t
 = 0x6680ull; \

662 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

663 
off£t
 = 0xc418ull; \

664 
off£t
 +(
a
) * 0x8ull; \

665 
off£t
; })

	)

667 
	#MCSX_CSE_RX_MEM_SLAVE_IFINUNCTLUCPKTSX
(
a
) ({ \

668 
u64
 
off£t
; \

670 
off£t
 = 0x7680ull; \

671 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

672 
off£t
 = 0xc618ull; \

673 
off£t
 +(
a
) * 0x8ull; \

674 
off£t
; })

	)

676 
	#MCSX_CSE_RX_MEM_SLAVE_INOCTETSSECYDECRYPTEDX
(
a
) ({ \

677 
u64
 
off£t
; \

679 
off£t
 = 0x5e80ull; \

680 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

681 
off£t
 = 0xdc18ull; \

682 
off£t
 +(
a
) * 0x8ull; \

683 
off£t
; })

	)

685 
	#MCSX_CSE_RX_MEM_SLAVE_INOCTETSSECYVALIDATEX
(
a
)({ \

686 
u64
 
off£t
; \

688 
off£t
 = 0x5680ull; \

689 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

690 
off£t
 = 0xda18ull; \

691 
off£t
 +(
a
) * 0x8ull; \

692 
off£t
; })

	)

694 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSCTRLPORTDISABLEDX
(
a
) ({ \

695 
u64
 
off£t
; \

697 
off£t
 = 0xd680ull; \

698 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

699 
off£t
 = 0xce18ull; \

700 
off£t
 +(
a
) * 0x8ull; \

701 
off£t
; })

	)

703 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSFLOWIDTCAMHITX
(
a
) ({ \

704 
u64
 
off£t
; \

706 
off£t
 = 0x16a80ull; \

707 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

708 
off£t
 = 0xec78ull; \

709 
off£t
 +(
a
) * 0x8ull; \

710 
off£t
; })

	)

712 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSFLOWIDTCAMMISSX
(
a
) ({ \

713 
u64
 
off£t
; \

715 
off£t
 = 0x16680ull; \

716 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

717 
off£t
 = 0xec38ull; \

718 
off£t
 +(
a
) * 0x8ull; \

719 
off£t
; })

	)

721 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSPARSEERRX
(
a
) ({ \

722 
u64
 
off£t
; \

724 
off£t
 = 0x16880ull; \

725 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

726 
off£t
 = 0xec18ull; \

727 
off£t
 +(
a
) * 0x8ull; \

728 
off£t
; })

	)

730 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSCCAMHITX
(
a
) ({ \

731 
u64
 
off£t
; \

733 
off£t
 = 0xfe80ull; \

734 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

735 
off£t
 = 0xde18ull; \

736 
off£t
 +(
a
) * 0x8ull; \

737 
off£t
; })

	)

739 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSCINVALIDX
(
a
) ({ \

740 
u64
 
off£t
; \

742 
off£t
 = 0x10680ull; \

743 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

744 
off£t
 = 0xe418ull; \

745 
off£t
 +(
a
) * 0x8ull; \

746 
off£t
; })

	)

748 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSCNOTVALIDX
(
a
) ({ \

749 
u64
 
off£t
; \

751 
off£t
 = 0x10e80ull; \

752 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

753 
off£t
 = 0xe218ull; \

754 
off£t
 +(
a
) * 0x8ull; \

755 
off£t
; })

	)

757 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYBADTAGX
(
a
) ({ \

758 
u64
 
off£t
; \

760 
off£t
 = 0xae80ull; \

761 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

762 
off£t
 = 0xd418ull; \

763 
off£t
 +(
a
) * 0x8ull; \

764 
off£t
; })

	)

766 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYNOSAX
(
a
) ({ \

767 
u64
 
off£t
; \

769 
off£t
 = 0xc680ull; \

770 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

771 
off£t
 = 0xd618ull; \

772 
off£t
 +(
a
) * 0x8ull; \

773 
off£t
; })

	)

775 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYNOSAERRORX
(
a
) ({ \

776 
u64
 
off£t
; \

778 
off£t
 = 0xce80ull; \

779 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

780 
off£t
 = 0xd818ull; \

781 
off£t
 +(
a
) * 0x8ull; \

782 
off£t
; })

	)

784 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYTAGGEDCTLX
(
a
) ({ \

785 
u64
 
off£t
; \

787 
off£t
 = 0xbe80ull; \

788 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

789 
off£t
 = 0xcc18ull; \

790 
off£t
 +(
a
) * 0x8ull; \

791 
off£t
; })

	)

793 
	#MCSX_CSE_RX_SLAVE_CTRL
 ({ \

794 
u64
 
off£t
; \

796 
off£t
 = 0x52a0ull; \

797 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

798 
off£t
 = 0x9c0ull; \

799 
off£t
; })

	)

801 
	#MCSX_CSE_RX_SLAVE_STATS_CLEAR
 ({ \

802 
u64
 
off£t
; \

804 
off£t
 = 0x52b8ull; \

805 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

806 
off£t
 = 0x9d8ull; \

807 
off£t
; })

	)

809 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSCUNCHECKEDX
(
a
) ({ \

810 
u64
 
off£t
; \

812 
off£t
 = 0xee80ull; \

813 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

814 
off£t
 = 0xe818ull; \

815 
off£t
 +(
a
) * 0x8ull; \

816 
off£t
; })

	)

818 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYUNTAGGEDX
(
a
) ({ \

819 
u64
 
off£t
; \

821 
off£t
 = 0xa680ull; \

822 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

823 
off£t
 = 0xd018ull; \

824 
off£t
 +(
a
) * 0x8ull; \

825 
off£t
; })

	)

827 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSCLATEORDELAYEDX
(
a
) ({ \

828 
u64
 
off£t
; \

830 
off£t
 = 0xf680ull; \

831 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

832 
off£t
 = 0xe018ull; \

833 
off£t
 +(
a
) * 0x8ull; \

834 
off£t
; })

	)

836 
	#MCSX_CSE_RX_MEM_SLAVE_INOCTETSSCDECRYPTEDX
(
a
Ë(0xe680uŒ + (aË* 0x8uŒ)

	)

837 
	#MCSX_CSE_RX_MEM_SLAVE_INOCTETSSCVALIDATEX
(
a
Ë(0xde80uŒ + (aË* 0x8uŒ)

	)

838 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYNOTAGX
(
a
Ë(0xd218 + (aË* 0x8uŒ)

	)

839 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSECYCTLX
(
a
Ë(0xb680uŒ + (aË* 0x8uŒ)

	)

840 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSAINVALIDX
(
a
Ë(0x12680uŒ + (aË* 0x8uŒ)

	)

841 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSANOTUSINGSAERRORX
(
a
Ë(0x15680uŒ + (aË* 0x8uŒ)

	)

842 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSANOTVALIDX
(
a
Ë(0x13680uŒ + (aË* 0x8uŒ)

	)

843 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSAOKX
(
a
Ë(0x11680uŒ + (aË* 0x8uŒ)

	)

844 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSAUNUSEDSAX
(
a
Ë(0x14680uŒ + (aË* 0x8uŒ)

	)

845 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSEARLYPREEMPTERRX
(
a
Ë(0xec58uŒ + (aË* 0x8uŒ)

	)

846 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSCOKX
(
a
Ë(0xó18uŒ + (aË* 0x8uŒ)

	)

847 
	#MCSX_CSE_RX_MEM_SLAVE_INPKTSSCDELAYEDX
(
a
Ë(0xe618uŒ + (aË* 0x8uŒ)

	)

850 
	#MCSX_CSE_TX_MEM_SLAVE_IFOUTCOMMONOCTETSX
(
a
Ë(0x18440uŒ + (aË* 0x8uŒ)

	)

851 
	#MCSX_CSE_TX_MEM_SLAVE_IFOUTCTLBCPKTSX
(
a
) ({ \

852 
u64
 
off£t
; \

854 
off£t
 = 0x1c440ull; \

855 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

856 
off£t
 = 0xf478ull; \

857 
off£t
 +(
a
) * 0x8ull; \

858 
off£t
; })

	)

860 
	#MCSX_CSE_TX_MEM_SLAVE_IFOUTCTLMCPKTSX
(
a
) ({ \

861 
u64
 
off£t
; \

863 
off£t
 = 0x1bc40ull; \

864 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

865 
off£t
 = 0xf278ull; \

866 
off£t
 +(
a
) * 0x8ull; \

867 
off£t
; })

	)

869 
	#MCSX_CSE_TX_MEM_SLAVE_IFOUTCTLOCTETSX
(
a
) ({ \

870 
u64
 
off£t
; \

872 
off£t
 = 0x19440ull; \

873 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

874 
off£t
 = 0xee78ull; \

875 
off£t
 +(
a
) * 0x8ull; \

876 
off£t
; })

	)

878 
	#MCSX_CSE_TX_MEM_SLAVE_IFOUTCTLUCPKTSX
(
a
) ({ \

879 
u64
 
off£t
; \

881 
off£t
 = 0x1b440ull; \

882 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

883 
off£t
 = 0xf078ull; \

884 
off£t
 +(
a
) * 0x8ull; \

885 
off£t
; })

	)

887 
	#MCSX_CSE_TX_MEM_SLAVE_IFOUTUNCTLBCPKTSX
(
a
) ({ \

888 
u64
 
off£t
; \

890 
off£t
 = 0x1ac40ull; \

891 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

892 
off£t
 = 0xfc78ull; \

893 
off£t
 +(
a
) * 0x8ull; \

894 
off£t
; })

	)

896 
	#MCSX_CSE_TX_MEM_SLAVE_IFOUTUNCTLMCPKTSX
(
a
) ({ \

897 
u64
 
off£t
; \

899 
off£t
 = 0x1a440ull; \

900 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

901 
off£t
 = 0xfa78ull; \

902 
off£t
 +(
a
) * 0x8ull; \

903 
off£t
; })

	)

905 
	#MCSX_CSE_TX_MEM_SLAVE_IFOUTUNCTLOCTETSX
(
a
) ({ \

906 
u64
 
off£t
; \

908 
off£t
 = 0x18c40ull; \

909 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

910 
off£t
 = 0xf678ull; \

911 
off£t
 +(
a
) * 0x8ull; \

912 
off£t
; })

	)

914 
	#MCSX_CSE_TX_MEM_SLAVE_IFOUTUNCTLUCPKTSX
(
a
) ({ \

915 
u64
 
off£t
; \

917 
off£t
 = 0x19c40ull; \

918 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

919 
off£t
 = 0xf878ull; \

920 
off£t
 +(
a
) * 0x8ull; \

921 
off£t
; })

	)

923 
	#MCSX_CSE_TX_MEM_SLAVE_OUTOCTETSSECYENCRYPTEDX
(
a
) ({ \

924 
u64
 
off£t
; \

926 
off£t
 = 0x17c40ull; \

927 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

928 
off£t
 = 0x10878ull; \

929 
off£t
 +(
a
) * 0x8ull; \

930 
off£t
; })

	)

932 
	#MCSX_CSE_TX_MEM_SLAVE_OUTOCTETSSECYPROTECTEDX
(
a
) ({ \

933 
u64
 
off£t
; \

935 
off£t
 = 0x17440ull; \

936 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

937 
off£t
 = 0x10678ull; \

938 
off£t
 +(
a
) * 0x8ull; \

939 
off£t
; })

	)

941 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSCTRLPORTDISABLEDX
(
a
) ({ \

942 
u64
 
off£t
; \

944 
off£t
 = 0x1e440ull; \

945 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

946 
off£t
 = 0xfe78ull; \

947 
off£t
 +(
a
) * 0x8ull; \

948 
off£t
; })

	)

950 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSFLOWIDTCAMHITX
(
a
) ({ \

951 
u64
 
off£t
; \

953 
off£t
 = 0x23240ull; \

954 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

955 
off£t
 = 0x10ed8ull; \

956 
off£t
 +(
a
) * 0x8ull; \

957 
off£t
; })

	)

959 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSFLOWIDTCAMMISSX
(
a
) ({ \

960 
u64
 
off£t
; \

962 
off£t
 = 0x22c40ull; \

963 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

964 
off£t
 = 0x10e98ull; \

965 
off£t
 +(
a
) * 0x8ull; \

966 
off£t
; })

	)

968 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSPARSEERRX
(
a
) ({ \

969 
u64
 
off£t
; \

971 
off£t
 = 0x22e40ull; \

972 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

973 
off£t
 = 0x10e78ull; \

974 
off£t
 +(
a
) * 0x8ull; \

975 
off£t
; })

	)

977 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSCENCRYPTEDX
(
a
) ({ \

978 
u64
 
off£t
; \

980 
off£t
 = 0x20440ull; \

981 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

982 
off£t
 = 0x10c78ull; \

983 
off£t
 +(
a
) * 0x8ull; \

984 
off£t
; })

	)

986 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSCPROTECTEDX
(
a
) ({ \

987 
u64
 
off£t
; \

989 
off£t
 = 0x1fc40ull; \

990 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

991 
off£t
 = 0x10a78ull; \

992 
off£t
 +(
a
) * 0x8ull; \

993 
off£t
; })

	)

995 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSECTAGINSERTIONERRX
(
a
) ({ \

996 
u64
 
off£t
; \

998 
off£t
 = 0x23040ull; \

999 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1000 
off£t
 = 0x110d8ull; \

1001 
off£t
 +(
a
) * 0x8ull; \

1002 
off£t
; })

	)

1004 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSECYNOACTIVESAX
(
a
) ({ \

1005 
u64
 
off£t
; \

1007 
off£t
 = 0x1dc40ull; \

1008 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1009 
off£t
 = 0x10278ull; \

1010 
off£t
 +(
a
) * 0x8ull; \

1011 
off£t
; })

	)

1013 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSECYTOOLONGX
(
a
) ({ \

1014 
u64
 
off£t
; \

1016 
off£t
 = 0x1d440ull; \

1017 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1018 
off£t
 = 0x10478ull; \

1019 
off£t
 +(
a
) * 0x8ull; \

1020 
off£t
; })

	)

1022 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSECYUNTAGGEDX
(
a
) ({ \

1023 
u64
 
off£t
; \

1025 
off£t
 = 0x1cc40ull; \

1026 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1027 
off£t
 = 0x10078ull; \

1028 
off£t
 +(
a
) * 0x8ull; \

1029 
off£t
; })

	)

1031 
	#MCSX_CSE_TX_SLAVE_CTRL
 ({ \

1032 
u64
 
off£t
; \

1034 
off£t
 = 0x54a0ull; \

1035 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1036 
off£t
 = 0xa00ull; \

1037 
off£t
; })

	)

1039 
	#MCSX_CSE_TX_SLAVE_STATS_CLEAR
 ({ \

1040 
u64
 
off£t
; \

1042 
off£t
 = 0x54b8ull; \

1043 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1044 
off£t
 = 0xa18ull; \

1045 
off£t
; })

	)

1047 
	#MCSX_CSE_TX_MEM_SLAVE_OUTOCTETSSCENCRYPTEDX
(
a
Ë(0x1f440uŒ + (aË* 0x8uŒ)

	)

1048 
	#MCSX_CSE_TX_MEM_SLAVE_OUTOCTETSSCPROTECTEDX
(
a
Ë(0x1ec40uŒ + (aË* 0x8uŒ)

	)

1049 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSEARLYPREEMPTERRX
(
a
Ë(0x10eb8uŒ + (aË* 0x8uŒ)

	)

1050 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSAENCRYPTEDX
(
a
Ë(0x21c40uŒ + (aË* 0x8uŒ)

	)

1051 
	#MCSX_CSE_TX_MEM_SLAVE_OUTPKTSSAPROTECTEDX
(
a
Ë(0x20c40uŒ + (aË* 0x8uŒ)

	)

1053 
	#MCSX_IP_INT
 ({ \

1054 
u64
 
off£t
; \

1056 
off£t
 = 0x80028ull; \

1057 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1058 
off£t
 = 0x60028ull; \

1059 
off£t
; })

	)

1061 
	#MCSX_IP_INT_ENA_W1S
 ({ \

1062 
u64
 
off£t
; \

1064 
off£t
 = 0x80040ull; \

1065 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1066 
off£t
 = 0x60040ull; \

1067 
off£t
; })

	)

1069 
	#MCSX_IP_INT_ENA_W1C
 ({ \

1070 
u64
 
off£t
; \

1072 
off£t
 = 0x80038ull; \

1073 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1074 
off£t
 = 0x60038ull; \

1075 
off£t
; })

	)

1077 
	#MCSX_TOP_SLAVE_INT_SUM
 ({ \

1078 
u64
 
off£t
; \

1080 
off£t
 = 0xc20ull; \

1081 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1082 
off£t
 = 0xab8ull; \

1083 
off£t
; })

	)

1085 
	#MCSX_TOP_SLAVE_INT_SUM_ENB
 ({ \

1086 
u64
 
off£t
; \

1088 
off£t
 = 0xc28ull; \

1089 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1090 
off£t
 = 0xac0ull; \

1091 
off£t
; })

	)

1093 
	#MCSX_CPM_RX_SLAVE_RX_INT
 ({ \

1094 
u64
 
off£t
; \

1096 
off£t
 = 0x23c00ull; \

1097 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1098 
off£t
 = 0x0ad8ull; \

1099 
off£t
; })

	)

1101 
	#MCSX_CPM_RX_SLAVE_RX_INT_ENB
 ({ \

1102 
u64
 
off£t
; \

1104 
off£t
 = 0x23c08ull; \

1105 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1106 
off£t
 = 0xae0ull; \

1107 
off£t
; })

	)

1109 
	#MCSX_CPM_TX_SLAVE_TX_INT
 ({ \

1110 
u64
 
off£t
; \

1112 
off£t
 = 0x3d490ull; \

1113 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1114 
off£t
 = 0x54a0ull; \

1115 
off£t
; })

	)

1117 
	#MCSX_CPM_TX_SLAVE_TX_INT_ENB
 ({ \

1118 
u64
 
off£t
; \

1120 
off£t
 = 0x3d498ull; \

1121 i‡(
mcs
->
hw
->
mcs_blks
 > 1) \

1122 
off£t
 = 0x54a8ull; \

1123 
off£t
; })

	)

	@mcs_rvu_if.c

7 
	~<löux/ty≥s.h
>

8 
	~<löux/devi˚.h
>

9 
	~<löux/moduÀ.h
>

10 
	~<löux/pci.h
>

12 
	~"mcs.h
"

13 
	~"rvu.h
"

14 
	~"lmac_comm⁄.h
"

16 
	#M
(
_«me
, 
_id
, 
_‚_«me
, 
_ªq_ty≥
, 
_r•_ty≥
) \

17 
_ªq_ty≥
 
__maybe_unu£d
 \

18 *
Ÿx2_mbox_Æloc_msg_
 ## 
	`_‚_«me
(
rvu
 *rvu, 
devid
) \

20 
_ªq_ty≥
 *
ªq
; \

22 
ªq
 = (
_ªq_ty≥
 *)
	`Ÿx2_mbox_Æloc_msg_r•
( \

23 &
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
devid
, (
_ªq_ty≥
), \

24 (
_r•_ty≥
)); \

25 i‡(!
ªq
) \

26  
NULL
; \

27 
ªq
->
hdr
.
sig
 = 
OTX2_MBOX_REQ_SIG
; \

28 
ªq
->
hdr
.
id
 = 
_id
; \

29  
ªq
; \

30 }

	)

32 
	gMBOX_UP_MCS_MESSAGES


33 #unde‡
M


35 
	$rvu_mbox_h™dÀr_mcs_£t_lmac_mode
(
rvu
 *rvu,

36 
mcs_£t_lmac_mode
 *
ªq
,

37 
msg_r•
 *
r•
)

39 
mcs
 *mcs;

41 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

42  
MCS_AF_ERR_INVALID_MCSID
;

44 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

46 i‡(
	`BIT_ULL
(
ªq
->
lmac_id
Ë& 
mcs
->
hw
->
lmac_bm≠
)

47 
	`mcs_£t_lmac_mode
(
mcs
, 
ªq
->
lmac_id
,Ñeq->
mode
);

50 
	}
}

52 
	$mcs_add_öå_wq_íåy
(
mcs
 *mcs, 
mcs_öå_evít
 *
evít
)

54 
mcs_öåq_íåy
 *
qíåy
;

55 
u16
 
pcifunc
 = 
evít
->pcifunc;

56 
rvu
 *rvu = 
mcs
->rvu;

57 
mcs_pfvf
 *
pfvf
;

60 i‡(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)

61 
pfvf
 = &
mcs
->
vf
[
	`rvu_gë_hwvf
(
rvu
, 
pcifunc
)];

63 
pfvf
 = &
mcs
->
pf
[
	`rvu_gë_pf
(
pcifunc
)];

65 
evít
->
öå_mask
 &
pfvf
->intr_mask;

68 i‡(!(
pfvf
->
öå_mask
 && 
evít
->intr_mask))

71 
qíåy
 = 
	`kmÆloc
((*qíåy), 
GFP_ATOMIC
);

72 i‡(!
qíåy
)

73  -
ENOMEM
;

75 
qíåy
->
öå_evít
 = *
evít
;

76 
	`•ö_lock
(&
rvu
->
mcs_öåq_lock
);

77 
	`li°_add_èû
(&
qíåy
->
node
, &
rvu
->
mcs_öåq_hód
);

78 
	`•ö_u∆ock
(&
rvu
->
mcs_öåq_lock
);

79 
	`queue_w‹k
(
rvu
->
mcs_öå_wq
, &rvu->
mcs_öå_w‹k
);

82 
	}
}

84 
	$mcs_nŸify_pfvf
(
mcs_öå_evít
 *
evít
, 
rvu
 *rvu)

86 
mcs_öå_öfo
 *
ªq
;

87 
îr
, 
pf
;

89 
pf
 = 
	`rvu_gë_pf
(
evít
->
pcifunc
);

91 
ªq
 = 
	`Ÿx2_mbox_Æloc_msg_mcs_öå_nŸify
(
rvu
, 
pf
);

92 i‡(!
ªq
)

93  -
ENOMEM
;

95 
ªq
->
mcs_id
 = 
evít
->mcs_id;

96 
ªq
->
öå_mask
 = 
evít
->intr_mask;

97 
ªq
->
ß_id
 = 
evít
->sa_id;

98 
ªq
->
hdr
.
pcifunc
 = 
evít
->pcifunc;

99 
ªq
->
lmac_id
 = 
evít
->lmac_id;

101 
	`Ÿx2_mbox_msg_£nd
(&
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
pf
);

102 
îr
 = 
	`Ÿx2_mbox_waô_f‹_r•
(&
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
pf
);

103 i‡(
îr
)

104 
	`dev_w¨n
(
rvu
->
dev
, "MCSÇŸifiˇti⁄Åÿp‡%d faûed\n", 
pf
);

107 
	}
}

109 
	$mcs_öå_h™dÀr_èsk
(
w‹k_°ru˘
 *
w‹k
)

111 
rvu
 *rvu = 
	`c⁄èöî_of
(
w‹k
, rvu, 
mcs_öå_w‹k
);

112 
mcs_öåq_íåy
 *
qíåy
;

113 
mcs_öå_evít
 *
evít
;

114 
Êags
;

117 
	`•ö_lock_úqßve
(&
rvu
->
mcs_öåq_lock
, 
Êags
);

118 
qíåy
 = 
	`li°_fú°_íåy_‹_nuŒ
(&
rvu
->
mcs_öåq_hód
,

119 
mcs_öåq_íåy
,

120 
node
);

121 i‡(
qíåy
)

122 
	`li°_dñ
(&
qíåy
->
node
);

124 
	`•ö_u∆ock_úqª°‹e
(&
rvu
->
mcs_öåq_lock
, 
Êags
);

125 i‡(!
qíåy
)

128 
evít
 = &
qíåy
->
öå_evít
;

130 
	`mcs_nŸify_pfvf
(
evít
, 
rvu
);

131 
	`k‰ì
(
qíåy
);

133 
	}
}

135 
	$rvu_mbox_h™dÀr_mcs_öå_cfg
(
rvu
 *rvu,

136 
mcs_öå_cfg
 *
ªq
,

137 
msg_r•
 *
r•
)

139 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

140 
mcs_pfvf
 *
pfvf
;

141 
mcs
 *mcs;

143 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

144  
MCS_AF_ERR_INVALID_MCSID
;

146 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

149 i‡(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)

150 
pfvf
 = &
mcs
->
vf
[
	`rvu_gë_hwvf
(
rvu
, 
pcifunc
)];

152 
pfvf
 = &
mcs
->
pf
[
	`rvu_gë_pf
(
pcifunc
)];

154 
mcs
->
pf_m≠
[0] = 
pcifunc
;

155 
pfvf
->
öå_mask
 = 
ªq
->intr_mask;

158 
	}
}

160 
	$rvu_mbox_h™dÀr_mcs_gë_hw_öfo
(
rvu
 *rvu,

161 
msg_ªq
 *
ªq
,

162 
mcs_hw_öfo
 *
r•
)

164 
mcs
 *mcs;

166 i‡(!
rvu
->
mcs_blk_˙t
)

167  
MCS_AF_ERR_NOT_MAPPED
;

170 
mcs
 = 
	`mcs_gë_pd©a
(0);

171 
r•
->
num_mcs_blks
 = 
rvu
->
mcs_blk_˙t
;

172 
r•
->
tˇm_íåõs
 = 
mcs
->
hw
->tcam_entries;

173 
r•
->
£cy_íåõs
 = 
mcs
->
hw
->secy_entries;

174 
r•
->
sc_íåõs
 = 
mcs
->
hw
->sc_entries;

175 
r•
->
ß_íåõs
 = 
mcs
->
hw
->sa_entries;

177 
	}
}

179 
	$rvu_mbox_h™dÀr_mcs_p‹t_ª£t
(
rvu
 *rvu, 
mcs_p‹t_ª£t_ªq
 *
ªq
,

180 
msg_r•
 *
r•
)

182 
mcs
 *mcs;

184 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

185  
MCS_AF_ERR_INVALID_MCSID
;

187 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

189 
	`mcs_ª£t_p‹t
(
mcs
, 
ªq
->
p‹t_id
,Ñeq->
ª£t
);

192 
	}
}

194 
	$rvu_mbox_h™dÀr_mcs_˛ór_°©s
(
rvu
 *rvu,

195 
mcs_˛ór_°©s
 *
ªq
,

196 
msg_r•
 *
r•
)

198 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

199 
mcs
 *mcs;

201 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

202  
MCS_AF_ERR_INVALID_MCSID
;

204 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

206 
	`muãx_lock
(&
mcs
->
°©s_lock
);

207 i‡(
ªq
->
Æl
)

208 
	`mcs_˛ór_Æl_°©s
(
mcs
, 
pcifunc
, 
ªq
->
dú
);

210 
	`mcs_˛ór_°©s
(
mcs
, 
ªq
->
ty≥
,Ñeq->
id
,Ñeq->
dú
);

212 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

214 
	}
}

216 
	$rvu_mbox_h™dÀr_mcs_gë_Êowid_°©s
(
rvu
 *rvu,

217 
mcs_°©s_ªq
 *
ªq
,

218 
mcs_Êowid_°©s
 *
r•
)

220 
mcs
 *mcs;

222 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

223  
MCS_AF_ERR_INVALID_MCSID
;

225 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

231 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

232 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
åue
);

234 
	`muãx_lock
(&
mcs
->
°©s_lock
);

235 
	`mcs_gë_Êowid_°©s
(
mcs
, 
r•
, 
ªq
->
id
,Ñeq->
dú
);

236 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

241 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

242 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
Ál£
);

245 
	}
}

247 
	$rvu_mbox_h™dÀr_mcs_gë_£cy_°©s
(
rvu
 *rvu,

248 
mcs_°©s_ªq
 *
ªq
,

249 
mcs_£cy_°©s
 *
r•
)

250 { 
mcs
 *mcs;

252 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

253  
MCS_AF_ERR_INVALID_MCSID
;

255 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

261 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

262 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
åue
);

264 
	`muãx_lock
(&
mcs
->
°©s_lock
);

266 i‡(
ªq
->
dú
 =
MCS_RX
)

267 
	`mcs_gë_rx_£cy_°©s
(
mcs
, 
r•
, 
ªq
->
id
);

269 
	`mcs_gë_tx_£cy_°©s
(
mcs
, 
r•
, 
ªq
->
id
);

271 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

276 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

277 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
Ál£
);

280 
	}
}

282 
	$rvu_mbox_h™dÀr_mcs_gë_sc_°©s
(
rvu
 *rvu,

283 
mcs_°©s_ªq
 *
ªq
,

284 
mcs_sc_°©s
 *
r•
)

286 
mcs
 *mcs;

288 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

289  
MCS_AF_ERR_INVALID_MCSID
;

291 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

297 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

298 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
åue
);

300 
	`muãx_lock
(&
mcs
->
°©s_lock
);

301 
	`mcs_gë_sc_°©s
(
mcs
, 
r•
, 
ªq
->
id
,Ñeq->
dú
);

302 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

307 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

308 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
Ál£
);

311 
	}
}

313 
	$rvu_mbox_h™dÀr_mcs_gë_ß_°©s
(
rvu
 *rvu,

314 
mcs_°©s_ªq
 *
ªq
,

315 
mcs_ß_°©s
 *
r•
)

317 
mcs
 *mcs;

319 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

320  
MCS_AF_ERR_INVALID_MCSID
;

322 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

328 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

329 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
åue
);

331 
	`muãx_lock
(&
mcs
->
°©s_lock
);

332 
	`mcs_gë_ß_°©s
(
mcs
, 
r•
, 
ªq
->
id
,Ñeq->
dú
);

333 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

338 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

339 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
Ál£
);

342 
	}
}

344 
	$rvu_mbox_h™dÀr_mcs_gë_p‹t_°©s
(
rvu
 *rvu,

345 
mcs_°©s_ªq
 *
ªq
,

346 
mcs_p‹t_°©s
 *
r•
)

348 
mcs
 *mcs;

350 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

351  
MCS_AF_ERR_INVALID_MCSID
;

353 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

359 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

360 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
åue
);

362 
	`muãx_lock
(&
mcs
->
°©s_lock
);

363 
	`mcs_gë_p‹t_°©s
(
mcs
, 
r•
, 
ªq
->
id
,Ñeq->
dú
);

364 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

369 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

370 
	`mcs_£t_f‹˚_˛k_í
(
mcs
, 
Ál£
);

373 
	}
}

375 
	$rvu_mbox_h™dÀr_mcs_£t_a˘ive_lmac
(
rvu
 *rvu,

376 
mcs_£t_a˘ive_lmac
 *
ªq
,

377 
msg_r•
 *
r•
)

379 
mcs
 *mcs;

381 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

382  
MCS_AF_ERR_INVALID_MCSID
;

384 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

385 i‡(!
mcs
)

386  
MCS_AF_ERR_NOT_MAPPED
;

388 
mcs
->
hw
->
lmac_bm≠
 = 
ªq
->lmac_bmap;

389 
	`mcs_£t_lmac_ch™√ls
(
ªq
->
mcs_id
,Ñeq->
ch™_ba£
);

391 
	}
}

393 
	$rvu_mbox_h™dÀr_mcs_p‹t_cfg_£t
(
rvu
 *rvu, 
mcs_p‹t_cfg_£t_ªq
 *
ªq
,

394 
msg_r•
 *
r•
)

396 
mcs
 *mcs;

398 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

399  
MCS_AF_ERR_INVALID_MCSID
;

401 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

403 i‡(
mcs
->
hw
->
lmac_˙t
 <
ªq
->
p‹t_id
 || !(mcs->hw->
lmac_bm≠
 & 
	`BIT_ULL
(req->port_id)))

404  -
EINVAL
;

406 
	`mcs_£t_p‹t_cfg
(
mcs
, 
ªq
);

409 
	}
}

411 
	$rvu_mbox_h™dÀr_mcs_p‹t_cfg_gë
(
rvu
 *rvu, 
mcs_p‹t_cfg_gë_ªq
 *
ªq
,

412 
mcs_p‹t_cfg_gë_r•
 *
r•
)

414 
mcs
 *mcs;

416 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

417  
MCS_AF_ERR_INVALID_MCSID
;

419 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

421 i‡(
mcs
->
hw
->
lmac_˙t
 <
ªq
->
p‹t_id
 || !(mcs->hw->
lmac_bm≠
 & 
	`BIT_ULL
(req->port_id)))

422  -
EINVAL
;

424 
	`mcs_gë_p‹t_cfg
(
mcs
, 
ªq
, 
r•
);

427 
	}
}

429 
	$rvu_mbox_h™dÀr_mcs_cu°om_èg_cfg_gë
(
rvu
 *rvu, 
mcs_cu°om_èg_cfg_gë_ªq
 *
ªq
,

430 
mcs_cu°om_èg_cfg_gë_r•
 *
r•
)

432 
mcs
 *mcs;

434 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

435  
MCS_AF_ERR_INVALID_MCSID
;

437 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

439 
	`mcs_gë_cu°om_èg_cfg
(
mcs
, 
ªq
, 
r•
);

442 
	}
}

444 
	$rvu_mcs_Êr_h™dÀr
(
rvu
 *rvu, 
u16
 
pcifunc
)

446 
mcs
 *mcs;

447 
mcs_id
;

450 i‡(
rvu
->
mcs_blk_˙t
 > 1) {

451 
mcs_id
 = 0; mcs_id < 
rvu
->
mcs_blk_˙t
; mcs_id++) {

452 
mcs
 = 
	`mcs_gë_pd©a
(
mcs_id
);

453 
	`mcs_‰ì_Æl_r§c
(
mcs
, 
MCS_RX
, 
pcifunc
);

454 
	`mcs_‰ì_Æl_r§c
(
mcs
, 
MCS_TX
, 
pcifunc
);

458 
mcs
 = 
	`mcs_gë_pd©a
(0);

459 
	`mcs_‰ì_Æl_r§c
(
mcs
, 
MCS_RX
, 
pcifunc
);

460 
	`mcs_‰ì_Æl_r§c
(
mcs
, 
MCS_TX
, 
pcifunc
);

463 
	}
}

465 
	$rvu_mbox_h™dÀr_mcs_Êowid_ía_íåy
(
rvu
 *rvu,

466 
mcs_Êowid_ía_dis_íåy
 *
ªq
,

467 
msg_r•
 *
r•
)

469 
mcs
 *mcs;

471 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

472  
MCS_AF_ERR_INVALID_MCSID
;

474 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

475 
	`mcs_ía_dis_Êowid_íåy
(
mcs
, 
ªq
->
Êow_id
,Ñeq->
dú
,Ñeq->
ía
);

477 
	}
}

479 
	$rvu_mbox_h™dÀr_mcs_≤_èbÀ_wrôe
(
rvu
 *rvu,

480 
mcs_≤_èbÀ_wrôe_ªq
 *
ªq
,

481 
msg_r•
 *
r•
)

483 
mcs
 *mcs;

485 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

486  
MCS_AF_ERR_INVALID_MCSID
;

488 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

489 
	`mcs_≤_èbÀ_wrôe
(
mcs
, 
ªq
->
≤_id
,Ñeq->
√xt_≤
,Ñeq->
dú
);

491 
	}
}

493 
	$rvu_mbox_h™dÀr_mcs_£t_≤_thªshﬁd
(
rvu
 *rvu,

494 
mcs_£t_≤_thªshﬁd
 *
ªq
,

495 
msg_r•
 *
r•
)

497 
mcs
 *mcs;

499 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

500  
MCS_AF_ERR_INVALID_MCSID
;

502 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

504 
	`mcs_≤_thªshﬁd_£t
(
mcs
, 
ªq
);

507 
	}
}

509 
	$rvu_mbox_h™dÀr_mcs_rx_sc_ß_m≠_wrôe
(
rvu
 *rvu,

510 
mcs_rx_sc_ß_m≠
 *
ªq
,

511 
msg_r•
 *
r•
)

513 
mcs
 *mcs;

515 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

516  
MCS_AF_ERR_INVALID_MCSID
;

518 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

519 
mcs
->
mcs_›s
->
	`mcs_rx_ß_mem_m≠_wrôe
(mcs, 
ªq
);

521 
	}
}

523 
	$rvu_mbox_h™dÀr_mcs_tx_sc_ß_m≠_wrôe
(
rvu
 *rvu,

524 
mcs_tx_sc_ß_m≠
 *
ªq
,

525 
msg_r•
 *
r•
)

527 
mcs
 *mcs;

529 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

530  
MCS_AF_ERR_INVALID_MCSID
;

532 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

533 
mcs
->
mcs_›s
->
	`mcs_tx_ß_mem_m≠_wrôe
(mcs, 
ªq
);

534 
mcs
->
tx_ß_a˘ive
[
ªq
->
sc_id
] =Ñeq->tx_sa_active;

537 
	}
}

539 
	$rvu_mbox_h™dÀr_mcs_ß_∂cy_wrôe
(
rvu
 *rvu,

540 
mcs_ß_∂cy_wrôe_ªq
 *
ªq
,

541 
msg_r•
 *
r•
)

543 
mcs
 *mcs;

544 
i
;

546 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

547  
MCS_AF_ERR_INVALID_MCSID
;

549 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

551 
i
 = 0; i < 
ªq
->
ß_˙t
; i++)

552 
	`mcs_ß_∂cy_wrôe
(
mcs
, &
ªq
->
∂cy
[
i
][0],

553 
ªq
->
ß_ödex
[
i
],Ñeq->
dú
);

555 
	}
}

557 
	$rvu_mbox_h™dÀr_mcs_rx_sc_ˇm_wrôe
(
rvu
 *rvu,

558 
mcs_rx_sc_ˇm_wrôe_ªq
 *
ªq
,

559 
msg_r•
 *
r•
)

561 
mcs
 *mcs;

563 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

564  
MCS_AF_ERR_INVALID_MCSID
;

566 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

567 
	`mcs_rx_sc_ˇm_wrôe
(
mcs
, 
ªq
->
sci
,Ñeq->
£cy_id
,Ñeq->
sc_id
);

569 
	}
}

571 
	$rvu_mbox_h™dÀr_mcs_£cy_∂cy_wrôe
(
rvu
 *rvu,

572 
mcs_£cy_∂cy_wrôe_ªq
 *
ªq
,

573 
msg_r•
 *
r•
)

574 { 
mcs
 *mcs;

576 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

577  
MCS_AF_ERR_INVALID_MCSID
;

579 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

581 
	`mcs_£cy_∂cy_wrôe
(
mcs
, 
ªq
->
∂cy
,

582 
ªq
->
£cy_id
,Ñeq->
dú
);

584 
	}
}

586 
	$rvu_mbox_h™dÀr_mcs_Êowid_íåy_wrôe
(
rvu
 *rvu,

587 
mcs_Êowid_íåy_wrôe_ªq
 *
ªq
,

588 
msg_r•
 *
r•
)

590 
£cy_mem_m≠
 
m≠
;

591 
mcs
 *mcs;

593 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

594  
MCS_AF_ERR_INVALID_MCSID
;

596 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

599 
	`mcs_Êowid_íåy_wrôe
(
mcs
, 
ªq
->
d©a
,Ñeq->
mask
,

600 
ªq
->
Êow_id
,Ñeq->
dú
);

601 
m≠
.
£cy
 = 
ªq
->
£cy_id
;

602 
m≠
.
sc
 = 
ªq
->
sc_id
;

603 
m≠
.
˘æ_pkt
 = 
ªq
->ctrl_pkt;

604 
m≠
.
Êow_id
 = 
ªq
->flow_id;

605 
m≠
.
sci
 = 
ªq
->sci;

606 
mcs
->
mcs_›s
->
	`mcs_Êowid_£cy_m≠
(mcs, &
m≠
, 
ªq
->
dú
);

607 i‡(
ªq
->
ía
)

608 
	`mcs_ía_dis_Êowid_íåy
(
mcs
, 
ªq
->
Êow_id
,

609 
ªq
->
dú
, 
åue
);

611 
	}
}

613 
	$rvu_mbox_h™dÀr_mcs_‰ì_ªsour˚s
(
rvu
 *rvu,

614 
mcs_‰ì_r§c_ªq
 *
ªq
,

615 
msg_r•
 *
r•
)

617 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

618 
mcs_r§c_m≠
 *
m≠
;

619 
mcs
 *mcs;

620 
rc
;

622 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

623  
MCS_AF_ERR_INVALID_MCSID
;

625 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

627 i‡(
ªq
->
dú
 =
MCS_RX
)

628 
m≠
 = &
mcs
->
rx
;

630 
m≠
 = &
mcs
->
tx
;

632 
	`muãx_lock
(&
rvu
->
r§c_lock
);

634 i‡(
ªq
->
Æl
) {

635 
rc
 = 
	`mcs_‰ì_Æl_r§c
(
mcs
, 
ªq
->
dú
, 
pcifunc
);

636 
exô
;

639 
ªq
->
r§c_ty≥
) {

640 
MCS_RSRC_TYPE_FLOWID
:

641 
rc
 = 
	`mcs_‰ì_r§c
(&
m≠
->
Êow_ids
, m≠->
Êowid2pf_m≠
, 
ªq
->
r§c_id
, 
pcifunc
);

642 
	`mcs_ía_dis_Êowid_íåy
(
mcs
, 
ªq
->
r§c_id
,Ñeq->
dú
, 
Ál£
);

644 
MCS_RSRC_TYPE_SECY
:

645 
rc
 = 
	`mcs_‰ì_r§c
(&
m≠
->
£cy
, m≠->
£cy2pf_m≠
, 
ªq
->
r§c_id
, 
pcifunc
);

646 
	`mcs_˛ór_£cy_∂cy
(
mcs
, 
ªq
->
r§c_id
,Ñeq->
dú
);

648 
MCS_RSRC_TYPE_SC
:

649 
rc
 = 
	`mcs_‰ì_r§c
(&
m≠
->
sc
, m≠->
sc2pf_m≠
, 
ªq
->
r§c_id
, 
pcifunc
);

651 i‡(
ªq
->
dú
 =
MCS_RX
)

652 
	`mcs_ía_dis_sc_ˇm_íåy
(
mcs
, 
ªq
->
r§c_id
, 
Ál£
);

654 
MCS_RSRC_TYPE_SA
:

655 
rc
 = 
	`mcs_‰ì_r§c
(&
m≠
->
ß
, m≠->
ß2pf_m≠
, 
ªq
->
r§c_id
, 
pcifunc
);

658 
exô
:

659 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

660  
rc
;

661 
	}
}

663 
	$rvu_mbox_h™dÀr_mcs_Æloc_ªsour˚s
(
rvu
 *rvu,

664 
mcs_Æloc_r§c_ªq
 *
ªq
,

665 
mcs_Æloc_r§c_r•
 *
r•
)

667 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

668 
mcs_r§c_m≠
 *
m≠
;

669 
mcs
 *mcs;

670 
r§c_id
, 
i
;

672 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

673  
MCS_AF_ERR_INVALID_MCSID
;

675 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

677 i‡(
ªq
->
dú
 =
MCS_RX
)

678 
m≠
 = &
mcs
->
rx
;

680 
m≠
 = &
mcs
->
tx
;

682 
	`muãx_lock
(&
rvu
->
r§c_lock
);

684 i‡(
ªq
->
Æl
) {

685 
r§c_id
 = 
	`mcs_Æloc_Æl_r§c
(
mcs
, &
r•
->
Êow_ids
[0],

686 &
r•
->
£cy_ids
[0],

687 &
r•
->
sc_ids
[0],

688 &
r•
->
ß_ids
[0],

689 &
r•
->
ß_ids
[1],

690 
pcifunc
, 
ªq
->
dú
);

691 
exô
;

694 
ªq
->
r§c_ty≥
) {

695 
MCS_RSRC_TYPE_FLOWID
:

696 
i
 = 0; i < 
ªq
->
r§c_˙t
; i++) {

697 
r§c_id
 = 
	`mcs_Æloc_r§c
(&
m≠
->
Êow_ids
, m≠->
Êowid2pf_m≠
, 
pcifunc
);

698 i‡(
r§c_id
 < 0)

699 
exô
;

700 
r•
->
Êow_ids
[
i
] = 
r§c_id
;

701 
r•
->
r§c_˙t
++;

704 
MCS_RSRC_TYPE_SECY
:

705 
i
 = 0; i < 
ªq
->
r§c_˙t
; i++) {

706 
r§c_id
 = 
	`mcs_Æloc_r§c
(&
m≠
->
£cy
, m≠->
£cy2pf_m≠
, 
pcifunc
);

707 i‡(
r§c_id
 < 0)

708 
exô
;

709 
r•
->
£cy_ids
[
i
] = 
r§c_id
;

710 
r•
->
r§c_˙t
++;

713 
MCS_RSRC_TYPE_SC
:

714 
i
 = 0; i < 
ªq
->
r§c_˙t
; i++) {

715 
r§c_id
 = 
	`mcs_Æloc_r§c
(&
m≠
->
sc
, m≠->
sc2pf_m≠
, 
pcifunc
);

716 i‡(
r§c_id
 < 0)

717 
exô
;

718 
r•
->
sc_ids
[
i
] = 
r§c_id
;

719 
r•
->
r§c_˙t
++;

722 
MCS_RSRC_TYPE_SA
:

723 
i
 = 0; i < 
ªq
->
r§c_˙t
; i++) {

724 
r§c_id
 = 
	`mcs_Æloc_r§c
(&
m≠
->
ß
, m≠->
ß2pf_m≠
, 
pcifunc
);

725 i‡(
r§c_id
 < 0)

726 
exô
;

727 
r•
->
ß_ids
[
i
] = 
r§c_id
;

728 
r•
->
r§c_˙t
++;

733 
r•
->
r§c_ty≥
 = 
ªq
->rsrc_type;

734 
r•
->
dú
 = 
ªq
->dir;

735 
r•
->
mcs_id
 = 
ªq
->mcs_id;

736 
r•
->
Æl
 = 
ªq
->all;

738 
exô
:

739 i‡(
r§c_id
 < 0)

740 
	`dev_îr
(
rvu
->
dev
, "FaûedÅÿÆloˇãÅhêmc†ªsour˚†f‹ PCIFUNC:%d\n", 
pcifunc
);

741 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

743 
	}
}

745 
	$rvu_mbox_h™dÀr_mcs_Æloc_˘æ_pkt_ruÀ
(
rvu
 *rvu,

746 
mcs_Æloc_˘æ_pkt_ruÀ_ªq
 *
ªq
,

747 
mcs_Æloc_˘æ_pkt_ruÀ_r•
 *
r•
)

749 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

750 
mcs_r§c_m≠
 *
m≠
;

751 
mcs
 *mcs;

752 
r§c_id
;

753 
u16
 
off£t
;

755 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

756  
MCS_AF_ERR_INVALID_MCSID
;

758 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

760 
m≠
 = (
ªq
->
dú
 =
MCS_RX
Ë? &
mcs
->
rx
 : &mcs->
tx
;

762 
	`muãx_lock
(&
rvu
->
r§c_lock
);

764 
ªq
->
ruÀ_ty≥
) {

765 
MCS_CTRL_PKT_RULE_TYPE_ETH
:

766 
off£t
 = 
MCS_CTRLPKT_ETYPE_RULE_OFFSET
;

768 
MCS_CTRL_PKT_RULE_TYPE_DA
:

769 
off£t
 = 
MCS_CTRLPKT_DA_RULE_OFFSET
;

771 
MCS_CTRL_PKT_RULE_TYPE_RANGE
:

772 
off£t
 = 
MCS_CTRLPKT_DA_RANGE_RULE_OFFSET
;

774 
MCS_CTRL_PKT_RULE_TYPE_COMBO
:

775 
off£t
 = 
MCS_CTRLPKT_COMBO_RULE_OFFSET
;

777 
MCS_CTRL_PKT_RULE_TYPE_MAC
:

778 
off£t
 = 
MCS_CTRLPKT_MAC_EN_RULE_OFFSET
;

782 
r§c_id
 = 
	`mcs_Æloc_˘æpkåuÀ
(&
m≠
->
˘æpkåuÀ
, m≠->
˘æpkåuÀ2pf_m≠
, 
off£t
,

783 
pcifunc
);

784 i‡(
r§c_id
 < 0)

785 
exô
;

787 
r•
->
ruÀ_idx
 = 
r§c_id
;

788 
r•
->
ruÀ_ty≥
 = 
ªq
->rule_type;

789 
r•
->
dú
 = 
ªq
->dir;

790 
r•
->
mcs_id
 = 
ªq
->mcs_id;

792 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

794 
exô
:

795 i‡(
r§c_id
 < 0)

796 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocateÅhe mcs ctrlÖktÑule for PCIFUNC:%d\n",

797 
pcifunc
);

798 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

799  
r§c_id
;

800 
	}
}

802 
	$rvu_mbox_h™dÀr_mcs_‰ì_˘æ_pkt_ruÀ
(
rvu
 *rvu,

803 
mcs_‰ì_˘æ_pkt_ruÀ_ªq
 *
ªq
,

804 
msg_r•
 *
r•
)

806 
mcs
 *mcs;

807 
rc
;

809 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

810  
MCS_AF_ERR_INVALID_MCSID
;

812 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

814 
	`muãx_lock
(&
rvu
->
r§c_lock
);

816 
rc
 = 
	`mcs_‰ì_˘æpkåuÀ
(
mcs
, 
ªq
);

818 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

820  
rc
;

821 
	}
}

823 
	$rvu_mbox_h™dÀr_mcs_˘æ_pkt_ruÀ_wrôe
(
rvu
 *rvu,

824 
mcs_˘æ_pkt_ruÀ_wrôe_ªq
 *
ªq
,

825 
msg_r•
 *
r•
)

827 
mcs
 *mcs;

828 
rc
;

830 i‡(
ªq
->
mcs_id
 >
rvu
->
mcs_blk_˙t
)

831  
MCS_AF_ERR_INVALID_MCSID
;

833 
mcs
 = 
	`mcs_gë_pd©a
(
ªq
->
mcs_id
);

835 
rc
 = 
	`mcs_˘æpkåuÀ_wrôe
(
mcs
, 
ªq
);

837  
rc
;

838 
	}
}

840 
	$rvu_mcs_£t_lmac_bm≠
(
rvu
 *rvu)

842 
mcs
 *mc†
	`mcs_gë_pd©a
(0);

843 
lmac_bm≠
;

844 
cgx
, 
lmac
, 
p‹t
;

846 
p‹t
 = 0;Ö‹à< 
mcs
->
hw
->
lmac_˙t
;Öort++) {

847 
cgx
 = 
p‹t
 / 
rvu
->
hw
->
lmac_≥r_cgx
;

848 
lmac
 = 
p‹t
 % 
rvu
->
hw
->
lmac_≥r_cgx
;

849 i‡(!
	`is_lmac_vÆid
(
	`rvu_cgx_pd©a
(
cgx
, 
rvu
), 
lmac
))

851 
	`£t_bô
(
p‹t
, &
lmac_bm≠
);

853 
mcs
->
hw
->
lmac_bm≠
 =Ümac_bmap;

854 
	}
}

856 
	$rvu_mcs_öô
(
rvu
 *rvu)

858 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

859 
lmac
, 
îr
 = 0, 
mcs_id
;

860 
mcs
 *mcs;

862 
rvu
->
mcs_blk_˙t
 = 
	`mcs_gë_blk˙t
();

864 i‡(!
rvu
->
mcs_blk_˙t
)

868 i‡(
rvu
->
mcs_blk_˙t
 == 1) {

869 
îr
 = 
	`mcs_£t_lmac_ch™√ls
(0, 
hw
->
cgx_ch™_ba£
);

870 i‡(
îr
)

871  
îr
;

873 
	`rvu_mcs_£t_lmac_bm≠
(
rvu
);

877 
mcs_id
 = 0; mcs_id < 
rvu
->
mcs_blk_˙t
; mcs_id++) {

878 
mcs
 = 
	`mcs_gë_pd©a
(
mcs_id
);

879 
	`mcs_ö°Æl_Êowid_by∑ss_íåy
(
mcs
);

880 
lmac
 = 0;Üma¯< 
mcs
->
hw
->
lmac_˙t
;Ümac++)

881 
	`mcs_£t_lmac_mode
(
mcs
, 
lmac
, 0);

883 
mcs
->
rvu
 =Ñvu;

886 
mcs
->
pf
 = 
	`devm_kˇŒoc
(mcs->
dev
, 
hw
->
tŸÆ_pfs
,

887 (
mcs_pfvf
), 
GFP_KERNEL
);

888 i‡(!
mcs
->
pf
)

889  -
ENOMEM
;

891 
mcs
->
vf
 = 
	`devm_kˇŒoc
(mcs->
dev
, 
hw
->
tŸÆ_vfs
,

892 (
mcs_pfvf
), 
GFP_KERNEL
);

893 i‡(!
mcs
->
vf
)

894  -
ENOMEM
;

898 
	`INIT_LIST_HEAD
(&
rvu
->
mcs_öåq_hód
);

899 
	`INIT_WORK
(&
rvu
->
mcs_öå_w‹k
, 
mcs_öå_h™dÀr_èsk
);

900 
rvu
->
mcs_öå_wq
 = 
	`Æloc_w‹kqueue
("mcs_intr_wq", 0, 0);

901 i‡(!
rvu
->
mcs_öå_wq
) {

902 
	`dev_îr
(
rvu
->
dev
, "mcsálloc workqueue failed\n");

903  -
ENOMEM
;

906  
îr
;

907 
	}
}

909 
	$rvu_mcs_exô
(
rvu
 *rvu)

911 i‡(!
rvu
->
mcs_öå_wq
)

914 
	`Êush_w‹kqueue
(
rvu
->
mcs_öå_wq
);

915 
	`de°roy_w‹kqueue
(
rvu
->
mcs_öå_wq
);

916 
rvu
->
mcs_öå_wq
 = 
NULL
;

917 
	}
}

	@npc.h

8 #i‚de‡
NPC_H


9 
	#NPC_H


	)

11 
	#NPC_KEX_CHAN_MASK
 0xFFFULL

	)

13 
	#SET_KEX_LD
(
ötf
, 
lid
, 
…y≥
, 
ld
, 
cfg
) \

14 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, \

15 
	`NPC_AF_INTFX_LIDX_LTX_LDX_CFG
(
ötf
, 
lid
, 
…y≥
, 
ld
), 
cfg
)

	)

17 
	#SET_KEX_LDFLAGS
(
ötf
, 
ld
, 
Êags
, 
cfg
) \

18 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, \

19 
	`NPC_AF_INTFX_LDATAX_FLAGSX_CFG
(
ötf
, 
ld
, 
Êags
), 
cfg
)

	)

21 
	eNPC_LID_E
 {

22 
	mNPC_LID_LA
 = 0,

23 
	mNPC_LID_LB
,

24 
	mNPC_LID_LC
,

25 
	mNPC_LID_LD
,

26 
	mNPC_LID_LE
,

27 
	mNPC_LID_LF
,

28 
	mNPC_LID_LG
,

29 
	mNPC_LID_LH
,

32 
	#NPC_LT_NA
 0

	)

34 
	e≈c_kpu_œ_…y≥
 {

35 
	mNPC_LT_LA_8023
 = 1,

36 
	mNPC_LT_LA_ETHER
,

37 
	mNPC_LT_LA_IH_NIX_ETHER
,

38 
	mNPC_LT_LA_HIGIG2_ETHER
 = 7,

39 
	mNPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

40 
	mNPC_LT_LA_CUSTOM_L2_90B_ETHER
,

41 
	mNPC_LT_LA_CPT_HDR
,

42 
	mNPC_LT_LA_CUSTOM_L2_24B_ETHER
,

43 
	mNPC_LT_LA_CUSTOM_PRE_L2_ETHER
,

44 
	mNPC_LT_LA_CUSTOM0
 = 0xE,

45 
	mNPC_LT_LA_CUSTOM1
 = 0xF,

48 
	e≈c_kpu_lb_…y≥
 {

49 
	mNPC_LT_LB_ETAG
 = 1,

50 
	mNPC_LT_LB_CTAG
,

51 
	mNPC_LT_LB_STAG_QINQ
,

52 
	mNPC_LT_LB_BTAG
,

53 
	mNPC_LT_LB_PPPOE
,

54 
	mNPC_LT_LB_DSA
,

55 
	mNPC_LT_LB_DSA_VLAN
,

56 
	mNPC_LT_LB_EDSA
,

57 
	mNPC_LT_LB_EDSA_VLAN
,

58 
	mNPC_LT_LB_EXDSA
,

59 
	mNPC_LT_LB_EXDSA_VLAN
,

60 
	mNPC_LT_LB_FDSA
,

61 
	mNPC_LT_LB_VLAN_EXDSA
,

62 
	mNPC_LT_LB_CUSTOM0
 = 0xE,

63 
	mNPC_LT_LB_CUSTOM1
 = 0xF,

70 
	e≈c_kpu_lc_…y≥
 {

71 
	mNPC_LT_LC_PTP
 = 1,

72 
	mNPC_LT_LC_IP
,

73 
	mNPC_LT_LC_IP_OPT
,

74 
	mNPC_LT_LC_IP6
,

75 
	mNPC_LT_LC_IP6_EXT
,

76 
	mNPC_LT_LC_ARP
,

77 
	mNPC_LT_LC_RARP
,

78 
	mNPC_LT_LC_MPLS
,

79 
	mNPC_LT_LC_NSH
,

80 
	mNPC_LT_LC_FCOE
,

81 
	mNPC_LT_LC_NGIO
,

82 
	mNPC_LT_LC_CUSTOM0
 = 0xE,

83 
	mNPC_LT_LC_CUSTOM1
 = 0xF,

89 
	e≈c_kpu_ld_…y≥
 {

90 
	mNPC_LT_LD_TCP
 = 1,

91 
	mNPC_LT_LD_UDP
,

92 
	mNPC_LT_LD_SCTP
 = 4,

93 
	mNPC_LT_LD_ICMP6
,

94 
	mNPC_LT_LD_CUSTOM0
,

95 
	mNPC_LT_LD_CUSTOM1
,

96 
	mNPC_LT_LD_IGMP
 = 8,

97 
	mNPC_LT_LD_AH
,

98 
	mNPC_LT_LD_GRE
,

99 
	mNPC_LT_LD_NVGRE
,

100 
	mNPC_LT_LD_NSH
,

101 
	mNPC_LT_LD_TU_MPLS_IN_NSH
,

102 
	mNPC_LT_LD_TU_MPLS_IN_IP
,

103 
	mNPC_LT_LD_ICMP
,

106 
	e≈c_kpu_À_…y≥
 {

107 
	mNPC_LT_LE_VXLAN
 = 1,

108 
	mNPC_LT_LE_GENEVE
,

109 
	mNPC_LT_LE_ESP
,

110 
	mNPC_LT_LE_GTPU
 = 4,

111 
	mNPC_LT_LE_VXLANGPE
,

112 
	mNPC_LT_LE_GTPC
,

113 
	mNPC_LT_LE_NSH
,

114 
	mNPC_LT_LE_TU_MPLS_IN_GRE
,

115 
	mNPC_LT_LE_TU_NSH_IN_GRE
,

116 
	mNPC_LT_LE_TU_MPLS_IN_UDP
,

117 
	mNPC_LT_LE_CUSTOM0
 = 0xE,

118 
	mNPC_LT_LE_CUSTOM1
 = 0xF,

121 
	e≈c_kpu_lf_…y≥
 {

122 
	mNPC_LT_LF_TU_ETHER
 = 1,

123 
	mNPC_LT_LF_TU_PPP
,

124 
	mNPC_LT_LF_TU_MPLS_IN_VXLANGPE
,

125 
	mNPC_LT_LF_TU_NSH_IN_VXLANGPE
,

126 
	mNPC_LT_LF_TU_MPLS_IN_NSH
,

127 
	mNPC_LT_LF_TU_3RD_NSH
,

128 
	mNPC_LT_LF_CUSTOM0
 = 0xE,

129 
	mNPC_LT_LF_CUSTOM1
 = 0xF,

132 
	e≈c_kpu_lg_…y≥
 {

133 
	mNPC_LT_LG_TU_IP
 = 1,

134 
	mNPC_LT_LG_TU_IP6
,

135 
	mNPC_LT_LG_TU_ARP
,

136 
	mNPC_LT_LG_TU_ETHER_IN_NSH
,

137 
	mNPC_LT_LG_CUSTOM0
 = 0xE,

138 
	mNPC_LT_LG_CUSTOM1
 = 0xF,

144 
	e≈c_kpu_lh_…y≥
 {

145 
	mNPC_LT_LH_TU_TCP
 = 1,

146 
	mNPC_LT_LH_TU_UDP
,

147 
	mNPC_LT_LH_TU_SCTP
 = 4,

148 
	mNPC_LT_LH_TU_ICMP6
,

149 
	mNPC_LT_LH_CUSTOM0
,

150 
	mNPC_LT_LH_CUSTOM1
,

151 
	mNPC_LT_LH_TU_IGMP
 = 8,

152 
	mNPC_LT_LH_TU_ESP
,

153 
	mNPC_LT_LH_TU_AH
,

154 
	mNPC_LT_LH_TU_ICMP
 = 0xF,

162 
	#NPC_UNRESERVED_PKIND_COUNT
 
NPC_RX_CPT_HDR_PTP_PKIND


	)

164 
	e≈c_pköd_ty≥
 {

165 
	mNPC_RX_LBK_PKIND
 = 0ULL,

166 
	mNPC_RX_CPT_HDR_PTP_PKIND
 = 54ULL,

167 
	mNPC_RX_CUSTOM_PRE_L2_PKIND
 = 55ULL,

168 
	mNPC_RX_VLAN_EXDSA_PKIND
 = 56ULL,

169 
	mNPC_RX_CHLEN24B_PKIND
 = 57ULL,

170 
	mNPC_RX_CPT_HDR_PKIND
,

171 
	mNPC_RX_CHLEN90B_PKIND
,

172 
	mNPC_TX_HIGIG_PKIND
,

173 
	mNPC_RX_HIGIG_PKIND
,

174 
	mNPC_RX_EDSA_PKIND
,

175 
	mNPC_TX_DEF_PKIND
,

178 
	e≈c_öãrÁ˚_ty≥
 {

179 
	mNPC_INTF_MODE_DEF
,

180 
	mNPC_INTF_MODE_EDSA
,

181 
	mNPC_INTF_MODE_HIGIG
,

182 
	mNPC_INTF_MODE_FDSA
,

188 
	ekey_fõlds
 {

189 
	mNPC_DMAC
,

190 
	mNPC_SMAC
,

191 
	mNPC_ETYPE
,

192 
	mNPC_VLAN_ETYPE_CTAG
,

193 
	mNPC_VLAN_ETYPE_STAG
,

194 
	mNPC_OUTER_VID
,

195 
	mNPC_TOS
,

196 
	mNPC_IPFRAG_IPV4
,

197 
	mNPC_SIP_IPV4
,

198 
	mNPC_DIP_IPV4
,

199 
	mNPC_IPFRAG_IPV6
,

200 
	mNPC_SIP_IPV6
,

201 
	mNPC_DIP_IPV6
,

202 
	mNPC_IPPROTO_TCP
,

203 
	mNPC_IPPROTO_UDP
,

204 
	mNPC_IPPROTO_SCTP
,

205 
	mNPC_IPPROTO_AH
,

206 
	mNPC_IPPROTO_ESP
,

207 
	mNPC_IPPROTO_ICMP
,

208 
	mNPC_IPPROTO_ICMP6
,

209 
	mNPC_SPORT_TCP
,

210 
	mNPC_DPORT_TCP
,

211 
	mNPC_SPORT_UDP
,

212 
	mNPC_DPORT_UDP
,

213 
	mNPC_SPORT_SCTP
,

214 
	mNPC_DPORT_SCTP
,

215 
	mNPC_FDSA_VAL
,

216 
	mNPC_HEADER_FIELDS_MAX
,

217 
	mNPC_CHAN
 = 
NPC_HEADER_FIELDS_MAX
,

218 
	mNPC_PF_FUNC
,

219 
	mNPC_ERRLEV
,

220 
	mNPC_ERRCODE
,

221 
	mNPC_LXMB
,

222 
	mNPC_EXACT_RESULT
,

223 
	mNPC_LA
,

224 
	mNPC_LB
,

225 
	mNPC_LC
,

226 
	mNPC_LD
,

227 
	mNPC_LE
,

228 
	mNPC_LF
,

229 
	mNPC_LG
,

230 
	mNPC_LH
,

232 
	mNPC_ETYPE_ETHER
,

234 
	mNPC_ETYPE_TAG1
,

236 
	mNPC_ETYPE_TAG2
,

238 
	mNPC_VLAN_TAG1
,

240 
	mNPC_VLAN_TAG2
,

242 
	mNPC_UNKNOWN
,

243 
	mNPC_KEY_FIELDS_MAX
,

246 
	s≈c_kpu_¥ofûe_ˇm
 {

247 
u8
 
	m°©e
;

248 
u8
 
	m°©e_mask
;

249 
u16
 
	mdp0
;

250 
u16
 
	mdp0_mask
;

251 
u16
 
	mdp1
;

252 
u16
 
	mdp1_mask
;

253 
u16
 
	mdp2
;

254 
u16
 
	mdp2_mask
;

255 } 
	g__∑cked
;

257 
	s≈c_kpu_¥ofûe_a˘i⁄
 {

258 
u8
 
	mîæev
;

259 
u8
 
	mîrcode
;

260 
u8
 
	mdp0_off£t
;

261 
u8
 
	mdp1_off£t
;

262 
u8
 
	mdp2_off£t
;

263 
u8
 
	mby∑ss_cou¡
;

264 
u8
 
	m∑r£_d⁄e
;

265 
u8
 
	m√xt_°©e
;

266 
u8
 
	m±r_adv™˚
;

267 
u8
 
	mˇp_ía
;

268 
u8
 
	mlid
;

269 
u8
 
	m…y≥
;

270 
u8
 
	mÊags
;

271 
u8
 
	moff£t
;

272 
u8
 
	mmask
;

273 
u8
 
	mright
;

274 
u8
 
	mshi·
;

275 } 
	g__∑cked
;

277 
	s≈c_kpu_¥ofûe
 {

278 
	mˇm_íåõs
;

279 
	ma˘i⁄_íåõs
;

280 
≈c_kpu_¥ofûe_ˇm
 *
	mˇm
;

281 
≈c_kpu_¥ofûe_a˘i⁄
 *
	ma˘i⁄
;

285 
	s≈c_kpu_ˇm
 {

286 #i‡
deföed
(
__BIG_ENDIAN_BITFIELD
)

287 
u64
 
	mrsvd_63_56
 : 8;

288 
u64
 
	m°©e
 : 8;

289 
u64
 
	mdp2_d©a
 : 16;

290 
u64
 
	mdp1_d©a
 : 16;

291 
u64
 
	mdp0_d©a
 : 16;

293 
u64
 
	mdp0_d©a
 : 16;

294 
u64
 
	mdp1_d©a
 : 16;

295 
u64
 
	mdp2_d©a
 : 16;

296 
u64
 
	m°©e
 : 8;

297 
u64
 
	mrsvd_63_56
 : 8;

301 
	s≈c_kpu_a˘i⁄0
 {

302 #i‡
deföed
(
__BIG_ENDIAN_BITFIELD
)

303 
u64
 
	mrsvd_63_57
 : 7;

304 
u64
 
	mbyp_cou¡
 : 3;

305 
u64
 
	mˇ±uª_ía
 : 1;

306 
u64
 
	m∑r£_d⁄e
 : 1;

307 
u64
 
	m√xt_°©e
 : 8;

308 
u64
 
	mrsvd_43
 : 1;

309 
u64
 
	mˇ±uª_lid
 : 3;

310 
u64
 
	mˇ±uª_…y≥
 : 4;

311 
u64
 
	mˇ±uª_Êags
 : 8;

312 
u64
 
	m±r_adv™˚
 : 8;

313 
u64
 
	mv¨_Àn_off£t
 : 8;

314 
u64
 
	mv¨_Àn_mask
 : 8;

315 
u64
 
	mv¨_Àn_right
 : 1;

316 
u64
 
	mv¨_Àn_shi·
 : 3;

318 
u64
 
	mv¨_Àn_shi·
 : 3;

319 
u64
 
	mv¨_Àn_right
 : 1;

320 
u64
 
	mv¨_Àn_mask
 : 8;

321 
u64
 
	mv¨_Àn_off£t
 : 8;

322 
u64
 
	m±r_adv™˚
 : 8;

323 
u64
 
	mˇ±uª_Êags
 : 8;

324 
u64
 
	mˇ±uª_…y≥
 : 4;

325 
u64
 
	mˇ±uª_lid
 : 3;

326 
u64
 
	mrsvd_43
 : 1;

327 
u64
 
	m√xt_°©e
 : 8;

328 
u64
 
	m∑r£_d⁄e
 : 1;

329 
u64
 
	mˇ±uª_ía
 : 1;

330 
u64
 
	mbyp_cou¡
 : 3;

331 
u64
 
	mrsvd_63_57
 : 7;

335 
	s≈c_kpu_a˘i⁄1
 {

336 #i‡
deföed
(
__BIG_ENDIAN_BITFIELD
)

337 
u64
 
	mrsvd_63_36
 : 28;

338 
u64
 
	mîæev
 : 4;

339 
u64
 
	mîrcode
 : 8;

340 
u64
 
	mdp2_off£t
 : 8;

341 
u64
 
	mdp1_off£t
 : 8;

342 
u64
 
	mdp0_off£t
 : 8;

344 
u64
 
	mdp0_off£t
 : 8;

345 
u64
 
	mdp1_off£t
 : 8;

346 
u64
 
	mdp2_off£t
 : 8;

347 
u64
 
	mîrcode
 : 8;

348 
u64
 
	mîæev
 : 4;

349 
u64
 
	mrsvd_63_36
 : 28;

353 
	s≈c_kpu_pköd_˝i_def
 {

354 #i‡
deföed
(
__BIG_ENDIAN_BITFIELD
)

355 
u64
 
	mía
 : 1;

356 
u64
 
	mrsvd_62_59
 : 4;

357 
u64
 
	mlid
 : 3;

358 
u64
 
	m…y≥_m©ch
 : 4;

359 
u64
 
	m…y≥_mask
 : 4;

360 
u64
 
	mÊags_m©ch
 : 8;

361 
u64
 
	mÊags_mask
 : 8;

362 
u64
 
	madd_off£t
 : 8;

363 
u64
 
	madd_mask
 : 8;

364 
u64
 
	mrsvd_15
 : 1;

365 
u64
 
	madd_shi·
 : 3;

366 
u64
 
	mrsvd_11_10
 : 2;

367 
u64
 
	m˝i_ba£
 : 10;

369 
u64
 
	m˝i_ba£
 : 10;

370 
u64
 
	mrsvd_11_10
 : 2;

371 
u64
 
	madd_shi·
 : 3;

372 
u64
 
	mrsvd_15
 : 1;

373 
u64
 
	madd_mask
 : 8;

374 
u64
 
	madd_off£t
 : 8;

375 
u64
 
	mÊags_mask
 : 8;

376 
u64
 
	mÊags_m©ch
 : 8;

377 
u64
 
	m…y≥_mask
 : 4;

378 
u64
 
	m…y≥_m©ch
 : 4;

379 
u64
 
	mlid
 : 3;

380 
u64
 
	mrsvd_62_59
 : 4;

381 
u64
 
	mía
 : 1;

385 
	snix_rx_a˘i⁄
 {

386 #i‡
deföed
(
__BIG_ENDIAN_BITFIELD
)

387 
u64
 
	mrsvd_63_61
 :3;

388 
u64
 
	mÊow_key_Æg
 :5;

389 
u64
 
	mm©ch_id
 :16;

390 
u64
 
	mödex
 :20;

391 
u64
 
	mpf_func
 :16;

392 
u64
 
	m›
 :4;

394 
u64
 
	m›
 :4;

395 
u64
 
	mpf_func
 :16;

396 
u64
 
	mödex
 :20;

397 
u64
 
	mm©ch_id
 :16;

398 
u64
 
	mÊow_key_Æg
 :5;

399 
u64
 
	mrsvd_63_61
 :3;

403 
	snix_tx_a˘i⁄
 {

404 #i‡
deföed
(
__BIG_ENDIAN_BITFIELD
)

405 
u64
 
	mrsvd_63_48
 :16;

406 
u64
 
	mm©ch_id
 :16;

407 
u64
 
	mödex
 :20;

408 
u64
 
	mrsvd_11_8
 :8;

409 
u64
 
	m›
 :4;

411 
u64
 
	m›
 :4;

412 
u64
 
	mrsvd_11_8
 :8;

413 
u64
 
	mödex
 :20;

414 
u64
 
	mm©ch_id
 :16;

415 
u64
 
	mrsvd_63_48
 :16;

420 
	#NPC_EXACT_NIBBLE_START
 40

	)

421 
	#NPC_EXACT_NIBBLE_END
 43

	)

422 
	#NPC_EXACT_NIBBLE
 
	`GENMASK_ULL
(43, 40)

	)

425 
	#NPC_EXACT_NIBBLE_HIT
 
	`BIT_ULL
(40)

	)

426 
	#NPC_EXACT_NIBBLE_OPC
 
	`BIT_ULL
(40)

	)

427 
	#NPC_EXACT_NIBBLE_WAY
 
	`BIT_ULL
(40)

	)

428 
	#NPC_EXACT_NIBBLE_INDEX
 
	`GENMASK_ULL
(43, 41)

	)

430 
	#NPC_EXACT_RESULT_HIT
 
	`BIT_ULL
(0)

	)

431 
	#NPC_EXACT_RESULT_OPC
 
	`GENMASK_ULL
(2, 1)

	)

432 
	#NPC_EXACT_RESULT_WAY
 
	`GENMASK_ULL
(4, 3)

	)

433 
	#NPC_EXACT_RESULT_IDX
 
	`GENMASK_ULL
(15, 5)

	)

436 
	#NPC_PARSE_NIBBLE
 
	`GENMASK_ULL
(30, 0)

	)

439 
	#NPC_PARSE_NIBBLE_CHAN
 
	`GENMASK_ULL
(2, 0)

	)

440 
	#NPC_PARSE_NIBBLE_ERRLEV
 
	`BIT_ULL
(3)

	)

441 
	#NPC_PARSE_NIBBLE_ERRCODE
 
	`GENMASK_ULL
(5, 4)

	)

442 
	#NPC_PARSE_NIBBLE_L2L3_BCAST
 
	`BIT_ULL
(6)

	)

443 
	#NPC_PARSE_NIBBLE_LA_FLAGS
 
	`GENMASK_ULL
(8, 7)

	)

444 
	#NPC_PARSE_NIBBLE_LA_LTYPE
 
	`BIT_ULL
(9)

	)

445 
	#NPC_PARSE_NIBBLE_LB_FLAGS
 
	`GENMASK_ULL
(11, 10)

	)

446 
	#NPC_PARSE_NIBBLE_LB_LTYPE
 
	`BIT_ULL
(12)

	)

447 
	#NPC_PARSE_NIBBLE_LC_FLAGS
 
	`GENMASK_ULL
(14, 13)

	)

448 
	#NPC_PARSE_NIBBLE_LC_LTYPE
 
	`BIT_ULL
(15)

	)

449 
	#NPC_PARSE_NIBBLE_LD_FLAGS
 
	`GENMASK_ULL
(17, 16)

	)

450 
	#NPC_PARSE_NIBBLE_LD_LTYPE
 
	`BIT_ULL
(18)

	)

451 
	#NPC_PARSE_NIBBLE_LE_FLAGS
 
	`GENMASK_ULL
(20, 19)

	)

452 
	#NPC_PARSE_NIBBLE_LE_LTYPE
 
	`BIT_ULL
(21)

	)

453 
	#NPC_PARSE_NIBBLE_LF_FLAGS
 
	`GENMASK_ULL
(23, 22)

	)

454 
	#NPC_PARSE_NIBBLE_LF_LTYPE
 
	`BIT_ULL
(24)

	)

455 
	#NPC_PARSE_NIBBLE_LG_FLAGS
 
	`GENMASK_ULL
(26, 25)

	)

456 
	#NPC_PARSE_NIBBLE_LG_LTYPE
 
	`BIT_ULL
(27)

	)

457 
	#NPC_PARSE_NIBBLE_LH_FLAGS
 
	`GENMASK_ULL
(29, 28)

	)

458 
	#NPC_PARSE_NIBBLE_LH_LTYPE
 
	`BIT_ULL
(30)

	)

461 
	#RX_VTAG0_VALID_BIT
 
	`BIT_ULL
(15)

	)

462 
	#RX_VTAG0_TYPE_MASK
 
	`GENMASK_ULL
(14, 12)

	)

463 
	#RX_VTAG0_LID_MASK
 
	`GENMASK_ULL
(10, 8)

	)

464 
	#RX_VTAG0_RELPTR_MASK
 
	`GENMASK_ULL
(7, 0)

	)

465 
	#RX_VTAG1_VALID_BIT
 
	`BIT_ULL
(47)

	)

466 
	#RX_VTAG1_TYPE_MASK
 
	`GENMASK_ULL
(46, 44)

	)

467 
	#RX_VTAG1_LID_MASK
 
	`GENMASK_ULL
(42, 40)

	)

468 
	#RX_VTAG1_RELPTR_MASK
 
	`GENMASK_ULL
(39, 32)

	)

471 
	#TX_VTAG0_DEF_MASK
 
	`GENMASK_ULL
(25, 16)

	)

472 
	#TX_VTAG0_OP_MASK
 
	`GENMASK_ULL
(13, 12)

	)

473 
	#TX_VTAG0_LID_MASK
 
	`GENMASK_ULL
(10, 8)

	)

474 
	#TX_VTAG0_RELPTR_MASK
 
	`GENMASK_ULL
(7, 0)

	)

475 
	#TX_VTAG1_DEF_MASK
 
	`GENMASK_ULL
(57, 48)

	)

476 
	#TX_VTAG1_OP_MASK
 
	`GENMASK_ULL
(45, 44)

	)

477 
	#TX_VTAG1_LID_MASK
 
	`GENMASK_ULL
(42, 40)

	)

478 
	#TX_VTAG1_RELPTR_MASK
 
	`GENMASK_ULL
(39, 32)

	)

481 
	#NIXLF_UCAST_ENTRY
 0

	)

482 
	#NIXLF_BCAST_ENTRY
 1

	)

483 
	#NIXLF_ALLMULTI_ENTRY
 2

	)

484 
	#NIXLF_PROMISC_ENTRY
 3

	)

486 
	s≈c_cﬂÀs˚d_kpu_¥Ê
 {

487 
	#NPC_SIGN
 0x00666f727063706e

	)

488 
	#NPC_PRFL_NAME
 "≈c_¥Ês_¨øy"

	)

489 
	#NPC_NAME_LEN
 32

	)

490 
u64
 
	msig«tuª
;

491 
u8
 
	m«me
[
NPC_NAME_LEN
];

492 
u64
 
	mvîsi⁄
;

493 
u8
 
	mnum_¥Ê
;

494 
u16
 
	m¥Ê_sz
[0];

497 
	s≈c_mˇm_kex
 {

499 
u64
 
	mmkex_sign
;

500 
u8
 
	m«me
[
MKEX_NAME_LEN
];

501 
u64
 
	m˝u_modñ
;

502 
u64
 
	mkpu_vîsi⁄
;

503 
u64
 
	mª£rved
;

506 
u64
 
	mkeyx_cfg
[
NPC_MAX_INTF
];

508 
u64
 
	mkex_ld_Êags
[
NPC_MAX_LD
];

510 
u64
 
	mötf_lid_…_ld
[
NPC_MAX_INTF
][
NPC_MAX_LID
][
NPC_MAX_LT
][
NPC_MAX_LD
];

512 
u64
 
	mötf_ld_Êags
[
NPC_MAX_INTF
][
NPC_MAX_LD
][
NPC_MAX_LFL
];

513 } 
	g__∑cked
;

515 
	s≈c_kpu_fwd©a
 {

516 
	míåõs
;

521 
u8
 
	md©a
[0];

522 } 
	g__∑cked
;

524 
	s≈c_…_def
 {

525 
u8
 
	m…y≥_mask
;

526 
u8
 
	m…y≥_m©ch
;

527 
u8
 
	mlid
;

528 } 
	g__∑cked
;

530 
	s≈c_…_def_ù£c
 {

531 
u8
 
	m…y≥_mask
;

532 
u8
 
	m…y≥_m©ch
;

533 
u8
 
	mlid
;

534 
u8
 
	m•i_off£t
;

535 
u8
 
	m•i_nz
;

536 } 
	g__∑cked
;

538 
	s≈c_…_def_≠ad
 {

539 
u8
 
	m…y≥_mask
;

540 
u8
 
	m…y≥_m©ch
;

541 
u8
 
	mlid
;

542 
u8
 
	mvÆid
;

543 } 
	g__∑cked
;

545 
	s≈c_…_def_cﬁ‹
 {

546 
u8
 
	m…y≥_mask
;

547 
u8
 
	m…y≥_m©ch
;

548 
u8
 
	mlid
;

549 
u8
 
	mnoff£t
;

550 
u8
 
	moff£t
;

551 } 
	g__∑cked
;

553 
	s≈c_…_def_ë
 {

554 
u8
 
	m…y≥_mask
;

555 
u8
 
	m…y≥_m©ch
;

556 
u8
 
	mlid
;

557 
u8
 
	mvÆid
;

558 
u8
 
	moff£t
;

559 } 
	g__∑cked
;

561 
	s≈c_…_def_cfg
 {

562 
≈c_…_def
 
	mrx_ﬁ2
;

563 
≈c_…_def
 
	mrx_où4
;

564 
≈c_…_def
 
	mrx_iù4
;

565 
≈c_…_def
 
	mrx_où6
;

566 
≈c_…_def
 
	mrx_iù6
;

567 
≈c_…_def
 
	mrx_Ÿ˝
;

568 
≈c_…_def
 
	mrx_ô˝
;

569 
≈c_…_def
 
	mrx_oudp
;

570 
≈c_…_def
 
	mrx_iudp
;

571 
≈c_…_def
 
	mrx_os˘p
;

572 
≈c_…_def
 
	mrx_is˘p
;

573 
≈c_…_def_ù£c
 
	mrx_ù£c
[2];

574 
≈c_…_def
 
	mpck_ﬁ2
;

575 
≈c_…_def
 
	mpck_où4
;

576 
≈c_…_def
 
	mpck_où6
;

577 
≈c_…_def
 
	mpck_iù4
;

578 
≈c_…_def_≠ad
 
	mrx_≠ad0
;

579 
≈c_…_def_≠ad
 
	mrx_≠ad1
;

580 
≈c_…_def_cﬁ‹
 
	movœn
;

581 
≈c_…_def_cﬁ‹
 
	mivœn
;

582 
≈c_…_def_cﬁ‹
 
	mrx_gí0_cﬁ‹
;

583 
≈c_…_def_cﬁ‹
 
	mrx_gí1_cﬁ‹
;

584 
≈c_…_def_ë
 
	mrx_ë
[2];

585 } 
	g__∑cked
;

588 
	s≈c_kpu_¥ofûe_fwd©a
 {

589 
	#KPU_SIGN
 0x00666f727075706b

	)

590 
	#KPU_NAME_LEN
 32

	)

592 
	#KPU_MAX_CST_ENT
 6

	)

594 
u64
 
	msig«tuª
;

595 
u8
 
	m«me
[
KPU_NAME_LEN
];

596 
u64
 
	mvîsi⁄
;

597 
u8
 
	mkpus
;

598 
u8
 
	mª£rved
[7];

604 
≈c_mˇm_kex
 
	mmkex
;

606 
≈c_…_def_cfg
 
	m…_def
;

611 
u8
 
	md©a
[0];

612 } 
	g__∑cked
;

614 
	srvu_≈c_mˇm_ruÀ
 {

615 
Êow_msg
 
	m∑ckë
;

616 
Êow_msg
 
	mmask
;

617 
u8
 
	mötf
;

619 
nix_tx_a˘i⁄
 
	mtx_a˘i⁄
;

620 
nix_rx_a˘i⁄
 
	mrx_a˘i⁄
;

622 
u64
 
	mvèg_a˘i⁄
;

623 
li°_hód
 
	mli°
;

624 
u64
 
	m„©uªs
;

625 
u16
 
	mow√r
;

626 
u16
 
	míåy
;

627 
u16
 
	m˙å
;

628 
boﬁ
 
	mhas_˙å
;

629 
u8
 
	mdeÁu…_ruÀ
;

630 
boﬁ
 
	míabÀ
;

631 
boﬁ
 
	mvfvœn_cfg
;

632 
u16
 
	mch™
;

633 
u16
 
	mch™_mask
;

634 
u8
 
	mlxmb
;

	@npc_profile.h

8 #i‚de‡
NPC_PROFILE_H


9 
	#NPC_PROFILE_H


	)

11 
	#NPC_KPU_PROFILE_VER
 0x0000000100070000

	)

12 
	#NPC_KPU_VER_MAJ
(
vî
Ë(
u16
)(((vîË>> 32Ë& 0xFFFF)

	)

13 
	#NPC_KPU_VER_MIN
(
vî
Ë(
u16
)(((vîË>> 16Ë& 0xFFFF)

	)

14 
	#NPC_KPU_VER_PATCH
(
vî
Ë(
u16
)((vîË& 0xFFFF)

	)

16 
	#NPC_IH_W
 0x8000

	)

17 
	#NPC_IH_UTAG
 0x2000

	)

19 
	#NPC_ETYPE_IP
 0x0800

	)

20 
	#NPC_ETYPE_IP6
 0x86dd

	)

21 
	#NPC_ETYPE_ARP
 0x0806

	)

22 
	#NPC_ETYPE_RARP
 0x8035

	)

23 
	#NPC_ETYPE_NGIO
 0x8842

	)

24 
	#NPC_ETYPE_MPLSU
 0x8847

	)

25 
	#NPC_ETYPE_MPLSM
 0x8848

	)

26 
	#NPC_ETYPE_ETAG
 0x893f

	)

27 
	#NPC_ETYPE_CTAG
 0x8100

	)

28 
	#NPC_ETYPE_SBTAG
 0x88a8

	)

29 
	#NPC_ETYPE_ITAG
 0x88e7

	)

30 
	#NPC_ETYPE_PTP
 0x88f7

	)

31 
	#NPC_ETYPE_FCOE
 0x8906

	)

32 
	#NPC_ETYPE_QINQ
 0x9100

	)

33 
	#NPC_ETYPE_TRANS_ETH_BR
 0x6558

	)

34 
	#NPC_ETYPE_PPP
 0x880b

	)

35 
	#NPC_ETYPE_NSH
 0x894f

	)

36 
	#NPC_ETYPE_DSA
 0xdada

	)

37 
	#NPC_ETYPE_PPPOE
 0x8864

	)

39 
	#NPC_PPP_IP
 0x0021

	)

40 
	#NPC_PPP_IP6
 0x0057

	)

42 
	#NPC_IPNH_HOP
 0

	)

43 
	#NPC_IPNH_ICMP
 1

	)

44 
	#NPC_IPNH_IGMP
 2

	)

45 
	#NPC_IPNH_IP
 4

	)

46 
	#NPC_IPNH_TCP
 6

	)

47 
	#NPC_IPNH_UDP
 17

	)

48 
	#NPC_IPNH_IP6
 41

	)

49 
	#NPC_IPNH_ROUT
 43

	)

50 
	#NPC_IPNH_FRAG
 44

	)

51 
	#NPC_IPNH_GRE
 47

	)

52 
	#NPC_IPNH_ESP
 50

	)

53 
	#NPC_IPNH_AH
 51

	)

54 
	#NPC_IPNH_ICMP6
 58

	)

55 
	#NPC_IPNH_NONH
 59

	)

56 
	#NPC_IPNH_DEST
 60

	)

57 
	#NPC_IPNH_SCTP
 132

	)

58 
	#NPC_IPNH_MOBILITY
 135

	)

59 
	#NPC_IPNH_MPLS
 137

	)

60 
	#NPC_IPNH_HOSTID
 139

	)

61 
	#NPC_IPNH_SHIM6
 140

	)

62 
	#NPC_IPNH_CUSTOM
 253

	)

64 
	#NPC_UDP_PORT_PTP_E
 319

	)

65 
	#NPC_UDP_PORT_PTP_G
 320

	)

66 
	#NPC_UDP_PORT_GTPC
 2123

	)

67 
	#NPC_UDP_PORT_GTPU
 2152

	)

68 
	#NPC_UDP_PORT_VXLAN
 4789

	)

69 
	#NPC_UDP_PORT_VXLANGPE
 4790

	)

70 
	#NPC_UDP_PORT_GENEVE
 6081

	)

71 
	#NPC_UDP_PORT_MPLS
 6635

	)

72 
	#NPC_UDP_PORT_ESP
 4500

	)

74 
	#NPC_VXLANGPE_NP_IP
 0x1

	)

75 
	#NPC_VXLANGPE_NP_IP6
 0x2

	)

76 
	#NPC_VXLANGPE_NP_ETH
 0x3

	)

77 
	#NPC_VXLANGPE_NP_NSH
 0x4

	)

78 
	#NPC_VXLANGPE_NP_MPLS
 0x5

	)

79 
	#NPC_VXLANGPE_NP_GBP
 0x6

	)

80 
	#NPC_VXLANGPE_NP_VBNG
 0x7

	)

82 
	#NPC_NSH_NP_IP
 0x1

	)

83 
	#NPC_NSH_NP_IP6
 0x2

	)

84 
	#NPC_NSH_NP_ETH
 0x3

	)

85 
	#NPC_NSH_NP_NSH
 0x4

	)

86 
	#NPC_NSH_NP_MPLS
 0x5

	)

88 
	#NPC_TCP_PORT_HTTP
 80

	)

89 
	#NPC_TCP_PORT_HTTPS
 443

	)

90 
	#NPC_TCP_PORT_PPTP
 1723

	)

92 
	#NPC_MPLS_S
 0x0100

	)

94 
	#NPC_IP_TTL_MASK
 0xff00

	)

95 
	#NPC_IP_VER_4
 0x4000

	)

96 
	#NPC_IP_VER_6
 0x6000

	)

97 
	#NPC_IP_VER_MASK
 0xf000

	)

98 
	#NPC_IP_HDR_LEN_5
 0x0500

	)

99 
	#NPC_IP_HDR_LEN_MASK
 0x0f00

	)

100 
	#NPC_IP_HDR_MF
 0x2000

	)

101 
	#NPC_IP_HDR_FRAGOFF
 0x1fff

	)

103 
	#NPC_IP6_HOP_MASK
 0x00ff

	)

104 
	#NPC_IP6_FRAG_FRAGOFF
 0xfff8

	)

106 
	#NPC_GRE_F_CSUM
 (0x1 << 15)

	)

107 
	#NPC_GRE_F_ROUTE
 (0x1 << 14)

	)

108 
	#NPC_GRE_F_KEY
 (0x1 << 13)

	)

109 
	#NPC_GRE_F_SEQ
 (0x1 << 12)

	)

110 
	#NPC_GRE_F_ACK
 (0x1 << 7)

	)

111 
	#NPC_GRE_FLAG_MASK
 (
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_ROUTE
 | \

112 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
 | 
NPC_GRE_F_ACK
)

	)

113 
	#NPC_GRE_VER_MASK
 0x0003

	)

114 
	#NPC_GRE_VER_1
 0x0001

	)

116 
	#NPC_VXLAN_I
 0x0800

	)

118 
	#NPC_VXLANGPE_VER
 (0x3 << 12)

	)

119 
	#NPC_VXLANGPE_I
 (0x1 << 11)

	)

120 
	#NPC_VXLANGPE_P
 (0x1 << 10)

	)

121 
	#NPC_VXLANGPE_B
 (0x1 << 9)

	)

122 
	#NPC_VXLANGPE_NP_MASK
 0x00ff

	)

124 
	#NPC_NSH_NP_MASK
 0x00ff

	)

126 
	#NPC_GENEVE_F_OAM
 (0x1 << 7)

	)

127 
	#NPC_GENEVE_F_CRI_OPT
 (0x1 << 6)

	)

129 
	#NPC_GTP_PT_GTP
 (0x1 << 12)

	)

130 
	#NPC_GTP_PT_MASK
 (0x1 << 12)

	)

131 
	#NPC_GTP_VER1
 (0x1 << 13)

	)

132 
	#NPC_GTP_VER_MASK
 (0x7 << 13)

	)

133 
	#NPC_GTP_MT_G_PDU
 0xff

	)

134 
	#NPC_GTP_MT_MASK
 0xff

	)

136 
	#NPC_TCP_FLAGS_FIN
 0x0001

	)

137 
	#NPC_TCP_FLAGS_SYN
 0x0002

	)

138 
	#NPC_TCP_FLAGS_RST
 0x0004

	)

139 
	#NPC_TCP_FLAGS_PSH
 0x0008

	)

140 
	#NPC_TCP_FLAGS_ACK
 0x0010

	)

141 
	#NPC_TCP_FLAGS_URG
 0x0020

	)

142 
	#NPC_TCP_FLAGS_MASK
 0x003f

	)

144 
	#NPC_TCP_DATA_OFFSET_5
 0x5000

	)

145 
	#NPC_TCP_DATA_OFFSET_MASK
 0xf000

	)

147 
	#NPC_DSA_EXTEND
 0x1000

	)

148 
	#NPC_DSA_EDSA
 0x8000

	)

149 
	#NPC_DSA_FDSA
 0xc000

	)

151 
	#NPC_KEXOF_DMAC
 9

	)

152 
	#MKEX_SIGN
 0x19bbfdbd15f

	)

153 
	#KEX_LD_CFG
(
byãsm1
, 
hdr_ofs
, 
ía
, 
Êags_ía
, 
key_ofs
) \

154 (((
byãsm1
Ë<< 16Ë| ((
hdr_ofs
Ë<< 8Ë| ((
ía
) << 7) | \

155 ((
Êags_ía
Ë<< 6Ë| ((
key_ofs
Ë& 0x3F))

	)

158 
	#NPC_PARSE_NIBBLE_INTF_RX
 (
NPC_PARSE_NIBBLE_CHAN
 | \

159 
NPC_PARSE_NIBBLE_L2L3_BCAST
 | \

160 
NPC_PARSE_NIBBLE_LA_LTYPE
 | \

161 
NPC_PARSE_NIBBLE_LB_LTYPE
 | \

162 
NPC_PARSE_NIBBLE_LC_LTYPE
 | \

163 
NPC_PARSE_NIBBLE_LD_LTYPE
 | \

164 
NPC_PARSE_NIBBLE_LE_LTYPE
)

	)

166 
	#NPC_PARSE_NIBBLE_INTF_TX
 (
NPC_PARSE_NIBBLE_LA_LTYPE
 | \

167 
NPC_PARSE_NIBBLE_LB_LTYPE
 | \

168 
NPC_PARSE_NIBBLE_LC_LTYPE
 | \

169 
NPC_PARSE_NIBBLE_LD_LTYPE
 | \

170 
NPC_PARSE_NIBBLE_LE_LTYPE
)

	)

172 
	e≈c_kpu_∑r£r_°©e
 {

173 
	mNPC_S_NA
 = 0,

174 
	mNPC_S_KPU1_ETHER
,

175 
	mNPC_S_KPU1_IH_NIX
,

176 
	mNPC_S_KPU1_IH
,

177 
	mNPC_S_KPU1_EXDSA
,

178 
	mNPC_S_KPU1_HIGIG2
,

179 
	mNPC_S_KPU1_IH_NIX_HIGIG2
,

180 
	mNPC_S_KPU1_CUSTOM_PRE_L2
,

181 
	mNPC_S_KPU1_CPT_HDR
,

182 
	mNPC_S_KPU1_VLAN_EXDSA
,

183 
	mNPC_S_KPU2_CTAG
,

184 
	mNPC_S_KPU2_CTAG2
,

185 
	mNPC_S_KPU2_SBTAG
,

186 
	mNPC_S_KPU2_QINQ
,

187 
	mNPC_S_KPU2_ETAG
,

188 
	mNPC_S_KPU2_EXDSA
,

189 
	mNPC_S_KPU2_CPT_CTAG
,

190 
	mNPC_S_KPU2_CPT_QINQ
,

191 
	mNPC_S_KPU2_MT
,

192 
	mNPC_S_KPU3_CTAG
,

193 
	mNPC_S_KPU3_STAG
,

194 
	mNPC_S_KPU3_QINQ
,

195 
	mNPC_S_KPU3_CTAG_C
,

196 
	mNPC_S_KPU3_STAG_C
,

197 
	mNPC_S_KPU3_QINQ_C
,

198 
	mNPC_S_KPU3_DSA
,

199 
	mNPC_S_KPU3_VLAN_EXDSA
,

200 
	mNPC_S_KPU4_MPLS
,

201 
	mNPC_S_KPU4_NSH
,

202 
	mNPC_S_KPU4_FDSA
,

203 
	mNPC_S_KPU4_VLAN_EXDSA
,

204 
	mNPC_S_KPU4_PPPOE
,

205 
	mNPC_S_KPU5_IP
,

206 
	mNPC_S_KPU5_IP6
,

207 
	mNPC_S_KPU5_ARP
,

208 
	mNPC_S_KPU5_RARP
,

209 
	mNPC_S_KPU5_PTP
,

210 
	mNPC_S_KPU5_FCOE
,

211 
	mNPC_S_KPU5_MPLS
,

212 
	mNPC_S_KPU5_MPLS_PL
,

213 
	mNPC_S_KPU5_NSH
,

214 
	mNPC_S_KPU5_CPT_IP
,

215 
	mNPC_S_KPU5_CPT_IP6
,

216 
	mNPC_S_KPU5_NGIO
,

217 
	mNPC_S_KPU6_IP6_EXT
,

218 
	mNPC_S_KPU6_IP6_HOP_DEST
,

219 
	mNPC_S_KPU6_IP6_ROUT
,

220 
	mNPC_S_KPU6_IP6_FRAG
,

221 
	mNPC_S_KPU6_IP6_CPT_FRAG
,

222 
	mNPC_S_KPU6_IP6_CPT_HOP_DEST
,

223 
	mNPC_S_KPU6_IP6_CPT_ROUT
,

224 
	mNPC_S_KPU7_IP6_EXT
,

225 
	mNPC_S_KPU7_IP6_ROUT
,

226 
	mNPC_S_KPU7_IP6_FRAG
,

227 
	mNPC_S_KPU7_CPT_IP6_FRAG
,

228 
	mNPC_S_KPU8_TCP
,

229 
	mNPC_S_KPU8_UDP
,

230 
	mNPC_S_KPU8_SCTP
,

231 
	mNPC_S_KPU8_ICMP
,

232 
	mNPC_S_KPU8_IGMP
,

233 
	mNPC_S_KPU8_ICMP6
,

234 
	mNPC_S_KPU8_GRE
,

235 
	mNPC_S_KPU8_AH
,

236 
	mNPC_S_KPU8_CUSTOM
,

237 
	mNPC_S_KPU9_TU_MPLS_IN_GRE
,

238 
	mNPC_S_KPU9_TU_MPLS_IN_NSH
,

239 
	mNPC_S_KPU9_TU_MPLS_IN_IP
,

240 
	mNPC_S_KPU9_TU_MPLS_IN_UDP
,

241 
	mNPC_S_KPU9_TU_NSH_IN_GRE
,

242 
	mNPC_S_KPU9_VXLAN
,

243 
	mNPC_S_KPU9_VXLANGPE
,

244 
	mNPC_S_KPU9_GENEVE
,

245 
	mNPC_S_KPU9_GTPC
,

246 
	mNPC_S_KPU9_GTPU
,

247 
	mNPC_S_KPU9_ESP
,

248 
	mNPC_S_KPU9_CUSTOM
,

249 
	mNPC_S_KPU10_TU_MPLS_IN_VXLANGPE
,

250 
	mNPC_S_KPU10_TU_MPLS_PL
,

251 
	mNPC_S_KPU10_TU_MPLS
,

252 
	mNPC_S_KPU10_TU_NSH_IN_VXLANGPE
,

253 
	mNPC_S_KPU11_TU_ETHER
,

254 
	mNPC_S_KPU11_TU_PPP
,

255 
	mNPC_S_KPU11_TU_MPLS_IN_NSH
,

256 
	mNPC_S_KPU11_TU_MPLS_PL
,

257 
	mNPC_S_KPU11_TU_MPLS
,

258 
	mNPC_S_KPU11_TU_ETHER_IN_NSH
,

259 
	mNPC_S_KPU12_TU_IP
,

260 
	mNPC_S_KPU12_TU_IP6
,

261 
	mNPC_S_KPU12_TU_ARP
,

262 
	mNPC_S_KPU13_TU_IP6_EXT
,

263 
	mNPC_S_KPU14_TU_IP6_EXT
,

264 
	mNPC_S_KPU15_TU_TCP
,

265 
	mNPC_S_KPU15_TU_UDP
,

266 
	mNPC_S_KPU15_TU_SCTP
,

267 
	mNPC_S_KPU15_TU_ICMP
,

268 
	mNPC_S_KPU15_TU_IGMP
,

269 
	mNPC_S_KPU15_TU_ICMP6
,

270 
	mNPC_S_KPU15_TU_ESP
,

271 
	mNPC_S_KPU15_TU_AH
,

272 
	mNPC_S_KPU16_HTTP_DATA
,

273 
	mNPC_S_KPU16_HTTPS_DATA
,

274 
	mNPC_S_KPU16_PPTP_DATA
,

275 
	mNPC_S_KPU16_TCP_DATA
,

276 
	mNPC_S_KPU16_UDP_DATA
,

277 
	mNPC_S_KPU16_UDP_PTP
,

278 
	mNPC_S_LAST


281 
	e≈c_kpu_œ_uÊag
 {

282 
	mNPC_F_LA_U_HAS_TAG
 = 0x10,

283 
	mNPC_F_LA_U_HAS_IH_NIX
 = 0x20,

284 
	mNPC_F_LA_U_HAS_HIGIG2
 = 0x40,

286 
	e≈c_kpu_œ_lÊag
 {

287 
	mNPC_F_LA_L_UNK_ETYPE
 = 1,

288 
	mNPC_F_LA_L_WITH_VLAN
,

289 
	mNPC_F_LA_L_WITH_ETAG
,

290 
	mNPC_F_LA_L_WITH_MPLS
,

291 
	mNPC_F_LA_L_WITH_NSH
,

294 
	e≈c_kpu_lb_uÊag
 {

295 
	mNPC_F_LB_U_UNK_ETYPE
 = 0x80,

296 
	mNPC_F_LB_U_MORE_TAG
 = 0x40,

298 
	e≈c_kpu_lb_lÊag
 {

299 
	mNPC_F_LB_L_WITH_CTAG
 = 1,

300 
	mNPC_F_LB_L_WITH_CTAG_UNK
,

301 
	mNPC_F_LB_L_WITH_STAG_CTAG
,

302 
	mNPC_F_LB_L_WITH_STAG_STAG
,

303 
	mNPC_F_LB_L_WITH_QINQ_CTAG
,

304 
	mNPC_F_LB_L_WITH_QINQ_QINQ
,

305 
	mNPC_F_LB_L_WITH_ITAG
,

306 
	mNPC_F_LB_L_WITH_ITAG_STAG
,

307 
	mNPC_F_LB_L_WITH_ITAG_CTAG
,

308 
	mNPC_F_LB_L_WITH_ITAG_UNK
,

309 
	mNPC_F_LB_L_WITH_BTAG_ITAG
,

310 
	mNPC_F_LB_L_WITH_STAG
,

311 
	mNPC_F_LB_L_WITH_QINQ
,

312 
	mNPC_F_LB_L_DSA
,

313 
	mNPC_F_LB_L_DSA_VLAN
,

314 
	mNPC_F_LB_L_EDSA
,

315 
	mNPC_F_LB_L_EDSA_VLAN
,

316 
	mNPC_F_LB_L_EXDSA
,

317 
	mNPC_F_LB_L_EXDSA_VLAN
,

318 
	mNPC_F_LB_L_FDSA
,

321 
	e≈c_kpu_lc_uÊag
 {

322 
	mNPC_F_LC_U_UNK_PROTO
 = 0x10,

323 
	mNPC_F_LC_U_IP_FRAG
 = 0x20,

324 
	mNPC_F_LC_U_IP6_FRAG
 = 0x40,

326 
	e≈c_kpu_lc_lÊag
 {

327 
	mNPC_F_LC_L_IP_IN_IP
 = 1,

328 
	mNPC_F_LC_L_6TO4
,

329 
	mNPC_F_LC_L_MPLS_IN_IP
,

330 
	mNPC_F_LC_L_IP6_TUN_IP6
,

331 
	mNPC_F_LC_L_IP6_MPLS_IN_IP
,

332 
	mNPC_F_LC_L_MPLS_4_LABELS
,

333 
	mNPC_F_LC_L_MPLS_3_LABELS
,

334 
	mNPC_F_LC_L_MPLS_2_LABELS
,

335 
	mNPC_F_LC_L_EXT_HOP
,

336 
	mNPC_F_LC_L_EXT_DEST
,

337 
	mNPC_F_LC_L_EXT_ROUT
,

338 
	mNPC_F_LC_L_EXT_MOBILITY
,

339 
	mNPC_F_LC_L_EXT_HOSTID
,

340 
	mNPC_F_LC_L_EXT_SHIM6
,

343 
	e≈c_kpu_ld_lÊag
 {

344 
	mNPC_F_LD_L_TCP_UNK_PORT
 = 1,

345 
	mNPC_F_LD_L_TCP_HAS_OPTIONS
,

346 
	mNPC_F_LD_L_TCP_UNK_PORT_HAS_OPTIONS
,

347 
	mNPC_F_LD_L_UDP_UNK_PORT
,

348 
	mNPC_F_LD_L_GRE_NVGRE
,

349 
	mNPC_F_LD_L_GRE_HAS_SRE
,

350 
	mNPC_F_LD_L_GRE_HAS_CSUM
,

351 
	mNPC_F_LD_L_GRE_HAS_KEY
,

352 
	mNPC_F_LD_L_GRE_HAS_SEQ
,

353 
	mNPC_F_LD_L_GRE_HAS_CSUM_KEY
,

354 
	mNPC_F_LD_L_GRE_HAS_CSUM_SEQ
,

355 
	mNPC_F_LD_L_GRE_HAS_KEY_SEQ
,

356 
	mNPC_F_LD_L_GRE_HAS_CSUM_KEY_SEQ
,

357 
	mNPC_F_LD_L_GRE_HAS_ROUTE
,

358 
	mNPC_F_LD_L_GRE_UNK_PROTO
,

359 
	mNPC_F_LD_L_GRE_VER1
,

360 
	mNPC_F_LD_L_GRE_VER1_HAS_SEQ
,

361 
	mNPC_F_LD_L_GRE_VER1_HAS_ACK
,

362 
	mNPC_F_LD_L_GRE_VER1_HAS_SEQ_ACK
,

363 
	mNPC_F_LD_L_GRE_VER1_UNK_PROTO
,

364 
	mNPC_F_LD_L_MPLS_4_LABELS
,

365 
	mNPC_F_LD_L_MPLS_3_LABELS
,

366 
	mNPC_F_LD_L_MPLS_2_LABELS
,

369 
	e≈c_kpu_À_lÊag
 {

370 
	mNPC_F_LE_L_VXLAN_NOVNI
,

371 
	mNPC_F_LE_L_VXLANGPE_NOVNI
,

372 
	mNPC_F_LE_L_VXLANGPE_UNK
,

373 
	mNPC_F_LE_L_VXLANGPE_NONP
,

374 
	mNPC_F_LE_L_GENEVE_OAM
,

375 
	mNPC_F_LE_L_GENEVE_CRI_OPT
,

376 
	mNPC_F_LE_L_GENEVE_OAM_CRI_OPT
,

377 
	mNPC_F_LE_L_GTPU_G_PDU
,

378 
	mNPC_F_LE_L_GTPU_UNK
,

381 
	e≈c_kpu_lf_uÊag
 {

382 
	mNPC_F_LF_U_UNK_ETYPE
 = 0x10,

383 
	mNPC_F_LF_U_HAS_TAG
 = 0x20,

386 
	e≈c_kpu_lf_lÊag
 {

387 
	mNPC_F_LF_L_WITH_CTAG
 = 1,

388 
	mNPC_F_LF_L_WITH_STAG_CTAG
,

389 
	mNPC_F_LF_L_WITH_STAG
,

390 
	mNPC_F_LF_L_WITH_QINQ_CTAG
,

391 
	mNPC_F_LF_L_WITH_QINQ
,

394 
	e≈c_kpu_lg_uÊag
 {

395 
	mNPC_F_LG_U_UNK_IP_PROTO
 = 0x10,

396 
	mNPC_F_LG_U_IP_HAS_OPTIONS
 = 0x20,

397 
	mNPC_F_LG_U_IP6_HAS_EXT
 = 0x40,

400 
	e≈c_kpu_lh_uÊag
 {

401 
	mNPC_F_LH_U_TCP_HAS_OPTIONS
 = 0x80,

404 
	e≈c_kpu_lh_lÊag
 {

405 
	mNPC_F_LH_L_TCP_HTTP
 = 1,

406 
	mNPC_F_LH_L_TCP_HTTPS
,

407 
	mNPC_F_LH_L_TCP_PPTP
,

408 
	mNPC_F_LH_L_TCP_UNK_PORT
,

409 
	mNPC_F_LH_L_UDP_UNK_PORT
,

412 
	e≈c_kpu_îr_code
 {

413 
	mNPC_EC_NOERR
 = 0,

414 
	mNPC_EC_UNK
,

415 
	mNPC_EC_IH_LENGTH
,

416 
	mNPC_EC_EDSA_UNK
,

417 
	mNPC_EC_L2_K1
,

418 
	mNPC_EC_L2_K2
,

419 
	mNPC_EC_L2_K3
,

420 
	mNPC_EC_L2_K3_ETYPE_UNK
,

421 
	mNPC_EC_L2_K4
,

422 
	mNPC_EC_MPLS_2MANY
,

423 
	mNPC_EC_MPLS_UNK
,

424 
	mNPC_EC_NSH_UNK
,

425 
	mNPC_EC_IP_TTL_0
,

426 
	mNPC_EC_IP_FRAG_OFFSET_1
,

427 
	mNPC_EC_IP_VER
,

428 
	mNPC_EC_IP6_HOP_0
,

429 
	mNPC_EC_IP6_VER
,

430 
	mNPC_EC_TCP_FLAGS_FIN_ONLY
,

431 
	mNPC_EC_TCP_FLAGS_ZERO
,

432 
	mNPC_EC_TCP_FLAGS_RST_FIN
,

433 
	mNPC_EC_TCP_FLAGS_URG_SYN
,

434 
	mNPC_EC_TCP_FLAGS_RST_SYN
,

435 
	mNPC_EC_TCP_FLAGS_SYN_FIN
,

436 
	mNPC_EC_VXLAN
,

437 
	mNPC_EC_NVGRE
,

438 
	mNPC_EC_GRE
,

439 
	mNPC_EC_GRE_VER1
,

440 
	mNPC_EC_L4
,

441 
	mNPC_EC_OIP4_CSUM
,

442 
	mNPC_EC_IIP4_CSUM
,

443 
	mNPC_EC_LAST


446 
	eNPC_ERRLEV_E
 {

447 
	mNPC_ERRLEV_RE
 = 0,

448 
	mNPC_ERRLEV_LA
 = 1,

449 
	mNPC_ERRLEV_LB
 = 2,

450 
	mNPC_ERRLEV_LC
 = 3,

451 
	mNPC_ERRLEV_LD
 = 4,

452 
	mNPC_ERRLEV_LE
 = 5,

453 
	mNPC_ERRLEV_LF
 = 6,

454 
	mNPC_ERRLEV_LG
 = 7,

455 
	mNPC_ERRLEV_LH
 = 8,

456 
	mNPC_ERRLEV_R9
 = 9,

457 
	mNPC_ERRLEV_R10
 = 10,

458 
	mNPC_ERRLEV_R11
 = 11,

459 
	mNPC_ERRLEV_R12
 = 12,

460 
	mNPC_ERRLEV_R13
 = 13,

461 
	mNPC_ERRLEV_R14
 = 14,

462 
	mNPC_ERRLEV_NIX
 = 15,

463 
	mNPC_ERRLEV_ENUM_LAST
 = 16,

466 
	#NPC_KPU_NOP_CAM
 \

468 
NPC_S_NA
, 0xff, \

475 }

	)

477 
	#NPC_KPU_NOP_ACTION
 \

479 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
, \

481 
NPC_S_NA
, 0, 0, \

482 
NPC_LID_LA
, 
NPC_LT_NA
, \

485 }

	)

487 
≈c_kpu_¥ofûe_a˘i⁄
 
	gikpu_a˘i⁄_íåõs
[] = {

489 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

491 
NPC_S_KPU1_ETHER
, 0, 0,

492 
NPC_LID_LA
, 
NPC_LT_NA
,

498 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

500 
NPC_S_KPU1_ETHER
, 0, 0,

501 
NPC_LID_LA
, 
NPC_LT_NA
,

507 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

509 
NPC_S_KPU1_ETHER
, 0, 0,

510 
NPC_LID_LA
, 
NPC_LT_NA
,

516 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

518 
NPC_S_KPU1_ETHER
, 0, 0,

519 
NPC_LID_LA
, 
NPC_LT_NA
,

525 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

527 
NPC_S_KPU1_ETHER
, 0, 0,

528 
NPC_LID_LA
, 
NPC_LT_NA
,

534 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

536 
NPC_S_KPU1_ETHER
, 0, 0,

537 
NPC_LID_LA
, 
NPC_LT_NA
,

543 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

545 
NPC_S_KPU1_ETHER
, 0, 0,

546 
NPC_LID_LA
, 
NPC_LT_NA
,

552 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

554 
NPC_S_KPU1_ETHER
, 0, 0,

555 
NPC_LID_LA
, 
NPC_LT_NA
,

561 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

563 
NPC_S_KPU1_ETHER
, 0, 0,

564 
NPC_LID_LA
, 
NPC_LT_NA
,

570 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

572 
NPC_S_KPU1_ETHER
, 0, 0,

573 
NPC_LID_LA
, 
NPC_LT_NA
,

579 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

581 
NPC_S_KPU1_ETHER
, 0, 0,

582 
NPC_LID_LA
, 
NPC_LT_NA
,

588 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

590 
NPC_S_KPU1_ETHER
, 0, 0,

591 
NPC_LID_LA
, 
NPC_LT_NA
,

597 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

599 
NPC_S_KPU1_ETHER
, 0, 0,

600 
NPC_LID_LA
, 
NPC_LT_NA
,

606 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

608 
NPC_S_KPU1_ETHER
, 0, 0,

609 
NPC_LID_LA
, 
NPC_LT_NA
,

615 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

617 
NPC_S_KPU1_ETHER
, 0, 0,

618 
NPC_LID_LA
, 
NPC_LT_NA
,

624 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

626 
NPC_S_KPU1_ETHER
, 0, 0,

627 
NPC_LID_LA
, 
NPC_LT_NA
,

633 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

635 
NPC_S_KPU1_ETHER
, 0, 0,

636 
NPC_LID_LA
, 
NPC_LT_NA
,

642 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

644 
NPC_S_KPU1_ETHER
, 0, 0,

645 
NPC_LID_LA
, 
NPC_LT_NA
,

651 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

653 
NPC_S_KPU1_ETHER
, 0, 0,

654 
NPC_LID_LA
, 
NPC_LT_NA
,

660 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

662 
NPC_S_KPU1_ETHER
, 0, 0,

663 
NPC_LID_LA
, 
NPC_LT_NA
,

669 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

671 
NPC_S_KPU1_ETHER
, 0, 0,

672 
NPC_LID_LA
, 
NPC_LT_NA
,

678 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

680 
NPC_S_KPU1_ETHER
, 0, 0,

681 
NPC_LID_LA
, 
NPC_LT_NA
,

687 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

689 
NPC_S_KPU1_ETHER
, 0, 0,

690 
NPC_LID_LA
, 
NPC_LT_NA
,

696 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

698 
NPC_S_KPU1_ETHER
, 0, 0,

699 
NPC_LID_LA
, 
NPC_LT_NA
,

705 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

707 
NPC_S_KPU1_ETHER
, 0, 0,

708 
NPC_LID_LA
, 
NPC_LT_NA
,

714 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

716 
NPC_S_KPU1_ETHER
, 0, 0,

717 
NPC_LID_LA
, 
NPC_LT_NA
,

723 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

725 
NPC_S_KPU1_ETHER
, 0, 0,

726 
NPC_LID_LA
, 
NPC_LT_NA
,

732 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

734 
NPC_S_KPU1_ETHER
, 0, 0,

735 
NPC_LID_LA
, 
NPC_LT_NA
,

741 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

743 
NPC_S_KPU1_ETHER
, 0, 0,

744 
NPC_LID_LA
, 
NPC_LT_NA
,

750 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

752 
NPC_S_KPU1_ETHER
, 0, 0,

753 
NPC_LID_LA
, 
NPC_LT_NA
,

759 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

761 
NPC_S_KPU1_ETHER
, 0, 0,

762 
NPC_LID_LA
, 
NPC_LT_NA
,

768 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

770 
NPC_S_KPU1_ETHER
, 0, 0,

771 
NPC_LID_LA
, 
NPC_LT_NA
,

777 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

779 
NPC_S_KPU1_ETHER
, 0, 0,

780 
NPC_LID_LA
, 
NPC_LT_NA
,

786 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

788 
NPC_S_KPU1_ETHER
, 0, 0,

789 
NPC_LID_LA
, 
NPC_LT_NA
,

795 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

797 
NPC_S_KPU1_ETHER
, 0, 0,

798 
NPC_LID_LA
, 
NPC_LT_NA
,

804 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

806 
NPC_S_KPU1_ETHER
, 0, 0,

807 
NPC_LID_LA
, 
NPC_LT_NA
,

813 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

815 
NPC_S_KPU1_ETHER
, 0, 0,

816 
NPC_LID_LA
, 
NPC_LT_NA
,

822 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

824 
NPC_S_KPU1_ETHER
, 0, 0,

825 
NPC_LID_LA
, 
NPC_LT_NA
,

831 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

833 
NPC_S_KPU1_ETHER
, 0, 0,

834 
NPC_LID_LA
, 
NPC_LT_NA
,

840 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

842 
NPC_S_KPU1_ETHER
, 0, 0,

843 
NPC_LID_LA
, 
NPC_LT_NA
,

849 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

851 
NPC_S_KPU1_ETHER
, 0, 0,

852 
NPC_LID_LA
, 
NPC_LT_NA
,

858 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

860 
NPC_S_KPU1_ETHER
, 0, 0,

861 
NPC_LID_LA
, 
NPC_LT_NA
,

867 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

869 
NPC_S_KPU1_ETHER
, 0, 0,

870 
NPC_LID_LA
, 
NPC_LT_NA
,

876 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

878 
NPC_S_KPU1_ETHER
, 0, 0,

879 
NPC_LID_LA
, 
NPC_LT_NA
,

885 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

887 
NPC_S_KPU1_ETHER
, 0, 0,

888 
NPC_LID_LA
, 
NPC_LT_NA
,

894 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

896 
NPC_S_KPU1_ETHER
, 0, 0,

897 
NPC_LID_LA
, 
NPC_LT_NA
,

903 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

905 
NPC_S_KPU1_ETHER
, 0, 0,

906 
NPC_LID_LA
, 
NPC_LT_NA
,

912 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

914 
NPC_S_KPU1_ETHER
, 0, 0,

915 
NPC_LID_LA
, 
NPC_LT_NA
,

921 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

923 
NPC_S_KPU1_ETHER
, 0, 0,

924 
NPC_LID_LA
, 
NPC_LT_NA
,

930 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

932 
NPC_S_KPU1_ETHER
, 0, 0,

933 
NPC_LID_LA
, 
NPC_LT_NA
,

939 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

941 
NPC_S_KPU1_ETHER
, 0, 0,

942 
NPC_LID_LA
, 
NPC_LT_NA
,

948 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

950 
NPC_S_KPU1_ETHER
, 0, 0,

951 
NPC_LID_LA
, 
NPC_LT_NA
,

957 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

959 
NPC_S_KPU1_ETHER
, 0, 0,

960 
NPC_LID_LA
, 
NPC_LT_NA
,

966 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

968 
NPC_S_KPU1_ETHER
, 0, 0,

969 
NPC_LID_LA
, 
NPC_LT_NA
,

975 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

977 
NPC_S_KPU1_CPT_HDR
, 48, 0,

978 
NPC_LID_LA
, 
NPC_LT_NA
,

984 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

986 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0, 1,

987 
NPC_LID_LA
, 
NPC_LT_LA_CUSTOM_PRE_L2_ETHER
,

993 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

995 
NPC_S_KPU1_VLAN_EXDSA
, 0, 0,

996 
NPC_LID_LA
, 
NPC_LT_NA
,

1002 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

1004 
NPC_S_KPU1_CUSTOM_PRE_L2
, 24, 1,

1005 
NPC_LID_LA
, 
NPC_LT_LA_CUSTOM_L2_24B_ETHER
,

1011 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

1013 
NPC_S_KPU1_CPT_HDR
, 40, 0,

1014 
NPC_LID_LA
, 
NPC_LT_NA
,

1020 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

1022 
NPC_S_KPU1_CUSTOM_PRE_L2
, 90, 1,

1023 
NPC_LID_LA
, 
NPC_LT_LA_CUSTOM_L2_90B_ETHER
,

1029 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

1031 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0, 0,

1032 
NPC_LID_LA
, 
NPC_LT_NA
,

1038 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

1040 
NPC_S_KPU1_HIGIG2
, 0, 0,

1041 
NPC_LID_LA
, 
NPC_LT_NA
,

1047 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

1049 
NPC_S_KPU1_EXDSA
, 0, 0,

1050 
NPC_LID_LA
, 
NPC_LT_NA
,

1056 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

1058 
NPC_S_KPU1_IH_NIX
, 0, 0,

1059 
NPC_LID_LA
, 
NPC_LT_NA
,

1066 
≈c_kpu_¥ofûe_ˇm
 
	gkpu1_ˇm_íåõs
[] = {

1067 
NPC_KPU_NOP_CAM
,

1068 
NPC_KPU_NOP_CAM
,

1069 
NPC_KPU_NOP_CAM
,

1070 
NPC_KPU_NOP_CAM
,

1071 
NPC_KPU_NOP_CAM
,

1072 
NPC_KPU_NOP_CAM
,

1074 
NPC_S_KPU1_ETHER
, 0xff,

1075 
NPC_ETYPE_IP
,

1083 
NPC_S_KPU1_ETHER
, 0xff,

1084 
NPC_ETYPE_IP6
,

1092 
NPC_S_KPU1_ETHER
, 0xff,

1093 
NPC_ETYPE_ARP
,

1101 
NPC_S_KPU1_ETHER
, 0xff,

1102 
NPC_ETYPE_RARP
,

1110 
NPC_S_KPU1_ETHER
, 0xff,

1111 
NPC_ETYPE_PTP
,

1119 
NPC_S_KPU1_ETHER
, 0xff,

1120 
NPC_ETYPE_FCOE
,

1128 
NPC_S_KPU1_ETHER
, 0xff,

1129 
NPC_ETYPE_CTAG
,

1131 
NPC_ETYPE_CTAG
,

1137 
NPC_S_KPU1_ETHER
, 0xff,

1138 
NPC_ETYPE_CTAG
,

1146 
NPC_S_KPU1_ETHER
, 0xff,

1147 
NPC_ETYPE_SBTAG
,

1155 
NPC_S_KPU1_ETHER
, 0xff,

1156 
NPC_ETYPE_QINQ
,

1164 
NPC_S_KPU1_ETHER
, 0xff,

1165 
NPC_ETYPE_ETAG
,

1173 
NPC_S_KPU1_ETHER
, 0xff,

1174 
NPC_ETYPE_MPLSU
,

1182 
NPC_S_KPU1_ETHER
, 0xff,

1183 
NPC_ETYPE_MPLSM
,

1191 
NPC_S_KPU1_ETHER
, 0xff,

1192 
NPC_ETYPE_NSH
,

1200 
NPC_S_KPU1_ETHER
, 0xff,

1201 
NPC_ETYPE_DSA
,

1209 
NPC_S_KPU1_ETHER
, 0xff,

1210 
NPC_ETYPE_PPPOE
,

1218 
NPC_S_KPU1_ETHER
, 0xff,

1227 
NPC_S_KPU1_ETHER
, 0xff,

1236 
NPC_S_KPU1_ETHER
, 0xff,

1245 
NPC_S_KPU1_IH_NIX
, 0xff,

1246 
NPC_ETYPE_IP
,

1254 
NPC_S_KPU1_IH_NIX
, 0xff,

1255 
NPC_ETYPE_IP6
,

1263 
NPC_S_KPU1_IH_NIX
, 0xff,

1264 
NPC_ETYPE_ARP
,

1272 
NPC_S_KPU1_IH_NIX
, 0xff,

1273 
NPC_ETYPE_RARP
,

1281 
NPC_S_KPU1_IH_NIX
, 0xff,

1282 
NPC_ETYPE_PTP
,

1290 
NPC_S_KPU1_IH_NIX
, 0xff,

1291 
NPC_ETYPE_FCOE
,

1299 
NPC_S_KPU1_IH_NIX
, 0xff,

1300 
NPC_ETYPE_CTAG
,

1302 
NPC_ETYPE_CTAG
,

1308 
NPC_S_KPU1_IH_NIX
, 0xff,

1309 
NPC_ETYPE_CTAG
,

1317 
NPC_S_KPU1_IH_NIX
, 0xff,

1318 
NPC_ETYPE_SBTAG
,

1326 
NPC_S_KPU1_IH_NIX
, 0xff,

1327 
NPC_ETYPE_QINQ
,

1335 
NPC_S_KPU1_IH_NIX
, 0xff,

1336 
NPC_ETYPE_ETAG
,

1344 
NPC_S_KPU1_IH_NIX
, 0xff,

1345 
NPC_ETYPE_MPLSU
,

1353 
NPC_S_KPU1_IH_NIX
, 0xff,

1354 
NPC_ETYPE_MPLSM
,

1362 
NPC_S_KPU1_IH_NIX
, 0xff,

1363 
NPC_ETYPE_NSH
,

1371 
NPC_S_KPU1_IH_NIX
, 0xff,

1380 
NPC_S_KPU1_IH
, 0xff,

1389 
NPC_S_KPU1_EXDSA
, 0xff,

1392 
NPC_DSA_EXTEND
,

1393 
NPC_DSA_EXTEND
,

1398 
NPC_S_KPU1_EXDSA
, 0xff,

1399 
NPC_DSA_FDSA
,

1400 
NPC_DSA_FDSA
,

1407 
NPC_S_KPU1_EXDSA
, 0xff,

1409 
NPC_DSA_EXTEND
,

1416 
NPC_S_KPU1_HIGIG2
, 0xff,

1417 
NPC_ETYPE_IP
,

1425 
NPC_S_KPU1_HIGIG2
, 0xff,

1426 
NPC_ETYPE_IP6
,

1434 
NPC_S_KPU1_HIGIG2
, 0xff,

1435 
NPC_ETYPE_ARP
,

1443 
NPC_S_KPU1_HIGIG2
, 0xff,

1444 
NPC_ETYPE_RARP
,

1452 
NPC_S_KPU1_HIGIG2
, 0xff,

1453 
NPC_ETYPE_PTP
,

1461 
NPC_S_KPU1_HIGIG2
, 0xff,

1462 
NPC_ETYPE_FCOE
,

1470 
NPC_S_KPU1_HIGIG2
, 0xff,

1471 
NPC_ETYPE_CTAG
,

1473 
NPC_ETYPE_CTAG
,

1479 
NPC_S_KPU1_HIGIG2
, 0xff,

1480 
NPC_ETYPE_CTAG
,

1488 
NPC_S_KPU1_HIGIG2
, 0xff,

1489 
NPC_ETYPE_SBTAG
,

1497 
NPC_S_KPU1_HIGIG2
, 0xff,

1498 
NPC_ETYPE_QINQ
,

1506 
NPC_S_KPU1_HIGIG2
, 0xff,

1507 
NPC_ETYPE_ETAG
,

1515 
NPC_S_KPU1_HIGIG2
, 0xff,

1516 
NPC_ETYPE_MPLSU
,

1524 
NPC_S_KPU1_HIGIG2
, 0xff,

1525 
NPC_ETYPE_MPLSM
,

1533 
NPC_S_KPU1_HIGIG2
, 0xff,

1534 
NPC_ETYPE_NSH
,

1542 
NPC_S_KPU1_HIGIG2
, 0xff,

1551 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1552 
NPC_ETYPE_IP
,

1560 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1561 
NPC_ETYPE_IP6
,

1569 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1570 
NPC_ETYPE_ARP
,

1578 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1579 
NPC_ETYPE_RARP
,

1587 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1588 
NPC_ETYPE_PTP
,

1596 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1597 
NPC_ETYPE_FCOE
,

1605 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1606 
NPC_ETYPE_CTAG
,

1608 
NPC_ETYPE_CTAG
,

1614 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1615 
NPC_ETYPE_CTAG
,

1623 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1624 
NPC_ETYPE_SBTAG
,

1632 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1633 
NPC_ETYPE_QINQ
,

1641 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1642 
NPC_ETYPE_ETAG
,

1650 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1651 
NPC_ETYPE_MPLSU
,

1659 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1660 
NPC_ETYPE_MPLSM
,

1668 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1669 
NPC_ETYPE_NSH
,

1677 
NPC_S_KPU1_IH_NIX_HIGIG2
, 0xff,

1686 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1687 
NPC_ETYPE_IP
,

1695 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1696 
NPC_ETYPE_IP6
,

1704 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1705 
NPC_ETYPE_ARP
,

1713 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1714 
NPC_ETYPE_RARP
,

1722 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1723 
NPC_ETYPE_PTP
,

1731 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1732 
NPC_ETYPE_FCOE
,

1740 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1741 
NPC_ETYPE_CTAG
,

1743 
NPC_ETYPE_CTAG
,

1749 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1750 
NPC_ETYPE_CTAG
,

1758 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1759 
NPC_ETYPE_SBTAG
,

1767 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1768 
NPC_ETYPE_QINQ
,

1776 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1777 
NPC_ETYPE_ETAG
,

1785 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1786 
NPC_ETYPE_MPLSU
,

1794 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1795 
NPC_ETYPE_MPLSM
,

1803 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1804 
NPC_ETYPE_NSH
,

1812 
NPC_S_KPU1_CUSTOM_PRE_L2
, 0xff,

1821 
NPC_S_KPU1_CPT_HDR
, 0xff,

1822 
NPC_ETYPE_IP
,

1830 
NPC_S_KPU1_CPT_HDR
, 0xff,

1831 
NPC_ETYPE_IP6
,

1839 
NPC_S_KPU1_CPT_HDR
, 0xff,

1840 
NPC_ETYPE_CTAG
,

1848 
NPC_S_KPU1_CPT_HDR
, 0xff,

1849 
NPC_ETYPE_QINQ
,

1857 
NPC_S_KPU1_VLAN_EXDSA
, 0xff,

1858 
NPC_ETYPE_CTAG
,

1866 
NPC_S_NA
, 0X00,

1876 
≈c_kpu_¥ofûe_ˇm
 
	gkpu2_ˇm_íåõs
[] = {

1877 
NPC_KPU_NOP_CAM
,

1878 
NPC_KPU_NOP_CAM
,

1879 
NPC_KPU_NOP_CAM
,

1880 
NPC_KPU_NOP_CAM
,

1881 
NPC_KPU_NOP_CAM
,

1882 
NPC_KPU_NOP_CAM
,

1884 
NPC_S_KPU2_CTAG
, 0xff,

1885 
NPC_ETYPE_IP
,

1893 
NPC_S_KPU2_CTAG
, 0xff,

1894 
NPC_ETYPE_IP6
,

1902 
NPC_S_KPU2_CTAG
, 0xff,

1903 
NPC_ETYPE_ARP
,

1911 
NPC_S_KPU2_CTAG
, 0xff,

1912 
NPC_ETYPE_RARP
,

1920 
NPC_S_KPU2_CTAG
, 0xff,

1921 
NPC_ETYPE_PTP
,

1929 
NPC_S_KPU2_CTAG
, 0xff,

1930 
NPC_ETYPE_FCOE
,

1938 
NPC_S_KPU2_CTAG
, 0xff,

1939 
NPC_ETYPE_MPLSU
,

1947 
NPC_S_KPU2_CTAG
, 0xff,

1948 
NPC_ETYPE_MPLSM
,

1956 
NPC_S_KPU2_CTAG
, 0xff,

1957 
NPC_ETYPE_NSH
,

1965 
NPC_S_KPU2_CTAG
, 0xff,

1966 
NPC_ETYPE_NGIO
,

1974 
NPC_S_KPU2_CTAG
, 0xff,

1975 
NPC_ETYPE_PPPOE
,

1979 
NPC_PPP_IP
,

1983 
NPC_S_KPU2_CTAG
, 0xff,

1984 
NPC_ETYPE_PPPOE
,

1988 
NPC_PPP_IP6
,

1992 
NPC_S_KPU2_CTAG
, 0xff,

2001 
NPC_S_KPU2_SBTAG
, 0xff,

2002 
NPC_ETYPE_CTAG
,

2004 
NPC_ETYPE_IP
,

2010 
NPC_S_KPU2_SBTAG
, 0xff,

2011 
NPC_ETYPE_CTAG
,

2013 
NPC_ETYPE_IP6
,

2019 
NPC_S_KPU2_SBTAG
, 0xff,

2020 
NPC_ETYPE_CTAG
,

2022 
NPC_ETYPE_ARP
,

2028 
NPC_S_KPU2_SBTAG
, 0xff,

2029 
NPC_ETYPE_CTAG
,

2031 
NPC_ETYPE_RARP
,

2037 
NPC_S_KPU2_SBTAG
, 0xff,

2038 
NPC_ETYPE_CTAG
,

2040 
NPC_ETYPE_PTP
,

2046 
NPC_S_KPU2_SBTAG
, 0xff,

2047 
NPC_ETYPE_CTAG
,

2049 
NPC_ETYPE_FCOE
,

2055 
NPC_S_KPU2_SBTAG
, 0xff,

2056 
NPC_ETYPE_CTAG
,

2058 
NPC_ETYPE_MPLSU
,

2064 
NPC_S_KPU2_SBTAG
, 0xff,

2065 
NPC_ETYPE_CTAG
,

2067 
NPC_ETYPE_MPLSM
,

2073 
NPC_S_KPU2_SBTAG
, 0xff,

2074 
NPC_ETYPE_CTAG
,

2076 
NPC_ETYPE_NSH
,

2082 
NPC_S_KPU2_SBTAG
, 0xff,

2083 
NPC_ETYPE_CTAG
,

2091 
NPC_S_KPU2_SBTAG
, 0xff,

2092 
NPC_ETYPE_SBTAG
,

2094 
NPC_ETYPE_CTAG
,

2100 
NPC_S_KPU2_SBTAG
, 0xff,

2101 
NPC_ETYPE_SBTAG
,

2103 
NPC_ETYPE_SBTAG
,

2109 
NPC_S_KPU2_SBTAG
, 0xff,

2110 
NPC_ETYPE_ITAG
,

2114 
NPC_ETYPE_IP
,

2118 
NPC_S_KPU2_SBTAG
, 0xff,

2119 
NPC_ETYPE_ITAG
,

2123 
NPC_ETYPE_IP6
,

2127 
NPC_S_KPU2_SBTAG
, 0xff,

2128 
NPC_ETYPE_ITAG
,

2132 
NPC_ETYPE_ARP
,

2136 
NPC_S_KPU2_SBTAG
, 0xff,

2137 
NPC_ETYPE_ITAG
,

2141 
NPC_ETYPE_RARP
,

2145 
NPC_S_KPU2_SBTAG
, 0xff,

2146 
NPC_ETYPE_ITAG
,

2150 
NPC_ETYPE_PTP
,

2154 
NPC_S_KPU2_SBTAG
, 0xff,

2155 
NPC_ETYPE_ITAG
,

2159 
NPC_ETYPE_FCOE
,

2163 
NPC_S_KPU2_SBTAG
, 0xff,

2164 
NPC_ETYPE_ITAG
,

2168 
NPC_ETYPE_MPLSU
,

2172 
NPC_S_KPU2_SBTAG
, 0xff,

2173 
NPC_ETYPE_ITAG
,

2177 
NPC_ETYPE_MPLSM
,

2181 
NPC_S_KPU2_SBTAG
, 0xff,

2182 
NPC_ETYPE_ITAG
,

2186 
NPC_ETYPE_NSH
,

2190 
NPC_S_KPU2_SBTAG
, 0xff,

2191 
NPC_ETYPE_ITAG
,

2195 
NPC_ETYPE_SBTAG
,

2199 
NPC_S_KPU2_SBTAG
, 0xff,

2200 
NPC_ETYPE_ITAG
,

2204 
NPC_ETYPE_CTAG
,

2208 
NPC_S_KPU2_SBTAG
, 0xff,

2209 
NPC_ETYPE_ITAG
,

2217 
NPC_S_KPU2_SBTAG
, 0xff,

2226 
NPC_S_KPU2_QINQ
, 0xff,

2227 
NPC_ETYPE_CTAG
,

2229 
NPC_ETYPE_IP
,

2235 
NPC_S_KPU2_QINQ
, 0xff,

2236 
NPC_ETYPE_CTAG
,

2238 
NPC_ETYPE_IP6
,

2244 
NPC_S_KPU2_QINQ
, 0xff,

2245 
NPC_ETYPE_CTAG
,

2247 
NPC_ETYPE_ARP
,

2253 
NPC_S_KPU2_QINQ
, 0xff,

2254 
NPC_ETYPE_CTAG
,

2256 
NPC_ETYPE_RARP
,

2262 
NPC_S_KPU2_QINQ
, 0xff,

2263 
NPC_ETYPE_CTAG
,

2265 
NPC_ETYPE_PTP
,

2271 
NPC_S_KPU2_QINQ
, 0xff,

2272 
NPC_ETYPE_CTAG
,

2274 
NPC_ETYPE_FCOE
,

2280 
NPC_S_KPU2_QINQ
, 0xff,

2281 
NPC_ETYPE_CTAG
,

2283 
NPC_ETYPE_MPLSU
,

2289 
NPC_S_KPU2_QINQ
, 0xff,

2290 
NPC_ETYPE_CTAG
,

2292 
NPC_ETYPE_MPLSM
,

2298 
NPC_S_KPU2_QINQ
, 0xff,

2299 
NPC_ETYPE_CTAG
,

2301 
NPC_ETYPE_NSH
,

2307 
NPC_S_KPU2_QINQ
, 0xff,

2308 
NPC_ETYPE_CTAG
,

2316 
NPC_S_KPU2_QINQ
, 0xff,

2317 
NPC_ETYPE_QINQ
,

2319 
NPC_ETYPE_CTAG
,

2325 
NPC_S_KPU2_QINQ
, 0xff,

2326 
NPC_ETYPE_QINQ
,

2328 
NPC_ETYPE_QINQ
,

2334 
NPC_S_KPU2_QINQ
, 0xff,

2343 
NPC_S_KPU2_ETAG
, 0xff,

2344 
NPC_ETYPE_IP
,

2352 
NPC_S_KPU2_ETAG
, 0xff,

2353 
NPC_ETYPE_IP6
,

2361 
NPC_S_KPU2_ETAG
, 0xff,

2362 
NPC_ETYPE_ARP
,

2370 
NPC_S_KPU2_ETAG
, 0xff,

2371 
NPC_ETYPE_RARP
,

2379 
NPC_S_KPU2_ETAG
, 0xff,

2380 
NPC_ETYPE_PTP
,

2388 
NPC_S_KPU2_ETAG
, 0xff,

2389 
NPC_ETYPE_FCOE
,

2397 
NPC_S_KPU2_ETAG
, 0xff,

2398 
NPC_ETYPE_MPLSU
,

2406 
NPC_S_KPU2_ETAG
, 0xff,

2407 
NPC_ETYPE_MPLSM
,

2415 
NPC_S_KPU2_ETAG
, 0xff,

2416 
NPC_ETYPE_NSH
,

2424 
NPC_S_KPU2_ETAG
, 0xff,

2425 
NPC_ETYPE_CTAG
,

2433 
NPC_S_KPU2_ETAG
, 0xff,

2434 
NPC_ETYPE_SBTAG
,

2442 
NPC_S_KPU2_ETAG
, 0xff,

2443 
NPC_ETYPE_QINQ
,

2451 
NPC_S_KPU2_ETAG
, 0xff,

2452 
NPC_ETYPE_ITAG
,

2456 
NPC_ETYPE_IP
,

2460 
NPC_S_KPU2_ETAG
, 0xff,

2461 
NPC_ETYPE_ITAG
,

2465 
NPC_ETYPE_IP6
,

2469 
NPC_S_KPU2_ETAG
, 0xff,

2470 
NPC_ETYPE_ITAG
,

2474 
NPC_ETYPE_ARP
,

2478 
NPC_S_KPU2_ETAG
, 0xff,

2479 
NPC_ETYPE_ITAG
,

2483 
NPC_ETYPE_SBTAG
,

2487 
NPC_S_KPU2_ETAG
, 0xff,

2488 
NPC_ETYPE_ITAG
,

2492 
NPC_ETYPE_CTAG
,

2496 
NPC_S_KPU2_ETAG
, 0xff,

2497 
NPC_ETYPE_ITAG
,

2505 
NPC_S_KPU2_ETAG
, 0xff,

2514 
NPC_S_KPU2_CTAG2
, 0xff,

2515 
NPC_ETYPE_IP
,

2523 
NPC_S_KPU2_CTAG2
, 0xff,

2524 
NPC_ETYPE_IP6
,

2532 
NPC_S_KPU2_CTAG2
, 0xff,

2533 
NPC_ETYPE_ARP
,

2541 
NPC_S_KPU2_CTAG2
, 0xff,

2542 
NPC_ETYPE_RARP
,

2550 
NPC_S_KPU2_CTAG2
, 0xff,

2551 
NPC_ETYPE_PTP
,

2559 
NPC_S_KPU2_CTAG2
, 0xff,

2560 
NPC_ETYPE_FCOE
,

2568 
NPC_S_KPU2_CTAG2
, 0xff,

2569 
NPC_ETYPE_MPLSU
,

2577 
NPC_S_KPU2_CTAG2
, 0xff,

2578 
NPC_ETYPE_MPLSM
,

2586 
NPC_S_KPU2_CTAG2
, 0xff,

2587 
NPC_ETYPE_NSH
,

2595 
NPC_S_KPU2_CTAG2
, 0xff,

2596 
NPC_ETYPE_CTAG
,

2604 
NPC_S_KPU2_CTAG2
, 0xff,

2613 
NPC_S_KPU2_EXDSA
, 0xff,

2614 
NPC_DSA_EDSA
,

2615 
NPC_DSA_EDSA
,

2618 
NPC_ETYPE_IP
,

2622 
NPC_S_KPU2_EXDSA
, 0xff,

2623 
NPC_DSA_EDSA
,

2624 
NPC_DSA_EDSA
,

2627 
NPC_ETYPE_IP6
,

2631 
NPC_S_KPU2_EXDSA
, 0xff,

2632 
NPC_DSA_EDSA
,

2633 
NPC_DSA_EDSA
,

2636 
NPC_ETYPE_ARP
,

2640 
NPC_S_KPU2_EXDSA
, 0xff,

2641 
NPC_DSA_EDSA
,

2642 
NPC_DSA_EDSA
,

2645 
NPC_ETYPE_RARP
,

2649 
NPC_S_KPU2_EXDSA
, 0xff,

2650 
NPC_DSA_EDSA
,

2651 
NPC_DSA_EDSA
,

2654 
NPC_ETYPE_PTP
,

2658 
NPC_S_KPU2_EXDSA
, 0xff,

2659 
NPC_DSA_EDSA
,

2660 
NPC_DSA_EDSA
,

2663 
NPC_ETYPE_FCOE
,

2667 
NPC_S_KPU2_EXDSA
, 0xff,

2668 
NPC_DSA_EDSA
,

2669 
NPC_DSA_EDSA
,

2672 
NPC_ETYPE_CTAG
,

2676 
NPC_S_KPU2_EXDSA
, 0xff,

2677 
NPC_DSA_EDSA
,

2678 
NPC_DSA_EDSA
,

2685 
NPC_S_KPU2_EXDSA
, 0xff,

2687 
NPC_DSA_EDSA
,

2688 
NPC_ETYPE_IP
,

2694 
NPC_S_KPU2_EXDSA
, 0xff,

2696 
NPC_DSA_EDSA
,

2697 
NPC_ETYPE_IP6
,

2703 
NPC_S_KPU2_EXDSA
, 0xff,

2705 
NPC_DSA_EDSA
,

2706 
NPC_ETYPE_ARP
,

2712 
NPC_S_KPU2_EXDSA
, 0xff,

2714 
NPC_DSA_EDSA
,

2715 
NPC_ETYPE_RARP
,

2721 
NPC_S_KPU2_EXDSA
, 0xff,

2723 
NPC_DSA_EDSA
,

2724 
NPC_ETYPE_PTP
,

2730 
NPC_S_KPU2_EXDSA
, 0xff,

2732 
NPC_DSA_EDSA
,

2733 
NPC_ETYPE_FCOE
,

2739 
NPC_S_KPU2_EXDSA
, 0xff,

2741 
NPC_DSA_EDSA
,

2742 
NPC_ETYPE_CTAG
,

2748 
NPC_S_KPU2_EXDSA
, 0xff,

2750 
NPC_DSA_EDSA
,

2757 
NPC_S_KPU2_CPT_CTAG
, 0xff,

2758 
NPC_ETYPE_IP
,

2766 
NPC_S_KPU2_CPT_CTAG
, 0xff,

2767 
NPC_ETYPE_IP6
,

2775 
NPC_S_KPU2_CPT_QINQ
, 0xff,

2776 
NPC_ETYPE_CTAG
,

2778 
NPC_ETYPE_IP
,

2784 
NPC_S_KPU2_CPT_QINQ
, 0xff,

2785 
NPC_ETYPE_CTAG
,

2787 
NPC_ETYPE_IP6
,

2793 
NPC_S_KPU2_MT
, 0xff,

2794 
NPC_ETYPE_CTAG
,

2802 
NPC_S_KPU2_MT
, 0xff,

2811 
NPC_S_NA
, 0X00,

2821 
≈c_kpu_¥ofûe_ˇm
 
	gkpu3_ˇm_íåõs
[] = {

2822 
NPC_KPU_NOP_CAM
,

2823 
NPC_KPU_NOP_CAM
,

2824 
NPC_KPU_NOP_CAM
,

2825 
NPC_KPU_NOP_CAM
,

2826 
NPC_KPU_NOP_CAM
,

2827 
NPC_KPU_NOP_CAM
,

2829 
NPC_S_KPU3_CTAG
, 0xff,

2830 
NPC_ETYPE_IP
,

2838 
NPC_S_KPU3_CTAG
, 0xff,

2839 
NPC_ETYPE_IP6
,

2847 
NPC_S_KPU3_CTAG
, 0xff,

2848 
NPC_ETYPE_ARP
,

2856 
NPC_S_KPU3_CTAG
, 0xff,

2857 
NPC_ETYPE_RARP
,

2865 
NPC_S_KPU3_CTAG
, 0xff,

2866 
NPC_ETYPE_PTP
,

2874 
NPC_S_KPU3_CTAG
, 0xff,

2875 
NPC_ETYPE_FCOE
,

2883 
NPC_S_KPU3_CTAG
, 0xff,

2884 
NPC_ETYPE_MPLSU
,

2892 
NPC_S_KPU3_CTAG
, 0xff,

2893 
NPC_ETYPE_MPLSM
,

2901 
NPC_S_KPU3_CTAG
, 0xff,

2902 
NPC_ETYPE_NSH
,

2910 
NPC_S_KPU3_CTAG
, 0xff,

2919 
NPC_S_KPU3_STAG
, 0xff,

2920 
NPC_ETYPE_CTAG
,

2922 
NPC_ETYPE_IP
,

2928 
NPC_S_KPU3_STAG
, 0xff,

2929 
NPC_ETYPE_CTAG
,

2931 
NPC_ETYPE_IP6
,

2937 
NPC_S_KPU3_STAG
, 0xff,

2938 
NPC_ETYPE_CTAG
,

2940 
NPC_ETYPE_ARP
,

2946 
NPC_S_KPU3_STAG
, 0xff,

2947 
NPC_ETYPE_CTAG
,

2949 
NPC_ETYPE_RARP
,

2955 
NPC_S_KPU3_STAG
, 0xff,

2956 
NPC_ETYPE_CTAG
,

2958 
NPC_ETYPE_PTP
,

2964 
NPC_S_KPU3_STAG
, 0xff,

2965 
NPC_ETYPE_CTAG
,

2967 
NPC_ETYPE_FCOE
,

2973 
NPC_S_KPU3_STAG
, 0xff,

2974 
NPC_ETYPE_CTAG
,

2976 
NPC_ETYPE_MPLSU
,

2982 
NPC_S_KPU3_STAG
, 0xff,

2983 
NPC_ETYPE_CTAG
,

2985 
NPC_ETYPE_MPLSM
,

2991 
NPC_S_KPU3_STAG
, 0xff,

2992 
NPC_ETYPE_CTAG
,

2994 
NPC_ETYPE_NSH
,

3000 
NPC_S_KPU3_STAG
, 0xff,

3001 
NPC_ETYPE_IP
,

3009 
NPC_S_KPU3_STAG
, 0xff,

3010 
NPC_ETYPE_IP6
,

3018 
NPC_S_KPU3_STAG
, 0xff,

3019 
NPC_ETYPE_ARP
,

3027 
NPC_S_KPU3_STAG
, 0xff,

3028 
NPC_ETYPE_RARP
,

3036 
NPC_S_KPU3_STAG
, 0xff,

3037 
NPC_ETYPE_MPLSU
,

3045 
NPC_S_KPU3_STAG
, 0xff,

3046 
NPC_ETYPE_MPLSM
,

3054 
NPC_S_KPU3_STAG
, 0xff,

3055 
NPC_ETYPE_NSH
,

3063 
NPC_S_KPU3_STAG
, 0xff,

3072 
NPC_S_KPU3_QINQ
, 0xff,

3073 
NPC_ETYPE_CTAG
,

3075 
NPC_ETYPE_IP
,

3081 
NPC_S_KPU3_QINQ
, 0xff,

3082 
NPC_ETYPE_CTAG
,

3084 
NPC_ETYPE_IP6
,

3090 
NPC_S_KPU3_QINQ
, 0xff,

3091 
NPC_ETYPE_CTAG
,

3093 
NPC_ETYPE_ARP
,

3099 
NPC_S_KPU3_QINQ
, 0xff,

3100 
NPC_ETYPE_CTAG
,

3102 
NPC_ETYPE_RARP
,

3108 
NPC_S_KPU3_QINQ
, 0xff,

3109 
NPC_ETYPE_CTAG
,

3111 
NPC_ETYPE_PTP
,

3117 
NPC_S_KPU3_QINQ
, 0xff,

3118 
NPC_ETYPE_CTAG
,

3120 
NPC_ETYPE_FCOE
,

3126 
NPC_S_KPU3_QINQ
, 0xff,

3127 
NPC_ETYPE_CTAG
,

3129 
NPC_ETYPE_MPLSU
,

3135 
NPC_S_KPU3_QINQ
, 0xff,

3136 
NPC_ETYPE_CTAG
,

3138 
NPC_ETYPE_MPLSM
,

3144 
NPC_S_KPU3_QINQ
, 0xff,

3145 
NPC_ETYPE_CTAG
,

3147 
NPC_ETYPE_NSH
,

3153 
NPC_S_KPU3_QINQ
, 0xff,

3154 
NPC_ETYPE_IP
,

3162 
NPC_S_KPU3_QINQ
, 0xff,

3163 
NPC_ETYPE_IP6
,

3171 
NPC_S_KPU3_QINQ
, 0xff,

3172 
NPC_ETYPE_ARP
,

3180 
NPC_S_KPU3_QINQ
, 0xff,

3181 
NPC_ETYPE_RARP
,

3189 
NPC_S_KPU3_QINQ
, 0xff,

3190 
NPC_ETYPE_PTP
,

3198 
NPC_S_KPU3_QINQ
, 0xff,

3199 
NPC_ETYPE_FCOE
,

3207 
NPC_S_KPU3_QINQ
, 0xff,

3208 
NPC_ETYPE_MPLSU
,

3216 
NPC_S_KPU3_QINQ
, 0xff,

3217 
NPC_ETYPE_MPLSM
,

3225 
NPC_S_KPU3_QINQ
, 0xff,

3226 
NPC_ETYPE_NSH
,

3234 
NPC_S_KPU3_QINQ
, 0xff,

3243 
NPC_S_KPU3_CTAG_C
, 0xff,

3244 
NPC_ETYPE_IP
,

3252 
NPC_S_KPU3_CTAG_C
, 0xff,

3253 
NPC_ETYPE_IP6
,

3261 
NPC_S_KPU3_CTAG_C
, 0xff,

3262 
NPC_ETYPE_ARP
,

3270 
NPC_S_KPU3_CTAG_C
, 0xff,

3271 
NPC_ETYPE_RARP
,

3279 
NPC_S_KPU3_CTAG_C
, 0xff,

3280 
NPC_ETYPE_PTP
,

3288 
NPC_S_KPU3_CTAG_C
, 0xff,

3289 
NPC_ETYPE_FCOE
,

3297 
NPC_S_KPU3_CTAG_C
, 0xff,

3298 
NPC_ETYPE_MPLSU
,

3306 
NPC_S_KPU3_CTAG_C
, 0xff,

3307 
NPC_ETYPE_MPLSM
,

3315 
NPC_S_KPU3_CTAG_C
, 0xff,

3316 
NPC_ETYPE_NSH
,

3324 
NPC_S_KPU3_CTAG_C
, 0xff,

3333 
NPC_S_KPU3_STAG_C
, 0xff,

3334 
NPC_ETYPE_CTAG
,

3336 
NPC_ETYPE_IP
,

3342 
NPC_S_KPU3_STAG_C
, 0xff,

3343 
NPC_ETYPE_CTAG
,

3345 
NPC_ETYPE_IP6
,

3351 
NPC_S_KPU3_STAG_C
, 0xff,

3352 
NPC_ETYPE_CTAG
,

3354 
NPC_ETYPE_ARP
,

3360 
NPC_S_KPU3_STAG_C
, 0xff,

3361 
NPC_ETYPE_CTAG
,

3363 
NPC_ETYPE_RARP
,

3369 
NPC_S_KPU3_STAG_C
, 0xff,

3370 
NPC_ETYPE_CTAG
,

3372 
NPC_ETYPE_PTP
,

3378 
NPC_S_KPU3_STAG_C
, 0xff,

3379 
NPC_ETYPE_CTAG
,

3381 
NPC_ETYPE_FCOE
,

3387 
NPC_S_KPU3_STAG_C
, 0xff,

3388 
NPC_ETYPE_CTAG
,

3390 
NPC_ETYPE_MPLSU
,

3396 
NPC_S_KPU3_STAG_C
, 0xff,

3397 
NPC_ETYPE_CTAG
,

3399 
NPC_ETYPE_MPLSM
,

3405 
NPC_S_KPU3_STAG_C
, 0xff,

3406 
NPC_ETYPE_CTAG
,

3408 
NPC_ETYPE_NSH
,

3414 
NPC_S_KPU3_STAG_C
, 0xff,

3415 
NPC_ETYPE_IP
,

3423 
NPC_S_KPU3_STAG_C
, 0xff,

3424 
NPC_ETYPE_IP6
,

3432 
NPC_S_KPU3_STAG_C
, 0xff,

3433 
NPC_ETYPE_ARP
,

3441 
NPC_S_KPU3_STAG_C
, 0xff,

3442 
NPC_ETYPE_RARP
,

3450 
NPC_S_KPU3_STAG_C
, 0xff,

3451 
NPC_ETYPE_MPLSU
,

3459 
NPC_S_KPU3_STAG_C
, 0xff,

3460 
NPC_ETYPE_MPLSM
,

3468 
NPC_S_KPU3_STAG_C
, 0xff,

3469 
NPC_ETYPE_NSH
,

3477 
NPC_S_KPU3_STAG_C
, 0xff,

3486 
NPC_S_KPU3_QINQ_C
, 0xff,

3487 
NPC_ETYPE_CTAG
,

3489 
NPC_ETYPE_IP
,

3495 
NPC_S_KPU3_QINQ_C
, 0xff,

3496 
NPC_ETYPE_CTAG
,

3498 
NPC_ETYPE_IP6
,

3504 
NPC_S_KPU3_QINQ_C
, 0xff,

3505 
NPC_ETYPE_CTAG
,

3507 
NPC_ETYPE_ARP
,

3513 
NPC_S_KPU3_QINQ_C
, 0xff,

3514 
NPC_ETYPE_CTAG
,

3516 
NPC_ETYPE_RARP
,

3522 
NPC_S_KPU3_QINQ_C
, 0xff,

3523 
NPC_ETYPE_CTAG
,

3525 
NPC_ETYPE_PTP
,

3531 
NPC_S_KPU3_QINQ_C
, 0xff,

3532 
NPC_ETYPE_CTAG
,

3534 
NPC_ETYPE_FCOE
,

3540 
NPC_S_KPU3_QINQ_C
, 0xff,

3541 
NPC_ETYPE_CTAG
,

3543 
NPC_ETYPE_MPLSU
,

3549 
NPC_S_KPU3_QINQ_C
, 0xff,

3550 
NPC_ETYPE_CTAG
,

3552 
NPC_ETYPE_MPLSM
,

3558 
NPC_S_KPU3_QINQ_C
, 0xff,

3559 
NPC_ETYPE_CTAG
,

3561 
NPC_ETYPE_NSH
,

3567 
NPC_S_KPU3_QINQ_C
, 0xff,

3568 
NPC_ETYPE_IP
,

3576 
NPC_S_KPU3_QINQ_C
, 0xff,

3577 
NPC_ETYPE_IP6
,

3585 
NPC_S_KPU3_QINQ_C
, 0xff,

3586 
NPC_ETYPE_ARP
,

3594 
NPC_S_KPU3_QINQ_C
, 0xff,

3595 
NPC_ETYPE_RARP
,

3603 
NPC_S_KPU3_QINQ_C
, 0xff,

3604 
NPC_ETYPE_PTP
,

3612 
NPC_S_KPU3_QINQ_C
, 0xff,

3613 
NPC_ETYPE_FCOE
,

3621 
NPC_S_KPU3_QINQ_C
, 0xff,

3622 
NPC_ETYPE_MPLSU
,

3630 
NPC_S_KPU3_QINQ_C
, 0xff,

3631 
NPC_ETYPE_MPLSM
,

3639 
NPC_S_KPU3_QINQ_C
, 0xff,

3640 
NPC_ETYPE_NSH
,

3648 
NPC_S_KPU3_QINQ_C
, 0xff,

3657 
NPC_S_KPU3_DSA
, 0xff,

3658 
NPC_ETYPE_IP
,

3666 
NPC_S_KPU3_DSA
, 0xff,

3667 
NPC_ETYPE_IP6
,

3675 
NPC_S_KPU3_DSA
, 0xff,

3676 
NPC_ETYPE_ARP
,

3684 
NPC_S_KPU3_DSA
, 0xff,

3685 
NPC_ETYPE_RARP
,

3693 
NPC_S_KPU3_DSA
, 0xff,

3694 
NPC_ETYPE_PTP
,

3702 
NPC_S_KPU3_DSA
, 0xff,

3703 
NPC_ETYPE_FCOE
,

3711 
NPC_S_KPU3_DSA
, 0xff,

3712 
NPC_ETYPE_CTAG
,

3714 
NPC_ETYPE_IP
,

3720 
NPC_S_KPU3_DSA
, 0xff,

3721 
NPC_ETYPE_CTAG
,

3723 
NPC_ETYPE_IP6
,

3729 
NPC_S_KPU3_DSA
, 0xff,

3730 
NPC_ETYPE_CTAG
,

3732 
NPC_ETYPE_ARP
,

3738 
NPC_S_KPU3_DSA
, 0xff,

3739 
NPC_ETYPE_CTAG
,

3741 
NPC_ETYPE_RARP
,

3747 
NPC_S_KPU3_DSA
, 0xff,

3748 
NPC_ETYPE_CTAG
,

3750 
NPC_ETYPE_PTP
,

3756 
NPC_S_KPU3_DSA
, 0xff,

3757 
NPC_ETYPE_CTAG
,

3759 
NPC_ETYPE_FCOE
,

3765 
NPC_S_KPU3_DSA
, 0xff,

3766 
NPC_ETYPE_CTAG
,

3774 
NPC_S_KPU3_DSA
, 0xff,

3783 
NPC_S_KPU3_VLAN_EXDSA
, 0xff,

3792 
NPC_S_NA
, 0X00,

3802 
≈c_kpu_¥ofûe_ˇm
 
	gkpu4_ˇm_íåõs
[] = {

3803 
NPC_KPU_NOP_CAM
,

3804 
NPC_KPU_NOP_CAM
,

3805 
NPC_KPU_NOP_CAM
,

3806 
NPC_KPU_NOP_CAM
,

3807 
NPC_KPU_NOP_CAM
,

3808 
NPC_KPU_NOP_CAM
,

3810 
NPC_S_KPU4_MPLS
, 0xff,

3811 
NPC_MPLS_S
,

3812 
NPC_MPLS_S
,

3819 
NPC_S_KPU4_MPLS
, 0xff,

3821 
NPC_MPLS_S
,

3822 
NPC_MPLS_S
,

3823 
NPC_MPLS_S
,

3828 
NPC_S_KPU4_MPLS
, 0xff,

3830 
NPC_MPLS_S
,

3832 
NPC_MPLS_S
,

3833 
NPC_MPLS_S
,

3834 
NPC_MPLS_S
,

3837 
NPC_S_KPU4_MPLS
, 0xff,

3839 
NPC_MPLS_S
,

3841 
NPC_MPLS_S
,

3843 
NPC_MPLS_S
,

3846 
NPC_S_KPU4_NSH
, 0xff,

3847 
NPC_NSH_NP_IP
,

3848 
NPC_NSH_NP_MASK
,

3855 
NPC_S_KPU4_NSH
, 0xff,

3856 
NPC_NSH_NP_IP6
,

3857 
NPC_NSH_NP_MASK
,

3864 
NPC_S_KPU4_NSH
, 0xff,

3865 
NPC_NSH_NP_ETH
,

3866 
NPC_NSH_NP_MASK
,

3873 
NPC_S_KPU4_NSH
, 0xff,

3874 
NPC_NSH_NP_MPLS
,

3875 
NPC_NSH_NP_MASK
,

3882 
NPC_S_KPU4_NSH
, 0xff,

3891 
NPC_S_KPU4_FDSA
, 0xff,

3892 
NPC_ETYPE_IP
,

3900 
NPC_S_KPU4_FDSA
, 0xff,

3901 
NPC_ETYPE_IP6
,

3909 
NPC_S_KPU4_FDSA
, 0xff,

3910 
NPC_ETYPE_ARP
,

3918 
NPC_S_KPU4_FDSA
, 0xff,

3919 
NPC_ETYPE_RARP
,

3927 
NPC_S_KPU4_FDSA
, 0xff,

3928 
NPC_ETYPE_PTP
,

3936 
NPC_S_KPU4_FDSA
, 0xff,

3937 
NPC_ETYPE_FCOE
,

3945 
NPC_S_KPU4_FDSA
, 0xff,

3946 
NPC_ETYPE_CTAG
,

3948 
NPC_ETYPE_IP
,

3954 
NPC_S_KPU4_FDSA
, 0xff,

3955 
NPC_ETYPE_CTAG
,

3957 
NPC_ETYPE_IP6
,

3963 
NPC_S_KPU4_FDSA
, 0xff,

3964 
NPC_ETYPE_CTAG
,

3966 
NPC_ETYPE_ARP
,

3972 
NPC_S_KPU4_FDSA
, 0xff,

3973 
NPC_ETYPE_CTAG
,

3975 
NPC_ETYPE_RARP
,

3981 
NPC_S_KPU4_FDSA
, 0xff,

3982 
NPC_ETYPE_CTAG
,

3984 
NPC_ETYPE_PTP
,

3990 
NPC_S_KPU4_FDSA
, 0xff,

3991 
NPC_ETYPE_CTAG
,

3993 
NPC_ETYPE_FCOE
,

3999 
NPC_S_KPU4_FDSA
, 0xff,

4000 
NPC_ETYPE_PPPOE
,

4004 
NPC_PPP_IP
,

4008 
NPC_S_KPU4_FDSA
, 0xff,

4009 
NPC_ETYPE_PPPOE
,

4013 
NPC_PPP_IP6
,

4017 
NPC_S_KPU4_FDSA
, 0xff,

4019 
NPC_DSA_FDSA
,

4026 
NPC_S_KPU4_VLAN_EXDSA
, 0xff,

4027 
NPC_ETYPE_IP
,

4035 
NPC_S_KPU4_VLAN_EXDSA
, 0xff,

4036 
NPC_ETYPE_IP6
,

4044 
NPC_S_KPU4_VLAN_EXDSA
, 0xff,

4045 
NPC_ETYPE_ARP
,

4053 
NPC_S_KPU4_VLAN_EXDSA
, 0xff,

4054 
NPC_ETYPE_RARP
,

4062 
NPC_S_KPU4_VLAN_EXDSA
, 0xff,

4063 
NPC_ETYPE_PTP
,

4071 
NPC_S_KPU4_VLAN_EXDSA
, 0xff,

4072 
NPC_ETYPE_FCOE
,

4080 
NPC_S_KPU4_VLAN_EXDSA
, 0xff,

4089 
NPC_S_KPU4_PPPOE
, 0xff,

4090 
NPC_PPP_IP
,

4098 
NPC_S_KPU4_PPPOE
, 0xff,

4099 
NPC_PPP_IP6
,

4107 
NPC_S_NA
, 0X00,

4117 
≈c_kpu_¥ofûe_ˇm
 
	gkpu5_ˇm_íåõs
[] = {

4118 
NPC_KPU_NOP_CAM
,

4119 
NPC_KPU_NOP_CAM
,

4120 
NPC_KPU_NOP_CAM
,

4121 
NPC_KPU_NOP_CAM
,

4122 
NPC_KPU_NOP_CAM
,

4123 
NPC_KPU_NOP_CAM
,

4125 
NPC_S_KPU5_IP
, 0xff,

4127 
NPC_IP_TTL_MASK
,

4134 
NPC_S_KPU5_IP
, 0xff,

4140 
NPC_IP_HDR_FRAGOFF
,

4143 
NPC_S_KPU5_IP
, 0xff,

4144 
NPC_IPNH_TCP
,

4146 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4147 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4149 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4152 
NPC_S_KPU5_IP
, 0xff,

4153 
NPC_IPNH_UDP
,

4155 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4156 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4158 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4161 
NPC_S_KPU5_IP
, 0xff,

4162 
NPC_IPNH_SCTP
,

4164 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4165 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4167 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4170 
NPC_S_KPU5_IP
, 0xff,

4171 
NPC_IPNH_ICMP
,

4173 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4174 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4176 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4179 
NPC_S_KPU5_IP
, 0xff,

4180 
NPC_IPNH_IGMP
,

4182 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4183 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4185 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4188 
NPC_S_KPU5_IP
, 0xff,

4189 
NPC_IPNH_ESP
,

4191 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4192 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4194 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4197 
NPC_S_KPU5_IP
, 0xff,

4198 
NPC_IPNH_AH
,

4200 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4201 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4203 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4206 
NPC_S_KPU5_IP
, 0xff,

4207 
NPC_IPNH_GRE
,

4209 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4210 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4212 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4215 
NPC_S_KPU5_IP
, 0xff,

4216 
NPC_IPNH_IP
,

4218 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4219 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4221 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4224 
NPC_S_KPU5_IP
, 0xff,

4225 
NPC_IPNH_IP6
,

4227 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4228 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4230 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4233 
NPC_S_KPU5_IP
, 0xff,

4234 
NPC_IPNH_MPLS
,

4236 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4237 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4239 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4242 
NPC_S_KPU5_IP
, 0xff,

4245 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4246 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4248 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4251 
NPC_S_KPU5_IP
, 0xff,

4254 
NPC_IP_VER_4
|
NPC_IP_HDR_LEN_5
,

4255 
NPC_IP_VER_MASK
|
NPC_IP_HDR_LEN_MASK
,

4260 
NPC_S_KPU5_IP
, 0xff,

4261 
NPC_IPNH_TCP
,

4263 
NPC_IP_VER_4
,

4264 
NPC_IP_VER_MASK
,

4266 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4269 
NPC_S_KPU5_IP
, 0xff,

4270 
NPC_IPNH_UDP
,

4272 
NPC_IP_VER_4
,

4273 
NPC_IP_VER_MASK
,

4275 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4278 
NPC_S_KPU5_IP
, 0xff,

4279 
NPC_IPNH_SCTP
,

4281 
NPC_IP_VER_4
,

4282 
NPC_IP_VER_MASK
,

4284 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4287 
NPC_S_KPU5_IP
, 0xff,

4288 
NPC_IPNH_ICMP
,

4290 
NPC_IP_VER_4
,

4291 
NPC_IP_VER_MASK
,

4293 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4296 
NPC_S_KPU5_IP
, 0xff,

4297 
NPC_IPNH_IGMP
,

4299 
NPC_IP_VER_4
,

4300 
NPC_IP_VER_MASK
,

4302 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4305 
NPC_S_KPU5_IP
, 0xff,

4306 
NPC_IPNH_ESP
,

4308 
NPC_IP_VER_4
,

4309 
NPC_IP_VER_MASK
,

4311 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4314 
NPC_S_KPU5_IP
, 0xff,

4315 
NPC_IPNH_AH
,

4317 
NPC_IP_VER_4
,

4318 
NPC_IP_VER_MASK
,

4320 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4323 
NPC_S_KPU5_IP
, 0xff,

4324 
NPC_IPNH_GRE
,

4326 
NPC_IP_VER_4
,

4327 
NPC_IP_VER_MASK
,

4329 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4332 
NPC_S_KPU5_IP
, 0xff,

4333 
NPC_IPNH_IP
,

4335 
NPC_IP_VER_4
,

4336 
NPC_IP_VER_MASK
,

4338 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4341 
NPC_S_KPU5_IP
, 0xff,

4342 
NPC_IPNH_IP6
,

4344 
NPC_IP_VER_4
,

4345 
NPC_IP_VER_MASK
,

4347 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4350 
NPC_S_KPU5_IP
, 0xff,

4351 
NPC_IPNH_MPLS
,

4353 
NPC_IP_VER_4
,

4354 
NPC_IP_VER_MASK
,

4356 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4359 
NPC_S_KPU5_IP
, 0xff,

4362 
NPC_IP_VER_4
,

4363 
NPC_IP_VER_MASK
,

4365 
NPC_IP_HDR_MF
|
NPC_IP_HDR_FRAGOFF
,

4368 
NPC_S_KPU5_IP
, 0xff,

4371 
NPC_IP_VER_4
,

4372 
NPC_IP_VER_MASK
,

4377 
NPC_S_KPU5_IP
, 0xff,

4386 
NPC_S_KPU5_ARP
, 0xff,

4395 
NPC_S_KPU5_RARP
, 0xff,

4404 
NPC_S_KPU5_PTP
, 0xff,

4413 
NPC_S_KPU5_FCOE
, 0xff,

4422 
NPC_S_KPU5_IP6
, 0xff,

4424 
NPC_IP6_HOP_MASK
,

4431 
NPC_S_KPU5_IP6
, 0xff,

4432 
NPC_IPNH_TCP
 << 8,

4434 
NPC_IP_VER_6
,

4435 
NPC_IP_VER_MASK
,

4440 
NPC_S_KPU5_IP6
, 0xff,

4441 
NPC_IPNH_UDP
 << 8,

4443 
NPC_IP_VER_6
,

4444 
NPC_IP_VER_MASK
,

4449 
NPC_S_KPU5_IP6
, 0xff,

4450 
NPC_IPNH_SCTP
 << 8,

4452 
NPC_IP_VER_6
,

4453 
NPC_IP_VER_MASK
,

4458 
NPC_S_KPU5_IP6
, 0xff,

4459 
NPC_IPNH_ICMP
 << 8,

4461 
NPC_IP_VER_6
,

4462 
NPC_IP_VER_MASK
,

4467 
NPC_S_KPU5_IP6
, 0xff,

4468 
NPC_IPNH_ICMP6
 << 8,

4470 
NPC_IP_VER_6
,

4471 
NPC_IP_VER_MASK
,

4476 
NPC_S_KPU5_IP6
, 0xff,

4477 
NPC_IPNH_GRE
 << 8,

4479 
NPC_IP_VER_6
,

4480 
NPC_IP_VER_MASK
,

4485 
NPC_S_KPU5_IP6
, 0xff,

4486 
NPC_IPNH_IP6
 << 8,

4488 
NPC_IP_VER_6
,

4489 
NPC_IP_VER_MASK
,

4494 
NPC_S_KPU5_IP6
, 0xff,

4495 
NPC_IPNH_MPLS
 << 8,

4497 
NPC_IP_VER_6
,

4498 
NPC_IP_VER_MASK
,

4503 
NPC_S_KPU5_IP6
, 0xff,

4504 
NPC_IPNH_HOP
 << 8,

4506 
NPC_IP_VER_6
,

4507 
NPC_IP_VER_MASK
,

4512 
NPC_S_KPU5_IP6
, 0xff,

4513 
NPC_IPNH_DEST
 << 8,

4515 
NPC_IP_VER_6
,

4516 
NPC_IP_VER_MASK
,

4521 
NPC_S_KPU5_IP6
, 0xff,

4522 
NPC_IPNH_ROUT
 << 8,

4524 
NPC_IP_VER_6
,

4525 
NPC_IP_VER_MASK
,

4530 
NPC_S_KPU5_IP6
, 0xff,

4531 
NPC_IPNH_FRAG
 << 8,

4533 
NPC_IP_VER_6
,

4534 
NPC_IP_VER_MASK
,

4539 
NPC_S_KPU5_IP6
, 0xff,

4540 
NPC_IPNH_ESP
 << 8,

4542 
NPC_IP_VER_6
,

4543 
NPC_IP_VER_MASK
,

4548 
NPC_S_KPU5_IP6
, 0xff,

4549 
NPC_IPNH_AH
 << 8,

4551 
NPC_IP_VER_6
,

4552 
NPC_IP_VER_MASK
,

4557 
NPC_S_KPU5_IP6
, 0xff,

4558 
NPC_IPNH_MOBILITY
 << 8,

4560 
NPC_IP_VER_6
,

4561 
NPC_IP_VER_MASK
,

4566 
NPC_S_KPU5_IP6
, 0xff,

4567 
NPC_IPNH_HOSTID
 << 8,

4569 
NPC_IP_VER_6
,

4570 
NPC_IP_VER_MASK
,

4575 
NPC_S_KPU5_IP6
, 0xff,

4576 
NPC_IPNH_SHIM6
 << 8,

4578 
NPC_IP_VER_6
,

4579 
NPC_IP_VER_MASK
,

4584 
NPC_S_KPU5_IP6
, 0xff,

4587 
NPC_IP_VER_6
,

4588 
NPC_IP_VER_MASK
,

4593 
NPC_S_KPU5_IP6
, 0xff,

4602 
NPC_S_KPU5_MPLS
, 0xff,

4603 
NPC_MPLS_S
,

4604 
NPC_MPLS_S
,

4605 
NPC_IP_VER_4
,

4606 
NPC_IP_VER_MASK
,

4611 
NPC_S_KPU5_MPLS
, 0xff,

4612 
NPC_MPLS_S
,

4613 
NPC_MPLS_S
,

4614 
NPC_IP_VER_6
,

4615 
NPC_IP_VER_MASK
,

4620 
NPC_S_KPU5_MPLS
, 0xff,

4621 
NPC_MPLS_S
,

4622 
NPC_MPLS_S
,

4629 
NPC_S_KPU5_MPLS
, 0xff,

4630 
NPC_MPLS_S
,

4631 
NPC_MPLS_S
,

4638 
NPC_S_KPU5_MPLS
, 0xff,

4640 
NPC_MPLS_S
,

4647 
NPC_S_KPU5_MPLS_PL
, 0xff,

4648 
NPC_IP_VER_4
,

4649 
NPC_IP_VER_MASK
,

4656 
NPC_S_KPU5_MPLS_PL
, 0xff,

4657 
NPC_IP_VER_6
,

4658 
NPC_IP_VER_MASK
,

4665 
NPC_S_KPU5_MPLS_PL
, 0xff,

4674 
NPC_S_KPU5_MPLS_PL
, 0xff,

4683 
NPC_S_KPU5_CPT_IP
, 0xff,

4685 
NPC_IP_TTL_MASK
,

4692 
NPC_S_KPU5_CPT_IP
, 0xff,

4698 
NPC_IP_HDR_FRAGOFF
,

4701 
NPC_S_KPU5_CPT_IP
, 0xff,

4702 
NPC_IPNH_TCP
,

4704 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4705 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4710 
NPC_S_KPU5_CPT_IP
, 0xff,

4711 
NPC_IPNH_UDP
,

4713 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4714 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4719 
NPC_S_KPU5_CPT_IP
, 0xff,

4720 
NPC_IPNH_SCTP
,

4722 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4723 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4728 
NPC_S_KPU5_CPT_IP
, 0xff,

4729 
NPC_IPNH_ICMP
,

4731 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4732 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4737 
NPC_S_KPU5_CPT_IP
, 0xff,

4738 
NPC_IPNH_IGMP
,

4740 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4741 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4746 
NPC_S_KPU5_CPT_IP
, 0xff,

4747 
NPC_IPNH_ESP
,

4749 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4750 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4755 
NPC_S_KPU5_CPT_IP
, 0xff,

4756 
NPC_IPNH_AH
,

4758 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4759 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4764 
NPC_S_KPU5_CPT_IP
, 0xff,

4765 
NPC_IPNH_GRE
,

4767 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4768 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4773 
NPC_S_KPU5_CPT_IP
, 0xff,

4774 
NPC_IPNH_IP
,

4776 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4777 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4782 
NPC_S_KPU5_CPT_IP
, 0xff,

4783 
NPC_IPNH_IP6
,

4785 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4786 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4791 
NPC_S_KPU5_CPT_IP
, 0xff,

4792 
NPC_IPNH_MPLS
,

4794 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4795 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4800 
NPC_S_KPU5_CPT_IP
, 0xff,

4801 
NPC_IPNH_CUSTOM
,

4803 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4804 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4809 
NPC_S_KPU5_CPT_IP
, 0xff,

4812 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

4813 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

4818 
NPC_S_KPU5_CPT_IP
, 0xff,

4819 
NPC_IPNH_TCP
,

4821 
NPC_IP_VER_4
,

4822 
NPC_IP_VER_MASK
,

4827 
NPC_S_KPU5_CPT_IP
, 0xff,

4828 
NPC_IPNH_UDP
,

4830 
NPC_IP_VER_4
,

4831 
NPC_IP_VER_MASK
,

4836 
NPC_S_KPU5_CPT_IP
, 0xff,

4837 
NPC_IPNH_SCTP
,

4839 
NPC_IP_VER_4
,

4840 
NPC_IP_VER_MASK
,

4845 
NPC_S_KPU5_CPT_IP
, 0xff,

4846 
NPC_IPNH_ICMP
,

4848 
NPC_IP_VER_4
,

4849 
NPC_IP_VER_MASK
,

4854 
NPC_S_KPU5_CPT_IP
, 0xff,

4855 
NPC_IPNH_IGMP
,

4857 
NPC_IP_VER_4
,

4858 
NPC_IP_VER_MASK
,

4863 
NPC_S_KPU5_CPT_IP
, 0xff,

4864 
NPC_IPNH_ESP
,

4866 
NPC_IP_VER_4
,

4867 
NPC_IP_VER_MASK
,

4872 
NPC_S_KPU5_CPT_IP
, 0xff,

4873 
NPC_IPNH_AH
,

4875 
NPC_IP_VER_4
,

4876 
NPC_IP_VER_MASK
,

4881 
NPC_S_KPU5_CPT_IP
, 0xff,

4882 
NPC_IPNH_GRE
,

4884 
NPC_IP_VER_4
,

4885 
NPC_IP_VER_MASK
,

4890 
NPC_S_KPU5_CPT_IP
, 0xff,

4891 
NPC_IPNH_IP
,

4893 
NPC_IP_VER_4
,

4894 
NPC_IP_VER_MASK
,

4899 
NPC_S_KPU5_CPT_IP
, 0xff,

4900 
NPC_IPNH_IP6
,

4902 
NPC_IP_VER_4
,

4903 
NPC_IP_VER_MASK
,

4908 
NPC_S_KPU5_CPT_IP
, 0xff,

4909 
NPC_IPNH_MPLS
,

4911 
NPC_IP_VER_4
,

4912 
NPC_IP_VER_MASK
,

4917 
NPC_S_KPU5_CPT_IP
, 0xff,

4918 
NPC_IPNH_CUSTOM
,

4920 
NPC_IP_VER_4
,

4921 
NPC_IP_VER_MASK
,

4926 
NPC_S_KPU5_CPT_IP
, 0xff,

4929 
NPC_IP_VER_4
,

4930 
NPC_IP_VER_MASK
,

4935 
NPC_S_KPU5_CPT_IP
, 0xff,

4944 
NPC_S_KPU5_CPT_IP6
, 0xff,

4946 
NPC_IP6_HOP_MASK
,

4953 
NPC_S_KPU5_CPT_IP6
, 0xff,

4954 
NPC_IPNH_TCP
 << 8,

4956 
NPC_IP_VER_6
,

4957 
NPC_IP_VER_MASK
,

4962 
NPC_S_KPU5_CPT_IP6
, 0xff,

4963 
NPC_IPNH_UDP
 << 8,

4965 
NPC_IP_VER_6
,

4966 
NPC_IP_VER_MASK
,

4971 
NPC_S_KPU5_CPT_IP6
, 0xff,

4972 
NPC_IPNH_SCTP
 << 8,

4974 
NPC_IP_VER_6
,

4975 
NPC_IP_VER_MASK
,

4980 
NPC_S_KPU5_CPT_IP6
, 0xff,

4981 
NPC_IPNH_ICMP
 << 8,

4983 
NPC_IP_VER_6
,

4984 
NPC_IP_VER_MASK
,

4989 
NPC_S_KPU5_CPT_IP6
, 0xff,

4990 
NPC_IPNH_ICMP6
 << 8,

4992 
NPC_IP_VER_6
,

4993 
NPC_IP_VER_MASK
,

4998 
NPC_S_KPU5_CPT_IP6
, 0xff,

4999 
NPC_IPNH_GRE
 << 8,

5001 
NPC_IP_VER_6
,

5002 
NPC_IP_VER_MASK
,

5007 
NPC_S_KPU5_CPT_IP6
, 0xff,

5008 
NPC_IPNH_IP6
 << 8,

5010 
NPC_IP_VER_6
,

5011 
NPC_IP_VER_MASK
,

5016 
NPC_S_KPU5_CPT_IP6
, 0xff,

5017 
NPC_IPNH_MPLS
 << 8,

5019 
NPC_IP_VER_6
,

5020 
NPC_IP_VER_MASK
,

5025 
NPC_S_KPU5_CPT_IP6
, 0xff,

5026 
NPC_IPNH_HOP
 << 8,

5028 
NPC_IP_VER_6
,

5029 
NPC_IP_VER_MASK
,

5034 
NPC_S_KPU5_CPT_IP6
, 0xff,

5035 
NPC_IPNH_DEST
 << 8,

5037 
NPC_IP_VER_6
,

5038 
NPC_IP_VER_MASK
,

5043 
NPC_S_KPU5_CPT_IP6
, 0xff,

5044 
NPC_IPNH_ROUT
 << 8,

5046 
NPC_IP_VER_6
,

5047 
NPC_IP_VER_MASK
,

5052 
NPC_S_KPU5_CPT_IP6
, 0xff,

5053 
NPC_IPNH_FRAG
 << 8,

5055 
NPC_IP_VER_6
,

5056 
NPC_IP_VER_MASK
,

5061 
NPC_S_KPU5_CPT_IP6
, 0xff,

5062 
NPC_IPNH_ESP
 << 8,

5064 
NPC_IP_VER_6
,

5065 
NPC_IP_VER_MASK
,

5070 
NPC_S_KPU5_CPT_IP6
, 0xff,

5071 
NPC_IPNH_AH
 << 8,

5073 
NPC_IP_VER_6
,

5074 
NPC_IP_VER_MASK
,

5079 
NPC_S_KPU5_CPT_IP6
, 0xff,

5080 
NPC_IPNH_MOBILITY
 << 8,

5082 
NPC_IP_VER_6
,

5083 
NPC_IP_VER_MASK
,

5088 
NPC_S_KPU5_CPT_IP6
, 0xff,

5089 
NPC_IPNH_HOSTID
 << 8,

5091 
NPC_IP_VER_6
,

5092 
NPC_IP_VER_MASK
,

5097 
NPC_S_KPU5_CPT_IP6
, 0xff,

5098 
NPC_IPNH_SHIM6
 << 8,

5100 
NPC_IP_VER_6
,

5101 
NPC_IP_VER_MASK
,

5106 
NPC_S_KPU5_CPT_IP6
, 0xff,

5107 
NPC_IPNH_CUSTOM
 << 8,

5109 
NPC_IP_VER_6
,

5110 
NPC_IP_VER_MASK
,

5115 
NPC_S_KPU5_CPT_IP6
, 0xff,

5118 
NPC_IP_VER_6
,

5119 
NPC_IP_VER_MASK
,

5124 
NPC_S_KPU5_CPT_IP6
, 0xff,

5133 
NPC_S_KPU5_NGIO
, 0xff,

5142 
NPC_S_NA
, 0X00,

5152 
≈c_kpu_¥ofûe_ˇm
 
	gkpu6_ˇm_íåõs
[] = {

5153 
NPC_KPU_NOP_CAM
,

5154 
NPC_KPU_NOP_CAM
,

5155 
NPC_KPU_NOP_CAM
,

5156 
NPC_KPU_NOP_CAM
,

5157 
NPC_KPU_NOP_CAM
,

5158 
NPC_KPU_NOP_CAM
,

5160 
NPC_S_KPU6_IP6_EXT
, 0xff,

5169 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5170 
NPC_IPNH_TCP
 << 8,

5173 
NPC_IP6_FRAG_FRAGOFF
,

5178 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5179 
NPC_IPNH_UDP
 << 8,

5182 
NPC_IP6_FRAG_FRAGOFF
,

5187 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5188 
NPC_IPNH_SCTP
 << 8,

5191 
NPC_IP6_FRAG_FRAGOFF
,

5196 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5197 
NPC_IPNH_ICMP
 << 8,

5200 
NPC_IP6_FRAG_FRAGOFF
,

5205 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5206 
NPC_IPNH_ICMP6
 << 8,

5209 
NPC_IP6_FRAG_FRAGOFF
,

5214 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5215 
NPC_IPNH_ESP
 << 8,

5218 
NPC_IP6_FRAG_FRAGOFF
,

5223 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5224 
NPC_IPNH_AH
 << 8,

5227 
NPC_IP6_FRAG_FRAGOFF
,

5232 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5233 
NPC_IPNH_GRE
 << 8,

5236 
NPC_IP6_FRAG_FRAGOFF
,

5241 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5242 
NPC_IPNH_IP6
 << 8,

5245 
NPC_IP6_FRAG_FRAGOFF
,

5250 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5251 
NPC_IPNH_MPLS
 << 8,

5254 
NPC_IP6_FRAG_FRAGOFF
,

5259 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5260 
NPC_IPNH_CUSTOM
 << 8,

5263 
NPC_IP6_FRAG_FRAGOFF
,

5268 
NPC_S_KPU6_IP6_FRAG
, 0xff,

5277 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5278 
NPC_IPNH_TCP
 << 8,

5286 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5287 
NPC_IPNH_UDP
 << 8,

5295 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5296 
NPC_IPNH_SCTP
 << 8,

5304 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5305 
NPC_IPNH_ICMP
 << 8,

5313 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5314 
NPC_IPNH_ICMP6
 << 8,

5322 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5323 
NPC_IPNH_ESP
 << 8,

5331 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5332 
NPC_IPNH_AH
 << 8,

5340 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5341 
NPC_IPNH_GRE
 << 8,

5349 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5350 
NPC_IPNH_IP6
 << 8,

5358 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5359 
NPC_IPNH_MPLS
 << 8,

5367 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5368 
NPC_IPNH_ROUT
 << 8,

5376 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5377 
NPC_IPNH_FRAG
 << 8,

5385 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5386 
NPC_IPNH_CUSTOM
 << 8,

5394 
NPC_S_KPU6_IP6_HOP_DEST
, 0xff,

5403 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5404 
NPC_IPNH_TCP
 << 8,

5412 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5413 
NPC_IPNH_UDP
 << 8,

5421 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5422 
NPC_IPNH_SCTP
 << 8,

5430 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5431 
NPC_IPNH_ICMP
 << 8,

5439 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5440 
NPC_IPNH_ICMP6
 << 8,

5448 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5449 
NPC_IPNH_ESP
 << 8,

5457 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5458 
NPC_IPNH_AH
 << 8,

5466 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5467 
NPC_IPNH_GRE
 << 8,

5475 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5476 
NPC_IPNH_IP6
 << 8,

5484 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5485 
NPC_IPNH_MPLS
 << 8,

5493 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5494 
NPC_IPNH_FRAG
 << 8,

5502 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5503 
NPC_IPNH_CUSTOM
 << 8,

5511 
NPC_S_KPU6_IP6_ROUT
, 0xff,

5520 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5521 
NPC_IPNH_TCP
 << 8,

5529 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5530 
NPC_IPNH_UDP
 << 8,

5538 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5539 
NPC_IPNH_SCTP
 << 8,

5547 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5548 
NPC_IPNH_ICMP
 << 8,

5556 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5557 
NPC_IPNH_ICMP6
 << 8,

5565 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5566 
NPC_IPNH_ESP
 << 8,

5574 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5575 
NPC_IPNH_AH
 << 8,

5583 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5584 
NPC_IPNH_GRE
 << 8,

5592 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5593 
NPC_IPNH_IP6
 << 8,

5601 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5602 
NPC_IPNH_MPLS
 << 8,

5610 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5611 
NPC_IPNH_CUSTOM
 << 8,

5619 
NPC_S_KPU6_IP6_CPT_FRAG
, 0xff,

5628 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5629 
NPC_IPNH_TCP
 << 8,

5637 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5638 
NPC_IPNH_UDP
 << 8,

5646 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5647 
NPC_IPNH_SCTP
 << 8,

5655 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5656 
NPC_IPNH_ICMP
 << 8,

5664 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5665 
NPC_IPNH_ICMP6
 << 8,

5673 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5674 
NPC_IPNH_ESP
 << 8,

5682 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5683 
NPC_IPNH_AH
 << 8,

5691 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5692 
NPC_IPNH_GRE
 << 8,

5700 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5701 
NPC_IPNH_IP6
 << 8,

5709 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5710 
NPC_IPNH_MPLS
 << 8,

5718 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5719 
NPC_IPNH_ROUT
 << 8,

5727 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5728 
NPC_IPNH_FRAG
 << 8,

5736 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5737 
NPC_IPNH_CUSTOM
 << 8,

5745 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 0xff,

5754 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5755 
NPC_IPNH_TCP
 << 8,

5763 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5764 
NPC_IPNH_UDP
 << 8,

5772 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5773 
NPC_IPNH_SCTP
 << 8,

5781 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5782 
NPC_IPNH_ICMP
 << 8,

5790 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5791 
NPC_IPNH_ICMP6
 << 8,

5799 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5800 
NPC_IPNH_ESP
 << 8,

5808 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5809 
NPC_IPNH_AH
 << 8,

5817 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5818 
NPC_IPNH_GRE
 << 8,

5826 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5827 
NPC_IPNH_IP6
 << 8,

5835 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5836 
NPC_IPNH_MPLS
 << 8,

5844 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5845 
NPC_IPNH_FRAG
 << 8,

5853 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5854 
NPC_IPNH_CUSTOM
 << 8,

5862 
NPC_S_KPU6_IP6_CPT_ROUT
, 0xff,

5871 
NPC_S_NA
, 0X00,

5881 
≈c_kpu_¥ofûe_ˇm
 
	gkpu7_ˇm_íåõs
[] = {

5882 
NPC_KPU_NOP_CAM
,

5883 
NPC_KPU_NOP_CAM
,

5884 
NPC_KPU_NOP_CAM
,

5885 
NPC_KPU_NOP_CAM
,

5886 
NPC_KPU_NOP_CAM
,

5887 
NPC_KPU_NOP_CAM
,

5889 
NPC_S_KPU7_IP6_EXT
, 0xff,

5898 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5899 
NPC_IPNH_TCP
 << 8,

5907 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5908 
NPC_IPNH_UDP
 << 8,

5916 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5917 
NPC_IPNH_SCTP
 << 8,

5925 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5926 
NPC_IPNH_ICMP
 << 8,

5934 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5935 
NPC_IPNH_ICMP6
 << 8,

5943 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5944 
NPC_IPNH_ESP
 << 8,

5952 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5953 
NPC_IPNH_AH
 << 8,

5961 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5962 
NPC_IPNH_GRE
 << 8,

5970 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5971 
NPC_IPNH_IP6
 << 8,

5979 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5980 
NPC_IPNH_MPLS
 << 8,

5988 
NPC_S_KPU7_IP6_ROUT
, 0xff,

5989 
NPC_IPNH_CUSTOM
 << 8,

5997 
NPC_S_KPU7_IP6_ROUT
, 0xff,

6006 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6007 
NPC_IPNH_TCP
 << 8,

6010 
NPC_IP6_FRAG_FRAGOFF
,

6015 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6016 
NPC_IPNH_UDP
 << 8,

6019 
NPC_IP6_FRAG_FRAGOFF
,

6024 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6025 
NPC_IPNH_SCTP
 << 8,

6028 
NPC_IP6_FRAG_FRAGOFF
,

6033 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6034 
NPC_IPNH_ICMP
 << 8,

6037 
NPC_IP6_FRAG_FRAGOFF
,

6042 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6043 
NPC_IPNH_ICMP6
 << 8,

6046 
NPC_IP6_FRAG_FRAGOFF
,

6051 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6052 
NPC_IPNH_ESP
 << 8,

6055 
NPC_IP6_FRAG_FRAGOFF
,

6060 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6061 
NPC_IPNH_AH
 << 8,

6064 
NPC_IP6_FRAG_FRAGOFF
,

6069 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6070 
NPC_IPNH_GRE
 << 8,

6073 
NPC_IP6_FRAG_FRAGOFF
,

6078 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6079 
NPC_IPNH_IP6
 << 8,

6082 
NPC_IP6_FRAG_FRAGOFF
,

6087 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6088 
NPC_IPNH_MPLS
 << 8,

6091 
NPC_IP6_FRAG_FRAGOFF
,

6096 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6097 
NPC_IPNH_CUSTOM
 << 8,

6100 
NPC_IP6_FRAG_FRAGOFF
,

6105 
NPC_S_KPU7_IP6_FRAG
, 0xff,

6114 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6115 
NPC_IPNH_TCP
 << 8,

6123 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6124 
NPC_IPNH_UDP
 << 8,

6132 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6133 
NPC_IPNH_SCTP
 << 8,

6141 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6142 
NPC_IPNH_ICMP
 << 8,

6150 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6151 
NPC_IPNH_ICMP6
 << 8,

6159 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6160 
NPC_IPNH_ESP
 << 8,

6168 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6169 
NPC_IPNH_AH
 << 8,

6177 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6178 
NPC_IPNH_GRE
 << 8,

6186 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6187 
NPC_IPNH_IP6
 << 8,

6195 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6196 
NPC_IPNH_MPLS
 << 8,

6204 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6205 
NPC_IPNH_CUSTOM
 << 8,

6213 
NPC_S_KPU7_CPT_IP6_FRAG
, 0xff,

6222 
NPC_S_NA
, 0X00,

6232 
≈c_kpu_¥ofûe_ˇm
 
	gkpu8_ˇm_íåõs
[] = {

6233 
NPC_KPU_NOP_CAM
,

6234 
NPC_KPU_NOP_CAM
,

6235 
NPC_KPU_NOP_CAM
,

6236 
NPC_KPU_NOP_CAM
,

6237 
NPC_KPU_NOP_CAM
,

6238 
NPC_KPU_NOP_CAM
,

6240 
NPC_S_KPU8_TCP
, 0xff,

6243 
NPC_TCP_FLAGS_FIN
,

6244 
NPC_TCP_FLAGS_MASK
,

6249 
NPC_S_KPU8_TCP
, 0xff,

6253 
NPC_TCP_FLAGS_MASK
,

6258 
NPC_S_KPU8_TCP
, 0xff,

6261 
NPC_TCP_FLAGS_RST
 | 
NPC_TCP_FLAGS_FIN
,

6262 
NPC_TCP_FLAGS_RST
 | 
NPC_TCP_FLAGS_FIN
,

6267 
NPC_S_KPU8_TCP
, 0xff,

6270 
NPC_TCP_FLAGS_URG
 | 
NPC_TCP_FLAGS_SYN
,

6271 
NPC_TCP_FLAGS_URG
 | 
NPC_TCP_FLAGS_SYN
,

6276 
NPC_S_KPU8_TCP
, 0xff,

6279 
NPC_TCP_FLAGS_RST
 | 
NPC_TCP_FLAGS_SYN
,

6280 
NPC_TCP_FLAGS_RST
 | 
NPC_TCP_FLAGS_SYN
,

6285 
NPC_S_KPU8_TCP
, 0xff,

6288 
NPC_TCP_FLAGS_SYN
 | 
NPC_TCP_FLAGS_FIN
,

6289 
NPC_TCP_FLAGS_SYN
 | 
NPC_TCP_FLAGS_FIN
,

6294 
NPC_S_KPU8_TCP
, 0xff,

6295 
NPC_TCP_PORT_HTTP
,

6297 
NPC_TCP_DATA_OFFSET_5
,

6298 
NPC_TCP_DATA_OFFSET_MASK
,

6303 
NPC_S_KPU8_TCP
, 0xff,

6304 
NPC_TCP_PORT_HTTPS
,

6306 
NPC_TCP_DATA_OFFSET_5
,

6307 
NPC_TCP_DATA_OFFSET_MASK
,

6312 
NPC_S_KPU8_TCP
, 0xff,

6313 
NPC_TCP_PORT_PPTP
,

6315 
NPC_TCP_DATA_OFFSET_5
,

6316 
NPC_TCP_DATA_OFFSET_MASK
,

6321 
NPC_S_KPU8_TCP
, 0xff,

6324 
NPC_TCP_DATA_OFFSET_5
,

6325 
NPC_TCP_DATA_OFFSET_MASK
,

6330 
NPC_S_KPU8_TCP
, 0xff,

6331 
NPC_TCP_PORT_HTTP
,

6339 
NPC_S_KPU8_TCP
, 0xff,

6340 
NPC_TCP_PORT_HTTPS
,

6348 
NPC_S_KPU8_TCP
, 0xff,

6349 
NPC_TCP_PORT_PPTP
,

6357 
NPC_S_KPU8_TCP
, 0xff,

6366 
NPC_S_KPU8_UDP
, 0xff,

6367 
NPC_UDP_PORT_VXLAN
,

6375 
NPC_S_KPU8_UDP
, 0xff,

6376 
NPC_UDP_PORT_VXLANGPE
,

6384 
NPC_S_KPU8_UDP
, 0xff,

6385 
NPC_UDP_PORT_GENEVE
,

6393 
NPC_S_KPU8_UDP
, 0xff,

6394 
NPC_UDP_PORT_GTPC
,

6402 
NPC_S_KPU8_UDP
, 0xff,

6403 
NPC_UDP_PORT_GTPU
,

6411 
NPC_S_KPU8_UDP
, 0xff,

6412 
NPC_UDP_PORT_PTP_E
,

6420 
NPC_S_KPU8_UDP
, 0xff,

6421 
NPC_UDP_PORT_PTP_G
,

6429 
NPC_S_KPU8_UDP
, 0xff,

6430 
NPC_UDP_PORT_MPLS
,

6438 
NPC_S_KPU8_UDP
, 0xff,

6439 
NPC_UDP_PORT_ESP
,

6447 
NPC_S_KPU8_UDP
, 0xff,

6448 
NPC_UDP_PORT_ESP
,

6456 
NPC_S_KPU8_UDP
, 0xff,

6459 
NPC_UDP_PORT_ESP
,

6465 
NPC_S_KPU8_UDP
, 0xff,

6474 
NPC_S_KPU8_SCTP
, 0xff,

6483 
NPC_S_KPU8_ICMP
, 0xff,

6492 
NPC_S_KPU8_IGMP
, 0xff,

6501 
NPC_S_KPU8_ICMP6
, 0xff,

6510 
NPC_S_KPU8_AH
, 0xff,

6519 
NPC_S_KPU8_GRE
, 0xff,

6520 
NPC_ETYPE_TRANS_ETH_BR
,

6522 
NPC_GRE_F_KEY
,

6528 
NPC_S_KPU8_GRE
, 0xff,

6529 
NPC_ETYPE_TRANS_ETH_BR
,

6537 
NPC_S_KPU8_GRE
, 0xff,

6538 
NPC_ETYPE_MPLSU
,

6546 
NPC_S_KPU8_GRE
, 0xff,

6547 
NPC_ETYPE_MPLSU
,

6549 
NPC_GRE_F_CSUM
,

6555 
NPC_S_KPU8_GRE
, 0xff,

6556 
NPC_ETYPE_MPLSU
,

6558 
NPC_GRE_F_KEY
,

6564 
NPC_S_KPU8_GRE
, 0xff,

6565 
NPC_ETYPE_MPLSU
,

6567 
NPC_GRE_F_SEQ
,

6573 
NPC_S_KPU8_GRE
, 0xff,

6574 
NPC_ETYPE_MPLSU
,

6576 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
,

6582 
NPC_S_KPU8_GRE
, 0xff,

6583 
NPC_ETYPE_MPLSU
,

6585 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_SEQ
,

6591 
NPC_S_KPU8_GRE
, 0xff,

6592 
NPC_ETYPE_MPLSU
,

6594 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6600 
NPC_S_KPU8_GRE
, 0xff,

6601 
NPC_ETYPE_MPLSU
,

6603 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6609 
NPC_S_KPU8_GRE
, 0xff,

6610 
NPC_ETYPE_MPLSM
,

6618 
NPC_S_KPU8_GRE
, 0xff,

6619 
NPC_ETYPE_MPLSM
,

6621 
NPC_GRE_F_CSUM
,

6627 
NPC_S_KPU8_GRE
, 0xff,

6628 
NPC_ETYPE_MPLSM
,

6630 
NPC_GRE_F_KEY
,

6636 
NPC_S_KPU8_GRE
, 0xff,

6637 
NPC_ETYPE_MPLSM
,

6639 
NPC_GRE_F_SEQ
,

6645 
NPC_S_KPU8_GRE
, 0xff,

6646 
NPC_ETYPE_MPLSM
,

6648 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
,

6654 
NPC_S_KPU8_GRE
, 0xff,

6655 
NPC_ETYPE_MPLSM
,

6657 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_SEQ
,

6663 
NPC_S_KPU8_GRE
, 0xff,

6664 
NPC_ETYPE_MPLSM
,

6666 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6672 
NPC_S_KPU8_GRE
, 0xff,

6673 
NPC_ETYPE_MPLSM
,

6675 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6681 
NPC_S_KPU8_GRE
, 0xff,

6682 
NPC_ETYPE_NSH
,

6690 
NPC_S_KPU8_GRE
, 0xff,

6691 
NPC_ETYPE_NSH
,

6693 
NPC_GRE_F_CSUM
,

6699 
NPC_S_KPU8_GRE
, 0xff,

6700 
NPC_ETYPE_NSH
,

6702 
NPC_GRE_F_KEY
,

6708 
NPC_S_KPU8_GRE
, 0xff,

6709 
NPC_ETYPE_NSH
,

6711 
NPC_GRE_F_SEQ
,

6717 
NPC_S_KPU8_GRE
, 0xff,

6718 
NPC_ETYPE_NSH
,

6720 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
,

6726 
NPC_S_KPU8_GRE
, 0xff,

6727 
NPC_ETYPE_NSH
,

6729 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_SEQ
,

6735 
NPC_S_KPU8_GRE
, 0xff,

6736 
NPC_ETYPE_NSH
,

6738 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6744 
NPC_S_KPU8_GRE
, 0xff,

6745 
NPC_ETYPE_NSH
,

6747 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6753 
NPC_S_KPU8_GRE
, 0xff,

6754 
NPC_ETYPE_IP
,

6762 
NPC_S_KPU8_GRE
, 0xff,

6763 
NPC_ETYPE_IP
,

6765 
NPC_GRE_F_CSUM
,

6771 
NPC_S_KPU8_GRE
, 0xff,

6772 
NPC_ETYPE_IP
,

6774 
NPC_GRE_F_KEY
,

6780 
NPC_S_KPU8_GRE
, 0xff,

6781 
NPC_ETYPE_IP
,

6783 
NPC_GRE_F_SEQ
,

6789 
NPC_S_KPU8_GRE
, 0xff,

6790 
NPC_ETYPE_IP
,

6792 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
,

6798 
NPC_S_KPU8_GRE
, 0xff,

6799 
NPC_ETYPE_IP
,

6801 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_SEQ
,

6807 
NPC_S_KPU8_GRE
, 0xff,

6808 
NPC_ETYPE_IP
,

6810 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6816 
NPC_S_KPU8_GRE
, 0xff,

6817 
NPC_ETYPE_IP
,

6819 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6825 
NPC_S_KPU8_GRE
, 0xff,

6826 
NPC_ETYPE_IP6
,

6834 
NPC_S_KPU8_GRE
, 0xff,

6835 
NPC_ETYPE_IP6
,

6837 
NPC_GRE_F_CSUM
,

6843 
NPC_S_KPU8_GRE
, 0xff,

6844 
NPC_ETYPE_IP6
,

6846 
NPC_GRE_F_KEY
,

6852 
NPC_S_KPU8_GRE
, 0xff,

6853 
NPC_ETYPE_IP6
,

6855 
NPC_GRE_F_SEQ
,

6861 
NPC_S_KPU8_GRE
, 0xff,

6862 
NPC_ETYPE_IP6
,

6864 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
,

6870 
NPC_S_KPU8_GRE
, 0xff,

6871 
NPC_ETYPE_IP6
,

6873 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_SEQ
,

6879 
NPC_S_KPU8_GRE
, 0xff,

6880 
NPC_ETYPE_IP6
,

6882 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6888 
NPC_S_KPU8_GRE
, 0xff,

6889 
NPC_ETYPE_IP6
,

6891 
NPC_GRE_F_CSUM
 | 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
,

6897 
NPC_S_KPU8_GRE
, 0xff,

6900 
NPC_GRE_F_ROUTE
,

6906 
NPC_S_KPU8_GRE
, 0xff,

6915 
NPC_S_KPU8_GRE
, 0xff,

6924 
NPC_S_KPU8_GRE
, 0xff,

6925 
NPC_ETYPE_PPP
,

6927 
NPC_GRE_F_KEY
 | 
NPC_GRE_VER_1
,

6933 
NPC_S_KPU8_GRE
, 0xff,

6934 
NPC_ETYPE_PPP
,

6936 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
 | 
NPC_GRE_VER_1
,

6942 
NPC_S_KPU8_GRE
, 0xff,

6943 
NPC_ETYPE_PPP
,

6945 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_ACK
 | 
NPC_GRE_VER_1
,

6951 
NPC_S_KPU8_GRE
, 0xff,

6952 
NPC_ETYPE_PPP
,

6954 
NPC_GRE_F_KEY
 | 
NPC_GRE_F_SEQ
 | 
NPC_GRE_F_ACK
 | 
NPC_GRE_VER_1
,

6960 
NPC_S_KPU8_GRE
, 0xff,

6969 
NPC_S_KPU8_GRE
, 0xff,

6978 
NPC_S_KPU8_CUSTOM
, 0xff,

6987 
NPC_S_NA
, 0X00,

6997 
≈c_kpu_¥ofûe_ˇm
 
	gkpu9_ˇm_íåõs
[] = {

6998 
NPC_KPU_NOP_CAM
,

6999 
NPC_KPU_NOP_CAM
,

7000 
NPC_KPU_NOP_CAM
,

7001 
NPC_KPU_NOP_CAM
,

7002 
NPC_KPU_NOP_CAM
,

7003 
NPC_KPU_NOP_CAM
,

7005 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 0xff,

7006 
NPC_MPLS_S
,

7007 
NPC_MPLS_S
,

7014 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 0xff,

7016 
NPC_MPLS_S
,

7017 
NPC_MPLS_S
,

7018 
NPC_MPLS_S
,

7023 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 0xff,

7025 
NPC_MPLS_S
,

7027 
NPC_MPLS_S
,

7028 
NPC_MPLS_S
,

7029 
NPC_MPLS_S
,

7032 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 0xff,

7034 
NPC_MPLS_S
,

7036 
NPC_MPLS_S
,

7038 
NPC_MPLS_S
,

7041 
NPC_S_KPU9_TU_MPLS_IN_NSH
, 0xff,

7042 
NPC_MPLS_S
,

7043 
NPC_MPLS_S
,

7050 
NPC_S_KPU9_TU_MPLS_IN_NSH
, 0xff,

7052 
NPC_MPLS_S
,

7053 
NPC_MPLS_S
,

7054 
NPC_MPLS_S
,

7059 
NPC_S_KPU9_TU_MPLS_IN_NSH
, 0xff,

7061 
NPC_MPLS_S
,

7063 
NPC_MPLS_S
,

7064 
NPC_MPLS_S
,

7065 
NPC_MPLS_S
,

7068 
NPC_S_KPU9_TU_MPLS_IN_NSH
, 0xff,

7070 
NPC_MPLS_S
,

7072 
NPC_MPLS_S
,

7074 
NPC_MPLS_S
,

7077 
NPC_S_KPU9_TU_MPLS_IN_IP
, 0xff,

7078 
NPC_MPLS_S
,

7079 
NPC_MPLS_S
,

7086 
NPC_S_KPU9_TU_MPLS_IN_IP
, 0xff,

7088 
NPC_MPLS_S
,

7089 
NPC_MPLS_S
,

7090 
NPC_MPLS_S
,

7095 
NPC_S_KPU9_TU_MPLS_IN_IP
, 0xff,

7097 
NPC_MPLS_S
,

7099 
NPC_MPLS_S
,

7100 
NPC_MPLS_S
,

7101 
NPC_MPLS_S
,

7104 
NPC_S_KPU9_TU_MPLS_IN_IP
, 0xff,

7106 
NPC_MPLS_S
,

7108 
NPC_MPLS_S
,

7110 
NPC_MPLS_S
,

7113 
NPC_S_KPU9_TU_NSH_IN_GRE
, 0xff,

7114 
NPC_NSH_NP_IP
,

7115 
NPC_NSH_NP_MASK
,

7122 
NPC_S_KPU9_TU_NSH_IN_GRE
, 0xff,

7123 
NPC_NSH_NP_IP6
,

7124 
NPC_NSH_NP_MASK
,

7131 
NPC_S_KPU9_TU_NSH_IN_GRE
, 0xff,

7132 
NPC_NSH_NP_ETH
,

7133 
NPC_NSH_NP_MASK
,

7140 
NPC_S_KPU9_TU_NSH_IN_GRE
, 0xff,

7149 
NPC_S_KPU9_VXLAN
, 0xff,

7152 
NPC_VXLAN_I
,

7153 
NPC_VXLAN_I
,

7158 
NPC_S_KPU9_VXLAN
, 0xff,

7167 
NPC_S_KPU9_VXLAN
, 0xff,

7176 
NPC_S_KPU9_VXLANGPE
, 0xff,

7179 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7180 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7181 
NPC_VXLANGPE_NP_IP
,

7182 
NPC_VXLANGPE_NP_MASK
,

7185 
NPC_S_KPU9_VXLANGPE
, 0xff,

7188 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7189 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7190 
NPC_VXLANGPE_NP_IP6
,

7191 
NPC_VXLANGPE_NP_MASK
,

7194 
NPC_S_KPU9_VXLANGPE
, 0xff,

7197 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7198 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7199 
NPC_VXLANGPE_NP_ETH
,

7200 
NPC_VXLANGPE_NP_MASK
,

7203 
NPC_S_KPU9_VXLANGPE
, 0xff,

7206 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7207 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7208 
NPC_VXLANGPE_NP_NSH
,

7209 
NPC_VXLANGPE_NP_MASK
,

7212 
NPC_S_KPU9_VXLANGPE
, 0xff,

7215 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7216 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7217 
NPC_VXLANGPE_NP_MPLS
,

7218 
NPC_VXLANGPE_NP_MASK
,

7221 
NPC_S_KPU9_VXLANGPE
, 0xff,

7224 
NPC_VXLANGPE_P
,

7225 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7226 
NPC_VXLANGPE_NP_IP
,

7227 
NPC_VXLANGPE_NP_MASK
,

7230 
NPC_S_KPU9_VXLANGPE
, 0xff,

7233 
NPC_VXLANGPE_P
,

7234 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7235 
NPC_VXLANGPE_NP_IP6
,

7236 
NPC_VXLANGPE_NP_MASK
,

7239 
NPC_S_KPU9_VXLANGPE
, 0xff,

7242 
NPC_VXLANGPE_P
,

7243 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7244 
NPC_VXLANGPE_NP_ETH
,

7245 
NPC_VXLANGPE_NP_MASK
,

7248 
NPC_S_KPU9_VXLANGPE
, 0xff,

7251 
NPC_VXLANGPE_P
,

7252 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7253 
NPC_VXLANGPE_NP_NSH
,

7254 
NPC_VXLANGPE_NP_MASK
,

7257 
NPC_S_KPU9_VXLANGPE
, 0xff,

7260 
NPC_VXLANGPE_P
,

7261 
NPC_VXLANGPE_P
 | 
NPC_VXLANGPE_I
,

7262 
NPC_VXLANGPE_NP_MPLS
,

7263 
NPC_VXLANGPE_NP_MASK
,

7266 
NPC_S_KPU9_VXLANGPE
, 0xff,

7269 
NPC_VXLANGPE_P
,

7270 
NPC_VXLANGPE_P
,

7275 
NPC_S_KPU9_VXLANGPE
, 0xff,

7279 
NPC_VXLANGPE_P
,

7284 
NPC_S_KPU9_GENEVE
, 0xff,

7288 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7289 
NPC_ETYPE_TRANS_ETH_BR
,

7293 
NPC_S_KPU9_GENEVE
, 0xff,

7296 
NPC_GENEVE_F_OAM
,

7297 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7298 
NPC_ETYPE_TRANS_ETH_BR
,

7302 
NPC_S_KPU9_GENEVE
, 0xff,

7305 
NPC_GENEVE_F_CRI_OPT
,

7306 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7307 
NPC_ETYPE_TRANS_ETH_BR
,

7311 
NPC_S_KPU9_GENEVE
, 0xff,

7314 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7315 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7316 
NPC_ETYPE_TRANS_ETH_BR
,

7320 
NPC_S_KPU9_GENEVE
, 0xff,

7324 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7325 
NPC_ETYPE_IP
,

7329 
NPC_S_KPU9_GENEVE
, 0xff,

7332 
NPC_GENEVE_F_OAM
,

7333 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7334 
NPC_ETYPE_IP
,

7338 
NPC_S_KPU9_GENEVE
, 0xff,

7341 
NPC_GENEVE_F_CRI_OPT
,

7342 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7343 
NPC_ETYPE_IP
,

7347 
NPC_S_KPU9_GENEVE
, 0xff,

7350 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7351 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7352 
NPC_ETYPE_IP
,

7356 
NPC_S_KPU9_GENEVE
, 0xff,

7360 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7361 
NPC_ETYPE_IP6
,

7365 
NPC_S_KPU9_GENEVE
, 0xff,

7368 
NPC_GENEVE_F_OAM
,

7369 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7370 
NPC_ETYPE_IP6
,

7374 
NPC_S_KPU9_GENEVE
, 0xff,

7377 
NPC_GENEVE_F_CRI_OPT
,

7378 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7379 
NPC_ETYPE_IP6
,

7383 
NPC_S_KPU9_GENEVE
, 0xff,

7386 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7387 
NPC_GENEVE_F_OAM
 | 
NPC_GENEVE_F_CRI_OPT
,

7388 
NPC_ETYPE_IP6
,

7392 
NPC_S_KPU9_GTPC
, 0xff,

7401 
NPC_S_KPU9_GTPU
, 0xff,

7404 
NPC_GTP_PT_GTP
 | 
NPC_GTP_VER1
,

7405 
NPC_GTP_PT_MASK
 | 
NPC_GTP_VER_MASK
,

7410 
NPC_S_KPU9_TU_MPLS_IN_UDP
, 0xff,

7411 
NPC_MPLS_S
,

7412 
NPC_MPLS_S
,

7419 
NPC_S_KPU9_TU_MPLS_IN_UDP
, 0xff,

7421 
NPC_MPLS_S
,

7422 
NPC_MPLS_S
,

7423 
NPC_MPLS_S
,

7428 
NPC_S_KPU9_TU_MPLS_IN_UDP
, 0xff,

7430 
NPC_MPLS_S
,

7432 
NPC_MPLS_S
,

7433 
NPC_MPLS_S
,

7434 
NPC_MPLS_S
,

7437 
NPC_S_KPU9_TU_MPLS_IN_UDP
, 0xff,

7439 
NPC_MPLS_S
,

7441 
NPC_MPLS_S
,

7443 
NPC_MPLS_S
,

7446 
NPC_S_KPU9_ESP
, 0xff,

7455 
NPC_S_KPU9_CUSTOM
, 0xff,

7464 
NPC_S_KPU9_CUSTOM
, 0xff,

7473 
NPC_S_NA
, 0X00,

7483 
≈c_kpu_¥ofûe_ˇm
 
	gkpu10_ˇm_íåõs
[] = {

7484 
NPC_KPU_NOP_CAM
,

7485 
NPC_KPU_NOP_CAM
,

7486 
NPC_KPU_NOP_CAM
,

7487 
NPC_KPU_NOP_CAM
,

7488 
NPC_KPU_NOP_CAM
,

7489 
NPC_KPU_NOP_CAM
,

7491 
NPC_S_KPU10_TU_MPLS
, 0xff,

7492 
NPC_MPLS_S
,

7493 
NPC_MPLS_S
,

7494 
NPC_IP_VER_4
,

7495 
NPC_IP_VER_MASK
,

7500 
NPC_S_KPU10_TU_MPLS
, 0xff,

7501 
NPC_MPLS_S
,

7502 
NPC_MPLS_S
,

7503 
NPC_IP_VER_6
,

7504 
NPC_IP_VER_MASK
,

7509 
NPC_S_KPU10_TU_MPLS
, 0xff,

7510 
NPC_MPLS_S
,

7511 
NPC_MPLS_S
,

7518 
NPC_S_KPU10_TU_MPLS
, 0xff,

7519 
NPC_MPLS_S
,

7520 
NPC_MPLS_S
,

7527 
NPC_S_KPU10_TU_MPLS
, 0xff,

7529 
NPC_MPLS_S
,

7536 
NPC_S_KPU10_TU_MPLS_PL
, 0xff,

7537 
NPC_IP_VER_4
,

7538 
NPC_IP_VER_MASK
,

7545 
NPC_S_KPU10_TU_MPLS_PL
, 0xff,

7546 
NPC_IP_VER_6
,

7547 
NPC_IP_VER_MASK
,

7554 
NPC_S_KPU10_TU_MPLS_PL
, 0xff,

7563 
NPC_S_KPU10_TU_MPLS_PL
, 0xff,

7572 
NPC_S_KPU10_TU_MPLS_IN_VXLANGPE
, 0xff,

7573 
NPC_MPLS_S
,

7574 
NPC_MPLS_S
,

7581 
NPC_S_KPU10_TU_MPLS_IN_VXLANGPE
, 0xff,

7583 
NPC_MPLS_S
,

7584 
NPC_MPLS_S
,

7585 
NPC_MPLS_S
,

7590 
NPC_S_KPU10_TU_MPLS_IN_VXLANGPE
, 0xff,

7592 
NPC_MPLS_S
,

7594 
NPC_MPLS_S
,

7595 
NPC_MPLS_S
,

7596 
NPC_MPLS_S
,

7599 
NPC_S_KPU10_TU_MPLS_IN_VXLANGPE
, 0xff,

7601 
NPC_MPLS_S
,

7603 
NPC_MPLS_S
,

7605 
NPC_MPLS_S
,

7608 
NPC_S_KPU10_TU_NSH_IN_VXLANGPE
, 0xff,

7609 
NPC_NSH_NP_IP
,

7610 
NPC_NSH_NP_MASK
,

7617 
NPC_S_KPU10_TU_NSH_IN_VXLANGPE
, 0xff,

7618 
NPC_NSH_NP_IP6
,

7619 
NPC_NSH_NP_MASK
,

7626 
NPC_S_KPU10_TU_NSH_IN_VXLANGPE
, 0xff,

7627 
NPC_NSH_NP_ETH
,

7628 
NPC_NSH_NP_MASK
,

7635 
NPC_S_KPU10_TU_NSH_IN_VXLANGPE
, 0xff,

7644 
NPC_S_NA
, 0X00,

7654 
≈c_kpu_¥ofûe_ˇm
 
	gkpu11_ˇm_íåõs
[] = {

7655 
NPC_KPU_NOP_CAM
,

7656 
NPC_KPU_NOP_CAM
,

7657 
NPC_KPU_NOP_CAM
,

7658 
NPC_KPU_NOP_CAM
,

7659 
NPC_KPU_NOP_CAM
,

7660 
NPC_KPU_NOP_CAM
,

7662 
NPC_S_KPU11_TU_ETHER
, 0xff,

7663 
NPC_ETYPE_IP
,

7671 
NPC_S_KPU11_TU_ETHER
, 0xff,

7672 
NPC_ETYPE_IP6
,

7680 
NPC_S_KPU11_TU_ETHER
, 0xff,

7681 
NPC_ETYPE_ARP
,

7689 
NPC_S_KPU11_TU_ETHER
, 0xff,

7690 
NPC_ETYPE_CTAG
,

7692 
NPC_ETYPE_IP
,

7698 
NPC_S_KPU11_TU_ETHER
, 0xff,

7699 
NPC_ETYPE_CTAG
,

7701 
NPC_ETYPE_IP6
,

7707 
NPC_S_KPU11_TU_ETHER
, 0xff,

7708 
NPC_ETYPE_CTAG
,

7710 
NPC_ETYPE_ARP
,

7716 
NPC_S_KPU11_TU_ETHER
, 0xff,

7717 
NPC_ETYPE_CTAG
,

7725 
NPC_S_KPU11_TU_ETHER
, 0xff,

7726 
NPC_ETYPE_SBTAG
,

7728 
NPC_ETYPE_CTAG
,

7730 
NPC_ETYPE_IP
,

7734 
NPC_S_KPU11_TU_ETHER
, 0xff,

7735 
NPC_ETYPE_SBTAG
,

7737 
NPC_ETYPE_CTAG
,

7739 
NPC_ETYPE_IP6
,

7743 
NPC_S_KPU11_TU_ETHER
, 0xff,

7744 
NPC_ETYPE_SBTAG
,

7746 
NPC_ETYPE_CTAG
,

7748 
NPC_ETYPE_ARP
,

7752 
NPC_S_KPU11_TU_ETHER
, 0xff,

7753 
NPC_ETYPE_SBTAG
,

7755 
NPC_ETYPE_CTAG
,

7761 
NPC_S_KPU11_TU_ETHER
, 0xff,

7762 
NPC_ETYPE_SBTAG
,

7764 
NPC_ETYPE_IP
,

7770 
NPC_S_KPU11_TU_ETHER
, 0xff,

7771 
NPC_ETYPE_SBTAG
,

7773 
NPC_ETYPE_IP6
,

7779 
NPC_S_KPU11_TU_ETHER
, 0xff,

7780 
NPC_ETYPE_SBTAG
,

7782 
NPC_ETYPE_ARP
,

7788 
NPC_S_KPU11_TU_ETHER
, 0xff,

7789 
NPC_ETYPE_SBTAG
,

7797 
NPC_S_KPU11_TU_ETHER
, 0xff,

7798 
NPC_ETYPE_QINQ
,

7800 
NPC_ETYPE_CTAG
,

7802 
NPC_ETYPE_IP
,

7806 
NPC_S_KPU11_TU_ETHER
, 0xff,

7807 
NPC_ETYPE_QINQ
,

7809 
NPC_ETYPE_CTAG
,

7811 
NPC_ETYPE_IP6
,

7815 
NPC_S_KPU11_TU_ETHER
, 0xff,

7816 
NPC_ETYPE_QINQ
,

7818 
NPC_ETYPE_CTAG
,

7820 
NPC_ETYPE_ARP
,

7824 
NPC_S_KPU11_TU_ETHER
, 0xff,

7825 
NPC_ETYPE_QINQ
,

7827 
NPC_ETYPE_CTAG
,

7833 
NPC_S_KPU11_TU_ETHER
, 0xff,

7834 
NPC_ETYPE_QINQ
,

7836 
NPC_ETYPE_IP
,

7842 
NPC_S_KPU11_TU_ETHER
, 0xff,

7843 
NPC_ETYPE_QINQ
,

7845 
NPC_ETYPE_IP6
,

7851 
NPC_S_KPU11_TU_ETHER
, 0xff,

7852 
NPC_ETYPE_QINQ
,

7854 
NPC_ETYPE_ARP
,

7860 
NPC_S_KPU11_TU_ETHER
, 0xff,

7861 
NPC_ETYPE_QINQ
,

7869 
NPC_S_KPU11_TU_ETHER
, 0xff,

7878 
NPC_S_KPU11_TU_PPP
, 0xff,

7887 
NPC_S_KPU11_TU_MPLS
, 0xff,

7888 
NPC_MPLS_S
,

7889 
NPC_MPLS_S
,

7890 
NPC_IP_VER_4
,

7891 
NPC_IP_VER_MASK
,

7896 
NPC_S_KPU11_TU_MPLS
, 0xff,

7897 
NPC_MPLS_S
,

7898 
NPC_MPLS_S
,

7899 
NPC_IP_VER_6
,

7900 
NPC_IP_VER_MASK
,

7905 
NPC_S_KPU11_TU_MPLS
, 0xff,

7906 
NPC_MPLS_S
,

7907 
NPC_MPLS_S
,

7914 
NPC_S_KPU11_TU_MPLS
, 0xff,

7916 
NPC_MPLS_S
,

7923 
NPC_S_KPU11_TU_MPLS_PL
, 0xff,

7924 
NPC_IP_VER_4
,

7925 
NPC_IP_VER_MASK
,

7932 
NPC_S_KPU11_TU_MPLS_PL
, 0xff,

7933 
NPC_IP_VER_6
,

7934 
NPC_IP_VER_MASK
,

7941 
NPC_S_KPU11_TU_MPLS_PL
, 0xff,

7950 
NPC_S_KPU11_TU_ETHER_IN_NSH
, 0xff,

7959 
NPC_S_NA
, 0X00,

7969 
≈c_kpu_¥ofûe_ˇm
 
	gkpu12_ˇm_íåõs
[] = {

7970 
NPC_KPU_NOP_CAM
,

7971 
NPC_KPU_NOP_CAM
,

7972 
NPC_KPU_NOP_CAM
,

7973 
NPC_KPU_NOP_CAM
,

7974 
NPC_KPU_NOP_CAM
,

7975 
NPC_KPU_NOP_CAM
,

7977 
NPC_S_KPU12_TU_IP
, 0xff,

7978 
NPC_IPNH_TCP
,

7980 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

7981 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

7986 
NPC_S_KPU12_TU_IP
, 0xff,

7987 
NPC_IPNH_UDP
,

7989 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

7990 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

7995 
NPC_S_KPU12_TU_IP
, 0xff,

7996 
NPC_IPNH_SCTP
,

7998 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

7999 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

8004 
NPC_S_KPU12_TU_IP
, 0xff,

8005 
NPC_IPNH_ICMP
,

8007 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

8008 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

8013 
NPC_S_KPU12_TU_IP
, 0xff,

8014 
NPC_IPNH_IGMP
,

8016 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

8017 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

8022 
NPC_S_KPU12_TU_IP
, 0xff,

8023 
NPC_IPNH_ESP
,

8025 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

8026 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

8031 
NPC_S_KPU12_TU_IP
, 0xff,

8032 
NPC_IPNH_AH
,

8034 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

8035 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

8040 
NPC_S_KPU12_TU_IP
, 0xff,

8043 
NPC_IP_VER_4
 | 
NPC_IP_HDR_LEN_5
,

8044 
NPC_IP_VER_MASK
 | 
NPC_IP_HDR_LEN_MASK
,

8049 
NPC_S_KPU12_TU_IP
, 0xff,

8050 
NPC_IPNH_TCP
,

8052 
NPC_IP_VER_4
,

8053 
NPC_IP_VER_MASK
,

8058 
NPC_S_KPU12_TU_IP
, 0xff,

8059 
NPC_IPNH_UDP
,

8061 
NPC_IP_VER_4
,

8062 
NPC_IP_VER_MASK
,

8067 
NPC_S_KPU12_TU_IP
, 0xff,

8068 
NPC_IPNH_SCTP
,

8070 
NPC_IP_VER_4
,

8071 
NPC_IP_VER_MASK
,

8076 
NPC_S_KPU12_TU_IP
, 0xff,

8077 
NPC_IPNH_ICMP
,

8079 
NPC_IP_VER_4
,

8080 
NPC_IP_VER_MASK
,

8085 
NPC_S_KPU12_TU_IP
, 0xff,

8086 
NPC_IPNH_IGMP
,

8088 
NPC_IP_VER_4
,

8089 
NPC_IP_VER_MASK
,

8094 
NPC_S_KPU12_TU_IP
, 0xff,

8095 
NPC_IPNH_ESP
,

8097 
NPC_IP_VER_4
,

8098 
NPC_IP_VER_MASK
,

8103 
NPC_S_KPU12_TU_IP
, 0xff,

8104 
NPC_IPNH_AH
,

8106 
NPC_IP_VER_4
,

8107 
NPC_IP_VER_MASK
,

8112 
NPC_S_KPU12_TU_IP
, 0xff,

8115 
NPC_IP_VER_4
,

8116 
NPC_IP_VER_MASK
,

8121 
NPC_S_KPU12_TU_IP
, 0xff,

8130 
NPC_S_KPU12_TU_ARP
, 0xff,

8139 
NPC_S_KPU12_TU_IP6
, 0xff,

8140 
NPC_IPNH_TCP
 << 8,

8142 
NPC_IP_VER_6
,

8143 
NPC_IP_VER_MASK
,

8148 
NPC_S_KPU12_TU_IP6
, 0xff,

8149 
NPC_IPNH_UDP
 << 8,

8151 
NPC_IP_VER_6
,

8152 
NPC_IP_VER_MASK
,

8157 
NPC_S_KPU12_TU_IP6
, 0xff,

8158 
NPC_IPNH_SCTP
 << 8,

8160 
NPC_IP_VER_6
,

8161 
NPC_IP_VER_MASK
,

8166 
NPC_S_KPU12_TU_IP6
, 0xff,

8167 
NPC_IPNH_ICMP
 << 8,

8169 
NPC_IP_VER_6
,

8170 
NPC_IP_VER_MASK
,

8175 
NPC_S_KPU12_TU_IP6
, 0xff,

8176 
NPC_IPNH_ICMP6
 << 8,

8178 
NPC_IP_VER_6
,

8179 
NPC_IP_VER_MASK
,

8184 
NPC_S_KPU12_TU_IP6
, 0xff,

8185 
NPC_IPNH_ESP
 << 8,

8187 
NPC_IP_VER_6
,

8188 
NPC_IP_VER_MASK
,

8193 
NPC_S_KPU12_TU_IP6
, 0xff,

8194 
NPC_IPNH_AH
 << 8,

8196 
NPC_IP_VER_6
,

8197 
NPC_IP_VER_MASK
,

8202 
NPC_S_KPU12_TU_IP6
, 0xff,

8205 
NPC_IP_VER_6
,

8206 
NPC_IP_VER_MASK
,

8211 
NPC_S_KPU12_TU_IP6
, 0xff,

8220 
NPC_S_NA
, 0X00,

8230 
≈c_kpu_¥ofûe_ˇm
 
	gkpu13_ˇm_íåõs
[] = {

8231 
NPC_KPU_NOP_CAM
,

8232 
NPC_KPU_NOP_CAM
,

8233 
NPC_KPU_NOP_CAM
,

8234 
NPC_KPU_NOP_CAM
,

8235 
NPC_KPU_NOP_CAM
,

8236 
NPC_KPU_NOP_CAM
,

8238 
NPC_S_KPU13_TU_IP6_EXT
, 0xff,

8248 
≈c_kpu_¥ofûe_ˇm
 
	gkpu14_ˇm_íåõs
[] = {

8249 
NPC_KPU_NOP_CAM
,

8250 
NPC_KPU_NOP_CAM
,

8251 
NPC_KPU_NOP_CAM
,

8252 
NPC_KPU_NOP_CAM
,

8253 
NPC_KPU_NOP_CAM
,

8254 
NPC_KPU_NOP_CAM
,

8256 
NPC_S_KPU14_TU_IP6_EXT
, 0xff,

8266 
≈c_kpu_¥ofûe_ˇm
 
	gkpu15_ˇm_íåõs
[] = {

8267 
NPC_KPU_NOP_CAM
,

8268 
NPC_KPU_NOP_CAM
,

8269 
NPC_KPU_NOP_CAM
,

8270 
NPC_KPU_NOP_CAM
,

8271 
NPC_KPU_NOP_CAM
,

8272 
NPC_KPU_NOP_CAM
,

8274 
NPC_S_KPU15_TU_TCP
, 0xff,

8277 
NPC_TCP_FLAGS_FIN
,

8278 
NPC_TCP_FLAGS_MASK
,

8283 
NPC_S_KPU15_TU_TCP
, 0xff,

8287 
NPC_TCP_FLAGS_MASK
,

8292 
NPC_S_KPU15_TU_TCP
, 0xff,

8295 
NPC_TCP_FLAGS_RST
 | 
NPC_TCP_FLAGS_FIN
,

8296 
NPC_TCP_FLAGS_RST
 | 
NPC_TCP_FLAGS_FIN
,

8301 
NPC_S_KPU15_TU_TCP
, 0xff,

8304 
NPC_TCP_FLAGS_URG
 | 
NPC_TCP_FLAGS_SYN
,

8305 
NPC_TCP_FLAGS_URG
 | 
NPC_TCP_FLAGS_SYN
,

8310 
NPC_S_KPU15_TU_TCP
, 0xff,

8313 
NPC_TCP_FLAGS_RST
 | 
NPC_TCP_FLAGS_SYN
,

8314 
NPC_TCP_FLAGS_RST
 | 
NPC_TCP_FLAGS_SYN
,

8319 
NPC_S_KPU15_TU_TCP
, 0xff,

8322 
NPC_TCP_FLAGS_SYN
 | 
NPC_TCP_FLAGS_FIN
,

8323 
NPC_TCP_FLAGS_SYN
 | 
NPC_TCP_FLAGS_FIN
,

8328 
NPC_S_KPU15_TU_TCP
, 0xff,

8329 
NPC_TCP_PORT_HTTP
,

8331 
NPC_TCP_DATA_OFFSET_5
,

8332 
NPC_TCP_DATA_OFFSET_MASK
,

8337 
NPC_S_KPU15_TU_TCP
, 0xff,

8338 
NPC_TCP_PORT_HTTPS
,

8340 
NPC_TCP_DATA_OFFSET_5
,

8341 
NPC_TCP_DATA_OFFSET_MASK
,

8346 
NPC_S_KPU15_TU_TCP
, 0xff,

8347 
NPC_TCP_PORT_PPTP
,

8349 
NPC_TCP_DATA_OFFSET_5
,

8350 
NPC_TCP_DATA_OFFSET_MASK
,

8355 
NPC_S_KPU15_TU_TCP
, 0xff,

8358 
NPC_TCP_DATA_OFFSET_5
,

8359 
NPC_TCP_DATA_OFFSET_MASK
,

8364 
NPC_S_KPU15_TU_TCP
, 0xff,

8365 
NPC_TCP_PORT_HTTP
,

8373 
NPC_S_KPU15_TU_TCP
, 0xff,

8374 
NPC_TCP_PORT_HTTPS
,

8382 
NPC_S_KPU15_TU_TCP
, 0xff,

8383 
NPC_TCP_PORT_PPTP
,

8391 
NPC_S_KPU15_TU_TCP
, 0xff,

8400 
NPC_S_KPU15_TU_UDP
, 0xff,

8409 
NPC_S_KPU15_TU_SCTP
, 0xff,

8418 
NPC_S_KPU15_TU_ICMP
, 0xff,

8427 
NPC_S_KPU15_TU_IGMP
, 0xff,

8436 
NPC_S_KPU15_TU_ICMP6
, 0xff,

8445 
NPC_S_KPU15_TU_ESP
, 0xff,

8454 
NPC_S_KPU15_TU_AH
, 0xff,

8463 
NPC_S_NA
, 0X00,

8473 
≈c_kpu_¥ofûe_ˇm
 
	gkpu16_ˇm_íåõs
[] = {

8474 
NPC_KPU_NOP_CAM
,

8475 
NPC_KPU_NOP_CAM
,

8476 
NPC_KPU_NOP_CAM
,

8477 
NPC_KPU_NOP_CAM
,

8478 
NPC_KPU_NOP_CAM
,

8479 
NPC_KPU_NOP_CAM
,

8481 
NPC_S_KPU16_TCP_DATA
, 0xff,

8490 
NPC_S_KPU16_HTTP_DATA
, 0xff,

8499 
NPC_S_KPU16_HTTPS_DATA
, 0xff,

8508 
NPC_S_KPU16_PPTP_DATA
, 0xff,

8517 
NPC_S_KPU16_UDP_DATA
, 0xff,

8526 
NPC_S_KPU16_UDP_PTP
, 0xff,

8536 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu1_a˘i⁄_íåõs
[] = {

8537 
NPC_KPU_NOP_ACTION
,

8538 
NPC_KPU_NOP_ACTION
,

8539 
NPC_KPU_NOP_ACTION
,

8540 
NPC_KPU_NOP_ACTION
,

8541 
NPC_KPU_NOP_ACTION
,

8542 
NPC_KPU_NOP_ACTION
,

8544 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8546 
NPC_S_KPU5_IP
, 14, 1,

8547 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8552 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8554 
NPC_S_KPU5_IP6
, 14, 1,

8555 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8560 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8562 
NPC_S_KPU5_ARP
, 14, 1,

8563 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8568 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8570 
NPC_S_KPU5_RARP
, 14, 1,

8571 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8576 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8578 
NPC_S_KPU5_PTP
, 14, 1,

8579 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8584 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8586 
NPC_S_KPU5_FCOE
, 14, 1,

8587 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8592 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8594 
NPC_S_KPU2_CTAG2
, 12, 1,

8595 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8596 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

8600 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8602 
NPC_S_KPU2_CTAG
, 12, 1,

8603 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8604 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

8608 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8610 
NPC_S_KPU2_SBTAG
, 12, 1,

8611 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8612 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

8616 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8618 
NPC_S_KPU2_QINQ
, 12, 1,

8619 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8620 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

8624 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8626 
NPC_S_KPU2_ETAG
, 12, 1,

8627 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8628 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_ETAG
,

8632 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8634 
NPC_S_KPU4_MPLS
, 14, 1,

8635 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8636 
NPC_F_LA_L_WITH_MPLS
,

8640 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8642 
NPC_S_KPU4_MPLS
, 14, 1,

8643 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8644 
NPC_F_LA_L_WITH_MPLS
,

8648 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8650 
NPC_S_KPU4_NSH
, 14, 1,

8651 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8652 
NPC_F_LA_L_WITH_NSH
,

8656 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8658 
NPC_S_KPU3_DSA
, 12, 1,

8659 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8664 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8666 
NPC_S_KPU4_PPPOE
, 12, 1,

8667 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8672 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8674 
NPC_S_NA
, 0, 1,

8675 
NPC_LID_LA
, 
NPC_LT_LA_8023
,

8680 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8682 
NPC_S_NA
, 0, 1,

8683 
NPC_LID_LA
, 
NPC_LT_LA_8023
,

8688 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8690 
NPC_S_NA
, 0, 1,

8691 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8692 
NPC_F_LA_L_UNK_ETYPE
,

8696 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8698 
NPC_S_KPU5_IP
, 22, 1,

8699 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8700 
NPC_F_LA_U_HAS_IH_NIX
,

8704 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8706 
NPC_S_KPU5_IP6
, 22, 1,

8707 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8708 
NPC_F_LA_U_HAS_IH_NIX
,

8712 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8714 
NPC_S_KPU5_ARP
, 22, 1,

8715 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8716 
NPC_F_LA_U_HAS_IH_NIX
,

8720 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8722 
NPC_S_KPU5_RARP
, 22, 1,

8723 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8724 
NPC_F_LA_U_HAS_IH_NIX
,

8728 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8730 
NPC_S_KPU5_PTP
, 22, 1,

8731 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8732 
NPC_F_LA_U_HAS_IH_NIX
,

8736 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8738 
NPC_S_KPU5_FCOE
, 22, 1,

8739 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8740 
NPC_F_LA_U_HAS_IH_NIX
,

8744 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8746 
NPC_S_KPU2_CTAG2
, 20, 1,

8747 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8748 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_TAG


8749 | 
NPC_F_LA_L_WITH_VLAN
,

8753 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8755 
NPC_S_KPU2_CTAG
, 20, 1,

8756 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8757 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_TAG


8758 | 
NPC_F_LA_L_WITH_VLAN
,

8762 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8764 
NPC_S_KPU2_SBTAG
, 20, 1,

8765 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8766 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_TAG


8767 | 
NPC_F_LA_L_WITH_VLAN
,

8771 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8773 
NPC_S_KPU2_QINQ
, 20, 1,

8774 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8775 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_TAG


8776 | 
NPC_F_LA_L_WITH_VLAN
,

8780 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8782 
NPC_S_KPU2_ETAG
, 20, 1,

8783 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8784 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_ETAG
,

8788 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8790 
NPC_S_KPU4_MPLS
, 22, 1,

8791 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8792 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_L_WITH_MPLS
,

8796 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8798 
NPC_S_KPU4_MPLS
, 22, 1,

8799 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8800 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_L_WITH_MPLS
,

8804 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8806 
NPC_S_KPU4_NSH
, 22, 1,

8807 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8808 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_L_WITH_NSH
,

8812 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8814 
NPC_S_NA
, 0, 1,

8815 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
,

8816 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_L_UNK_ETYPE
,

8820 
NPC_ERRLEV_LA
, 
NPC_EC_IH_LENGTH
,

8822 
NPC_S_NA
, 0, 1,

8823 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8824 
NPC_F_LA_L_UNK_ETYPE
,

8828 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8830 
NPC_S_KPU2_EXDSA
, 12, 1,

8831 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8836 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8838 
NPC_S_KPU4_FDSA
, 12, 1,

8839 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8844 
NPC_ERRLEV_LA
, 
NPC_EC_EDSA_UNK
,

8846 
NPC_S_NA
, 0, 1,

8847 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

8852 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8854 
NPC_S_KPU5_IP
, 30, 1,

8855 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8856 
NPC_F_LA_U_HAS_HIGIG2
,

8860 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8862 
NPC_S_KPU5_IP6
, 30, 1,

8863 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8864 
NPC_F_LA_U_HAS_HIGIG2
,

8868 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8870 
NPC_S_KPU5_ARP
, 30, 1,

8871 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8872 
NPC_F_LA_U_HAS_HIGIG2
,

8876 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8878 
NPC_S_KPU5_RARP
, 30, 1,

8879 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8880 
NPC_F_LA_U_HAS_HIGIG2
,

8884 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8886 
NPC_S_KPU5_PTP
, 30, 1,

8887 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8888 
NPC_F_LA_U_HAS_HIGIG2
,

8892 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8894 
NPC_S_KPU5_FCOE
, 30, 1,

8895 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8896 
NPC_F_LA_U_HAS_HIGIG2
,

8900 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8902 
NPC_S_KPU2_CTAG2
, 28, 1,

8903 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8904 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_U_HAS_TAG


8905 | 
NPC_F_LA_L_WITH_VLAN
,

8909 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8911 
NPC_S_KPU2_CTAG
, 28, 1,

8912 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8913 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_U_HAS_TAG


8914 | 
NPC_F_LA_L_WITH_VLAN
,

8918 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8920 
NPC_S_KPU2_SBTAG
, 28, 1,

8921 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8922 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_U_HAS_TAG


8923 | 
NPC_F_LA_L_WITH_VLAN
,

8927 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8929 
NPC_S_KPU2_QINQ
, 28, 1,

8930 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8931 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_U_HAS_TAG


8932 | 
NPC_F_LA_L_WITH_VLAN
,

8936 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8938 
NPC_S_KPU2_ETAG
, 28, 1,

8939 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8940 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_ETAG
,

8944 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8946 
NPC_S_KPU4_MPLS
, 30, 1,

8947 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8948 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_L_WITH_MPLS
,

8952 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8954 
NPC_S_KPU4_MPLS
, 30, 1,

8955 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8956 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_L_WITH_MPLS
,

8960 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8962 
NPC_S_KPU4_NSH
, 30, 1,

8963 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8964 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_L_WITH_NSH
,

8968 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8970 
NPC_S_NA
, 0, 1,

8971 
NPC_LID_LA
, 
NPC_LT_LA_HIGIG2_ETHER
,

8972 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_L_UNK_ETYPE
,

8976 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8978 
NPC_S_KPU5_IP
, 38, 1,

8979 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

8980 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2
,

8984 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8986 
NPC_S_KPU5_IP6
, 38, 1,

8987 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

8988 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2
,

8992 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

8994 
NPC_S_KPU5_ARP
, 38, 1,

8995 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

8996 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2
,

9000 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9002 
NPC_S_KPU5_RARP
, 38, 1,

9003 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9004 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2
,

9008 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9010 
NPC_S_KPU5_PTP
, 38, 1,

9011 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9012 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2
,

9016 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9018 
NPC_S_KPU5_FCOE
, 38, 1,

9019 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9020 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2
,

9024 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9026 
NPC_S_KPU2_CTAG2
, 36, 1,

9027 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9028 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2


9029 | 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

9033 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9035 
NPC_S_KPU2_CTAG
, 36, 1,

9036 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9037 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2


9038 | 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

9042 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9044 
NPC_S_KPU2_SBTAG
, 36, 1,

9045 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9046 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2


9047 | 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

9051 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9053 
NPC_S_KPU2_QINQ
, 36, 1,

9054 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9055 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2


9056 | 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

9060 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9062 
NPC_S_KPU2_ETAG
, 36, 1,

9063 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9064 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2
 | 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_ETAG
,

9068 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9070 
NPC_S_KPU4_MPLS
, 38, 1,

9071 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9072 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2


9073 | 
NPC_F_LA_L_WITH_MPLS
,

9077 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9079 
NPC_S_KPU4_MPLS
, 38, 1,

9080 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9081 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2


9082 | 
NPC_F_LA_L_WITH_MPLS
,

9086 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9088 
NPC_S_KPU4_NSH
, 38, 1,

9089 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9090 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2


9091 | 
NPC_F_LA_L_WITH_NSH
,

9095 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9097 
NPC_S_NA
, 0, 1,

9098 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
,

9099 
NPC_F_LA_U_HAS_IH_NIX
 | 
NPC_F_LA_U_HAS_HIGIG2


9100 | 
NPC_F_LA_L_UNK_ETYPE
,

9104 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9106 
NPC_S_KPU5_IP
, 14, 0,

9107 
NPC_LID_LA
, 
NPC_LT_NA
,

9112 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9114 
NPC_S_KPU5_IP6
, 14, 0,

9115 
NPC_LID_LA
, 
NPC_LT_NA
,

9120 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9122 
NPC_S_KPU5_ARP
, 14, 0,

9123 
NPC_LID_LA
, 
NPC_LT_NA
,

9128 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9130 
NPC_S_KPU5_RARP
, 14, 0,

9131 
NPC_LID_LA
, 
NPC_LT_NA
,

9136 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9138 
NPC_S_KPU5_PTP
, 14, 0,

9139 
NPC_LID_LA
, 
NPC_LT_NA
,

9144 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9146 
NPC_S_KPU5_FCOE
, 14, 0,

9147 
NPC_LID_LA
, 
NPC_LT_NA
,

9152 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9154 
NPC_S_KPU2_CTAG2
, 12, 0,

9155 
NPC_LID_LA
, 
NPC_LT_NA
,

9160 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9162 
NPC_S_KPU2_CTAG
, 12, 0,

9163 
NPC_LID_LA
, 
NPC_LT_NA
,

9168 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9170 
NPC_S_KPU2_SBTAG
, 12, 0,

9171 
NPC_LID_LA
, 
NPC_LT_NA
,

9176 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9178 
NPC_S_KPU2_QINQ
, 12, 0,

9179 
NPC_LID_LA
, 
NPC_LT_NA
,

9184 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9186 
NPC_S_KPU2_ETAG
, 12, 0,

9187 
NPC_LID_LA
, 
NPC_LT_NA
,

9192 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9194 
NPC_S_KPU4_MPLS
, 14, 0,

9195 
NPC_LID_LA
, 
NPC_LT_NA
,

9200 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9202 
NPC_S_KPU4_MPLS
, 14, 0,

9203 
NPC_LID_LA
, 
NPC_LT_NA
,

9208 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9210 
NPC_S_KPU4_NSH
, 14, 0,

9211 
NPC_LID_LA
, 
NPC_LT_NA
,

9216 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9218 
NPC_S_NA
, 0, 0,

9219 
NPC_LID_LA
, 
NPC_LT_NA
,

9224 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9226 
NPC_S_KPU5_CPT_IP
, 14, 1,

9227 
NPC_LID_LA
, 
NPC_LT_LA_CPT_HDR
,

9232 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9234 
NPC_S_KPU5_CPT_IP6
, 14, 1,

9235 
NPC_LID_LA
, 
NPC_LT_LA_CPT_HDR
,

9240 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9242 
NPC_S_KPU2_CPT_CTAG
, 12, 1,

9243 
NPC_LID_LA
, 
NPC_LT_LA_CPT_HDR
,

9244 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

9248 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9250 
NPC_S_KPU2_CPT_QINQ
, 12, 1,

9251 
NPC_LID_LA
, 
NPC_LT_LA_CPT_HDR
,

9252 
NPC_F_LA_U_HAS_TAG
 | 
NPC_F_LA_L_WITH_VLAN
,

9256 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9258 
NPC_S_KPU3_VLAN_EXDSA
, 12, 1,

9259 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
,

9264 
NPC_ERRLEV_LA
, 
NPC_EC_L2_K1
,

9266 
NPC_S_NA
, 0, 0,

9267 
NPC_LID_LA
, 
NPC_LT_NA
,

9273 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu2_a˘i⁄_íåõs
[] = {

9274 
NPC_KPU_NOP_ACTION
,

9275 
NPC_KPU_NOP_ACTION
,

9276 
NPC_KPU_NOP_ACTION
,

9277 
NPC_KPU_NOP_ACTION
,

9278 
NPC_KPU_NOP_ACTION
,

9279 
NPC_KPU_NOP_ACTION
,

9281 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9283 
NPC_S_KPU5_IP
, 6, 1,

9284 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9289 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9291 
NPC_S_KPU5_IP6
, 6, 1,

9292 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9297 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9299 
NPC_S_KPU5_ARP
, 6, 1,

9300 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9305 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9307 
NPC_S_KPU5_RARP
, 6, 1,

9308 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9313 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9315 
NPC_S_KPU5_PTP
, 6, 1,

9316 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9321 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9323 
NPC_S_KPU5_FCOE
, 6, 1,

9324 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9329 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9331 
NPC_S_KPU4_MPLS
, 6, 1,

9332 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9337 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9339 
NPC_S_KPU4_MPLS
, 6, 1,

9340 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9345 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9347 
NPC_S_KPU4_NSH
, 6, 1,

9348 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9353 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9355 
NPC_S_KPU5_NGIO
, 6, 1,

9356 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9361 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9363 
NPC_S_KPU5_IP
, 14, 1,

9364 
NPC_LID_LB
, 
NPC_LT_LB_PPPOE
,

9369 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9371 
NPC_S_KPU5_IP6
, 14, 1,

9372 
NPC_LID_LB
, 
NPC_LT_LB_PPPOE
,

9377 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9379 
NPC_S_NA
, 6, 1,

9380 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

9381 
NPC_F_LB_U_UNK_ETYPE
,

9385 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9387 
NPC_S_KPU5_IP
, 10, 1,

9388 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9389 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9393 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9395 
NPC_S_KPU5_IP6
, 10, 1,

9396 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9397 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9401 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9403 
NPC_S_KPU5_ARP
, 10, 1,

9404 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9405 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9409 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9411 
NPC_S_KPU5_RARP
, 10, 1,

9412 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9413 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9417 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9419 
NPC_S_KPU5_PTP
, 10, 1,

9420 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9421 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9425 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9427 
NPC_S_KPU5_FCOE
, 10, 1,

9428 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9429 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9433 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9435 
NPC_S_KPU4_MPLS
, 10, 1,

9436 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9437 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9441 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9443 
NPC_S_KPU4_MPLS
, 10, 1,

9444 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9445 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9449 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9451 
NPC_S_KPU4_NSH
, 10, 1,

9452 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9453 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9457 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9459 
NPC_S_NA
, 0, 1,

9460 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9461 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG_UNK
,

9465 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9467 
NPC_S_KPU3_CTAG
, 10, 1,

9468 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9469 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_STAG_CTAG
,

9473 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9475 
NPC_S_KPU3_STAG
, 10, 1,

9476 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9477 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_STAG_STAG
,

9481 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9483 
NPC_S_KPU5_IP
, 24, 1,

9484 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9485 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9489 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9491 
NPC_S_KPU5_IP6
, 24, 1,

9492 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9493 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9497 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9499 
NPC_S_KPU5_ARP
, 24, 1,

9500 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9501 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9505 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9507 
NPC_S_KPU5_RARP
, 24, 1,

9508 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9509 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9513 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9515 
NPC_S_KPU5_PTP
, 24, 1,

9516 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9517 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9521 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9523 
NPC_S_KPU5_FCOE
, 24, 1,

9524 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9525 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9529 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9531 
NPC_S_KPU4_MPLS
, 24, 1,

9532 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9533 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9537 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9539 
NPC_S_KPU4_MPLS
, 24, 1,

9540 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9541 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9545 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9547 
NPC_S_KPU4_NSH
, 24, 1,

9548 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9549 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9553 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9555 
NPC_S_KPU3_STAG
, 24, 1,

9556 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9557 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG_STAG
,

9561 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9563 
NPC_S_KPU3_CTAG
, 24, 1,

9564 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9565 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG_CTAG
,

9569 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9571 
NPC_S_NA
, 0, 1,

9572 
NPC_LID_LB
, 
NPC_LT_LB_BTAG
,

9573 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG_UNK
,

9577 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9579 
NPC_S_NA
, 0, 1,

9580 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9581 
NPC_F_LB_U_UNK_ETYPE
,

9585 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9587 
NPC_S_KPU5_IP
, 10, 1,

9588 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9589 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9593 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9595 
NPC_S_KPU5_IP6
, 10, 1,

9596 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9597 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9601 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9603 
NPC_S_KPU5_ARP
, 10, 1,

9604 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9605 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9609 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9611 
NPC_S_KPU5_RARP
, 10, 1,

9612 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9613 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9617 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9619 
NPC_S_KPU5_PTP
, 10, 1,

9620 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9621 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9625 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9627 
NPC_S_KPU5_FCOE
, 10, 1,

9628 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9629 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9633 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9635 
NPC_S_KPU4_MPLS
, 10, 1,

9636 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9637 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9641 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9643 
NPC_S_KPU4_MPLS
, 10, 1,

9644 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9645 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9649 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9651 
NPC_S_KPU4_NSH
, 10, 1,

9652 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9653 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9657 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9659 
NPC_S_NA
, 0, 1,

9660 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9661 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG_UNK
,

9665 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9667 
NPC_S_KPU3_CTAG
, 10, 1,

9668 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9669 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_QINQ_CTAG
,

9673 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9675 
NPC_S_KPU3_QINQ
, 10, 1,

9676 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9677 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_QINQ_QINQ
,

9681 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9683 
NPC_S_NA
, 0, 1,

9684 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9685 
NPC_F_LB_U_UNK_ETYPE
,

9689 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9691 
NPC_S_KPU5_IP
, 10, 1,

9692 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9697 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9699 
NPC_S_KPU5_IP6
, 10, 1,

9700 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9705 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9707 
NPC_S_KPU5_ARP
, 10, 1,

9708 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9713 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9715 
NPC_S_KPU5_RARP
, 10, 1,

9716 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9721 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9723 
NPC_S_KPU5_PTP
, 10, 1,

9724 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9729 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9731 
NPC_S_KPU5_FCOE
, 10, 1,

9732 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9737 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9739 
NPC_S_KPU4_MPLS
, 10, 1,

9740 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9745 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9747 
NPC_S_KPU4_MPLS
, 10, 1,

9748 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9753 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9755 
NPC_S_KPU4_NSH
, 10, 1,

9756 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9761 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9763 
NPC_S_KPU3_CTAG
, 10, 1,

9764 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9765 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

9769 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9771 
NPC_S_KPU3_STAG
, 10, 1,

9772 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9773 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_STAG
,

9777 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9779 
NPC_S_KPU3_QINQ
, 10, 1,

9780 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9781 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_QINQ
,

9785 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9787 
NPC_S_KPU5_IP
, 28, 1,

9788 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9789 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9793 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9795 
NPC_S_KPU5_IP6
, 28, 1,

9796 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9797 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9801 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9803 
NPC_S_KPU5_ARP
, 28, 1,

9804 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9805 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG
,

9809 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9811 
NPC_S_KPU3_STAG
, 28, 1,

9812 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9813 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG_STAG
,

9817 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9819 
NPC_S_KPU3_CTAG
, 28, 1,

9820 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9821 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG_CTAG
,

9825 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9827 
NPC_S_NA
, 0, 1,

9828 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9829 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_ITAG_UNK
,

9833 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9835 
NPC_S_NA
, 0, 1,

9836 
NPC_LID_LB
, 
NPC_LT_LB_ETAG
,

9837 
NPC_F_LB_U_UNK_ETYPE
,

9841 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9843 
NPC_S_KPU5_IP
, 10, 1,

9844 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9849 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9851 
NPC_S_KPU5_IP6
, 10, 1,

9852 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9857 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9859 
NPC_S_KPU5_ARP
, 10, 1,

9860 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9865 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9867 
NPC_S_KPU5_RARP
, 10, 1,

9868 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9873 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9875 
NPC_S_KPU5_PTP
, 10, 1,

9876 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9881 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9883 
NPC_S_KPU5_FCOE
, 10, 1,

9884 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9889 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9891 
NPC_S_KPU4_MPLS
, 10, 1,

9892 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9897 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9899 
NPC_S_KPU4_MPLS
, 10, 1,

9900 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9905 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9907 
NPC_S_KPU4_NSH
, 10, 1,

9908 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9913 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9915 
NPC_S_KPU3_QINQ
, 10, 1,

9916 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9917 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_QINQ_QINQ
,

9921 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9923 
NPC_S_NA
, 0, 1,

9924 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

9925 
NPC_F_LB_U_UNK_ETYPE
,

9929 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9931 
NPC_S_KPU5_IP
, 18, 1,

9932 
NPC_LID_LB
, 
NPC_LT_LB_EDSA
,

9933 
NPC_F_LB_L_EDSA
,

9937 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9939 
NPC_S_KPU5_IP6
, 18, 1,

9940 
NPC_LID_LB
, 
NPC_LT_LB_EDSA
,

9941 
NPC_F_LB_L_EDSA
,

9945 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9947 
NPC_S_KPU5_ARP
, 18, 1,

9948 
NPC_LID_LB
, 
NPC_LT_LB_EDSA
,

9949 
NPC_F_LB_L_EDSA
,

9953 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9955 
NPC_S_KPU5_RARP
, 18, 1,

9956 
NPC_LID_LB
, 
NPC_LT_LB_EDSA
,

9957 
NPC_F_LB_L_EDSA
,

9961 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9963 
NPC_S_KPU5_PTP
, 18, 1,

9964 
NPC_LID_LB
, 
NPC_LT_LB_EDSA
,

9965 
NPC_F_LB_L_EDSA
,

9969 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9971 
NPC_S_KPU5_FCOE
, 18, 1,

9972 
NPC_LID_LB
, 
NPC_LT_LB_EDSA
,

9973 
NPC_F_LB_L_EDSA
,

9977 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9979 
NPC_S_KPU3_CTAG
, 16, 1,

9980 
NPC_LID_LB
, 
NPC_LT_LB_EDSA_VLAN
,

9981 
NPC_F_LB_L_EDSA_VLAN
,

9985 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9987 
NPC_S_NA
, 0, 1,

9988 
NPC_LID_LB
, 
NPC_LT_LB_EDSA
,

9989 
NPC_F_LB_U_UNK_ETYPE
 | 
NPC_F_LB_L_EDSA
,

9993 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

9995 
NPC_S_KPU5_IP
, 10, 1,

9996 
NPC_LID_LB
, 
NPC_LT_LB_EXDSA
,

9997 
NPC_F_LB_L_EXDSA
,

10001 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10003 
NPC_S_KPU5_IP6
, 10, 1,

10004 
NPC_LID_LB
, 
NPC_LT_LB_EXDSA
,

10005 
NPC_F_LB_L_EXDSA
,

10009 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10011 
NPC_S_KPU5_ARP
, 10, 1,

10012 
NPC_LID_LB
, 
NPC_LT_LB_EXDSA
,

10013 
NPC_F_LB_L_EXDSA
,

10017 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10019 
NPC_S_KPU5_RARP
, 10, 1,

10020 
NPC_LID_LB
, 
NPC_LT_LB_EXDSA
,

10021 
NPC_F_LB_L_EXDSA
,

10025 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10027 
NPC_S_KPU5_PTP
, 10, 1,

10028 
NPC_LID_LB
, 
NPC_LT_LB_EXDSA
,

10029 
NPC_F_LB_L_EXDSA
,

10033 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10035 
NPC_S_KPU5_FCOE
, 10, 1,

10036 
NPC_LID_LB
, 
NPC_LT_LB_EXDSA
,

10037 
NPC_F_LB_L_EXDSA
,

10041 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10043 
NPC_S_KPU3_CTAG
, 8, 1,

10044 
NPC_LID_LB
, 
NPC_LT_LB_EXDSA_VLAN
,

10045 
NPC_F_LB_L_EXDSA_VLAN
,

10049 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10051 
NPC_S_NA
, 0, 1,

10052 
NPC_LID_LB
, 
NPC_LT_LB_EXDSA
,

10053 
NPC_F_LB_U_UNK_ETYPE
 | 
NPC_F_LB_L_EXDSA
,

10057 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10059 
NPC_S_KPU5_CPT_IP
, 6, 1,

10060 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

10065 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10067 
NPC_S_KPU5_CPT_IP6
, 6, 1,

10068 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

10073 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10075 
NPC_S_KPU5_CPT_IP
, 10, 1,

10076 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10077 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

10081 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10083 
NPC_S_KPU5_CPT_IP6
, 10, 1,

10084 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10085 
NPC_F_LB_U_MORE_TAG
 | 
NPC_F_LB_L_WITH_CTAG
,

10089 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10091 
NPC_S_KPU3_CTAG
, 0, 1,

10092 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
,

10097 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10099 
NPC_S_KPU3_CTAG_C
, 0, 0,

10100 
NPC_LID_LB
, 
NPC_LT_NA
,

10105 
NPC_ERRLEV_LB
, 
NPC_EC_L2_K3
,

10107 
NPC_S_NA
, 0, 0,

10108 
NPC_LID_LB
, 
NPC_LT_NA
,

10114 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu3_a˘i⁄_íåõs
[] = {

10115 
NPC_KPU_NOP_ACTION
,

10116 
NPC_KPU_NOP_ACTION
,

10117 
NPC_KPU_NOP_ACTION
,

10118 
NPC_KPU_NOP_ACTION
,

10119 
NPC_KPU_NOP_ACTION
,

10120 
NPC_KPU_NOP_ACTION
,

10122 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10124 
NPC_S_KPU5_IP
, 6, 0,

10125 
NPC_LID_LB
, 
NPC_LT_NA
,

10130 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10132 
NPC_S_KPU5_IP6
, 6, 0,

10133 
NPC_LID_LB
, 
NPC_LT_NA
,

10138 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10140 
NPC_S_KPU5_ARP
, 6, 0,

10141 
NPC_LID_LB
, 
NPC_LT_NA
,

10146 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10148 
NPC_S_KPU5_RARP
, 6, 0,

10149 
NPC_LID_LB
, 
NPC_LT_NA
,

10154 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10156 
NPC_S_KPU5_PTP
, 6, 0,

10157 
NPC_LID_LB
, 
NPC_LT_NA
,

10162 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10164 
NPC_S_KPU5_FCOE
, 6, 0,

10165 
NPC_LID_LB
, 
NPC_LT_NA
,

10170 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10172 
NPC_S_KPU4_MPLS
, 6, 0,

10173 
NPC_LID_LB
, 
NPC_LT_NA
,

10178 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10180 
NPC_S_KPU4_MPLS
, 6, 0,

10181 
NPC_LID_LB
, 
NPC_LT_NA
,

10186 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10188 
NPC_S_KPU4_NSH
, 6, 0,

10189 
NPC_LID_LB
, 
NPC_LT_NA
,

10194 
NPC_ERRLEV_LB
, 
NPC_EC_L2_K3_ETYPE_UNK
,

10196 
NPC_S_NA
, 0, 0,

10197 
NPC_LID_LB
, 
NPC_LT_NA
,

10202 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10204 
NPC_S_KPU5_IP
, 8, 0,

10205 
NPC_LID_LB
, 
NPC_LT_NA
,

10210 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10212 
NPC_S_KPU5_IP6
, 8, 0,

10213 
NPC_LID_LB
, 
NPC_LT_NA
,

10218 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10220 
NPC_S_KPU5_ARP
, 8, 0,

10221 
NPC_LID_LB
, 
NPC_LT_NA
,

10226 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10228 
NPC_S_KPU5_RARP
, 8, 0,

10229 
NPC_LID_LB
, 
NPC_LT_NA
,

10234 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10236 
NPC_S_KPU5_PTP
, 8, 0,

10237 
NPC_LID_LB
, 
NPC_LT_NA
,

10242 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10244 
NPC_S_KPU5_FCOE
, 8, 0,

10245 
NPC_LID_LB
, 
NPC_LT_NA
,

10250 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10252 
NPC_S_KPU4_MPLS
, 8, 0,

10253 
NPC_LID_LB
, 
NPC_LT_NA
,

10258 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10260 
NPC_S_KPU4_MPLS
, 8, 0,

10261 
NPC_LID_LB
, 
NPC_LT_NA
,

10266 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10268 
NPC_S_KPU4_NSH
, 8, 0,

10269 
NPC_LID_LB
, 
NPC_LT_NA
,

10274 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10276 
NPC_S_KPU5_IP
, 4, 0,

10277 
NPC_LID_LB
, 
NPC_LT_NA
,

10282 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10284 
NPC_S_KPU5_IP6
, 4, 0,

10285 
NPC_LID_LB
, 
NPC_LT_NA
,

10290 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10292 
NPC_S_KPU5_ARP
, 4, 0,

10293 
NPC_LID_LB
, 
NPC_LT_NA
,

10298 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10300 
NPC_S_KPU5_RARP
, 4, 0,

10301 
NPC_LID_LB
, 
NPC_LT_NA
,

10306 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10308 
NPC_S_KPU4_MPLS
, 4, 0,

10309 
NPC_LID_LB
, 
NPC_LT_NA
,

10314 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10316 
NPC_S_KPU4_MPLS
, 4, 0,

10317 
NPC_LID_LB
, 
NPC_LT_NA
,

10322 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10324 
NPC_S_KPU4_NSH
, 4, 0,

10325 
NPC_LID_LB
, 
NPC_LT_NA
,

10330 
NPC_ERRLEV_LB
, 
NPC_EC_L2_K3_ETYPE_UNK
,

10332 
NPC_S_NA
, 0, 0,

10333 
NPC_LID_LB
, 
NPC_LT_NA
,

10338 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10340 
NPC_S_KPU5_IP
, 8, 0,

10341 
NPC_LID_LB
, 
NPC_LT_NA
,

10346 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10348 
NPC_S_KPU5_IP6
, 8, 0,

10349 
NPC_LID_LB
, 
NPC_LT_NA
,

10354 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10356 
NPC_S_KPU5_ARP
, 8, 0,

10357 
NPC_LID_LB
, 
NPC_LT_NA
,

10362 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10364 
NPC_S_KPU5_RARP
, 8, 0,

10365 
NPC_LID_LB
, 
NPC_LT_NA
,

10370 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10372 
NPC_S_KPU5_PTP
, 8, 0,

10373 
NPC_LID_LB
, 
NPC_LT_NA
,

10378 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10380 
NPC_S_KPU5_FCOE
, 8, 0,

10381 
NPC_LID_LB
, 
NPC_LT_NA
,

10386 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10388 
NPC_S_KPU4_MPLS
, 8, 0,

10389 
NPC_LID_LB
, 
NPC_LT_NA
,

10394 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10396 
NPC_S_KPU4_MPLS
, 8, 0,

10397 
NPC_LID_LB
, 
NPC_LT_NA
,

10402 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10404 
NPC_S_KPU4_NSH
, 8, 0,

10405 
NPC_LID_LB
, 
NPC_LT_NA
,

10410 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10412 
NPC_S_KPU5_IP
, 4, 0,

10413 
NPC_LID_LB
, 
NPC_LT_NA
,

10418 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10420 
NPC_S_KPU5_IP6
, 4, 0,

10421 
NPC_LID_LB
, 
NPC_LT_NA
,

10426 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10428 
NPC_S_KPU5_ARP
, 4, 0,

10429 
NPC_LID_LB
, 
NPC_LT_NA
,

10434 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10436 
NPC_S_KPU5_RARP
, 4, 0,

10437 
NPC_LID_LB
, 
NPC_LT_NA
,

10442 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10444 
NPC_S_KPU5_PTP
, 4, 0,

10445 
NPC_LID_LB
, 
NPC_LT_NA
,

10450 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10452 
NPC_S_KPU5_FCOE
, 4, 0,

10453 
NPC_LID_LB
, 
NPC_LT_NA
,

10458 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10460 
NPC_S_KPU4_MPLS
, 4, 0,

10461 
NPC_LID_LB
, 
NPC_LT_NA
,

10466 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10468 
NPC_S_KPU4_MPLS
, 4, 0,

10469 
NPC_LID_LB
, 
NPC_LT_NA
,

10474 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10476 
NPC_S_KPU4_NSH
, 4, 0,

10477 
NPC_LID_LB
, 
NPC_LT_NA
,

10482 
NPC_ERRLEV_LB
, 
NPC_EC_L2_K3_ETYPE_UNK
,

10484 
NPC_S_NA
, 0, 0,

10485 
NPC_LID_LB
, 
NPC_LT_NA
,

10490 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10492 
NPC_S_KPU5_IP
, 2, 0,

10493 
NPC_LID_LB
, 
NPC_LT_NA
,

10498 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10500 
NPC_S_KPU5_IP6
, 2, 0,

10501 
NPC_LID_LB
, 
NPC_LT_NA
,

10506 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10508 
NPC_S_KPU5_ARP
, 2, 0,

10509 
NPC_LID_LB
, 
NPC_LT_NA
,

10514 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10516 
NPC_S_KPU5_RARP
, 2, 0,

10517 
NPC_LID_LB
, 
NPC_LT_NA
,

10522 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10524 
NPC_S_KPU5_PTP
, 2, 0,

10525 
NPC_LID_LB
, 
NPC_LT_NA
,

10530 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10532 
NPC_S_KPU5_FCOE
, 2, 0,

10533 
NPC_LID_LB
, 
NPC_LT_NA
,

10538 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10540 
NPC_S_KPU4_MPLS
, 2, 0,

10541 
NPC_LID_LB
, 
NPC_LT_NA
,

10546 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10548 
NPC_S_KPU4_MPLS
, 2, 0,

10549 
NPC_LID_LB
, 
NPC_LT_NA
,

10554 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10556 
NPC_S_KPU4_NSH
, 2, 0,

10557 
NPC_LID_LB
, 
NPC_LT_NA
,

10562 
NPC_ERRLEV_LB
, 
NPC_EC_L2_K3_ETYPE_UNK
,

10564 
NPC_S_NA
, 0, 0,

10565 
NPC_LID_LB
, 
NPC_LT_NA
,

10570 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10572 
NPC_S_KPU5_IP
, 8, 1,

10573 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10578 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10580 
NPC_S_KPU5_IP6
, 8, 1,

10581 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10586 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10588 
NPC_S_KPU5_ARP
, 8, 1,

10589 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10594 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10596 
NPC_S_KPU5_RARP
, 8, 1,

10597 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10602 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10604 
NPC_S_KPU5_PTP
, 8, 1,

10605 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10610 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10612 
NPC_S_KPU5_FCOE
, 8, 1,

10613 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10618 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10620 
NPC_S_KPU4_MPLS
, 8, 1,

10621 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10626 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10628 
NPC_S_KPU4_MPLS
, 8, 1,

10629 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10634 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10636 
NPC_S_KPU4_NSH
, 8, 1,

10637 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10642 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10644 
NPC_S_KPU5_IP
, 4, 1,

10645 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10650 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10652 
NPC_S_KPU5_IP6
, 4, 1,

10653 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10658 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10660 
NPC_S_KPU5_ARP
, 4, 1,

10661 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10666 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10668 
NPC_S_KPU5_RARP
, 4, 1,

10669 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10674 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10676 
NPC_S_KPU4_MPLS
, 4, 1,

10677 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10682 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10684 
NPC_S_KPU4_MPLS
, 4, 1,

10685 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10690 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10692 
NPC_S_KPU4_NSH
, 4, 1,

10693 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10698 
NPC_ERRLEV_LB
, 
NPC_EC_L2_K3_ETYPE_UNK
,

10700 
NPC_S_NA
, 0, 1,

10701 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10706 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10708 
NPC_S_KPU5_IP
, 8, 1,

10709 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10714 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10716 
NPC_S_KPU5_IP6
, 8, 1,

10717 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10722 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10724 
NPC_S_KPU5_ARP
, 8, 1,

10725 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10730 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10732 
NPC_S_KPU5_RARP
, 8, 1,

10733 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10738 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10740 
NPC_S_KPU5_PTP
, 8, 1,

10741 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10746 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10748 
NPC_S_KPU5_FCOE
, 8, 1,

10749 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10754 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10756 
NPC_S_KPU4_MPLS
, 8, 1,

10757 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10762 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10764 
NPC_S_KPU4_MPLS
, 8, 1,

10765 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10770 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10772 
NPC_S_KPU4_NSH
, 8, 1,

10773 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10778 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10780 
NPC_S_KPU5_IP
, 4, 1,

10781 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10786 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10788 
NPC_S_KPU5_IP6
, 4, 1,

10789 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10794 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10796 
NPC_S_KPU5_ARP
, 4, 1,

10797 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10802 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10804 
NPC_S_KPU5_RARP
, 4, 1,

10805 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10810 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10812 
NPC_S_KPU5_PTP
, 4, 1,

10813 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10818 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10820 
NPC_S_KPU5_FCOE
, 4, 1,

10821 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10826 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10828 
NPC_S_KPU4_MPLS
, 4, 1,

10829 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10834 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10836 
NPC_S_KPU4_MPLS
, 4, 1,

10837 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10842 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10844 
NPC_S_KPU4_NSH
, 4, 1,

10845 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10850 
NPC_ERRLEV_LB
, 
NPC_EC_L2_K3_ETYPE_UNK
,

10852 
NPC_S_NA
, 0, 1,

10853 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
,

10858 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10860 
NPC_S_KPU5_IP
, 10, 1,

10861 
NPC_LID_LB
, 
NPC_LT_LB_DSA
,

10862 
NPC_F_LB_L_DSA
,

10866 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10868 
NPC_S_KPU5_IP6
, 10, 1,

10869 
NPC_LID_LB
, 
NPC_LT_LB_DSA
,

10870 
NPC_F_LB_L_DSA
,

10874 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10876 
NPC_S_KPU5_ARP
, 10, 1,

10877 
NPC_LID_LB
, 
NPC_LT_LB_DSA
,

10878 
NPC_F_LB_L_DSA
,

10882 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10884 
NPC_S_KPU5_RARP
, 10, 1,

10885 
NPC_LID_LB
, 
NPC_LT_LB_DSA
,

10886 
NPC_F_LB_L_DSA
,

10890 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10892 
NPC_S_KPU5_PTP
, 10, 1,

10893 
NPC_LID_LB
, 
NPC_LT_LB_DSA
,

10894 
NPC_F_LB_L_DSA
,

10898 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10900 
NPC_S_KPU5_FCOE
, 10, 1,

10901 
NPC_LID_LB
, 
NPC_LT_LB_DSA
,

10902 
NPC_F_LB_L_DSA
,

10906 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10908 
NPC_S_KPU5_IP
, 14, 1,

10909 
NPC_LID_LB
, 
NPC_LT_LB_DSA_VLAN
,

10910 
NPC_F_LB_L_DSA_VLAN
,

10914 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10916 
NPC_S_KPU5_IP6
, 14, 1,

10917 
NPC_LID_LB
, 
NPC_LT_LB_DSA_VLAN
,

10918 
NPC_F_LB_L_DSA_VLAN
,

10922 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10924 
NPC_S_KPU5_ARP
, 14, 1,

10925 
NPC_LID_LB
, 
NPC_LT_LB_DSA_VLAN
,

10926 
NPC_F_LB_L_DSA_VLAN
,

10930 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10932 
NPC_S_KPU5_RARP
, 14, 1,

10933 
NPC_LID_LB
, 
NPC_LT_LB_DSA_VLAN
,

10934 
NPC_F_LB_L_DSA_VLAN
,

10938 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10940 
NPC_S_KPU5_PTP
, 14, 1,

10941 
NPC_LID_LB
, 
NPC_LT_LB_DSA_VLAN
,

10942 
NPC_F_LB_L_DSA_VLAN
,

10946 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10948 
NPC_S_KPU5_FCOE
, 14, 1,

10949 
NPC_LID_LB
, 
NPC_LT_LB_DSA_VLAN
,

10950 
NPC_F_LB_L_DSA_VLAN
,

10954 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10956 
NPC_S_NA
, 0, 1,

10957 
NPC_LID_LB
, 
NPC_LT_LB_DSA_VLAN
,

10958 
NPC_F_LB_U_UNK_ETYPE
 | 
NPC_F_LB_L_DSA
,

10962 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10964 
NPC_S_NA
, 0, 1,

10965 
NPC_LID_LB
, 
NPC_LT_LB_DSA
,

10966 
NPC_F_LB_U_UNK_ETYPE
 | 
NPC_F_LB_L_DSA_VLAN
,

10970 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10972 
NPC_S_KPU4_VLAN_EXDSA
, 12, 1,

10973 
NPC_LID_LB
, 
NPC_LT_LB_VLAN_EXDSA
,

10978 
NPC_ERRLEV_LB
, 
NPC_EC_L2_K3
,

10980 
NPC_S_NA
, 0, 0,

10981 
NPC_LID_LB
, 
NPC_LT_NA
,

10987 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu4_a˘i⁄_íåõs
[] = {

10988 
NPC_KPU_NOP_ACTION
,

10989 
NPC_KPU_NOP_ACTION
,

10990 
NPC_KPU_NOP_ACTION
,

10991 
NPC_KPU_NOP_ACTION
,

10992 
NPC_KPU_NOP_ACTION
,

10993 
NPC_KPU_NOP_ACTION
,

10995 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

10997 
NPC_S_KPU5_MPLS_PL
, 4, 1,

10998 
NPC_LID_LC
, 
NPC_LT_LC_MPLS
,

11003 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11005 
NPC_S_KPU5_MPLS_PL
, 8, 1,

11006 
NPC_LID_LC
, 
NPC_LT_LC_MPLS
,

11007 
NPC_F_LC_L_MPLS_2_LABELS
,

11011 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11013 
NPC_S_KPU5_MPLS_PL
, 12, 1,

11014 
NPC_LID_LC
, 
NPC_LT_LC_MPLS
,

11015 
NPC_F_LC_L_MPLS_3_LABELS
,

11019 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11021 
NPC_S_KPU5_MPLS
, 12, 1,

11022 
NPC_LID_LC
, 
NPC_LT_LC_MPLS
,

11023 
NPC_F_LC_L_MPLS_4_LABELS
,

11027 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11029 
NPC_S_KPU12_TU_IP
, 0, 1,

11030 
NPC_LID_LC
, 
NPC_LT_LC_NSH
,

11035 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11037 
NPC_S_KPU12_TU_IP6
, 0, 1,

11038 
NPC_LID_LC
, 
NPC_LT_LC_NSH
,

11043 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11045 
NPC_S_KPU11_TU_ETHER
, 0, 1,

11046 
NPC_LID_LC
, 
NPC_LT_LC_NSH
,

11051 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11053 
NPC_S_KPU9_TU_MPLS_IN_NSH
, 0, 1,

11054 
NPC_LID_LC
, 
NPC_LT_LC_NSH
,

11059 
NPC_ERRLEV_LC
, 
NPC_EC_NSH_UNK
,

11061 
NPC_S_NA
, 0, 1,

11062 
NPC_LID_LC
, 
NPC_LT_LC_NSH
,

11067 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11069 
NPC_S_KPU5_IP
, 6, 1,

11070 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11071 
NPC_F_LB_L_FDSA
,

11075 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11077 
NPC_S_KPU5_IP6
, 6, 1,

11078 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11079 
NPC_F_LB_L_FDSA
,

11083 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11085 
NPC_S_KPU5_ARP
, 6, 1,

11086 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11087 
NPC_F_LB_L_FDSA
,

11091 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11093 
NPC_S_KPU5_RARP
, 6, 1,

11094 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11095 
NPC_F_LB_L_FDSA
,

11099 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11101 
NPC_S_KPU5_PTP
, 6, 1,

11102 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11103 
NPC_F_LB_L_FDSA
,

11107 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11109 
NPC_S_KPU5_FCOE
, 6, 1,

11110 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11111 
NPC_F_LB_L_FDSA
,

11115 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11117 
NPC_S_KPU5_IP
, 10, 1,

11118 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11119 
NPC_F_LB_L_FDSA
,

11123 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11125 
NPC_S_KPU5_IP6
, 10, 1,

11126 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11127 
NPC_F_LB_L_FDSA
,

11131 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11133 
NPC_S_KPU5_ARP
, 10, 1,

11134 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11135 
NPC_F_LB_L_FDSA
,

11139 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11141 
NPC_S_KPU5_RARP
, 10, 1,

11142 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11143 
NPC_F_LB_L_FDSA
,

11147 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11149 
NPC_S_KPU5_PTP
, 10, 1,

11150 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11151 
NPC_F_LB_L_FDSA
,

11155 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11157 
NPC_S_KPU5_FCOE
, 10, 1,

11158 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11159 
NPC_F_LB_L_FDSA
,

11163 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11165 
NPC_S_KPU5_IP
, 14, 1,

11166 
NPC_LID_LB
, 
NPC_LT_LB_PPPOE
,

11171 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11173 
NPC_S_KPU5_IP6
, 14, 1,

11174 
NPC_LID_LB
, 
NPC_LT_LB_PPPOE
,

11179 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11181 
NPC_S_NA
, 0, 1,

11182 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
,

11183 
NPC_F_LB_U_UNK_ETYPE
 | 
NPC_F_LB_L_FDSA
,

11187 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11189 
NPC_S_KPU5_IP
, 2, 0,

11190 
NPC_LID_LC
, 
NPC_LT_NA
,

11195 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11197 
NPC_S_KPU5_IP6
, 2, 0,

11198 
NPC_LID_LC
, 
NPC_LT_NA
,

11203 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11205 
NPC_S_KPU5_ARP
, 2, 0,

11206 
NPC_LID_LC
, 
NPC_LT_NA
,

11211 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11213 
NPC_S_KPU5_RARP
, 2, 0,

11214 
NPC_LID_LC
, 
NPC_LT_NA
,

11219 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11221 
NPC_S_KPU5_PTP
, 2, 0,

11222 
NPC_LID_LC
, 
NPC_LT_NA
,

11227 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11229 
NPC_S_KPU5_FCOE
, 2, 0,

11230 
NPC_LID_LC
, 
NPC_LT_NA
,

11235 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11237 
NPC_S_NA
, 0, 0,

11238 
NPC_LID_LC
, 
NPC_LT_NA
,

11243 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11245 
NPC_S_KPU5_IP
, 10, 0,

11246 
NPC_LID_LB
, 
NPC_LT_LB_PPPOE
,

11251 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11253 
NPC_S_KPU5_IP6
, 10, 0,

11254 
NPC_LID_LB
, 
NPC_LT_LB_PPPOE
,

11259 
NPC_ERRLEV_LB
, 
NPC_EC_L2_K4
,

11261 
NPC_S_NA
, 0, 0,

11262 
NPC_LID_LC
, 
NPC_LT_NA
,

11268 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu5_a˘i⁄_íåõs
[] = {

11269 
NPC_KPU_NOP_ACTION
,

11270 
NPC_KPU_NOP_ACTION
,

11271 
NPC_KPU_NOP_ACTION
,

11272 
NPC_KPU_NOP_ACTION
,

11273 
NPC_KPU_NOP_ACTION
,

11274 
NPC_KPU_NOP_ACTION
,

11276 
NPC_ERRLEV_LC
, 
NPC_EC_IP_TTL_0
,

11278 
NPC_S_NA
, 0, 1,

11279 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11284 
NPC_ERRLEV_LC
, 
NPC_EC_IP_FRAG_OFFSET_1
,

11286 
NPC_S_NA
, 0, 1,

11287 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11288 
NPC_F_LC_U_IP_FRAG
,

11292 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11294 
NPC_S_KPU8_TCP
, 20, 1,

11295 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11300 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11302 
NPC_S_KPU8_UDP
, 20, 1,

11303 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11308 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11310 
NPC_S_KPU8_SCTP
, 20, 1,

11311 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11316 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11318 
NPC_S_KPU8_ICMP
, 20, 1,

11319 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11324 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11326 
NPC_S_KPU8_IGMP
, 20, 1,

11327 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11332 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11334 
NPC_S_KPU9_ESP
, 20, 1,

11335 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11340 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11342 
NPC_S_KPU8_AH
, 20, 1,

11343 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11348 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11350 
NPC_S_KPU8_GRE
, 20, 1,

11351 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11356 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11358 
NPC_S_KPU12_TU_IP
, 20, 1,

11359 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11360 
NPC_F_LC_L_IP_IN_IP
,

11364 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11366 
NPC_S_KPU12_TU_IP6
, 20, 1,

11367 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11368 
NPC_F_LC_L_6TO4
,

11372 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11374 
NPC_S_KPU9_TU_MPLS_IN_IP
, 20, 1,

11375 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11376 
NPC_F_LC_L_MPLS_IN_IP
,

11380 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11382 
NPC_S_NA
, 0, 1,

11383 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11384 
NPC_F_LC_U_UNK_PROTO
,

11388 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11390 
NPC_S_NA
, 0, 1,

11391 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11392 
NPC_F_LC_U_IP_FRAG
,

11396 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11398 
NPC_S_KPU8_TCP
, 0, 1,

11399 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11404 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11406 
NPC_S_KPU8_UDP
, 0, 1,

11407 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11412 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11414 
NPC_S_KPU8_SCTP
, 0, 1,

11415 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11420 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11422 
NPC_S_KPU8_ICMP
, 0, 1,

11423 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11428 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11430 
NPC_S_KPU8_IGMP
, 0, 1,

11431 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11436 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11438 
NPC_S_KPU9_ESP
, 0, 1,

11439 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11444 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11446 
NPC_S_KPU8_AH
, 0, 1,

11447 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11452 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11454 
NPC_S_KPU8_GRE
, 0, 1,

11455 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11460 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11462 
NPC_S_KPU12_TU_IP
, 0, 1,

11463 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11464 
NPC_F_LC_L_IP_IN_IP
,

11468 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11470 
NPC_S_KPU12_TU_IP6
, 0, 1,

11471 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11472 
NPC_F_LC_L_6TO4
,

11476 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11478 
NPC_S_KPU9_TU_MPLS_IN_IP
, 20, 1,

11479 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11480 
NPC_F_LC_L_MPLS_IN_IP
,

11484 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11486 
NPC_S_NA
, 0, 1,

11487 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11488 
NPC_F_LC_U_UNK_PROTO
,

11492 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11494 
NPC_S_NA
, 0, 1,

11495 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11496 
NPC_F_LC_U_IP_FRAG
,

11500 
NPC_ERRLEV_LC
, 
NPC_EC_IP_VER
,

11502 
NPC_S_NA
, 0, 1,

11503 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11508 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11510 
NPC_S_NA
, 0, 1,

11511 
NPC_LID_LC
, 
NPC_LT_LC_ARP
,

11516 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11518 
NPC_S_NA
, 0, 1,

11519 
NPC_LID_LC
, 
NPC_LT_LC_RARP
,

11524 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11526 
NPC_S_NA
, 0, 1,

11527 
NPC_LID_LC
, 
NPC_LT_LC_PTP
,

11532 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11534 
NPC_S_NA
, 0, 1,

11535 
NPC_LID_LC
, 
NPC_LT_LC_FCOE
,

11540 
NPC_ERRLEV_LC
, 
NPC_EC_IP6_HOP_0
,

11542 
NPC_S_NA
, 0, 1,

11543 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11548 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11550 
NPC_S_KPU8_TCP
, 40, 1,

11551 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11556 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11558 
NPC_S_KPU8_UDP
, 40, 1,

11559 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11564 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11566 
NPC_S_KPU8_SCTP
, 40, 1,

11567 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11572 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11574 
NPC_S_KPU8_ICMP
, 40, 1,

11575 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11580 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11582 
NPC_S_KPU8_ICMP6
, 40, 1,

11583 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11588 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11590 
NPC_S_KPU8_GRE
, 40, 1,

11591 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11596 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11598 
NPC_S_KPU12_TU_IP6
, 40, 1,

11599 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11600 
NPC_F_LC_L_IP6_TUN_IP6
,

11604 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11606 
NPC_S_KPU9_TU_MPLS_IN_IP
, 40, 1,

11607 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11608 
NPC_F_LC_L_IP6_MPLS_IN_IP
,

11612 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11614 
NPC_S_KPU6_IP6_HOP_DEST
, 40, 1,

11615 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

11616 
NPC_F_LC_L_EXT_HOP
,

11620 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11622 
NPC_S_KPU6_IP6_HOP_DEST
, 40, 1,

11623 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

11624 
NPC_F_LC_L_EXT_DEST
,

11628 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11630 
NPC_S_KPU6_IP6_ROUT
, 40, 1,

11631 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

11632 
NPC_F_LC_L_EXT_ROUT
,

11636 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11638 
NPC_S_KPU6_IP6_FRAG
, 40, 1,

11639 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

11640 
NPC_F_LC_U_IP6_FRAG
,

11644 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11646 
NPC_S_KPU9_ESP
, 40, 1,

11647 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

11652 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11654 
NPC_S_KPU8_AH
, 40, 1,

11655 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

11660 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11662 
NPC_S_NA
, 0, 1,

11663 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

11664 
NPC_F_LC_L_EXT_MOBILITY
,

11668 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11670 
NPC_S_NA
, 0, 1,

11671 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

11672 
NPC_F_LC_L_EXT_HOSTID
,

11676 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11678 
NPC_S_NA
, 0, 1,

11679 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

11680 
NPC_F_LC_L_EXT_SHIM6
,

11684 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11686 
NPC_S_NA
, 0, 1,

11687 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11688 
NPC_F_LC_U_UNK_PROTO
,

11692 
NPC_ERRLEV_LC
, 
NPC_EC_IP6_VER
,

11694 
NPC_S_NA
, 0, 1,

11695 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

11700 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11702 
NPC_S_KPU12_TU_IP
, 4, 0,

11703 
NPC_LID_LB
, 
NPC_LT_NA
,

11708 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11710 
NPC_S_KPU12_TU_IP6
, 4, 0,

11711 
NPC_LID_LB
, 
NPC_LT_NA
,

11716 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11718 
NPC_S_KPU11_TU_ETHER
, 8, 0,

11719 
NPC_LID_LB
, 
NPC_LT_NA
,

11724 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11726 
NPC_S_KPU11_TU_ETHER
, 4, 0,

11727 
NPC_LID_LB
, 
NPC_LT_NA
,

11732 
NPC_ERRLEV_LB
, 
NPC_EC_MPLS_2MANY
,

11734 
NPC_S_NA
, 0, 0,

11735 
NPC_LID_LB
, 
NPC_LT_NA
,

11740 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11742 
NPC_S_KPU12_TU_IP
, 0, 0,

11743 
NPC_LID_LB
, 
NPC_LT_NA
,

11748 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11750 
NPC_S_KPU12_TU_IP6
, 0, 0,

11751 
NPC_LID_LB
, 
NPC_LT_NA
,

11756 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11758 
NPC_S_KPU11_TU_ETHER
, 4, 0,

11759 
NPC_LID_LB
, 
NPC_LT_NA
,

11764 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11766 
NPC_S_KPU11_TU_ETHER
, 0, 0,

11767 
NPC_LID_LB
, 
NPC_LT_NA
,

11772 
NPC_ERRLEV_LC
, 
NPC_EC_IP_TTL_0
,

11774 
NPC_S_NA
, 0, 1,

11775 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11780 
NPC_ERRLEV_LC
, 
NPC_EC_IP_FRAG_OFFSET_1
,

11782 
NPC_S_NA
, 0, 1,

11783 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11784 
NPC_F_LC_U_IP_FRAG
,

11788 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11790 
NPC_S_KPU8_TCP
, 20, 1,

11791 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11796 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11798 
NPC_S_KPU8_UDP
, 20, 1,

11799 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11804 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11806 
NPC_S_KPU8_SCTP
, 20, 1,

11807 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11812 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11814 
NPC_S_KPU8_ICMP
, 20, 1,

11815 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11820 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11822 
NPC_S_KPU8_IGMP
, 20, 1,

11823 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11828 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11830 
NPC_S_KPU9_ESP
, 20, 1,

11831 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11836 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11838 
NPC_S_KPU8_AH
, 20, 1,

11839 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11844 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11846 
NPC_S_KPU8_GRE
, 20, 1,

11847 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11852 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11854 
NPC_S_KPU12_TU_IP
, 20, 1,

11855 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11856 
NPC_F_LC_L_IP_IN_IP
,

11860 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11862 
NPC_S_KPU12_TU_IP6
, 20, 1,

11863 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11864 
NPC_F_LC_L_6TO4
,

11868 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11870 
NPC_S_KPU9_TU_MPLS_IN_IP
, 20, 1,

11871 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11872 
NPC_F_LC_L_MPLS_IN_IP
,

11876 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11878 
NPC_S_KPU8_CUSTOM
, 20, 1,

11879 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11884 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11886 
NPC_S_NA
, 0, 1,

11887 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

11888 
NPC_F_LC_U_UNK_PROTO
,

11892 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11894 
NPC_S_KPU8_TCP
, 0, 1,

11895 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11900 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11902 
NPC_S_KPU8_UDP
, 0, 1,

11903 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11908 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11910 
NPC_S_KPU8_SCTP
, 0, 1,

11911 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11916 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11918 
NPC_S_KPU8_ICMP
, 0, 1,

11919 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11924 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11926 
NPC_S_KPU8_IGMP
, 0, 1,

11927 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11932 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11934 
NPC_S_KPU9_ESP
, 0, 1,

11935 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11940 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11942 
NPC_S_KPU8_AH
, 0, 1,

11943 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11948 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11950 
NPC_S_KPU8_GRE
, 0, 1,

11951 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11956 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11958 
NPC_S_KPU12_TU_IP
, 0, 1,

11959 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11960 
NPC_F_LC_L_IP_IN_IP
,

11964 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11966 
NPC_S_KPU12_TU_IP6
, 0, 1,

11967 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11968 
NPC_F_LC_L_6TO4
,

11972 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11974 
NPC_S_KPU9_TU_MPLS_IN_IP
, 20, 1,

11975 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11976 
NPC_F_LC_L_MPLS_IN_IP
,

11980 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11982 
NPC_S_KPU8_CUSTOM
, 0, 1,

11983 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11988 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

11990 
NPC_S_NA
, 0, 1,

11991 
NPC_LID_LC
, 
NPC_LT_LC_IP_OPT
,

11992 
NPC_F_LC_U_UNK_PROTO
,

11996 
NPC_ERRLEV_LC
, 
NPC_EC_IP_VER
,

11998 
NPC_S_NA
, 0, 1,

11999 
NPC_LID_LC
, 
NPC_LT_LC_IP
,

12004 
NPC_ERRLEV_LC
, 
NPC_EC_IP6_HOP_0
,

12006 
NPC_S_NA
, 0, 1,

12007 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12012 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12014 
NPC_S_KPU8_TCP
, 40, 1,

12015 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12020 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12022 
NPC_S_KPU8_UDP
, 40, 1,

12023 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12028 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12030 
NPC_S_KPU8_SCTP
, 40, 1,

12031 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12036 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12038 
NPC_S_KPU8_ICMP
, 40, 1,

12039 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12044 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12046 
NPC_S_KPU8_ICMP6
, 40, 1,

12047 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12052 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12054 
NPC_S_KPU8_GRE
, 40, 1,

12055 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12060 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12062 
NPC_S_KPU12_TU_IP6
, 40, 1,

12063 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12064 
NPC_F_LC_L_IP6_TUN_IP6
,

12068 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12070 
NPC_S_KPU9_TU_MPLS_IN_IP
, 40, 1,

12071 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12072 
NPC_F_LC_L_IP6_MPLS_IN_IP
,

12076 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12078 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 40, 1,

12079 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

12080 
NPC_F_LC_L_EXT_HOP
,

12084 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12086 
NPC_S_KPU6_IP6_CPT_HOP_DEST
, 40, 1,

12087 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

12088 
NPC_F_LC_L_EXT_DEST
,

12092 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12094 
NPC_S_KPU6_IP6_CPT_ROUT
, 40, 1,

12095 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

12096 
NPC_F_LC_L_EXT_ROUT
,

12100 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12102 
NPC_S_KPU6_IP6_CPT_FRAG
, 40, 1,

12103 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

12104 
NPC_F_LC_U_IP6_FRAG
,

12108 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12110 
NPC_S_KPU9_ESP
, 40, 1,

12111 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

12116 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12118 
NPC_S_KPU8_AH
, 40, 1,

12119 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

12124 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12126 
NPC_S_NA
, 0, 1,

12127 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

12128 
NPC_F_LC_L_EXT_MOBILITY
,

12132 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12134 
NPC_S_NA
, 0, 1,

12135 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

12136 
NPC_F_LC_L_EXT_HOSTID
,

12140 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12142 
NPC_S_NA
, 0, 1,

12143 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
,

12144 
NPC_F_LC_L_EXT_SHIM6
,

12148 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12150 
NPC_S_KPU8_CUSTOM
, 40, 1,

12151 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12156 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12158 
NPC_S_NA
, 0, 1,

12159 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12160 
NPC_F_LC_U_UNK_PROTO
,

12164 
NPC_ERRLEV_LC
, 
NPC_EC_IP6_VER
,

12166 
NPC_S_NA
, 0, 1,

12167 
NPC_LID_LC
, 
NPC_LT_LC_IP6
,

12172 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12174 
NPC_S_NA
, 0, 1,

12175 
NPC_LID_LC
, 
NPC_LT_LC_NGIO
,

12180 
NPC_ERRLEV_LC
, 
NPC_EC_UNK
,

12182 
NPC_S_NA
, 0, 0,

12183 
NPC_LID_LC
, 
NPC_LT_NA
,

12189 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu6_a˘i⁄_íåõs
[] = {

12190 
NPC_KPU_NOP_ACTION
,

12191 
NPC_KPU_NOP_ACTION
,

12192 
NPC_KPU_NOP_ACTION
,

12193 
NPC_KPU_NOP_ACTION
,

12194 
NPC_KPU_NOP_ACTION
,

12195 
NPC_KPU_NOP_ACTION
,

12197 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12199 
NPC_S_NA
, 0, 0,

12200 
NPC_LID_LC
, 
NPC_LT_NA
,

12205 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12207 
NPC_S_NA
, 0, 0,

12208 
NPC_LID_LC
, 
NPC_LT_NA
,

12213 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12215 
NPC_S_NA
, 0, 0,

12216 
NPC_LID_LC
, 
NPC_LT_NA
,

12221 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12223 
NPC_S_NA
, 0, 0,

12224 
NPC_LID_LC
, 
NPC_LT_NA
,

12229 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12231 
NPC_S_NA
, 0, 0,

12232 
NPC_LID_LC
, 
NPC_LT_NA
,

12237 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12239 
NPC_S_NA
, 0, 0,

12240 
NPC_LID_LC
, 
NPC_LT_NA
,

12245 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12247 
NPC_S_NA
, 0, 0,

12248 
NPC_LID_LC
, 
NPC_LT_NA
,

12253 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12255 
NPC_S_NA
, 0, 0,

12256 
NPC_LID_LC
, 
NPC_LT_NA
,

12261 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12263 
NPC_S_NA
, 0, 0,

12264 
NPC_LID_LC
, 
NPC_LT_NA
,

12269 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12271 
NPC_S_NA
, 0, 0,

12272 
NPC_LID_LC
, 
NPC_LT_NA
,

12277 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12279 
NPC_S_NA
, 0, 0,

12280 
NPC_LID_LC
, 
NPC_LT_NA
,

12285 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12287 
NPC_S_KPU8_CUSTOM
, 8, 0,

12288 
NPC_LID_LC
, 
NPC_LT_NA
,

12293 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12295 
NPC_S_NA
, 0, 0,

12296 
NPC_LID_LC
, 
NPC_LT_NA
,

12301 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12303 
NPC_S_KPU8_TCP
, 8, 0,

12304 
NPC_LID_LC
, 
NPC_LT_NA
,

12309 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12311 
NPC_S_KPU8_UDP
, 8, 0,

12312 
NPC_LID_LC
, 
NPC_LT_NA
,

12317 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12319 
NPC_S_KPU8_SCTP
, 8, 0,

12320 
NPC_LID_LC
, 
NPC_LT_NA
,

12325 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12327 
NPC_S_KPU8_ICMP
, 8, 0,

12328 
NPC_LID_LC
, 
NPC_LT_NA
,

12333 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12335 
NPC_S_KPU8_ICMP6
, 8, 0,

12336 
NPC_LID_LC
, 
NPC_LT_NA
,

12341 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12343 
NPC_S_KPU9_ESP
, 8, 0,

12344 
NPC_LID_LC
, 
NPC_LT_NA
,

12349 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12351 
NPC_S_KPU8_AH
, 8, 0,

12352 
NPC_LID_LC
, 
NPC_LT_NA
,

12357 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12359 
NPC_S_KPU8_GRE
, 8, 0,

12360 
NPC_LID_LC
, 
NPC_LT_NA
,

12365 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12367 
NPC_S_KPU12_TU_IP6
, 8, 0,

12368 
NPC_LID_LC
, 
NPC_LT_NA
,

12373 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12375 
NPC_S_KPU9_TU_MPLS_IN_IP
, 8, 0,

12376 
NPC_LID_LC
, 
NPC_LT_NA
,

12381 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12383 
NPC_S_KPU7_IP6_ROUT
, 8, 0,

12384 
NPC_LID_LC
, 
NPC_LT_NA
,

12389 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12391 
NPC_S_KPU7_IP6_FRAG
, 8, 0,

12392 
NPC_LID_LC
, 
NPC_LT_NA
,

12397 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12399 
NPC_S_KPU8_CUSTOM
, 8, 0,

12400 
NPC_LID_LC
, 
NPC_LT_NA
,

12405 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12407 
NPC_S_NA
, 0, 0,

12408 
NPC_LID_LC
, 
NPC_LT_NA
,

12413 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12415 
NPC_S_KPU8_TCP
, 8, 0,

12416 
NPC_LID_LC
, 
NPC_LT_NA
,

12421 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12423 
NPC_S_KPU8_UDP
, 8, 0,

12424 
NPC_LID_LC
, 
NPC_LT_NA
,

12429 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12431 
NPC_S_KPU8_SCTP
, 8, 0,

12432 
NPC_LID_LC
, 
NPC_LT_NA
,

12437 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12439 
NPC_S_KPU8_ICMP
, 8, 0,

12440 
NPC_LID_LC
, 
NPC_LT_NA
,

12445 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12447 
NPC_S_KPU8_ICMP6
, 8, 0,

12448 
NPC_LID_LC
, 
NPC_LT_NA
,

12453 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12455 
NPC_S_KPU9_ESP
, 8, 0,

12456 
NPC_LID_LC
, 
NPC_LT_NA
,

12461 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12463 
NPC_S_KPU8_AH
, 8, 0,

12464 
NPC_LID_LC
, 
NPC_LT_NA
,

12469 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12471 
NPC_S_KPU8_GRE
, 8, 0,

12472 
NPC_LID_LC
, 
NPC_LT_NA
,

12477 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12479 
NPC_S_KPU12_TU_IP6
, 8, 0,

12480 
NPC_LID_LC
, 
NPC_LT_NA
,

12485 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12487 
NPC_S_KPU9_TU_MPLS_IN_IP
, 8, 0,

12488 
NPC_LID_LC
, 
NPC_LT_NA
,

12493 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12495 
NPC_S_KPU7_IP6_FRAG
, 8, 0,

12496 
NPC_LID_LC
, 
NPC_LT_NA
,

12501 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12503 
NPC_S_KPU8_CUSTOM
, 8, 0,

12504 
NPC_LID_LC
, 
NPC_LT_NA
,

12509 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12511 
NPC_S_NA
, 0, 0,

12512 
NPC_LID_LC
, 
NPC_LT_NA
,

12517 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12519 
NPC_S_KPU8_TCP
, 8, 0,

12520 
NPC_LID_LC
, 
NPC_LT_NA
,

12525 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12527 
NPC_S_KPU8_UDP
, 8, 0,

12528 
NPC_LID_LC
, 
NPC_LT_NA
,

12533 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12535 
NPC_S_KPU8_SCTP
, 8, 0,

12536 
NPC_LID_LC
, 
NPC_LT_NA
,

12541 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12543 
NPC_S_KPU8_ICMP
, 8, 0,

12544 
NPC_LID_LC
, 
NPC_LT_NA
,

12549 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12551 
NPC_S_KPU8_ICMP6
, 8, 0,

12552 
NPC_LID_LC
, 
NPC_LT_NA
,

12557 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12559 
NPC_S_KPU9_ESP
, 8, 0,

12560 
NPC_LID_LC
, 
NPC_LT_NA
,

12565 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12567 
NPC_S_KPU8_AH
, 8, 0,

12568 
NPC_LID_LC
, 
NPC_LT_NA
,

12573 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12575 
NPC_S_KPU8_GRE
, 8, 0,

12576 
NPC_LID_LC
, 
NPC_LT_NA
,

12581 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12583 
NPC_S_KPU12_TU_IP6
, 8, 0,

12584 
NPC_LID_LC
, 
NPC_LT_NA
,

12589 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12591 
NPC_S_KPU9_TU_MPLS_IN_IP
, 8, 0,

12592 
NPC_LID_LC
, 
NPC_LT_NA
,

12597 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12599 
NPC_S_KPU8_CUSTOM
, 8, 0,

12600 
NPC_LID_LC
, 
NPC_LT_NA
,

12605 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12607 
NPC_S_NA
, 0, 0,

12608 
NPC_LID_LC
, 
NPC_LT_NA
,

12613 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12615 
NPC_S_KPU8_TCP
, 8, 0,

12616 
NPC_LID_LC
, 
NPC_LT_NA
,

12621 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12623 
NPC_S_KPU8_UDP
, 8, 0,

12624 
NPC_LID_LC
, 
NPC_LT_NA
,

12629 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12631 
NPC_S_KPU8_SCTP
, 8, 0,

12632 
NPC_LID_LC
, 
NPC_LT_NA
,

12637 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12639 
NPC_S_KPU8_ICMP
, 8, 0,

12640 
NPC_LID_LC
, 
NPC_LT_NA
,

12645 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12647 
NPC_S_KPU8_ICMP6
, 8, 0,

12648 
NPC_LID_LC
, 
NPC_LT_NA
,

12653 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12655 
NPC_S_KPU9_ESP
, 8, 0,

12656 
NPC_LID_LC
, 
NPC_LT_NA
,

12661 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12663 
NPC_S_KPU8_AH
, 8, 0,

12664 
NPC_LID_LC
, 
NPC_LT_NA
,

12669 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12671 
NPC_S_KPU8_GRE
, 8, 0,

12672 
NPC_LID_LC
, 
NPC_LT_NA
,

12677 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12679 
NPC_S_KPU12_TU_IP6
, 8, 0,

12680 
NPC_LID_LC
, 
NPC_LT_NA
,

12685 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12687 
NPC_S_KPU9_TU_MPLS_IN_IP
, 8, 0,

12688 
NPC_LID_LC
, 
NPC_LT_NA
,

12693 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12695 
NPC_S_KPU7_IP6_ROUT
, 8, 0,

12696 
NPC_LID_LC
, 
NPC_LT_NA
,

12701 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12703 
NPC_S_KPU7_CPT_IP6_FRAG
, 8, 0,

12704 
NPC_LID_LC
, 
NPC_LT_NA
,

12709 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12711 
NPC_S_KPU8_CUSTOM
, 8, 0,

12712 
NPC_LID_LC
, 
NPC_LT_NA
,

12717 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12719 
NPC_S_NA
, 0, 0,

12720 
NPC_LID_LC
, 
NPC_LT_NA
,

12725 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12727 
NPC_S_KPU8_TCP
, 8, 0,

12728 
NPC_LID_LC
, 
NPC_LT_NA
,

12733 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12735 
NPC_S_KPU8_UDP
, 8, 0,

12736 
NPC_LID_LC
, 
NPC_LT_NA
,

12741 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12743 
NPC_S_KPU8_SCTP
, 8, 0,

12744 
NPC_LID_LC
, 
NPC_LT_NA
,

12749 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12751 
NPC_S_KPU8_ICMP
, 8, 0,

12752 
NPC_LID_LC
, 
NPC_LT_NA
,

12757 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12759 
NPC_S_KPU8_ICMP6
, 8, 0,

12760 
NPC_LID_LC
, 
NPC_LT_NA
,

12765 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12767 
NPC_S_KPU9_ESP
, 8, 0,

12768 
NPC_LID_LC
, 
NPC_LT_NA
,

12773 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12775 
NPC_S_KPU8_AH
, 8, 0,

12776 
NPC_LID_LC
, 
NPC_LT_NA
,

12781 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12783 
NPC_S_KPU8_GRE
, 8, 0,

12784 
NPC_LID_LC
, 
NPC_LT_NA
,

12789 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12791 
NPC_S_KPU12_TU_IP6
, 8, 0,

12792 
NPC_LID_LC
, 
NPC_LT_NA
,

12797 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12799 
NPC_S_KPU9_TU_MPLS_IN_IP
, 8, 0,

12800 
NPC_LID_LC
, 
NPC_LT_NA
,

12805 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12807 
NPC_S_KPU7_CPT_IP6_FRAG
, 8, 0,

12808 
NPC_LID_LC
, 
NPC_LT_NA
,

12813 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12815 
NPC_S_KPU8_CUSTOM
, 8, 0,

12816 
NPC_LID_LC
, 
NPC_LT_NA
,

12821 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12823 
NPC_S_NA
, 0, 0,

12824 
NPC_LID_LC
, 
NPC_LT_NA
,

12829 
NPC_ERRLEV_LC
, 
NPC_EC_UNK
,

12831 
NPC_S_NA
, 0, 0,

12832 
NPC_LID_LC
, 
NPC_LT_NA
,

12838 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu7_a˘i⁄_íåõs
[] = {

12839 
NPC_KPU_NOP_ACTION
,

12840 
NPC_KPU_NOP_ACTION
,

12841 
NPC_KPU_NOP_ACTION
,

12842 
NPC_KPU_NOP_ACTION
,

12843 
NPC_KPU_NOP_ACTION
,

12844 
NPC_KPU_NOP_ACTION
,

12846 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12848 
NPC_S_NA
, 0, 0,

12849 
NPC_LID_LC
, 
NPC_LT_NA
,

12854 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12856 
NPC_S_KPU8_TCP
, 8, 0,

12857 
NPC_LID_LC
, 
NPC_LT_NA
,

12862 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12864 
NPC_S_KPU8_UDP
, 8, 0,

12865 
NPC_LID_LC
, 
NPC_LT_NA
,

12870 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12872 
NPC_S_KPU8_SCTP
, 8, 0,

12873 
NPC_LID_LC
, 
NPC_LT_NA
,

12878 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12880 
NPC_S_KPU8_ICMP
, 8, 0,

12881 
NPC_LID_LC
, 
NPC_LT_NA
,

12886 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12888 
NPC_S_KPU8_ICMP6
, 8, 0,

12889 
NPC_LID_LC
, 
NPC_LT_NA
,

12894 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12896 
NPC_S_KPU9_ESP
, 8, 0,

12897 
NPC_LID_LC
, 
NPC_LT_NA
,

12902 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12904 
NPC_S_KPU8_AH
, 8, 0,

12905 
NPC_LID_LC
, 
NPC_LT_NA
,

12910 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12912 
NPC_S_KPU8_GRE
, 8, 0,

12913 
NPC_LID_LC
, 
NPC_LT_NA
,

12918 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12920 
NPC_S_KPU12_TU_IP6
, 8, 0,

12921 
NPC_LID_LC
, 
NPC_LT_NA
,

12926 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12928 
NPC_S_KPU9_TU_MPLS_IN_IP
, 8, 0,

12929 
NPC_LID_LC
, 
NPC_LT_NA
,

12934 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12936 
NPC_S_KPU8_CUSTOM
, 8, 0,

12937 
NPC_LID_LC
, 
NPC_LT_NA
,

12942 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12944 
NPC_S_NA
, 0, 0,

12945 
NPC_LID_LC
, 
NPC_LT_NA
,

12950 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12952 
NPC_S_NA
, 0, 0,

12953 
NPC_LID_LC
, 
NPC_LT_NA
,

12958 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12960 
NPC_S_NA
, 0, 0,

12961 
NPC_LID_LC
, 
NPC_LT_NA
,

12966 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12968 
NPC_S_NA
, 0, 0,

12969 
NPC_LID_LC
, 
NPC_LT_NA
,

12974 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12976 
NPC_S_NA
, 0, 0,

12977 
NPC_LID_LC
, 
NPC_LT_NA
,

12982 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12984 
NPC_S_NA
, 0, 0,

12985 
NPC_LID_LC
, 
NPC_LT_NA
,

12990 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

12992 
NPC_S_NA
, 0, 0,

12993 
NPC_LID_LC
, 
NPC_LT_NA
,

12998 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13000 
NPC_S_NA
, 0, 0,

13001 
NPC_LID_LC
, 
NPC_LT_NA
,

13006 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13008 
NPC_S_NA
, 0, 0,

13009 
NPC_LID_LC
, 
NPC_LT_NA
,

13014 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13016 
NPC_S_NA
, 0, 0,

13017 
NPC_LID_LC
, 
NPC_LT_NA
,

13022 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13024 
NPC_S_NA
, 0, 0,

13025 
NPC_LID_LC
, 
NPC_LT_NA
,

13030 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13032 
NPC_S_KPU8_CUSTOM
, 8, 0,

13033 
NPC_LID_LC
, 
NPC_LT_NA
,

13038 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13040 
NPC_S_NA
, 0, 0,

13041 
NPC_LID_LC
, 
NPC_LT_NA
,

13046 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13048 
NPC_S_KPU8_TCP
, 8, 0,

13049 
NPC_LID_LC
, 
NPC_LT_NA
,

13054 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13056 
NPC_S_KPU8_UDP
, 8, 0,

13057 
NPC_LID_LC
, 
NPC_LT_NA
,

13062 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13064 
NPC_S_KPU8_SCTP
, 8, 0,

13065 
NPC_LID_LC
, 
NPC_LT_NA
,

13070 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13072 
NPC_S_KPU8_ICMP
, 8, 0,

13073 
NPC_LID_LC
, 
NPC_LT_NA
,

13078 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13080 
NPC_S_KPU8_ICMP6
, 8, 0,

13081 
NPC_LID_LC
, 
NPC_LT_NA
,

13086 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13088 
NPC_S_KPU9_ESP
, 8, 0,

13089 
NPC_LID_LC
, 
NPC_LT_NA
,

13094 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13096 
NPC_S_KPU8_AH
, 8, 0,

13097 
NPC_LID_LC
, 
NPC_LT_NA
,

13102 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13104 
NPC_S_KPU8_GRE
, 8, 0,

13105 
NPC_LID_LC
, 
NPC_LT_NA
,

13110 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13112 
NPC_S_KPU12_TU_IP6
, 8, 0,

13113 
NPC_LID_LC
, 
NPC_LT_NA
,

13118 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13120 
NPC_S_KPU9_TU_MPLS_IN_IP
, 8, 0,

13121 
NPC_LID_LC
, 
NPC_LT_NA
,

13126 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13128 
NPC_S_KPU8_CUSTOM
, 8, 0,

13129 
NPC_LID_LC
, 
NPC_LT_NA
,

13134 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13136 
NPC_S_NA
, 0, 0,

13137 
NPC_LID_LC
, 
NPC_LT_NA
,

13142 
NPC_ERRLEV_LC
, 
NPC_EC_UNK
,

13144 
NPC_S_NA
, 0, 0,

13145 
NPC_LID_LC
, 
NPC_LT_NA
,

13151 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu8_a˘i⁄_íåõs
[] = {

13152 
NPC_KPU_NOP_ACTION
,

13153 
NPC_KPU_NOP_ACTION
,

13154 
NPC_KPU_NOP_ACTION
,

13155 
NPC_KPU_NOP_ACTION
,

13156 
NPC_KPU_NOP_ACTION
,

13157 
NPC_KPU_NOP_ACTION
,

13159 
NPC_ERRLEV_LD
, 
NPC_EC_TCP_FLAGS_FIN_ONLY
,

13161 
NPC_S_NA
, 0, 1,

13162 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13167 
NPC_ERRLEV_LD
, 
NPC_EC_TCP_FLAGS_ZERO
,

13169 
NPC_S_NA
, 0, 1,

13170 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13175 
NPC_ERRLEV_LD
, 
NPC_EC_TCP_FLAGS_RST_FIN
,

13177 
NPC_S_NA
, 0, 1,

13178 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13183 
NPC_ERRLEV_LD
, 
NPC_EC_TCP_FLAGS_URG_SYN
,

13185 
NPC_S_NA
, 0, 1,

13186 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13191 
NPC_ERRLEV_LD
, 
NPC_EC_TCP_FLAGS_RST_SYN
,

13193 
NPC_S_NA
, 0, 1,

13194 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13199 
NPC_ERRLEV_LD
, 
NPC_EC_TCP_FLAGS_SYN_FIN
,

13201 
NPC_S_NA
, 0, 1,

13202 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13207 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13209 
NPC_S_KPU16_HTTP_DATA
, 20, 1,

13210 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13215 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13217 
NPC_S_KPU16_HTTPS_DATA
, 20, 1,

13218 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13223 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13225 
NPC_S_KPU16_PPTP_DATA
, 20, 1,

13226 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13231 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13233 
NPC_S_KPU16_TCP_DATA
, 20, 1,

13234 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13235 
NPC_F_LD_L_TCP_UNK_PORT
,

13239 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13241 
NPC_S_KPU16_HTTP_DATA
, 0, 1,

13242 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13243 
NPC_F_LD_L_TCP_HAS_OPTIONS
,

13247 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13249 
NPC_S_KPU16_HTTPS_DATA
, 0, 1,

13250 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13251 
NPC_F_LD_L_TCP_HAS_OPTIONS
,

13255 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13257 
NPC_S_KPU16_PPTP_DATA
, 0, 1,

13258 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13259 
NPC_F_LD_L_TCP_HAS_OPTIONS
,

13263 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13265 
NPC_S_KPU16_TCP_DATA
, 0, 1,

13266 
NPC_LID_LD
, 
NPC_LT_LD_TCP
,

13267 
NPC_F_LD_L_TCP_UNK_PORT_HAS_OPTIONS
,

13271 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13273 
NPC_S_KPU9_VXLAN
, 8, 1,

13274 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13279 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13281 
NPC_S_KPU9_VXLANGPE
, 8, 1,

13282 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13287 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13289 
NPC_S_KPU9_GENEVE
, 8, 1,

13290 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13295 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13297 
NPC_S_KPU9_GTPC
, 8, 1,

13298 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13303 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13305 
NPC_S_KPU9_GTPU
, 8, 1,

13306 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13311 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13313 
NPC_S_KPU16_UDP_PTP
, 0, 1,

13314 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13319 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13321 
NPC_S_KPU16_UDP_PTP
, 0, 1,

13322 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13327 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13329 
NPC_S_KPU9_TU_MPLS_IN_UDP
, 8, 1,

13330 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13335 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13337 
NPC_S_NA
, 8, 1,

13338 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13343 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13345 
NPC_S_KPU9_ESP
, 8, 1,

13346 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13351 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13353 
NPC_S_KPU9_ESP
, 8, 1,

13354 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13359 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13361 
NPC_S_KPU16_UDP_DATA
, 8, 1,

13362 
NPC_LID_LD
, 
NPC_LT_LD_UDP
,

13367 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13369 
NPC_S_NA
, 0, 1,

13370 
NPC_LID_LD
, 
NPC_LT_LD_SCTP
,

13375 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13377 
NPC_S_NA
, 0, 1,

13378 
NPC_LID_LD
, 
NPC_LT_LD_ICMP
,

13383 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13385 
NPC_S_NA
, 0, 1,

13386 
NPC_LID_LD
, 
NPC_LT_LD_IGMP
,

13391 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13393 
NPC_S_NA
, 0, 1,

13394 
NPC_LID_LD
, 
NPC_LT_LD_ICMP6
,

13399 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13401 
NPC_S_NA
, 0, 1,

13402 
NPC_LID_LD
, 
NPC_LT_LD_AH
,

13407 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13409 
NPC_S_KPU11_TU_ETHER
, 8, 1,

13410 
NPC_LID_LD
, 
NPC_LT_LD_NVGRE
,

13411 
NPC_F_LD_L_GRE_NVGRE
,

13415 
NPC_ERRLEV_LD
, 
NPC_EC_NVGRE
,

13417 
NPC_S_NA
, 0, 0,

13418 
NPC_LID_LD
, 
NPC_LT_NA
,

13423 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13425 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 4, 1,

13426 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13431 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13433 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 8, 1,

13434 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13435 
NPC_F_LD_L_GRE_HAS_CSUM
,

13439 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13441 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 8, 1,

13442 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13443 
NPC_F_LD_L_GRE_HAS_KEY
,

13447 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13449 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 8, 1,

13450 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13451 
NPC_F_LD_L_GRE_HAS_SEQ
,

13455 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13457 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 12, 1,

13458 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13459 
NPC_F_LD_L_GRE_HAS_CSUM_KEY
,

13463 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13465 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 12, 1,

13466 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13467 
NPC_F_LD_L_GRE_HAS_CSUM_SEQ
,

13471 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13473 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 12, 1,

13474 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13475 
NPC_F_LD_L_GRE_HAS_KEY_SEQ
,

13479 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13481 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 16, 1,

13482 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13483 
NPC_F_LD_L_GRE_HAS_CSUM_KEY_SEQ
,

13487 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13489 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 4, 1,

13490 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13495 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13497 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 8, 1,

13498 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13499 
NPC_F_LD_L_GRE_HAS_CSUM
,

13503 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13505 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 8, 1,

13506 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13507 
NPC_F_LD_L_GRE_HAS_KEY
,

13511 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13513 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 8, 1,

13514 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13515 
NPC_F_LD_L_GRE_HAS_SEQ
,

13519 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13521 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 12, 1,

13522 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13523 
NPC_F_LD_L_GRE_HAS_CSUM_KEY
,

13527 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13529 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 12, 1,

13530 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13531 
NPC_F_LD_L_GRE_HAS_CSUM_SEQ
,

13535 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13537 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 12, 1,

13538 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13539 
NPC_F_LD_L_GRE_HAS_KEY_SEQ
,

13543 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13545 
NPC_S_KPU9_TU_MPLS_IN_GRE
, 16, 1,

13546 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13547 
NPC_F_LD_L_GRE_HAS_CSUM_KEY_SEQ
,

13551 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13553 
NPC_S_KPU9_TU_NSH_IN_GRE
, 4, 1,

13554 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13559 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13561 
NPC_S_KPU9_TU_NSH_IN_GRE
, 8, 1,

13562 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13563 
NPC_F_LD_L_GRE_HAS_CSUM
,

13567 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13569 
NPC_S_KPU9_TU_NSH_IN_GRE
, 8, 1,

13570 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13571 
NPC_F_LD_L_GRE_HAS_KEY
,

13575 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13577 
NPC_S_KPU9_TU_NSH_IN_GRE
, 8, 1,

13578 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13579 
NPC_F_LD_L_GRE_HAS_SEQ
,

13583 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13585 
NPC_S_KPU9_TU_NSH_IN_GRE
, 12, 1,

13586 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13587 
NPC_F_LD_L_GRE_HAS_CSUM_KEY
,

13591 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13593 
NPC_S_KPU9_TU_NSH_IN_GRE
, 12, 1,

13594 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13595 
NPC_F_LD_L_GRE_HAS_CSUM_SEQ
,

13599 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13601 
NPC_S_KPU9_TU_NSH_IN_GRE
, 12, 1,

13602 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13603 
NPC_F_LD_L_GRE_HAS_KEY_SEQ
,

13607 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13609 
NPC_S_KPU9_TU_NSH_IN_GRE
, 16, 1,

13610 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13611 
NPC_F_LD_L_GRE_HAS_CSUM_KEY_SEQ
,

13615 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13617 
NPC_S_KPU12_TU_IP
, 4, 1,

13618 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13623 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13625 
NPC_S_KPU12_TU_IP
, 8, 1,

13626 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13627 
NPC_F_LD_L_GRE_HAS_CSUM
,

13631 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13633 
NPC_S_KPU12_TU_IP
, 8, 1,

13634 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13635 
NPC_F_LD_L_GRE_HAS_KEY
,

13639 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13641 
NPC_S_KPU12_TU_IP
, 8, 1,

13642 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13643 
NPC_F_LD_L_GRE_HAS_SEQ
,

13647 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13649 
NPC_S_KPU12_TU_IP
, 12, 1,

13650 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13651 
NPC_F_LD_L_GRE_HAS_CSUM_KEY
,

13655 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13657 
NPC_S_KPU12_TU_IP
, 12, 1,

13658 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13659 
NPC_F_LD_L_GRE_HAS_CSUM_SEQ
,

13663 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13665 
NPC_S_KPU12_TU_IP
, 12, 1,

13666 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13667 
NPC_F_LD_L_GRE_HAS_KEY_SEQ
,

13671 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13673 
NPC_S_KPU12_TU_IP
, 16, 1,

13674 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13675 
NPC_F_LD_L_GRE_HAS_CSUM_KEY_SEQ
,

13679 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13681 
NPC_S_KPU12_TU_IP6
, 4, 1,

13682 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13687 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13689 
NPC_S_KPU12_TU_IP6
, 8, 1,

13690 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13691 
NPC_F_LD_L_GRE_HAS_CSUM
,

13695 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13697 
NPC_S_KPU12_TU_IP6
, 8, 1,

13698 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13699 
NPC_F_LD_L_GRE_HAS_KEY
,

13703 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13705 
NPC_S_KPU12_TU_IP6
, 8, 1,

13706 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13707 
NPC_F_LD_L_GRE_HAS_SEQ
,

13711 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13713 
NPC_S_KPU12_TU_IP6
, 12, 1,

13714 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13715 
NPC_F_LD_L_GRE_HAS_CSUM_KEY
,

13719 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13721 
NPC_S_KPU12_TU_IP6
, 12, 1,

13722 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13723 
NPC_F_LD_L_GRE_HAS_CSUM_SEQ
,

13727 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13729 
NPC_S_KPU12_TU_IP6
, 12, 1,

13730 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13731 
NPC_F_LD_L_GRE_HAS_KEY_SEQ
,

13735 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13737 
NPC_S_KPU12_TU_IP6
, 16, 1,

13738 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13739 
NPC_F_LD_L_GRE_HAS_CSUM_KEY_SEQ
,

13743 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13745 
NPC_S_NA
, 0, 1,

13746 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13747 
NPC_F_LD_L_GRE_HAS_ROUTE
,

13751 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13753 
NPC_S_NA
, 0, 1,

13754 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13755 
NPC_F_LD_L_GRE_UNK_PROTO
,

13759 
NPC_ERRLEV_LD
, 
NPC_EC_GRE
,

13761 
NPC_S_NA
, 0, 0,

13762 
NPC_LID_LD
, 
NPC_LT_NA
,

13767 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13769 
NPC_S_KPU11_TU_PPP
, 8, 1,

13770 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13771 
NPC_F_LD_L_GRE_VER1
,

13775 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13777 
NPC_S_KPU11_TU_PPP
, 12, 1,

13778 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13779 
NPC_F_LD_L_GRE_VER1_HAS_SEQ
,

13783 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13785 
NPC_S_KPU11_TU_PPP
, 12, 1,

13786 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13787 
NPC_F_LD_L_GRE_VER1_HAS_ACK
,

13791 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13793 
NPC_S_KPU11_TU_PPP
, 16, 1,

13794 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13795 
NPC_F_LD_L_GRE_VER1_HAS_SEQ_ACK
,

13799 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13801 
NPC_S_NA
, 0, 1,

13802 
NPC_LID_LD
, 
NPC_LT_LD_GRE
,

13803 
NPC_F_LD_L_GRE_VER1_UNK_PROTO
,

13807 
NPC_ERRLEV_LD
, 
NPC_EC_GRE_VER1
,

13809 
NPC_S_NA
, 0, 0,

13810 
NPC_LID_LD
, 
NPC_LT_NA
,

13815 
NPC_ERRLEV_LD
, 
NPC_EC_NOERR
,

13817 
NPC_S_KPU9_CUSTOM
, 0, 0,

13818 
NPC_LT_NA
, NPC_LT_NA,

13823 
NPC_ERRLEV_LD
, 
NPC_EC_UNK
,

13825 
NPC_S_NA
, 0, 0,

13826 
NPC_LID_LD
, 
NPC_LT_NA
,

13832 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu9_a˘i⁄_íåõs
[] = {

13833 
NPC_KPU_NOP_ACTION
,

13834 
NPC_KPU_NOP_ACTION
,

13835 
NPC_KPU_NOP_ACTION
,

13836 
NPC_KPU_NOP_ACTION
,

13837 
NPC_KPU_NOP_ACTION
,

13838 
NPC_KPU_NOP_ACTION
,

13840 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13842 
NPC_S_KPU10_TU_MPLS_PL
, 4, 1,

13843 
NPC_LID_LE
, 
NPC_LT_LE_TU_MPLS_IN_GRE
,

13848 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13850 
NPC_S_KPU10_TU_MPLS_PL
, 8, 1,

13851 
NPC_LID_LE
, 
NPC_LT_LE_TU_MPLS_IN_GRE
,

13856 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13858 
NPC_S_KPU10_TU_MPLS_PL
, 12, 1,

13859 
NPC_LID_LE
, 
NPC_LT_LE_TU_MPLS_IN_GRE
,

13864 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13866 
NPC_S_KPU10_TU_MPLS
, 12, 1,

13867 
NPC_LID_LE
, 
NPC_LT_LE_TU_MPLS_IN_GRE
,

13872 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13874 
NPC_S_KPU10_TU_MPLS_PL
, 4, 1,

13875 
NPC_LID_LD
, 
NPC_LT_LD_TU_MPLS_IN_NSH
,

13880 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13882 
NPC_S_KPU10_TU_MPLS_PL
, 8, 1,

13883 
NPC_LID_LD
, 
NPC_LT_LD_TU_MPLS_IN_NSH
,

13884 
NPC_F_LD_L_MPLS_2_LABELS
,

13888 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13890 
NPC_S_KPU10_TU_MPLS_PL
, 12, 1,

13891 
NPC_LID_LD
, 
NPC_LT_LD_TU_MPLS_IN_NSH
,

13892 
NPC_F_LD_L_MPLS_3_LABELS
,

13896 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13898 
NPC_S_KPU10_TU_MPLS
, 12, 1,

13899 
NPC_LID_LD
, 
NPC_LT_LD_TU_MPLS_IN_NSH
,

13900 
NPC_F_LD_L_MPLS_4_LABELS
,

13904 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13906 
NPC_S_KPU10_TU_MPLS_PL
, 4, 1,

13907 
NPC_LID_LD
, 
NPC_LT_LD_TU_MPLS_IN_IP
,

13912 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13914 
NPC_S_KPU10_TU_MPLS_PL
, 8, 1,

13915 
NPC_LID_LD
, 
NPC_LT_LD_TU_MPLS_IN_IP
,

13916 
NPC_F_LD_L_MPLS_2_LABELS
,

13920 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13922 
NPC_S_KPU10_TU_MPLS_PL
, 12, 1,

13923 
NPC_LID_LD
, 
NPC_LT_LD_TU_MPLS_IN_IP
,

13924 
NPC_F_LD_L_MPLS_3_LABELS
,

13928 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13930 
NPC_S_KPU10_TU_MPLS
, 12, 1,

13931 
NPC_LID_LD
, 
NPC_LT_LD_TU_MPLS_IN_IP
,

13932 
NPC_F_LD_L_MPLS_4_LABELS
,

13936 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13938 
NPC_S_KPU12_TU_IP
, 0, 1,

13939 
NPC_LID_LE
, 
NPC_LT_LE_TU_NSH_IN_GRE
,

13944 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13946 
NPC_S_KPU12_TU_IP6
, 0, 1,

13947 
NPC_LID_LE
, 
NPC_LT_LE_TU_NSH_IN_GRE
,

13952 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13954 
NPC_S_KPU11_TU_ETHER
, 0, 1,

13955 
NPC_LID_LE
, 
NPC_LT_LE_TU_NSH_IN_GRE
,

13960 
NPC_ERRLEV_LE
, 
NPC_EC_NSH_UNK
,

13962 
NPC_S_NA
, 0, 1,

13963 
NPC_LID_LE
, 
NPC_LT_LE_TU_NSH_IN_GRE
,

13968 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13970 
NPC_S_KPU11_TU_ETHER
, 8, 1,

13971 
NPC_LID_LE
, 
NPC_LT_LE_VXLAN
,

13976 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13978 
NPC_S_KPU11_TU_ETHER
, 8, 1,

13979 
NPC_LID_LE
, 
NPC_LT_LE_VXLAN
,

13980 
NPC_F_LE_L_VXLAN_NOVNI
,

13984 
NPC_ERRLEV_LE
, 
NPC_EC_VXLAN
,

13986 
NPC_S_NA
, 0, 0,

13987 
NPC_LID_LE
, 
NPC_LT_NA
,

13992 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

13994 
NPC_S_KPU12_TU_IP
, 8, 1,

13995 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14000 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14002 
NPC_S_KPU12_TU_IP6
, 8, 1,

14003 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14008 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14010 
NPC_S_KPU11_TU_ETHER
, 8, 1,

14011 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14016 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14018 
NPC_S_KPU10_TU_NSH_IN_VXLANGPE
, 8, 1,

14019 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14024 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14026 
NPC_S_KPU10_TU_MPLS_IN_VXLANGPE
, 8, 1,

14027 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14032 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14034 
NPC_S_KPU12_TU_IP
, 8, 1,

14035 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14036 
NPC_F_LE_L_VXLANGPE_NOVNI
,

14040 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14042 
NPC_S_KPU12_TU_IP6
, 8, 1,

14043 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14044 
NPC_F_LE_L_VXLANGPE_NOVNI
,

14048 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14050 
NPC_S_KPU11_TU_ETHER
, 8, 1,

14051 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14052 
NPC_F_LE_L_VXLANGPE_NOVNI
,

14056 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14058 
NPC_S_KPU10_TU_NSH_IN_VXLANGPE
, 8, 1,

14059 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14060 
NPC_F_LE_L_VXLANGPE_NOVNI
,

14064 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14066 
NPC_S_KPU10_TU_MPLS_IN_VXLANGPE
, 8, 1,

14067 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14068 
NPC_F_LE_L_VXLANGPE_NOVNI
,

14072 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14074 
NPC_S_NA
, 0, 1,

14075 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14076 
NPC_F_LE_L_VXLANGPE_UNK
,

14080 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14082 
NPC_S_NA
, 0, 1,

14083 
NPC_LID_LE
, 
NPC_LT_LE_VXLANGPE
,

14084 
NPC_F_LE_L_VXLANGPE_NONP
,

14088 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14090 
NPC_S_KPU11_TU_ETHER
, 8, 1,

14091 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14096 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14098 
NPC_S_KPU11_TU_ETHER
, 8, 1,

14099 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14100 
NPC_F_LE_L_GENEVE_OAM
,

14104 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14106 
NPC_S_KPU11_TU_ETHER
, 8, 1,

14107 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14108 
NPC_F_LE_L_GENEVE_CRI_OPT
,

14112 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14114 
NPC_S_KPU11_TU_ETHER
, 8, 1,

14115 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14116 
NPC_F_LE_L_GENEVE_OAM_CRI_OPT
,

14120 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14122 
NPC_S_KPU12_TU_IP
, 8, 1,

14123 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14128 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14130 
NPC_S_KPU12_TU_IP
, 8, 1,

14131 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14132 
NPC_F_LE_L_GENEVE_OAM
,

14136 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14138 
NPC_S_KPU12_TU_IP
, 8, 1,

14139 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14140 
NPC_F_LE_L_GENEVE_CRI_OPT
,

14144 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14146 
NPC_S_KPU12_TU_IP
, 8, 1,

14147 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14148 
NPC_F_LE_L_GENEVE_OAM_CRI_OPT
,

14152 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14154 
NPC_S_KPU12_TU_IP6
, 8, 1,

14155 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14160 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14162 
NPC_S_KPU12_TU_IP6
, 8, 1,

14163 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14164 
NPC_F_LE_L_GENEVE_OAM
,

14168 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14170 
NPC_S_KPU12_TU_IP6
, 8, 1,

14171 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14172 
NPC_F_LE_L_GENEVE_CRI_OPT
,

14176 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14178 
NPC_S_KPU12_TU_IP6
, 8, 1,

14179 
NPC_LID_LE
, 
NPC_LT_LE_GENEVE
,

14180 
NPC_F_LE_L_GENEVE_OAM_CRI_OPT
,

14184 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14186 
NPC_S_NA
, 0, 1,

14187 
NPC_LID_LE
, 
NPC_LT_LE_GTPC
,

14192 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14194 
NPC_S_NA
, 0, 1,

14195 
NPC_LID_LE
, 
NPC_LT_LE_GTPU
,

14200 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14202 
NPC_S_KPU10_TU_MPLS_PL
, 4, 1,

14203 
NPC_LID_LE
, 
NPC_LT_LE_TU_MPLS_IN_UDP
,

14208 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14210 
NPC_S_KPU10_TU_MPLS_PL
, 8, 1,

14211 
NPC_LID_LE
, 
NPC_LT_LE_TU_MPLS_IN_UDP
,

14216 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14218 
NPC_S_KPU10_TU_MPLS_PL
, 12, 1,

14219 
NPC_LID_LE
, 
NPC_LT_LE_TU_MPLS_IN_UDP
,

14224 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14226 
NPC_S_KPU10_TU_MPLS
, 12, 1,

14227 
NPC_LID_LE
, 
NPC_LT_LE_TU_MPLS_IN_UDP
,

14232 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14234 
NPC_S_NA
, 0, 1,

14235 
NPC_LID_LE
, 
NPC_LT_LE_ESP
,

14240 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14242 
NPC_S_KPU12_TU_IP
, 0, 0,

14243 
NPC_LID_LE
, 
NPC_LT_NA
,

14248 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14250 
NPC_S_KPU12_TU_IP6
, 0, 0,

14251 
NPC_LID_LE
, 
NPC_LT_NA
,

14256 
NPC_ERRLEV_LE
, 
NPC_EC_UNK
,

14258 
NPC_S_NA
, 0, 0,

14259 
NPC_LID_LE
, 
NPC_LT_NA
,

14265 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu10_a˘i⁄_íåõs
[] = {

14266 
NPC_KPU_NOP_ACTION
,

14267 
NPC_KPU_NOP_ACTION
,

14268 
NPC_KPU_NOP_ACTION
,

14269 
NPC_KPU_NOP_ACTION
,

14270 
NPC_KPU_NOP_ACTION
,

14271 
NPC_KPU_NOP_ACTION
,

14273 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14275 
NPC_S_KPU12_TU_IP
, 4, 0,

14276 
NPC_LID_LF
, 
NPC_LT_NA
,

14281 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14283 
NPC_S_KPU12_TU_IP6
, 4, 0,

14284 
NPC_LID_LF
, 
NPC_LT_NA
,

14289 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14291 
NPC_S_KPU11_TU_ETHER
, 8, 0,

14292 
NPC_LID_LF
, 
NPC_LT_NA
,

14297 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14299 
NPC_S_KPU11_TU_ETHER
, 4, 0,

14300 
NPC_LID_LF
, 
NPC_LT_NA
,

14305 
NPC_ERRLEV_LE
, 
NPC_EC_MPLS_2MANY
,

14307 
NPC_S_NA
, 0, 0,

14308 
NPC_LID_LF
, 
NPC_LT_NA
,

14313 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14315 
NPC_S_KPU12_TU_IP
, 0, 0,

14316 
NPC_LID_LF
, 
NPC_LT_NA
,

14321 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14323 
NPC_S_KPU12_TU_IP6
, 0, 0,

14324 
NPC_LID_LF
, 
NPC_LT_NA
,

14329 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14331 
NPC_S_KPU11_TU_ETHER
, 4, 0,

14332 
NPC_LID_LF
, 
NPC_LT_NA
,

14337 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14339 
NPC_S_KPU11_TU_ETHER
, 0, 0,

14340 
NPC_LID_LF
, 
NPC_LT_NA
,

14345 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14347 
NPC_S_KPU11_TU_MPLS_PL
, 4, 1,

14348 
NPC_LID_LF
, 
NPC_LT_LF_TU_MPLS_IN_VXLANGPE
,

14353 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14355 
NPC_S_KPU11_TU_MPLS_PL
, 8, 1,

14356 
NPC_LID_LF
, 
NPC_LT_LF_TU_MPLS_IN_VXLANGPE
,

14361 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14363 
NPC_S_KPU11_TU_MPLS_PL
, 12, 1,

14364 
NPC_LID_LF
, 
NPC_LT_LF_TU_MPLS_IN_VXLANGPE
,

14369 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14371 
NPC_S_KPU11_TU_MPLS
, 12, 1,

14372 
NPC_LID_LF
, 
NPC_LT_LF_TU_MPLS_IN_VXLANGPE
,

14377 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14379 
NPC_S_KPU12_TU_IP
, 0, 1,

14380 
NPC_LID_LF
, 
NPC_LT_LF_TU_NSH_IN_VXLANGPE
,

14385 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14387 
NPC_S_KPU12_TU_IP6
, 0, 1,

14388 
NPC_LID_LF
, 
NPC_LT_LF_TU_NSH_IN_VXLANGPE
,

14393 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14395 
NPC_S_KPU11_TU_ETHER_IN_NSH
, 0, 1,

14396 
NPC_LID_LF
, 
NPC_LT_LF_TU_NSH_IN_VXLANGPE
,

14401 
NPC_ERRLEV_LF
, 
NPC_EC_NSH_UNK
,

14403 
NPC_S_NA
, 0, 1,

14404 
NPC_LID_LF
, 
NPC_LT_LF_TU_NSH_IN_VXLANGPE
,

14409 
NPC_ERRLEV_LE
, 
NPC_EC_UNK
,

14411 
NPC_S_NA
, 0, 0,

14412 
NPC_LID_LF
, 
NPC_LT_NA
,

14418 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu11_a˘i⁄_íåõs
[] = {

14419 
NPC_KPU_NOP_ACTION
,

14420 
NPC_KPU_NOP_ACTION
,

14421 
NPC_KPU_NOP_ACTION
,

14422 
NPC_KPU_NOP_ACTION
,

14423 
NPC_KPU_NOP_ACTION
,

14424 
NPC_KPU_NOP_ACTION
,

14426 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14428 
NPC_S_KPU12_TU_IP
, 14, 1,

14429 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14434 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14436 
NPC_S_KPU12_TU_IP6
, 14, 1,

14437 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14442 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14444 
NPC_S_KPU12_TU_ARP
, 14, 1,

14445 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14450 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14452 
NPC_S_KPU12_TU_IP
, 18, 1,

14453 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14454 
NPC_F_LF_L_WITH_CTAG
,

14458 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14460 
NPC_S_KPU12_TU_IP6
, 18, 1,

14461 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14462 
NPC_F_LF_L_WITH_CTAG
,

14466 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14468 
NPC_S_KPU12_TU_ARP
, 18, 1,

14469 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14470 
NPC_F_LF_L_WITH_CTAG
,

14474 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14476 
NPC_S_NA
, 0, 1,

14477 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14478 
NPC_F_LF_U_UNK_ETYPE
 | 
NPC_F_LF_L_WITH_CTAG
,

14482 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14484 
NPC_S_KPU12_TU_IP
, 22, 1,

14485 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14486 
NPC_F_LF_L_WITH_STAG_CTAG
,

14490 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14492 
NPC_S_KPU12_TU_IP6
, 22, 1,

14493 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14494 
NPC_F_LF_L_WITH_STAG_CTAG
,

14498 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14500 
NPC_S_KPU12_TU_ARP
, 22, 1,

14501 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14502 
NPC_F_LF_L_WITH_STAG_CTAG
,

14506 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14508 
NPC_S_NA
, 0, 1,

14509 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14510 
NPC_F_LF_U_UNK_ETYPE
 | 
NPC_F_LF_L_WITH_STAG_CTAG
,

14514 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14516 
NPC_S_KPU12_TU_IP
, 18, 1,

14517 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14518 
NPC_F_LF_L_WITH_CTAG
,

14522 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14524 
NPC_S_KPU12_TU_IP6
, 18, 1,

14525 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14526 
NPC_F_LF_L_WITH_CTAG
,

14530 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14532 
NPC_S_KPU12_TU_ARP
, 18, 1,

14533 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14534 
NPC_F_LF_L_WITH_CTAG
,

14538 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14540 
NPC_S_NA
, 0, 1,

14541 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14542 
NPC_F_LF_U_UNK_ETYPE
 | 
NPC_F_LF_L_WITH_CTAG
,

14546 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14548 
NPC_S_KPU12_TU_IP
, 22, 1,

14549 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14550 
NPC_F_LF_L_WITH_QINQ_CTAG
,

14554 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14556 
NPC_S_KPU12_TU_IP6
, 22, 1,

14557 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14558 
NPC_F_LF_L_WITH_QINQ_CTAG
,

14562 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14564 
NPC_S_KPU12_TU_ARP
, 22, 1,

14565 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14566 
NPC_F_LF_L_WITH_QINQ_CTAG
,

14570 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14572 
NPC_S_NA
, 0, 1,

14573 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14574 
NPC_F_LF_U_UNK_ETYPE
 | 
NPC_F_LF_L_WITH_QINQ_CTAG
,

14578 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14580 
NPC_S_KPU12_TU_IP
, 18, 1,

14581 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14582 
NPC_F_LF_L_WITH_QINQ
,

14586 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14588 
NPC_S_KPU12_TU_IP6
, 18, 1,

14589 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14590 
NPC_F_LF_L_WITH_QINQ
,

14594 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14596 
NPC_S_KPU12_TU_ARP
, 18, 1,

14597 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14598 
NPC_F_LF_L_WITH_QINQ
,

14602 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14604 
NPC_S_NA
, 0, 1,

14605 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14606 
NPC_F_LF_U_UNK_ETYPE
 | 
NPC_F_LF_L_WITH_QINQ
,

14610 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14612 
NPC_S_NA
, 0, 1,

14613 
NPC_LID_LF
, 
NPC_LT_LF_TU_ETHER
,

14614 
NPC_F_LF_U_UNK_ETYPE
,

14618 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14620 
NPC_S_NA
, 0, 1,

14621 
NPC_LID_LF
, 
NPC_LT_LF_TU_PPP
,

14626 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14628 
NPC_S_KPU12_TU_IP
, 4, 0,

14629 
NPC_LID_LF
, 
NPC_LT_NA
,

14634 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14636 
NPC_S_KPU12_TU_IP6
, 4, 0,

14637 
NPC_LID_LF
, 
NPC_LT_NA
,

14642 
NPC_ERRLEV_LF
, 
NPC_EC_MPLS_UNK
,

14644 
NPC_S_NA
, 0, 0,

14645 
NPC_LID_LF
, 
NPC_LT_NA
,

14650 
NPC_ERRLEV_LF
, 
NPC_EC_MPLS_2MANY
,

14652 
NPC_S_NA
, 0, 0,

14653 
NPC_LID_LF
, 
NPC_LT_NA
,

14658 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14660 
NPC_S_KPU12_TU_IP
, 0, 0,

14661 
NPC_LID_LF
, 
NPC_LT_NA
,

14666 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14668 
NPC_S_KPU12_TU_IP6
, 0, 0,

14669 
NPC_LID_LF
, 
NPC_LT_NA
,

14674 
NPC_ERRLEV_LF
, 
NPC_EC_MPLS_UNK
,

14676 
NPC_S_NA
, 0, 0,

14677 
NPC_LID_LF
, 
NPC_LT_NA
,

14682 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14684 
NPC_S_NA
, 0, 1,

14685 
NPC_LID_LG
, 
NPC_LT_LG_TU_ETHER_IN_NSH
,

14690 
NPC_ERRLEV_LF
, 
NPC_EC_UNK
,

14692 
NPC_S_NA
, 0, 0,

14693 
NPC_LID_LF
, 
NPC_LT_NA
,

14699 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu12_a˘i⁄_íåõs
[] = {

14700 
NPC_KPU_NOP_ACTION
,

14701 
NPC_KPU_NOP_ACTION
,

14702 
NPC_KPU_NOP_ACTION
,

14703 
NPC_KPU_NOP_ACTION
,

14704 
NPC_KPU_NOP_ACTION
,

14705 
NPC_KPU_NOP_ACTION
,

14707 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14709 
NPC_S_KPU15_TU_TCP
, 20, 1,

14710 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14715 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14717 
NPC_S_KPU15_TU_UDP
, 20, 1,

14718 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14723 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14725 
NPC_S_KPU15_TU_SCTP
, 20, 1,

14726 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14731 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14733 
NPC_S_KPU15_TU_ICMP
, 20, 1,

14734 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14739 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14741 
NPC_S_KPU15_TU_IGMP
, 20, 1,

14742 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14747 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14749 
NPC_S_KPU15_TU_ESP
, 20, 1,

14750 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14755 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14757 
NPC_S_KPU15_TU_AH
, 20, 1,

14758 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14763 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14765 
NPC_S_NA
, 0, 1,

14766 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14767 
NPC_F_LG_U_UNK_IP_PROTO
,

14771 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14773 
NPC_S_KPU15_TU_TCP
, 0, 1,

14774 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14775 
NPC_F_LG_U_IP_HAS_OPTIONS
,

14779 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14781 
NPC_S_KPU15_TU_UDP
, 0, 1,

14782 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14783 
NPC_F_LG_U_IP_HAS_OPTIONS
,

14787 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14789 
NPC_S_KPU15_TU_SCTP
, 0, 1,

14790 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14791 
NPC_F_LG_U_IP_HAS_OPTIONS
,

14795 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14797 
NPC_S_KPU15_TU_ICMP
, 0, 1,

14798 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14799 
NPC_F_LG_U_IP_HAS_OPTIONS
,

14803 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14805 
NPC_S_KPU15_TU_IGMP
, 0, 1,

14806 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14807 
NPC_F_LG_U_IP_HAS_OPTIONS
,

14811 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14813 
NPC_S_KPU15_TU_ESP
, 0, 1,

14814 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14815 
NPC_F_LG_U_IP_HAS_OPTIONS
,

14819 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14821 
NPC_S_KPU15_TU_AH
, 0, 1,

14822 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14823 
NPC_F_LG_U_IP_HAS_OPTIONS
,

14827 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14829 
NPC_S_NA
, 0, 1,

14830 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14831 
NPC_F_LG_U_IP_HAS_OPTIONS
 | 
NPC_F_LG_U_UNK_IP_PROTO
,

14835 
NPC_ERRLEV_LF
, 
NPC_EC_IP_VER
,

14837 
NPC_S_NA
, 0, 1,

14838 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP
,

14843 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14845 
NPC_S_NA
, 0, 1,

14846 
NPC_LID_LG
, 
NPC_LT_LG_TU_ARP
,

14851 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14853 
NPC_S_KPU15_TU_TCP
, 40, 1,

14854 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP6
,

14859 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14861 
NPC_S_KPU15_TU_UDP
, 40, 1,

14862 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP6
,

14867 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14869 
NPC_S_KPU15_TU_SCTP
, 40, 1,

14870 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP6
,

14875 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14877 
NPC_S_KPU15_TU_ICMP
, 40, 1,

14878 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP6
,

14883 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14885 
NPC_S_KPU15_TU_ICMP6
, 40, 1,

14886 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP6
,

14891 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14893 
NPC_S_KPU15_TU_ESP
, 40, 1,

14894 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP6
,

14899 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14901 
NPC_S_KPU15_TU_AH
, 40, 1,

14902 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP6
,

14907 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14909 
NPC_S_KPU13_TU_IP6_EXT
, 0, 1,

14910 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP6
,

14911 
NPC_F_LG_U_IP6_HAS_EXT
,

14915 
NPC_ERRLEV_LF
, 
NPC_EC_IP6_VER
,

14917 
NPC_S_NA
, 0, 1,

14918 
NPC_LID_LG
, 
NPC_LT_LG_TU_IP6
,

14923 
NPC_ERRLEV_LF
, 
NPC_EC_UNK
,

14925 
NPC_S_NA
, 0, 0,

14926 
NPC_LID_LG
, 
NPC_LT_NA
,

14932 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu13_a˘i⁄_íåõs
[] = {

14933 
NPC_KPU_NOP_ACTION
,

14934 
NPC_KPU_NOP_ACTION
,

14935 
NPC_KPU_NOP_ACTION
,

14936 
NPC_KPU_NOP_ACTION
,

14937 
NPC_KPU_NOP_ACTION
,

14938 
NPC_KPU_NOP_ACTION
,

14940 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14942 
NPC_S_NA
, 0, 0,

14943 
NPC_LID_LC
, 
NPC_LT_NA
,

14949 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu14_a˘i⁄_íåõs
[] = {

14950 
NPC_KPU_NOP_ACTION
,

14951 
NPC_KPU_NOP_ACTION
,

14952 
NPC_KPU_NOP_ACTION
,

14953 
NPC_KPU_NOP_ACTION
,

14954 
NPC_KPU_NOP_ACTION
,

14955 
NPC_KPU_NOP_ACTION
,

14957 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

14959 
NPC_S_NA
, 0, 0,

14960 
NPC_LID_LC
, 
NPC_LT_NA
,

14966 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu15_a˘i⁄_íåõs
[] = {

14967 
NPC_KPU_NOP_ACTION
,

14968 
NPC_KPU_NOP_ACTION
,

14969 
NPC_KPU_NOP_ACTION
,

14970 
NPC_KPU_NOP_ACTION
,

14971 
NPC_KPU_NOP_ACTION
,

14972 
NPC_KPU_NOP_ACTION
,

14974 
NPC_ERRLEV_LG
, 
NPC_EC_TCP_FLAGS_FIN_ONLY
,

14976 
NPC_S_NA
, 0, 1,

14977 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

14982 
NPC_ERRLEV_LG
, 
NPC_EC_TCP_FLAGS_ZERO
,

14984 
NPC_S_NA
, 0, 1,

14985 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

14990 
NPC_ERRLEV_LG
, 
NPC_EC_TCP_FLAGS_RST_FIN
,

14992 
NPC_S_NA
, 0, 1,

14993 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

14998 
NPC_ERRLEV_LG
, 
NPC_EC_TCP_FLAGS_URG_SYN
,

15000 
NPC_S_NA
, 0, 1,

15001 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15006 
NPC_ERRLEV_LG
, 
NPC_EC_TCP_FLAGS_RST_SYN
,

15008 
NPC_S_NA
, 0, 1,

15009 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15014 
NPC_ERRLEV_LG
, 
NPC_EC_TCP_FLAGS_SYN_FIN
,

15016 
NPC_S_NA
, 0, 1,

15017 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15022 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15024 
NPC_S_KPU16_HTTP_DATA
, 20, 1,

15025 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15026 
NPC_F_LH_L_TCP_HTTP
,

15030 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15032 
NPC_S_KPU16_HTTPS_DATA
, 20, 1,

15033 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15034 
NPC_F_LH_L_TCP_HTTP
,

15038 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15040 
NPC_S_KPU16_PPTP_DATA
, 20, 1,

15041 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15042 
NPC_F_LH_L_TCP_PPTP
,

15046 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15048 
NPC_S_KPU16_TCP_DATA
, 20, 1,

15049 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15050 
NPC_F_LH_L_TCP_UNK_PORT
,

15054 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15056 
NPC_S_KPU16_HTTP_DATA
, 0, 1,

15057 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15058 
NPC_F_LH_U_TCP_HAS_OPTIONS
 | 
NPC_F_LH_L_TCP_HTTP
,

15062 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15064 
NPC_S_KPU16_HTTPS_DATA
, 0, 1,

15065 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15066 
NPC_F_LH_U_TCP_HAS_OPTIONS
 | 
NPC_F_LH_L_TCP_HTTPS
,

15070 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15072 
NPC_S_KPU16_PPTP_DATA
, 0, 1,

15073 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15074 
NPC_F_LH_U_TCP_HAS_OPTIONS
 | 
NPC_F_LH_L_TCP_PPTP
,

15078 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15080 
NPC_S_KPU16_TCP_DATA
, 0, 1,

15081 
NPC_LID_LH
, 
NPC_LT_LH_TU_TCP
,

15082 
NPC_F_LH_U_TCP_HAS_OPTIONS
 | 
NPC_F_LH_L_TCP_UNK_PORT
,

15086 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15088 
NPC_S_KPU16_UDP_DATA
, 8, 1,

15089 
NPC_LID_LH
, 
NPC_LT_LH_TU_UDP
,

15090 
NPC_F_LH_L_UDP_UNK_PORT
,

15094 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15096 
NPC_S_NA
, 0, 1,

15097 
NPC_LID_LH
, 
NPC_LT_LH_TU_SCTP
,

15102 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15104 
NPC_S_NA
, 0, 1,

15105 
NPC_LID_LH
, 
NPC_LT_LH_TU_ICMP
,

15110 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15112 
NPC_S_NA
, 0, 1,

15113 
NPC_LID_LH
, 
NPC_LT_LH_TU_IGMP
,

15118 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15120 
NPC_S_NA
, 0, 1,

15121 
NPC_LID_LH
, 
NPC_LT_LH_TU_ICMP6
,

15126 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15128 
NPC_S_NA
, 0, 1,

15129 
NPC_LID_LH
, 
NPC_LT_LH_TU_ESP
,

15134 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15136 
NPC_S_NA
, 0, 1,

15137 
NPC_LID_LH
, 
NPC_LT_LH_TU_AH
,

15142 
NPC_ERRLEV_LG
, 
NPC_EC_L4
,

15144 
NPC_S_NA
, 0, 0,

15145 
NPC_LID_LH
, 
NPC_LT_NA
,

15151 
≈c_kpu_¥ofûe_a˘i⁄
 
	gkpu16_a˘i⁄_íåõs
[] = {

15152 
NPC_KPU_NOP_ACTION
,

15153 
NPC_KPU_NOP_ACTION
,

15154 
NPC_KPU_NOP_ACTION
,

15155 
NPC_KPU_NOP_ACTION
,

15156 
NPC_KPU_NOP_ACTION
,

15157 
NPC_KPU_NOP_ACTION
,

15159 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15161 
NPC_S_NA
, 0, 0,

15162 
NPC_LID_LH
, 
NPC_LT_NA
,

15167 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15169 
NPC_S_NA
, 0, 0,

15170 
NPC_LID_LH
, 
NPC_LT_NA
,

15175 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15177 
NPC_S_NA
, 0, 0,

15178 
NPC_LID_LH
, 
NPC_LT_NA
,

15183 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15185 
NPC_S_NA
, 0, 0,

15186 
NPC_LID_LH
, 
NPC_LT_NA
,

15191 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15193 
NPC_S_NA
, 0, 0,

15194 
NPC_LID_LH
, 
NPC_LT_NA
,

15199 
NPC_ERRLEV_RE
, 
NPC_EC_NOERR
,

15201 
NPC_S_NA
, 0, 0,

15202 
NPC_LID_LH
, 
NPC_LT_NA
,

15208 
≈c_kpu_¥ofûe
 
	g≈c_kpu_¥ofûes
[] = {

15210 
ARRAY_SIZE
(
kpu1_ˇm_íåõs
),

15211 
ARRAY_SIZE
(
kpu1_a˘i⁄_íåõs
),

15212 &
kpu1_ˇm_íåõs
[0],

15213 &
kpu1_a˘i⁄_íåõs
[0],

15216 
ARRAY_SIZE
(
kpu2_ˇm_íåõs
),

15217 
ARRAY_SIZE
(
kpu2_a˘i⁄_íåõs
),

15218 &
kpu2_ˇm_íåõs
[0],

15219 &
kpu2_a˘i⁄_íåõs
[0],

15222 
ARRAY_SIZE
(
kpu3_ˇm_íåõs
),

15223 
ARRAY_SIZE
(
kpu3_a˘i⁄_íåõs
),

15224 &
kpu3_ˇm_íåõs
[0],

15225 &
kpu3_a˘i⁄_íåõs
[0],

15228 
ARRAY_SIZE
(
kpu4_ˇm_íåõs
),

15229 
ARRAY_SIZE
(
kpu4_a˘i⁄_íåõs
),

15230 &
kpu4_ˇm_íåõs
[0],

15231 &
kpu4_a˘i⁄_íåõs
[0],

15234 
ARRAY_SIZE
(
kpu5_ˇm_íåõs
),

15235 
ARRAY_SIZE
(
kpu5_a˘i⁄_íåõs
),

15236 &
kpu5_ˇm_íåõs
[0],

15237 &
kpu5_a˘i⁄_íåõs
[0],

15240 
ARRAY_SIZE
(
kpu6_ˇm_íåõs
),

15241 
ARRAY_SIZE
(
kpu6_a˘i⁄_íåõs
),

15242 &
kpu6_ˇm_íåõs
[0],

15243 &
kpu6_a˘i⁄_íåõs
[0],

15246 
ARRAY_SIZE
(
kpu7_ˇm_íåõs
),

15247 
ARRAY_SIZE
(
kpu7_a˘i⁄_íåõs
),

15248 &
kpu7_ˇm_íåõs
[0],

15249 &
kpu7_a˘i⁄_íåõs
[0],

15252 
ARRAY_SIZE
(
kpu8_ˇm_íåõs
),

15253 
ARRAY_SIZE
(
kpu8_a˘i⁄_íåõs
),

15254 &
kpu8_ˇm_íåõs
[0],

15255 &
kpu8_a˘i⁄_íåõs
[0],

15258 
ARRAY_SIZE
(
kpu9_ˇm_íåõs
),

15259 
ARRAY_SIZE
(
kpu9_a˘i⁄_íåõs
),

15260 &
kpu9_ˇm_íåõs
[0],

15261 &
kpu9_a˘i⁄_íåõs
[0],

15264 
ARRAY_SIZE
(
kpu10_ˇm_íåõs
),

15265 
ARRAY_SIZE
(
kpu10_a˘i⁄_íåõs
),

15266 &
kpu10_ˇm_íåõs
[0],

15267 &
kpu10_a˘i⁄_íåõs
[0],

15270 
ARRAY_SIZE
(
kpu11_ˇm_íåõs
),

15271 
ARRAY_SIZE
(
kpu11_a˘i⁄_íåõs
),

15272 &
kpu11_ˇm_íåõs
[0],

15273 &
kpu11_a˘i⁄_íåõs
[0],

15276 
ARRAY_SIZE
(
kpu12_ˇm_íåõs
),

15277 
ARRAY_SIZE
(
kpu12_a˘i⁄_íåõs
),

15278 &
kpu12_ˇm_íåõs
[0],

15279 &
kpu12_a˘i⁄_íåõs
[0],

15282 
ARRAY_SIZE
(
kpu13_ˇm_íåõs
),

15283 
ARRAY_SIZE
(
kpu13_a˘i⁄_íåõs
),

15284 &
kpu13_ˇm_íåõs
[0],

15285 &
kpu13_a˘i⁄_íåõs
[0],

15288 
ARRAY_SIZE
(
kpu14_ˇm_íåõs
),

15289 
ARRAY_SIZE
(
kpu14_a˘i⁄_íåõs
),

15290 &
kpu14_ˇm_íåõs
[0],

15291 &
kpu14_a˘i⁄_íåõs
[0],

15294 
ARRAY_SIZE
(
kpu15_ˇm_íåõs
),

15295 
ARRAY_SIZE
(
kpu15_a˘i⁄_íåõs
),

15296 &
kpu15_ˇm_íåõs
[0],

15297 &
kpu15_a˘i⁄_íåõs
[0],

15300 
ARRAY_SIZE
(
kpu16_ˇm_íåõs
),

15301 
ARRAY_SIZE
(
kpu16_a˘i⁄_íåõs
),

15302 &
kpu16_ˇm_íåõs
[0],

15303 &
kpu16_a˘i⁄_íåõs
[0],

15307 
≈c_…_def_cfg
 
	g≈c_…_deÁu…s
 = {

15308 .
rx_ﬁ2
 = {

15309 .
lid
 = 
NPC_LID_LA
,

15310 .
	g…y≥_m©ch
 = 
NPC_LT_LA_ETHER
,

15311 .
	g…y≥_mask
 = 0x0F,

15313 .
	govœn
 = {

15314 .
lid
 = 
NPC_LID_LB
,

15315 .
	g…y≥_m©ch
 = 
NPC_LT_LB_CTAG
,

15316 .
	g…y≥_mask
 = 0x0F,

15318 .
	givœn
 = {

15319 .
lid
 = 
NPC_LID_LB
,

15320 .
	g…y≥_m©ch
 = 
NPC_LT_LB_STAG_QINQ
,

15321 .
	g…y≥_mask
 = 0x0F,

15323 .
	grx_où4
 = {

15324 .
lid
 = 
NPC_LID_LC
,

15325 .
	g…y≥_m©ch
 = 
NPC_LT_LC_IP
,

15326 .
	g…y≥_mask
 = 0x0E,

15328 .
	grx_iù4
 = {

15329 .
lid
 = 
NPC_LID_LG
,

15330 .
	g…y≥_m©ch
 = 
NPC_LT_LG_TU_IP
,

15331 .
	g…y≥_mask
 = 0x0F,

15333 .
	grx_où6
 = {

15334 .
lid
 = 
NPC_LID_LC
,

15335 .
	g…y≥_m©ch
 = 
NPC_LT_LC_IP6
,

15336 .
	g…y≥_mask
 = 0x0E,

15338 .
	grx_iù6
 = {

15339 .
lid
 = 
NPC_LID_LG
,

15340 .
	g…y≥_m©ch
 = 
NPC_LT_LG_TU_IP6
,

15341 .
	g…y≥_mask
 = 0x0F,

15343 .
	grx_Ÿ˝
 = {

15344 .
lid
 = 
NPC_LID_LD
,

15345 .
	g…y≥_m©ch
 = 
NPC_LT_LD_TCP
,

15346 .
	g…y≥_mask
 = 0x0F,

15348 .
	grx_ô˝
 = {

15349 .
lid
 = 
NPC_LID_LH
,

15350 .
	g…y≥_m©ch
 = 
NPC_LT_LH_TU_TCP
,

15351 .
	g…y≥_mask
 = 0x0F,

15353 .
	grx_oudp
 = {

15354 .
lid
 = 
NPC_LID_LD
,

15355 .
	g…y≥_m©ch
 = 
NPC_LT_LD_UDP
,

15356 .
	g…y≥_mask
 = 0x0F,

15358 .
	grx_iudp
 = {

15359 .
lid
 = 
NPC_LID_LH
,

15360 .
	g…y≥_m©ch
 = 
NPC_LT_LH_TU_UDP
,

15361 .
	g…y≥_mask
 = 0x0F,

15363 .
	grx_os˘p
 = {

15364 .
lid
 = 
NPC_LID_LD
,

15365 .
	g…y≥_m©ch
 = 
NPC_LT_LD_SCTP
,

15366 .
	g…y≥_mask
 = 0x0F,

15368 .
	grx_is˘p
 = {

15369 .
lid
 = 
NPC_LID_LH
,

15370 .
	g…y≥_m©ch
 = 
NPC_LT_LH_TU_SCTP
,

15371 .
	g…y≥_mask
 = 0x0F,

15373 .
	grx_ù£c
 = {

15375 .
lid
 = 
NPC_LID_LE
,

15376 .
	g…y≥_m©ch
 = 
NPC_LT_LE_ESP
,

15377 .
	g…y≥_mask
 = 0x0F,

15380 .
	g•i_off£t
 = 8,

15381 .
	glid
 = 
NPC_LID_LH
,

15382 .
	g…y≥_m©ch
 = 
NPC_LT_LH_TU_ESP
,

15383 .
	g…y≥_mask
 = 0x0F,

15386 .
	gpck_ﬁ2
 = {

15387 .
lid
 = 
NPC_LID_LA
,

15388 .
	g…y≥_m©ch
 = 
NPC_LT_LA_ETHER
,

15389 .
	g…y≥_mask
 = 0x0F,

15391 .
	gpck_où4
 = {

15392 .
lid
 = 
NPC_LID_LC
,

15393 .
	g…y≥_m©ch
 = 
NPC_LT_LC_IP
,

15394 .
	g…y≥_mask
 = 0x0E,

15396 .
	gpck_iù4
 = {

15397 .
lid
 = 
NPC_LID_LG
,

15398 .
	g…y≥_m©ch
 = 
NPC_LT_LG_TU_IP
,

15399 .
	g…y≥_mask
 = 0x0F,

15401 .
	grx_≠ad0
 = {

15402 .
vÆid
 = 0,

15403 .
	glid
 = 
NPC_LID_LC
,

15404 .
	g…y≥_m©ch
 = 
NPC_LT_LC_IP6
,

15405 .
	g…y≥_mask
 = 0x0F,

15407 .
	grx_≠ad1
 = {

15408 .
vÆid
 = 0,

15409 .
	glid
 = 
NPC_LID_LC
,

15410 .
	g…y≥_m©ch
 = 
NPC_LT_LC_IP6
,

15411 .
	g…y≥_mask
 = 0x0F,

15413 .
	grx_ë
 = {

15415 .
off£t
 = -2,

15416 .
	gvÆid
 = 1,

15417 .
	glid
 = 
NPC_LID_LC
,

15418 .
	g…y≥_m©ch
 = 
NPC_LT_NA
,

15419 .
	g…y≥_mask
 = 0x0,

15422 .
	glid
 = 
NPC_LID_LB
,

15423 .
	g…y≥_m©ch
 = 
NPC_LT_NA
,

15424 .
	g…y≥_mask
 = 0x0,

15429 
≈c_mˇm_kex
 
	g≈c_mkex_deÁu…
 = {

15430 .
mkex_sign
 = 
MKEX_SIGN
,

15431 .
	g«me
 = "default",

15432 .
	gkpu_vîsi⁄
 = 
NPC_KPU_PROFILE_VER
,

15433 .
	gkeyx_cfg
 = {

15435 [
NIX_INTF_RX
] = ((
u64
)
NPC_MCAM_KEY_X2
 << 32Ë| 
NPC_PARSE_NIBBLE_INTF_RX
 |

15436 (
u64
)
NPC_EXACT_NIBBLE_HIT
,

15438 [
NIX_INTF_TX
] = ((
u64
)
NPC_MCAM_KEY_X2
 << 32Ë| 
NPC_PARSE_NIBBLE_INTF_TX
,

15440 .
	götf_lid_…_ld
 = {

15442 [
NIX_INTF_RX
] = {

15443 [
NPC_LID_LA
] = {

15445 [
NPC_LT_LA_ETHER
] = {

15447 
KEX_LD_CFG
(0x05, 0x0, 0x1, 0x0, 
NPC_KEXOF_DMAC
),

15449 
KEX_LD_CFG
(0x01, 0xc, 0x1, 0x0, 0x5),

15452 [
NPC_LT_LA_HIGIG2_ETHER
] = {

15454 
KEX_LD_CFG
(0x01, 0x8, 0x1, 0x0, 
NPC_KEXOF_DMAC
),

15456 
KEX_LD_CFG
(0x01, 0xc, 0x1, 0x0,

15457 
NPC_KEXOF_DMAC
 + 2),

15460 [
NPC_LID_LB
] = {

15462 [
NPC_LT_LB_CTAG
] = {

15464 
KEX_LD_CFG
(0x01, 0x2, 0x1, 0x0, 0x7),

15466 
KEX_LD_CFG
(0x01, 0x4, 0x1, 0x0, 0x5),

15469 [
NPC_LT_LB_STAG_QINQ
] = {

15471 
KEX_LD_CFG
(0x01, 0x2, 0x1, 0x0, 0x7),

15473 
KEX_LD_CFG
(0x01, 0x8, 0x1, 0x0, 0x5),

15475 [
NPC_LT_LB_FDSA
] = {

15477 
KEX_LD_CFG
(0x0, 0x1, 0x1, 0x0, 0x7),

15479 
KEX_LD_CFG
(0x01, 0x4, 0x1, 0x0, 0x5),

15482 [
NPC_LID_LC
] = {

15484 [
NPC_LT_LC_IP
] = {

15486 
KEX_LD_CFG
(0x07, 0xc, 0x1, 0x0, 0x10),

15488 
KEX_LD_CFG
(0x0, 0x1, 0x1, 0x0, 0xf),

15491 [
NPC_LT_LC_IP6
] = {

15493 
KEX_LD_CFG
(0x07, 0x0, 0x1, 0x0, 0x10),

15496 [
NPC_LID_LD
] = {

15498 [
NPC_LT_LD_UDP
] = {

15500 
KEX_LD_CFG
(0x3, 0x0, 0x1, 0x0, 0x18),

15503 [
NPC_LT_LD_TCP
] = {

15505 
KEX_LD_CFG
(0x3, 0x0, 0x1, 0x0, 0x18),

15511 [
NIX_INTF_TX
] = {

15512 [
NPC_LID_LA
] = {

15517 [
NPC_LT_LA_IH_NIX_ETHER
] = {

15519 
KEX_LD_CFG
(0x01, 0x0, 0x1, 0x0, 0x4),

15521 
KEX_LD_CFG
(0x05, 0x8, 0x1, 0x0, 0xa),

15524 [
NPC_LT_LA_IH_NIX_HIGIG2_ETHER
] = {

15526 
KEX_LD_CFG
(0x01, 0x0, 0x1, 0x0, 0x4),

15528 
KEX_LD_CFG
(0x01, 0x10, 0x1, 0x0, 0xa),

15531 [
NPC_LID_LB
] = {

15533 [
NPC_LT_LB_CTAG
] = {

15535 
KEX_LD_CFG
(0x01, 0x2, 0x1, 0x0, 0x6),

15537 
KEX_LD_CFG
(0x01, 0x4, 0x1, 0x0, 0x8),

15540 [
NPC_LT_LB_STAG_QINQ
] = {

15542 
KEX_LD_CFG
(0x01, 0x2, 0x1, 0x0, 0x6),

15544 
KEX_LD_CFG
(0x01, 0x8, 0x1, 0x0, 0x8),

15547 [
NPC_LID_LC
] = {

15549 [
NPC_LT_LC_IP
] = {

15551 
KEX_LD_CFG
(0x07, 0xc, 0x1, 0x0, 0x10),

15554 [
NPC_LT_LC_IP6
] = {

15556 
KEX_LD_CFG
(0x07, 0x0, 0x1, 0x0, 0x10),

15559 [
NPC_LID_LD
] = {

15561 [
NPC_LT_LD_UDP
] = {

15563 
KEX_LD_CFG
(0x3, 0x0, 0x1, 0x0, 0x18),

15566 [
NPC_LT_LD_TCP
] = {

15568 
KEX_LD_CFG
(0x3, 0x0, 0x1, 0x0, 0x18),

	@ptp.c

8 
	~<löux/bôfõld.h
>

9 
	~<löux/devi˚.h
>

10 
	~<löux/moduÀ.h
>

11 
	~<löux/pci.h
>

12 
	~<löux/hπimî.h
>

13 
	~<löux/ktime.h
>

15 
	~"±p.h
"

16 
	~"mbox.h
"

17 
	~"rvu.h
"

19 
	#DRV_NAME
 "M¨vñ»PTP Drivî"

	)

21 
	#PCI_DEVID_OCTEONTX2_PTP
 0xA00C

	)

22 
	#PCI_SUBSYS_DEVID_OCTX2_98xx_PTP
 0xB100

	)

23 
	#PCI_SUBSYS_DEVID_OCTX2_96XX_PTP
 0xB200

	)

24 
	#PCI_SUBSYS_DEVID_OCTX2_95XX_PTP
 0xB300

	)

25 
	#PCI_SUBSYS_DEVID_OCTX2_95XXN_PTP
 0xB400

	)

26 
	#PCI_SUBSYS_DEVID_OCTX2_95MM_PTP
 0xB500

	)

27 
	#PCI_SUBSYS_DEVID_OCTX2_95XXO_PTP
 0xB600

	)

28 
	#PCI_DEVID_OCTEONTX2_RST
 0xA085

	)

29 
	#PCI_DEVID_CN10K_PTP
 0xA09E

	)

30 
	#PCI_SUBSYS_DEVID_CN10K_A_PTP
 0xB900

	)

31 
	#PCI_SUBSYS_DEVID_CNF10K_A_PTP
 0xBA00

	)

32 
	#PCI_SUBSYS_DEVID_CNF10K_B_PTP
 0xBC00

	)

34 
	#PCI_PTP_BAR_NO
 0

	)

36 
	#PTP_CLOCK_CFG
 0xF00ULL

	)

37 
	#PTP_CLOCK_CFG_PTP_EN
 
	`BIT_ULL
(0)

	)

38 
	#PTP_CLOCK_CFG_EXT_CLK_EN
 
	`BIT_ULL
(1)

	)

39 
	#PTP_CLOCK_CFG_EXT_CLK_IN_MASK
 
	`GENMASK_ULL
(7, 2)

	)

40 
	#PTP_CLOCK_CFG_TSTMP_EDGE
 
	`BIT_ULL
(9)

	)

41 
	#PTP_CLOCK_CFG_TSTMP_EN
 
	`BIT_ULL
(8)

	)

42 
	#PTP_CLOCK_CFG_TSTMP_IN_MASK
 
	`GENMASK_ULL
(15, 10)

	)

43 
	#PTP_CLOCK_CFG_PPS_EN
 
	`BIT_ULL
(30)

	)

44 
	#PTP_CLOCK_CFG_PPS_INV
 
	`BIT_ULL
(31)

	)

46 
	#PTP_PPS_HI_INCR
 0xF60ULL

	)

47 
	#PTP_PPS_LO_INCR
 0xF68ULL

	)

48 
	#PTP_PPS_THRESH_HI
 0xF58ULL

	)

50 
	#PTP_CLOCK_LO
 0xF08ULL

	)

51 
	#PTP_CLOCK_HI
 0xF10ULL

	)

52 
	#PTP_CLOCK_COMP
 0xF18ULL

	)

53 
	#PTP_TIMESTAMP
 0xF20ULL

	)

54 
	#PTP_CLOCK_SEC
 0xFD0ULL

	)

55 
	#PTP_SEC_ROLLOVER
 0xFD8ULL

	)

57 
	#CYCLE_MULT
 1000

	)

59 
±p
 *
	gfú°_±p_block
;

60 c⁄° 
pci_devi˚_id
 
	g±p_id_èbÀ
[];

62 
boﬁ
 
	$is_±p_dev_˙f10kb
(
±p
 *ptp)

64  (
±p
->
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CNF10K_B_PTP
Ë? 
åue
 : 
Ál£
;

65 
	}
}

67 
boﬁ
 
	$is_±p_dev_˙10k
(
±p
 *ptp)

69  (
±p
->
pdev
->
devi˚
 =
PCI_DEVID_CN10K_PTP
Ë? 
åue
 : 
Ál£
;

70 
	}
}

72 
boﬁ
 
	$˙10k_±p_îøè
(
±p
 *ptp)

74 i‡(
±p
->
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CN10K_A_PTP
 ||

75 
±p
->
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CNF10K_A_PTP
)

76  
åue
;

77  
Ál£
;

78 
	}
}

80 
boﬁ
 
	$is_±p_tsfmt_£c_n£c
(
±p
 *ptp)

82 i‡(
±p
->
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CN10K_A_PTP
 ||

83 
±p
->
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CNF10K_A_PTP
)

84  
åue
;

85  
Ál£
;

86 
	}
}

88 
hπimî_ª°¨t
 
	$±p_ª£t_thªsh
(
hπimî
 *hrtimer)

90 
±p
 *±∞
	`c⁄èöî_of
(
hπimî
, ptp, hrtimer);

91 
ktime_t
 
cuº_ts
 = 
	`ktime_gë
();

92 
ktime_t
 
dñè_ns
, 
≥riod_ns
;

93 
u64
 
±p_˛ock_hi
;

96 
dñè_ns
 = 
	`ktime_to_ns
(
	`ktime_sub
(
cuº_ts
, 
±p
->
œ°_ts
));

102 
±p_˛ock_hi
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_CLOCK_HI
);

103 i‡(
±p_˛ock_hi
 > 500000000) {

104 
≥riod_ns
 = 
	`ktime_£t
(0, (
NSEC_PER_SEC
 + 100 - 
±p_˛ock_hi
));

106 
	`wrôeq
(500000000, 
±p
->
ªg_ba£
 + 
PTP_PPS_THRESH_HI
);

107 
≥riod_ns
 = 
	`ktime_£t
(0, (
NSEC_PER_SEC
 + 100 - 
dñè_ns
));

110 
	`hπimî_f‹w¨d_now
(
hπimî
, 
≥riod_ns
);

111 
±p
->
œ°_ts
 = 
cuº_ts
;

113  
HRTIMER_RESTART
;

114 
	}
}

116 
	$±p_hπimî_°¨t
(
±p
 *±p, 
ktime_t
 
°¨t_ns
)

118 
ktime_t
 
≥riod_ns
;

120 
≥riod_ns
 = 
	`ktime_£t
(0, (
NSEC_PER_SEC
 + 100 - 
°¨t_ns
));

121 
	`hπimî_°¨t
(&
±p
->
hπimî
, 
≥riod_ns
, 
HRTIMER_MODE_REL
);

122 
±p
->
œ°_ts
 = 
	`ktime_gë
();

123 
	}
}

125 
u64
 
	$ªad_±p_t°mp_£c_n£c
(
±p
 *ptp)

127 
u64
 
£c
, 
£c1
, 
n£c
;

128 
Êags
;

130 
	`•ö_lock_úqßve
(&
±p
->
±p_lock
, 
Êags
);

131 
£c
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_CLOCK_SEC
) & 0xFFFFFFFFUL;

132 
n£c
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_CLOCK_HI
);

133 
£c1
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_CLOCK_SEC
) & 0xFFFFFFFFUL;

135 i‡(
£c1
 > 
£c
) {

136 
n£c
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_CLOCK_HI
);

137 
£c
 = 
£c1
;

139 
	`•ö_u∆ock_úqª°‹e
(&
±p
->
±p_lock
, 
Êags
);

141  
£c
 * 
NSEC_PER_SEC
 + 
n£c
;

142 
	}
}

144 
u64
 
	$ªad_±p_t°mp_n£c
(
±p
 *ptp)

146  
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_CLOCK_HI
);

147 
	}
}

149 
u64
 
	$±p_ˇlc_adju°ed_comp
(
u64
 
±p_˛ock_‰eq
)

151 
u64
 
comp
, 
adj
 = 0, 
cy˛es_≥r_£c
, 
ns_dri·
 = 0;

152 
u32
 
±p_˛ock_n£c
, 
cy˛e_time
;

153 
cy˛e
;

165 
comp
 = ((
u64
)1000000000ULL << 32Ë/ 
±p_˛ock_‰eq
;

167 
cy˛e_time
 = 
NSEC_PER_SEC
 * 
CYCLE_MULT
 / 
±p_˛ock_‰eq
;

169 
cy˛es_≥r_£c
 = 
±p_˛ock_‰eq
;

172 
cy˛e
 = 
cy˛es_≥r_£c
 - 1;

173 
±p_˛ock_n£c
 = (
cy˛e
 * 
comp
) >> 32;

174 
±p_˛ock_n£c
 < 
NSEC_PER_SEC
) {

175 i‡(
±p_˛ock_n£c
 == 0x3B9AC9FF)

176 
ˇlc_adj_comp
;

177 
cy˛e
++;

178 
±p_˛ock_n£c
 = (
cy˛e
 * 
comp
) >> 32;

181 
ns_dri·
 = 
±p_˛ock_n£c
 - 
NSEC_PER_SEC
;

183 i‡(
ns_dri·
 > 0) {

184 
adj
 = 
comp
 * 
ns_dri·
;

185 
adj
 =ádj / 1000000000ULL;

188 
comp
 +
adj
;

189  
comp
;

191 
ˇlc_adj_comp
:

193 
adj
 = 
comp
 * 
cy˛e_time
;

194 
adj
 =ádj / 1000000000ULL;

195 
adj
 =ádj / 
CYCLE_MULT
;

196 
comp
 -
adj
;

198  
comp
;

199 
	}
}

201 
±p
 *
	$±p_gë
()

203 
±p
 *±∞
fú°_±p_block
;

206 i‡(!
	`pci_dev_¥e£¡
(
±p_id_èbÀ
))

207  
	`ERR_PTR
(-
ENODEV
);

209 i‡(!
±p
)

210 
±p
 = 
	`ERR_PTR
(-
EPROBE_DEFER
);

212 
	`pci_dev_gë
(
±p
->
pdev
);

214  
±p
;

215 
	}
}

217 
	$±p_put
(
±p
 *ptp)

219 i‡(!
±p
)

222 
	`pci_dev_put
(
±p
->
pdev
);

223 
	}
}

225 
	$±p_adjföe
(
±p
 *±p, 
sˇÀd_µm
)

227 
boﬁ
 
√g_adj
 = 
Ál£
;

228 
u32
 
‰eq
, 
‰eq_adj
;

229 
u64
 
comp
, 
adj
;

230 
s64
 
µb
;

232 i‡(
sˇÀd_µm
 < 0) {

233 
√g_adj
 = 
åue
;

234 
sˇÀd_µm
 = -scaled_ppm;

252 
µb
 = 1 + 
sˇÀd_µm
;

253 
µb
 *= 125;

254 
µb
 >>= 13;

256 i‡(
	`˙10k_±p_îøè
(
±p
)) {

258 
‰eq_adj
 = (
±p
->
˛ock_øã
 * 
µb
) / 1000000000ULL;

259 
‰eq
 = 
√g_adj
 ? 
±p
->
˛ock_øã
 + 
‰eq_adj
 :Ötp->clock_rate - freq_adj;

260 
comp
 = 
	`±p_ˇlc_adju°ed_comp
(
‰eq
);

262 
comp
 = ((
u64
)1000000000uŒ << 32Ë/ 
±p
->
˛ock_øã
;

263 
adj
 = 
comp
 * 
µb
;

264 
adj
 = 
	`div_u64
(adj, 1000000000ull);

265 
comp
 = 
√g_adj
 ? com∞- 
adj
 : comp +ádj;

267 
	`wrôeq
(
comp
, 
±p
->
ªg_ba£
 + 
PTP_CLOCK_COMP
);

270 
	}
}

272 
ölöe
 
u64
 
	$gë_tsc
(
boﬁ
 
is_pmu
)

274 #i‡
	`deföed
(
CONFIG_ARM64
)

275  
is_pmu
 ? 
	`ªad_sy§eg
(
pmc˙å_ñ0
Ë:Ñód_sy§eg(
˙tv˘_ñ0
);

279 
	}
}

281 
	$±p_gë_˛ock
(
±p
 *±p, 
boﬁ
 
is_pmu
, 
u64
 *
˛k
, u64 *
tsc
)

283 
u64
 
íd
, 
°¨t
;

284 
u8
 
ªåõs
 = 0;

287 
°¨t
 = 
	`gë_tsc
(0);

288 *
tsc
 = 
	`gë_tsc
(
is_pmu
);

289 *
˛k
 = 
±p
->
	`ªad_±p_t°mp
(ptp);

290 
íd
 = 
	`gë_tsc
(0);

291 
ªåõs
++;

292 } ((
íd
 - 
°¨t
Ë> 50Ë&& 
ªåõs
 < 5);

295 
	}
}

297 
	$±p_°¨t
(
±p
 *±p, 
u64
 
s˛k
, 
u32
 
ext_˛k_‰eq
, u32 
exâs
)

299 
pci_dev
 *
pdev
;

300 
u64
 
˛ock_comp
;

301 
u64
 
˛ock_cfg
;

303 i‡(!
±p
)

306 
pdev
 = 
±p
->pdev;

308 i‡(!
s˛k
) {

309 
	`dev_îr
(&
pdev
->
dev
, "PTP input clock cannot be zero\n");

314 
±p
->
˛ock_øã
 = 
s˛k
 * 1000000;

317 i‡(
	`is_±p_dev_˙f10kb
(
±p
))

318 
	`wrôeq
(0x3b9aˇ00, 
±p
->
ªg_ba£
 + 
PTP_SEC_ROLLOVER
);

321 
˛ock_cfg
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_CLOCK_CFG
);

323 i‡(
ext_˛k_‰eq
) {

324 
±p
->
˛ock_øã
 = 
ext_˛k_‰eq
;

326 
˛ock_cfg
 &~
PTP_CLOCK_CFG_EXT_CLK_IN_MASK
;

327 
˛ock_cfg
 |
PTP_CLOCK_CFG_EXT_CLK_EN
;

330 i‡(
exâs
) {

331 
˛ock_cfg
 |
PTP_CLOCK_CFG_TSTMP_EDGE
;

333 
˛ock_cfg
 &~
PTP_CLOCK_CFG_TSTMP_IN_MASK
;

334 
˛ock_cfg
 |
PTP_CLOCK_CFG_TSTMP_EN
;

337 
˛ock_cfg
 |
PTP_CLOCK_CFG_PTP_EN
;

338 
˛ock_cfg
 |
PTP_CLOCK_CFG_PPS_EN
 | 
PTP_CLOCK_CFG_PPS_INV
;

339 
	`wrôeq
(
˛ock_cfg
, 
±p
->
ªg_ba£
 + 
PTP_CLOCK_CFG
);

342 
	`wrôeq
(0x1dcd650000000000, 
±p
->
ªg_ba£
 + 
PTP_PPS_HI_INCR
);

343 
	`wrôeq
(0x1dcd650000000000, 
±p
->
ªg_ba£
 + 
PTP_PPS_LO_INCR
);

344 i‡(
	`˙10k_±p_îøè
(
±p
)) {

352 
±p
->
˛ock_≥riod
 = 
NSEC_PER_SEC
 /Öç->
˛ock_øã
;

353 
	`wrôeq
((0x1dcd6500ULL - 
±p
->
˛ock_≥riod
) << 32,

354 
±p
->
ªg_ba£
 + 
PTP_PPS_LO_INCR
);

357 i‡(
	`˙10k_±p_îøè
(
±p
))

358 
˛ock_comp
 = 
	`±p_ˇlc_adju°ed_comp
(
±p
->
˛ock_øã
);

360 
˛ock_comp
 = ((
u64
)1000000000uŒ << 32Ë/ 
±p
->
˛ock_øã
;

363 
	`wrôeq
(
˛ock_comp
, 
±p
->
ªg_ba£
 + 
PTP_CLOCK_COMP
);

364 
	}
}

366 
	$±p_gë_t°mp
(
±p
 *±p, 
u64
 *
˛k
)

368 
u64
 
time°amp
;

370 i‡(
	`is_±p_dev_˙10k
(
±p
)) {

371 
time°amp
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_TIMESTAMP
);

372 *
˛k
 = (
time°amp
 >> 32Ë* 
NSEC_PER_SEC
 + (timestamp & 0xFFFFFFFF);

374 *
˛k
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_TIMESTAMP
);

378 
	}
}

380 
	$±p_£t_thªsh
(
±p
 *±p, 
u64
 
thªsh
)

382 i‡(
	`˙10k_±p_îøè
(
±p
)) {

386 
	`wrôeq
(
thªsh
, 
±p
->
ªg_ba£
 + 
PTP_PPS_THRESH_HI
);

390 
	}
}

392 
	$±p_exâs_⁄
(
±p
 *±p, 
⁄
)

394 
u64
 
±p_˛ock_hi
;

396 i‡(
	`˙10k_±p_îøè
(
±p
)) {

397 i‡(
⁄
) {

398 
±p_˛ock_hi
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_CLOCK_HI
);

399 
	`±p_hπimî_°¨t
(
±p
, (
ktime_t
)
±p_˛ock_hi
);

401 i‡(
	`hπimî_a˘ive
(&
±p
->
hπimî
))

402 
	`hπimî_ˇn˚l
(&
±p
->
hπimî
);

407 
	}
}

409 
	$±p_¥obe
(
pci_dev
 *
pdev
,

410 c⁄° 
pci_devi˚_id
 *
ít
)

412 
devi˚
 *
dev
 = &
pdev
->dev;

413 
±p
 *ptp;

414 
îr
;

416 
±p
 = 
	`devm_kzÆloc
(
dev
, (*±p), 
GFP_KERNEL
);

417 i‡(!
±p
) {

418 
îr
 = -
ENOMEM
;

419 
îr‹
;

422 
±p
->
pdev
 =Ödev;

424 
îr
 = 
	`pcim_íabÀ_devi˚
(
pdev
);

425 i‡(
îr
)

426 
îr‹_‰ì
;

428 
îr
 = 
	`pcim_iom≠_ªgi⁄s
(
pdev
, 1 << 
PCI_PTP_BAR_NO
, 
	`pci_«me
(pdev));

429 i‡(
îr
)

430 
îr‹_‰ì
;

432 
±p
->
ªg_ba£
 = 
	`pcim_iom≠_èbÀ
(
pdev
)[
PCI_PTP_BAR_NO
];

433 i‡(!
±p
->
ªg_ba£
) {

434 
îr
 = -
ENODEV
;

435 
îr‹_‰ì
;

438 
	`pci_£t_drvd©a
(
pdev
, 
±p
);

439 i‡(!
fú°_±p_block
)

440 
fú°_±p_block
 = 
±p
;

442 
	`•ö_lock_öô
(&
±p
->
±p_lock
);

443 i‡(
	`is_±p_tsfmt_£c_n£c
(
±p
))

444 
±p
->
ªad_±p_t°mp
 = &
ªad_±p_t°mp_£c_n£c
;

446 
±p
->
ªad_±p_t°mp
 = &
ªad_±p_t°mp_n£c
;

448 i‡(
	`˙10k_±p_îøè
(
±p
)) {

449 
	`hπimî_öô
(&
±p
->
hπimî
, 
CLOCK_MONOTONIC
, 
HRTIMER_MODE_REL
);

450 
±p
->
hπimî
.
fun˘i⁄
 = 
±p_ª£t_thªsh
;

455 
îr‹_‰ì
:

456 
	`devm_k‰ì
(
dev
, 
±p
);

458 
îr‹
:

465 
	`pci_£t_drvd©a
(
pdev
, 
	`ERR_PTR
(
îr
));

466 i‡(!
fú°_±p_block
)

467 
fú°_±p_block
 = 
	`ERR_PTR
(
îr
);

470 
	}
}

472 
	$±p_ªmove
(
pci_dev
 *
pdev
)

474 
±p
 *±∞
	`pci_gë_drvd©a
(
pdev
);

475 
u64
 
˛ock_cfg
;

477 i‡(
	`˙10k_±p_îøè
(
±p
Ë&& 
	`hπimî_a˘ive
(&±p->
hπimî
))

478 
	`hπimî_ˇn˚l
(&
±p
->
hπimî
);

480 i‡(
	`IS_ERR_OR_NULL
(
±p
))

484 
˛ock_cfg
 = 
	`ªadq
(
±p
->
ªg_ba£
 + 
PTP_CLOCK_CFG
);

485 
˛ock_cfg
 &~
PTP_CLOCK_CFG_PTP_EN
;

486 
	`wrôeq
(
˛ock_cfg
, 
±p
->
ªg_ba£
 + 
PTP_CLOCK_CFG
);

487 
	}
}

489 c⁄° 
pci_devi˚_id
 
	g±p_id_èbÀ
[] = {

490 { 
PCI_DEVICE_SUB
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_OCTEONTX2_PTP
,

491 
PCI_VENDOR_ID_CAVIUM
,

492 
PCI_SUBSYS_DEVID_OCTX2_98xx_PTP
) },

493 { 
PCI_DEVICE_SUB
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_OCTEONTX2_PTP
,

494 
PCI_VENDOR_ID_CAVIUM
,

495 
PCI_SUBSYS_DEVID_OCTX2_96XX_PTP
) },

496 { 
PCI_DEVICE_SUB
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_OCTEONTX2_PTP
,

497 
PCI_VENDOR_ID_CAVIUM
,

498 
PCI_SUBSYS_DEVID_OCTX2_95XX_PTP
) },

499 { 
PCI_DEVICE_SUB
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_OCTEONTX2_PTP
,

500 
PCI_VENDOR_ID_CAVIUM
,

501 
PCI_SUBSYS_DEVID_OCTX2_95XXN_PTP
) },

502 { 
PCI_DEVICE_SUB
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_OCTEONTX2_PTP
,

503 
PCI_VENDOR_ID_CAVIUM
,

504 
PCI_SUBSYS_DEVID_OCTX2_95MM_PTP
) },

505 { 
PCI_DEVICE_SUB
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_OCTEONTX2_PTP
,

506 
PCI_VENDOR_ID_CAVIUM
,

507 
PCI_SUBSYS_DEVID_OCTX2_95XXO_PTP
) },

508 { 
PCI_DEVICE
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_CN10K_PTP
) },

512 
pci_drivî
 
	g±p_drivî
 = {

513 .
«me
 = 
DRV_NAME
,

514 .
	gid_èbÀ
 = 
±p_id_èbÀ
,

515 .
	g¥obe
 = 
±p_¥obe
,

516 .
	gªmove
 = 
±p_ªmove
,

519 
	$rvu_mbox_h™dÀr_±p_›
(
rvu
 *rvu, 
±p_ªq
 *
ªq
,

520 
±p_r•
 *
r•
)

522 
îr
 = 0;

524 i‡(!
rvu
->
±p
)

525  -
ENODEV
;

527 
ªq
->
›
) {

528 
PTP_OP_ADJFINE
:

529 
îr
 = 
	`±p_adjföe
(
rvu
->
±p
, 
ªq
->
sˇÀd_µm
);

531 
PTP_OP_GET_CLOCK
:

532 
îr
 = 
	`±p_gë_˛ock
(
rvu
->
±p
, 
ªq
->
is_pmu
, &
r•
->
˛k
,

533 &
r•
->
tsc
);

535 
PTP_OP_GET_TSTMP
:

536 
îr
 = 
	`±p_gë_t°mp
(
rvu
->
±p
, &
r•
->
˛k
);

538 
PTP_OP_SET_THRESH
:

539 
îr
 = 
	`±p_£t_thªsh
(
rvu
->
±p
, 
ªq
->
thªsh
);

541 
PTP_OP_EXTTS_ON
:

542 
îr
 = 
	`±p_exâs_⁄
(
rvu
->
±p
, 
ªq
->
exâs_⁄
);

545 
îr
 = -
EINVAL
;

549  
îr
;

550 
	}
}

	@ptp.h

8 #i‚de‡
PTP_H


9 
	#PTP_H


	)

11 
	~<löux/timecou¡î.h
>

12 
	~<löux/time64.h
>

13 
	~<löux/•ölock.h
>

15 
	s±p
 {

16 
pci_dev
 *
	mpdev
;

17 
__iomem
 *
	mªg_ba£
;

18 
u64
 (*
ªad_±p_t°mp
)(
±p
 *
	m±p
);

19 
•ölock_t
 
	m±p_lock
;

20 
hπimî
 
	mhπimî
;

21 
ktime_t
 
	mœ°_ts
;

22 
u32
 
	m˛ock_øã
;

23 
u32
 
	m˛ock_≥riod
;

26 
±p
 *
±p_gë
();

27 
±p_put
(
±p
 *ptp);

28 
±p_°¨t
(
±p
 *±p, 
u64
 
s˛k
, 
u32
 
ext_˛k_‰eq
, u32 
exâs
);

30 
pci_drivî
 
±p_drivî
;

	@rpm.c

8 
	~"cgx.h
"

9 
	~"lmac_comm⁄.h
"

11 
mac_›s
 
	gΩm_mac_›s
 = {

12 .
«me
 = "rpm",

13 .
	gc§_off£t
 = 0x4e00,

14 .
	glmac_off£t
 = 20,

15 .
	göt_ªgi°î
 = 
RPMX_CMRX_SW_INT
,

16 .
	göt_£t_ªg
 = 
RPMX_CMRX_SW_INT_ENA_W1S
,

17 .
	gúq_off£t
 = 1,

18 .
	göt_ía_bô
 = 
BIT_ULL
(0),

19 .
	glmac_fwi
 = 
RPM_LMAC_FWI
,

20 .
	gn⁄_c⁄tiguous_£rdes_œ√
 = 
åue
,

21 .
	grx_°©s_˙t
 = 43,

22 .
	gtx_°©s_˙t
 = 34,

23 .
	gdmac_fûãr_cou¡
 = 32,

24 .
	ggë_ƒ_lmacs
 = 
Ωm_gë_ƒ_lmacs
,

25 .
	ggë_lmac_ty≥
 = 
Ωm_gë_lmac_ty≥
,

26 .
	glmac_fifo_Àn
 = 
Ωm_gë_lmac_fifo_Àn
,

27 .
	gmac_lmac_öé_lbk
 = 
Ωm_lmac_öã∫Æ_lo›back
,

28 .
	gmac_gë_rx_°©s
 = 
Ωm_gë_rx_°©s
,

29 .
	gmac_gë_tx_°©s
 = 
Ωm_gë_tx_°©s
,

30 .
	ggë_„c_°©s
 = 
Ωm_gë_„c_°©s
,

31 .
	gmac_íadis_rx_∑u£_fwdög
 = 
Ωm_lmac_íadis_rx_∑u£_fwdög
,

32 .
	gmac_gë_∑u£_‰m_°©us
 = 
Ωm_lmac_gë_∑u£_‰m_°©us
,

33 .
	gmac_íadis_∑u£_‰m
 = 
Ωm_lmac_íadis_∑u£_‰m
,

34 .
	gmac_∑u£_‰m_c⁄fig
 = 
Ωm_lmac_∑u£_‰m_c⁄fig
,

35 .
	gmac_íadis_±p_c⁄fig
 = 
Ωm_lmac_±p_c⁄fig
,

36 .
	gmac_rx_tx_íabÀ
 = 
Ωm_lmac_rx_tx_íabÀ
,

37 .
	gmac_tx_íabÀ
 = 
Ωm_lmac_tx_íabÀ
,

38 .
	gpfc_c⁄fig
 = 
Ωm_lmac_pfc_c⁄fig
,

39 .
	gmac_gë_pfc_‰m_cfg
 = 
Ωm_lmac_gë_pfc_‰m_cfg
,

40 .
	gmac_ª£t
 = 
Ωm_lmac_ª£t
,

41 .
	ggë_dmacÊt_dr›≥d_pkt˙t
 = 
Ωm_gë_dmacÊt_dr›≥d_pkt˙t
,

44 
mac_›s
 
	gΩm2_mac_›s
 = {

45 .
«me
 = "rpm",

46 .
	gc§_off£t
 = 
RPM2_CSR_OFFSET
,

47 .
	glmac_off£t
 = 20,

48 .
	göt_ªgi°î
 = 
RPM2_CMRX_SW_INT
,

49 .
	göt_£t_ªg
 = 
RPM2_CMRX_SW_INT_ENA_W1S
,

50 .
	gúq_off£t
 = 1,

51 .
	göt_ía_bô
 = 
BIT_ULL
(0),

52 .
	glmac_fwi
 = 
RPM_LMAC_FWI
,

53 .
	gn⁄_c⁄tiguous_£rdes_œ√
 = 
åue
,

54 .
	grx_°©s_˙t
 = 43,

55 .
	gtx_°©s_˙t
 = 34,

56 .
	gdmac_fûãr_cou¡
 = 64,

57 .
	ggë_ƒ_lmacs
 = 
Ωm2_gë_ƒ_lmacs
,

58 .
	ggë_lmac_ty≥
 = 
Ωm_gë_lmac_ty≥
,

59 .
	glmac_fifo_Àn
 = 
Ωm2_gë_lmac_fifo_Àn
,

60 .
	gmac_lmac_öé_lbk
 = 
Ωm_lmac_öã∫Æ_lo›back
,

61 .
	gmac_gë_rx_°©s
 = 
Ωm_gë_rx_°©s
,

62 .
	gmac_gë_tx_°©s
 = 
Ωm_gë_tx_°©s
,

63 .
	ggë_„c_°©s
 = 
Ωm_gë_„c_°©s
,

64 .
	gmac_íadis_rx_∑u£_fwdög
 = 
Ωm_lmac_íadis_rx_∑u£_fwdög
,

65 .
	gmac_gë_∑u£_‰m_°©us
 = 
Ωm_lmac_gë_∑u£_‰m_°©us
,

66 .
	gmac_íadis_∑u£_‰m
 = 
Ωm_lmac_íadis_∑u£_‰m
,

67 .
	gmac_∑u£_‰m_c⁄fig
 = 
Ωm_lmac_∑u£_‰m_c⁄fig
,

68 .
	gmac_íadis_±p_c⁄fig
 = 
Ωm_lmac_±p_c⁄fig
,

69 .
	gmac_rx_tx_íabÀ
 = 
Ωm_lmac_rx_tx_íabÀ
,

70 .
	gmac_tx_íabÀ
 = 
Ωm_lmac_tx_íabÀ
,

71 .
	gpfc_c⁄fig
 = 
Ωm_lmac_pfc_c⁄fig
,

72 .
	gmac_gë_pfc_‰m_cfg
 = 
Ωm_lmac_gë_pfc_‰m_cfg
,

73 .
	gmac_ª£t
 = 
Ωm_lmac_ª£t
,

74 .
	ggë_dmacÊt_dr›≥d_pkt˙t
 = 
Ωm_gë_dmacÊt_dr›≥d_pkt˙t
,

77 
boﬁ
 
	$is_dev_Ωm2
(*
Ωmd
)

79 
Ωm_t
 *
Ωm
 = 
Ωmd
;

81  (
Ωm
->
pdev
->
devi˚
 =
PCI_DEVID_CN10KB_RPM
);

82 
	}
}

84 
mac_›s
 *
	$Ωm_gë_mac_›s
(
Ωm_t
 *
Ωm
)

86 i‡(
	`is_dev_Ωm2
(
Ωm
))

87  &
Ωm2_mac_›s
;

89  &
Ωm_mac_›s
;

90 
	}
}

92 
	$Ωm_wrôe
(
Ωm_t
 *
Ωm
, 
u64
 
lmac
, u64 
off£t
, u64 
vÆ
)

94 
	`cgx_wrôe
(
Ωm
, 
lmac
, 
off£t
, 
vÆ
);

95 
	}
}

97 
u64
 
	$Ωm_ªad
(
Ωm_t
 *
Ωm
, 
u64
 
lmac
, u64 
off£t
)

99  
	`cgx_ªad
(
Ωm
, 
lmac
, 
off£t
);

100 
	}
}

105 
boﬁ
 
	$is_mac_Ωmusx
(*
Ωmd
)

107 
Ωm_t
 *
Ωm
 = 
Ωmd
;

109  
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_CONST1
) & 0x700ULL;

110 
	}
}

112 
	$Ωm_gë_ƒ_lmacs
(*
Ωmd
)

114 
Ωm_t
 *
Ωm
 = 
Ωmd
;

116  
	`hweight8
(
	`Ωm_ªad
(
Ωm
, 0, 
CGXX_CMRX_RX_LMACS
) & 0xFULL);

117 
	}
}

119 
	$Ωm2_gë_ƒ_lmacs
(*
Ωmd
)

121 
Ωm_t
 *
Ωm
 = 
Ωmd
;

123  
	`hweight8
(
	`Ωm_ªad
(
Ωm
, 0, 
RPM2_CMRX_RX_LMACS
) & 0xFFULL);

124 
	}
}

126 
	$Ωm_lmac_tx_íabÀ
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

128 
Ωm_t
 *
Ωm
 = 
Ωmd
;

129 
u64
 
cfg
, 
œ°
;

131 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

132  -
ENODEV
;

134 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

135 
œ°
 = 
cfg
;

136 i‡(
íabÀ
)

137 
cfg
 |
RPM_TX_EN
;

139 
cfg
 &~(
RPM_TX_EN
);

141 i‡(
cfg
 !
œ°
)

142 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

143  !!(
œ°
 & 
RPM_TX_EN
);

144 
	}
}

146 
	$Ωm_lmac_rx_tx_íabÀ
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

148 
Ωm_t
 *
Ωm
 = 
Ωmd
;

149 
u64
 
cfg
;

151 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

152  -
ENODEV
;

154 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

155 i‡(
íabÀ
)

156 
cfg
 |
RPM_RX_EN
 | 
RPM_TX_EN
;

158 
cfg
 &~(
RPM_RX_EN
 | 
RPM_TX_EN
);

159 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

161 
	}
}

163 
	$Ωm_lmac_íadis_rx_∑u£_fwdög
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

165 
Ωm_t
 *
Ωm
 = 
Ωmd
;

166 
lmac
 *lmac;

167 
u64
 
cfg
;

169 i‡(!
Ωm
)

172 
lmac
 = 
	`lmac_pd©a
(
lmac_id
, 
Ωm
);

173 i‡(!
lmac
)

177 i‡(!
	`bôm≠_weight
(
lmac
->
rx_fc_pfvf_bm≠
.
bm≠
,Ümac->rx_fc_pfvf_bm≠.
max
))

180 i‡(
íabÀ
) {

181 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

182 
cfg
 &~
RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_IGNORE
;

183 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

185 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

186 
cfg
 |
RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_IGNORE
;

187 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

189 
	}
}

191 
	$Ωm_lmac_gë_∑u£_‰m_°©us
(*
Ωmd
, 
lmac_id
,

192 
u8
 *
tx_∑u£
, u8 *
rx_∑u£
)

194 
Ωm_t
 *
Ωm
 = 
Ωmd
;

195 
u64
 
cfg
;

197 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

198  -
ENODEV
;

200 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

201 i‡(!(
cfg
 & 
RPMX_MTI_MAC100X_COMMAND_CONFIG_PFC_MODE
)) {

202 *
rx_∑u£
 = !(
cfg
 & 
RPMX_MTI_MAC100X_COMMAND_CONFIG_RX_P_DISABLE
);

203 *
tx_∑u£
 = !(
cfg
 & 
RPMX_MTI_MAC100X_COMMAND_CONFIG_TX_P_DISABLE
);

207 
	}
}

209 
	$Ωm_cfg_pfc_qu™è_thªsh
(
Ωm_t
 *
Ωm
, 
lmac_id
,

210 
pfc_í
,

211 
boﬁ
 
íabÀ
)

213 
u64
 
qu™è_off£t
 = 0, 
qu™è_thªsh
 = 0, 
cfg
;

214 
i
, 
shi·
;

217 
	`f‹_óch_£t_bô
(
i
, &
pfc_í
, 16) {

218 
i
) {

221 
qu™è_off£t
 = 
RPMX_MTI_MAC100X_CL01_PAUSE_QUANTA
;

222 
qu™è_thªsh
 = 
RPMX_MTI_MAC100X_CL01_QUANTA_THRESH
;

226 
qu™è_off£t
 = 
RPMX_MTI_MAC100X_CL23_PAUSE_QUANTA
;

227 
qu™è_thªsh
 = 
RPMX_MTI_MAC100X_CL23_QUANTA_THRESH
;

231 
qu™è_off£t
 = 
RPMX_MTI_MAC100X_CL45_PAUSE_QUANTA
;

232 
qu™è_thªsh
 = 
RPMX_MTI_MAC100X_CL45_QUANTA_THRESH
;

236 
qu™è_off£t
 = 
RPMX_MTI_MAC100X_CL67_PAUSE_QUANTA
;

237 
qu™è_thªsh
 = 
RPMX_MTI_MAC100X_CL67_QUANTA_THRESH
;

241 
qu™è_off£t
 = 
RPMX_MTI_MAC100X_CL89_PAUSE_QUANTA
;

242 
qu™è_thªsh
 = 
RPMX_MTI_MAC100X_CL89_QUANTA_THRESH
;

246 
qu™è_off£t
 = 
RPMX_MTI_MAC100X_CL1011_PAUSE_QUANTA
;

247 
qu™è_thªsh
 = 
RPMX_MTI_MAC100X_CL1011_QUANTA_THRESH
;

251 
qu™è_off£t
 = 
RPMX_MTI_MAC100X_CL1213_PAUSE_QUANTA
;

252 
qu™è_thªsh
 = 
RPMX_MTI_MAC100X_CL1213_QUANTA_THRESH
;

256 
qu™è_off£t
 = 
RPMX_MTI_MAC100X_CL1415_PAUSE_QUANTA
;

257 
qu™è_thªsh
 = 
RPMX_MTI_MAC100X_CL1415_QUANTA_THRESH
;

261 i‡(!
qu™è_off£t
 || !
qu™è_thªsh
)

264 
shi·
 = (
i
 % 2) ? 1 : 0;

265 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
qu™è_off£t
);

266 i‡(
íabÀ
) {

267 
cfg
 |((
u64
)
RPM_DEFAULT_PAUSE_TIME
 << 
shi·
 * 16);

269 i‡(!
shi·
)

270 
cfg
 &~
	`GENMASK_ULL
(15, 0);

272 
cfg
 &~
	`GENMASK_ULL
(31, 16);

274 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
qu™è_off£t
, 
cfg
);

276 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
qu™è_thªsh
);

277 i‡(
íabÀ
) {

278 
cfg
 |((
u64
)(
RPM_DEFAULT_PAUSE_TIME
 / 2Ë<< 
shi·
 * 16);

280 i‡(!
shi·
)

281 
cfg
 &~
	`GENMASK_ULL
(15, 0);

283 
cfg
 &~
	`GENMASK_ULL
(31, 16);

285 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
qu™è_thªsh
, 
cfg
);

287 
	}
}

289 
	$Ωm2_lmac_cfg_bp
(
Ωm_t
 *
Ωm
, 
lmac_id
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
)

291 
u64
 
cfg
;

293 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPM2_CMR_RX_OVR_BP
);

294 i‡(
tx_∑u£
) {

298 
	`Ωm_cfg_pfc_qu™è_thªsh
(
Ωm
, 
lmac_id
, 1, 
åue
);

299 
cfg
 &~
RPM2_CMR_RX_OVR_BP_EN
;

302 
	`Ωm_cfg_pfc_qu™è_thªsh
(
Ωm
, 
lmac_id
, 0xffff, 
Ál£
);

303 
cfg
 |
RPM2_CMR_RX_OVR_BP_EN
;

304 
cfg
 &~
RPM2_CMR_RX_OVR_BP_BP
;

306 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPM2_CMR_RX_OVR_BP
, 
cfg
);

307 
	}
}

309 
	$Ωm_lmac_cfg_bp
(
Ωm_t
 *
Ωm
, 
lmac_id
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
)

311 
u64
 
cfg
;

313 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_CMR_RX_OVR_BP
);

314 i‡(
tx_∑u£
) {

318 
	`Ωm_cfg_pfc_qu™è_thªsh
(
Ωm
, 
lmac_id
, 1, 
åue
);

319 
cfg
 &~
	`RPMX_CMR_RX_OVR_BP_EN
(
lmac_id
);

322 
	`Ωm_cfg_pfc_qu™è_thªsh
(
Ωm
, 
lmac_id
, 0xffff, 
Ál£
);

323 
cfg
 |
	`RPMX_CMR_RX_OVR_BP_EN
(
lmac_id
);

324 
cfg
 &~
	`RPMX_CMR_RX_OVR_BP_BP
(
lmac_id
);

326 
	`Ωm_wrôe
(
Ωm
, 0, 
RPMX_CMR_RX_OVR_BP
, 
cfg
);

327 
	}
}

329 
	$Ωm_lmac_íadis_∑u£_‰m
(*
Ωmd
, 
lmac_id
, 
u8
 
tx_∑u£
,

330 
u8
 
rx_∑u£
)

332 
Ωm_t
 *
Ωm
 = 
Ωmd
;

333 
u64
 
cfg
;

335 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

336  -
ENODEV
;

338 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

339 
cfg
 &~
RPMX_MTI_MAC100X_COMMAND_CONFIG_RX_P_DISABLE
;

340 
cfg
 |
rx_∑u£
 ? 0x0 : 
RPMX_MTI_MAC100X_COMMAND_CONFIG_RX_P_DISABLE
;

341 
cfg
 &~
RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_IGNORE
;

342 
cfg
 |
rx_∑u£
 ? 0x0 : 
RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_IGNORE
;

343 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

345 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

346 
cfg
 &~
RPMX_MTI_MAC100X_COMMAND_CONFIG_TX_P_DISABLE
;

347 
cfg
 |
tx_∑u£
 ? 0x0 : 
RPMX_MTI_MAC100X_COMMAND_CONFIG_TX_P_DISABLE
;

348 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

350 i‡(
	`is_dev_Ωm2
(
Ωm
))

351 
	`Ωm2_lmac_cfg_bp
(
Ωm
, 
lmac_id
, 
tx_∑u£
, 
rx_∑u£
);

353 
	`Ωm_lmac_cfg_bp
(
Ωm
, 
lmac_id
, 
tx_∑u£
, 
rx_∑u£
);

356 
	}
}

358 
	$Ωm_lmac_∑u£_‰m_c⁄fig
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

360 
Ωm_t
 *
Ωm
 = 
Ωmd
;

361 
u64
 
cfg
;

364 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

365 
cfg
 |
RPMX_MTI_MAC100X_COMMAND_CONFIG_RX_P_DISABLE
;

366 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

369 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

370 
cfg
 |
RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_IGNORE
;

371 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

374 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

375 
cfg
 |
RPMX_MTI_MAC100X_COMMAND_CONFIG_TX_P_DISABLE
;

376 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

379 i‡(
	`is_dev_Ωm2
(
Ωm
))

380 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPM2_CMR_CHAN_MSK_OR
, 0xffff);

382 
	`Ωm_wrôe
(
Ωm
, 0, 
RPMX_CMR_CHAN_MSK_OR
, ~0ULL);

385 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_CMRX_PRT_CBFC_CTL
);

386 
cfg
 = 
	`FIELD_SET
(
RPM_PFC_CLASS_MASK
, 0, cfg);

387 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_CMRX_PRT_CBFC_CTL
, 
cfg
);

388 
	}
}

390 
	$Ωm_gë_rx_°©s
(*
Ωmd
, 
lmac_id
, 
idx
, 
u64
 *
rx_°©
)

392 
Ωm_t
 *
Ωm
 = 
Ωmd
;

393 
u64
 
vÆ_lo
, 
vÆ_hi
;

395 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

396  -
ENODEV
;

398 
	`muãx_lock
(&
Ωm
->
lock
);

401 
idx
 +
lmac_id
 * 
Ωm
->
mac_›s
->
rx_°©s_˙t
;

404 
vÆ_lo
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_MTI_STAT_RX_STAT_PAGES_COUNTERX
 +

405 (
idx
 * 8));

410 
vÆ_hi
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_MTI_STAT_DATA_HI_CDC
);

412 *
rx_°©
 = (
vÆ_hi
 << 32 | 
vÆ_lo
);

414 
	`muãx_u∆ock
(&
Ωm
->
lock
);

416 
	}
}

418 
	$Ωm_gë_tx_°©s
(*
Ωmd
, 
lmac_id
, 
idx
, 
u64
 *
tx_°©
)

420 
Ωm_t
 *
Ωm
 = 
Ωmd
;

421 
u64
 
vÆ_lo
, 
vÆ_hi
;

423 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

424  -
ENODEV
;

426 
	`muãx_lock
(&
Ωm
->
lock
);

429 
idx
 +
lmac_id
 * 
Ωm
->
mac_›s
->
tx_°©s_˙t
;

431 
vÆ_lo
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_MTI_STAT_TX_STAT_PAGES_COUNTERX
 +

432 (
idx
 * 8));

433 
vÆ_hi
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_MTI_STAT_DATA_HI_CDC
);

435 *
tx_°©
 = (
vÆ_hi
 << 32 | 
vÆ_lo
);

437 
	`muãx_u∆ock
(&
Ωm
->
lock
);

439 
	}
}

441 
	$Ωm_gë_„c_°©s
(*
Ωmd
, 
lmac_id
, 
cgx_„c_°©s_r•
 *
r•
)

443 
u64
 
vÆ_lo
, 
vÆ_hi
;

444 
Ωm_t
 *
Ωm
 = 
Ωmd
;

445 
u64
 
cfg
;

447 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

448  -
ENODEV
;

450 i‡(
Ωm
->
lmac_idm≠
[
lmac_id
]->
lök_öfo
.
„c
 =
OTX2_FEC_NONE
)

453 i‡(
Ωm
->
lmac_idm≠
[
lmac_id
]->
lök_öfo
.
„c
 =
OTX2_FEC_BASER
) {

454 
vÆ_lo
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_FCFECX_VL0_CCW_LO
);

455 
vÆ_hi
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_FCFECX_CW_HI
);

456 
r•
->
„c_c‹r_blks
 = (
vÆ_hi
 << 32 | 
vÆ_lo
);

458 
vÆ_lo
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_FCFECX_VL0_NCCW_LO
);

459 
vÆ_hi
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_FCFECX_CW_HI
);

460 
r•
->
„c_unc‹r_blks
 = (
vÆ_hi
 << 32 | 
vÆ_lo
);

463 i‡(
Ωm
->
lmac_idm≠
[
lmac_id
]->
lök_öfo
.
lmac_ty≥_id
 =
LMAC_MODE_50G_R
) {

464 
vÆ_lo
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_FCFECX_VL1_CCW_LO
);

465 
vÆ_hi
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_FCFECX_CW_HI
);

466 
r•
->
„c_c‹r_blks
 +(
vÆ_hi
 << 32 | 
vÆ_lo
);

468 
vÆ_lo
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_FCFECX_VL1_NCCW_LO
);

469 
vÆ_hi
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_FCFECX_CW_HI
);

470 
r•
->
„c_unc‹r_blks
 +(
vÆ_hi
 << 32 | 
vÆ_lo
);

474 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_MTI_STAT_STATN_CONTROL
);

475 
cfg
 |
RPMX_RSFEC_RX_CAPTURE
 | 
	`BIT
(
lmac_id
);

476 
	`Ωm_wrôe
(
Ωm
, 0, 
RPMX_MTI_STAT_STATN_CONTROL
, 
cfg
);

478 
vÆ_lo
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_MTI_RSFEC_STAT_COUNTER_CAPTURE_2
);

479 
vÆ_hi
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_MTI_STAT_DATA_HI_CDC
);

480 
r•
->
„c_c‹r_blks
 = (
vÆ_hi
 << 32 | 
vÆ_lo
);

482 
vÆ_lo
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_MTI_RSFEC_STAT_COUNTER_CAPTURE_3
);

483 
vÆ_hi
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPMX_MTI_STAT_DATA_HI_CDC
);

484 
r•
->
„c_unc‹r_blks
 = (
vÆ_hi
 << 32 | 
vÆ_lo
);

488 
	}
}

490 
u64
 
	$Ωm_gë_dmacÊt_dr›≥d_pkt˙t
(*
Ωmd
, 
lmac_id
)

492 
Ωm_t
 *
Ωm
 = 
Ωmd
;

493 
u64
 
dmac_Êt_°©
;

495 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

498 
dmac_Êt_°©
 = 
	`is_dev_Ωm2
(
Ωm
Ë? 
RPM2_CMRX_RX_STAT2
 :

499 
RPMX_CMRX_RX_STAT2
;

501  
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
dmac_Êt_°©
);

502 
	}
}

504 
u8
 
	$Ωm_gë_lmac_ty≥
(*
Ωmd
, 
lmac_id
)

506 
Ωm_t
 *
Ωm
 = 
Ωmd
;

507 
u64
 
ªq
 = 0, 
ª•
;

508 
îr
;

510 
ªq
 = 
	`FIELD_SET
(
CMDREG_ID
, 
CGX_CMD_GET_LINK_STS
,Ñeq);

511 
îr
 = 
	`cgx_fwi_cmd_gíîic
(
ªq
, &
ª•
, 
Ωm
, 0);

512 i‡(!
îr
)

513  
	`FIELD_GET
(
RESP_LINKSTAT_LMAC_TYPE
, 
ª•
);

514  
îr
;

515 
	}
}

517 
u32
 
	$Ωm_gë_lmac_fifo_Àn
(*
Ωmd
, 
lmac_id
)

519 
Ωm_t
 *
Ωm
 = 
Ωmd
;

520 
u64
 
hi_≥rf_lmac
;

521 
u8
 
num_lmacs
;

522 
u32
 
fifo_Àn
;

524 
fifo_Àn
 = 
Ωm
->
mac_›s
->fifo_len;

525 
num_lmacs
 = 
Ωm
->
mac_›s
->
	`gë_ƒ_lmacs
(rpm);

527 
num_lmacs
) {

529  
fifo_Àn
;

531  
fifo_Àn
 / 2;

534 
hi_≥rf_lmac
 = 
	`Ωm_ªad
(
Ωm
, 0, 
CGXX_CMRX_RX_LMACS
);

535 
hi_≥rf_lmac
 = (hi_perf_lmac >> 4) & 0x3ULL;

536 i‡(
lmac_id
 =
hi_≥rf_lmac
)

537  
fifo_Àn
 / 2;

538  
fifo_Àn
 / 4;

541  
fifo_Àn
 / 4;

544 
	}
}

546 
	$Ωmusx_lmac_öã∫Æ_lo›back
(
Ωm_t
 *
Ωm
, 
lmac_id
, 
boﬁ
 
íabÀ
)

548 
u64
 
cfg
;

550 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPM2_USX_PCSX_CONTROL1
);

552 i‡(
íabÀ
)

553 
cfg
 |
RPM2_USX_PCS_LBK
;

555 
cfg
 &~
RPM2_USX_PCS_LBK
;

556 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPM2_USX_PCSX_CONTROL1
, 
cfg
);

559 
	}
}

561 
u32
 
	$Ωm2_gë_lmac_fifo_Àn
(*
Ωmd
, 
lmac_id
)

563 
u64
 
hi_≥rf_lmac
, 
lmac_öfo
;

564 
Ωm_t
 *
Ωm
 = 
Ωmd
;

565 
u8
 
num_lmacs
;

566 
u32
 
fifo_Àn
;

568 
lmac_öfo
 = 
	`Ωm_ªad
(
Ωm
, 0, 
RPM2_CMRX_RX_LMACS
);

574 
fifo_Àn
 = 
Ωm
->
mac_›s
->fifo_len / 2;

576 i‡(
lmac_id
 < 4) {

577 
num_lmacs
 = 
	`hweight8
(
lmac_öfo
 & 0xF);

578 
hi_≥rf_lmac
 = (
lmac_öfo
 >> 8) & 0x3ULL;

580 
num_lmacs
 = 
	`hweight8
(
lmac_öfo
 & 0xF0);

581 
hi_≥rf_lmac
 = (
lmac_öfo
 >> 10) & 0x3ULL;

582 
hi_≥rf_lmac
 += 4;

585 
num_lmacs
) {

587  
fifo_Àn
;

589  
fifo_Àn
 / 2;

594 i‡(
lmac_id
 =
hi_≥rf_lmac
)

595  
fifo_Àn
 / 2;

596  
fifo_Àn
 / 4;

599  
fifo_Àn
 / 4;

602 
	}
}

604 
	$Ωm_lmac_öã∫Æ_lo›back
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

606 
Ωm_t
 *
Ωm
 = 
Ωmd
;

607 
u8
 
lmac_ty≥
;

608 
u64
 
cfg
;

610 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

611  -
ENODEV
;

612 
lmac_ty≥
 = 
Ωm
->
mac_›s
->
	`gë_lmac_ty≥
‘pm, 
lmac_id
);

614 i‡(
lmac_ty≥
 =
LMAC_MODE_QSGMII
 ||Ümac_ty≥ =
LMAC_MODE_SGMII
) {

615 
	`dev_îr
(&
Ωm
->
pdev
->
dev
, "loopbackÇot supported for LPC mode\n");

619 i‡(
	`is_dev_Ωm2
(
Ωm
Ë&& 
	`is_mac_Ωmusx
(rpm))

620  
	`Ωmusx_lmac_öã∫Æ_lo›back
(
Ωm
, 
lmac_id
, 
íabÀ
);

622 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_PCS100X_CONTROL1
);

624 i‡(
íabÀ
)

625 
cfg
 |
RPMX_MTI_PCS_LBK
;

627 
cfg
 &~
RPMX_MTI_PCS_LBK
;

628 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_PCS100X_CONTROL1
, 
cfg
);

631 
	}
}

633 
	$Ωm_lmac_±p_c⁄fig
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

635 
Ωm_t
 *
Ωm
 = 
Ωmd
;

636 
u64
 
cfg
;

638 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

641 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_CMRX_CFG
);

642 i‡(
íabÀ
) {

643 
cfg
 |
RPMX_RX_TS_PREPEND
;

644 
cfg
 |
RPMX_TX_PTP_1S_SUPPORT
;

646 
cfg
 &~
RPMX_RX_TS_PREPEND
;

647 
cfg
 &~
RPMX_TX_PTP_1S_SUPPORT
;

650 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_CMRX_CFG
, 
cfg
);

652 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_XIF_MODE
);

654 i‡(
íabÀ
) {

655 
cfg
 |
RPMX_ONESTEP_ENABLE
;

656 
cfg
 &~
RPMX_TS_BINARY_MODE
;

658 
cfg
 &~
RPMX_ONESTEP_ENABLE
;

661 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_XIF_MODE
, 
cfg
);

662 
	}
}

664 
	$Ωm_lmac_pfc_c⁄fig
(*
Ωmd
, 
lmac_id
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
, 
u16
 
pfc_í
)

666 
u64
 
cfg
, 
˛ass_í
, 
pfc_˛ass_mask_cfg
;

667 
Ωm_t
 *
Ωm
 = 
Ωmd
;

669 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

670  -
ENODEV
;

672 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

673 
˛ass_í
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_CMRX_PRT_CBFC_CTL
);

674 
pfc_í
 |
	`FIELD_GET
(
RPM_PFC_CLASS_MASK
, 
˛ass_í
);

676 i‡(
rx_∑u£
) {

677 
cfg
 &~(
RPMX_MTI_MAC100X_COMMAND_CONFIG_RX_P_DISABLE
 |

678 
RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_IGNORE
 |

679 
RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_FWD
);

681 
cfg
 |(
RPMX_MTI_MAC100X_COMMAND_CONFIG_RX_P_DISABLE
 |

682 
RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_IGNORE
 |

683 
RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_FWD
);

686 i‡(
tx_∑u£
) {

687 
	`Ωm_cfg_pfc_qu™è_thªsh
(
Ωm
, 
lmac_id
, 
pfc_í
, 
åue
);

688 
cfg
 &~
RPMX_MTI_MAC100X_COMMAND_CONFIG_TX_P_DISABLE
;

689 
˛ass_í
 = 
	`FIELD_SET
(
RPM_PFC_CLASS_MASK
, 
pfc_í
, class_en);

691 
	`Ωm_cfg_pfc_qu™è_thªsh
(
Ωm
, 
lmac_id
, 0xfff, 
Ál£
);

692 
cfg
 |
RPMX_MTI_MAC100X_COMMAND_CONFIG_TX_P_DISABLE
;

693 
˛ass_í
 = 
	`FIELD_SET
(
RPM_PFC_CLASS_MASK
, 0, class_en);

696 i‡(!
rx_∑u£
 && !
tx_∑u£
)

697 
cfg
 &~
RPMX_MTI_MAC100X_COMMAND_CONFIG_PFC_MODE
;

699 
cfg
 |
RPMX_MTI_MAC100X_COMMAND_CONFIG_PFC_MODE
;

701 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
, 
cfg
);

703 
pfc_˛ass_mask_cfg
 = 
	`is_dev_Ωm2
(
Ωm
Ë? 
RPM2_CMRX_PRT_CBFC_CTL
 :

704 
RPMX_CMRX_PRT_CBFC_CTL
;

706 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
pfc_˛ass_mask_cfg
, 
˛ass_í
);

709 
	}
}

711 
	$Ωm_lmac_gë_pfc_‰m_cfg
(*
Ωmd
, 
lmac_id
, 
u8
 *
tx_∑u£
, u8 *
rx_∑u£
)

713 
Ωm_t
 *
Ωm
 = 
Ωmd
;

714 
u64
 
cfg
;

716 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

717  -
ENODEV
;

719 
cfg
 = 
	`Ωm_ªad
(
Ωm
, 
lmac_id
, 
RPMX_MTI_MAC100X_COMMAND_CONFIG
);

720 i‡(
cfg
 & 
RPMX_MTI_MAC100X_COMMAND_CONFIG_PFC_MODE
) {

721 *
rx_∑u£
 = !(
cfg
 & 
RPMX_MTI_MAC100X_COMMAND_CONFIG_RX_P_DISABLE
);

722 *
tx_∑u£
 = !(
cfg
 & 
RPMX_MTI_MAC100X_COMMAND_CONFIG_TX_P_DISABLE
);

726 
	}
}

728 
	$Ωm_lmac_ª£t
(*
Ωmd
, 
lmac_id
)

730 
u64
 
rx_logl_x⁄
, 
cfg
;

731 
Ωm_t
 *
Ωm
 = 
Ωmd
;

733 i‡(!
	`is_lmac_vÆid
(
Ωm
, 
lmac_id
))

734  -
ENODEV
;

737 
rx_logl_x⁄
 = 
	`is_dev_Ωm2
(
Ωm
Ë? 
RPM2_CMRX_RX_LOGL_XON
 :

738 
RPMX_CMRX_RX_LOGL_XON
;

739 
cfg
 = 0xff;

741 
	`Ωm_wrôe
(
Ωm
, 
lmac_id
, 
rx_logl_x⁄
, 
cfg
);

744 
	}
}

	@rpm.h

8 #i‚de‡
RPM_H


9 
	#RPM_H


	)

11 
	~<löux/bôs.h
>

14 
	#PCI_DEVID_CN10K_RPM
 0xA060

	)

15 
	#PCI_SUBSYS_DEVID_CNF10KB_RPM
 0xBC00

	)

16 
	#PCI_DEVID_CN10KB_RPM
 0xA09F

	)

19 
	#RPMX_CMRX_CFG
 0x00

	)

20 
	#RPMX_RX_TS_PREPEND
 
	`BIT_ULL
(22)

	)

21 
	#RPMX_TX_PTP_1S_SUPPORT
 
	`BIT_ULL
(17)

	)

22 
	#RPMX_CMRX_RX_ID_MAP
 0x80

	)

23 
	#RPMX_CMRX_SW_INT
 0x180

	)

24 
	#RPMX_CMRX_SW_INT_W1S
 0x188

	)

25 
	#RPMX_CMRX_SW_INT_ENA_W1S
 0x198

	)

26 
	#RPMX_CMRX_LINK_CFG
 0x1070

	)

27 
	#RPMX_MTI_PCS100X_CONTROL1
 0x20000

	)

28 
	#RPMX_MTI_LPCSX_CONTROL
(
id
Ë(0x30000 | ((idË* 0x100))

	)

29 
	#RPMX_MTI_PCS_LBK
 
	`BIT_ULL
(14)

	)

31 
	#RPMX_CMRX_LINK_RANGE_MASK
 
	`GENMASK_ULL
(19, 16)

	)

32 
	#RPMX_CMRX_LINK_BASE_MASK
 
	`GENMASK_ULL
(11, 0)

	)

34 
	#RPMX_MTI_MAC100X_COMMAND_CONFIG
 0x8010

	)

35 
	#RPMX_MTI_MAC100X_COMMAND_CONFIG_RX_P_DISABLE
 
	`BIT_ULL
(29)

	)

36 
	#RPMX_MTI_MAC100X_COMMAND_CONFIG_TX_P_DISABLE
 
	`BIT_ULL
(28)

	)

37 
	#RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_IGNORE
 
	`BIT_ULL
(8)

	)

38 
	#RPMX_MTI_MAC100X_COMMAND_CONFIG_PFC_MODE
 
	`BIT_ULL
(19)

	)

39 
	#RPMX_MTI_MAC100X_CL01_PAUSE_QUANTA
 0x80A8

	)

40 
	#RPMX_MTI_MAC100X_CL23_PAUSE_QUANTA
 0x80B0

	)

41 
	#RPMX_MTI_MAC100X_CL45_PAUSE_QUANTA
 0x80B8

	)

42 
	#RPMX_MTI_MAC100X_CL67_PAUSE_QUANTA
 0x80C0

	)

43 
	#RPMX_MTI_MAC100X_CL01_QUANTA_THRESH
 0x80C8

	)

44 
	#RPMX_MTI_MAC100X_CL23_QUANTA_THRESH
 0x80D0

	)

45 
	#RPMX_MTI_MAC100X_CL45_QUANTA_THRESH
 0x80D8

	)

46 
	#RPMX_MTI_MAC100X_CL67_QUANTA_THRESH
 0x80E0

	)

47 
	#RPMX_MTI_MAC100X_CL89_PAUSE_QUANTA
 0x8108

	)

48 
	#RPMX_MTI_MAC100X_CL1011_PAUSE_QUANTA
 0x8110

	)

49 
	#RPMX_MTI_MAC100X_CL1213_PAUSE_QUANTA
 0x8118

	)

50 
	#RPMX_MTI_MAC100X_CL1415_PAUSE_QUANTA
 0x8120

	)

51 
	#RPMX_MTI_MAC100X_CL89_QUANTA_THRESH
 0x8128

	)

52 
	#RPMX_MTI_MAC100X_CL1011_QUANTA_THRESH
 0x8130

	)

53 
	#RPMX_MTI_MAC100X_CL1213_QUANTA_THRESH
 0x8138

	)

54 
	#RPMX_MTI_MAC100X_CL1415_QUANTA_THRESH
 0x8140

	)

55 
	#RPMX_CMRX_RX_LOGL_XON
 0x4100

	)

56 
	#RPMX_CMR_RX_OVR_BP
 0x4120

	)

57 
	#RPMX_CMR_RX_OVR_BP_EN
(
x
Ë
	`BIT_ULL
((xË+ 8)

	)

58 
	#RPMX_CMR_RX_OVR_BP_BP
(
x
Ë
	`BIT_ULL
((xË+ 4)

	)

59 
	#RPMX_CMR_CHAN_MSK_OR
 0x4118

	)

60 
	#RPMX_MTI_STAT_RX_STAT_PAGES_COUNTERX
 0x12000

	)

61 
	#RPMX_MTI_STAT_TX_STAT_PAGES_COUNTERX
 0x13000

	)

62 
	#RPMX_MTI_STAT_DATA_HI_CDC
 0x10038

	)

63 
	#RPMX_CMRX_RX_STAT2
 0x4010

	)

64 
	#RPM_LMAC_FWI
 0xa

	)

65 
	#RPM_TX_EN
 
	`BIT_ULL
(0)

	)

66 
	#RPM_RX_EN
 
	`BIT_ULL
(1)

	)

67 
	#RPMX_CMRX_PRT_CBFC_CTL
 0x5B08

	)

68 
	#RPMX_CMRX_PRT_CBFC_CTL_LOGL_EN_RX_SHIFT
 33

	)

69 
	#RPMX_CMRX_PRT_CBFC_CTL_PHYS_BP_SHIFT
 16

	)

70 
	#RPMX_CMRX_PRT_CBFC_CTL_LOGL_EN_TX_SHIFT
 0

	)

71 
	#RPM_PFC_CLASS_MASK
 
	`GENMASK_ULL
(48, 33)

	)

72 
	#RPMX_MTI_MAC100X_CL89_QUANTA_THRESH
 0x8128

	)

73 
	#RPMX_MTI_MAC100X_COMMAND_CONFIG_TX_PAD_EN
 
	`BIT_ULL
(11)

	)

74 
	#RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_IGNORE
 
	`BIT_ULL
(8)

	)

75 
	#RPMX_MTI_MAC100X_COMMAND_CONFIG_PAUSE_FWD
 
	`BIT_ULL
(7)

	)

76 
	#RPMX_MTI_MAC100X_CL01_PAUSE_QUANTA
 0x80A8

	)

77 
	#RPMX_MTI_MAC100X_CL89_PAUSE_QUANTA
 0x8108

	)

78 
	#RPM_DEFAULT_PAUSE_TIME
 0x7FF

	)

80 
	#RPMX_MTI_MAC100X_XIF_MODE
 0x8100

	)

81 
	#RPMX_ONESTEP_ENABLE
 
	`BIT_ULL
(5)

	)

82 
	#RPMX_TS_BINARY_MODE
 
	`BIT_ULL
(11)

	)

83 
	#RPMX_CONST1
 0x2008

	)

86 
	#RPMX_MTI_STAT_STATN_CONTROL
 0x10018

	)

87 
	#RPMX_MTI_STAT_DATA_HI_CDC
 0x10038

	)

88 
	#RPMX_RSFEC_RX_CAPTURE
 
	`BIT_ULL
(27)

	)

89 
	#RPMX_MTI_RSFEC_STAT_COUNTER_CAPTURE_2
 0x40050

	)

90 
	#RPMX_MTI_RSFEC_STAT_COUNTER_CAPTURE_3
 0x40058

	)

91 
	#RPMX_MTI_FCFECX_VL0_CCW_LO
 0x38618

	)

92 
	#RPMX_MTI_FCFECX_VL0_NCCW_LO
 0x38620

	)

93 
	#RPMX_MTI_FCFECX_VL1_CCW_LO
 0x38628

	)

94 
	#RPMX_MTI_FCFECX_VL1_NCCW_LO
 0x38630

	)

95 
	#RPMX_MTI_FCFECX_CW_HI
 0x38638

	)

98 
	#RPM2_CMRX_SW_INT
 0x1b0

	)

99 
	#RPM2_CMRX_SW_INT_ENA_W1S
 0x1b8

	)

100 
	#RPM2_CMR_CHAN_MSK_OR
 0x3120

	)

101 
	#RPM2_CMR_RX_OVR_BP_EN
 
	`BIT_ULL
(2)

	)

102 
	#RPM2_CMR_RX_OVR_BP_BP
 
	`BIT_ULL
(1)

	)

103 
	#RPM2_CMR_RX_OVR_BP
 0x3130

	)

104 
	#RPM2_CSR_OFFSET
 0x3e00

	)

105 
	#RPM2_CMRX_PRT_CBFC_CTL
 0x6510

	)

106 
	#RPM2_CMRX_RX_LMACS
 0x100

	)

107 
	#RPM2_CMRX_RX_LOGL_XON
 0x3100

	)

108 
	#RPM2_CMRX_RX_STAT2
 0x3010

	)

109 
	#RPM2_USX_PCSX_CONTROL1
 0x80000

	)

110 
	#RPM2_USX_PCS_LBK
 
	`BIT_ULL
(14)

	)

113 
Ωm_gë_ƒ_lmacs
(*
Ωmd
);

114 
u8
 
Ωm_gë_lmac_ty≥
(*
Ωmd
, 
lmac_id
);

115 
u32
 
Ωm_gë_lmac_fifo_Àn
(*
Ωmd
, 
lmac_id
);

116 
u32
 
Ωm2_gë_lmac_fifo_Àn
(*
Ωmd
, 
lmac_id
);

117 
Ωm_lmac_öã∫Æ_lo›back
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

118 
Ωm_lmac_íadis_rx_∑u£_fwdög
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

119 
Ωm_lmac_gë_∑u£_‰m_°©us
(*
cgxd
, 
lmac_id
, 
u8
 *
tx_∑u£
,

120 
u8
 *
rx_∑u£
);

121 
Ωm_lmac_∑u£_‰m_c⁄fig
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

122 
Ωm_lmac_íadis_∑u£_‰m
(*
Ωmd
, 
lmac_id
, 
u8
 
tx_∑u£
,

123 
u8
 
rx_∑u£
);

124 
Ωm_gë_tx_°©s
(*
Ωmd
, 
lmac_id
, 
idx
, 
u64
 *
tx_°©
);

125 
Ωm_gë_rx_°©s
(*
Ωmd
, 
lmac_id
, 
idx
, 
u64
 *
rx_°©
);

126 
Ωm_gë_„c_°©s
(*
cgxd
, 
lmac_id
, 
cgx_„c_°©s_r•
 *
r•
);

127 
u64
 
Ωm_gë_dmacÊt_dr›≥d_pkt˙t
(*
Ωmd
, 
lmac_id
);

128 
Ωm_lmac_±p_c⁄fig
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

129 
Ωm_lmac_rx_tx_íabÀ
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

130 
Ωm_lmac_tx_íabÀ
(*
Ωmd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

131 
Ωm_lmac_pfc_c⁄fig
(*
Ωmd
, 
lmac_id
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
,

132 
u16
 
pfc_í
);

133 
Ωm_lmac_gë_pfc_‰m_cfg
(*
Ωmd
, 
lmac_id
, 
u8
 *
tx_∑u£
,

134 
u8
 *
rx_∑u£
);

135 
Ωm_lmac_ª£t
(*
Ωmd
, 
lmac_id
);

136 
Ωm2_gë_ƒ_lmacs
(*
Ωmd
);

137 
boﬁ
 
is_dev_Ωm2
(*
Ωmd
);

	@rvu.c

8 
	~<löux/moduÀ.h
>

9 
	~<löux/öãºu±.h
>

10 
	~<löux/dñay.h
>

11 
	~<löux/úq.h
>

12 
	~<löux/pci.h
>

13 
	~<löux/sysfs.h
>

14 
	~<löux/jiffõs.h
>

16 
	~"cgx.h
"

17 
	~"rvu.h
"

18 
	~"rvu_ªg.h
"

19 
	~"±p.h
"

20 
	~"mcs.h
"

22 
	~"rvu_åa˚.h
"

23 
	~"rvu_≈c_hash.h
"

25 
	#DRV_NAME
 "rvu_af"

	)

26 
	#DRV_STRING
 "M¨vñ»RVU Admö Fun˘i⁄ Drivî"

	)

28 
rvu_£t_msix_off£t
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
,

29 
rvu_block
 *
block
, 
lf
);

30 
rvu_˛ór_msix_off£t
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
,

31 
rvu_block
 *
block
, 
lf
);

32 
__rvu_Êr_h™dÀr
(
rvu
 *rvu, 
u16
 
pcifunc
);

34 
rvu_mbox_öô
(
rvu
 *rvu, 
mbox_wq_öfo
 *
mw
,

35 
ty≥
, 
num
,

36 (
mbox_h™dÀr
)(
w‹k_°ru˘
 *),

37 (
mbox_up_h™dÀr
)(
w‹k_°ru˘
 *));

39 
TYPE_AFVF
,

40 
TYPE_AFPF
,

44 c⁄° 
pci_devi˚_id
 
rvu_id_èbÀ
[] = {

45 { 
	`PCI_DEVICE
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_OCTEONTX2_RVU_AF
) },

47 
	}
};

49 
MODULE_AUTHOR
("Marvell.");

50 
MODULE_DESCRIPTION
(
DRV_STRING
);

51 
MODULE_LICENSE
("GPL v2");

52 
MODULE_DEVICE_TABLE
(
pci
, 
rvu_id_èbÀ
);

54 *
	gmkex_¥ofûe
;

55 
moduÀ_∑øm
(
mkex_¥ofûe
, 
ch¨p
, 0000);

56 
MODULE_PARM_DESC
(
mkex_¥ofûe
, "MKEXÖrofileÇame string");

58 *
	gkpu_¥ofûe
;

59 
moduÀ_∑øm
(
kpu_¥ofûe
, 
ch¨p
, 0000);

60 
MODULE_PARM_DESC
(
kpu_¥ofûe
, "KPUÖrofileÇame string");

62 
	$rvu_£tup_hw_ˇ∑bûôõs
(
rvu
 *rvu)

64 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

66 
hw
->
ˇp
.
nix_tx_aggr_lvl
 = 
NIX_TXSCH_LVL_TL1
;

67 
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
 = 
Ál£
;

68 
hw
->
ˇp
.
nix_sh≠ög
 = 
åue
;

69 
hw
->
ˇp
.
nix_tx_lök_bp
 = 
åue
;

70 
hw
->
ˇp
.
nix_rx_mu…iˇ°
 = 
åue
;

71 
hw
->
ˇp
.
nix_sh≠î_toggÀ_waô
 = 
Ál£
;

72 
hw
->
ˇp
.
≈c_hash_exåa˘
 = 
Ál£
;

73 
hw
->
ˇp
.
≈c_exa˘_m©ch_íabÀd
 = 
Ál£
;

74 
hw
->
rvu
 =Ñvu;

76 i‡(
	`is_rvu_¥e_96xx_C0
(
rvu
)) {

77 
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
 = 
åue
;

78 
hw
->
ˇp
.
nix_txsch_≥r_cgx_lmac
 = 4;

79 
hw
->
ˇp
.
nix_txsch_≥r_lbk_lmac
 = 132;

80 
hw
->
ˇp
.
nix_txsch_≥r_sdp_lmac
 = 76;

81 
hw
->
ˇp
.
nix_sh≠ög
 = 
Ál£
;

82 
hw
->
ˇp
.
nix_tx_lök_bp
 = 
Ál£
;

83 i‡(
	`is_rvu_96xx_A0
(
rvu
Ë|| 
	`is_rvu_95xx_A0
(rvu))

84 
hw
->
ˇp
.
nix_rx_mu…iˇ°
 = 
Ál£
;

86 i‡(!
	`is_rvu_¥e_96xx_C0
(
rvu
))

87 
hw
->
ˇp
.
nix_sh≠î_toggÀ_waô
 = 
åue
;

89 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

90 
hw
->
ˇp
.
≥r_pf_mbox_ªgs
 = 
åue
;

92 i‡(
	`is_rvu_≈c_hash_exåa˘_í
(
rvu
))

93 
hw
->
ˇp
.
≈c_hash_exåa˘
 = 
åue
;

95 i‡(
	`is_rvu_nix_•i_to_ß_í
(
rvu
))

96 
hw
->
ˇp
.
•i_to_ßs
 = 0x2000;

97 
	}
}

102 
	$rvu_pﬁl_ªg
(
rvu
 *rvu, 
u64
 
block
, u64 
off£t
, u64 
mask
, 
boﬁ
 
zîo
)

104 
timeout
 = 
jiffõs
 + 
	`u£cs_to_jiffõs
(20000);

105 
boﬁ
 
twi˚
 = 
Ál£
;

106 
__iomem
 *
ªg
;

107 
u64
 
ªg_vÆ
;

109 
ªg
 = 
rvu
->
a‰eg_ba£
 + ((
block
 << 28Ë| 
off£t
);

110 
agaö
:

111 
ªg_vÆ
 = 
	`ªadq
(
ªg
);

112 i‡(
zîo
 && !(
ªg_vÆ
 & 
mask
))

114 i‡(!
zîo
 && (
ªg_vÆ
 & 
mask
))

116 i‡(
	`time_bef‹e
(
jiffõs
, 
timeout
)) {

117 
	`u¶ìp_ønge
(1, 5);

118 
agaö
;

125 i‡(!
twi˚
) {

126 
twi˚
 = 
åue
;

127 
agaö
;

129  -
EBUSY
;

130 
	}
}

132 
	$rvu_Æloc_r§c
(
r§c_bm≠
 *
r§c
)

134 
id
;

136 i‡(!
r§c
->
bm≠
)

137  -
EINVAL
;

139 
id
 = 
	`föd_fú°_zîo_bô
(
r§c
->
bm≠
,Ñ§c->
max
);

140 i‡(
id
 >
r§c
->
max
)

141  -
ENOSPC
;

143 
	`__£t_bô
(
id
, 
r§c
->
bm≠
);

145  
id
;

146 
	}
}

148 
	$rvu_Æloc_r§c_c⁄tig
(
r§c_bm≠
 *
r§c
, 
ƒ§c
)

150 
°¨t
;

152 i‡(!
r§c
->
bm≠
)

153  -
EINVAL
;

155 
°¨t
 = 
	`bôm≠_föd_√xt_zîo_¨ó
(
r§c
->
bm≠
,Ñ§c->
max
, 0, 
ƒ§c
, 0);

156 i‡(
°¨t
 >
r§c
->
max
)

157  -
ENOSPC
;

159 
	`bôm≠_£t
(
r§c
->
bm≠
, 
°¨t
, 
ƒ§c
);

160  
°¨t
;

161 
	}
}

163 
	$rvu_‰ì_r§c_c⁄tig
(
r§c_bm≠
 *
r§c
, 
ƒ§c
, 
°¨t
)

165 i‡(!
r§c
->
bm≠
)

167 i‡(
°¨t
 >
r§c
->
max
)

170 
	`bôm≠_˛ór
(
r§c
->
bm≠
, 
°¨t
, 
ƒ§c
);

171 
	}
}

173 
boﬁ
 
	$rvu_r§c_check_c⁄tig
(
r§c_bm≠
 *
r§c
, 
ƒ§c
)

175 
°¨t
;

177 i‡(!
r§c
->
bm≠
)

178  
Ál£
;

180 
°¨t
 = 
	`bôm≠_föd_√xt_zîo_¨ó
(
r§c
->
bm≠
,Ñ§c->
max
, 0, 
ƒ§c
, 0);

181 i‡(
°¨t
 >
r§c
->
max
)

182  
Ál£
;

184  
åue
;

185 
	}
}

187 
	$rvu_‰ì_r§c
(
r§c_bm≠
 *
r§c
, 
id
)

189 i‡(!
r§c
->
bm≠
)

192 
	`__˛ór_bô
(
id
, 
r§c
->
bm≠
);

193 
	}
}

195 
	$rvu_r§c_‰ì_cou¡
(
r§c_bm≠
 *
r§c
)

197 
u£d
;

199 i‡(!
r§c
->
bm≠
)

202 
u£d
 = 
	`bôm≠_weight
(
r§c
->
bm≠
,Ñ§c->
max
);

203  (
r§c
->
max
 - 
u£d
);

204 
	}
}

206 
boﬁ
 
	$is_r§c_‰ì
(
r§c_bm≠
 *
r§c
, 
id
)

208 i‡(!
r§c
->
bm≠
)

209  
Ál£
;

211  !
	`ã°_bô
(
id
, 
r§c
->
bm≠
);

212 
	}
}

214 
	$rvu_Æloc_bôm≠
(
r§c_bm≠
 *
r§c
)

216 
r§c
->
bm≠
 = 
	`kˇŒoc
(
	`BITS_TO_LONGS
‘§c->
max
),

217 (), 
GFP_KERNEL
);

218 i‡(!
r§c
->
bm≠
)

219  -
ENOMEM
;

221 
	}
}

223 
	$rvu_‰ì_bôm≠
(
r§c_bm≠
 *
r§c
)

225 
	`k‰ì
(
r§c
->
bm≠
);

226 
	}
}

229 
	$rvu_gë_lf
(
rvu
 *rvu, 
rvu_block
 *
block
, 
u16
 
pcifunc
, u16 
¶Ÿ
)

231 
u16
 
m©ch
 = 0;

232 
lf
;

234 
	`muãx_lock
(&
rvu
->
r§c_lock
);

235 
lf
 = 0;Ü‡< 
block
->lf.
max
;Üf++) {

236 i‡(
block
->
‚_m≠
[
lf
] =
pcifunc
) {

237 i‡(
¶Ÿ
 =
m©ch
) {

238 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

239  
lf
;

241 
m©ch
++;

244 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

245  -
ENODEV
;

246 
	}
}

257 
	$rvu_gë_blkaddr
(
rvu
 *rvu, 
blkty≥
, 
u16
 
pcifunc
)

259 
devnum
, 
blkaddr
 = -
ENODEV
;

260 
u64
 
cfg
, 
ªg
;

261 
boﬁ
 
is_pf
;

263 
blkty≥
) {

264 
BLKTYPE_NPC
:

265 
blkaddr
 = 
BLKADDR_NPC
;

266 
exô
;

267 
BLKTYPE_NPA
:

268 
blkaddr
 = 
BLKADDR_NPA
;

269 
exô
;

270 
BLKTYPE_NIX
:

272 i‡(!
pcifunc
) {

273 
blkaddr
 = 
BLKADDR_NIX0
;

274 
exô
;

277 
BLKTYPE_SSO
:

278 
blkaddr
 = 
BLKADDR_SSO
;

279 
exô
;

280 
BLKTYPE_SSOW
:

281 
blkaddr
 = 
BLKADDR_SSOW
;

282 
exô
;

283 
BLKTYPE_TIM
:

284 
blkaddr
 = 
BLKADDR_TIM
;

285 
exô
;

286 
BLKTYPE_CPT
:

288 i‡(!
pcifunc
) {

289 
blkaddr
 = 
BLKADDR_CPT0
;

290 
exô
;

293 
BLKTYPE_REE
:

294 i‡(!
pcifunc
) {

295 
blkaddr
 = 
BLKADDR_REE0
;

296 
exô
;

302 i‡(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) {

303 
is_pf
 = 
Ál£
;

304 
devnum
 = 
	`rvu_gë_hwvf
(
rvu
, 
pcifunc
);

306 
is_pf
 = 
åue
;

307 
devnum
 = 
	`rvu_gë_pf
(
pcifunc
);

313 i‡(
blkty≥
 =
BLKTYPE_NIX
) {

314 
ªg
 = 
is_pf
 ? 
	`RVU_PRIV_PFX_NIXX_CFG
(0) :

315 
	`RVU_PRIV_HWVFX_NIXX_CFG
(0);

316 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
ªg
 | (
devnum
 << 16));

317 i‡(
cfg
) {

318 
blkaddr
 = 
BLKADDR_NIX0
;

319 
exô
;

322 
ªg
 = 
is_pf
 ? 
	`RVU_PRIV_PFX_NIXX_CFG
(1) :

323 
	`RVU_PRIV_HWVFX_NIXX_CFG
(1);

324 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
ªg
 | (
devnum
 << 16));

325 i‡(
cfg
)

326 
blkaddr
 = 
BLKADDR_NIX1
;

329 i‡(
blkty≥
 =
BLKTYPE_CPT
) {

330 
ªg
 = 
is_pf
 ? 
	`RVU_PRIV_PFX_CPTX_CFG
(0) :

331 
	`RVU_PRIV_HWVFX_CPTX_CFG
(0);

332 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
ªg
 | (
devnum
 << 16));

333 i‡(
cfg
) {

334 
blkaddr
 = 
BLKADDR_CPT0
;

335 
exô
;

338 
ªg
 = 
is_pf
 ? 
	`RVU_PRIV_PFX_CPTX_CFG
(1) :

339 
	`RVU_PRIV_HWVFX_CPTX_CFG
(1);

340 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
ªg
 | (
devnum
 << 16));

341 i‡(
cfg
)

342 
blkaddr
 = 
BLKADDR_CPT1
;

349 i‡(
blkty≥
 =
BLKTYPE_REE
) {

350 
ªg
 = 
is_pf
 ? 
	`RVU_PRIV_PFX_REEX_CFG
(0) :

351 
	`RVU_PRIV_HWVFX_REEX_CFG
(0);

352 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
ªg
 | (
devnum
 << 16));

353 i‡(
cfg
) {

354 
blkaddr
 = 
BLKADDR_REE0
;

355 
exô
;

358 
ªg
 = 
is_pf
 ? 
	`RVU_PRIV_PFX_REEX_CFG
(1) :

359 
	`RVU_PRIV_HWVFX_REEX_CFG
(1);

360 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
ªg
 | (
devnum
 << 16));

361 i‡(
cfg
)

362 
blkaddr
 = 
BLKADDR_REE1
;

365 
exô
:

366 i‡(
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

367  
blkaddr
;

368  -
ENODEV
;

369 
	}
}

371 
	$rvu_upd©e_r§c_m≠
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
,

372 
rvu_block
 *
block
, 
u16
 
pcifunc
,

373 
u16
 
lf
, 
boﬁ
 
©èch
)

375 
devnum
, 
num_lfs
 = 0;

376 
boﬁ
 
is_pf
;

377 
u64
 
ªg
;

379 i‡(
lf
 >
block
->lf.
max
) {

380 
	`dev_îr
(&
rvu
->
pdev
->
dev
,

382 
__func__
, 
lf
, 
block
->
«me
, block->lf.
max
);

387 i‡(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) {

388 
is_pf
 = 
Ál£
;

389 
devnum
 = 
	`rvu_gë_hwvf
(
rvu
, 
pcifunc
);

391 
is_pf
 = 
åue
;

392 
devnum
 = 
	`rvu_gë_pf
(
pcifunc
);

395 
block
->
‚_m≠
[
lf
] = 
©èch
 ? 
pcifunc
 : 0;

397 
block
->
addr
) {

398 
BLKADDR_NPA
:

399 
pfvf
->
≈Æf
 = 
©èch
 ? 
åue
 : 
Ál£
;

400 
num_lfs
 = 
pfvf
->
≈Æf
;

402 
BLKADDR_NIX0
:

403 
BLKADDR_NIX1
:

404 
pfvf
->
nixlf
 = 
©èch
 ? 
åue
 : 
Ál£
;

405 
num_lfs
 = 
pfvf
->
nixlf
;

407 
BLKADDR_SSO
:

408 
©èch
 ? 
pfvf
->
sso
++ :Öfvf->sso--;

409 
num_lfs
 = 
pfvf
->
sso
;

411 
BLKADDR_SSOW
:

412 
©èch
 ? 
pfvf
->
ssow
++ :Öfvf->ssow--;

413 
num_lfs
 = 
pfvf
->
ssow
;

415 
BLKADDR_TIM
:

416 
©èch
 ? 
pfvf
->
timlfs
++ :Öfvf->timlfs--;

417 
num_lfs
 = 
pfvf
->
timlfs
;

419 
BLKADDR_CPT0
:

420 
©èch
 ? 
pfvf
->
˝éfs
++ :Öfvf->cptlfs--;

421 
num_lfs
 = 
pfvf
->
˝éfs
;

423 
BLKADDR_CPT1
:

424 
©èch
 ? 
pfvf
->
˝t1_lfs
++ :Öfvf->cpt1_lfs--;

425 
num_lfs
 = 
pfvf
->
˝t1_lfs
;

427 
BLKADDR_REE0
:

428 
©èch
 ? 
pfvf
->
ªe0_lfs
++ :Öfvf->ree0_lfs--;

429 
num_lfs
 = 
pfvf
->
ªe0_lfs
;

431 
BLKADDR_REE1
:

432 
©èch
 ? 
pfvf
->
ªe1_lfs
++ :Öfvf->ree1_lfs--;

433 
num_lfs
 = 
pfvf
->
ªe1_lfs
;

437 
ªg
 = 
is_pf
 ? 
block
->
pf_lf˙t_ªg
 : block->
vf_lf˙t_ªg
;

438 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
ªg
 | (
devnum
 << 16), 
num_lfs
);

439 
	}
}

441 
ölöe
 
	$rvu_gë_pf
(
u16
 
pcifunc
)

443  (
pcifunc
 >> 
RVU_PFVF_PF_SHIFT
Ë& 
RVU_PFVF_PF_MASK
;

444 
	}
}

446 
	$rvu_gë_pf_numvfs
(
rvu
 *rvu, 
pf
, *
numvfs
, *
hwvf
)

448 
u64
 
cfg
;

451 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
pf
));

452 *
numvfs
 = (
cfg
 >> 12) & 0xFF;

453 *
hwvf
 = 
cfg
 & 0xFFF;

454 
	}
}

456 
	$rvu_gë_hwvf
(
rvu
 *rvu, 
pcifunc
)

458 
pf
, 
func
;

459 
u64
 
cfg
;

461 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

462 
func
 = 
pcifunc
 & 
RVU_PFVF_FUNC_MASK
;

465 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
pf
));

467  ((
cfg
 & 0xFFFË+ 
func
 - 1);

468 
	}
}

470 
rvu_pfvf
 *
	$rvu_gë_pfvf
(
rvu
 *rvu, 
pcifunc
)

473 i‡(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)

474  &
rvu
->
hwvf
[
	`rvu_gë_hwvf
‘vu, 
pcifunc
)];

476  &
rvu
->
pf
[
	`rvu_gë_pf
(
pcifunc
)];

477 
	}
}

479 
boﬁ
 
	$is_pf_func_vÆid
(
rvu
 *rvu, 
u16
 
pcifunc
)

481 
pf
, 
vf
, 
nvfs
;

482 
u64
 
cfg
;

484 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

485 i‡(
pf
 >
rvu
->
hw
->
tŸÆ_pfs
)

486  
Ál£
;

488 i‡(!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
))

489  
åue
;

492 
vf
 = (
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) - 1;

493 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
pf
));

494 
nvfs
 = (
cfg
 >> 12) & 0xFF;

495 i‡(
vf
 >
nvfs
)

496  
Ál£
;

498  
åue
;

499 
	}
}

501 
boﬁ
 
	$is_block_im∂emíãd
(
rvu_hwöfo
 *
hw
, 
blkaddr
)

503 
rvu_block
 *
block
;

505 i‡(
blkaddr
 < 
BLKADDR_RVUM
 || blkadd∏>
BLK_COUNT
)

506  
Ál£
;

508 
block
 = &
hw
->block[
blkaddr
];

509  
block
->
im∂emíãd
;

510 
	}
}

512 
	$rvu_check_block_im∂emíãd
(
rvu
 *rvu)

514 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

515 
rvu_block
 *
block
;

516 
blkid
;

517 
u64
 
cfg
;

520 
blkid
 = 0; blkid < 
BLK_COUNT
; blkid++) {

521 
block
 = &
hw
->block[
blkid
];

522 
cfg
 = 
	`rvupf_ªad64
(
rvu
, 
	`RVU_PF_BLOCK_ADDRX_DISC
(
blkid
));

523 i‡(
cfg
 & 
	`BIT_ULL
(11))

524 
block
->
im∂emíãd
 = 
åue
;

526 
	}
}

528 
	$rvu_£tup_rvum_blk_ªvid
(
rvu
 *rvu)

530 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
,

531 
	`RVU_PRIV_BLOCK_TYPEX_REV
(
BLKTYPE_RVUM
),

532 
RVU_BLK_RVUM_REVID
);

533 
	}
}

535 
	$rvu_˛ór_rvum_blk_ªvid
(
rvu
 *rvu)

537 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
,

538 
	`RVU_PRIV_BLOCK_TYPEX_REV
(
BLKTYPE_RVUM
), 0x00);

539 
	}
}

541 
	$rvu_lf_ª£t
(
rvu
 *rvu, 
rvu_block
 *
block
, 
lf
)

543 
îr
;

545 i‡(!
block
->
im∂emíãd
)

548 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, block->
l‰e£t_ªg
, 
lf
 | 
	`BIT_ULL
(12));

549 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
block
->
addr
, block->
l‰e£t_ªg
, 
	`BIT_ULL
(12),

550 
åue
);

551  
îr
;

552 
	}
}

554 
	$rvu_block_ª£t
(
rvu
 *rvu, 
blkaddr
, 
u64
 
r°_ªg
)

556 
rvu_block
 *
block
 = &
rvu
->
hw
->block[
blkaddr
];

557 
îr
;

559 i‡(!
block
->
im∂emíãd
)

562 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
r°_ªg
, 
	`BIT_ULL
(0));

563 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
r°_ªg
, 
	`BIT_ULL
(63), 
åue
);

564 i‡(
îr
) {

565 
	`dev_îr
(
rvu
->
dev
, "HW block:%dÑe£àtimeouàªåyögágaö\n", 
blkaddr
);

566 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
r°_ªg
, 
	`BIT_ULL
(63), 
åue
Ë=-
EBUSY
)

569 
	}
}

571 
	$rvu_ª£t_Æl_blocks
(
rvu
 *rvu)

574 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_NPA
, 
NPA_AF_BLK_RST
);

575 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_NIX0
, 
NIX_AF_BLK_RST
);

576 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_NIX1
, 
NIX_AF_BLK_RST
);

577 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_NPC
, 
NPC_AF_BLK_RST
);

578 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_SSO
, 
SSO_AF_BLK_RST
);

579 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_TIM
, 
TIM_AF_BLK_RST
);

580 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_CPT0
, 
CPT_AF_BLK_RST
);

581 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_CPT1
, 
CPT_AF_BLK_RST
);

582 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_NDC_NIX0_RX
, 
NDC_AF_BLK_RST
);

583 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_NDC_NIX0_TX
, 
NDC_AF_BLK_RST
);

584 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_NDC_NIX1_RX
, 
NDC_AF_BLK_RST
);

585 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_NDC_NIX1_TX
, 
NDC_AF_BLK_RST
);

586 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_NDC_NPA0
, 
NDC_AF_BLK_RST
);

587 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_REE0
, 
REE_AF_BLK_RST
);

588 
	`rvu_block_ª£t
(
rvu
, 
BLKADDR_REE1
, 
REE_AF_BLK_RST
);

589 
	}
}

591 
	$rvu_sˇn_block
(
rvu
 *rvu, 
rvu_block
 *
block
)

593 
rvu_pfvf
 *
pfvf
;

594 
u64
 
cfg
;

595 
lf
;

597 
lf
 = 0;Ü‡< 
block
->lf.
max
;Üf++) {

598 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
,

599 
block
->
lfcfg_ªg
 | (
lf
 << block->
lfshi·
));

600 i‡(!(
cfg
 & 
	`BIT_ULL
(63)))

604 
	`__£t_bô
(
lf
, 
block
->lf.
bm≠
);

607 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, (
cfg
 >> 8) & 0xFFFF);

608 
	`rvu_upd©e_r§c_m≠
(
rvu
, 
pfvf
, 
block
,

609 (
cfg
 >> 8Ë& 0xFFFF, 
lf
, 
åue
);

612 
	`rvu_£t_msix_off£t
(
rvu
, 
pfvf
, 
block
, 
lf
);

614 
	}
}

616 
	$rvu_check_mö_msix_vec
(
rvu
 *rvu, 
nvecs
, 
pf
, 
vf
)

618 
mö_vecs
;

620 i‡(!
vf
)

621 
check_pf
;

623 i‡(!
nvecs
) {

624 
	`dev_w¨n
(
rvu
->
dev
,

626 
pf
, 
vf
 - 1, 
nvecs
);

630 
check_pf
:

631 i‡(
pf
 == 0)

632 
mö_vecs
 = 
RVU_AF_INT_VEC_CNT
 + 
RVU_PF_INT_VEC_CNT
;

634 
mö_vecs
 = 
RVU_PF_INT_VEC_CNT
;

636 i‡(!(
nvecs
 < 
mö_vecs
))

638 
	`dev_w¨n
(
rvu
->
dev
,

640 
pf
, 
nvecs
, 
mö_vecs
);

641 
	}
}

643 
	$rvu_£tup_msix_ªsour˚s
(
rvu
 *rvu)

645 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

646 
pf
, 
vf
, 
numvfs
, 
hwvf
, 
îr
;

647 
nvecs
, 
off£t
, 
max_msix
;

648 
rvu_pfvf
 *
pfvf
;

649 
u64
 
cfg
, 
phy_addr
;

650 
dma_addr_t
 
iova
;

652 
pf
 = 0;Ö‡< 
hw
->
tŸÆ_pfs
;Öf++) {

653 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
pf
));

655 i‡(!((
cfg
 >> 20) & 0x01))

658 
	`rvu_gë_pf_numvfs
(
rvu
, 
pf
, &
numvfs
, &
hwvf
);

660 
pfvf
 = &
rvu
->
pf
[pf];

662 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_MSIX_CFG
(
pf
));

663 
pfvf
->
msix
.
max
 = ((
cfg
 >> 32) & 0xFFF) + 1;

664 
	`rvu_check_mö_msix_vec
(
rvu
, 
pfvf
->
msix
.
max
, 
pf
, 0);

667 
îr
 = 
	`rvu_Æloc_bôm≠
(&
pfvf
->
msix
);

668 i‡(
îr
)

669  
îr
;

672 
pfvf
->
msix_lfm≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
,Öfvf->
msix
.
max
,

673 (
u16
), 
GFP_KERNEL
);

674 i‡(!
pfvf
->
msix_lfm≠
)

675  -
ENOMEM
;

680 i‡(!
pf
)

681 
£tup_vfmsix
;

687 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_INT_CFG
(
pf
));

688 
nvecs
 = (
cfg
 >> 12) & 0xFF;

689 
cfg
 &= ~0x7FFULL;

690 
off£t
 = 
	`rvu_Æloc_r§c_c⁄tig
(&
pfvf
->
msix
, 
nvecs
);

691 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
,

692 
	`RVU_PRIV_PFX_INT_CFG
(
pf
), 
cfg
 | 
off£t
);

693 
£tup_vfmsix
:

695 
vf
 = 0; v‡< 
numvfs
; vf++) {

696 
pfvf
 = &
rvu
->
hwvf
[hwv‡+ 
vf
];

698 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
,

699 
	`RVU_PRIV_PFX_MSIX_CFG
(
pf
));

700 
pfvf
->
msix
.
max
 = (
cfg
 & 0xFFF) + 1;

701 
	`rvu_check_mö_msix_vec
(
rvu
, 
pfvf
->
msix
.
max
, 
pf
, 
vf
 + 1);

704 
îr
 = 
	`rvu_Æloc_bôm≠
(&
pfvf
->
msix
);

705 i‡(
îr
)

706  
îr
;

708 
pfvf
->
msix_lfm≠
 =

709 
	`devm_kˇŒoc
(
rvu
->
dev
, 
pfvf
->
msix
.
max
,

710 (
u16
), 
GFP_KERNEL
);

711 i‡(!
pfvf
->
msix_lfm≠
)

712  -
ENOMEM
;

718 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
,

719 
	`RVU_PRIV_HWVFX_INT_CFG
(
hwvf
 + 
vf
));

720 
nvecs
 = (
cfg
 >> 12) & 0xFF;

721 
cfg
 &= ~0x7FFULL;

722 
off£t
 = 
	`rvu_Æloc_r§c_c⁄tig
(&
pfvf
->
msix
, 
nvecs
);

723 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
,

724 
	`RVU_PRIV_HWVFX_INT_CFG
(
hwvf
 + 
vf
),

725 
cfg
 | 
off£t
);

733 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_PRIV_CONST
);

734 
max_msix
 = 
cfg
 & 0xFFFFF;

735 i‡(
rvu
->
fwd©a
 &&Ñvu->fwd©a->
msixå_ba£
)

736 
phy_addr
 = 
rvu
->
fwd©a
->
msixå_ba£
;

738 
phy_addr
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_MSIXTR_BASE
);

739 
iova
 = 
	`dma_m≠_ªsour˚
(
rvu
->
dev
, 
phy_addr
,

740 
max_msix
 * 
PCI_MSIX_ENTRY_SIZE
,

741 
DMA_BIDIRECTIONAL
, 0);

743 i‡(
	`dma_m≠pög_îr‹
(
rvu
->
dev
, 
iova
))

744  -
ENOMEM
;

746 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_MSIXTR_BASE
, (
u64
)
iova
);

747 
rvu
->
msix_ba£_iova
 = 
iova
;

748 
rvu
->
msixå_ba£_phy
 = 
phy_addr
;

751 
	}
}

753 
	$rvu_ª£t_msix
(
rvu
 *rvu)

756 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_MSIXTR_BASE
,

757 
rvu
->
msixå_ba£_phy
);

758 
	}
}

760 
	$rvu_‰ì_hw_ªsour˚s
(
rvu
 *rvu)

762 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

763 
rvu_block
 *
block
;

764 
rvu_pfvf
 *
pfvf
;

765 
id
, 
max_msix
;

766 
u64
 
cfg
;

768 
	`rvu_≈a_‰ìmem
(
rvu
);

769 
	`rvu_≈c_‰ìmem
(
rvu
);

770 
	`rvu_nix_‰ìmem
(
rvu
);

771 
	`rvu_sso_‰ìmem
(
rvu
);

772 
	`rvu_ªe_‰ìmem
(
rvu
);

775 
id
 = 0; id < 
BLK_COUNT
; id++) {

776 
block
 = &
hw
->block[
id
];

777 
	`k‰ì
(
block
->
lf
.
bm≠
);

781 
id
 = 0; id < 
hw
->
tŸÆ_pfs
; id++) {

782 
pfvf
 = &
rvu
->
pf
[
id
];

783 
	`k‰ì
(
pfvf
->
msix
.
bm≠
);

786 
id
 = 0; id < 
hw
->
tŸÆ_vfs
; id++) {

787 
pfvf
 = &
rvu
->
hwvf
[
id
];

788 
	`k‰ì
(
pfvf
->
msix
.
bm≠
);

792 i‡(!
rvu
->
msix_ba£_iova
)

794 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_PRIV_CONST
);

795 
max_msix
 = 
cfg
 & 0xFFFFF;

796 
	`dma_unm≠_ªsour˚
(
rvu
->
dev
,Ñvu->
msix_ba£_iova
,

797 
max_msix
 * 
PCI_MSIX_ENTRY_SIZE
,

798 
DMA_BIDIRECTIONAL
, 0);

800 
	`rvu_ª£t_msix
(
rvu
);

801 
	`muãx_de°roy
(&
rvu
->
r§c_lock
);

802 
	`muãx_de°roy
(&
rvu
->
Æüs_lock
);

803 
	}
}

805 
	$rvu_£tup_pfvf_maˇddªss
(
rvu
 *rvu)

807 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

808 
pf
, 
vf
, 
numvfs
, 
hwvf
;

809 
rvu_pfvf
 *
pfvf
;

810 
u64
 *
mac
;

812 
pf
 = 0;Ö‡< 
hw
->
tŸÆ_pfs
;Öf++) {

814 i‡(!
pf
)

815 
lbkvf
;

817 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

820 
pfvf
 = &
rvu
->
pf
[pf];

821 i‡(
rvu
->
fwd©a
 && 
pf
 < 
PF_MACNUM_MAX
) {

822 
mac
 = &
rvu
->
fwd©a
->
pf_macs
[
pf
];

823 i‡(*
mac
)

824 
	`u64_to_ëhî_addr
(*
mac
, 
pfvf
->
mac_addr
);

826 
	`ëh_øndom_addr
(
pfvf
->
mac_addr
);

828 
	`ëh_øndom_addr
(
pfvf
->
mac_addr
);

830 
	`ëhî_addr_c›y
(
pfvf
->
deÁu…_mac
,Öfvf->
mac_addr
);

832 
lbkvf
:

834 
	`rvu_gë_pf_numvfs
(
rvu
, 
pf
, &
numvfs
, &
hwvf
);

835 
vf
 = 0; v‡< 
numvfs
; vf++, 
hwvf
++) {

836 
pfvf
 = &
rvu
->
hwvf
[hwvf];

837 i‡(
rvu
->
fwd©a
 && 
hwvf
 < 
VF_MACNUM_MAX
) {

838 
mac
 = &
rvu
->
fwd©a
->
vf_macs
[
hwvf
];

839 i‡(*
mac
)

840 
	`u64_to_ëhî_addr
(*
mac
, 
pfvf
->
mac_addr
);

842 
	`ëh_øndom_addr
(
pfvf
->
mac_addr
);

844 
	`ëh_øndom_addr
(
pfvf
->
mac_addr
);

846 
	`ëhî_addr_c›y
(
pfvf
->
deÁu…_mac
,Öfvf->
mac_addr
);

849 
	}
}

851 
	$rvu_£tup_pfvf_aggr_lvl_º_¥io
(
rvu
 *rvu)

853 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

854 
rvu_pfvf
 *
pfvf
;

855 
pf
;

857 
pf
 = 0;Ö‡< 
hw
->
tŸÆ_pfs
;Öf++) {

858 
pfvf
 = &
rvu
->
pf
[pf];

859 
pfvf
->
é1_º_¥io
 = 
TXSCH_TL1_DFLT_RR_PRIO
;

861 
	}
}

863 
	$rvu_fwd©a_öô
(
rvu
 *rvu)

865 
u64
 
fwdba£
;

866 
îr
;

869 
îr
 = 
	`cgx_gë_fwd©a_ba£
(&
fwdba£
);

870 i‡(
îr
)

871 
Áû
;

872 
rvu
->
fwd©a
 = 
	`i‹em≠_wc
(
fwdba£
, (
rvu_fwd©a
));

873 i‡(!
rvu
->
fwd©a
)

874 
Áû
;

875 i‡(!
	`is_rvu_fwd©a_vÆid
(
rvu
)) {

876 
	`dev_îr
(
rvu
->
dev
,

878 
	`iounm≠
(
rvu
->
fwd©a
);

879 
rvu
->
fwd©a
 = 
NULL
;

880  -
EINVAL
;

883 
Áû
:

884 
	`dev_öfo
(
rvu
->
dev
, "UnableÅo fetch 'fwdata' from firmware\n");

885  -
EIO
;

886 
	}
}

888 
	$rvu_fwd©a_exô
(
rvu
 *rvu)

890 i‡(
rvu
->
fwd©a
)

891 
	`iounm≠
(
rvu
->
fwd©a
);

892 
	}
}

894 
	$rvu_£tup_nix_hw_ªsour˚
(
rvu
 *rvu, 
blkaddr
)

896 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

897 
rvu_block
 *
block
;

898 
blkid
;

899 
u64
 
cfg
;

902 
block
 = &
hw
->block[
blkaddr
];

903 i‡(!
block
->
im∂emíãd
)

905 
blkid
 = (
blkaddr
 =
BLKADDR_NIX0
) ? 0 : 1;

906 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST2
);

907 
block
->
lf
.
max
 = 
cfg
 & 0xFFF;

908 
block
->
addr
 = 
blkaddr
;

909 
block
->
ty≥
 = 
BLKTYPE_NIX
;

910 
block
->
lfshi·
 = 8;

911 
block
->
lookup_ªg
 = 
NIX_AF_RVU_LF_CFG_DEBUG
;

912 
block
->
pf_lf˙t_ªg
 = 
	`RVU_PRIV_PFX_NIXX_CFG
(
blkid
);

913 
block
->
vf_lf˙t_ªg
 = 
	`RVU_PRIV_HWVFX_NIXX_CFG
(
blkid
);

914 
block
->
lfcfg_ªg
 = 
NIX_PRIV_LFX_CFG
;

915 
block
->
msixcfg_ªg
 = 
NIX_PRIV_LFX_INT_CFG
;

916 
block
->
l‰e£t_ªg
 = 
NIX_AF_LF_RST
;

917 
block
->
rvu
 =Ñvu;

918 
	`•rötf
(
block
->
«me
, "NIX%d", 
blkid
);

919 
rvu
->
nix_blkaddr
[
blkid
] = 
blkaddr
;

920  
	`rvu_Æloc_bôm≠
(&
block
->
lf
);

921 
	}
}

923 
	$rvu_£tup_˝t_hw_ªsour˚
(
rvu
 *rvu, 
blkaddr
)

925 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

926 
rvu_block
 *
block
;

927 
blkid
;

928 
u64
 
cfg
;

931 
block
 = &
hw
->block[
blkaddr
];

932 i‡(!
block
->
im∂emíãd
)

934 
blkid
 = (
blkaddr
 =
BLKADDR_CPT0
) ? 0 : 1;

935 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CONSTANTS0
);

936 
block
->
lf
.
max
 = 
cfg
 & 0xFF;

937 
block
->
addr
 = 
blkaddr
;

938 
block
->
ty≥
 = 
BLKTYPE_CPT
;

939 
block
->
mu…i¶Ÿ
 = 
åue
;

940 
block
->
lfshi·
 = 3;

941 
block
->
lookup_ªg
 = 
CPT_AF_RVU_LF_CFG_DEBUG
;

942 
block
->
pf_lf˙t_ªg
 = 
	`RVU_PRIV_PFX_CPTX_CFG
(
blkid
);

943 
block
->
vf_lf˙t_ªg
 = 
	`RVU_PRIV_HWVFX_CPTX_CFG
(
blkid
);

944 
block
->
lfcfg_ªg
 = 
CPT_PRIV_LFX_CFG
;

945 
block
->
msixcfg_ªg
 = 
CPT_PRIV_LFX_INT_CFG
;

946 
block
->
l‰e£t_ªg
 = 
CPT_AF_LF_RST
;

947 
block
->
rvu
 =Ñvu;

948 
	`•rötf
(
block
->
«me
, "CPT%d", 
blkid
);

949  
	`rvu_Æloc_bôm≠
(&
block
->
lf
);

950 
	}
}

952 
	$rvu_£tup_ªe_hw_ªsour˚
(
rvu
 *rvu, 
blkaddr
, 
blkid
)

954 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

955 
rvu_block
 *
block
;

956 
îr
;

957 
u64
 
cfg
;

960 
block
 = &
hw
->block[
blkaddr
];

961 i‡(!
block
->
im∂emíãd
)

963 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
REE_AF_CONSTANTS
);

964 
block
->
lf
.
max
 = 
cfg
 & 0xFF;

965 
block
->
addr
 = 
blkaddr
;

966 
block
->
ty≥
 = 
BLKTYPE_REE
;

967 
block
->
mu…i¶Ÿ
 = 
åue
;

968 
block
->
lfshi·
 = 3;

969 
block
->
lookup_ªg
 = 
REE_AF_RVU_LF_CFG_DEBUG
;

970 
block
->
pf_lf˙t_ªg
 = 
	`RVU_PRIV_PFX_REEX_CFG
(
blkid
);

971 
block
->
vf_lf˙t_ªg
 = 
	`RVU_PRIV_HWVFX_REEX_CFG
(
blkid
);

972 
block
->
lfcfg_ªg
 = 
REE_PRIV_LFX_CFG
;

973 
block
->
msixcfg_ªg
 = 
REE_PRIV_LFX_INT_CFG
;

974 
block
->
l‰e£t_ªg
 = 
REE_AF_LF_RST
;

975 
block
->
rvu
 =Ñvu;

976 
	`•rötf
(
block
->
«me
, "REE%d", 
blkid
);

977 
îr
 = 
	`rvu_Æloc_bôm≠
(&
block
->
lf
);

978 i‡(
îr
)

979  
îr
;

981 
	}
}

983 
	$rvu_gë_lbk_bufsize
(
rvu
 *rvu)

985 
pci_dev
 *
pdev
 = 
NULL
;

986 
__iomem
 *
ba£
;

987 
u64
 
lbk_c⁄°
;

989 
pdev
 = 
	`pci_gë_devi˚
(
PCI_VENDOR_ID_CAVIUM
,

990 
PCI_DEVID_OCTEONTX2_LBK
, 
pdev
);

991 i‡(!
pdev
)

994 
ba£
 = 
	`pci_i‹em≠_b¨
(
pdev
, 0);

995 i‡(!
ba£
)

996 
îr_put
;

998 
lbk_c⁄°
 = 
	`ªadq
(
ba£
 + 
LBK_CONST
);

1001 
rvu
->
hw
->
lbk_bufsize
 = 
	`FIELD_GET
(
LBK_CONST_BUF_SIZE
, 
lbk_c⁄°
);

1003 
	`iounm≠
(
ba£
);

1004 
îr_put
:

1005 
	`pci_dev_put
(
pdev
);

1006 
	}
}

1009 
	$rvu_£tup_hw_ªsour˚s
(
rvu
 *rvu)

1011 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1012 
rvu_block
 *
block
;

1013 
blkid
, 
îr
;

1014 
u64
 
cfg
;

1017 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_PRIV_CONST
);

1018 
hw
->
tŸÆ_pfs
 = (
cfg
 >> 32) & 0xFF;

1019 
hw
->
tŸÆ_vfs
 = (
cfg
 >> 20) & 0xFFF;

1020 
hw
->
max_vfs_≥r_pf
 = (
cfg
 >> 40) & 0xFF;

1022 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

1023 
	`rvu_≠r_block_˙10k_öô
(
rvu
);

1026 
block
 = &
hw
->block[
BLKADDR_NPA
];

1027 i‡(!
block
->
im∂emíãd
)

1028 
nix
;

1029 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NPA
, 
NPA_AF_CONST
);

1030 
block
->
lf
.
max
 = (
cfg
 >> 16) & 0xFFF;

1031 
block
->
addr
 = 
BLKADDR_NPA
;

1032 
block
->
ty≥
 = 
BLKTYPE_NPA
;

1033 
block
->
lfshi·
 = 8;

1034 
block
->
lookup_ªg
 = 
NPA_AF_RVU_LF_CFG_DEBUG
;

1035 
block
->
pf_lf˙t_ªg
 = 
RVU_PRIV_PFX_NPA_CFG
;

1036 
block
->
vf_lf˙t_ªg
 = 
RVU_PRIV_HWVFX_NPA_CFG
;

1037 
block
->
lfcfg_ªg
 = 
NPA_PRIV_LFX_CFG
;

1038 
block
->
msixcfg_ªg
 = 
NPA_PRIV_LFX_INT_CFG
;

1039 
block
->
l‰e£t_ªg
 = 
NPA_AF_LF_RST
;

1040 
block
->
rvu
 =Ñvu;

1041 
	`•rötf
(
block
->
«me
, "NPA");

1042 
îr
 = 
	`rvu_Æloc_bôm≠
(&
block
->
lf
);

1043 i‡(
îr
) {

1044 
	`dev_îr
(
rvu
->
dev
,

1045 "%s: FaûedÅÿÆloˇã NPA LF bôm≠\n", 
__func__
);

1046  
îr
;

1049 
nix
:

1050 
îr
 = 
	`rvu_£tup_nix_hw_ªsour˚
(
rvu
, 
BLKADDR_NIX0
);

1051 i‡(
îr
) {

1052 
	`dev_îr
(
rvu
->
dev
,

1053 "%s: FaûedÅÿÆloˇã NIX0 LF†bôm≠\n", 
__func__
);

1054  
îr
;

1057 
îr
 = 
	`rvu_£tup_nix_hw_ªsour˚
(
rvu
, 
BLKADDR_NIX1
);

1058 i‡(
îr
) {

1059 
	`dev_îr
(
rvu
->
dev
,

1060 "%s: FaûedÅÿÆloˇã NIX1 LF†bôm≠\n", 
__func__
);

1061  
îr
;

1065 
block
 = &
hw
->block[
BLKADDR_SSO
];

1066 i‡(!
block
->
im∂emíãd
)

1067 
ssow
;

1068 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_SSO
, 
SSO_AF_CONST
);

1069 
block
->
lf
.
max
 = 
cfg
 & 0xFFFF;

1070 
block
->
addr
 = 
BLKADDR_SSO
;

1071 
block
->
ty≥
 = 
BLKTYPE_SSO
;

1072 
block
->
mu…i¶Ÿ
 = 
åue
;

1073 
block
->
lfshi·
 = 3;

1074 
block
->
lookup_ªg
 = 
SSO_AF_RVU_LF_CFG_DEBUG
;

1075 
block
->
pf_lf˙t_ªg
 = 
RVU_PRIV_PFX_SSO_CFG
;

1076 
block
->
vf_lf˙t_ªg
 = 
RVU_PRIV_HWVFX_SSO_CFG
;

1077 
block
->
lfcfg_ªg
 = 
SSO_PRIV_LFX_HWGRP_CFG
;

1078 
block
->
msixcfg_ªg
 = 
SSO_PRIV_LFX_HWGRP_INT_CFG
;

1079 
block
->
l‰e£t_ªg
 = 
SSO_AF_LF_HWGRP_RST
;

1080 
block
->
rvu
 =Ñvu;

1081 
	`•rötf
(
block
->
«me
, "SSO GROUP");

1082 
îr
 = 
	`rvu_Æloc_bôm≠
(&
block
->
lf
);

1083 i‡(
îr
) {

1084 
	`dev_îr
(
rvu
->
dev
,

1085 "%s: FaûedÅÿÆloˇã SSO LF bôm≠\n", 
__func__
);

1086  
îr
;

1089 
ssow
:

1091 
block
 = &
hw
->block[
BLKADDR_SSOW
];

1092 i‡(!
block
->
im∂emíãd
)

1093 
tim
;

1094 
block
->
lf
.
max
 = (
cfg
 >> 56) & 0xFF;

1095 
block
->
addr
 = 
BLKADDR_SSOW
;

1096 
block
->
ty≥
 = 
BLKTYPE_SSOW
;

1097 
block
->
mu…i¶Ÿ
 = 
åue
;

1098 
block
->
lfshi·
 = 3;

1099 
block
->
lookup_ªg
 = 
SSOW_AF_RVU_LF_HWS_CFG_DEBUG
;

1100 
block
->
pf_lf˙t_ªg
 = 
RVU_PRIV_PFX_SSOW_CFG
;

1101 
block
->
vf_lf˙t_ªg
 = 
RVU_PRIV_HWVFX_SSOW_CFG
;

1102 
block
->
lfcfg_ªg
 = 
SSOW_PRIV_LFX_HWS_CFG
;

1103 
block
->
msixcfg_ªg
 = 
SSOW_PRIV_LFX_HWS_INT_CFG
;

1104 
block
->
l‰e£t_ªg
 = 
SSOW_AF_LF_HWS_RST
;

1105 
block
->
rvu
 =Ñvu;

1106 
	`•rötf
(
block
->
«me
, "SSOWS");

1107 
îr
 = 
	`rvu_Æloc_bôm≠
(&
block
->
lf
);

1108 i‡(
îr
) {

1109 
	`dev_îr
(
rvu
->
dev
,

1110 "%s: FaûedÅÿÆloˇã SSOW LF bôm≠\n", 
__func__
);

1111  
îr
;

1114 
tim
:

1116 
block
 = &
hw
->block[
BLKADDR_TIM
];

1117 i‡(!
block
->
im∂emíãd
)

1118 
˝t
;

1119 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_TIM
, 
TIM_AF_CONST
);

1120 
block
->
lf
.
max
 = 
cfg
 & 0xFFFF;

1121 
block
->
addr
 = 
BLKADDR_TIM
;

1122 
block
->
ty≥
 = 
BLKTYPE_TIM
;

1123 
block
->
mu…i¶Ÿ
 = 
åue
;

1124 
block
->
lfshi·
 = 3;

1125 
block
->
lookup_ªg
 = 
TIM_AF_RVU_LF_CFG_DEBUG
;

1126 
block
->
pf_lf˙t_ªg
 = 
RVU_PRIV_PFX_TIM_CFG
;

1127 
block
->
vf_lf˙t_ªg
 = 
RVU_PRIV_HWVFX_TIM_CFG
;

1128 
block
->
lfcfg_ªg
 = 
TIM_PRIV_LFX_CFG
;

1129 
block
->
msixcfg_ªg
 = 
TIM_PRIV_LFX_INT_CFG
;

1130 
block
->
l‰e£t_ªg
 = 
TIM_AF_LF_RST
;

1131 
block
->
rvu
 =Ñvu;

1132 
	`•rötf
(
block
->
«me
, "TIM");

1133 
îr
 = 
	`rvu_Æloc_bôm≠
(&
block
->
lf
);

1134 i‡(
îr
) {

1135 
	`dev_îr
(
rvu
->
dev
,

1136 "%s: FaûedÅÿÆloˇã TIM LF bôm≠\n", 
__func__
);

1137  
îr
;

1140 
˝t
:

1141 
îr
 = 
	`rvu_£tup_˝t_hw_ªsour˚
(
rvu
, 
BLKADDR_CPT0
);

1142 i‡(
îr
) {

1143 
	`dev_îr
(
rvu
->
dev
,

1144 "%s: FaûedÅÿÆloˇã CPT0 LF bôm≠\n", 
__func__
);

1145  
îr
;

1147 
îr
 = 
	`rvu_£tup_˝t_hw_ªsour˚
(
rvu
, 
BLKADDR_CPT1
);

1148 i‡(
îr
) {

1149 
	`dev_îr
(
rvu
->
dev
,

1150 "%s: FaûedÅÿÆloˇã CPT1 LF bôm≠\n", 
__func__
);

1151  
îr
;

1155 
îr
 = 
	`rvu_£tup_ªe_hw_ªsour˚
(
rvu
, 
BLKADDR_REE0
, 0);

1156 i‡(
îr
)

1157  
îr
;

1158 
îr
 = 
	`rvu_£tup_ªe_hw_ªsour˚
(
rvu
, 
BLKADDR_REE1
, 1);

1159 i‡(
îr
)

1160  
îr
;

1163 
rvu
->
pf
 = 
	`devm_kˇŒoc
‘vu->
dev
, 
hw
->
tŸÆ_pfs
,

1164 (
rvu_pfvf
), 
GFP_KERNEL
);

1165 i‡(!
rvu
->
pf
) {

1166 
	`dev_îr
(
rvu
->
dev
,

1167 "%s: FaûedÅÿÆloˇã mem‹y f‹ PF'†rvu_pfv‡°ru˘\n", 
__func__
);

1168  -
ENOMEM
;

1171 
rvu
->
hwvf
 = 
	`devm_kˇŒoc
‘vu->
dev
, 
hw
->
tŸÆ_vfs
,

1172 (
rvu_pfvf
), 
GFP_KERNEL
);

1173 i‡(!
rvu
->
hwvf
) {

1174 
	`dev_îr
(
rvu
->
dev
,

1175 "%s: FaûedÅÿÆloˇã mem‹y f‹ VF'†rvu_pfv‡°ru˘\n", 
__func__
);

1176  -
ENOMEM
;

1179 
	`muãx_öô
(&
rvu
->
r§c_lock
);

1180 
	`muãx_öô
(&
rvu
->
Æüs_lock
);

1182 
	`rvu_fwd©a_öô
(
rvu
);

1184 
îr
 = 
	`rvu_£tup_msix_ªsour˚s
(
rvu
);

1185 i‡(
îr
) {

1186 
	`dev_îr
(
rvu
->
dev
,

1187 "%s: FaûedÅÿ£tu∞MSIXÑesour˚s\n", 
__func__
);

1188  
îr
;

1191 
blkid
 = 0; blkid < 
BLK_COUNT
; blkid++) {

1192 
block
 = &
hw
->block[
blkid
];

1193 i‡(!
block
->
lf
.
bm≠
)

1197 
block
->
‚_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, block->
lf
.
max
,

1198 (
u16
), 
GFP_KERNEL
);

1199 i‡(!
block
->
‚_m≠
) {

1200 
îr
 = -
ENOMEM
;

1201 
msix_îr
;

1207 
	`rvu_sˇn_block
(
rvu
, 
block
);

1210 
îr
 = 
	`rvu_£t_ch™√ls_ba£
(
rvu
);

1211 i‡(
îr
)

1212 
msix_îr
;

1214 
îr
 = 
	`rvu_≈c_öô
(
rvu
);

1215 i‡(
îr
) {

1216 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizê≈c\n", 
__func__
);

1217 
≈c_îr
;

1220 
îr
 = 
	`rvu_cgx_öô
(
rvu
);

1221 i‡(
îr
) {

1222 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizêcgx\n", 
__func__
);

1223 
cgx_îr
;

1226 
îr
 = 
	`rvu_≈c_exa˘_öô
(
rvu
);

1227 i‡(
îr
) {

1228 
	`dev_îr
(
rvu
->
dev
, "failedÅo initializeÉxact matchÅable\n");

1229  
îr
;

1233 
	`rvu_£tup_pfvf_maˇddªss
(
rvu
);

1236 
	`rvu_£tup_pfvf_aggr_lvl_º_¥io
(
rvu
);

1238 
îr
 = 
	`rvu_≈a_öô
(
rvu
);

1239 i‡(
îr
) {

1240 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizê≈a\n", 
__func__
);

1241 
≈a_îr
;

1244 
	`rvu_gë_lbk_bufsize
(
rvu
);

1246 
îr
 = 
	`rvu_nix_öô
(
rvu
);

1247 i‡(
îr
) {

1248 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizênix\n", 
__func__
);

1249 
nix_îr
;

1252 
îr
 = 
	`rvu_sso_öô
(
rvu
);

1253 i‡(
îr
) {

1254 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizêsso\n", 
__func__
);

1255 
sso_îr
;

1258 
îr
 = 
	`rvu_tim_öô
(
rvu
);

1259 i‡(
îr
) {

1260 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizêtim\n", 
__func__
);

1261 
sso_îr
;

1264 
îr
 = 
	`rvu_sdp_öô
(
rvu
);

1265 i‡(
îr
) {

1266 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizêsdp\n", 
__func__
);

1267 
sso_îr
;

1270 
îr
 = 
	`rvu_ªe_öô
(
rvu
);

1271 i‡(
îr
) {

1272 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizêªe\n", 
__func__
);

1273 
sso_îr
;

1276 
îr
 = 
	`rvu_˝t_öô
(
rvu
);

1277 i‡(
îr
) {

1278 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizê˝t\n", 
__func__
);

1279 
sso_îr
;

1282 
	`rvu_¥ogøm_ch™√ls
(
rvu
);

1284 
îr
 = 
	`rvu_mcs_öô
(
rvu
);

1285 i‡(
îr
) {

1286 
	`dev_îr
(
rvu
->
dev
, "%s: FaûedÅÿöôülizêmcs\n", 
__func__
);

1287 
sso_îr
;

1292 
sso_îr
:

1293 
	`rvu_sso_‰ìmem
(
rvu
);

1294 
nix_îr
:

1295 
	`rvu_nix_‰ìmem
(
rvu
);

1296 
≈a_îr
:

1297 
	`rvu_≈a_‰ìmem
(
rvu
);

1298 
cgx_îr
:

1299 
	`rvu_cgx_exô
(
rvu
);

1300 
≈c_îr
:

1301 
	`rvu_≈c_‰ìmem
(
rvu
);

1302 
	`rvu_fwd©a_exô
(
rvu
);

1303 
msix_îr
:

1304 
	`rvu_ª£t_msix
(
rvu
);

1305  
îr
;

1306 
	}
}

1309 
	$rvu_aq_‰ì
(
rvu
 *rvu, 
admö_queue
 *
aq
)

1311 i‡(!
aq
)

1314 
	`qmem_‰ì
(
rvu
->
dev
, 
aq
->
ö°
);

1315 
	`qmem_‰ì
(
rvu
->
dev
, 
aq
->
ªs
);

1316 
	`devm_k‰ì
(
rvu
->
dev
, 
aq
);

1317 
	}
}

1319 
	$rvu_aq_Æloc
(
rvu
 *rvu, 
admö_queue
 **
ad_queue
,

1320 
qsize
, 
ö°_size
, 
ªs_size
)

1322 
admö_queue
 *
aq
;

1323 
îr
;

1325 *
ad_queue
 = 
	`devm_kzÆloc
(
rvu
->
dev
, (*
aq
), 
GFP_KERNEL
);

1326 i‡(!*
ad_queue
)

1327  -
ENOMEM
;

1328 
aq
 = *
ad_queue
;

1331 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
aq
->
ö°
, 
qsize
, 
ö°_size
);

1332 i‡(
îr
) {

1333 
	`devm_k‰ì
(
rvu
->
dev
, 
aq
);

1334  
îr
;

1338 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
aq
->
ªs
, 
qsize
, 
ªs_size
);

1339 i‡(
îr
) {

1340 
	`rvu_aq_‰ì
(
rvu
, 
aq
);

1341  
îr
;

1344 
	`•ö_lock_öô
(&
aq
->
lock
);

1346 
	}
}

1348 
	$rvu_mbox_h™dÀr_ªady
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

1349 
ªady_msg_r•
 *
r•
)

1351 i‡(
rvu
->
fwd©a
) {

1352 
r•
->
r˛k_‰eq
 = 
rvu
->
fwd©a
->
r˛k
;

1353 
r•
->
s˛k_‰eq
 = 
rvu
->
fwd©a
->
s˛k
;

1356 
	}
}

1361 
u16
 
	$rvu_gë_r§c_m≠cou¡
(
rvu_pfvf
 *
pfvf
, 
blkaddr
)

1363 
blkaddr
) {

1364 
BLKADDR_NPA
:

1365  
pfvf
->
≈Æf
 ? 1 : 0;

1366 
BLKADDR_NIX0
:

1367 
BLKADDR_NIX1
:

1368  
pfvf
->
nixlf
 ? 1 : 0;

1369 
BLKADDR_SSO
:

1370  
pfvf
->
sso
;

1371 
BLKADDR_SSOW
:

1372  
pfvf
->
ssow
;

1373 
BLKADDR_TIM
:

1374  
pfvf
->
timlfs
;

1375 
BLKADDR_CPT0
:

1376  
pfvf
->
˝éfs
;

1377 
BLKADDR_CPT1
:

1378  
pfvf
->
˝t1_lfs
;

1379 
BLKADDR_REE0
:

1380  
pfvf
->
ªe0_lfs
;

1381 
BLKADDR_REE1
:

1382  
pfvf
->
ªe1_lfs
;

1385 
	}
}

1388 
boﬁ
 
	$is_blkty≥_©èched
(
rvu_pfvf
 *
pfvf
, 
blkty≥
)

1390 
blkty≥
) {

1391 
BLKTYPE_NPA
:

1392  
pfvf
->
≈Æf
 ? 1 : 0;

1393 
BLKTYPE_NIX
:

1394  
pfvf
->
nixlf
 ? 1 : 0;

1395 
BLKTYPE_SSO
:

1396  !!
pfvf
->
sso
;

1397 
BLKTYPE_SSOW
:

1398  !!
pfvf
->
ssow
;

1399 
BLKTYPE_TIM
:

1400  !!
pfvf
->
timlfs
;

1401 
BLKTYPE_CPT
:

1402  
pfvf
->
˝éfs
 ||Öfvf->
˝t1_lfs
;

1403 
BLKTYPE_REE
:

1404  
pfvf
->
ªe0_lfs
 ||Öfvf->
ªe1_lfs
;

1407  
Ál£
;

1408 
	}
}

1410 
boﬁ
 
	$is_pffunc_m≠_vÆid
(
rvu
 *rvu, 
u16
 
pcifunc
, 
blkty≥
)

1412 
rvu_pfvf
 *
pfvf
;

1414 i‡(!
	`is_pf_func_vÆid
(
rvu
, 
pcifunc
))

1415  
Ál£
;

1417 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1420 i‡(
blkty≥
 !
BLKTYPE_SSO
 && !
	`is_blkty≥_©èched
(
pfvf
, blktype))

1421  
Ál£
;

1423  
åue
;

1424 
	}
}

1426 
	$rvu_lookup_r§c
(
rvu
 *rvu, 
rvu_block
 *
block
,

1427 
pcifunc
, 
¶Ÿ
)

1429 
u64
 
vÆ
;

1431 i‡(
block
->
ty≥
 =
BLKTYPE_TIM
)

1432  
	`rvu_tim_lookup_r§c
(
rvu
, 
block
, 
pcifunc
, 
¶Ÿ
);

1434 
vÆ
 = ((
u64
)
pcifunc
 << 24Ë| (
¶Ÿ
 << 16) | (1ULL << 13);

1435 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, block->
lookup_ªg
, 
vÆ
);

1438 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, block->
lookup_ªg
) & (1ULL << 13))

1441 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, block->
lookup_ªg
);

1444 i‡(!(
vÆ
 & (1ULL << 12)))

1447  (
vÆ
 & 0xFFF);

1448 
	}
}

1450 
	$rvu_gë_blkaddr_‰om_¶Ÿ
(
rvu
 *rvu, 
blkty≥
, 
u16
 
pcifunc
,

1451 
u16
 
globÆ_¶Ÿ
, u16 *
¶Ÿ_ö_block
)

1453 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1454 
numlfs
, 
tŸÆ_lfs
 = 0, 
ƒ_blocks
 = 0;

1455 
i
, 
num_blkaddr
[
BLK_COUNT
] = { 0 };

1456 
rvu_block
 *
block
;

1457 
blkaddr
 = -
ENODEV
;

1458 
u16
 
°¨t_¶Ÿ
;

1460 i‡(!
	`is_blkty≥_©èched
(
pfvf
, 
blkty≥
))

1461  -
ENODEV
;

1466 
blkaddr
 = 
BLKADDR_RVUM
; blkadd∏< 
BLK_COUNT
; blkaddr++) {

1467 
block
 = &
rvu
->
hw
->block[
blkaddr
];

1468 i‡(
block
->
ty≥
 !
blkty≥
)

1470 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

1473 
numlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
blkaddr
);

1474 i‡(
numlfs
) {

1475 
tŸÆ_lfs
 +
numlfs
;

1476 
num_blkaddr
[
ƒ_blocks
] = 
blkaddr
;

1477 
ƒ_blocks
++;

1481 i‡(
globÆ_¶Ÿ
 >
tŸÆ_lfs
)

1482  -
ENODEV
;

1488 
tŸÆ_lfs
 = 0;

1489 
blkaddr
 = -
ENODEV
;

1490 
i
 = 0; i < 
ƒ_blocks
; i++) {

1491 
numlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
num_blkaddr
[
i
]);

1492 
tŸÆ_lfs
 +
numlfs
;

1493 i‡(
globÆ_¶Ÿ
 < 
tŸÆ_lfs
) {

1494 
blkaddr
 = 
num_blkaddr
[
i
];

1495 
°¨t_¶Ÿ
 = 
tŸÆ_lfs
 - 
numlfs
;

1496 *
¶Ÿ_ö_block
 = 
globÆ_¶Ÿ
 - 
°¨t_¶Ÿ
;

1501  
blkaddr
;

1502 
	}
}

1504 
	$rvu_dëach_block
(
rvu
 *rvu, 
pcifunc
, 
blkty≥
)

1506 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1507 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1508 
rvu_block
 *
block
;

1509 
¶Ÿ
, 
lf
, 
num_lfs
;

1510 
blkaddr
;

1512 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
blkty≥
, 
pcifunc
);

1513 i‡(
blkaddr
 < 0)

1516 i‡(
blkty≥
 =
BLKTYPE_NIX
)

1517 
	`rvu_nix_ª£t_mac
(
pfvf
, 
pcifunc
);

1519 
block
 = &
hw
->block[
blkaddr
];

1521 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

1522 i‡(!
num_lfs
)

1525 
¶Ÿ
 = 0; slŸ < 
num_lfs
; slot++) {

1526 
lf
 = 
	`rvu_lookup_r§c
(
rvu
, 
block
, 
pcifunc
, 
¶Ÿ
);

1527 i‡(
lf
 < 0)

1531 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
block
->
lfcfg_ªg
 |

1532 (
lf
 << 
block
->
lfshi·
), 0x00ULL);

1535 
	`rvu_upd©e_r§c_m≠
(
rvu
, 
pfvf
, 
block
,

1536 
pcifunc
, 
lf
, 
Ál£
);

1539 
	`rvu_‰ì_r§c
(&
block
->
lf
,Üf);

1542 
	`rvu_˛ór_msix_off£t
(
rvu
, 
pfvf
, 
block
, 
lf
);

1544 
	}
}

1546 
	$rvu_dëach_r§cs
(
rvu
 *rvu, 
r§c_dëach
 *
dëach
,

1547 
u16
 
pcifunc
)

1549 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1550 
boﬁ
 
dëach_Æl
 = 
åue
;

1551 
rvu_block
 *
block
;

1552 
blkid
;

1554 
	`muãx_lock
(&
rvu
->
r§c_lock
);

1557 i‡(
dëach
 && dëach->
∑πül
)

1558 
dëach_Æl
 = 
Ál£
;

1563 
blkid
 = 0; blkid < 
BLK_COUNT
; blkid++) {

1564 
block
 = &
hw
->block[
blkid
];

1565 i‡(!
block
->
lf
.
bm≠
)

1567 i‡(!
dëach_Æl
 && 
dëach
) {

1568 i‡(
blkid
 =
BLKADDR_NPA
 && !
dëach
->
≈Æf
)

1570 i‡((
blkid
 =
BLKADDR_NIX0
Ë&& !
dëach
->
nixlf
)

1572 i‡((
blkid
 =
BLKADDR_NIX1
Ë&& !
dëach
->
nixlf
)

1574 i‡((
blkid
 =
BLKADDR_SSO
Ë&& !
dëach
->
sso
)

1576 i‡((
blkid
 =
BLKADDR_SSOW
Ë&& !
dëach
->
ssow
)

1578 i‡((
blkid
 =
BLKADDR_TIM
Ë&& !
dëach
->
timlfs
)

1580 i‡((
blkid
 =
BLKADDR_CPT0
Ë&& !
dëach
->
˝éfs
)

1582 i‡((
blkid
 =
BLKADDR_CPT1
Ë&& !
dëach
->
˝éfs
)

1584 i‡((
blkid
 =
BLKADDR_REE0
Ë&& !
dëach
->
ªñfs
)

1586 i‡((
blkid
 =
BLKADDR_REE1
Ë&& !
dëach
->
ªñfs
)

1589 
	`rvu_dëach_block
(
rvu
, 
pcifunc
, 
block
->
ty≥
);

1592 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

1594 
	}
}

1596 
	$rvu_mbox_h™dÀr_dëach_ªsour˚s
(
rvu
 *rvu,

1597 
r§c_dëach
 *
dëach
,

1598 
msg_r•
 *
r•
)

1600  
	`rvu_dëach_r§cs
(
rvu
, 
dëach
, dëach->
hdr
.
pcifunc
);

1601 
	}
}

1603 
	$rvu_gë_nix_blkaddr
(
rvu
 *rvu, 
u16
 
pcifunc
)

1605 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1606 
blkaddr
 = 
BLKADDR_NIX0
, 
vf
;

1607 
rvu_pfvf
 *
pf
;

1609 
pf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
);

1612 i‡(
	`is_pf_cgxm≠≥d
(
rvu
, 
	`rvu_gë_pf
(
pcifunc
))) {

1613 
blkaddr
 = 
pf
->
nix_blkaddr
;

1614 } i‡(
	`is_afvf
(
pcifunc
)) {

1615 
vf
 = 
pcifunc
 - 1;

1619 
blkaddr
 = (
vf
 & 1Ë? 
BLKADDR_NIX1
 : 
BLKADDR_NIX0
;

1621 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_NIX1
))

1622 
blkaddr
 = 
BLKADDR_NIX0
;

1626 i‡(
	`is_sdp_pfvf
(
pcifunc
Ë&& 
pf
->
sdp_öfo
->
node_id
 == 1)

1627 
blkaddr
 = 
BLKADDR_NIX1
;

1629 
blkaddr
) {

1630 
BLKADDR_NIX1
:

1631 
pfvf
->
nix_blkaddr
 = 
BLKADDR_NIX1
;

1632 
pfvf
->
nix_rx_ötf
 = 
	`NIX_INTFX_RX
(1);

1633 
pfvf
->
nix_tx_ötf
 = 
	`NIX_INTFX_TX
(1);

1635 
BLKADDR_NIX0
:

1637 
pfvf
->
nix_blkaddr
 = 
BLKADDR_NIX0
;

1638 
pfvf
->
nix_rx_ötf
 = 
	`NIX_INTFX_RX
(0);

1639 
pfvf
->
nix_tx_ötf
 = 
	`NIX_INTFX_TX
(0);

1643  
pfvf
->
nix_blkaddr
;

1644 
	}
}

1646 
	$rvu_gë_©èch_blkaddr
(
rvu
 *rvu, 
blkty≥
,

1647 
u16
 
pcifunc
, 
r§c_©èch
 *
©èch
)

1649 
blkaddr
;

1651 
blkty≥
) {

1652 
BLKTYPE_NIX
:

1653 
blkaddr
 = 
	`rvu_gë_nix_blkaddr
(
rvu
, 
pcifunc
);

1655 
BLKTYPE_CPT
:

1656 i‡(
©èch
->
hdr
.
vî
 < 
RVU_MULTI_BLK_VER
)

1657  
	`rvu_gë_blkaddr
(
rvu
, 
blkty≥
, 0);

1658 
blkaddr
 = 
©èch
->
˝t_blkaddr
 ?áttach->cpt_blkaddr :

1659 
BLKADDR_CPT0
;

1660 i‡(
blkaddr
 !
BLKADDR_CPT0
 && blkadd∏!
BLKADDR_CPT1
)

1661  -
ENODEV
;

1663 
BLKTYPE_REE
:

1664 
blkaddr
 = 
©èch
->
ªe_blkaddr
 ?áttach->ree_blkaddr :

1665 
BLKADDR_REE0
;

1666 i‡(
blkaddr
 !
BLKADDR_REE0
 && blkadd∏!
BLKADDR_REE1
)

1667  -
ENODEV
;

1670  
	`rvu_gë_blkaddr
(
rvu
, 
blkty≥
, 0);

1673 i‡(
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

1674  
blkaddr
;

1676  -
ENODEV
;

1677 
	}
}

1679 
	$rvu_©èch_block
(
rvu
 *rvu, 
pcifunc
, 
blkty≥
,

1680 
num_lfs
, 
r§c_©èch
 *
©èch
)

1682 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1683 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1684 
rvu_block
 *
block
;

1685 
¶Ÿ
, 
lf
;

1686 
blkaddr
;

1687 
u64
 
cfg
;

1689 i‡(!
num_lfs
)

1692 
blkaddr
 = 
	`rvu_gë_©èch_blkaddr
(
rvu
, 
blkty≥
, 
pcifunc
, 
©èch
);

1693 i‡(
blkaddr
 < 0)

1696 
block
 = &
hw
->block[
blkaddr
];

1697 i‡(!
block
->
lf
.
bm≠
)

1700 
¶Ÿ
 = 0; slŸ < 
num_lfs
; slot++) {

1702 
lf
 = 
	`rvu_Æloc_r§c
(&
block
->lf);

1703 i‡(
lf
 < 0)

1706 
cfg
 = (1ULL << 63Ë| (
pcifunc
 << 8Ë| 
¶Ÿ
;

1707 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
block
->
lfcfg_ªg
 |

1708 (
lf
 << 
block
->
lfshi·
), 
cfg
);

1709 
	`rvu_upd©e_r§c_m≠
(
rvu
, 
pfvf
, 
block
,

1710 
pcifunc
, 
lf
, 
åue
);

1713 
	`rvu_£t_msix_off£t
(
rvu
, 
pfvf
, 
block
, 
lf
);

1715 
	}
}

1717 
	$rvu_check_r§c_avaûabûôy
(
rvu
 *rvu,

1718 
r§c_©èch
 *
ªq
, 
u16
 
pcifunc
)

1720 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1721 
‰ì_lfs
, 
m≠≥dlfs
, 
blkaddr
;

1722 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1723 
rvu_block
 *
block
;

1724 
ªt
;

1726 
ªt
 = 
	`rvu_check_r§c_pﬁicy
(
rvu
, 
ªq
, 
pcifunc
);

1727 i‡(
ªt
) {

1728 
	`dev_îr
(
rvu
->
dev
, "Func 0x%x: ResourceÖolicy check failed\n",

1729 
pcifunc
);

1730  
ªt
;

1734 i‡(
ªq
->
≈Æf
 && !
	`is_blkty≥_©èched
(
pfvf
, 
BLKTYPE_NPA
)) {

1735 
block
 = &
hw
->block[
BLKADDR_NPA
];

1736 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

1737 i‡(!
‰ì_lfs
)

1738 
Áû
;

1739 } i‡(
ªq
->
≈Æf
) {

1740 
	`dev_îr
(&
rvu
->
pdev
->
dev
,

1742 
pcifunc
);

1743  -
EINVAL
;

1747 i‡(
ªq
->
nixlf
 && !
	`is_blkty≥_©èched
(
pfvf
, 
BLKTYPE_NIX
)) {

1748 
blkaddr
 = 
	`rvu_gë_©èch_blkaddr
(
rvu
, 
BLKTYPE_NIX
,

1749 
pcifunc
, 
ªq
);

1750 i‡(
blkaddr
 < 0)

1751  
blkaddr
;

1752 
block
 = &
hw
->block[
blkaddr
];

1753 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

1754 i‡(!
‰ì_lfs
)

1755 
Áû
;

1756 } i‡(
ªq
->
nixlf
) {

1757 
	`dev_îr
(&
rvu
->
pdev
->
dev
,

1759 
pcifunc
);

1760  -
EINVAL
;

1763 i‡(
ªq
->
sso
) {

1764 
block
 = &
hw
->block[
BLKADDR_SSO
];

1766 i‡(
ªq
->
sso
 > 
block
->
lf
.
max
) {

1767 
	`dev_îr
(&
rvu
->
pdev
->
dev
,

1769 
pcifunc
, 
ªq
->
sso
, 
block
->
lf
.
max
);

1770  -
EINVAL
;

1772 
m≠≥dlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

1773 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

1775 i‡(
ªq
->
sso
 > 
m≠≥dlfs
 &&

1776 ((
ªq
->
sso
 - 
m≠≥dlfs
Ë> 
‰ì_lfs
))

1777 
Áû
;

1780 i‡(
ªq
->
ssow
) {

1781 
block
 = &
hw
->block[
BLKADDR_SSOW
];

1782 i‡(
ªq
->
ssow
 > 
block
->
lf
.
max
) {

1783 
	`dev_îr
(&
rvu
->
pdev
->
dev
,

1785 
pcifunc
, 
ªq
->
sso
, 
block
->
lf
.
max
);

1786  -
EINVAL
;

1788 
m≠≥dlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

1789 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

1790 i‡(
ªq
->
ssow
 > 
m≠≥dlfs
 &&

1791 ((
ªq
->
ssow
 - 
m≠≥dlfs
Ë> 
‰ì_lfs
))

1792 
Áû
;

1795 i‡(
ªq
->
timlfs
) {

1796 
block
 = &
hw
->block[
BLKADDR_TIM
];

1797 i‡(
ªq
->
timlfs
 > 
block
->
lf
.
max
) {

1798 
	`dev_îr
(&
rvu
->
pdev
->
dev
,

1800 
pcifunc
, 
ªq
->
timlfs
, 
block
->
lf
.
max
);

1801  -
EINVAL
;

1803 
m≠≥dlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

1804 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

1805 i‡(
ªq
->
timlfs
 > 
m≠≥dlfs
 &&

1806 ((
ªq
->
timlfs
 - 
m≠≥dlfs
Ë> 
‰ì_lfs
))

1807 
Áû
;

1810 i‡(
ªq
->
˝éfs
) {

1811 
blkaddr
 = 
	`rvu_gë_©èch_blkaddr
(
rvu
, 
BLKTYPE_CPT
,

1812 
pcifunc
, 
ªq
);

1813 i‡(
blkaddr
 < 0)

1814  
blkaddr
;

1815 
block
 = &
hw
->block[
blkaddr
];

1816 i‡(
ªq
->
˝éfs
 > 
block
->
lf
.
max
) {

1817 
	`dev_îr
(&
rvu
->
pdev
->
dev
,

1819 
pcifunc
, 
ªq
->
˝éfs
, 
block
->
lf
.
max
);

1820  -
EINVAL
;

1822 
m≠≥dlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

1823 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

1824 i‡(
ªq
->
˝éfs
 > 
m≠≥dlfs
 &&

1825 ((
ªq
->
˝éfs
 - 
m≠≥dlfs
Ë> 
‰ì_lfs
))

1826 
Áû
;

1829 i‡(
ªq
->
hdr
.
vî
 >
RVU_MULTI_BLK_VER
 &&Ñeq->
ªñfs
) {

1830 
blkaddr
 = 
	`rvu_gë_©èch_blkaddr
(
rvu
, 
BLKTYPE_REE
,

1831 
pcifunc
, 
ªq
);

1832 i‡(
blkaddr
 < 0)

1833  
blkaddr
;

1834 
block
 = &
hw
->block[
blkaddr
];

1835 i‡(
ªq
->
ªñfs
 > 
block
->
lf
.
max
) {

1836 
	`dev_îr
(&
rvu
->
pdev
->
dev
,

1838 
pcifunc
, 
ªq
->
ªñfs
, 
block
->
lf
.
max
);

1839  -
EINVAL
;

1841 
m≠≥dlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

1842 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

1843 i‡(
ªq
->
ªñfs
 > 
m≠≥dlfs
 &&

1844 ((
ªq
->
ªñfs
 - 
m≠≥dlfs
Ë> 
‰ì_lfs
))

1845 
Áû
;

1850 
Áû
:

1851 
	`dev_öfo
(
rvu
->
dev
, "Reque° f‹ %†Áûed\n", 
block
->
«me
);

1852  -
ENOSPC
;

1853 
	}
}

1855 
boﬁ
 
	$rvu_©èch_‰om_ßme_block
(
rvu
 *rvu, 
blkty≥
,

1856 
r§c_©èch
 *
©èch
)

1858 
blkaddr
, 
num_lfs
;

1860 
blkaddr
 = 
	`rvu_gë_©èch_blkaddr
(
rvu
, 
blkty≥
,

1861 
©èch
->
hdr
.
pcifunc
,áttach);

1862 i‡(
blkaddr
 < 0)

1863  
Ál£
;

1865 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
	`rvu_gë_pfvf
(
rvu
, 
©èch
->
hdr
.
pcifunc
),

1866 
blkaddr
);

1868  !!
num_lfs
;

1869 
	}
}

1871 
	$rvu_mbox_h™dÀr_©èch_ªsour˚s
(
rvu
 *rvu,

1872 
r§c_©èch
 *
©èch
,

1873 
msg_r•
 *
r•
)

1875 
u16
 
pcifunc
 = 
©èch
->
hdr
.pcifunc;

1876 
îr
;

1879 i‡(!
©èch
->
modify
)

1880 
	`rvu_dëach_r§cs
(
rvu
, 
NULL
, 
pcifunc
);

1882 
	`muãx_lock
(&
rvu
->
r§c_lock
);

1885 
îr
 = 
	`rvu_check_r§c_avaûabûôy
(
rvu
, 
©èch
, 
pcifunc
);

1886 i‡(
îr
)

1887 
exô
;

1890 i‡(
©èch
->
nixlf
)

1891 
	`rvu_©èch_block
(
rvu
, 
pcifunc
, 
BLKTYPE_NIX
, 1, 
©èch
);

1893 i‡(
©èch
->
≈Æf
)

1894 
	`rvu_©èch_block
(
rvu
, 
pcifunc
, 
BLKTYPE_NPA
, 1, 
©èch
);

1896 i‡(
©èch
->
sso
) {

1902 i‡(
©èch
->
modify
)

1903 
	`rvu_dëach_block
(
rvu
, 
pcifunc
, 
BLKTYPE_SSO
);

1904 
	`rvu_©èch_block
(
rvu
, 
pcifunc
, 
BLKTYPE_SSO
,

1905 
©èch
->
sso
,áttach);

1908 i‡(
©èch
->
ssow
) {

1909 i‡(
©èch
->
modify
)

1910 
	`rvu_dëach_block
(
rvu
, 
pcifunc
, 
BLKTYPE_SSOW
);

1911 
	`rvu_©èch_block
(
rvu
, 
pcifunc
, 
BLKTYPE_SSOW
,

1912 
©èch
->
ssow
,áttach);

1915 i‡(
©èch
->
timlfs
) {

1916 i‡(
©èch
->
modify
)

1917 
	`rvu_dëach_block
(
rvu
, 
pcifunc
, 
BLKTYPE_TIM
);

1918 
	`rvu_©èch_block
(
rvu
, 
pcifunc
, 
BLKTYPE_TIM
,

1919 
©èch
->
timlfs
,áttach);

1922 i‡(
©èch
->
˝éfs
) {

1923 i‡(
©èch
->
modify
 &&

1924 
	`rvu_©èch_‰om_ßme_block
(
rvu
, 
BLKTYPE_CPT
, 
©èch
))

1925 
	`rvu_dëach_block
(
rvu
, 
pcifunc
, 
BLKTYPE_CPT
);

1926 
	`rvu_©èch_block
(
rvu
, 
pcifunc
, 
BLKTYPE_CPT
,

1927 
©èch
->
˝éfs
,áttach);

1930 i‡(
©èch
->
hdr
.
vî
 >
RVU_MULTI_BLK_VER
 &&áâach->
ªñfs
) {

1931 i‡(
©èch
->
modify
 &&

1932 
	`rvu_©èch_‰om_ßme_block
(
rvu
, 
BLKTYPE_REE
, 
©èch
))

1933 
	`rvu_dëach_block
(
rvu
, 
pcifunc
, 
BLKTYPE_REE
);

1934 
	`rvu_©èch_block
(
rvu
, 
pcifunc
, 
BLKTYPE_REE
,

1935 
©èch
->
ªñfs
,áttach);

1938 
exô
:

1939 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

1940  
îr
;

1941 
	}
}

1943 
u16
 
	$rvu_gë_msix_off£t
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
,

1944 
blkaddr
, 
lf
)

1946 
u16
 
vec
;

1948 i‡(
lf
 < 0)

1949  
MSIX_VECTOR_INVALID
;

1951 
vec
 = 0; ve¯< 
pfvf
->
msix
.
max
; vec++) {

1952 i‡(
pfvf
->
msix_lfm≠
[
vec
] =
	`MSIX_BLKLF
(
blkaddr
, 
lf
))

1953  
vec
;

1955  
MSIX_VECTOR_INVALID
;

1956 
	}
}

1958 
	$rvu_£t_msix_off£t
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
,

1959 
rvu_block
 *
block
, 
lf
)

1961 
u16
 
nvecs
, 
vec
, 
off£t
;

1962 
u64
 
cfg
;

1964 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, block->
msixcfg_ªg
 |

1965 (
lf
 << 
block
->
lfshi·
));

1966 
nvecs
 = (
cfg
 >> 12) & 0xFF;

1969 i‡(!
	`rvu_r§c_check_c⁄tig
(&
pfvf
->
msix
, 
nvecs
))

1972 
off£t
 = 
	`rvu_Æloc_r§c_c⁄tig
(&
pfvf
->
msix
, 
nvecs
);

1975 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, block->
msixcfg_ªg
 |

1976 (
lf
 << 
block
->
lfshi·
), (
cfg
 & ~0x7FFULLË| 
off£t
);

1979 
vec
 = 0; ve¯< 
nvecs
; vec++)

1980 
pfvf
->
msix_lfm≠
[
off£t
 + 
vec
] = 
	`MSIX_BLKLF
(
block
->
addr
, 
lf
);

1981 
	}
}

1983 
	$rvu_˛ór_msix_off£t
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
,

1984 
rvu_block
 *
block
, 
lf
)

1986 
u16
 
nvecs
, 
vec
, 
off£t
;

1987 
u64
 
cfg
;

1989 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, block->
msixcfg_ªg
 |

1990 (
lf
 << 
block
->
lfshi·
));

1991 
nvecs
 = (
cfg
 >> 12) & 0xFF;

1994 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, block->
msixcfg_ªg
 |

1995 (
lf
 << 
block
->
lfshi·
), 
cfg
 & ~0x7FFULL);

1997 
off£t
 = 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
block
->
addr
, 
lf
);

1998 i‡(
off£t
 =
MSIX_VECTOR_INVALID
)

2002 
vec
 = 0; ve¯< 
nvecs
; vec++)

2003 
pfvf
->
msix_lfm≠
[
off£t
 + 
vec
] = 0;

2006 
	`rvu_‰ì_r§c_c⁄tig
(&
pfvf
->
msix
, 
nvecs
, 
off£t
);

2007 
	}
}

2009 
	$rvu_mbox_h™dÀr_msix_off£t
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

2010 
msix_off£t_r•
 *
r•
)

2012 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2013 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2014 
rvu_pfvf
 *
pfvf
;

2015 
lf
, 
¶Ÿ
, 
blkaddr
;

2017 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

2018 i‡(!
pfvf
->
msix
.
bm≠
)

2022 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
BLKADDR_NPA
], 
pcifunc
, 0);

2023 
r•
->
≈a_msixoff
 = 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
BLKADDR_NPA
, 
lf
);

2026 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

2027 i‡(
blkaddr
 < 0) {

2028 
r•
->
nix_msixoff
 = 
MSIX_VECTOR_INVALID
;

2030 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

2031 
r•
->
nix_msixoff
 = 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
blkaddr
, 
lf
);

2034 
r•
->
sso
 = 
pfvf
->sso;

2035 
¶Ÿ
 = 0; slŸ < 
r•
->
sso
; slot++) {

2036 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
BLKADDR_SSO
], 
pcifunc
, 
¶Ÿ
);

2037 
r•
->
sso_msixoff
[
¶Ÿ
] =

2038 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
BLKADDR_SSO
, 
lf
);

2041 
r•
->
ssow
 = 
pfvf
->ssow;

2042 
¶Ÿ
 = 0; slŸ < 
r•
->
ssow
; slot++) {

2043 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
BLKADDR_SSOW
], 
pcifunc
, 
¶Ÿ
);

2044 
r•
->
ssow_msixoff
[
¶Ÿ
] =

2045 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
BLKADDR_SSOW
, 
lf
);

2048 
r•
->
timlfs
 = 
pfvf
->timlfs;

2049 
¶Ÿ
 = 0; slŸ < 
r•
->
timlfs
; slot++) {

2050 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
BLKADDR_TIM
], 
pcifunc
, 
¶Ÿ
);

2051 
r•
->
timlf_msixoff
[
¶Ÿ
] =

2052 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
BLKADDR_TIM
, 
lf
);

2055 
r•
->
˝éfs
 = 
pfvf
->cptlfs;

2056 
¶Ÿ
 = 0; slŸ < 
r•
->
˝éfs
; slot++) {

2057 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
BLKADDR_CPT0
], 
pcifunc
, 
¶Ÿ
);

2058 
r•
->
˝éf_msixoff
[
¶Ÿ
] =

2059 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
BLKADDR_CPT0
, 
lf
);

2062 
r•
->
˝t1_lfs
 = 
pfvf
->cpt1_lfs;

2063 
¶Ÿ
 = 0; slŸ < 
r•
->
˝t1_lfs
; slot++) {

2064 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
BLKADDR_CPT1
], 
pcifunc
, 
¶Ÿ
);

2065 
r•
->
˝t1_lf_msixoff
[
¶Ÿ
] =

2066 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
BLKADDR_CPT1
, 
lf
);

2069 
r•
->
ªe0_lfs
 = 
pfvf
->ree0_lfs;

2070 
¶Ÿ
 = 0; slŸ < 
r•
->
ªe0_lfs
; slot++) {

2071 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
BLKADDR_REE0
], 
pcifunc
, 
¶Ÿ
);

2072 
r•
->
ªe0_lf_msixoff
[
¶Ÿ
] =

2073 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
BLKADDR_REE0
, 
lf
);

2076 
r•
->
ªe1_lfs
 = 
pfvf
->ree1_lfs;

2077 
¶Ÿ
 = 0; slŸ < 
r•
->
ªe1_lfs
; slot++) {

2078 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
BLKADDR_REE1
], 
pcifunc
, 
¶Ÿ
);

2079 
r•
->
ªe1_lf_msixoff
[
¶Ÿ
] =

2080 
	`rvu_gë_msix_off£t
(
rvu
, 
pfvf
, 
BLKADDR_REE1
, 
lf
);

2084 
	}
}

2086 
	$rvu_mbox_h™dÀr_vf_Êr
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

2087 
msg_r•
 *
r•
)

2089 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2090 
u16
 
vf
, 
numvfs
;

2091 
u64
 
cfg
;

2093 
vf
 = 
pcifunc
 & 
RVU_PFVF_FUNC_MASK
;

2094 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
,

2095 
	`RVU_PRIV_PFX_CFG
(
	`rvu_gë_pf
(
pcifunc
)));

2096 
numvfs
 = (
cfg
 >> 12) & 0xFF;

2098 i‡(
vf
 && v‡<
numvfs
)

2099 
	`__rvu_Êr_h™dÀr
(
rvu
, 
pcifunc
);

2101  
RVU_INVALID_VF_ID
;

2104 
	}
}

2106 
	$rvu_ndc_sync
(
rvu
 *rvu, 
lfblkaddr
, 
lfidx
, 
u64
 
lfoff£t
)

2109 
	`rvu_wrôe64
(
rvu
, 
lfblkaddr
, 
lfoff£t
, 
	`BIT_ULL
(12Ë| 
lfidx
);

2110  
	`rvu_pﬁl_ªg
(
rvu
, 
lfblkaddr
, 
lfoff£t
, 
	`BIT_ULL
(12), 
åue
);

2111 
	}
}

2113 
	$rvu_mbox_h™dÀr_gë_hw_ˇp
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

2114 
gë_hw_ˇp_r•
 *
r•
)

2116 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2118 
r•
->
nix_fixed_txschq_m≠pög
 = 
hw
->
ˇp
.nix_fixed_txschq_mapping;

2119 
r•
->
nix_sh≠ög
 = 
hw
->
ˇp
.nix_shaping;

2120 
r•
->
≈c_hash_exåa˘
 = 
hw
->
ˇp
.npc_hash_extract;

2123 
	}
}

2125 
	$rvu_mbox_h™dÀr_ndc_sync_›
(
rvu
 *rvu,

2126 
ndc_sync_›
 *
ªq
,

2127 
msg_r•
 *
r•
)

2129 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2130 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2131 
îr
, 
lfidx
, 
lfblkaddr
;

2133 i‡(
ªq
->
≈a_lf_sync
) {

2135 
lfblkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 
pcifunc
);

2136 i‡(
lfblkaddr
 < 0)

2137  
NPA_AF_ERR_AF_LF_INVALID
;

2139 
lfidx
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
lfblkaddr
], 
pcifunc
, 0);

2140 i‡(
lfidx
 < 0)

2141  
NPA_AF_ERR_AF_LF_INVALID
;

2144 
îr
 = 
	`rvu_ndc_sync
(
rvu
, 
lfblkaddr
,

2145 
lfidx
, 
NPA_AF_NDC_SYNC
);

2146 i‡(
îr
)

2147 
	`dev_îr
(
rvu
->
dev
,

2148 "NDC-NPA syn¯Áûed f‹ LF %u\n", 
lfidx
);

2151 i‡(!
ªq
->
nix_lf_tx_sync
 && !ªq->
nix_lf_rx_sync
)

2155 
lfblkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

2156 i‡(
lfblkaddr
 < 0)

2157  
NIX_AF_ERR_AF_LF_INVALID
;

2159 
lfidx
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
lfblkaddr
], 
pcifunc
, 0);

2160 i‡(
lfidx
 < 0)

2161  
NIX_AF_ERR_AF_LF_INVALID
;

2163 i‡(
ªq
->
nix_lf_tx_sync
) {

2165 
îr
 = 
	`rvu_ndc_sync
(
rvu
, 
lfblkaddr
,

2166 
lfidx
, 
NIX_AF_NDC_TX_SYNC
);

2167 i‡(
îr
)

2168 
	`dev_îr
(
rvu
->
dev
,

2169 "NDC-NIX-TX syn¯Áû f‹ LF %u\n", 
lfidx
);

2172 i‡(
ªq
->
nix_lf_rx_sync
) {

2174 
îr
 = 
	`rvu_ndc_sync
(
rvu
, 
lfblkaddr
,

2175 
lfidx
, 
NIX_AF_NDC_RX_SYNC
);

2176 i‡(
îr
)

2177 
	`dev_îr
(
rvu
->
dev
,

2178 "NDC-NIX-RX syn¯Áûed f‹ LF %u\n", 
lfidx
);

2182 
	}
}

2184 
	$rvu_mbox_h™dÀr_£t_vf_≥rm
(
rvu
 *rvu, 
£t_vf_≥rm
 *
ªq
,

2185 
msg_r•
 *
r•
)

2187 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2188 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2189 
rvu_pfvf
 *
pfvf
;

2190 
blkaddr
, 
nixlf
;

2191 
u16
 
èrgë
;

2194 i‡((
pcifunc
 & 
RVU_PFVF_FUNC_MASK
Ë|| 
	`is_afvf
(pcifunc))

2195  -
EOPNOTSUPP
;

2197 
èrgë
 = (
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
Ë| (
ªq
->
vf
 + 1);

2198 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
èrgë
);

2200 i‡(
ªq
->
Êags
 & 
RESET_VF_PERM
) {

2201 
pfvf
->
Êags
 &
RVU_CLEAR_VF_PERM
;

2202 } i‡(
	`ã°_bô
(
PF_SET_VF_TRUSTED
, &
pfvf
->
Êags
) ^

2203 (
ªq
->
Êags
 & 
VF_TRUSTED
)) {

2204 
	`ch™ge_bô
(
PF_SET_VF_TRUSTED
, &
pfvf
->
Êags
);

2206 i‡(!
	`ã°_bô
(
PF_SET_VF_TRUSTED
, &
pfvf
->
Êags
)) {

2207 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
èrgë
);

2208 i‡(
blkaddr
 < 0)

2210 
nixlf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
],

2211 
èrgë
, 0);

2212 i‡(
nixlf
 < 0)

2214 
	`≈c_íadis_deÁu…_m˚_íåy
(
rvu
, 
èrgë
, 
nixlf
,

2215 
NIXLF_ALLMULTI_ENTRY
,

2216 
Ál£
);

2217 
	`≈c_íadis_deÁu…_m˚_íåy
(
rvu
, 
èrgë
, 
nixlf
,

2218 
NIXLF_PROMISC_ENTRY
,

2219 
Ál£
);

2224 
	}
}

2226 
	$rvu_¥o˚ss_mbox_msg
(
Ÿx2_mbox
 *
mbox
, 
devid
,

2227 
mbox_msghdr
 *
ªq
)

2229 
rvu
 *rvu = 
	`pci_gë_drvd©a
(
mbox
->
pdev
);

2232 i‡(
ªq
->
sig
 !
OTX2_MBOX_REQ_SIG
)

2233 
bad_mesßge
;

2235 
ªq
->
id
) {

2236 
	#M
(
_«me
, 
_id
, 
_‚_«me
, 
_ªq_ty≥
, 
_r•_ty≥
) \

2237 
_id
: { \

2238 
_r•_ty≥
 *
r•
; \

2239 
îr
; \

2241 
r•
 = (
_r•_ty≥
 *)
	`Ÿx2_mbox_Æloc_msg
( \

2242 
mbox
, 
devid
, \

2243 (
_r•_ty≥
)); \

2246 i‡(!
r•
 && \

2247 
_id
 !
MBOX_MSG_DETACH_RESOURCES
 && \

2248 
_id
 !
MBOX_MSG_NIX_TXSCH_FREE
 && \

2249 
_id
 !
MBOX_MSG_VF_FLR
) \

2250  -
ENOMEM
; \

2251 i‡(
r•
) { \

2252 
r•
->
hdr
.
id
 = 
_id
; \

2253 
r•
->
hdr
.
sig
 = 
OTX2_MBOX_RSP_SIG
; \

2254 
r•
->
hdr
.
pcifunc
 = 
ªq
->pcifunc; \

2255 
r•
->
hdr
.
rc
 = 0; \

2258 
îr
 = 
rvu_mbox_h™dÀr_
 ## 
	`_‚_«me
(
rvu
, \

2259 (
_ªq_ty≥
 *)
ªq
, \

2260 
r•
); \

2261 i‡(
r•
 && 
îr
) \

2262 
r•
->
hdr
.
rc
 = 
îr
; \

2264 
	`åa˚_Ÿx2_msg_¥o˚ss
(
mbox
->
pdev
, 
_id
, 
îr
); \

2265  
r•
 ? 
îr
 : -
ENOMEM
; \

2266 }

	)

2267 
MBOX_MESSAGES


2268 
MBOX_MCS_FIPS_MESSAGES


2269 #unde‡
M


2271 
bad_mesßge
:

2273 
	`Ÿx2_ª∂y_övÆid_msg
(
mbox
, 
devid
, 
ªq
->
pcifunc
,Ñeq->
id
);

2274  -
ENODEV
;

2276 
	}
}

2278 
	$__rvu_mbox_h™dÀr
(
rvu_w‹k
 *
mw‹k
, 
ty≥
)

2280 
rvu
 *rvu = 
mw‹k
->rvu;

2281 
off£t
, 
îr
, 
id
, 
devid
;

2282 
Ÿx2_mbox_dev
 *
mdev
;

2283 
mbox_hdr
 *
ªq_hdr
;

2284 
mbox_msghdr
 *
msg
;

2285 
mbox_wq_öfo
 *
mw
;

2286 
Ÿx2_mbox
 *
mbox
;

2288 
ty≥
) {

2289 
TYPE_AFPF
:

2290 
mw
 = &
rvu
->
aÂf_wq_öfo
;

2292 
TYPE_AFVF
:

2293 
mw
 = &
rvu
->
afvf_wq_öfo
;

2299 
devid
 = 
mw‹k
 - 
mw
->
mbox_wrk
;

2300 
mbox
 = &
mw
->mbox;

2301 
mdev
 = &
mbox
->
dev
[
devid
];

2304 
ªq_hdr
 = 
mdev
->
mba£
 + 
mbox
->
rx_°¨t
;

2305 i‡(
mw
->
mbox_wrk
[
devid
].
num_msgs
 == 0)

2308 
off£t
 = 
mbox
->
rx_°¨t
 + 
	`ALIGN
((*
ªq_hdr
), 
MBOX_MSG_ALIGN
);

2310 
id
 = 0; id < 
mw
->
mbox_wrk
[
devid
].
num_msgs
; id++) {

2311 
msg
 = 
mdev
->
mba£
 + 
off£t
;

2314 
ty≥
) {

2315 
TYPE_AFPF
:

2316 
msg
->
pcifunc
 &=

2317 ~(
RVU_PFVF_PF_MASK
 << 
RVU_PFVF_PF_SHIFT
);

2318 
msg
->
pcifunc
 |(
devid
 << 
RVU_PFVF_PF_SHIFT
);

2320 
TYPE_AFVF
:

2321 
msg
->
pcifunc
 &=

2322 ~(
RVU_PFVF_FUNC_MASK
 << 
RVU_PFVF_FUNC_SHIFT
);

2323 
msg
->
pcifunc
 |(
devid
 << 
RVU_PFVF_FUNC_SHIFT
) + 1;

2327 
îr
 = 
	`rvu_¥o˚ss_mbox_msg
(
mbox
, 
devid
, 
msg
);

2328 i‡(!
îr
) {

2329 
off£t
 = 
mbox
->
rx_°¨t
 + 
msg
->
√xt_msgoff
;

2333 i‡(
msg
->
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)

2334 
	`dev_w¨n
(
rvu
->
dev
, "Error %d whenÖrocessing message %s (0x%x) from PF%d:VF%d\n",

2335 
îr
, 
	`Ÿx2_mbox_id2«me
(
msg
->
id
),

2336 
msg
->
id
, 
	`rvu_gë_pf
(msg->
pcifunc
),

2337 (
msg
->
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) - 1);

2339 
	`dev_w¨n
(
rvu
->
dev
, "Error %d whenÖrocessing message %s (0x%x) from PF%d\n",

2340 
îr
, 
	`Ÿx2_mbox_id2«me
(
msg
->
id
),

2341 
msg
->
id
, 
devid
);

2343 
mw
->
mbox_wrk
[
devid
].
num_msgs
 = 0;

2346 
	`Ÿx2_mbox_msg_£nd
(
mbox
, 
devid
);

2347 
	}
}

2349 
ölöe
 
	$rvu_aÂf_mbox_h™dÀr
(
w‹k_°ru˘
 *
w‹k
)

2351 
rvu_w‹k
 *
mw‹k
 = 
	`c⁄èöî_of
(
w‹k
, rvu_work, work);

2353 
	`__rvu_mbox_h™dÀr
(
mw‹k
, 
TYPE_AFPF
);

2354 
	}
}

2356 
ölöe
 
	$rvu_afvf_mbox_h™dÀr
(
w‹k_°ru˘
 *
w‹k
)

2358 
rvu_w‹k
 *
mw‹k
 = 
	`c⁄èöî_of
(
w‹k
, rvu_work, work);

2360 
	`__rvu_mbox_h™dÀr
(
mw‹k
, 
TYPE_AFVF
);

2361 
	}
}

2363 
	$__rvu_mbox_up_h™dÀr
(
rvu_w‹k
 *
mw‹k
, 
ty≥
)

2365 
rvu
 *rvu = 
mw‹k
->rvu;

2366 
Ÿx2_mbox_dev
 *
mdev
;

2367 
mbox_hdr
 *
r•_hdr
;

2368 
mbox_msghdr
 *
msg
;

2369 
mbox_wq_öfo
 *
mw
;

2370 
Ÿx2_mbox
 *
mbox
;

2371 
off£t
, 
id
, 
devid
;

2373 
ty≥
) {

2374 
TYPE_AFPF
:

2375 
mw
 = &
rvu
->
aÂf_wq_öfo
;

2377 
TYPE_AFVF
:

2378 
mw
 = &
rvu
->
afvf_wq_öfo
;

2384 
devid
 = 
mw‹k
 - 
mw
->
mbox_wrk_up
;

2385 
mbox
 = &
mw
->
mbox_up
;

2386 
mdev
 = &
mbox
->
dev
[
devid
];

2388 
r•_hdr
 = 
mdev
->
mba£
 + 
mbox
->
rx_°¨t
;

2389 i‡(
mw
->
mbox_wrk_up
[
devid
].
up_num_msgs
 == 0) {

2390 
	`dev_w¨n
(
rvu
->
dev
, "mbox up handler:Çum_msgs = 0\n");

2394 
off£t
 = 
mbox
->
rx_°¨t
 + 
	`ALIGN
((*
r•_hdr
), 
MBOX_MSG_ALIGN
);

2396 
id
 = 0; id < 
mw
->
mbox_wrk_up
[
devid
].
up_num_msgs
; id++) {

2397 
msg
 = 
mdev
->
mba£
 + 
off£t
;

2399 i‡(
msg
->
id
 >
MBOX_MSG_MAX
) {

2400 
	`dev_îr
(
rvu
->
dev
,

2401 "Mbox msg wôh unknow¿ID 0x%x\n", 
msg
->
id
);

2402 
íd
;

2405 i‡(
msg
->
sig
 !
OTX2_MBOX_RSP_SIG
) {

2406 
	`dev_îr
(
rvu
->
dev
,

2408 
msg
->
sig
, msg->
id
);

2409 
íd
;

2412 
msg
->
id
) {

2413 
MBOX_MSG_CGX_LINK_EVENT
:

2416 i‡(
msg
->
rc
)

2417 
	`dev_îr
(
rvu
->
dev
,

2419 
msg
->
rc
, msg->
id
);

2422 
íd
:

2423 
off£t
 = 
mbox
->
rx_°¨t
 + 
msg
->
√xt_msgoff
;

2424 
mdev
->
msgs_acked
++;

2426 
mw
->
mbox_wrk_up
[
devid
].
up_num_msgs
 = 0;

2428 
	`Ÿx2_mbox_ª£t
(
mbox
, 
devid
);

2429 
	}
}

2431 
ölöe
 
	$rvu_aÂf_mbox_up_h™dÀr
(
w‹k_°ru˘
 *
w‹k
)

2433 
rvu_w‹k
 *
mw‹k
 = 
	`c⁄èöî_of
(
w‹k
, rvu_work, work);

2435 
	`__rvu_mbox_up_h™dÀr
(
mw‹k
, 
TYPE_AFPF
);

2436 
	}
}

2438 
ölöe
 
	$rvu_afvf_mbox_up_h™dÀr
(
w‹k_°ru˘
 *
w‹k
)

2440 
rvu_w‹k
 *
mw‹k
 = 
	`c⁄èöî_of
(
w‹k
, rvu_work, work);

2442 
	`__rvu_mbox_up_h™dÀr
(
mw‹k
, 
TYPE_AFVF
);

2443 
	}
}

2445 
	$rvu_gë_mbox_ªgi⁄s
(
rvu
 *rvu, **
mbox_addr
,

2446 
num
, 
ty≥
, *
pf_bm≠
)

2448 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2449 
ªgi⁄
;

2450 
u64
 
b¨4
;

2456 i‡(
ty≥
 =
TYPE_AFVF
) {

2457 
ªgi⁄
 = 0;Ñegi⁄ < 
num
;Ñegion++) {

2458 i‡(!
	`ã°_bô
(
ªgi⁄
, 
pf_bm≠
))

2461 i‡(
hw
->
ˇp
.
≥r_pf_mbox_ªgs
) {

2462 
b¨4
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
,

2463 
	`RVU_AF_PFX_BAR4_ADDR
(0)) +

2464 
MBOX_SIZE
;

2465 
b¨4
 +
ªgi⁄
 * 
MBOX_SIZE
;

2467 
b¨4
 = 
	`rvupf_ªad64
(
rvu
, 
RVU_PF_VF_BAR4_ADDR
);

2468 
b¨4
 +
ªgi⁄
 * 
MBOX_SIZE
;

2470 
mbox_addr
[
ªgi⁄
] = (*)
	`i‹em≠_wc
(
b¨4
, 
MBOX_SIZE
);

2471 i‡(!
mbox_addr
[
ªgi⁄
])

2472 
îr‹
;

2481 
ªgi⁄
 = 0;Ñegi⁄ < 
num
;Ñegion++) {

2482 i‡(!
	`ã°_bô
(
ªgi⁄
, 
pf_bm≠
))

2485 i‡(
hw
->
ˇp
.
≥r_pf_mbox_ªgs
) {

2486 
b¨4
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
,

2487 
	`RVU_AF_PFX_BAR4_ADDR
(
ªgi⁄
));

2489 
b¨4
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
,

2490 
RVU_AF_PF_BAR4_ADDR
);

2491 
b¨4
 +
ªgi⁄
 * 
MBOX_SIZE
;

2493 
mbox_addr
[
ªgi⁄
] = (*)
	`i‹em≠_wc
(
b¨4
, 
MBOX_SIZE
);

2494 i‡(!
mbox_addr
[
ªgi⁄
])

2495 
îr‹
;

2499 
îr‹
:

2500 
ªgi⁄
--)

2501 
	`iounm≠
((
__iomem
 *)
mbox_addr
[
ªgi⁄
]);

2502  -
ENOMEM
;

2503 
	}
}

2505 
rvu_mbox_öô
(
rvu
 *rvu, 
mbox_wq_öfo
 *
mw
,

2506 
ty≥
, 
num
,

2507 (
mbox_h™dÀr
)(
w‹k_°ru˘
 *),

2508 (
mbox_up_h™dÀr
)(
w‹k_°ru˘
 *))

2510 
îr
 = -
EINVAL
, 
i
, 
dú
, 
dú_up
;

2511 
__iomem
 *
ªg_ba£
;

2512 
rvu_w‹k
 *
mw‹k
;

2513 *
pf_bm≠
;

2514 **
mbox_ªgi⁄s
;

2515 c⁄° *
«me
;

2516 
u64
 
cfg
;

2518 
pf_bm≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
	`BITS_TO_LONGS
(
num
), (), 
GFP_KERNEL
);

2519 i‡(!
pf_bm≠
)

2520  -
ENOMEM
;

2523 i‡(
ty≥
 =
TYPE_AFVF
)

2524 
	`bôm≠_£t
(
pf_bm≠
, 0, 
num
);

2526 i‡(
ty≥
 =
TYPE_AFPF
) {

2528 
i
 = 0; i < 
num
; i++) {

2529 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
i
));

2530 i‡(
cfg
 & 
	`BIT_ULL
(20))

2531 
	`£t_bô
(
i
, 
pf_bm≠
);

2535 
mbox_ªgi⁄s
 = 
	`kˇŒoc
(
num
, (*), 
GFP_KERNEL
);

2536 i‡(!
mbox_ªgi⁄s
)

2537  -
ENOMEM
;

2539 
ty≥
) {

2540 
TYPE_AFPF
:

2541 
«me
 = "rvu_afpf_mailbox";

2542 
dú
 = 
MBOX_DIR_AFPF
;

2543 
dú_up
 = 
MBOX_DIR_AFPF_UP
;

2544 
ªg_ba£
 = 
rvu
->
a‰eg_ba£
;

2545 
îr
 = 
	`rvu_gë_mbox_ªgi⁄s
(
rvu
, 
mbox_ªgi⁄s
, 
num
, 
TYPE_AFPF
, 
pf_bm≠
);

2546 i‡(
îr
)

2547 
‰ì_ªgi⁄s
;

2549 
TYPE_AFVF
:

2550 
«me
 = "rvu_afvf_mailbox";

2551 
dú
 = 
MBOX_DIR_PFVF
;

2552 
dú_up
 = 
MBOX_DIR_PFVF_UP
;

2553 
ªg_ba£
 = 
rvu
->
p‰eg_ba£
;

2554 
îr
 = 
	`rvu_gë_mbox_ªgi⁄s
(
rvu
, 
mbox_ªgi⁄s
, 
num
, 
TYPE_AFVF
, 
pf_bm≠
);

2555 i‡(
îr
)

2556 
‰ì_ªgi⁄s
;

2559  
îr
;

2562 
mw
->
mbox_wq
 = 
	`Æloc_w‹kqueue
(
«me
,

2563 
WQ_UNBOUND
 | 
WQ_HIGHPRI
 | 
WQ_MEM_RECLAIM
,

2564 
num
);

2565 i‡(!
mw
->
mbox_wq
) {

2566 
îr
 = -
ENOMEM
;

2567 
unm≠_ªgi⁄s
;

2570 
mw
->
mbox_wrk
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
num
,

2571 (
rvu_w‹k
), 
GFP_KERNEL
);

2572 i‡(!
mw
->
mbox_wrk
) {

2573 
îr
 = -
ENOMEM
;

2574 
exô
;

2577 
mw
->
mbox_wrk_up
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
num
,

2578 (
rvu_w‹k
), 
GFP_KERNEL
);

2579 i‡(!
mw
->
mbox_wrk_up
) {

2580 
îr
 = -
ENOMEM
;

2581 
exô
;

2584 
îr
 = 
	`Ÿx2_mbox_ªgi⁄s_öô
(&
mw
->
mbox
, 
mbox_ªgi⁄s
, 
rvu
->
pdev
,

2585 
ªg_ba£
, 
dú
, 
num
, 
pf_bm≠
);

2586 i‡(
îr
)

2587 
exô
;

2589 
îr
 = 
	`Ÿx2_mbox_ªgi⁄s_öô
(&
mw
->
mbox_up
, 
mbox_ªgi⁄s
, 
rvu
->
pdev
,

2590 
ªg_ba£
, 
dú_up
, 
num
, 
pf_bm≠
);

2591 i‡(
îr
)

2592 
exô
;

2594 
i
 = 0; i < 
num
; i++) {

2595 i‡(!
	`ã°_bô
(
i
, 
pf_bm≠
))

2598 
mw‹k
 = &
mw
->
mbox_wrk
[
i
];

2599 
mw‹k
->
rvu
 =Ñvu;

2600 
	`INIT_WORK
(&
mw‹k
->
w‹k
, 
mbox_h™dÀr
);

2602 
mw‹k
 = &
mw
->
mbox_wrk_up
[
i
];

2603 
mw‹k
->
rvu
 =Ñvu;

2604 
	`INIT_WORK
(&
mw‹k
->
w‹k
, 
mbox_up_h™dÀr
);

2606 
	`k‰ì
(
mbox_ªgi⁄s
);

2609 
exô
:

2610 
	`de°roy_w‹kqueue
(
mw
->
mbox_wq
);

2611 
unm≠_ªgi⁄s
:

2612 
num
--)

2613 
	`iounm≠
((
__iomem
 *)
mbox_ªgi⁄s
[
num
]);

2614 
‰ì_ªgi⁄s
:

2615 
	`k‰ì
(
mbox_ªgi⁄s
);

2616  
îr
;

2617 
	}
}

2619 
	$rvu_mbox_de°roy
(
mbox_wq_öfo
 *
mw
)

2621 
Ÿx2_mbox
 *
mbox
 = &
mw
->mbox;

2622 
Ÿx2_mbox_dev
 *
mdev
;

2623 
devid
;

2625 i‡(
mw
->
mbox_wq
) {

2626 
	`Êush_w‹kqueue
(
mw
->
mbox_wq
);

2627 
	`de°roy_w‹kqueue
(
mw
->
mbox_wq
);

2628 
mw
->
mbox_wq
 = 
NULL
;

2631 
devid
 = 0; devid < 
mbox
->
ndevs
; devid++) {

2632 
mdev
 = &
mbox
->
dev
[
devid
];

2633 i‡(
mdev
->
hwba£
)

2634 
	`iounm≠
((
__iomem
 *)
mdev
->
hwba£
);

2637 
	`Ÿx2_mbox_de°roy
(&
mw
->
mbox
);

2638 
	`Ÿx2_mbox_de°roy
(&
mw
->
mbox_up
);

2639 
	}
}

2641 
	$rvu_queue_w‹k
(
mbox_wq_öfo
 *
mw
, 
fú°
,

2642 
mdevs
, 
u64
 
öå
)

2644 
Ÿx2_mbox_dev
 *
mdev
;

2645 
Ÿx2_mbox
 *
mbox
;

2646 
mbox_hdr
 *
hdr
;

2647 
i
;

2649 
i
 = 
fú°
; i < 
mdevs
; i++) {

2651 i‡(!(
öå
 & 
	`BIT_ULL
(
i
 - 
fú°
)))

2654 
mbox
 = &
mw
->mbox;

2655 
mdev
 = &
mbox
->
dev
[
i
];

2656 
hdr
 = 
mdev
->
mba£
 + 
mbox
->
rx_°¨t
;

2666 i‡(
hdr
->
num_msgs
) {

2667 
mw
->
mbox_wrk
[
i
].
num_msgs
 = 
hdr
->num_msgs;

2668 
hdr
->
num_msgs
 = 0;

2669 
	`queue_w‹k
(
mw
->
mbox_wq
, &mw->
mbox_wrk
[
i
].
w‹k
);

2671 
mbox
 = &
mw
->
mbox_up
;

2672 
mdev
 = &
mbox
->
dev
[
i
];

2673 
hdr
 = 
mdev
->
mba£
 + 
mbox
->
rx_°¨t
;

2674 i‡(
hdr
->
num_msgs
) {

2675 
mw
->
mbox_wrk_up
[
i
].
up_num_msgs
 = 
hdr
->
num_msgs
;

2676 
hdr
->
num_msgs
 = 0;

2677 
	`queue_w‹k
(
mw
->
mbox_wq
, &mw->
mbox_wrk_up
[
i
].
w‹k
);

2680 
	}
}

2682 
úqªtu∫_t
 
	$rvu_mbox_öå_h™dÀr
(
úq
, *
rvu_úq
)

2684 
rvu
 *rvu = (rvu *)
rvu_úq
;

2685 
vfs
 = 
rvu
->vfs;

2686 
u64
 
öå
;

2688 
öå
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFAF_MBOX_INT
);

2690 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFAF_MBOX_INT
, 
öå
);

2691 i‡(
öå
)

2692 
	`åa˚_Ÿx2_msg_öãºu±
(
rvu
->
pdev
, "PF(sËtÿAF", 
öå
);

2695 
	`rmb
();

2697 
	`rvu_queue_w‹k
(&
rvu
->
aÂf_wq_öfo
, 0,Ñvu->
hw
->
tŸÆ_pfs
, 
öå
);

2700 i‡(
vfs
 > 64) {

2701 
öå
 = 
	`rvupf_ªad64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INTX
(1));

2702 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INTX
(1), 
öå
);

2704 
	`rvu_queue_w‹k
(&
rvu
->
afvf_wq_öfo
, 64, 
vfs
, 
öå
);

2705 
vfs
 -= 64;

2708 
öå
 = 
	`rvupf_ªad64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INTX
(0));

2709 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INTX
(0), 
öå
);

2710 i‡(
öå
)

2711 
	`åa˚_Ÿx2_msg_öãºu±
(
rvu
->
pdev
, "VF(sËtÿAF", 
öå
);

2713 
	`rvu_queue_w‹k
(&
rvu
->
afvf_wq_öfo
, 0, 
vfs
, 
öå
);

2715  
IRQ_HANDLED
;

2716 
	}
}

2718 
	$rvu_íabÀ_mbox_öå
(
rvu
 *rvu)

2720 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2723 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
,

2724 
RVU_AF_PFAF_MBOX_INT
, 
	`INTR_MASK
(
hw
->
tŸÆ_pfs
));

2727 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFAF_MBOX_INT_ENA_W1S
,

2728 
	`INTR_MASK
(
hw
->
tŸÆ_pfs
) & ~1ULL);

2729 
	}
}

2731 
	$rvu_≈a_lf_m≠≥d_nix_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
)

2733 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2734 
rvu_block
 *
nix_block
;

2735 
r§c_dëach
 
dëach
;

2736 
u16
 
nix_pcifunc
;

2737 
blkaddr
, 
lf
;

2738 
u64
 
ªgvÆ
;

2740 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

2741 i‡(
blkaddr
 < 0)

2744 
nix_block
 = &
hw
->
block
[
blkaddr
];

2745 
lf
 = 0;Ü‡< 
nix_block
->lf.
max
;Üf++) {

2749 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_CFG
(
lf
));

2750 i‡((
ªgvÆ
 & 0xFFFFË!
pcifunc
)

2753 
nix_pcifunc
 = 
nix_block
->
‚_m≠
[
lf
];

2758 i‡(
nix_pcifunc
 =
pcifunc
)

2761 
dëach
.
∑πül
 = 
åue
;

2762 
dëach
.
nixlf
 = 
åue
;

2764 
	`rvu_nix_lf_ã¨down
(
rvu
, 
nix_pcifunc
, 
blkaddr
, 
lf
);

2765 
	`rvu_lf_ª£t
(
rvu
, 
nix_block
, 
lf
);

2767 
	`rvu_dëach_r§cs
(
rvu
, &
dëach
, 
nix_pcifunc
);

2769 
	}
}

2771 
	$rvu_≈a_lf_m≠≥d_sso_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
)

2773 
≈a_blkaddr
, 
blkaddr
, 
lf
, 
ªåy
;

2774 
u16
 
sso_pcifunc
, 
m©ch_˙t
 = 0;

2775 
rvu_block
 *
sso_block
;

2776 
r§c_dëach
 
dëach
;

2777 
døö_tmo
;

2778 
u16
 *
pcifunc_¨r
;

2779 
u64
 
ªgvÆ
;

2781 
pcifunc_¨r
 = 
	`kˇŒoc
(
rvu
->
hw
->
tŸÆ_pfs
 +Ñvu->hw->
tŸÆ_vfs
,

2782 (*
pcifunc_¨r
), 
GFP_KERNEL
);

2783 i‡(!
pcifunc_¨r
)

2786 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

2787 i‡(
blkaddr
 < 0)

2790 
≈a_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

2791 i‡(
blkaddr
 < 0)

2794 
ªgvÆ
 = 
	`BIT_ULL
(16Ë| 
pcifunc
;

2795 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
≈a_blkaddr
, 
NPA_AF_BAR2_SEL
, 
ªgvÆ
);

2797 
sso_block
 = &
rvu
->
hw
->
block
[
blkaddr
];

2798 
ªåy
 = 0;

2799 
døö_tmo
 = 
jiffõs
 + 
	`m£cs_to_jiffõs
(
SSO_FLUSH_TMO_MAX
);

2800 
lf
 = 0;Ü‡< 
sso_block
->lf.
max
 || 
ªåy
;Üf++) {

2801 i‡(
lf
 =
sso_block
->lf.
max
) {

2802 i‡(
	`time_a·î
(
jiffõs
, 
døö_tmo
)) {

2803 
	`dev_îr
(
rvu
->
dev
, "FailedÅo drain SSO queues\n");

2807 
lf
 = 0;

2808 
ªåy
 = 0;

2810 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_GMCTL
(
lf
));

2811 i‡((
ªgvÆ
 & 0xFFFFË!
pcifunc
)

2814 
sso_pcifunc
 = 
sso_block
->
‚_m≠
[
lf
];

2815 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
sso_block
->
lfcfg_ªg
 |

2816 (
lf
 << 
sso_block
->
lfshi·
));

2817 i‡(
	`rvu_sso_lf_døö_queues
(
rvu
, 
sso_pcifunc
, 
lf
,

2818 
ªgvÆ
 & 0xFË=-
EAGAIN
) {

2819 
ªåy
 = 1;

2823 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_XAQ_AURA
(
lf
));

2824 
	`rvu_sso_deöô_xaq_auø
(
rvu
, 
sso_pcifunc
, 
pcifunc
, 
ªgvÆ
, 
lf
);

2827 
lf
 = 0;Ü‡< 
sso_block
->lf.
max
;Üf++) {

2828 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_GMCTL
(
lf
));

2829 i‡((
ªgvÆ
 & 0xFFFFË!
pcifunc
)

2832 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_XAQ_AURA
(
lf
));

2833 i‡(
	`rvu_sso_pﬁl_auø_˙t
(
rvu
, 
≈a_blkaddr
, 
ªgvÆ
))

2834 
	`dev_îr
(
rvu
->
dev
,

2836 
__LINE__
, 
ªgvÆ
);

2838 
	`rvu_sso_xaq_auø_wrôe
(
rvu
, 
lf
, 0);

2839 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_GMCTL
(
lf
), 0);

2842 
lf
 = 0;Ü‡< 
sso_block
->lf.
max
;Üf++) {

2843 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_GMCTL
(
lf
));

2844 i‡((
ªgvÆ
 & 0xFFFFË!
pcifunc
)

2847 
sso_pcifunc
 = 
sso_block
->
‚_m≠
[
lf
];

2848 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
sso_block
->
lfcfg_ªg
 |

2849 (
lf
 << 
sso_block
->
lfshi·
));

2853 
	`rvu_sso_lf_ã¨down
(
rvu
, 
sso_pcifunc
, 
lf
, 
ªgvÆ
 & 0xF);

2854 
	`rvu_lf_ª£t
(
rvu
, 
sso_block
, 
lf
);

2855 
pcifunc_¨r
[
m©ch_˙t
] = 
sso_pcifunc
;

2856 
m©ch_˙t
++;

2858 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
≈a_blkaddr
, 
NPA_AF_BAR2_SEL
, 0);

2860 
dëach
.
∑πül
 = 
åue
;

2861 
dëach
.
sso
 = 
åue
;

2863 
sso_pcifunc
 = 0; sso_pcifun¯< 
m©ch_˙t
; sso_pcifunc++)

2864 
	`rvu_dëach_r§cs
(
rvu
, &
dëach
, 
pcifunc_¨r
[
sso_pcifunc
]);

2865 
	`k‰ì
(
pcifunc_¨r
);

2866 
	}
}

2868 
	$rvu_blklf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u8
 
blkaddr
)

2870 
rvu_block
 *
block
;

2871 
døö_tmo
;

2872 
¶Ÿ
, 
lf
, 
num_lfs
;

2873 
îr
, 
ªåy
;

2875 
block
 = &
rvu
->
hw
->block[
blkaddr
];

2876 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
),

2877 
block
->
addr
);

2878 i‡(!
num_lfs
)

2881 i‡(
block
->
addr
 =
BLKADDR_SSO
) {

2882 
ªåy
 = 0;

2883 
døö_tmo
 = 
jiffõs
 + 
	`m£cs_to_jiffõs
(
SSO_FLUSH_TMO_MAX
);

2884 
¶Ÿ
 = 0; slŸ < 
num_lfs
 || 
ªåy
; slot++) {

2885 i‡(
¶Ÿ
 =
num_lfs
) {

2886 i‡(
	`time_a·î
(
jiffõs
, 
døö_tmo
)) {

2887 
	`dev_îr
(
rvu
->
dev
,

2892 
¶Ÿ
 = 0;

2893 
ªåy
 = 0;

2895 
lf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 
¶Ÿ
);

2896 i‡(
lf
 < 0)

2898 i‡(
	`rvu_sso_lf_døö_queues
(
rvu
, 
pcifunc
, 
lf
, 
¶Ÿ
) ==

2899 -
EAGAIN
)

2900 
ªåy
 = 1;

2902 
	`rvu_sso_˛ónup_xaq_auø
(
rvu
, 
pcifunc
, 
num_lfs
);

2905 
¶Ÿ
 = 0; slŸ < 
num_lfs
; slot++) {

2906 
lf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 
¶Ÿ
);

2907 i‡(
lf
 < 0)

2911 i‡(
block
->
addr
 =
BLKADDR_NIX0
 || block->add∏=
BLKADDR_NIX1
)

2912 
	`rvu_nix_lf_ã¨down
(
rvu
, 
pcifunc
, 
block
->
addr
, 
lf
);

2913 i‡(
block
->
addr
 =
BLKADDR_NPA
) {

2914 
	`rvu_≈a_lf_m≠≥d_nix_lf_ã¨down
(
rvu
, 
pcifunc
);

2915 
	`rvu_≈a_lf_m≠≥d_sso_lf_ã¨down
(
rvu
, 
pcifunc
);

2916 
	`rvu_≈a_lf_ã¨down
(
rvu
, 
pcifunc
, 
lf
);

2917 } i‡(
block
->
addr
 =
BLKADDR_SSO
)

2918 
	`rvu_sso_lf_ã¨down
(
rvu
, 
pcifunc
, 
lf
, 
¶Ÿ
);

2919 i‡(
block
->
addr
 =
BLKADDR_SSOW
)

2920 
	`rvu_ssow_lf_ã¨down
(
rvu
, 
pcifunc
, 
lf
, 
¶Ÿ
);

2921 i‡(
block
->
addr
 =
BLKADDR_TIM
)

2922 
	`rvu_tim_lf_ã¨down
(
rvu
, 
pcifunc
, 
lf
, 
¶Ÿ
);

2923 i‡((
block
->
addr
 =
BLKADDR_CPT0
) ||

2924 (
block
->
addr
 =
BLKADDR_CPT1
))

2925 
	`rvu_˝t_lf_ã¨down
(
rvu
, 
pcifunc
, 
block
->
addr
, 
lf
,

2926 
¶Ÿ
);

2928 
îr
 = 
	`rvu_lf_ª£t
(
rvu
, 
block
, 
lf
);

2929 i‡(
îr
) {

2930 
	`dev_îr
(
rvu
->
dev
, "FailedÅoÑeset blkaddr %d LF%d\n",

2931 
block
->
addr
, 
lf
);

2934 i‡(
block
->
addr
 =
BLKADDR_SSO
)

2935 
	`rvu_sso_hwgΩ_c⁄fig_thªsh
(
rvu
, 
block
->
addr
, 
lf
, 
NULL
);

2937 
	}
}

2939 
	$rvu_sso_pfvf_r°
(
rvu
 *rvu, 
u16
 
pcifunc
)

2941 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

2942 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2944 i‡(
pfvf
->
sso_uniq_idít
) {

2945 
	`rvu_‰ì_r§c
(&
hw
->
sso
.
pfvf_idít
, 
pfvf
->
sso_uniq_idít
);

2946 
pfvf
->
sso_uniq_idít
 = 0;

2948 
	}
}

2950 
	$__rvu_Êr_h™dÀr
(
rvu
 *rvu, 
u16
 
pcifunc
)

2952 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

2953 
	`rvu_≈c_exa˘_ª£t
(
rvu
, 
pcifunc
);

2955 
	`muãx_lock
(&
rvu
->
Êr_lock
);

2961 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_NIX0
);

2962 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_NIX1
);

2963 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_CPT0
);

2964 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_CPT1
);

2965 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_REE0
);

2966 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_REE1
);

2967 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_TIM
);

2968 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_SSOW
);

2969 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_SSO
);

2970 
	`rvu_blklf_ã¨down
(
rvu
, 
pcifunc
, 
BLKADDR_NPA
);

2971 
	`rvu_ª£t_lmt_m≠_tbl
(
rvu
, 
pcifunc
);

2972 
	`rvu_dëach_r§cs
(
rvu
, 
NULL
, 
pcifunc
);

2973 
	`rvu_sso_pfvf_r°
(
rvu
, 
pcifunc
);

2979 
	`rvu_≈c_‰ì_mˇm_íåõs
(
rvu
, 
pcifunc
, -1);

2980 
	`rvu_mac_ª£t
(
rvu
, 
pcifunc
);

2983 i‡(
rvu
->
mcs_blk_˙t
)

2984 
	`rvu_mcs_Êr_h™dÀr
(
rvu
, 
pcifunc
);

2986 
	`muãx_u∆ock
(&
rvu
->
Êr_lock
);

2987 
	}
}

2989 
	$rvu_afvf_Êr_h™dÀr
(
rvu
 *rvu, 
vf
)

2991 
ªg
 = 0;

2994 
	`__rvu_Êr_h™dÀr
(
rvu
, 
vf
 + 1);

2996 i‡(
vf
 >= 64) {

2997 
ªg
 = 1;

2998 
vf
 = vf - 64;

3002 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFTRPENDX
(
ªg
), 
	`BIT_ULL
(
vf
));

3003 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFFLR_INT_ENA_W1SX
(
ªg
), 
	`BIT_ULL
(
vf
));

3004 
	}
}

3006 
	$rvu_Êr_h™dÀr
(
w‹k_°ru˘
 *
w‹k
)

3008 
rvu_w‹k
 *
Êrw‹k
 = 
	`c⁄èöî_of
(
w‹k
, rvu_work, work);

3009 
rvu
 *rvu = 
Êrw‹k
->rvu;

3010 
u16
 
pcifunc
, 
numvfs
, 
vf
;

3011 
u64
 
cfg
;

3012 
pf
;

3014 
pf
 = 
Êrw‹k
 - 
rvu
->
Êr_wrk
;

3015 i‡(
pf
 >
rvu
->
hw
->
tŸÆ_pfs
) {

3016 
	`rvu_afvf_Êr_h™dÀr
(
rvu
, 
pf
 -Ñvu->
hw
->
tŸÆ_pfs
);

3020 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
pf
));

3021 
numvfs
 = (
cfg
 >> 12) & 0xFF;

3022 
pcifunc
 = 
pf
 << 
RVU_PFVF_PF_SHIFT
;

3024 
vf
 = 0; v‡< 
numvfs
; vf++)

3025 
	`__rvu_Êr_h™dÀr
(
rvu
, (
pcifunc
 | (
vf
 + 1)));

3027 
	`__rvu_Êr_h™dÀr
(
rvu
, 
pcifunc
);

3030 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFTRPEND
, 
	`BIT_ULL
(
pf
));

3033 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFFLR_INT_ENA_W1S
, 
	`BIT_ULL
(
pf
));

3034 
	}
}

3036 
	$rvu_afvf_queue_Êr_w‹k
(
rvu
 *rvu, 
°¨t_vf
, 
numvfs
)

3038 
dev
, 
vf
, 
ªg
 = 0;

3039 
u64
 
öå
;

3041 i‡(
°¨t_vf
 >= 64)

3042 
ªg
 = 1;

3044 
öå
 = 
	`rvupf_ªad64
(
rvu
, 
	`RVU_PF_VFFLR_INTX
(
ªg
));

3045 i‡(!
öå
)

3048 
vf
 = 0; v‡< 
numvfs
; vf++) {

3049 i‡(!(
öå
 & 
	`BIT_ULL
(
vf
)))

3052 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFFLR_INTX
(
ªg
), 
	`BIT_ULL
(
vf
));

3053 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFFLR_INT_ENA_W1CX
(
ªg
), 
	`BIT_ULL
(
vf
));

3055 
dev
 = 
vf
 + 
°¨t_vf
 + 
rvu
->
hw
->
tŸÆ_pfs
;

3056 
	`queue_w‹k
(
rvu
->
Êr_wq
, &rvu->
Êr_wrk
[
dev
].
w‹k
);

3058 
	}
}

3060 
úqªtu∫_t
 
	$rvu_Êr_öå_h™dÀr
(
úq
, *
rvu_úq
)

3062 
rvu
 *rvu = (rvu *)
rvu_úq
;

3063 
u64
 
öå
;

3064 
u8
 
pf
;

3066 
öå
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFFLR_INT
);

3067 i‡(!
öå
)

3068 
afvf_Êr
;

3070 
pf
 = 0;Ö‡< 
rvu
->
hw
->
tŸÆ_pfs
;Öf++) {

3071 i‡(
öå
 & (1ULL << 
pf
)) {

3073 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFFLR_INT
,

3074 
	`BIT_ULL
(
pf
));

3076 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFFLR_INT_ENA_W1C
,

3077 
	`BIT_ULL
(
pf
));

3079 
	`queue_w‹k
(
rvu
->
Êr_wq
, &rvu->
Êr_wrk
[
pf
].
w‹k
);

3083 
afvf_Êr
:

3084 
	`rvu_afvf_queue_Êr_w‹k
(
rvu
, 0, 64);

3085 i‡(
rvu
->
vfs
 > 64)

3086 
	`rvu_afvf_queue_Êr_w‹k
(
rvu
, 64,Ñvu->
vfs
 - 64);

3088  
IRQ_HANDLED
;

3089 
	}
}

3091 
	$rvu_me_h™dÀ_vf£t
(
rvu
 *rvu, 
idx
, 
u64
 
öå
)

3093 
vf
;

3098 
vf
 = 0; vf < 64; vf++) {

3099 i‡(
öå
 & (1ULL << 
vf
)) {

3101 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFTRPENDX
(
idx
), 
	`BIT_ULL
(
vf
));

3103 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFME_INTX
(
idx
), 
	`BIT_ULL
(
vf
));

3106 
	}
}

3109 
úqªtu∫_t
 
	$rvu_me_vf_öå_h™dÀr
(
úq
, *
rvu_úq
)

3111 
rvu
 *rvu = (rvu *)
rvu_úq
;

3112 
vf£t
;

3113 
u64
 
öå
;

3115 
öå
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFME_INT
);

3117 
vf£t
 = 0; vfset <= 1; vfset++) {

3118 
öå
 = 
	`rvupf_ªad64
(
rvu
, 
	`RVU_PF_VFME_INTX
(
vf£t
));

3119 i‡(
öå
)

3120 
	`rvu_me_h™dÀ_vf£t
(
rvu
, 
vf£t
, 
öå
);

3123  
IRQ_HANDLED
;

3124 
	}
}

3127 
úqªtu∫_t
 
	$rvu_me_pf_öå_h™dÀr
(
úq
, *
rvu_úq
)

3129 
rvu
 *rvu = (rvu *)
rvu_úq
;

3130 
u64
 
öå
;

3131 
u8
 
pf
;

3133 
öå
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFME_INT
);

3138 
pf
 = 0;Ö‡< 
rvu
->
hw
->
tŸÆ_pfs
;Öf++) {

3139 i‡(
öå
 & (1ULL << 
pf
)) {

3141 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFTRPEND
,

3142 
	`BIT_ULL
(
pf
));

3144 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFME_INT
,

3145 
	`BIT_ULL
(
pf
));

3149  
IRQ_HANDLED
;

3150 
	}
}

3152 
	$rvu_uƒegi°î_öãºu±s
(
rvu
 *rvu)

3154 
úq
;

3156 
	`rvu_sso_uƒegi°î_öãºu±s
(
rvu
);

3157 
	`rvu_˝t_uƒegi°î_öãºu±s
(
rvu
);

3158 
	`rvu_ªe_uƒegi°î_öãºu±s
(
rvu
);

3161 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFAF_MBOX_INT_ENA_W1C
,

3162 
	`INTR_MASK
(
rvu
->
hw
->
tŸÆ_pfs
) & ~1ULL);

3165 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFFLR_INT_ENA_W1C
,

3166 
	`INTR_MASK
(
rvu
->
hw
->
tŸÆ_pfs
) & ~1ULL);

3169 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFME_INT_ENA_W1C
,

3170 
	`INTR_MASK
(
rvu
->
hw
->
tŸÆ_pfs
) & ~1ULL);

3172 
úq
 = 0; irq < 
rvu
->
num_vec
; irq++) {

3173 i‡(
rvu
->
úq_Æloˇãd
[
úq
]) {

3174 
	`‰ì_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
úq
),Ñvu);

3175 
rvu
->
úq_Æloˇãd
[
úq
] = 
Ál£
;

3179 
	`pci_‰ì_úq_ve˘‹s
(
rvu
->
pdev
);

3180 
rvu
->
num_vec
 = 0;

3181 
	}
}

3183 
	$rvu_afvf_msix_ve˘‹s_num_ok
(
rvu
 *rvu)

3185 
rvu_pfvf
 *
pfvf
 = &
rvu
->
pf
[0];

3186 
off£t
;

3188 
pfvf
 = &
rvu
->
pf
[0];

3189 
off£t
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_INT_CFG
(0)) & 0x3ff;

3195  (
pfvf
->
msix
.
max
 >
RVU_AF_INT_VEC_CNT
 + 
RVU_PF_INT_VEC_CNT
) &&

3196 
off£t
;

3197 
	}
}

3199 
	$rvu_ªgi°î_öãºu±s
(
rvu
 *rvu)

3201 
ªt
, 
off£t
, 
pf_vec_°¨t
;

3203 
rvu
->
num_vec
 = 
	`pci_msix_vec_cou¡
‘vu->
pdev
);

3205 
rvu
->
úq_«me
 = 
	`devm_kmÆloc_¨øy
‘vu->
dev
,Ñvu->
num_vec
,

3206 
NAME_SIZE
, 
GFP_KERNEL
);

3207 i‡(!
rvu
->
úq_«me
)

3208  -
ENOMEM
;

3210 
rvu
->
úq_Æloˇãd
 = 
	`devm_kˇŒoc
‘vu->
dev
,Ñvu->
num_vec
,

3211 (
boﬁ
), 
GFP_KERNEL
);

3212 i‡(!
rvu
->
úq_Æloˇãd
)

3213  -
ENOMEM
;

3216 
ªt
 = 
	`pci_Æloc_úq_ve˘‹s
(
rvu
->
pdev
,Ñvu->
num_vec
,

3217 
rvu
->
num_vec
, 
PCI_IRQ_MSIX
);

3218 i‡(
ªt
 < 0) {

3219 
	`dev_îr
(
rvu
->
dev
,

3221 
rvu
->
num_vec
, 
ªt
);

3222  
ªt
;

3226 
	`•rötf
(&
rvu
->
úq_«me
[
RVU_AF_INT_VEC_MBOX
 * 
NAME_SIZE
], "RVUAF Mbox");

3227 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
RVU_AF_INT_VEC_MBOX
),

3228 
rvu_mbox_öå_h™dÀr
, 0,

3229 &
rvu
->
úq_«me
[
RVU_AF_INT_VEC_MBOX
 * 
NAME_SIZE
],Ñvu);

3230 i‡(
ªt
) {

3231 
	`dev_îr
(
rvu
->
dev
,

3233 
Áû
;

3236 
rvu
->
úq_Æloˇãd
[
RVU_AF_INT_VEC_MBOX
] = 
åue
;

3239 
	`rvu_íabÀ_mbox_öå
(
rvu
);

3242 
	`•rötf
(&
rvu
->
úq_«me
[
RVU_AF_INT_VEC_PFFLR
 * 
NAME_SIZE
],

3244 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
RVU_AF_INT_VEC_PFFLR
),

3245 
rvu_Êr_öå_h™dÀr
, 0,

3246 &
rvu
->
úq_«me
[
RVU_AF_INT_VEC_PFFLR
 * 
NAME_SIZE
],

3247 
rvu
);

3248 i‡(
ªt
) {

3249 
	`dev_îr
(
rvu
->
dev
,

3251 
Áû
;

3253 
rvu
->
úq_Æloˇãd
[
RVU_AF_INT_VEC_PFFLR
] = 
åue
;

3256 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
,

3257 
RVU_AF_PFFLR_INT
, 
	`INTR_MASK
(
rvu
->
hw
->
tŸÆ_pfs
));

3259 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFFLR_INT_ENA_W1S
,

3260 
	`INTR_MASK
(
rvu
->
hw
->
tŸÆ_pfs
) & ~1ULL);

3263 
	`•rötf
(&
rvu
->
úq_«me
[
RVU_AF_INT_VEC_PFME
 * 
NAME_SIZE
],

3265 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
RVU_AF_INT_VEC_PFME
),

3266 
rvu_me_pf_öå_h™dÀr
, 0,

3267 &
rvu
->
úq_«me
[
RVU_AF_INT_VEC_PFME
 * 
NAME_SIZE
],

3268 
rvu
);

3269 i‡(
ªt
) {

3270 
	`dev_îr
(
rvu
->
dev
,

3273 
rvu
->
úq_Æloˇãd
[
RVU_AF_INT_VEC_PFME
] = 
åue
;

3276 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
,

3277 
RVU_AF_PFTRPEND
, 
	`INTR_MASK
(
rvu
->
hw
->
tŸÆ_pfs
));

3279 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
,

3280 
RVU_AF_PFME_INT
, 
	`INTR_MASK
(
rvu
->
hw
->
tŸÆ_pfs
));

3282 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_PFME_INT_ENA_W1S
,

3283 
	`INTR_MASK
(
rvu
->
hw
->
tŸÆ_pfs
) & ~1ULL);

3285 i‡(!
	`rvu_afvf_msix_ve˘‹s_num_ok
(
rvu
))

3289 
pf_vec_°¨t
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
,

3290 
	`RVU_PRIV_PFX_INT_CFG
(0)) & 0x3ff;

3293 
off£t
 = 
pf_vec_°¨t
 + 
RVU_PF_INT_VEC_VFPF_MBOX0
;

3294 
	`•rötf
(&
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], "RVUAFVF Mbox0");

3295 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
off£t
),

3296 
rvu_mbox_öå_h™dÀr
, 0,

3297 &
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
],

3298 
rvu
);

3299 i‡(
ªt
)

3300 
	`dev_îr
(
rvu
->
dev
,

3303 
rvu
->
úq_Æloˇãd
[
off£t
] = 
åue
;

3308 
off£t
 = 
pf_vec_°¨t
 + 
RVU_PF_INT_VEC_VFPF_MBOX1
;

3309 
	`•rötf
(&
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], "RVUAFVF Mbox1");

3310 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
off£t
),

3311 
rvu_mbox_öå_h™dÀr
, 0,

3312 &
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
],

3313 
rvu
);

3314 i‡(
ªt
)

3315 
	`dev_îr
(
rvu
->
dev
,

3318 
rvu
->
úq_Æloˇãd
[
off£t
] = 
åue
;

3321 
off£t
 = 
pf_vec_°¨t
 + 
RVU_PF_INT_VEC_VFFLR0
;

3322 
	`•rötf
(&
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], "RVUAFVF FLR0");

3323 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
off£t
),

3324 
rvu_Êr_öå_h™dÀr
, 0,

3325 &
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
],Ñvu);

3326 i‡(
ªt
) {

3327 
	`dev_îr
(
rvu
->
dev
,

3329 
Áû
;

3331 
rvu
->
úq_Æloˇãd
[
off£t
] = 
åue
;

3333 
off£t
 = 
pf_vec_°¨t
 + 
RVU_PF_INT_VEC_VFFLR1
;

3334 
	`•rötf
(&
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], "RVUAFVF FLR1");

3335 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
off£t
),

3336 
rvu_Êr_öå_h™dÀr
, 0,

3337 &
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
],Ñvu);

3338 i‡(
ªt
) {

3339 
	`dev_îr
(
rvu
->
dev
,

3341 
Áû
;

3343 
rvu
->
úq_Æloˇãd
[
off£t
] = 
åue
;

3346 
off£t
 = 
pf_vec_°¨t
 + 
RVU_PF_INT_VEC_VFME0
;

3347 
	`•rötf
(&
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], "RVUAFVF ME0");

3348 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
off£t
),

3349 
rvu_me_vf_öå_h™dÀr
, 0,

3350 &
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
],Ñvu);

3351 i‡(
ªt
) {

3352 
	`dev_îr
(
rvu
->
dev
,

3354 
Áû
;

3356 
rvu
->
úq_Æloˇãd
[
off£t
] = 
åue
;

3358 
off£t
 = 
pf_vec_°¨t
 + 
RVU_PF_INT_VEC_VFME1
;

3359 
	`•rötf
(&
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], "RVUAFVF ME1");

3360 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
off£t
),

3361 
rvu_me_vf_öå_h™dÀr
, 0,

3362 &
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
],Ñvu);

3363 i‡(
ªt
) {

3364 
	`dev_îr
(
rvu
->
dev
,

3366 
Áû
;

3368 
rvu
->
úq_Æloˇãd
[
off£t
] = 
åue
;

3370 
ªt
 = 
	`rvu_sso_ªgi°î_öãºu±s
(
rvu
);

3371 i‡(
ªt
)

3372 
Áû
;

3374 
ªt
 = 
	`rvu_˝t_ªgi°î_öãºu±s
(
rvu
);

3375 i‡(
ªt
)

3376 
Áû
;

3378 
ªt
 = 
	`rvu_ªe_ªgi°î_öãºu±s
(
rvu
);

3379 i‡(
ªt
)

3380 
Áû
;

3383 
Áû
:

3384 
	`rvu_uƒegi°î_öãºu±s
(
rvu
);

3385  
ªt
;

3386 
	}
}

3388 
	$rvu_Êr_wq_de°roy
(
rvu
 *rvu)

3390 i‡(
rvu
->
Êr_wq
) {

3391 
	`Êush_w‹kqueue
(
rvu
->
Êr_wq
);

3392 
	`de°roy_w‹kqueue
(
rvu
->
Êr_wq
);

3393 
rvu
->
Êr_wq
 = 
NULL
;

3395 
	}
}

3397 
	$rvu_Êr_öô
(
rvu
 *rvu)

3399 
dev
, 
num_devs
;

3400 
u64
 
cfg
;

3401 
pf
;

3404 
pf
 = 0;Ö‡< 
rvu
->
hw
->
tŸÆ_pfs
;Öf++) {

3405 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
pf
));

3406 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
pf
),

3407 
cfg
 | 
	`BIT_ULL
(22));

3410 
rvu
->
Êr_wq
 = 
	`Æloc_w‹kqueue
("rvu_afpf_flr",

3411 
WQ_UNBOUND
 | 
WQ_HIGHPRI
 | 
WQ_MEM_RECLAIM
,

3413 i‡(!
rvu
->
Êr_wq
)

3414  -
ENOMEM
;

3416 
num_devs
 = 
rvu
->
hw
->
tŸÆ_pfs
 + 
	`pci_§iov_gë_tŸÆvfs
‘vu->
pdev
);

3417 
rvu
->
Êr_wrk
 = 
	`devm_kˇŒoc
‘vu->
dev
, 
num_devs
,

3418 (
rvu_w‹k
), 
GFP_KERNEL
);

3419 i‡(!
rvu
->
Êr_wrk
) {

3420 
	`de°roy_w‹kqueue
(
rvu
->
Êr_wq
);

3421  -
ENOMEM
;

3424 
dev
 = 0; dev < 
num_devs
; dev++) {

3425 
rvu
->
Êr_wrk
[
dev
].rvu =Ñvu;

3426 
	`INIT_WORK
(&
rvu
->
Êr_wrk
[
dev
].
w‹k
, 
rvu_Êr_h™dÀr
);

3429 
	`muãx_öô
(&
rvu
->
Êr_lock
);

3432 
	}
}

3434 
	$rvu_dißbÀ_afvf_öå
(
rvu
 *rvu)

3436 
vfs
 = 
rvu
->vfs;

3438 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INT_ENA_W1CX
(0), 
	`INTR_MASK
(
vfs
));

3439 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFFLR_INT_ENA_W1CX
(0), 
	`INTR_MASK
(
vfs
));

3440 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFME_INT_ENA_W1CX
(0), 
	`INTR_MASK
(
vfs
));

3441 i‡(
vfs
 <= 64)

3444 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INT_ENA_W1CX
(1),

3445 
	`INTR_MASK
(
vfs
 - 64));

3446 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFFLR_INT_ENA_W1CX
(1), 
	`INTR_MASK
(
vfs
 - 64));

3447 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFME_INT_ENA_W1CX
(1), 
	`INTR_MASK
(
vfs
 - 64));

3448 
	}
}

3450 
	$rvu_íabÀ_afvf_öå
(
rvu
 *rvu)

3452 
vfs
 = 
rvu
->vfs;

3458 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INTX
(0), 
	`INTR_MASK
(
vfs
));

3459 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INT_ENA_W1SX
(0), 
	`INTR_MASK
(
vfs
));

3462 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFFLR_INTX
(0), 
	`INTR_MASK
(
vfs
));

3463 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFFLR_INT_ENA_W1SX
(0), 
	`INTR_MASK
(
vfs
));

3464 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFME_INT_ENA_W1SX
(0), 
	`INTR_MASK
(
vfs
));

3467 i‡(
vfs
 <= 64)

3470 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INTX
(1), 
	`INTR_MASK
(
vfs
 - 64));

3471 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFPF_MBOX_INT_ENA_W1SX
(1),

3472 
	`INTR_MASK
(
vfs
 - 64));

3474 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFFLR_INTX
(1), 
	`INTR_MASK
(
vfs
 - 64));

3475 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFFLR_INT_ENA_W1SX
(1), 
	`INTR_MASK
(
vfs
 - 64));

3476 
	`rvupf_wrôe64
(
rvu
, 
	`RVU_PF_VFME_INT_ENA_W1SX
(1), 
	`INTR_MASK
(
vfs
 - 64));

3477 
	}
}

3479 
	$rvu_gë_num_lbk_ch™s
()

3481 
pci_dev
 *
pdev
;

3482 
__iomem
 *
ba£
;

3483 
ªt
 = -
EIO
;

3485 
pdev
 = 
	`pci_gë_devi˚
(
PCI_VENDOR_ID_CAVIUM
, 
PCI_DEVID_OCTEONTX2_LBK
,

3486 
NULL
);

3487 i‡(!
pdev
)

3488 
îr
;

3490 
ba£
 = 
	`pci_i‹em≠_b¨
(
pdev
, 0);

3491 i‡(!
ba£
)

3492 
îr_put
;

3495 
ªt
 = (
	`ªadq
(
ba£
 + 0x10) >> 32) & 0xffff;

3496 
	`iounm≠
(
ba£
);

3497 
îr_put
:

3498 
	`pci_dev_put
(
pdev
);

3499 
îr
:

3500  
ªt
;

3501 
	}
}

3503 
	$rvu_íabÀ_§iov
(
rvu
 *rvu)

3505 
pci_dev
 *
pdev
 = 
rvu
->pdev;

3506 
îr
, 
ch™s
, 
vfs
;

3508 i‡(!
	`rvu_afvf_msix_ve˘‹s_num_ok
(
rvu
)) {

3509 
	`dev_w¨n
(&
pdev
->
dev
,

3514 
ch™s
 = 
	`rvu_gë_num_lbk_ch™s
();

3515 i‡(
ch™s
 < 0)

3516  
ch™s
;

3518 
vfs
 = 
	`pci_§iov_gë_tŸÆvfs
(
pdev
);

3521 i‡(
vfs
 > 
ch™s
)

3522 
vfs
 = 
ch™s
;

3524 i‡(!
vfs
)

3530 i‡(
vfs
 > 62)

3531 
vfs
 = 62;

3537 
rvu
->
vfs
 = vfs;

3539 
îr
 = 
	`rvu_mbox_öô
(
rvu
, &rvu->
afvf_wq_öfo
, 
TYPE_AFVF
, 
vfs
,

3540 
rvu_afvf_mbox_h™dÀr
, 
rvu_afvf_mbox_up_h™dÀr
);

3541 i‡(
îr
)

3542  
îr
;

3544 
	`rvu_íabÀ_afvf_öå
(
rvu
);

3546 
	`mb
();

3548 
îr
 = 
	`pci_íabÀ_§iov
(
pdev
, 
vfs
);

3549 i‡(
îr
) {

3550 
	`rvu_dißbÀ_afvf_öå
(
rvu
);

3551 
	`rvu_mbox_de°roy
(&
rvu
->
afvf_wq_öfo
);

3552  
îr
;

3556 
	}
}

3558 
	$rvu_dißbÀ_§iov
(
rvu
 *rvu)

3560 
	`rvu_dißbÀ_afvf_öå
(
rvu
);

3561 
	`rvu_mbox_de°roy
(&
rvu
->
afvf_wq_öfo
);

3562 
	`pci_dißbÀ_§iov
(
rvu
->
pdev
);

3563 
	}
}

3565 
	$rvu_upd©e_moduÀ_∑øms
(
rvu
 *rvu)

3567 c⁄° *
deÁu…_pÊ_«me
 = "default";

3569 
	`°rs˝y
(
rvu
->
mkex_pÊ_«me
,

3570 
mkex_¥ofûe
 ? mkex_¥ofûê: 
deÁu…_pÊ_«me
, 
MKEX_NAME_LEN
);

3571 
	`°rs˝y
(
rvu
->
kpu_pÊ_«me
,

3572 
kpu_¥ofûe
 ? kpu_¥ofûê: 
deÁu…_pÊ_«me
, 
KPU_NAME_LEN
);

3573 
	}
}

3575 
	$rvu_¥obe
(
pci_dev
 *
pdev
, c⁄° 
pci_devi˚_id
 *
id
)

3577 
devi˚
 *
dev
 = &
pdev
->dev;

3578 
rvu
 *rvu;

3579 
îr
;

3581 
rvu
 = 
	`devm_kzÆloc
(
dev
, (*rvu), 
GFP_KERNEL
);

3582 i‡(!
rvu
)

3583  -
ENOMEM
;

3585 
rvu
->
hw
 = 
	`devm_kzÆloc
(
dev
, (
rvu_hwöfo
), 
GFP_KERNEL
);

3586 i‡(!
rvu
->
hw
) {

3587 
	`devm_k‰ì
(
dev
, 
rvu
);

3588  -
ENOMEM
;

3591 
	`pci_£t_drvd©a
(
pdev
, 
rvu
);

3592 
rvu
->
pdev
 =Ödev;

3593 
rvu
->
dev
 = &
pdev
->dev;

3595 
îr
 = 
	`pci_íabÀ_devi˚
(
pdev
);

3596 i‡(
îr
) {

3597 
	`dev_îr
(
dev
, "FailedÅoÉnable PCI device\n");

3598 
îr_‰ìmem
;

3601 
îr
 = 
	`pci_ªque°_ªgi⁄s
(
pdev
, 
DRV_NAME
);

3602 i‡(
îr
) {

3603 
	`dev_îr
(
dev
, "PCIÑeque°Ñegi⁄†Áûed 0x%x\n", 
îr
);

3604 
îr_dißbÀ_devi˚
;

3607 
îr
 = 
	`dma_£t_mask_™d_cohîít
(
dev
, 
	`DMA_BIT_MASK
(48));

3608 i‡(
îr
) {

3609 
	`dev_îr
(
dev
, "DMA mask config failed,ábort\n");

3610 
îr_ªÀa£_ªgi⁄s
;

3613 
	`pci_£t_ma°î
(
pdev
);

3614 
rvu
->
±p
 = 
	`±p_gë
();

3615 i‡(
	`IS_ERR
(
rvu
->
±p
)) {

3616 
îr
 = 
	`PTR_ERR
(
rvu
->
±p
);

3617 i‡(
îr
 =-
EPROBE_DEFER
) {

3618 
	`dev_îr
(
dev
,

3620 
îr_ªÀa£_ªgi⁄s
;

3622 
rvu
->
±p
 = 
NULL
;

3626 
rvu
->
a‰eg_ba£
 = 
	`pcim_iom≠
(
pdev
, 
PCI_AF_REG_BAR_NUM
, 0);

3627 
rvu
->
p‰eg_ba£
 = 
	`pcim_iom≠
(
pdev
, 
PCI_PF_REG_BAR_NUM
, 0);

3628 i‡(!
rvu
->
a‰eg_ba£
 || !rvu->
p‰eg_ba£
) {

3629 
	`dev_îr
(
dev
, "UnableÅo mapádmin function CSRs,áborting\n");

3630 
îr
 = -
ENOMEM
;

3631 
îr_put_±p
;

3635 
	`rvu_upd©e_moduÀ_∑øms
(
rvu
);

3638 
	`rvu_check_block_im∂emíãd
(
rvu
);

3640 
	`rvu_ª£t_Æl_blocks
(
rvu
);

3642 
	`rvu_£tup_hw_ˇ∑bûôõs
(
rvu
);

3644 
îr
 = 
	`rvu_£tup_hw_ªsour˚s
(
rvu
);

3645 i‡(
îr
)

3646 
îr_put_±p
;

3649 
îr
 = 
	`rvu_mbox_öô
(
rvu
, &rvu->
aÂf_wq_öfo
, 
TYPE_AFPF
,

3650 
rvu
->
hw
->
tŸÆ_pfs
, 
rvu_aÂf_mbox_h™dÀr
,

3651 
rvu_aÂf_mbox_up_h™dÀr
);

3652 i‡(
îr
) {

3653 
	`dev_îr
(
dev
, "%s: FaûedÅÿöôülizêmbox\n", 
__func__
);

3654 
îr_hw£tup
;

3657 
îr
 = 
	`rvu_Êr_öô
(
rvu
);

3658 i‡(
îr
) {

3659 
	`dev_îr
(
dev
, "%s: FaûedÅÿöôülizêÊr\n", 
__func__
);

3660 
îr_mbox
;

3663 
îr
 = 
	`rvu_ªgi°î_öãºu±s
(
rvu
);

3664 i‡(
îr
) {

3665 
	`dev_îr
(
dev
, "%s: FaûedÅÿªgi°î i¡îru±s\n", 
__func__
);

3666 
îr_Êr
;

3669 
îr
 = 
	`rvu_ªgi°î_dl
(
rvu
);

3670 i‡(
îr
) {

3671 
	`dev_îr
(
dev
, "%s: FaûedÅÿªgi°î devlök\n", 
__func__
);

3672 
îr_úq
;

3675 
	`rvu_£tup_rvum_blk_ªvid
(
rvu
);

3677 
îr
 = 
	`rvu_pﬁicy_öô
(
rvu
);

3678 i‡(
îr
)

3679 
îr_dl
;

3682 
îr
 = 
	`rvu_íabÀ_§iov
(
rvu
);

3683 i‡(
îr
) {

3684 
	`dev_îr
(
dev
, "%s: FaûedÅÿíabÀ sriov\n", 
__func__
);

3685 
îr_pﬁicy
;

3689 
	`rvu_dbg_öô
(
rvu
);

3691 
	`muãx_öô
(&
rvu
->
rswôch
.
swôch_lock
);

3693 i‡(
rvu
->
fwd©a
)

3694 
	`±p_°¨t
(
rvu
->
±p
,Ñvu->
fwd©a
->
s˛k
,Ñvu->fwd©a->
±p_ext_˛k_øã
,

3695 
rvu
->
fwd©a
->
±p_ext_t°amp
);

3699 
îr_pﬁicy
:

3700 
	`rvu_pﬁicy_de°roy
(
rvu
);

3701 
îr_dl
:

3702 
	`rvu_uƒegi°î_dl
(
rvu
);

3703 
îr_úq
:

3704 
	`rvu_uƒegi°î_öãºu±s
(
rvu
);

3705 
îr_Êr
:

3706 
	`rvu_Êr_wq_de°roy
(
rvu
);

3707 
îr_mbox
:

3708 
	`rvu_mbox_de°roy
(&
rvu
->
aÂf_wq_öfo
);

3709 
îr_hw£tup
:

3710 
	`rvu_cgx_exô
(
rvu
);

3711 
	`rvu_fwd©a_exô
(
rvu
);

3712 
	`rvu_mcs_exô
(
rvu
);

3713 
	`rvu_ª£t_Æl_blocks
(
rvu
);

3714 
	`rvu_‰ì_hw_ªsour˚s
(
rvu
);

3715 
	`rvu_˛ór_rvum_blk_ªvid
(
rvu
);

3716 
îr_put_±p
:

3717 
	`±p_put
(
rvu
->
±p
);

3718 
îr_ªÀa£_ªgi⁄s
:

3719 
	`pci_ªÀa£_ªgi⁄s
(
pdev
);

3720 
îr_dißbÀ_devi˚
:

3721 
	`pci_dißbÀ_devi˚
(
pdev
);

3722 
îr_‰ìmem
:

3723 
	`pci_£t_drvd©a
(
pdev
, 
NULL
);

3724 
	`devm_k‰ì
(&
pdev
->
dev
, 
rvu
->
hw
);

3725 
	`devm_k‰ì
(
dev
, 
rvu
);

3726  
îr
;

3727 
	}
}

3729 
	$rvu_ªmove
(
pci_dev
 *
pdev
)

3731 
rvu
 *rvu = 
	`pci_gë_drvd©a
(
pdev
);

3733 
	`rvu_dbg_exô
(
rvu
);

3734 
	`rvu_pﬁicy_de°roy
(
rvu
);

3735 
	`rvu_uƒegi°î_dl
(
rvu
);

3736 
	`rvu_uƒegi°î_öãºu±s
(
rvu
);

3737 
	`rvu_Êr_wq_de°roy
(
rvu
);

3738 
	`rvu_cgx_exô
(
rvu
);

3739 
	`rvu_fwd©a_exô
(
rvu
);

3740 
	`rvu_mcs_exô
(
rvu
);

3741 
	`rvu_mbox_de°roy
(&
rvu
->
aÂf_wq_öfo
);

3742 
	`rvu_dißbÀ_§iov
(
rvu
);

3743 
	`rvu_ª£t_Æl_blocks
(
rvu
);

3744 
	`rvu_‰ì_hw_ªsour˚s
(
rvu
);

3745 
	`rvu_˛ór_rvum_blk_ªvid
(
rvu
);

3746 
	`±p_put
(
rvu
->
±p
);

3747 
	`pci_ªÀa£_ªgi⁄s
(
pdev
);

3748 
	`pci_dißbÀ_devi˚
(
pdev
);

3749 
	`pci_£t_drvd©a
(
pdev
, 
NULL
);

3751 
	`devm_k‰ì
(&
pdev
->
dev
, 
rvu
->
hw
);

3752 
	`devm_k‰ì
(&
pdev
->
dev
, 
rvu
);

3753 
	}
}

3755 
pci_drivî
 
	grvu_drivî
 = {

3756 .
«me
 = 
DRV_NAME
,

3757 .
	gid_èbÀ
 = 
rvu_id_èbÀ
,

3758 .
	g¥obe
 = 
rvu_¥obe
,

3759 .
	gªmove
 = 
rvu_ªmove
,

3762 
__öô
 
	$rvu_öô_moduÀ
()

3764 
îr
;

3766 
	`¥_öfo
("%s: %s\n", 
DRV_NAME
, 
DRV_STRING
);

3768 
îr
 = 
	`pci_ªgi°î_drivî
(&
cgx_drivî
);

3769 i‡(
îr
 < 0)

3770  
îr
;

3772 
îr
 = 
	`pci_ªgi°î_drivî
(&
±p_drivî
);

3773 i‡(
îr
 < 0)

3774 
±p_îr
;

3776 
îr
 = 
	`pci_ªgi°î_drivî
(&
mcs_drivî
);

3777 i‡(
îr
 < 0)

3778 
mcs_îr
;

3780 
îr
 = 
	`pci_ªgi°î_drivî
(&
rvu_drivî
);

3781 i‡(
îr
 < 0)

3782 
rvu_îr
;

3785 
rvu_îr
:

3786 
	`pci_uƒegi°î_drivî
(&
mcs_drivî
);

3787 
mcs_îr
:

3788 
	`pci_uƒegi°î_drivî
(&
±p_drivî
);

3789 
±p_îr
:

3790 
	`pci_uƒegi°î_drivî
(&
cgx_drivî
);

3792  
îr
;

3793 
	}
}

3795 
__exô
 
	$rvu_˛ónup_moduÀ
()

3797 
	`pci_uƒegi°î_drivî
(&
rvu_drivî
);

3798 
	`pci_uƒegi°î_drivî
(&
mcs_drivî
);

3799 
	`pci_uƒegi°î_drivî
(&
±p_drivî
);

3800 
	`pci_uƒegi°î_drivî
(&
cgx_drivî
);

3801 
	}
}

3803 
moduÀ_öô
(
rvu_öô_moduÀ
);

3804 
moduÀ_exô
(
rvu_˛ónup_moduÀ
);

	@rvu.h

8 #i‚de‡
RVU_H


9 
	#RVU_H


	)

11 
	~<löux/pci.h
>

12 
	~<√t/devlök.h
>

14 
	~"rvu_°ru˘.h
"

15 
	~"rvu_devlök.h
"

16 
	~"comm⁄.h
"

17 
	~"mbox.h
"

18 
	~"mcs_fùs_mbox.h
"

19 
	~"≈c.h
"

20 
	~"rvu_vÆid©i⁄.h
"

21 
	~"rvu_ªg.h
"

24 
	#PCI_DEVID_OCTEONTX2_RVU_AF
 0xA065

	)

25 
	#PCI_DEVID_OCTEONTX2_LBK
 0xA061

	)

28 
	#PCI_SUBSYS_DEVID_98XX
 0xB100

	)

29 
	#PCI_SUBSYS_DEVID_96XX
 0xB200

	)

30 
	#PCI_SUBSYS_DEVID_CN10K_A
 0xB900

	)

31 
	#PCI_SUBSYS_DEVID_CNF10K_A
 0xBA00

	)

32 
	#PCI_SUBSYS_DEVID_CNF10K_B
 0xBC00

	)

33 
	#PCI_SUBSYS_DEVID_CN10K_B
 0xBD00

	)

36 
	#PCI_AF_REG_BAR_NUM
 0

	)

37 
	#PCI_PF_REG_BAR_NUM
 2

	)

38 
	#PCI_MBOX_BAR_NUM
 4

	)

40 
	#NAME_SIZE
 32

	)

41 
	#MAX_NIX_BLKS
 2

	)

44 
	#RVU_PFVF_PF_SHIFT
 10

	)

45 
	#RVU_PFVF_PF_MASK
 0x3F

	)

46 
	#RVU_PFVF_FUNC_SHIFT
 0

	)

47 
	#RVU_PFVF_FUNC_MASK
 0x3FF

	)

49 #ifde‡
CONFIG_DEBUG_FS


50 
	sdump_˘x
 {

51 
	mlf
;

52 
	mid
;

53 
boﬁ
 
	mÆl
;

56 
	s˝t_dump_˘x
 {

57 
	me_ty≥
[
NAME_SIZE
];

60 
	srvu_debugfs
 {

61 
díåy
 *
	mroŸ
;

62 
díåy
 *
	m≈a
;

63 
díåy
 *
	mcgx_roŸ
;

64 
díåy
 *
	mcgx
;

65 
díåy
 *
	mlmac
;

66 
díåy
 *
	mnix
;

67 
díåy
 *
	m≈c
;

68 
díåy
 *
	msso
;

69 
díåy
 *
	msso_hwgΩ
;

70 
díåy
 *
	msso_hws
;

71 
díåy
 *
	m˝t
;

72 
díåy
 *
	mmcs_roŸ
;

73 
díåy
 *
	mmcs
;

74 
díåy
 *
	mmcs_rx
;

75 
díåy
 *
	mmcs_tx
;

76 
dump_˘x
 
	m≈a_auø_˘x
;

77 
dump_˘x
 
	m≈a_poﬁ_˘x
;

78 
dump_˘x
 
	mnix_cq_˘x
;

79 
dump_˘x
 
	mnix_rq_˘x
;

80 
dump_˘x
 
	mnix_sq_˘x
;

81 
˝t_dump_˘x
 
	m˝t_˘x
;

82 
	m≈a_qsize_id
;

83 
	mnix_qsize_id
;

87 
	srvu_w‹k
 {

88 
w‹k_°ru˘
 
	mw‹k
;

89 
rvu
 *
	mrvu
;

90 
	mnum_msgs
;

91 
	mup_num_msgs
;

94 
	sr§c_bm≠
 {

95 *
	mbm≠
;

96 
u16
 
	mmax
;

99 
	srvu_block
 {

100 
r§c_bm≠
 
	mlf
;

101 
admö_queue
 *
	maq
;

102 
u16
 *
	m‚_m≠
;

103 
boﬁ
 
	mmu…i¶Ÿ
;

104 
boﬁ
 
	mim∂emíãd
;

105 
u8
 
	maddr
;

106 
u8
 
	mty≥
;

107 
u8
 
	mlfshi·
;

108 
u64
 
	mlookup_ªg
;

109 
u64
 
	mpf_lf˙t_ªg
;

110 
u64
 
	mvf_lf˙t_ªg
;

111 
u64
 
	mlfcfg_ªg
;

112 
u64
 
	mmsixcfg_ªg
;

113 
u64
 
	ml‰e£t_ªg
;

114 
	m«me
[
NAME_SIZE
];

115 
rvu
 *
	mrvu
;

116 
u64
 
	m˝t_Êt_íg_m≠
[3];

117 
u64
 
	m˝t_rcvrd_íg_m≠
[3];

120 
	snix_mˇ°
 {

121 
qmem
 *
	mm˚_˘x
;

122 
qmem
 *
	mmˇ°_buf
;

123 
	mª∂ay_pköd
;

124 
	m√xt_‰ì_m˚
;

125 
muãx
 
	mm˚_lock
;

128 
	snix_m˚_li°
 {

129 
hli°_hód
 
	mhód
;

130 
	mcou¡
;

131 
	mmax
;

135 
	s≈c_œyî_md©a
 {

136 
u8
 
	mlid
;

137 
u8
 
	m…y≥
;

138 
u8
 
	mhdr
;

139 
u8
 
	mkey
;

140 
u8
 
	mÀn
;

149 
	s≈c_key_fõld
 {

153 
u64
 
	mkw_mask
[
NPC_MAX_KWS_IN_KEY
];

159 
	mƒ_kws
;

161 
≈c_œyî_md©a
 
	mœyî_md©a
;

164 
	s≈c_mˇm
 {

165 
r§c_bm≠
 
	mcou¡îs
;

166 
muãx
 
	mlock
;

167 *
	mbm≠
;

168 *
	mbm≠_ªvî£
;

169 
u16
 
	mbm≠_íåõs
;

170 
u16
 
	mbm≠_f˙t
;

171 
u16
 *
	míåy2pfvf_m≠
;

172 
u16
 *
	míåy2˙å_m≠
;

173 
u16
 *
	m˙å2pfvf_m≠
;

174 
u16
 *
	m˙å_ªf˙t
;

175 
u16
 *
	míåy2èrgë_pffunc
;

176 
u8
 
	mkeysize
;

177 
u8
 
	mb™ks
;

178 
u8
 
	mb™ks_≥r_íåy
;

179 
u16
 
	mb™ksize
;

180 
u16
 
	mtŸÆ_íåõs
;

181 
u16
 
	mnixlf_off£t
;

182 
u16
 
	mpf_off£t
;

183 
u16
 
	mÕrio_cou¡
;

184 
u16
 
	mÕrio_°¨t
;

185 
u16
 
	mh¥io_cou¡
;

186 
u16
 
	mh¥io_íd
;

187 
u16
 
	mrx_miss_a˘_˙å
;

189 
≈c_key_fõld
 
	mtx_key_fõlds
[
NPC_KEY_FIELDS_MAX
];

190 
≈c_key_fõld
 
	mrx_key_fõlds
[
NPC_KEY_FIELDS_MAX
];

191 
u64
 
	mtx_„©uªs
;

192 
u64
 
	mrx_„©uªs
;

193 
li°_hód
 
	mmˇm_ruÀs
;

196 
	ssso_aq_thr
 {

197 
u64
 
	müq_rsvd
;

198 
u64
 
	müq_max
;

199 
u64
 
	mèq_rsvd
;

200 
u64
 
	mèq_max
;

203 
	ssso_r§c
 {

204 
u8
 
	msso_hws
;

205 
u16
 
	msso_hwgΩs
;

206 
u16
 
	msso_xaq_num_w‹ks
;

207 
u16
 
	msso_xaq_buf_size
;

208 
u16
 
	msso_iue
;

209 
sso_aq_thr
 
	maq_thr
;

210 
r§c_bm≠
 
	mpfvf_idít
;

213 
	etim_rög_öãrvÆ
 {

214 
	mTIM_INTERVAL_1US
 = 0,

215 
	mTIM_INTERVAL_10US
,

216 
	mTIM_INTERVAL_1MS
,

217 
	mTIM_INTERVAL_INVAL
,

220 
	stim_r§c
 {

221 
u16
 
	mrögs_≥r_ötvl
[
TIM_INTERVAL_INVAL
];

222 
tim_rög_öãrvÆ
 *
	mrög_ötvls
;

225 
	sªe_r§c
 {

226 
qmem
 *
	mgøph_˘x
;

227 
qmem
 *
	m¥efix_˘x
;

228 **
	mruÀdb
;

229 
u8
 *
	mruÀdbi
;

230 
u32
 
	maq_hód
;

231 
u32
 
	mruÀdb_Àn
;

232 
u32
 
	mruÀdbi_Àn
;

233 
u8
 
	mruÀdb_blocks
;

237 
	srvu_pfvf
 {

238 
boﬁ
 
	m≈Æf
;

239 
boﬁ
 
	mnixlf
;

240 
u16
 
	msso
;

241 
u16
 
	mssow
;

242 
u16
 
	m˝éfs
;

243 
u16
 
	mtimlfs
;

244 
u16
 
	m˝t1_lfs
;

245 
u16
 
	mªe0_lfs
;

246 
u16
 
	mªe1_lfs
;

247 
u8
 
	mcgx_lmac
;

248 
u8
 
	msso_uniq_idít
;

251 
r§c_bm≠
 
	mmsix
;

252 
	#MSIX_BLKLF
(
blkaddr
, 
lf
Ë(((blkaddrË<< 8Ë| (÷fË& 0xFF))

	)

253 
u16
 *
	mmsix_lfm≠
;

256 
qmem
 *
	mauø_˘x
;

257 
qmem
 *
	mpoﬁ_˘x
;

258 
qmem
 *
	m≈a_qöts_˘x
;

259 *
	mauø_bm≠
;

260 *
	mpoﬁ_bm≠
;

263 
qmem
 *
	mrq_˘x
;

264 
qmem
 *
	msq_˘x
;

265 
qmem
 *
	mcq_˘x
;

266 
qmem
 *
	mrss_˘x
;

267 
qmem
 *
	mcq_öts_˘x
;

268 
qmem
 *
	mnix_qöts_˘x
;

269 *
	msq_bm≠
;

270 *
	mrq_bm≠
;

271 *
	mcq_bm≠
;

273 
u16
 
	mrx_ch™_ba£
;

274 
u16
 
	mtx_ch™_ba£
;

275 
u8
 
	mrx_ch™_˙t
;

276 
u8
 
	mtx_ch™_˙t
;

277 
u16
 
	mmaxÀn
;

278 
u16
 
	mmöÀn
;

280 
boﬁ
 
	mhw_rx_t°amp_í
;

281 
u8
 
	mmac_addr
[
ETH_ALEN
];

282 
u8
 
	mdeÁu…_mac
[
ETH_ALEN
];

285 
u16
 
	mbˇ°_m˚_idx
;

286 
u16
 
	mmˇ°_m˚_idx
;

287 
u16
 
	m¥omisc_m˚_idx
;

288 
nix_m˚_li°
 
	mbˇ°_m˚_li°
;

289 
nix_m˚_li°
 
	mmˇ°_m˚_li°
;

290 
nix_m˚_li°
 
	m¥omisc_m˚_li°
;

291 
boﬁ
 
	mu£_m˚_li°
;

294 
pci_dev
 *
	mpdev
;

295 
kobje˘
 *
	mlimôs_kobj
;

297 
rvu_≈c_mˇm_ruÀ
 *
	mdef_uˇ°_ruÀ
;

299 
boﬁ
 
	mcgx_ö_u£
;

300 
	mcgx_u£rs
;

302 
	mötf_mode
;

303 
u8
 
	mnix_blkaddr
;

304 
u8
 
	mnix_rx_ötf
;

305 
u8
 
	mnix_tx_ötf
;

306 
u8
 
	mlbkid
;

307 
u64
 
	mlmt_ba£_addr
;

308 
u64
 
	mlmt_m≠_ít_w1
;

309 
	mÊags
;

310 
sdp_node_öfo
 *
	msdp_öfo
;

311 
u8
 
	mé1_º_¥io
;

314 
	ervu_pfvf_Êags
 {

315 
	mNIXLF_INITIALIZED
 = 0,

316 
	mPF_SET_VF_MAC
,

317 
	mPF_SET_VF_CFG
,

318 
	mPF_SET_VF_TRUSTED
,

321 
	#RVU_CLEAR_VF_PERM
 ~
	`GENMASK
(
PF_SET_VF_TRUSTED
, 
PF_SET_VF_MAC
)

	)

323 
	snix_txsch
 {

324 
r§c_bm≠
 
	mschq
;

325 
u8
 
	mlvl
;

326 
	#NIX_TXSCHQ_FREE
 
	`BIT_ULL
(1)

	)

327 
	#NIX_TXSCHQ_CFG_DONE
 
	`BIT_ULL
(0)

	)

328 
	#TXSCH_MAP_FUNC
(
__pfvf_m≠
Ë((__pfvf_m≠Ë& 0xFFFF)

	)

329 
	#TXSCH_MAP_FLAGS
(
__pfvf_m≠
Ë((__pfvf_m≠Ë>> 16)

	)

330 
	#TXSCH_MAP
(
__func
, 
__Êags
Ë(((__funcË& 0xFFFFË| ((__ÊagsË<< 16))

	)

331 
	#TXSCH_SET_FLAG
(
__pfvf_m≠
, 
Êag
Ë((__pfvf_m≠Ë| ((ÊagË<< 16))

	)

332 
u32
 *
	mpfvf_m≠
;

335 
	snix_m¨k_f‹m©
 {

336 
u8
 
	mtŸÆ
;

337 
u8
 
	mö_u£
;

338 
u32
 *
	mcfg
;

341 
	s≈c_pköd
 {

342 
r§c_bm≠
 
	mr§c
;

343 
u32
 *
	mpfch™_m≠
;

346 
	snix_Êowkey
 {

347 
	#NIX_FLOW_KEY_ALG_MAX
 32

	)

348 
u32
 
	mÊowkey
[
NIX_FLOW_KEY_ALG_MAX
];

349 
	mö_u£
;

352 
	snix_lso
 {

353 
u8
 
	mtŸÆ
;

354 
u8
 
	mö_u£
;

357 
	snix_rq_˝t_mask
 {

358 
u8
 
	mtŸÆ
;

359 
u8
 
	mö_u£
;

362 
	snix_txvœn
 {

363 
	#NIX_TX_VTAG_DEF_MAX
 0x400

	)

364 
r§c_bm≠
 
	mr§c
;

365 
u16
 *
	míåy2pfvf_m≠
;

366 
muãx
 
	mr§c_lock
;

369 
	snix_ùﬁi˚r
 {

370 
r§c_bm≠
 
	mb™d_¥of
;

371 
u16
 *
	mpfvf_m≠
;

372 
u16
 *
	mm©ch_id
;

373 
u16
 *
	mªf_cou¡
;

376 
	snix_hw
 {

377 
	mblkaddr
;

378 
rvu
 *
	mrvu
;

379 
nix_txsch
 
	mtxsch
[
NIX_TXSCH_LVL_CNT
];

380 
nix_mˇ°
 
	mmˇ°
;

381 
nix_Êowkey
 
	mÊowkey
;

382 
nix_m¨k_f‹m©
 
	mm¨k_f‹m©
;

383 
nix_lso
 
	mlso
;

384 
nix_rq_˝t_mask
 
	mrq_msk
;

385 
nix_txvœn
 
	mtxvœn
;

386 
nix_ùﬁi˚r
 *
	mùﬁi˚r
;

387 
u64
 *
	mtx_¸edôs
;

388 *
	mtx_°Æl
;

394 
	shw_ˇp
 {

396 
u8
 
	mnix_tx_aggr_lvl
;

397 
u16
 
	mnix_txsch_≥r_cgx_lmac
;

398 
u16
 
	mnix_txsch_≥r_lbk_lmac
;

399 
u16
 
	mnix_txsch_≥r_sdp_lmac
;

400 
boﬁ
 
	mnix_fixed_txschq_m≠pög
;

401 
boﬁ
 
	mnix_sh≠ög
;

402 
boﬁ
 
	mnix_sh≠î_toggÀ_waô
;

403 
boﬁ
 
	mnix_tx_lök_bp
;

404 
boﬁ
 
	mnix_rx_mu…iˇ°
;

405 
boﬁ
 
	mnix_comm⁄_dwº_mtu
;

406 
boﬁ
 
	m≥r_pf_mbox_ªgs
;

407 
boﬁ
 
	m¥ogømmabÀ_ch™s
;

408 
boﬁ
 
	mùﬁi˚r
;

409 
boﬁ
 
	m£c⁄d_˝t_∑ss
;

410 
boﬁ
 
	mnix_mu…ùÀ_dwº_mtu
;

411 
boﬁ
 
	m≈c_hash_exåa˘
;

412 
boﬁ
 
	m≈c_exa˘_m©ch_íabÀd
;

413 
u16
 
	m•i_to_ßs
;

416 
	srvu_hwöfo
 {

417 
u8
 
	mtŸÆ_pfs
;

418 
u16
 
	mtŸÆ_vfs
;

419 
u16
 
	mmax_vfs_≥r_pf
;

420 
u8
 
	mcgx
;

421 
u8
 
	mlmac_≥r_cgx
;

422 
u16
 
	mcgx_ch™_ba£
;

423 
u16
 
	mlbk_ch™_ba£
;

424 
u16
 
	msdp_ch™_ba£
;

425 
u16
 
	m˝t_ch™_ba£
;

426 
u8
 
	mcgx_löks
;

427 
u8
 
	mlbk_löks
;

428 
u8
 
	msdp_löks
;

429 
u8
 
	m˝t_löks
;

430 
u8
 
	m≈c_kpus
;

431 
u8
 
	m≈c_pköds
;

432 
u8
 
	m≈c_ötfs
;

433 
u8
 
	m≈c_kpu_íåõs
;

434 
u16
 
	m≈c_cou¡îs
;

435 
u32
 
	mlbk_bufsize
;

436 
boﬁ
 
	m≈c_ext_£t
;

437 
u64
 
	m≈c_°©_ía
;

439 
hw_ˇp
 
	mˇp
;

440 
rvu_block
 
	mblock
[
BLK_COUNT
];

441 
nix_hw
 *
	mnix
;

442 
rvu
 *
	mrvu
;

443 
≈c_pköd
 
	mpköd
;

444 
≈c_mˇm
 
	mmˇm
;

445 
sso_r§c
 
	msso
;

446 
tim_r§c
 
	mtim
;

447 
ªe_r§c
 *
	mªe
;

448 
≈c_exa˘_èbÀ
 *
	mèbÀ
;

451 
	smbox_wq_öfo
 {

452 
Ÿx2_mbox
 
	mmbox
;

453 
rvu_w‹k
 *
	mmbox_wrk
;

455 
Ÿx2_mbox
 
	mmbox_up
;

456 
rvu_w‹k
 *
	mmbox_wrk_up
;

458 
w‹kqueue_°ru˘
 *
	mmbox_wq
;

461 
	srvu_fwd©a
 {

462 
	#RVU_FWDATA_HEADER_MAGIC
 0xCFDA

	)

463 
	#RVU_FWDATA_VERSION
 0x0001

	)

464 
u32
 
	mhódî_magic
;

465 
u32
 
	mvîsi⁄
;

468 
	#PF_MACNUM_MAX
 32

	)

469 
	#VF_MACNUM_MAX
 256

	)

470 
u64
 
	mpf_macs
[
PF_MACNUM_MAX
];

471 
u64
 
	mvf_macs
[
VF_MACNUM_MAX
];

472 
u64
 
	ms˛k
;

473 
u64
 
	mr˛k
;

474 
u64
 
	mmˇm_addr
;

475 
u64
 
	mmˇm_sz
;

476 
u64
 
	mmsixå_ba£
;

477 
u32
 
	m±p_ext_˛k_øã
;

478 
u32
 
	m±p_ext_t°amp
;

479 
	#FWDATA_RESERVED_MEM
 1022

	)

480 
u64
 
	mª£rved
[
FWDATA_RESERVED_MEM
];

481 
	#CGX_MAX
 9

	)

482 
	#CGX_LMACS_MAX
 4

	)

483 
	#CGX_LMACS_USX
 8

	)

485 
cgx_lmac_fwd©a_s


486 
	mcgx_fw_d©a
[
CGX_MAX
][
CGX_LMACS_MAX
];

487 
cgx_lmac_fwd©a_s


488 
	mcgx_fw_d©a_usx
[
CGX_MAX
][
CGX_LMACS_USX
];

493 
	g±p
;

498 
	s≈c_kpu_¥ofûe_ad≠ãr
 {

499 c⁄° *
	m«me
;

500 
u64
 
	mvîsi⁄
;

501 c⁄° 
≈c_…_def_cfg
 *
	m…_def
;

502 c⁄° 
≈c_kpu_¥ofûe_a˘i⁄
 *
	mikpu
;

503 c⁄° 
≈c_kpu_¥ofûe
 *
	mkpu
;

504 
≈c_mˇm_kex
 *
	mmkex
;

505 
≈c_mˇm_kex_hash
 *
	mmkex_hash
;

506 
boﬁ
 
	mcu°om
;

507 
size_t
 
	mpköds
;

508 
size_t
 
	mkpus
;

511 
	#RVU_SWITCH_LBK_CHAN
 63

	)

513 
	srvu_swôch
 {

514 
muãx
 
	mswôch_lock
;

515 
u32
 
	mu£d_íåõs
;

516 
u16
 *
	míåy2pcifunc
;

517 
u16
 
	mmode
;

518 
u16
 
	m°¨t_íåy
;

521 
	srvu
 {

522 
__iomem
 *
	ma‰eg_ba£
;

523 
__iomem
 *
	mp‰eg_ba£
;

524 
pci_dev
 *
	mpdev
;

525 
devi˚
 *
	mdev
;

526 
rvu_hwöfo
 *
	mhw
;

527 
rvu_pfvf
 *
	mpf
;

528 
rvu_pfvf
 *
	mhwvf
;

529 
rvu_limôs
 
	mpf_limôs
;

530 
muãx
 
	mr§c_lock
;

531 
muãx
 
	mÆüs_lock
;

532 
	mvfs
;

533 
	mnix_blkaddr
[
MAX_NIX_BLKS
];

536 
mbox_wq_öfo
 
	maÂf_wq_öfo
;

537 
mbox_wq_öfo
 
	mafvf_wq_öfo
;

540 
rvu_w‹k
 *
	mÊr_wrk
;

541 
w‹kqueue_°ru˘
 *
	mÊr_wq
;

542 
muãx
 
	mÊr_lock
;

545 
u16
 
	mnum_vec
;

546 *
	múq_«me
;

547 
boﬁ
 *
	múq_Æloˇãd
;

548 
dma_addr_t
 
	mmsix_ba£_iova
;

549 
u64
 
	mmsixå_ba£_phy
;

552 
	#PF_CGXMAP_BASE
 1

	)

553 
u16
 
	mcgx_m≠≥d_vfs
;

554 
u8
 
	mcgx_m≠≥d_pfs
;

555 
u8
 
	mcgx_˙t_max
;

556 
u8
 *
	mpf2cgxlmac_m≠
;

557 
u16
 *
	mcgxlmac2pf_m≠
;

560 
	mpf_nŸify_bm≠
;

561 **
	mcgx_idm≠
;

562 
w‹k_°ru˘
 
	mcgx_evh_w‹k
;

563 
w‹kqueue_°ru˘
 *
	mcgx_evh_wq
;

564 
•ölock_t
 
	mcgx_evq_lock
;

565 
li°_hód
 
	mcgx_evq_hód
;

566 
muãx
 
	mcgx_cfg_lock
;

568 
	mmkex_pÊ_«me
[
MKEX_NAME_LEN
];

569 
	mkpu_pÊ_«me
[
KPU_NAME_LEN
];

572 
rvu_fwd©a
 *
	mfwd©a
;

573 *
	mkpu_fwd©a
;

574 
size_t
 
	mkpu_fwd©a_sz
;

575 
__iomem
 *
	mkpu_¥Ê_addr
;

578 
≈c_kpu_¥ofûe_ad≠ãr
 
	mkpu
;

580 
±p
 *
	m±p
;

582 
	m˝t_pf_num
;

583 
	mmcs_blk_˙t
;

585 #ifde‡
CONFIG_DEBUG_FS


586 
rvu_debugfs
 
	mrvu_dbg
;

588 
rvu_devlök
 *
	mrvu_dl
;

591 
rvu_swôch
 
	mrswôch
;

593 
w‹k_°ru˘
 
	mmcs_öå_w‹k
;

594 
w‹kqueue_°ru˘
 *
	mmcs_öå_wq
;

595 
li°_hód
 
	mmcs_öåq_hód
;

597 
•ölock_t
 
	mmcs_öåq_lock
;

599 
•ölock_t
 
	m˝t_öå_lock
;

602 
ölöe
 
	$rvu_wrôe64
(
rvu
 *rvu, 
u64
 
block
, u64 
off£t
, u64 
vÆ
)

604 
	`wrôeq
(
vÆ
, 
rvu
->
a‰eg_ba£
 + ((
block
 << 28Ë| 
off£t
));

605 
	}
}

607 
ölöe
 
u64
 
	$rvu_ªad64
(
rvu
 *rvu, 
u64
 
block
, u64 
off£t
)

609  
	`ªadq
(
rvu
->
a‰eg_ba£
 + ((
block
 << 28Ë| 
off£t
));

610 
	}
}

612 
ölöe
 
	$rvupf_wrôe64
(
rvu
 *rvu, 
u64
 
off£t
, u64 
vÆ
)

614 
	`wrôeq
(
vÆ
, 
rvu
->
p‰eg_ba£
 + 
off£t
);

615 
	}
}

617 
ölöe
 
u64
 
	$rvupf_ªad64
(
rvu
 *rvu, 
u64
 
off£t
)

619  
	`ªadq
(
rvu
->
p‰eg_ba£
 + 
off£t
);

620 
	}
}

622 
ölöe
 
	$rvu_b¨2_£l_wrôe64
(
rvu
 *rvu, 
u64
 
block
, u64 
off£t
, u64 
vÆ
)

627 
	`rvu_wrôe64
(
rvu
, 
block
, 
off£t
, 
vÆ
);

628 
	`rvu_ªad64
(
rvu
, 
block
, 
off£t
);

630 
	`mb
();

631 
	}
}

634 
ölöe
 
boﬁ
 
	$is_rvu_¥e_96xx_C0
(
rvu
 *rvu)

636 
pci_dev
 *
pdev
 = 
rvu
->pdev;

638  ((
pdev
->
ªvisi⁄
 == 0x00) || (pdev->revision == 0x01) ||

639 (
pdev
->
ªvisi⁄
 == 0x10) || (pdev->revision == 0x11) ||

640 (
pdev
->
ªvisi⁄
 == 0x14));

641 
	}
}

643 
ölöe
 
boﬁ
 
	$is_rvu_96xx_A0
(
rvu
 *rvu)

645 
pci_dev
 *
pdev
 = 
rvu
->pdev;

647  (
pdev
->
ªvisi⁄
 == 0x00);

648 
	}
}

650 
ölöe
 
boﬁ
 
	$is_rvu_96xx_B0
(
rvu
 *rvu)

652 
pci_dev
 *
pdev
 = 
rvu
->pdev;

654  (
pdev
->
ªvisi⁄
 == 0x00) || (pdev->revision == 0x01);

655 
	}
}

657 
ölöe
 
boﬁ
 
	$is_rvu_95xx_A0
(
rvu
 *rvu)

659 
pci_dev
 *
pdev
 = 
rvu
->pdev;

661  (
pdev
->
ªvisi⁄
 == 0x10) || (pdev->revision == 0x11);

662 
	}
}

668 
	#PCI_REVISION_ID_96XX
 0x00

	)

669 
	#PCI_REVISION_ID_95XX
 0x10

	)

670 
	#PCI_REVISION_ID_95XXN
 0x20

	)

671 
	#PCI_REVISION_ID_98XX
 0x30

	)

672 
	#PCI_REVISION_ID_95XXMM
 0x40

	)

673 
	#PCI_REVISION_ID_95XXO
 0xE0

	)

675 
ölöe
 
boﬁ
 
	$is_rvu_Ÿx2
(
rvu
 *rvu)

677 
pci_dev
 *
pdev
 = 
rvu
->pdev;

679 
u8
 
midr
 = 
pdev
->
ªvisi⁄
 & 0xF0;

681  (
midr
 =
PCI_REVISION_ID_96XX
 || mid∏=
PCI_REVISION_ID_95XX
 ||

682 
midr
 =
PCI_REVISION_ID_95XXN
 || mid∏=
PCI_REVISION_ID_98XX
 ||

683 
midr
 =
PCI_REVISION_ID_95XXMM
 || mid∏=
PCI_REVISION_ID_95XXO
);

684 
	}
}

686 
ölöe
 
boﬁ
 
	$is_˙10ka_a0
(
rvu
 *rvu)

688 
pci_dev
 *
pdev
 = 
rvu
->pdev;

690 i‡(
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CN10K_A
 &&

691 (
pdev
->
ªvisi⁄
 & 0x0F) == 0x0)

692  
åue
;

693  
Ál£
;

694 
	}
}

696 
ölöe
 
boﬁ
 
	$is_˙10ka_a1
(
rvu
 *rvu)

698 
pci_dev
 *
pdev
 = 
rvu
->pdev;

700 i‡(
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CN10K_A
 &&

701 (
pdev
->
ªvisi⁄
 & 0x0F) == 0x1)

702  
åue
;

703  
Ál£
;

704 
	}
}

706 
ölöe
 
boﬁ
 
	$is_˙10kb_a0
(
rvu
 *rvu)

708 
pci_dev
 *
pdev
 = 
rvu
->pdev;

710 i‡(
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CN10K_B
 &&

711 (
pdev
->
ªvisi⁄
 & 0x0F) == 0x0)

712  
åue
;

713  
Ál£
;

714 
	}
}

716 
ölöe
 
boﬁ
 
	$is_˙10kb_a1
(
rvu
 *rvu)

718 
pci_dev
 *
pdev
 = 
rvu
->pdev;

720 i‡(
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CN10K_B
 &&

721 (
pdev
->
ªvisi⁄
 & 0x0F) == 0x1)

722  
åue
;

723  
Ál£
;

724 
	}
}

726 
ölöe
 
boﬁ
 
	$is_˙f10kb_a0
(
rvu
 *rvu)

728 
pci_dev
 *
pdev
 = 
rvu
->pdev;

730 i‡(
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CNF10K_B
 &&

731 (
pdev
->
ªvisi⁄
 & 0x0F) == 0x0)

732  
åue
;

733  
Ál£
;

734 
	}
}

736 
ölöe
 
boﬁ
 
	$is_˙f10ka_a1
(
rvu
 *rvu)

738 
pci_dev
 *
pdev
 = 
rvu
->pdev;

740 i‡(
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CNF10K_A
 &&

741 (
pdev
->
ªvisi⁄
 & 0x0F) == 0x1)

742  
åue
;

743  
Ál£
;

744 
	}
}

746 
ölöe
 
boﬁ
 
	$is_cgx_m≠≥d_to_nix
(
id
, 
u8
 
cgx_id
)

751 i‡(
id
 =
PCI_SUBSYS_DEVID_CNF10K_A
 || id =
PCI_SUBSYS_DEVID_CNF10K_B
)

752  
cgx_id
 <= 1;

754  !(
cgx_id
 && !(
id
 =
PCI_SUBSYS_DEVID_96XX
 ||

755 
id
 =
PCI_SUBSYS_DEVID_98XX
 ||

756 
id
 =
PCI_SUBSYS_DEVID_CN10K_A
));

757 
	}
}

759 
ölöe
 
boﬁ
 
	$is_rvu_≈c_hash_exåa˘_í
(
rvu
 *rvu)

761 
u64
 
≈c_c⁄°3
;

763 
≈c_c⁄°3
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NPC
, 
NPC_AF_CONST3
);

764 i‡(!(
≈c_c⁄°3
 & 
	`BIT_ULL
(62)))

765  
Ál£
;

767  
åue
;

768 
	}
}

770 
ölöe
 
boﬁ
 
	$is_rvu_nix_•i_to_ß_í
(
rvu
 *rvu)

772 
u64
 
≈c_c⁄°2
;

774 
≈c_c⁄°2
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NIX0
, 
NPC_AF_CONST2
);

775 i‡((
≈c_c⁄°2
 >> 48) & 0xffff)

776  
åue
;

778  
Ál£
;

779 
	}
}

781 
ölöe
 
u16
 
	$rvu_nix_ch™_cgx
(
rvu
 *rvu, 
u8
 
cgxid
,

782 
u8
 
lmacid
, u8 
ch™
)

784 
u64
 
nix_c⁄°
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NIX0
, 
NIX_AF_CONST
);

785 
u16
 
cgx_ch™s
 = 
nix_c⁄°
 & 0xFFULL;

786 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

788 i‡(!
hw
->
ˇp
.
¥ogømmabÀ_ch™s
)

789  
	`NIX_CHAN_CGX_LMAC_CHX
(
cgxid
, 
lmacid
, 
ch™
);

791  
rvu
->
hw
->
cgx_ch™_ba£
 +

792 (
cgxid
 * 
hw
->
lmac_≥r_cgx
 + 
lmacid
Ë* 
cgx_ch™s
 + 
ch™
;

793 
	}
}

795 
ölöe
 
u16
 
	$rvu_nix_ch™_lbk
(
rvu
 *rvu, 
u8
 
lbkid
,

796 
u8
 
ch™
)

798 
u64
 
nix_c⁄°
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NIX0
, 
NIX_AF_CONST
);

799 
u16
 
lbk_ch™s
 = (
nix_c⁄°
 >> 16) & 0xFFULL;

800 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

802 i‡(!
hw
->
ˇp
.
¥ogømmabÀ_ch™s
)

803  
	`NIX_CHAN_LBK_CHX
(
lbkid
, 
ch™
);

805  
rvu
->
hw
->
lbk_ch™_ba£
 + 
lbkid
 * 
lbk_ch™s
 + 
ch™
;

806 
	}
}

808 
ölöe
 
u16
 
	$rvu_nix_ch™_sdp
(
rvu
 *rvu, 
u8
 
ch™
)

810 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

812 i‡(!
hw
->
ˇp
.
¥ogømmabÀ_ch™s
)

813  
	`NIX_CHAN_SDP_CHX
(
ch™
);

815  
hw
->
sdp_ch™_ba£
 + 
ch™
;

816 
	}
}

818 
ölöe
 
u16
 
	$rvu_nix_ch™_˝t
(
rvu
 *rvu, 
u8
 
ch™
)

820  
rvu
->
hw
->
˝t_ch™_ba£
 + 
ch™
;

821 
	}
}

826 
ölöe
 
boﬁ
 
	$is_afvf
(
u16
 
pcifunc
)

828  !(
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
);

829 
	}
}

831 
ölöe
 
boﬁ
 
	$is_vf
(
u16
 
pcifunc
)

833  !!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
);

834 
	}
}

837 
ölöe
 
boﬁ
 
	$is_pffunc_af
(
u16
 
pcifunc
)

839  !
pcifunc
;

840 
	}
}

842 
ölöe
 
boﬁ
 
	$is_rvu_fwd©a_vÆid
(
rvu
 *rvu)

844  (
rvu
->
fwd©a
->
hódî_magic
 =
RVU_FWDATA_HEADER_MAGIC
) &&

845 (
rvu
->
fwd©a
->
vîsi⁄
 =
RVU_FWDATA_VERSION
);

846 
	}
}

848 
rvu_Æloc_bôm≠
(
r§c_bm≠
 *
r§c
);

849 
rvu_‰ì_bôm≠
(
r§c_bm≠
 *
r§c
);

850 
rvu_Æloc_r§c
(
r§c_bm≠
 *
r§c
);

851 
rvu_‰ì_r§c
(
r§c_bm≠
 *
r§c
, 
id
);

852 
boﬁ
 
is_r§c_‰ì
(
r§c_bm≠
 *
r§c
, 
id
);

853 
rvu_r§c_‰ì_cou¡
(
r§c_bm≠
 *
r§c
);

854 
rvu_Æloc_r§c_c⁄tig
(
r§c_bm≠
 *
r§c
, 
ƒ§c
);

855 
boﬁ
 
rvu_r§c_check_c⁄tig
(
r§c_bm≠
 *
r§c
, 
ƒ§c
);

856 
u16
 
rvu_gë_r§c_m≠cou¡
(
rvu_pfvf
 *
pfvf
, 
blkaddr
);

857 
rvu_gë_pf
(
u16
 
pcifunc
);

858 
rvu_pfvf
 *
rvu_gë_pfvf
(
rvu
 *rvu, 
pcifunc
);

859 
rvu_gë_pf_numvfs
(
rvu
 *rvu, 
pf
, *
numvfs
, *
hwvf
);

860 
boﬁ
 
is_block_im∂emíãd
(
rvu_hwöfo
 *
hw
, 
blkaddr
);

861 
boﬁ
 
is_pffunc_m≠_vÆid
(
rvu
 *rvu, 
u16
 
pcifunc
, 
blkty≥
);

862 
rvu_gë_lf
(
rvu
 *rvu, 
rvu_block
 *
block
, 
u16
 
pcifunc
, u16 
¶Ÿ
);

863 
rvu_lf_ª£t
(
rvu
 *rvu, 
rvu_block
 *
block
, 
lf
);

864 
rvu_gë_blkaddr
(
rvu
 *rvu, 
blkty≥
, 
u16
 
pcifunc
);

865 
rvu_pﬁl_ªg
(
rvu
 *rvu, 
u64
 
block
, u64 
off£t
, u64 
mask
, 
boﬁ
 
zîo
);

866 
rvu_gë_num_lbk_ch™s
();

867 
rvu_ndc_sync
(
rvu
 *rvu, 
lfblkid
, 
lfidx
, 
u64
 
lfoff£t
);

868 
rvu_gë_blkaddr_‰om_¶Ÿ
(
rvu
 *rvu, 
blkty≥
, 
u16
 
pcifunc
,

869 
u16
 
globÆ_¶Ÿ
, u16 *
¶Ÿ_ö_block
);

872 
	eªgm≠_block
 {

873 
	mTXSCHQ_HWREGMAP
 = 0,

874 
	mMAX_HWREGMAP
,

877 
boﬁ
 
rvu_check_vÆid_ªg
(
ªgm≠
, 
ªgblk
, 
u64
 
ªg
);

880 
rvu_aq_Æloc
(
rvu
 *rvu, 
admö_queue
 **
ad_queue
,

881 
qsize
, 
ö°_size
, 
ªs_size
);

882 
rvu_aq_‰ì
(
rvu
 *rvu, 
admö_queue
 *
aq
);

885 
rvu_sdp_öô
(
rvu
 *rvu);

886 
boﬁ
 
is_sdp_pfvf
(
u16
 
pcifunc
);

887 
boﬁ
 
is_sdp_pf
(
u16
 
pcifunc
);

888 
boﬁ
 
is_sdp_vf
(
u16
 
pcifunc
);

891 
ölöe
 
boﬁ
 
	$is_pf_cgxm≠≥d
(
rvu
 *rvu, 
u8
 
pf
)

893  (
pf
 >
PF_CGXMAP_BASE
 &&Ö‡<
rvu
->
cgx_m≠≥d_pfs
) &&

894 !
	`is_sdp_pf
(
pf
 << 
RVU_PFVF_PF_SHIFT
);

895 
	}
}

897 
ölöe
 
	$rvu_gë_cgx_lmac_id
(
u8
 
m≠
, u8 *
cgx_id
, u8 *
lmac_id
)

899 *
cgx_id
 = (
m≠
 >> 4) & 0xF;

900 *
lmac_id
 = (
m≠
 & 0xF);

901 
	}
}

903 
ölöe
 
boﬁ
 
	$is_cgx_vf
(
rvu
 *rvu, 
u16
 
pcifunc
)

905  ((
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) &&

906 
	`is_pf_cgxm≠≥d
(
rvu
, 
	`rvu_gë_pf
(
pcifunc
)));

907 
	}
}

909 
	#M
(
_«me
, 
_id
, 
‚_«me
, 
ªq
, 
r•
) \

910 
rvu_mbox_h™dÀr_
 ## 
	`‚_«me
(
rvu
 *, 
ªq
 *, 
r•
 *);

	)

911 
MBOX_MESSAGES


912 
	gMBOX_MCS_FIPS_MESSAGES


913 #unde‡
M


915 
rvu_cgx_öô
(
rvu
 *rvu);

916 
rvu_cgx_exô
(
rvu
 *rvu);

917 *
rvu_cgx_pd©a
(
u8
 
cgx_id
, 
rvu
 *rvu);

918 
rvu_cgx_c⁄fig_rxtx
(
rvu
 *rvu, 
u16
 
pcifunc
, 
boﬁ
 
°¨t
);

919 
rvu_cgx_íadis_rx_bp
(
rvu
 *rvu, 
pf
, 
boﬁ
 
íabÀ
);

920 
rvu_cgx_íadis_higig2
(
rvu
 *rvu, 
pf
, 
boﬁ
 
íabÀ
);

921 
boﬁ
 
rvu_cgx_is_higig2_íabÀd
(
rvu
 *rvu, 
pf
);

922 
rvu_cgx_dißbÀ_dmac_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
);

923 
rvu_cgx_°¨t_°›_io
(
rvu
 *rvu, 
u16
 
pcifunc
, 
boﬁ
 
°¨t
);

924 
rvu_cgx_nix_cuml_°©s
(
rvu
 *rvu, *
cgxd
, 
lmac_id
, 
ödex
,

925 
rxtxÊag
, 
u64
 *
°©
);

926 
boﬁ
 
is_cgx_c⁄fig_≥rmôãd
(
rvu
 *rvu, 
u16
 
pcifunc
);

927 
boﬁ
 
rvu_cgx_is_pköd_c⁄fig_≥rmôãd
(
rvu
 *rvu, 
u16
 
pcifunc
);

928 *
rvu_fú°_cgx_pd©a
(
rvu
 *rvu);

929 
cgxlmac_to_pf
(
rvu
 *rvu, 
cgx_id
, 
lmac_id
);

930 
rvu_cgx_c⁄fig_tx
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
);

931 
rvu_cgx_tx_íabÀ
(
rvu
 *rvu, 
u16
 
pcifunc
, 
boﬁ
 
íabÀ
);

932 
rvu_cgx_¥io_Êow_˘æ_cfg
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
,

933 
u16
 
pfc_í
);

934 
rvu_cgx_cfg_∑u£_‰m
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
);

935 
u32
 
rvu_cgx_gë_lmac_fifﬁí
(
rvu
 *rvu, 
cgx
, 
lmac
);

936 
rvu_mac_ª£t
(
rvu
 *rvu, 
u16
 
pcifunc
);

937 
u64
 
rvu_cgx_gë_dmacÊt_dr›≥d_pkt˙t
(*
cgxd
, 
lmac_id
);

940 
rvu_sso_öô
(
rvu
 *rvu);

941 
rvu_sso_‰ìmem
(
rvu
 *rvu);

942 
rvu_sso_ªgi°î_öãºu±s
(
rvu
 *rvu);

943 
rvu_sso_uƒegi°î_öãºu±s
(
rvu
 *rvu);

944 
rvu_sso_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
lf
, 
¶Ÿ_id
);

945 
rvu_ssow_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
lf
, 
¶Ÿ_id
);

946 
rvu_sso_hwgΩ_c⁄fig_thªsh
(
rvu
 *rvu, 
blkaddr
, 
lf
,

947 
sso_aq_thr
 *
aq_thr
);

948 
rvu_sso_block_˙10k_öô
(
rvu
 *rvu, 
blkaddr
);

949 
rvu_sso_lf_døö_queues
(
rvu
 *rvu, 
u16
 
pcifunc
, 
lf
, 
¶Ÿ
);

950 
rvu_sso_˛ónup_xaq_auø
(
rvu
 *rvu, 
u16
 
pcifunc
, 
hwgΩ
);

951 
rvu_sso_pﬁl_auø_˙t
(
rvu
 *rvu, 
≈a_blkaddr
, 
auø
);

952 
rvu_sso_deöô_xaq_auø
(
rvu
 *rvu, 
blkaddr
, 
≈a_blkaddr
,

953 
auø
, 
lf
);

954 
rvu_sso_xaq_auø_wrôe
(
rvu
 *rvu, 
lf
, 
u64
 
vÆ
);

957 
rvu_≈a_öô
(
rvu
 *rvu);

958 
rvu_≈a_‰ìmem
(
rvu
 *rvu);

959 
rvu_≈a_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
≈Æf
);

960 
rvu_≈a_aq_íq_ö°
(
rvu
 *rvu, 
≈a_aq_íq_ªq
 *
ªq
,

961 
≈a_aq_íq_r•
 *
r•
);

964 
boﬁ
 
is_nixlf_©èched
(
rvu
 *rvu, 
u16
 
pcifunc
);

965 
rvu_nix_öô
(
rvu
 *rvu);

966 
rvu_nix_ª£rve_m¨k_f‹m©
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

967 
blkaddr
, 
u32
 
cfg
);

968 
rvu_nix_‰ìmem
(
rvu
 *rvu);

969 
rvu_gë_nixlf_cou¡
(
rvu
 *rvu);

970 
rvu_nix_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
blkaddr
, 
≈Æf
);

971 
nix_gë_nixlf
(
rvu
 *rvu, 
u16
 
pcifunc
, *
nixlf
, *
nix_blkaddr
);

972 
boﬁ
 
rvu_nix_is_±p_tx_íabÀd
(
rvu
 *rvu, 
u16
 
pcifunc
);

973 
nix_upd©e_m˚_li°
(
rvu
 *rvu, 
u16
 
pcifunc
,

974 
nix_m˚_li°
 *
m˚_li°
,

975 
m˚_idx
, 
mˇm_ödex
, 
boﬁ
 
add
);

976 
nix_gë_m˚_li°
(
rvu
 *rvu, 
u16
 
pcifunc
, 
ty≥
,

977 
nix_m˚_li°
 **
m˚_li°
, *
m˚_idx
);

978 
nix_hw
 *
gë_nix_hw
(
rvu_hwöfo
 *
hw
, 
blkaddr
);

979 
rvu_gë_√xt_nix_blkaddr
(
rvu
 *rvu, 
blkaddr
);

980 
rvu_nix_ª£t_mac
(
rvu_pfvf
 *
pfvf
, 
pcifunc
);

981 
nix_gë_°ru˘_±rs
(
rvu
 *rvu, 
u16
 
pcifunc
,

982 
nix_hw
 **nix_hw, *
blkaddr
);

983 
rvu_nix_£tup_øãlimô_aggr
(
rvu
 *rvu, 
u16
 
pcifunc
,

984 
u16
 
rq_idx
, u16 
m©ch_id
);

985 
rvu_nix_‰ì_•i_to_ß_èbÀ
(
rvu
 *rvu, 
uöt16_t
 
pcifunc
);

986 
nix_aq_c⁄ãxt_ªad
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

987 
nix_˙10k_aq_íq_ªq
 *
aq_ªq
,

988 
nix_˙10k_aq_íq_r•
 *
aq_r•
,

989 
u16
 
pcifunc
, 
u8
 
˘y≥
, 
u32
 
qidx
);

990 
rvu_gë_nix_blkaddr
(
rvu
 *rvu, 
u16
 
pcifunc
);

991 
nix_gë_dwº_mtu_ªg
(
rvu_hwöfo
 *
hw
, 
smq_lök_ty≥
);

992 
u32
 
c⁄vît_dwº_mtu_to_byãs
(
u8
 
dwº_mtu
);

993 
u32
 
c⁄vît_byãs_to_dwº_mtu
(u32 
byãs
);

994 
rvu_nix_tx_é2_cfg
(
rvu
 *rvu, 
blkaddr
, 
u16
 
pcifunc
,

995 
nix_txsch
 *
txsch
, 
boﬁ
 
íabÀ
);

998 
rvu_≈c_‰ìmem
(
rvu
 *rvu);

999 
rvu_≈c_gë_pköd
(
rvu
 *rvu, 
u16
 
pf
);

1000 
rvu_≈c_£t_pköd
(
rvu
 *rvu, 
pköd
, 
rvu_pfvf
 *
pfvf
);

1001 
≈c_c⁄fig_ts_kpua˘i⁄
(
rvu
 *rvu, 
pf
, 
u16
 
pcifunc
, 
boﬁ
 
í
);

1002 
rvu_≈c_ö°Æl_uˇ°_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
,

1003 
nixlf
, 
u64
 
ch™
, 
u8
 *
mac_addr
);

1004 
rvu_≈c_ö°Æl_¥omisc_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
,

1005 
nixlf
, 
u64
 
ch™
, 
u8
 
ch™_˙t
);

1006 
rvu_≈c_íabÀ_¥omisc_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
,

1007 
boﬁ
 
íabÀ
);

1008 
rvu_≈c_ö°Æl_bˇ°_m©ch_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
,

1009 
nixlf
, 
u64
 
ch™
);

1010 
rvu_≈c_íabÀ_bˇ°_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
,

1011 
boﬁ
 
íabÀ
);

1012 
rvu_≈c_ö°Æl_Ælmu…i_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
,

1013 
u64
 
ch™
);

1014 
rvu_≈c_íabÀ_Ælmu…i_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
,

1015 
boﬁ
 
íabÀ
);

1017 
≈c_íadis_deÁu…_m˚_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
,

1018 
nixlf
, 
ty≥
, 
boﬁ
 
íabÀ
);

1019 
rvu_≈c_dißbÀ_mˇm_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
);

1020 
boﬁ
 
rvu_≈c_íabÀ_mˇm_by_íåy_ödex
(
rvu
 *rvu, 
íåy
, 
ötf
, boﬁ 
íabÀ
);

1021 
rvu_≈c_‰ì_mˇm_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
);

1022 
rvu_≈c_dißbÀ_deÁu…_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
);

1023 
rvu_≈c_íabÀ_deÁu…_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
);

1024 
rvu_≈c_upd©e_Êowkey_Æg_idx
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
,

1025 
group
, 
Æg_idx
, 
mˇm_ödex
);

1027 
rvu_≈c_gë_mˇm_íåy_Æloc_öfo
(
rvu
 *rvu, 
u16
 
pcifunc
,

1028 
blkaddr
, *
Æloc_˙t
,

1029 *
íabÀ_˙t
);

1030 
rvu_≈c_gë_mˇm_cou¡î_Æloc_öfo
(
rvu
 *rvu, 
u16
 
pcifunc
,

1031 
blkaddr
, *
Æloc_˙t
,

1032 *
íabÀ_˙t
);

1033 
boﬁ
 
is_≈c_ötf_tx
(
u8
 
ötf
);

1034 
boﬁ
 
is_≈c_ötf_rx
(
u8
 
ötf
);

1035 
boﬁ
 
is_≈c_öãrÁ˚_vÆid
(
rvu
 *rvu, 
u8
 
ötf
);

1036 
≈c_Êow_°ìrög_öô
(
rvu
 *rvu, 
blkaddr
);

1037 c⁄° *
≈c_gë_fõld_«me
(
u8
 
hdr
);

1038 
≈c_gë_b™k
(
≈c_mˇm
 *
mˇm
, 
ödex
);

1039 
≈c_mˇm_íabÀ_Êows
(
rvu
 *rvu, 
u16
 
èrgë
);

1040 
≈c_mˇm_dißbÀ_Êows
(
rvu
 *rvu, 
u16
 
èrgë
);

1041 
≈c_íabÀ_mˇm_íåy
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

1042 
blkaddr
, 
ödex
, 
boﬁ
 
íabÀ
);

1043 
≈c_ªad_mˇm_íåy
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

1044 
blkaddr
, 
u16
 
§c
, 
mˇm_íåy
 *
íåy
,

1045 
u8
 *
ötf
, u8 *
ía
);

1046 
boﬁ
 
is_mac_„©uª_suµ‹ãd
(
rvu
 *rvu, 
pf
, 
„©uª
);

1047 
u32
 
rvu_cgx_gë_fifﬁí
(
rvu
 *rvu);

1048 *
rvu_fú°_cgx_pd©a
(
rvu
 *rvu);

1049 
≈c_gë_nixlf_mˇm_ödex
(
≈c_mˇm
 *
mˇm
, 
u16
 
pcifunc
, 
nixlf
,

1050 
ty≥
);

1051 
boﬁ
 
is_mˇm_íåy_íabÀd
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
, 
blkaddr
,

1052 
ödex
);

1053 
rvu_≈c_öô
(
rvu
 *rvu);

1054 
≈c_ö°Æl_mˇm_dr›_ruÀ
(
rvu
 *rvu, 
mˇm_idx
, 
u16
 *
cou¡î_idx
,

1055 
u64
 
ch™_vÆ
, u64 
ch™_mask
, u64 
exa˘_vÆ
, u64 
exa˘_mask
,

1056 
u64
 
bˇ°_mˇ°_vÆ
, u64 
bˇ°_mˇ°_mask
);

1057 
≈c_mˇm_r§cs_ª£rve
(
rvu
 *rvu, 
blkaddr
, 
íåy_idx
);

1058 
boﬁ
 
≈c_is_„©uª_suµ‹ãd
(
rvu
 *rvu, 
u64
 
„©uªs
, 
u8
 
ötf
);

1061 
rvu_˝t_ªgi°î_öãºu±s
(
rvu
 *rvu);

1062 
rvu_˝t_uƒegi°î_öãºu±s
(
rvu
 *rvu);

1063 
rvu_˝t_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
blkaddr
, 
lf
,

1064 
¶Ÿ
);

1065 
rvu_˝t_˘x_Êush
(
rvu
 *rvu, 
u16
 
pcifunc
);

1066 
rvu_˝t_öô
(
rvu
 *rvu);

1067 
u32
 
rvu_gë_˝t_ch™_mask
(
rvu
 *rvu);

1070 
	#NDC_MAX_BANK
(
rvu
, 
blk_addr
Ë(
	`rvu_ªad64
(rvu, \

1071 
blk_addr
, 
NDC_AF_CONST
Ë& 0xFF)

	)

1072 
	#NDC_MAX_LINE_PER_BANK
(
rvu
, 
blk_addr
Ë((
	`rvu_ªad64
(rvu, \

1073 
blk_addr
, 
NDC_AF_CONST
Ë& 0xFFFF0000Ë>> 16)

	)

1076 
rvu_£t_ch™√ls_ba£
(
rvu
 *rvu);

1077 
rvu_¥ogøm_ch™√ls
(
rvu
 *rvu);

1080 
rvu_ª£t_lmt_m≠_tbl
(
rvu
 *rvu, 
u16
 
pcifunc
);

1081 
rvu_≠r_block_˙10k_öô
(
rvu
 *rvu);

1084 
rvu_tim_öô
(
rvu
 *rvu);

1085 
rvu_tim_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
lf
, 
¶Ÿ
);

1088 
rvu_ªe_öô
(
rvu
 *rvu);

1089 
rvu_ªe_‰ìmem
(
rvu
 *rvu);

1090 
rvu_ªe_ªgi°î_öãºu±s
(
rvu
 *rvu);

1091 
rvu_ªe_uƒegi°î_öãºu±s
(
rvu
 *rvu);

1093 #ifde‡
CONFIG_DEBUG_FS


1094 
rvu_dbg_öô
(
rvu
 *rvu);

1095 
rvu_dbg_exô
(
rvu
 *rvu);

1097 
ölöe
 
	$rvu_dbg_öô
(
rvu
 *rvuË{
	}
}

1098 
ölöe
 
	$rvu_dbg_exô
(
rvu
 *rvuË{
	}
}

1102 
rvu_nix_txsch_lock
(
nix_hw
 *nix_hw);

1103 
rvu_nix_txsch_u∆ock
(
nix_hw
 *nix_hw);

1104 
rvu_nix_upd©e_lök_¸edôs
(
rvu
 *rvu, 
blkaddr
,

1105 
lök
, 
u64
 
n¸edôs
);

1107 
rvu_nix_upd©e_sq_smq_m≠pög
(
rvu
 *rvu, 
blkaddr
, 
nixlf
,

1108 
u16
 
sq
, u16 
smq
);

1109 
rvu_nix_txsch_c⁄fig_ch™ged
(
nix_hw
 *nix_hw);

1110 
ssize_t
 
rvu_nix_gë_tx_°Æl_cou¡îs
(
nix_hw
 *nix_hw,

1111 
__u£r
 *
buf„r
, 
loff_t
 *
µos
);

1112 
rvu_nix_fixes_öô
(
rvu
 *rvu, 
nix_hw
 *nix_hw, 
blkaddr
);

1113 
rvu_nix_fixes_exô
(
rvu
 *rvu, 
nix_hw
 *nix_hw);

1114 
rvu_tim_lookup_r§c
(
rvu
 *rvu, 
rvu_block
 *
block
,

1115 
u16
 
pcifunc
, 
¶Ÿ
);

1116 
rvu_≈c_gë_tx_nibbÀ_cfg
(
rvu
 *rvu, 
u64
 
nibbÀ_ía
);

1117 
boﬁ
 
is_∑r£_nibbÀ_c⁄fig_vÆid
(
rvu
 *rvu,

1118 
≈c_mˇm_kex
 *
mˇm_kex
);

1120 
rvu_≈c_£t_∑r£_mode
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u64
 
mode
, 
u8
 
dú
,

1121 
u64
 
pköd
, 
u8
 
v¨_Àn_off
, u8 
v¨_Àn_off_mask
,

1122 
u8
 
shi·_dú
);

1123 
rvu_tim_hw_fixes
(
rvu
 *rvu, 
blkaddr
);

1124 
rvu_ndc_fix_locked_ˇchñöe
(
rvu
 *rvu, 
blkaddr
);

1125 
rvu_gë_hwvf
(
rvu
 *rvu, 
pcifunc
);

1128 
rvu_nix_block_˙10k_öô
(
rvu
 *rvu, 
nix_hw
 *nix_hw);

1131 
rvu_swôch_íabÀ
(
rvu
 *rvu);

1132 
rvu_swôch_dißbÀ
(
rvu
 *rvu);

1133 
rvu_swôch_upd©e_ruÀs
(
rvu
 *rvu, 
u16
 
pcifunc
);

1136 
rvu_mcs_öô
(
rvu
 *rvu);

1137 
rvu_mcs_Êr_h™dÀr
(
rvu
 *rvu, 
u16
 
pcifunc
);

1138 
rvu_mcs_exô
(
rvu
 *rvu);

	@rvu_cgx.c

8 
	~<löux/ty≥s.h
>

9 
	~<löux/moduÀ.h
>

10 
	~<löux/pci.h
>

12 
	~"rvu.h
"

13 
	~"cgx.h
"

14 
	~"lmac_comm⁄.h
"

15 
	~"rvu_ªg.h
"

16 
	~"rvu_åa˚.h
"

17 
	~"rvu_≈c_hash.h
"

19 
	scgx_evq_íåy
 {

20 
li°_hód
 
	mevq_node
;

21 
cgx_lök_evít
 
	mlök_evít
;

24 
	#M
(
_«me
, 
_id
, 
_‚_«me
, 
_ªq_ty≥
, 
_r•_ty≥
) \

25 
_ªq_ty≥
 
__maybe_unu£d
 \

26 *
Ÿx2_mbox_Æloc_msg_
 ## 
	`_‚_«me
(
rvu
 *rvu, 
devid
) \

28 
_ªq_ty≥
 *
ªq
; \

30 
ªq
 = (
_ªq_ty≥
 *)
	`Ÿx2_mbox_Æloc_msg_r•
( \

31 &
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
devid
, (
_ªq_ty≥
), \

32 (
_r•_ty≥
)); \

33 i‡(!
ªq
) \

34  
NULL
; \

35 
ªq
->
hdr
.
sig
 = 
OTX2_MBOX_REQ_SIG
; \

36 
ªq
->
hdr
.
id
 = 
_id
; \

37 
	`åa˚_Ÿx2_msg_Æloc
(
rvu
->
pdev
, 
_id
, (*
ªq
)); \

38  
ªq
; \

39 }

	)

41 
	gMBOX_UP_CGX_MESSAGES


42 #unde‡
M


44 
boﬁ
 
	$is_mac_„©uª_suµ‹ãd
(
rvu
 *rvu, 
pf
, 
„©uª
)

46 
u8
 
cgx_id
, 
lmac_id
;

47 *
cgxd
;

49 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

52 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

53 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

54 i‡(!
cgxd
)

57  (
	`cgx_„©uªs_gë
(
cgxd
Ë& 
„©uª
);

58 
	}
}

60 
	#CGX_OFFSET
(
x
Ë((xË* 
rvu
->
hw
->
lmac_≥r_cgx
)

	)

62 
ölöe
 
u64
 
	$cgxlmac_to_pfm≠
(
rvu
 *rvu, 
u8
 
cgx_id
, u8 
lmac_id
)

64  
rvu
->
cgxlmac2pf_m≠
[
	`CGX_OFFSET
(
cgx_id
Ë+ 
lmac_id
];

65 
	}
}

67 
	$cgxlmac_to_pf
(
rvu
 *rvu, 
cgx_id
, 
lmac_id
)

69 
pfm≠
;

71 
pfm≠
 = 
	`cgxlmac_to_pfm≠
(
rvu
, 
cgx_id
, 
lmac_id
);

74 i‡(!
pfm≠
)

75  -
ENODEV
;

77  
	`föd_fú°_bô
(&
pfm≠
,

78 
rvu
->
cgx_˙t_max
 *Ñvu->
hw
->
lmac_≥r_cgx
);

79 
	}
}

81 
ölöe
 
u8
 
	$cgxlmac_id_to_bm≠
(
u8
 
cgx_id
, u8 
lmac_id
)

83  ((
cgx_id
 & 0xFË<< 4Ë| (
lmac_id
 & 0xF);

84 
	}
}

86 *
	$rvu_cgx_pd©a
(
u8
 
cgx_id
, 
rvu
 *rvu)

88 i‡(
cgx_id
 >
rvu
->
cgx_˙t_max
)

89  
NULL
;

91  
rvu
->
cgx_idm≠
[
cgx_id
];

92 
	}
}

95 *
	$rvu_fú°_cgx_pd©a
(
rvu
 *rvu)

97 
fú°_íabÀd_cgx
 = 0;

98 *
cgxd
 = 
NULL
;

100 ; 
fú°_íabÀd_cgx
 < 
rvu
->
cgx_˙t_max
; first_enabled_cgx++) {

101 
cgxd
 = 
	`rvu_cgx_pd©a
(
fú°_íabÀd_cgx
, 
rvu
);

102 i‡(
cgxd
)

106  
cgxd
;

107 
	}
}

110 
	$rvu_m≠_cgx_nix_block
(
rvu
 *rvu, 
pf
,

111 
cgx_id
, 
lmac_id
)

113 
rvu_pfvf
 *
pfvf
 = &
rvu
->
pf
[pf];

114 
u8
 
p2x
;

116 
p2x
 = 
	`cgx_lmac_gë_p2x
(
cgx_id
, 
lmac_id
);

118 
pfvf
->
nix_blkaddr
 = 
BLKADDR_NIX0
;

119 i‡(
p2x
 =
CMR_P2X_SEL_NIX1
)

120 
pfvf
->
nix_blkaddr
 = 
BLKADDR_NIX1
;

121 
	}
}

123 
	$rvu_m≠_cgx_lmac_pf
(
rvu
 *rvu)

125 
≈c_pköd
 *
pköd
 = &
rvu
->
hw
->pkind;

126 
cgx_˙t_max
 = 
rvu
->cgx_cnt_max;

127 
pf
 = 
PF_CGXMAP_BASE
;

128 
lmac_bm≠
;

129 
size
, 
‰ì_pköd
;

130 
cgx
, 
lmac
, 
ôî
;

131 
numvfs
, 
hwvfs
;

133 i‡(!
cgx_˙t_max
)

136 i‡(
cgx_˙t_max
 > 0xF || 
rvu
->
hw
->
lmac_≥r_cgx
 > 0xF)

137  -
EINVAL
;

143 
size
 = (
cgx_˙t_max
 * 
rvu
->
hw
->
lmac_≥r_cgx
 + 1Ë* (
u8
);

144 
rvu
->
pf2cgxlmac_m≠
 = 
	`devm_kmÆloc
‘vu->
dev
, 
size
, 
GFP_KERNEL
);

145 i‡(!
rvu
->
pf2cgxlmac_m≠
)

146  -
ENOMEM
;

149 
	`mem£t
(
rvu
->
pf2cgxlmac_m≠
, 0xFF, 
size
);

152 
rvu
->
cgxlmac2pf_m≠
 =

153 
	`devm_kzÆloc
(
rvu
->
dev
,

154 
cgx_˙t_max
 * 
rvu
->
hw
->
lmac_≥r_cgx
 * (
u64
),

155 
GFP_KERNEL
);

156 i‡(!
rvu
->
cgxlmac2pf_m≠
)

157  -
ENOMEM
;

159 
rvu
->
cgx_m≠≥d_pfs
 = 0;

160 
cgx
 = 0; cgx < 
cgx_˙t_max
; cgx++) {

161 i‡(!
	`rvu_cgx_pd©a
(
cgx
, 
rvu
))

163 
lmac_bm≠
 = 
	`cgx_gë_lmac_bm≠
(
	`rvu_cgx_pd©a
(
cgx
, 
rvu
));

164 
	`f‹_óch_£t_bô
(
ôî
, &
lmac_bm≠
, 
rvu
->
hw
->
lmac_≥r_cgx
) {

165 
lmac
 = 
	`cgx_gë_lmacid
(
	`rvu_cgx_pd©a
(
cgx
, 
rvu
),

166 
ôî
);

167 
rvu
->
pf2cgxlmac_m≠
[
pf
] = 
	`cgxlmac_id_to_bm≠
(
cgx
, 
lmac
);

168 
rvu
->
cgxlmac2pf_m≠
[
	`CGX_OFFSET
(
cgx
Ë+ 
lmac
] = 1 << 
pf
;

169 
‰ì_pköd
 = 
	`rvu_Æloc_r§c
(&
pköd
->
r§c
);

170 
pköd
->
pfch™_m≠
[
‰ì_pköd
] = ((
pf
) & 0x3F) << 16;

171 
	`rvu_m≠_cgx_nix_block
(
rvu
, 
pf
, 
cgx
, 
lmac
);

172 
rvu
->
cgx_m≠≥d_pfs
++;

173 
	`rvu_gë_pf_numvfs
(
rvu
, 
pf
, &
numvfs
, &
hwvfs
);

174 
rvu
->
cgx_m≠≥d_vfs
 +
numvfs
;

175 
pf
++;

179 
	}
}

181 
	$rvu_cgx_£nd_lök_öfo
(
cgx_id
, 
lmac_id
, 
rvu
 *rvu)

183 
cgx_evq_íåy
 *
qíåy
;

184 
Êags
;

185 
îr
;

187 
qíåy
 = 
	`kmÆloc
((*qíåy), 
GFP_KERNEL
);

188 i‡(!
qíåy
)

189  -
ENOMEM
;

192 
	`•ö_lock_úqßve
(&
rvu
->
cgx_evq_lock
, 
Êags
);

193 
îr
 = 
	`cgx_gë_lök_öfo
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
), 
lmac_id
,

194 &
qíåy
->
lök_evít
.
lök_uöfo
);

195 
qíåy
->
lök_evít
.
cgx_id
 = cgx_id;

196 
qíåy
->
lök_evít
.
lmac_id
 =Ümac_id;

197 i‡(
îr
) {

198 
	`k‰ì
(
qíåy
);

199 
skù_add
;

201 
	`li°_add_èû
(&
qíåy
->
evq_node
, &
rvu
->
cgx_evq_hód
);

202 
skù_add
:

203 
	`•ö_u∆ock_úqª°‹e
(&
rvu
->
cgx_evq_lock
, 
Êags
);

206 
	`queue_w‹k
(
rvu
->
cgx_evh_wq
, &rvu->
cgx_evh_w‹k
);

209 
	}
}

212 
	$cgx_lmac_po°evít
(
cgx_lök_evít
 *
evít
, *
d©a
)

214 
cgx_evq_íåy
 *
qíåy
;

215 
rvu
 *rvu = 
d©a
;

218 
qíåy
 = 
	`kmÆloc
((*qíåy), 
GFP_ATOMIC
);

219 i‡(!
qíåy
)

220  -
ENOMEM
;

221 
qíåy
->
lök_evít
 = *
evít
;

222 
	`•ö_lock
(&
rvu
->
cgx_evq_lock
);

223 
	`li°_add_èû
(&
qíåy
->
evq_node
, &
rvu
->
cgx_evq_hód
);

224 
	`•ö_u∆ock
(&
rvu
->
cgx_evq_lock
);

227 
	`queue_w‹k
(
rvu
->
cgx_evh_wq
, &rvu->
cgx_evh_w‹k
);

230 
	}
}

232 
	$cgx_nŸify_pfs
(
cgx_lök_evít
 *
evít
, 
rvu
 *rvu)

234 
cgx_lök_u£r_öfo
 *
löfo
;

235 
cgx_lök_öfo_msg
 *
msg
;

236 
pfm≠
;

237 
îr
, 
pfid
;

239 
löfo
 = &
evít
->
lök_uöfo
;

240 
pfm≠
 = 
	`cgxlmac_to_pfm≠
(
rvu
, 
evít
->
cgx_id
,Évít->
lmac_id
);

243 
pfid
 = 
	`föd_fú°_bô
(&
pfm≠
,

244 
rvu
->
cgx_˙t_max
 *Ñvu->
hw
->
lmac_≥r_cgx
);

245 
	`˛ór_bô
(
pfid
, &
pfm≠
);

248 i‡(!
	`ã°_bô
(
pfid
, &
rvu
->
pf_nŸify_bm≠
))

252 
msg
 = 
	`Ÿx2_mbox_Æloc_msg_cgx_lök_evít
(
rvu
, 
pfid
);

253 i‡(!
msg
)

255 
msg
->
lök_öfo
 = *
löfo
;

256 
	`Ÿx2_mbox_msg_£nd
(&
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
pfid
);

257 
îr
 = 
	`Ÿx2_mbox_waô_f‹_r•
(&
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
pfid
);

258 i‡(
îr
)

259 
	`dev_w¨n
(
rvu
->
dev
, "notificationÅoÖf %d failed\n",

260 
pfid
);

261 } 
pfm≠
);

262 
	}
}

264 
	$cgx_evh™dÀr_èsk
(
w‹k_°ru˘
 *
w‹k
)

266 
rvu
 *rvu = 
	`c⁄èöî_of
(
w‹k
, rvu, 
cgx_evh_w‹k
);

267 
cgx_evq_íåy
 *
qíåy
;

268 
cgx_lök_evít
 *
evít
;

269 
Êags
;

273 
	`•ö_lock_úqßve
(&
rvu
->
cgx_evq_lock
, 
Êags
);

274 
qíåy
 = 
	`li°_fú°_íåy_‹_nuŒ
(&
rvu
->
cgx_evq_hód
,

275 
cgx_evq_íåy
,

276 
evq_node
);

277 i‡(
qíåy
)

278 
	`li°_dñ
(&
qíåy
->
evq_node
);

279 
	`•ö_u∆ock_úqª°‹e
(&
rvu
->
cgx_evq_lock
, 
Êags
);

280 i‡(!
qíåy
)

283 
evít
 = &
qíåy
->
lök_evít
;

286 
	`cgx_nŸify_pfs
(
evít
, 
rvu
);

287 
	`k‰ì
(
qíåy
);

289 
	}
}

291 
	$cgx_lmac_evít_h™dÀr_öô
(
rvu
 *rvu)

293 
lmac_bm≠
;

294 
cgx_evít_cb
 
cb
;

295 
cgx
, 
lmac
, 
îr
;

296 *
cgxd
;

298 
	`•ö_lock_öô
(&
rvu
->
cgx_evq_lock
);

299 
	`INIT_LIST_HEAD
(&
rvu
->
cgx_evq_hód
);

300 
	`INIT_WORK
(&
rvu
->
cgx_evh_w‹k
, 
cgx_evh™dÀr_èsk
);

301 
rvu
->
cgx_evh_wq
 = 
	`Æloc_w‹kqueue
("rvu_evh_wq", 0, 0);

302 i‡(!
rvu
->
cgx_evh_wq
) {

303 
	`dev_îr
(
rvu
->
dev
, "alloc workqueue failed");

304  -
ENOMEM
;

307 
cb
.
nŸify_lök_chg
 = 
cgx_lmac_po°evít
;

308 
cb
.
d©a
 = 
rvu
;

310 
cgx
 = 0; cgx <
rvu
->
cgx_˙t_max
; cgx++) {

311 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx
, 
rvu
);

312 i‡(!
cgxd
)

314 
lmac_bm≠
 = 
	`cgx_gë_lmac_bm≠
(
cgxd
);

315 
	`f‹_óch_£t_bô
(
lmac
, &
lmac_bm≠
, 
rvu
->
hw
->
lmac_≥r_cgx
) {

316 
îr
 = 
	`cgx_lmac_evh_ªgi°î
(&
cb
, 
cgxd
, 
lmac
);

317 i‡(
îr
)

318 
	`dev_îr
(
rvu
->
dev
,

320 
cgx
, 
lmac
);

325 
	}
}

327 
	$rvu_cgx_wq_de°roy
(
rvu
 *rvu)

329 i‡(
rvu
->
cgx_evh_wq
) {

330 
	`Êush_w‹kqueue
(
rvu
->
cgx_evh_wq
);

331 
	`de°roy_w‹kqueue
(
rvu
->
cgx_evh_wq
);

332 
rvu
->
cgx_evh_wq
 = 
NULL
;

334 
	}
}

336 
	$rvu_cgx_öô
(
rvu
 *rvu)

338 
cgx
, 
îr
;

339 *
cgxd
;

344 
rvu
->
cgx_˙t_max
 = 
	`cgx_gë_cgx˙t_max
();

345 i‡(!
rvu
->
cgx_˙t_max
) {

346 
	`dev_öfo
(
rvu
->
dev
, "No CGX devices found!\n");

350 
rvu
->
cgx_idm≠
 = 
	`devm_kzÆloc
‘vu->
dev
,Ñvu->
cgx_˙t_max
 *

351 (*), 
GFP_KERNEL
);

352 i‡(!
rvu
->
cgx_idm≠
)

353  -
ENOMEM
;

356 
cgx
 = 0; cgx < 
rvu
->
cgx_˙t_max
; cgx++)

357 
rvu
->
cgx_idm≠
[
cgx
] = 
	`cgx_gë_pd©a
(cgx);

360 
îr
 = 
	`rvu_m≠_cgx_lmac_pf
(
rvu
);

361 i‡(
îr
)

362  
îr
;

365 
îr
 = 
	`cgx_lmac_evít_h™dÀr_öô
(
rvu
);

366 i‡(
îr
)

367  
îr
;

369 
	`muãx_öô
(&
rvu
->
cgx_cfg_lock
);

374 
	`mb
();

377 
cgx
 = 0; cgx <
rvu
->
cgx_˙t_max
; cgx++) {

378 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx
, 
rvu
);

379 i‡(!
cgxd
)

381 
îr
 = 
	`cgx_lmac_lökup_°¨t
(
cgxd
);

382 i‡(
îr
)

383 
	`dev_îr
(
rvu
->
dev
,

385 
cgx
);

389 
	}
}

391 
	$rvu_cgx_exô
(
rvu
 *rvu)

393 
lmac_bm≠
;

394 
cgx
, 
lmac
;

395 *
cgxd
;

397 
cgx
 = 0; cgx <
rvu
->
cgx_˙t_max
; cgx++) {

398 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx
, 
rvu
);

399 i‡(!
cgxd
)

401 
lmac_bm≠
 = 
	`cgx_gë_lmac_bm≠
(
cgxd
);

402 
	`f‹_óch_£t_bô
(
lmac
, &
lmac_bm≠
, 
rvu
->
hw
->
lmac_≥r_cgx
)

403 
	`cgx_lmac_evh_uƒegi°î
(
cgxd
, 
lmac
);

407 
	`mb
();

409 
	`rvu_cgx_wq_de°roy
(
rvu
);

411 
	}
}

417 
ölöe
 
boﬁ
 
	$is_cgx_c⁄fig_≥rmôãd
(
rvu
 *rvu, 
u16
 
pcifunc
)

419 i‡((
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) ||

420 !
	`is_pf_cgxm≠≥d
(
rvu
, 
	`rvu_gë_pf
(
pcifunc
)))

421  
Ál£
;

422  
åue
;

423 
	}
}

425 
	$rvu_cgx_íadis_rx_bp
(
rvu
 *rvu, 
pf
, 
boﬁ
 
íabÀ
)

427 
mac_›s
 *mac_ops;

428 
u8
 
cgx_id
, 
lmac_id
;

429 *
cgxd
;

431 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

434 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

435 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

437 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

439 i‡(
íabÀ
)

440 
mac_›s
->
	`mac_íadis_rx_∑u£_fwdög
(
cgxd
, 
lmac_id
, 
åue
);

442 
mac_›s
->
	`mac_íadis_rx_∑u£_fwdög
(
cgxd
, 
lmac_id
, 
Ál£
);

443 
	}
}

445 
	$rvu_cgx_íadis_higig2
(
rvu
 *rvu, 
pf
, 
boﬁ
 
íabÀ
)

447 
u8
 
cgx_id
, 
lmac_id
;

448 *
cgxd
;

450 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

453 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

454 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

455 
	`cgx_lmac_íadis_higig2
(
cgxd
, 
lmac_id
, 
íabÀ
);

456 
	}
}

458 
boﬁ
 
	$rvu_cgx_is_higig2_íabÀd
(
rvu
 *rvu, 
pf
)

460 
u8
 
cgx_id
, 
lmac_id
;

461 *
cgxd
;

463 i‡(!
	`is_mac_„©uª_suµ‹ãd
(
rvu
, 
pf
, 
RVU_LMAC_FEAT_HIGIG2
))

466 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

467  
Ál£
;

469 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

470 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

472  
	`is_higig2_íabÀd
(
cgxd
, 
lmac_id
);

473 
	}
}

475 
	$rvu_cgx_c⁄fig_rxtx
(
rvu
 *rvu, 
u16
 
pcifunc
, 
boﬁ
 
°¨t
)

477 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

478 
mac_›s
 *mac_ops;

479 
u8
 
cgx_id
, 
lmac_id
;

480 *
cgxd
;

482 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
))

483  
LMAC_AF_ERR_PERM_DENIED
;

485 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

486 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

487 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

489  
mac_›s
->
	`mac_rx_tx_íabÀ
(
cgxd
, 
lmac_id
, 
°¨t
);

490 
	}
}

492 
	$rvu_cgx_tx_íabÀ
(
rvu
 *rvu, 
u16
 
pcifunc
, 
boﬁ
 
íabÀ
)

494 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

495 
mac_›s
 *mac_ops;

496 
u8
 
cgx_id
, 
lmac_id
;

497 *
cgxd
;

499 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
))

502 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

503 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

504 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

506  
mac_›s
->
	`mac_tx_íabÀ
(
cgxd
, 
lmac_id
, 
íabÀ
);

507 
	}
}

509 
	$rvu_cgx_c⁄fig_tx
(*
cgxd
, 
lmac_id
, 
boﬁ
 
íabÀ
)

511 
mac_›s
 *mac_ops;

513 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

514  
mac_›s
->
	`mac_tx_íabÀ
(
cgxd
, 
lmac_id
, 
íabÀ
);

515 
	}
}

517 
	$rvu_cgx_dißbÀ_dmac_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
)

519 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

520 
i
 = 0, 
lmac_cou¡
 = 0;

521 
mac_›s
 *mac_ops;

522 
u8
 
max_dmac_fûãrs
;

523 
u8
 
cgx_id
, 
lmac_id
;

524 *
cgx_dev
;

526 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
))

529 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
)) {

530 
	`rvu_≈c_exa˘_ª£t
(
rvu
, 
pcifunc
);

534 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

535 
cgx_dev
 = 
	`cgx_gë_pd©a
(
cgx_id
);

536 
lmac_cou¡
 = 
	`cgx_gë_lmac_˙t
(
cgx_dev
);

538 
mac_›s
 = 
	`gë_mac_›s
(
cgx_dev
);

539 i‡(!
mac_›s
)

542 
max_dmac_fûãrs
 = 
mac_›s
->
dmac_fûãr_cou¡
 / 
lmac_cou¡
;

544 
i
 = 0; i < 
max_dmac_fûãrs
; i++)

545 
	`cgx_lmac_addr_dñ
(
cgx_id
, 
lmac_id
, 
i
);

550 
	`cgx_lmac_addr_ª£t
(
cgx_id
, 
lmac_id
);

551 
	}
}

553 
	$rvu_mbox_h™dÀr_cgx_°¨t_rxtx
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

554 
msg_r•
 *
r•
)

556 
	`rvu_cgx_c⁄fig_rxtx
(
rvu
, 
ªq
->
hdr
.
pcifunc
, 
åue
);

558 
	}
}

560 
	$rvu_mbox_h™dÀr_cgx_°›_rxtx
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

561 
msg_r•
 *
r•
)

563 
	`rvu_cgx_c⁄fig_rxtx
(
rvu
, 
ªq
->
hdr
.
pcifunc
, 
Ál£
);

565 
	}
}

567 
	$rvu_lmac_gë_°©s
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

568 *
r•
)

570 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

571 
mac_›s
 *mac_ops;

572 
°©
 = 0, 
îr
 = 0;

573 
u64
 
tx_°©
, 
rx_°©
;

574 
u8
 
cgx_idx
, 
lmac
;

575 *
cgxd
;

577 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

578  
LMAC_AF_ERR_PERM_DENIED
;

580 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_idx
, &
lmac
);

581 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_idx
, 
rvu
);

582 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

584 
°©
 < 
mac_›s
->
rx_°©s_˙t
) {

585 
îr
 = 
mac_›s
->
	`mac_gë_rx_°©s
(
cgxd
, 
lmac
, 
°©
, &
rx_°©
);

586 i‡(
îr
)

587  
îr
;

588 i‡(
mac_›s
->
rx_°©s_˙t
 =
RPM_RX_STATS_COUNT
)

589 ((
Ωm_°©s_r•
 *)
r•
)->
rx_°©s
[
°©
] = 
rx_°©
;

591 ((
cgx_°©s_r•
 *)
r•
)->
rx_°©s
[
°©
] = 
rx_°©
;

592 
°©
++;

596 
°©
 = 0;

597 
°©
 < 
mac_›s
->
tx_°©s_˙t
) {

598 
îr
 = 
mac_›s
->
	`mac_gë_tx_°©s
(
cgxd
, 
lmac
, 
°©
, &
tx_°©
);

599 i‡(
îr
)

600  
îr
;

601 i‡(
mac_›s
->
tx_°©s_˙t
 =
RPM_TX_STATS_COUNT
)

602 ((
Ωm_°©s_r•
 *)
r•
)->
tx_°©s
[
°©
] = 
tx_°©
;

604 ((
cgx_°©s_r•
 *)
r•
)->
tx_°©s
[
°©
] = 
tx_°©
;

605 
°©
++;

608 
	}
}

610 
	$rvu_mbox_h™dÀr_cgx_°©s
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

611 
cgx_°©s_r•
 *
r•
)

613  
	`rvu_lmac_gë_°©s
(
rvu
, 
ªq
, (*)
r•
);

614 
	}
}

616 
	$rvu_mbox_h™dÀr_Ωm_°©s
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

617 
Ωm_°©s_r•
 *
r•
)

619  
	`rvu_lmac_gë_°©s
(
rvu
, 
ªq
, (*)
r•
);

620 
	}
}

622 
	$rvu_mbox_h™dÀr_cgx_„c_°©s
(
rvu
 *rvu,

623 
msg_ªq
 *
ªq
,

624 
cgx_„c_°©s_r•
 *
r•
)

626 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

627 
mac_›s
 *mac_ops;

628 
u8
 
cgx_idx
, 
lmac
;

629 *
cgxd
;

631 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

632  
LMAC_AF_ERR_PERM_DENIED
;

633 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_idx
, &
lmac
);

635 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_idx
, 
rvu
);

636 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

637  
mac_›s
->
	`gë_„c_°©s
(
cgxd
, 
lmac
, 
r•
);

638 
	}
}

640 
	$rvu_mbox_h™dÀr_cgx_°©s_r°
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

641 
msg_r•
 *
r•
)

643 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

644 
rvu_pfvf
 *
∑ª¡_pf
;

645 
u8
 
cgx_idx
, 
lmac
;

646 *
cgxd
;

648 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

649  
LMAC_AF_ERR_PERM_DENIED
;

651 
∑ª¡_pf
 = &
rvu
->
pf
[pf];

656 i‡(
∑ª¡_pf
->
cgx_u£rs
 > 1) {

657 
	`dev_öfo
(
rvu
->
dev
, "CGX busy, couldÇotÑeset statistics\n");

661 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_idx
, &
lmac
);

662 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_idx
, 
rvu
);

664  
	`cgx_°©s_r°
(
cgxd
, 
lmac
);

665 
	}
}

667 
	$rvu_mbox_h™dÀr_cgx_mac_addr_£t
(
rvu
 *rvu,

668 
cgx_mac_addr_£t_‹_gë
 *
ªq
,

669 
cgx_mac_addr_£t_‹_gë
 *
r•
)

671 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

672 
rvu_pfvf
 *
pfvf
;

673 
u8
 
cgx_id
, 
lmac_id
;

675 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

676  
LMAC_AF_ERR_PF_NOT_MAPPED
;

678 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

679  
	`rvu_≈c_exa˘_mac_addr_£t
(
rvu
, 
ªq
, 
r•
);

681 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

683 
pfvf
 = &
rvu
->
pf
[pf];

684 
	`mem˝y
(
pfvf
->
mac_addr
, 
ªq
->mac_addr, 
ETH_ALEN
);

685 
	`cgx_lmac_addr_£t
(
cgx_id
, 
lmac_id
, 
ªq
->
mac_addr
);

688 
	}
}

690 
	$rvu_mbox_h™dÀr_cgx_mac_addr_add
(
rvu
 *rvu,

691 
cgx_mac_addr_add_ªq
 *
ªq
,

692 
cgx_mac_addr_add_r•
 *
r•
)

694 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

695 
u8
 
cgx_id
, 
lmac_id
;

696 
rc
 = 0;

698 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

699  
LMAC_AF_ERR_PERM_DENIED
;

701 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

702  
	`rvu_≈c_exa˘_mac_addr_add
(
rvu
, 
ªq
, 
r•
);

704 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

705 
rc
 = 
	`cgx_lmac_addr_add
(
cgx_id
, 
lmac_id
, 
ªq
->
mac_addr
);

706 i‡(
rc
 >= 0) {

707 
r•
->
ödex
 = 
rc
;

711  
rc
;

712 
	}
}

714 
	$rvu_mbox_h™dÀr_cgx_mac_addr_dñ
(
rvu
 *rvu,

715 
cgx_mac_addr_dñ_ªq
 *
ªq
,

716 
msg_r•
 *
r•
)

718 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

719 
u8
 
cgx_id
, 
lmac_id
;

721 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

722  
LMAC_AF_ERR_PERM_DENIED
;

724 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

725  
	`rvu_≈c_exa˘_mac_addr_dñ
(
rvu
, 
ªq
, 
r•
);

727 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

728  
	`cgx_lmac_addr_dñ
(
cgx_id
, 
lmac_id
, 
ªq
->
ödex
);

729 
	}
}

731 
	$rvu_mbox_h™dÀr_cgx_mac_max_íåõs_gë
(
rvu
 *rvu,

732 
msg_ªq
 *
ªq
,

733 
cgx_max_dmac_íåõs_gë_r•
 *
r•
)

735 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

736 
u8
 
cgx_id
, 
lmac_id
;

742 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
)) {

743 
r•
->
max_dmac_fûãrs
 = 0;

747 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
)) {

748 
r•
->
max_dmac_fûãrs
 = 
	`rvu_≈c_exa˘_gë_max_íåõs
(
rvu
);

752 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

753 
r•
->
max_dmac_fûãrs
 = 
	`cgx_lmac_addr_max_íåõs_gë
(
cgx_id
, 
lmac_id
);

755 
	}
}

757 
	$rvu_mbox_h™dÀr_cgx_mac_addr_gë
(
rvu
 *rvu,

758 
cgx_mac_addr_£t_‹_gë
 *
ªq
,

759 
cgx_mac_addr_£t_‹_gë
 *
r•
)

761 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

762 
i
;

764 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
)))

765  
LMAC_AF_ERR_PF_NOT_MAPPED
;

768 
i
 = 0; i < 
ETH_ALEN
; i++)

769 
r•
->
mac_addr
[
i
] = 
pfvf
->mac_addr[i];

772 
	}
}

774 
	$rvu_mbox_h™dÀr_cgx_¥omisc_íabÀ
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

775 
msg_r•
 *
r•
)

777 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

778 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

779 
u8
 
cgx_id
, 
lmac_id
;

781 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

782  
LMAC_AF_ERR_PERM_DENIED
;

785 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

786  
	`rvu_≈c_exa˘_¥omisc_íabÀ
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

788 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

790 
	`cgx_lmac_¥omisc_c⁄fig
(
cgx_id
, 
lmac_id
, 
åue
);

792 
	}
}

794 
	$rvu_mbox_h™dÀr_cgx_¥omisc_dißbÀ
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

795 
msg_r•
 *
r•
)

797 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

798 
u8
 
cgx_id
, 
lmac_id
;

800 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

801  
LMAC_AF_ERR_PERM_DENIED
;

804 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

805  
	`rvu_≈c_exa˘_¥omisc_dißbÀ
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

807 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

809 
	`cgx_lmac_¥omisc_c⁄fig
(
cgx_id
, 
lmac_id
, 
Ál£
);

811 
	}
}

813 
	$cgx_nŸify_up_±p_öfo
(
rvu
 *rvu, 
pf
, 
boﬁ
 
íabÀ
)

815 
cgx_±p_rx_öfo_msg
 *
msg
;

816 
îr
;

819 
msg
 = 
	`Ÿx2_mbox_Æloc_msg_cgx_±p_rx_öfo
(
rvu
, 
pf
);

820 i‡(!
msg
) {

821 
	`dev_îr
(
rvu
->
dev
, "±∞nŸifiˇti⁄Åÿp‡%d faûed\n", 
pf
);

825 
msg
->
±p_í
 = 
íabÀ
;

826 
	`Ÿx2_mbox_msg_£nd
(&
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
pf
);

827 
îr
 = 
	`Ÿx2_mbox_waô_f‹_r•
(&
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
pf
);

828 i‡(
îr
)

829 
	`dev_îr
(
rvu
->
dev
, "±∞nŸifiˇti⁄Åÿp‡%d faûed\n", 
pf
);

830 
	}
}

832 
	$rvu_mbox_h™dÀr_cgx_±p_rx_íabÀ
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

833 
msg_r•
 *
r•
)

835 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

836 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

837 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

838 
mac_›s
 *mac_ops;

839 
u8
 
cgx_id
, 
lmac_id
;

840 *
cgxd
;

842 i‡(!
	`is_mac_„©uª_suµ‹ãd
(
rvu
, 
pf
, 
RVU_LMAC_FEAT_PTP
))

845 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
	`rvu_gë_pf
(
pcifunc
)))

846  -
EPERM
;

849 i‡(
	`rvu_cgx_is_higig2_íabÀd
(
rvu
, 
pf
))

850  
NIX_AF_ERR_PTP_CONFIG_FAIL
;

852 
	`cgx_nŸify_up_±p_öfo
(
rvu
, 
pf
, 
åue
);

854 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

855 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

857 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

858 
mac_›s
->
	`mac_íadis_±p_c⁄fig
(
cgxd
, 
lmac_id
, 
åue
);

863 i‡(
	`≈c_c⁄fig_ts_kpua˘i⁄
(
rvu
, 
pf
, 
pcifunc
, 
åue
))

864  
NIX_AF_ERR_PTP_CONFIG_FAIL
;

867 
pfvf
->
hw_rx_t°amp_í
 = 
åue
;

870 
	}
}

872 
	$rvu_mbox_h™dÀr_cgx_±p_rx_dißbÀ
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

873 
msg_r•
 *
r•
)

875 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

876 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

877 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

878 
mac_›s
 *mac_ops;

879 
u8
 
cgx_id
, 
lmac_id
;

880 *
cgxd
;

882 i‡(!
	`is_mac_„©uª_suµ‹ãd
(
rvu
, 
pf
, 
RVU_LMAC_FEAT_PTP
))

885 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
))

886  
LMAC_AF_ERR_PERM_DENIED
;

888 
	`cgx_nŸify_up_±p_öfo
(
rvu
, 
pf
, 
Ál£
);

890 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

891 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

893 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

894 
mac_›s
->
	`mac_íadis_±p_c⁄fig
(
cgxd
, 
lmac_id
, 
Ál£
);

897 i‡(
	`≈c_c⁄fig_ts_kpua˘i⁄
(
rvu
, 
pf
, 
pcifunc
, 
Ál£
))

898  
NIX_AF_ERR_PTP_CONFIG_FAIL
;

900 
pfvf
->
hw_rx_t°amp_í
 = 
Ál£
;

903 
	}
}

905 
	$rvu_cgx_c⁄fig_lökevíts
(
rvu
 *rvu, 
u16
 
pcifunc
, 
boﬁ
 
í
)

907 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

908 
u8
 
cgx_id
, 
lmac_id
;

910 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
))

911  
LMAC_AF_ERR_PERM_DENIED
;

913 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

915 i‡(
í
) {

916 
	`£t_bô
(
pf
, &
rvu
->
pf_nŸify_bm≠
);

918 
	`rvu_cgx_£nd_lök_öfo
(
cgx_id
, 
lmac_id
, 
rvu
);

920 
	`˛ór_bô
(
pf
, &
rvu
->
pf_nŸify_bm≠
);

924 
	}
}

926 
	$rvu_mbox_h™dÀr_cgx_°¨t_lökevíts
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

927 
msg_r•
 *
r•
)

929 
	`rvu_cgx_c⁄fig_lökevíts
(
rvu
, 
ªq
->
hdr
.
pcifunc
, 
åue
);

931 
	}
}

933 
	$rvu_mbox_h™dÀr_cgx_°›_lökevíts
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

934 
msg_r•
 *
r•
)

936 
	`rvu_cgx_c⁄fig_lökevíts
(
rvu
, 
ªq
->
hdr
.
pcifunc
, 
Ál£
);

938 
	}
}

940 
	$rvu_mbox_h™dÀr_cgx_gë_lököfo
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

941 
cgx_lök_öfo_msg
 *
r•
)

943 
u8
 
cgx_id
, 
lmac_id
;

944 
pf
, 
îr
;

946 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

948 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

949  
LMAC_AF_ERR_PF_NOT_MAPPED
;

951 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

953 
îr
 = 
	`cgx_gë_lök_öfo
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
), 
lmac_id
,

954 &
r•
->
lök_öfo
);

955  
îr
;

956 
	}
}

958 
	$rvu_cgx_c⁄fig_öébk
(
rvu
 *rvu, 
u16
 
pcifunc
, 
boﬁ
 
í
)

960 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

961 
mac_›s
 *mac_ops;

962 
u8
 
cgx_id
, 
lmac_id
;

964 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
))

965  
LMAC_AF_ERR_PERM_DENIED
;

967 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

968 
mac_›s
 = 
	`gë_mac_›s
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
));

970  
mac_›s
->
	`mac_lmac_öé_lbk
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
),

971 
lmac_id
, 
í
);

972 
	}
}

974 
	$rvu_mbox_h™dÀr_cgx_öébk_íabÀ
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

975 
msg_r•
 *
r•
)

977 
	`rvu_cgx_c⁄fig_öébk
(
rvu
, 
ªq
->
hdr
.
pcifunc
, 
åue
);

979 
	}
}

981 
	$rvu_mbox_h™dÀr_cgx_öébk_dißbÀ
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

982 
msg_r•
 *
r•
)

984 
	`rvu_cgx_c⁄fig_öébk
(
rvu
, 
ªq
->
hdr
.
pcifunc
, 
Ál£
);

986 
	}
}

988 
	$rvu_cgx_cfg_∑u£_‰m
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u8
 
tx_∑u£
, u8 
rx_∑u£
)

990 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

991 
u8
 
rx_pfc
 = 0, 
tx_pfc
 = 0;

992 
mac_›s
 *mac_ops;

993 
u8
 
cgx_id
, 
lmac_id
;

994 *
cgxd
;

996 i‡(!
	`is_mac_„©uª_suµ‹ãd
(
rvu
, 
pf
, 
RVU_LMAC_FEAT_FC
))

1002 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1003  
LMAC_AF_ERR_PF_NOT_MAPPED
;

1005 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1006 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

1007 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

1009 
mac_›s
->
	`mac_gë_pfc_‰m_cfg
(
cgxd
, 
lmac_id
, &
tx_pfc
, &
rx_pfc
);

1010 i‡(
tx_pfc
 || 
rx_pfc
) {

1011 
	`dev_w¨n
(
rvu
->
dev
,

1013  
LMAC_AF_ERR_8023PAUSE_ENADIS_PERM_DENIED
;

1016 
	`muãx_lock
(&
rvu
->
r§c_lock
);

1017 i‡(
	`vîify_lmac_fc_cfg
(
cgxd
, 
lmac_id
, 
tx_∑u£
, 
rx_∑u£
,

1018 
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)) {

1019 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

1020  
LMAC_AF_ERR_PERM_DENIED
;

1022 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

1024  
mac_›s
->
	`mac_íadis_∑u£_‰m
(
cgxd
, 
lmac_id
, 
tx_∑u£
, 
rx_∑u£
);

1025 
	}
}

1027 
	$rvu_mbox_h™dÀr_cgx_cfg_∑u£_‰m
(
rvu
 *rvu,

1028 
cgx_∑u£_‰m_cfg
 *
ªq
,

1029 
cgx_∑u£_‰m_cfg
 *
r•
)

1031 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1032 
mac_›s
 *mac_ops;

1033 
u8
 
cgx_id
, 
lmac_id
;

1034 
îr
 = 0;

1035 *
cgxd
;

1040 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1041  
LMAC_AF_ERR_PF_NOT_MAPPED
;

1043 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1044 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

1045 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

1047 i‡(
ªq
->
£t
)

1048 
îr
 = 
	`rvu_cgx_cfg_∑u£_‰m
(
rvu
, 
ªq
->
hdr
.
pcifunc
,Ñeq->
tx_∑u£
,Ñeq->
rx_∑u£
);

1050 
mac_›s
->
	`mac_gë_∑u£_‰m_°©us
(
cgxd
, 
lmac_id
, &
r•
->
tx_∑u£
, &r•->
rx_∑u£
);

1052  
îr
;

1053 
	}
}

1055 
	$rvu_mbox_h™dÀr_cgx_gë_phy_„c_°©s
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

1056 
msg_r•
 *
r•
)

1058 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1059 
u8
 
cgx_id
, 
lmac_id
;

1061 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1062  
LMAC_AF_ERR_PF_NOT_MAPPED
;

1064 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1065  
	`cgx_gë_phy_„c_°©s
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
), 
lmac_id
);

1066 
	}
}

1068 
	$rvu_cgx_°¨t_°›_io
(
rvu
 *rvu, 
u16
 
pcifunc
, 
boﬁ
 
°¨t
)

1070 
rvu_pfvf
 *
∑ª¡_pf
, *
pfvf
;

1071 
cgx_u£rs
, 
îr
 = 0;

1073 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
	`rvu_gë_pf
(
pcifunc
)))

1076 
∑ª¡_pf
 = &
rvu
->
pf
[
	`rvu_gë_pf
(
pcifunc
)];

1077 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1079 
	`muãx_lock
(&
rvu
->
cgx_cfg_lock
);

1081 i‡(
°¨t
 && 
pfvf
->
cgx_ö_u£
)

1082 
exô
;

1083 i‡(!
°¨t
 && !
pfvf
->
cgx_ö_u£
)

1084 
exô
;

1086 i‡(
°¨t
) {

1087 
cgx_u£rs
 = 
∑ª¡_pf
->cgx_users;

1088 
∑ª¡_pf
->
cgx_u£rs
++;

1090 
∑ª¡_pf
->
cgx_u£rs
--;

1091 
cgx_u£rs
 = 
∑ª¡_pf
->cgx_users;

1097 i‡(!
cgx_u£rs
) {

1098 
îr
 = 
	`rvu_cgx_c⁄fig_rxtx
(
rvu
, 
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
,

1099 
°¨t
);

1100 i‡(
îr
) {

1101 
	`dev_îr
(
rvu
->
dev
, "UnableÅo %s CGX\n",

1102 
°¨t
 ? "start" : "stop");

1104 
∑ª¡_pf
->
cgx_u£rs
 = 
°¨t
 ?Öarent_pf->cgx_users - 1

1105 : 
∑ª¡_pf
->
cgx_u£rs
 + 1;

1106 
exô
;

1109 
pfvf
->
cgx_ö_u£
 = 
°¨t
;

1110 
exô
:

1111 
	`muãx_u∆ock
(&
rvu
->
cgx_cfg_lock
);

1112  
îr
;

1113 
	}
}

1115 
	$rvu_mbox_h™dÀr_cgx_£t_„c_∑øm
(
rvu
 *rvu,

1116 
„c_mode
 *
ªq
,

1117 
„c_mode
 *
r•
)

1119 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1120 
u8
 
cgx_id
, 
lmac_id
;

1122 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1123  
LMAC_AF_ERR_PF_NOT_MAPPED
;

1125 i‡(
ªq
->
„c
 =
OTX2_FEC_OFF
)

1126 
ªq
->
„c
 = 
OTX2_FEC_NONE
;

1127 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1128 
r•
->
„c
 = 
	`cgx_£t_„c
(
ªq
->„c, 
cgx_id
, 
lmac_id
);

1130 
	}
}

1132 
	$rvu_mbox_h™dÀr_cgx_gë_aux_lök_öfo
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

1133 
cgx_fw_d©a
 *
r•
)

1135 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1136 
u8
 
cgx_id
, 
lmac_id
;

1138 i‡(!
rvu
->
fwd©a
)

1139  
LMAC_AF_ERR_FIRMWARE_DATA_NOT_MAPPED
;

1141 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1142  
LMAC_AF_ERR_PF_NOT_MAPPED
;

1144 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1146 i‡(
rvu
->
hw
->
lmac_≥r_cgx
 =
CGX_LMACS_USX
)

1147 
	`mem˝y
(&
r•
->
fwd©a
,

1148 &
rvu
->
fwd©a
->
cgx_fw_d©a_usx
[
cgx_id
][
lmac_id
],

1149 (
cgx_lmac_fwd©a_s
));

1151 
	`mem˝y
(&
r•
->
fwd©a
,

1152 &
rvu
->
fwd©a
->
cgx_fw_d©a
[
cgx_id
][
lmac_id
],

1153 (
cgx_lmac_fwd©a_s
));

1156 
	}
}

1158 
	$rvu_mbox_h™dÀr_cgx_£t_lök_mode
(
rvu
 *rvu,

1159 
cgx_£t_lök_mode_ªq
 *
ªq
,

1160 
cgx_£t_lök_mode_r•
 *
r•
)

1162 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1163 
u8
 
cgx_idx
, 
lmac
;

1164 *
cgxd
;

1166 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

1167  
LMAC_AF_ERR_PERM_DENIED
;

1169 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_idx
, &
lmac
);

1170 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_idx
, 
rvu
);

1171 
r•
->
°©us
 = 
	`cgx_£t_lök_mode
(
cgxd
, 
ªq
->
¨gs
, 
cgx_idx
, 
lmac
);

1173 
	}
}

1175 
	$rvu_mbox_h™dÀr_cgx_£t_lök_°©e
(
rvu
 *rvu,

1176 
cgx_£t_lök_°©e_msg
 *
ªq
,

1177 
msg_r•
 *
r•
)

1179 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1180 
u8
 
cgx_id
, 
lmac_id
;

1181 
pf
, 
îr
;

1183 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

1185 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
))

1186  
LMAC_AF_ERR_PERM_DENIED
;

1188 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1190 
îr
 = 
	`cgx_£t_lök_°©e
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
), 
lmac_id
,

1191 !!
ªq
->
íabÀ
);

1192 i‡(
îr
)

1193 
	`dev_w¨n
(
rvu
->
dev
, "Cannot setÜink stateÅo %s,Érr %d\n",

1194 (
ªq
->
íabÀ
Ë? "íabÀ" : "dißbÀ", 
îr
);

1196  
îr
;

1197 
	}
}

1199 
	$rvu_mbox_h™dÀr_cgx_£t_phy_mod_ty≥
(
rvu
 *rvu,

1200 
cgx_phy_mod_ty≥
 *
ªq
,

1201 
msg_r•
 *
r•
)

1203 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1204 
u8
 
cgx_id
, 
lmac_id
;

1206 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1207  
LMAC_AF_ERR_PF_NOT_MAPPED
;

1209 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1210  
	`cgx_£t_phy_mod_ty≥
(
ªq
->
mod
, 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
),

1211 
lmac_id
);

1212 
	}
}

1214 
	$rvu_mbox_h™dÀr_cgx_gë_phy_mod_ty≥
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

1215 
cgx_phy_mod_ty≥
 *
r•
)

1217 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1218 
u8
 
cgx_id
, 
lmac_id
;

1220 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1221  
LMAC_AF_ERR_PF_NOT_MAPPED
;

1223 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1224 
r•
->
mod
 = 
	`cgx_gë_phy_mod_ty≥
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
), 
lmac_id
);

1225 i‡(
r•
->
mod
 < 0)

1226  
r•
->
mod
;

1228 
	}
}

1233 
	$rvu_cgx_nix_cuml_°©s
(
rvu
 *rvu, *
cgxd
, 
lmac_id
,

1234 
ödex
, 
rxtxÊag
, 
u64
 *
°©
)

1236 
rvu_block
 *
block
;

1237 
blkaddr
;

1238 
u16
 
pcifunc
;

1239 
pf
, 
lf
;

1241 *
°©
 = 0;

1243 i‡(!
cgxd
 || !
rvu
)

1244  -
EINVAL
;

1246 
pf
 = 
	`cgxlmac_to_pf
(
rvu
, 
	`cgx_gë_cgxid
(
cgxd
), 
lmac_id
);

1247 i‡(
pf
 < 0)

1248  
pf
;

1253 
pcifunc
 = 
pf
 << 
RVU_PFVF_PF_SHIFT
;

1254 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

1255 i‡(
blkaddr
 < 0)

1257 
block
 = &
rvu
->
hw
->block[
blkaddr
];

1259 
lf
 = 0;Ü‡< 
block
->lf.
max
;Üf++) {

1261 i‡(!((
block
->
‚_m≠
[
lf
] & ~
RVU_PFVF_FUNC_MASK
Ë=(
pcifunc
 &

1262 ~
RVU_PFVF_FUNC_MASK
)))

1264 i‡(
rxtxÊag
 =
NIX_STATS_RX
)

1265 *
°©
 +
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1266 
	`NIX_AF_LFX_RX_STATX
(
lf
, 
ödex
));

1268 *
°©
 +
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1269 
	`NIX_AF_LFX_TX_STATX
(
lf
, 
ödex
));

1273 
	}
}

1278 
boﬁ
 
	$rvu_cgx_is_pköd_c⁄fig_≥rmôãd
(
rvu
 *rvu, 
u16
 
pcifunc
)

1280 
rc
, 
pf
, 
rxpköd
;

1281 
u8
 
cgx_id
, 
lmac_id
;

1283 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

1286 i‡(!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
))

1287  
åue
;

1289 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1290  
åue
;

1292 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1294 
rc
 = 
	`cgx_gë_pköd
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
), 
lmac_id
, &
rxpköd
);

1295 i‡(
rc
)

1296  
Ál£
;

1298 
rxpköd
) {

1300 
NPC_RX_HIGIG_PKIND
:

1301 
NPC_RX_EDSA_PKIND
:

1302 
rc
 = 
Ál£
;

1305 
rc
 = 
åue
;

1308  
rc
;

1309 
	}
}

1311 
	$rvu_mbox_h™dÀr_cgx_„©uªs_gë
(
rvu
 *rvu,

1312 
msg_ªq
 *
ªq
,

1313 
cgx_„©uªs_öfo_msg
 *
r•
)

1315 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1316 
u8
 
cgx_idx
, 
lmac
;

1317 *
cgxd
;

1319 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1322 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_idx
, &
lmac
);

1323 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_idx
, 
rvu
);

1324 i‡(!
cgxd
)

1327 
r•
->
lmac_„©uªs
 = 
	`cgx_„©uªs_gë
(
cgxd
);

1330 
	}
}

1332 
u32
 
	$rvu_cgx_gë_fifﬁí
(
rvu
 *rvu)

1334 
mac_›s
 *mac_ops;

1335 
u32
 
fifo_Àn
;

1337 
mac_›s
 = 
	`gë_mac_›s
(
	`rvu_fú°_cgx_pd©a
(
rvu
));

1338 
fifo_Àn
 = 
mac_›s
 ? mac_ops->fifo_len : 0;

1340  
fifo_Àn
;

1341 
	}
}

1343 
u32
 
	$rvu_cgx_gë_lmac_fifﬁí
(
rvu
 *rvu, 
cgx
, 
lmac
)

1345 
mac_›s
 *mac_ops;

1346 *
cgxd
;

1348 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx
, 
rvu
);

1349 i‡(!
cgxd
)

1352 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

1353 i‡(!
mac_›s
->
lmac_fifo_Àn
)

1356  
mac_›s
->
	`lmac_fifo_Àn
(
cgxd
, 
lmac
);

1357 
	}
}

1359 
	$rvu_mbox_h™dÀr_cgx_mac_addr_ª£t
(
rvu
 *rvu, 
cgx_mac_addr_ª£t_ªq
 *
ªq
,

1360 
msg_r•
 *
r•
)

1362 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1363 
u8
 
cgx_id
, 
lmac_id
;

1365 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

1366  
LMAC_AF_ERR_PERM_DENIED
;

1368 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1370 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

1371  
	`rvu_≈c_exa˘_mac_addr_ª£t
(
rvu
, 
ªq
, 
r•
);

1373  
	`cgx_lmac_addr_ª£t
(
cgx_id
, 
lmac_id
);

1374 
	}
}

1376 
	$rvu_mbox_h™dÀr_cgx_mac_addr_upd©e
(
rvu
 *rvu,

1377 
cgx_mac_addr_upd©e_ªq
 *
ªq
,

1378 
cgx_mac_addr_upd©e_r•
 *
r•
)

1380 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1381 
u8
 
cgx_id
, 
lmac_id
;

1383 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

1384  
LMAC_AF_ERR_PERM_DENIED
;

1386 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

1387  
	`rvu_≈c_exa˘_mac_addr_upd©e
(
rvu
, 
ªq
, 
r•
);

1389 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1390  
	`cgx_lmac_addr_upd©e
(
cgx_id
, 
lmac_id
, 
ªq
->
mac_addr
,Ñeq->
ödex
);

1391 
	}
}

1393 
	$rvu_cgx_¥io_Êow_˘æ_cfg
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u8
 
tx_∑u£
,

1394 
u8
 
rx_∑u£
, 
u16
 
pfc_í
)

1396 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

1397 
u8
 
rx_8023
 = 0, 
tx_8023
 = 0;

1398 
mac_›s
 *mac_ops;

1399 
u8
 
cgx_id
, 
lmac_id
;

1400 *
cgxd
;

1405 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1406  -
ENODEV
;

1408 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1409 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

1410 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

1412 
mac_›s
->
	`mac_gë_∑u£_‰m_°©us
(
cgxd
, 
lmac_id
, &
tx_8023
, &
rx_8023
);

1413 i‡(
tx_8023
 || 
rx_8023
) {

1414 
	`dev_w¨n
(
rvu
->
dev
,

1416  
LMAC_AF_ERR_PFC_ENADIS_PERM_DENIED
;

1419 
	`muãx_lock
(&
rvu
->
r§c_lock
);

1420 i‡(
	`vîify_lmac_fc_cfg
(
cgxd
, 
lmac_id
, 
tx_∑u£
, 
rx_∑u£
,

1421 
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)) {

1422 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

1423  
LMAC_AF_ERR_PERM_DENIED
;

1425 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

1427  
mac_›s
->
	`pfc_c⁄fig
(
cgxd
, 
lmac_id
, 
tx_∑u£
, 
rx_∑u£
, 
pfc_í
);

1428 
	}
}

1430 
	$rvu_mbox_h™dÀr_cgx_¥io_Êow_˘æ_cfg
(
rvu
 *rvu,

1431 
cgx_pfc_cfg
 *
ªq
,

1432 
cgx_pfc_r•
 *
r•
)

1434 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1435 
mac_›s
 *mac_ops;

1436 
u8
 
cgx_id
, 
lmac_id
;

1437 *
cgxd
;

1438 
îr
;

1443 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1444  -
ENODEV
;

1446 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1447 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

1448 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

1450 
îr
 = 
	`rvu_cgx_¥io_Êow_˘æ_cfg
(
rvu
, 
ªq
->
hdr
.
pcifunc
,Ñeq->
tx_∑u£
,

1451 
ªq
->
rx_∑u£
,Ñeq->
pfc_í
);

1453 
mac_›s
->
	`mac_gë_pfc_‰m_cfg
(
cgxd
, 
lmac_id
, &
r•
->
tx_∑u£
, &r•->
rx_∑u£
);

1454  
îr
;

1455 
	}
}

1457 
	$rvu_mac_ª£t
(
rvu
 *rvu, 
u16
 
pcifunc
)

1459 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

1460 
mac_›s
 *mac_ops;

1461 
cgx
 *
cgxd
;

1462 
u8
 
cgx
, 
lmac
;

1464 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

1467 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx
, &
lmac
);

1468 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx
, 
rvu
);

1469 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

1471 i‡(
mac_›s
->
	`mac_ª£t
(
cgxd
, 
lmac
))

1472 
	`dev_îr
(
rvu
->
dev
, "FailedÅoÑeset MAC\n");

1473 
	}
}

1475 
u64
 
	$rvu_cgx_gë_dmacÊt_dr›≥d_pkt˙t
(*
cgxd
, 
lmac_id
)

1477 
mac_›s
 *mac_ops;

1479 i‡(!
cgxd
)

1482 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

1484 i‡(!
mac_›s
->
lmac_fifo_Àn
)

1487  
mac_›s
->
	`gë_dmacÊt_dr›≥d_pkt˙t
(
cgxd
, 
lmac_id
);

1488 
	}
}

	@rvu_cn10k.c

7 
	~<löux/bôfõld.h
>

8 
	~<löux/pci.h
>

9 
	~"rvu.h
"

10 
	~"cgx.h
"

11 
	~"rvu_ªg.h
"

14 
	#LMT_TBL_OP_READ
 0

	)

15 
	#LMT_TBL_OP_WRITE
 1

	)

16 
	#LMT_MAP_TABLE_SIZE
 (128 * 1024)

	)

17 
	#LMT_MAPTBL_ENTRY_SIZE
 16

	)

19 
	$lmt°_m≠_èbÀ_›s
(
rvu
 *rvu, 
u32
 
ödex
, 
u64
 *
vÆ
,

20 
lmt_tbl_›
)

22 
__iomem
 *
lmt_m≠_ba£
;

23 
u64
 
tbl_ba£
;

25 
tbl_ba£
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_APR
, 
APR_AF_LMT_MAP_BASE
);

27 
lmt_m≠_ba£
 = 
	`i‹em≠_wc
(
tbl_ba£
, 
LMT_MAP_TABLE_SIZE
);

28 i‡(!
lmt_m≠_ba£
) {

29 
	`dev_îr
(
rvu
->
dev
, "FailedÅo setupÜmt mapÅable mapping!!\n");

30  -
ENOMEM
;

33 i‡(
lmt_tbl_›
 =
LMT_TBL_OP_READ
) {

34 *
vÆ
 = 
	`ªadq
(
lmt_m≠_ba£
 + 
ödex
);

36 
	`wrôeq
((*
vÆ
), (
lmt_m≠_ba£
 + 
ödex
));

42 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_APR
, 
APR_AF_LMT_CTL
, 
	`BIT_ULL
(0));

43 
	`rvu_ªad64
(
rvu
, 
BLKADDR_APR
, 
APR_AF_LMT_CTL
);

44 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_APR
, 
APR_AF_LMT_CTL
, 0x00);

47 
	`iounm≠
(
lmt_m≠_ba£
);

49 
	}
}

51 
	#LMT_MAP_TBL_W1_OFF
 8

	)

52 
u32
 
	$rvu_gë_lmt°_tbl_ödex
(
rvu
 *rvu, 
u16
 
pcifunc
)

54  ((
	`rvu_gë_pf
(
pcifunc
Ë* 
rvu
->
hw
->
tŸÆ_vfs
) +

55 (
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)Ë* 
LMT_MAPTBL_ENTRY_SIZE
;

56 
	}
}

58 
	$rvu_gë_lmèddr
(
rvu
 *rvu, 
u16
 
pcifunc
,

59 
u64
 
iova
, u64 *
lmt_addr
)

61 
u64
 
∑
, 
vÆ
, 
pf
;

62 
îr
;

64 i‡(!
iova
) {

65 
	`dev_îr
(
rvu
->
dev
, "%†Reque°ed NuŒáddªs†f‹Åønsuœti⁄\n", 
__func__
);

66  -
EINVAL
;

69 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_SMMU_ADDR_REQ
, 
iova
);

70 
pf
 = 
	`rvu_gë_pf
(
pcifunc
) & 0x1F;

71 
vÆ
 = 
	`BIT_ULL
(63Ë| BIT_ULL(14Ë| BIT_ULL(13Ë| 
pf
 << 8 |

72 ((
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) & 0xFF);

73 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_SMMU_TXN_REQ
, 
vÆ
);

75 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_SMMU_ADDR_RSP_STS
, 
	`BIT_ULL
(0), 
Ál£
);

76 i‡(
îr
) {

77 
	`dev_îr
(
rvu
->
dev
, "%†LMTLINE iov®å™suœti⁄ faûed\n", 
__func__
);

78  
îr
;

80 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_SMMU_ADDR_RSP_STS
);

81 i‡(
vÆ
 & ~0x1ULL) {

82 
	`dev_îr
(
rvu
->
dev
, "%†LMTLINE iov®å™suœti⁄ faûedÉº:%Œx\n", 
__func__
, 
vÆ
);

83  -
EIO
;

88 
∑
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
RVU_AF_SMMU_TLN_FLIT0
) >> 18;

89 
∑
 &
	`GENMASK_ULL
(39, 0);

90 *
lmt_addr
 = (
∑
 << 12Ë| (
iova
 & 0xFFF);

93 
	}
}

95 
	$rvu_upd©e_lmèddr
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u64
 
lmt_addr
)

97 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

98 
u32
 
tbl_idx
;

99 
îr
 = 0;

100 
u64
 
vÆ
;

103 
tbl_idx
 = 
	`rvu_gë_lmt°_tbl_ödex
(
rvu
, 
pcifunc
);

104 
îr
 = 
	`lmt°_m≠_èbÀ_›s
(
rvu
, 
tbl_idx
, &
vÆ
, 
LMT_TBL_OP_READ
);

105 i‡(
îr
) {

106 
	`dev_îr
(
rvu
->
dev
,

108 
tbl_idx
, 
îr
);

109  
îr
;

116 i‡(!
pfvf
->
lmt_ba£_addr
)

117 
pfvf
->
lmt_ba£_addr
 = 
vÆ
;

120 
îr
 = 
	`lmt°_m≠_èbÀ_›s
(
rvu
, 
tbl_idx
, &
lmt_addr
, 
LMT_TBL_OP_WRITE
);

121 i‡(
îr
) {

122 
	`dev_îr
(
rvu
->
dev
,

124 
tbl_idx
, 
îr
);

125  
îr
;

128 
	}
}

130 
	$rvu_mbox_h™dÀr_lmt°_tbl_£tup
(
rvu
 *rvu,

131 
lmt°_tbl_£tup_ªq
 *
ªq
,

132 
msg_r•
 *
r•
)

134 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

135 
u32
 
¥i_tbl_idx
, 
tbl_idx
;

136 
u64
 
lmt_addr
;

137 
îr
 = 0;

138 
u64
 
vÆ
;

144 i‡(
ªq
->
u£_loˇl_lmt_ªgi⁄
) {

145 
îr
 = 
	`rvu_gë_lmèddr
(
rvu
, 
ªq
->
hdr
.
pcifunc
,

146 
ªq
->
lmt_iova
, &
lmt_addr
);

147 i‡(
îr
 < 0)

148  
îr
;

151 
îr
 = 
	`rvu_upd©e_lmèddr
(
rvu
, 
ªq
->
hdr
.
pcifunc
, 
lmt_addr
);

152 i‡(
îr
)

153  
îr
;

162 i‡(
ªq
->
ba£_pcifunc
) {

166 
¥i_tbl_idx
 = 
	`rvu_gë_lmt°_tbl_ödex
(
rvu
, 
ªq
->
ba£_pcifunc
);

169 
îr
 = 
	`lmt°_m≠_èbÀ_›s
(
rvu
, 
¥i_tbl_idx
, &
vÆ
,

170 
LMT_TBL_OP_READ
);

171 i‡(
îr
) {

172 
	`dev_îr
(
rvu
->
dev
,

174 
¥i_tbl_idx
, 
îr
);

175 
îr‹
;

181 
îr
 = 
	`rvu_upd©e_lmèddr
(
rvu
, 
ªq
->
hdr
.
pcifunc
, 
vÆ
);

182 i‡(
îr
)

183  
îr
;

190 i‡(
ªq
->
sch_ía
 ||Ñeq->
dis_sched_óæy_comp
 ||Ñeq->
dis_löe_¥ef
) {

191 
tbl_idx
 = 
	`rvu_gë_lmt°_tbl_ödex
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

192 
îr
 = 
	`lmt°_m≠_èbÀ_›s
(
rvu
, 
tbl_idx
 + 
LMT_MAP_TBL_W1_OFF
,

193 &
vÆ
, 
LMT_TBL_OP_READ
);

194 i‡(
îr
) {

195 
	`dev_îr
(
rvu
->
dev
,

197 
tbl_idx
 + 
LMT_MAP_TBL_W1_OFF
, 
îr
);

198 
îr‹
;

205 i‡(!
pfvf
->
lmt_m≠_ít_w1
)

206 
pfvf
->
lmt_m≠_ít_w1
 = 
vÆ
;

209 i‡(
ªq
->
dis_sched_óæy_comp
)

210 
vÆ
 |(
ªq
->
dis_sched_óæy_comp
 <<

211 
APR_LMT_MAP_ENT_DIS_SCH_CMP_SHIFT
);

213 i‡(
ªq
->
sch_ía
)

214 
vÆ
 |(
ªq
->
sch_ía
 << 
APR_LMT_MAP_ENT_SCH_ENA_SHIFT
) |

215 
ªq
->
ssow_pf_func
;

217 i‡(
ªq
->
dis_löe_¥ef
)

218 
vÆ
 |(
ªq
->
dis_löe_¥ef
 <<

219 
APR_LMT_MAP_ENT_DIS_LINE_PREF_SHIFT
);

221 
îr
 = 
	`lmt°_m≠_èbÀ_›s
(
rvu
, 
tbl_idx
 + 
LMT_MAP_TBL_W1_OFF
,

222 &
vÆ
, 
LMT_TBL_OP_WRITE
);

223 i‡(
îr
) {

224 
	`dev_îr
(
rvu
->
dev
,

226 
tbl_idx
 + 
LMT_MAP_TBL_W1_OFF
, 
îr
);

227 
îr‹
;

231 
îr‹
:

232  
îr
;

233 
	}
}

236 
	$rvu_ª£t_lmt_m≠_tbl
(
rvu
 *rvu, 
u16
 
pcifunc
)

238 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

239 
u32
 
tbl_idx
;

240 
îr
;

242 i‡(
	`is_rvu_Ÿx2
(
rvu
))

245 i‡(
pfvf
->
lmt_ba£_addr
 ||Öfvf->
lmt_m≠_ít_w1
) {

247 
tbl_idx
 = 
	`rvu_gë_lmt°_tbl_ödex
(
rvu
, 
pcifunc
);

251 i‡(
pfvf
->
lmt_ba£_addr
) {

252 
îr
 = 
	`lmt°_m≠_èbÀ_›s
(
rvu
, 
tbl_idx
,

253 &
pfvf
->
lmt_ba£_addr
,

254 
LMT_TBL_OP_WRITE
);

255 i‡(
îr
)

256 
	`dev_îr
(
rvu
->
dev
,

258 
tbl_idx
, 
îr
);

259 
pfvf
->
lmt_ba£_addr
 = 0;

264 i‡(
pfvf
->
lmt_m≠_ít_w1
) {

265 
îr
 = 
	`lmt°_m≠_èbÀ_›s
(
rvu
,

266 
tbl_idx
 + 
LMT_MAP_TBL_W1_OFF
,

267 &
pfvf
->
lmt_m≠_ít_w1
,

268 
LMT_TBL_OP_WRITE
);

269 i‡(
îr
)

270 
	`dev_îr
(
rvu
->
dev
,

272 
tbl_idx
 + 
LMT_MAP_TBL_W1_OFF
, 
îr
);

273 
pfvf
->
lmt_m≠_ít_w1
 = 0;

276 
	}
}

278 
	$rvu_£t_ch™√ls_ba£
(
rvu
 *rvu)

280 
u16
 
ƒ_lbk_ch™s
, 
ƒ_sdp_ch™s
, 
ƒ_cgx_ch™s
, 
ƒ_˝t_ch™s
;

281 
u16
 
sdp_ch™_ba£
, 
cgx_ch™_ba£
, 
˝t_ch™_ba£
;

282 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

283 
u64
 
nix_c⁄°
, 
nix_c⁄°1
;

284 
blkaddr
;

286 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

287 i‡(
blkaddr
 < 0)

288  
blkaddr
;

290 
nix_c⁄°
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST
);

291 
nix_c⁄°1
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST1
);

293 
hw
->
cgx
 = (
nix_c⁄°
 >> 12) & 0xFULL;

294 
hw
->
lmac_≥r_cgx
 = (
nix_c⁄°
 >> 8) & 0xFULL;

295 
hw
->
cgx_löks
 = hw->
cgx
 * hw->
lmac_≥r_cgx
;

296 
hw
->
lbk_löks
 = (
nix_c⁄°
 >> 24) & 0xFULL;

297 
hw
->
˝t_löks
 = (
nix_c⁄°
 >> 44) & 0xFULL;

298 
hw
->
sdp_löks
 = 1;

300 
hw
->
cgx_ch™_ba£
 = 
	`NIX_CHAN_CGX_LMAC_CHX
(0, 0, 0);

301 
hw
->
lbk_ch™_ba£
 = 
	`NIX_CHAN_LBK_CHX
(0, 0);

302 
hw
->
sdp_ch™_ba£
 = 
NIX_CHAN_SDP_CH_START
;

305 i‡(!(
nix_c⁄°
 & 
	`BIT_ULL
(60)))

308 
hw
->
ˇp
.
¥ogømmabÀ_ch™s
 = 
åue
;

318 
ƒ_lbk_ch™s
 = (
nix_c⁄°
 >> 16) & 0xFFULL;

319 
ƒ_sdp_ch™s
 = 
nix_c⁄°1
 & 0xFFFULL;

320 
ƒ_cgx_ch™s
 = 
nix_c⁄°
 & 0xFFULL;

321 
ƒ_˝t_ch™s
 = (
nix_c⁄°
 >> 32) & 0xFFFULL;

323 
sdp_ch™_ba£
 = 
hw
->
lbk_ch™_ba£
 + hw->
lbk_löks
 * 
ƒ_lbk_ch™s
;

325 
hw
->
sdp_ch™_ba£
 = 
	`ALIGN
(sdp_ch™_ba£, 
ƒ_sdp_ch™s
);

327 
cgx_ch™_ba£
 = 
hw
->
sdp_ch™_ba£
 + hw->
sdp_löks
 * 
ƒ_sdp_ch™s
;

328 
hw
->
cgx_ch™_ba£
 = 
	`ALIGN
(cgx_ch™_ba£, 
ƒ_cgx_ch™s
);

330 
˝t_ch™_ba£
 = 
hw
->
cgx_ch™_ba£
 + hw->
cgx_löks
 * 
ƒ_cgx_ch™s
;

331 
hw
->
˝t_ch™_ba£
 = 
	`ALIGN
(˝t_ch™_ba£, 
ƒ_˝t_ch™s
);

336 i‡(
˝t_ch™_ba£
 <
NIX_CHAN_CPT_CH_START
) {

337 
hw
->
˝t_ch™_ba£
 = 
NIX_CHAN_CPT_CH_START
;

339 
	`dev_îr
(
rvu
->
dev
,

341  -
EINVAL
;

345 
	}
}

347 
	#LBK_CONNECT_NIXX
(
a
Ë(0x0 + (a))

	)

349 
	$__rvu_lbk_£t_ch™s
(
rvu
 *rvu, 
__iomem
 *
ba£
,

350 
u64
 
off£t
, 
lbkid
, 
u16
 
ch™s
)

352 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

353 
u64
 
cfg
;

355 
cfg
 = 
	`ªadq
(
ba£
 + 
off£t
);

356 
cfg
 &~(
LBK_LINK_CFG_RANGE_MASK
 |

357 
LBK_LINK_CFG_ID_MASK
 | 
LBK_LINK_CFG_BASE_MASK
);

358 
cfg
 |
	`FIELD_PREP
(
LBK_LINK_CFG_RANGE_MASK
, 
	`ûog2
(
ch™s
));

359 
cfg
 |
	`FIELD_PREP
(
LBK_LINK_CFG_ID_MASK
, 
lbkid
);

360 
cfg
 |
	`FIELD_PREP
(
LBK_LINK_CFG_BASE_MASK
, 
hw
->
lbk_ch™_ba£
);

362 
	`wrôeq
(
cfg
, 
ba£
 + 
off£t
);

363 
	}
}

365 
	$rvu_lbk_£t_ch™√ls
(
rvu
 *rvu)

367 
pci_dev
 *
pdev
 = 
NULL
;

368 
__iomem
 *
ba£
;

369 
u64
 
lbk_c⁄°
;

370 
u8
 
§c
, 
d°
;

371 
u16
 
ch™s
;

387 
åue
) {

388 
pdev
 = 
	`pci_gë_devi˚
(
PCI_VENDOR_ID_CAVIUM
,

389 
PCI_DEVID_OCTEONTX2_LBK
, 
pdev
);

390 i‡(!
pdev
)

393 
ba£
 = 
	`pci_i‹em≠_b¨
(
pdev
, 0);

394 i‡(!
ba£
)

395 
îr_put
;

397 
lbk_c⁄°
 = 
	`ªadq
(
ba£
 + 
LBK_CONST
);

398 
ch™s
 = 
	`FIELD_GET
(
LBK_CONST_CHANS
, 
lbk_c⁄°
);

399 
d°
 = 
	`FIELD_GET
(
LBK_CONST_DST
, 
lbk_c⁄°
);

400 
§c
 = 
	`FIELD_GET
(
LBK_CONST_SRC
, 
lbk_c⁄°
);

402 i‡(
§c
 =
d°
) {

403 i‡(
§c
 =
	`LBK_CONNECT_NIXX
(0)) {

404 
	`__rvu_lbk_£t_ch™s
(
rvu
, 
ba£
, 
LBK_LINK_CFG_X2P
,

405 0, 
ch™s
);

406 
	`__rvu_lbk_£t_ch™s
(
rvu
, 
ba£
, 
LBK_LINK_CFG_P2X
,

407 0, 
ch™s
);

408 } i‡(
§c
 =
	`LBK_CONNECT_NIXX
(1)) {

409 
	`__rvu_lbk_£t_ch™s
(
rvu
, 
ba£
, 
LBK_LINK_CFG_X2P
,

410 1, 
ch™s
);

411 
	`__rvu_lbk_£t_ch™s
(
rvu
, 
ba£
, 
LBK_LINK_CFG_P2X
,

412 1, 
ch™s
);

415 i‡(
§c
 =
	`LBK_CONNECT_NIXX
(0)) {

416 
	`__rvu_lbk_£t_ch™s
(
rvu
, 
ba£
, 
LBK_LINK_CFG_X2P
,

417 0, 
ch™s
);

418 
	`__rvu_lbk_£t_ch™s
(
rvu
, 
ba£
, 
LBK_LINK_CFG_P2X
,

419 1, 
ch™s
);

420 } i‡(
§c
 =
	`LBK_CONNECT_NIXX
(1)) {

421 
	`__rvu_lbk_£t_ch™s
(
rvu
, 
ba£
, 
LBK_LINK_CFG_X2P
,

422 1, 
ch™s
);

423 
	`__rvu_lbk_£t_ch™s
(
rvu
, 
ba£
, 
LBK_LINK_CFG_P2X
,

424 0, 
ch™s
);

427 
	`iounm≠
(
ba£
);

429 
îr_put
:

430 
	`pci_dev_put
(
pdev
);

431 
	}
}

433 
	$__rvu_nix_£t_ch™√ls
(
rvu
 *rvu, 
blkaddr
)

435 
u64
 
nix_c⁄°1
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST1
);

436 
u64
 
nix_c⁄°
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST
);

437 
u16
 
cgx_ch™s
, 
lbk_ch™s
, 
sdp_ch™s
, 
˝t_ch™s
;

438 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

439 
lök
, 
nix_lök
 = 0;

440 
u16
 
°¨t
;

441 
u64
 
cfg
;

443 
cgx_ch™s
 = 
nix_c⁄°
 & 0xFFULL;

444 
lbk_ch™s
 = (
nix_c⁄°
 >> 16) & 0xFFULL;

445 
sdp_ch™s
 = 
nix_c⁄°1
 & 0xFFFULL;

446 
˝t_ch™s
 = (
nix_c⁄°
 >> 32) & 0xFFFULL;

448 
°¨t
 = 
hw
->
cgx_ch™_ba£
;

449 
lök
 = 0;Üök < 
hw
->
cgx_löks
;Üök++, 
nix_lök
++) {

450 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LINKX_CFG
(
nix_lök
));

451 
cfg
 &~(
NIX_AF_LINKX_BASE_MASK
 | 
NIX_AF_LINKX_RANGE_MASK
);

452 
cfg
 |
	`FIELD_PREP
(
NIX_AF_LINKX_RANGE_MASK
, 
	`ûog2
(
cgx_ch™s
));

453 
cfg
 |
	`FIELD_PREP
(
NIX_AF_LINKX_BASE_MASK
, 
°¨t
);

454 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LINKX_CFG
(
nix_lök
), 
cfg
);

455 
°¨t
 +
cgx_ch™s
;

458 
°¨t
 = 
hw
->
lbk_ch™_ba£
;

459 
lök
 = 0;Üök < 
hw
->
lbk_löks
;Üök++, 
nix_lök
++) {

460 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LINKX_CFG
(
nix_lök
));

461 
cfg
 &~(
NIX_AF_LINKX_BASE_MASK
 | 
NIX_AF_LINKX_RANGE_MASK
);

462 
cfg
 |
	`FIELD_PREP
(
NIX_AF_LINKX_RANGE_MASK
, 
	`ûog2
(
lbk_ch™s
));

463 
cfg
 |
	`FIELD_PREP
(
NIX_AF_LINKX_BASE_MASK
, 
°¨t
);

464 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LINKX_CFG
(
nix_lök
), 
cfg
);

465 
°¨t
 +
lbk_ch™s
;

468 
°¨t
 = 
hw
->
sdp_ch™_ba£
;

469 
lök
 = 0;Üök < 
hw
->
sdp_löks
;Üök++, 
nix_lök
++) {

470 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LINKX_CFG
(
nix_lök
));

471 
cfg
 &~(
NIX_AF_LINKX_BASE_MASK
 | 
NIX_AF_LINKX_RANGE_MASK
);

472 
cfg
 |
	`FIELD_PREP
(
NIX_AF_LINKX_RANGE_MASK
, 
	`ûog2
(
sdp_ch™s
));

473 
cfg
 |
	`FIELD_PREP
(
NIX_AF_LINKX_BASE_MASK
, 
°¨t
);

474 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LINKX_CFG
(
nix_lök
), 
cfg
);

475 
°¨t
 +
sdp_ch™s
;

478 
°¨t
 = 
hw
->
˝t_ch™_ba£
;

479 
lök
 = 0;Üök < 
hw
->
˝t_löks
;Üök++, 
nix_lök
++) {

480 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LINKX_CFG
(
nix_lök
));

481 
cfg
 &~(
NIX_AF_LINKX_BASE_MASK
 | 
NIX_AF_LINKX_RANGE_MASK
);

482 
cfg
 |
	`FIELD_PREP
(
NIX_AF_LINKX_RANGE_MASK
, 
	`ûog2
(
˝t_ch™s
));

483 
cfg
 |
	`FIELD_PREP
(
NIX_AF_LINKX_BASE_MASK
, 
°¨t
);

484 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LINKX_CFG
(
nix_lök
), 
cfg
);

485 
°¨t
 +
˝t_ch™s
;

487 
	}
}

489 
	$rvu_nix_£t_ch™√ls
(
rvu
 *rvu)

491 
blkaddr
 = 0;

493 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

494 
blkaddr
) {

495 
	`__rvu_nix_£t_ch™√ls
(
rvu
, 
blkaddr
);

496 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

498 
	}
}

500 
	$__rvu_Ωm_£t_ch™√ls
(
cgxid
, 
lmacid
, 
u16
 
ba£
)

502 
u64
 
cfg
;

504 
cfg
 = 
	`cgx_lmac_ªad
(
cgxid
, 
lmacid
, 
RPMX_CMRX_LINK_CFG
);

505 
cfg
 &~(
RPMX_CMRX_LINK_BASE_MASK
 | 
RPMX_CMRX_LINK_RANGE_MASK
);

510 
cfg
 |
	`FIELD_PREP
(
RPMX_CMRX_LINK_RANGE_MASK
, 
	`ûog2
(16));

511 
cfg
 |
	`FIELD_PREP
(
RPMX_CMRX_LINK_BASE_MASK
, 
ba£
);

512 
	`cgx_lmac_wrôe
(
cgxid
, 
lmacid
, 
RPMX_CMRX_LINK_CFG
, 
cfg
);

513 
	}
}

515 
	$rvu_Ωm_£t_ch™√ls
(
rvu
 *rvu)

517 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

518 
u16
 
ba£
 = 
hw
->
cgx_ch™_ba£
;

519 
cgx
, 
lmac
;

521 
cgx
 = 0; cgx < 
rvu
->
cgx_˙t_max
; cgx++) {

522 
lmac
 = 0;Üma¯< 
hw
->
lmac_≥r_cgx
;Ümac++) {

523 
	`__rvu_Ωm_£t_ch™√ls
(
cgx
, 
lmac
, 
ba£
);

524 
ba£
 += 16;

527 
	}
}

529 
	$rvu_¥ogøm_ch™√ls
(
rvu
 *rvu)

531 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

533 i‡(!
hw
->
ˇp
.
¥ogømmabÀ_ch™s
)

536 
	`rvu_nix_£t_ch™√ls
(
rvu
);

537 
	`rvu_lbk_£t_ch™√ls
(
rvu
);

538 
	`rvu_Ωm_£t_ch™√ls
(
rvu
);

539 
	}
}

541 
	$rvu_sso_block_˙10k_öô
(
rvu
 *rvu, 
blkaddr
)

543 
u64
 
ªg
;

545 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_WS_CFG
);

547 
ªg
 &~
	`BIT_ULL
(4);

548 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_WS_CFG
, 
ªg
);

549 
	}
}

551 
	$rvu_nix_block_˙10k_öô
(
rvu
 *rvu, 
nix_hw
 *nix_hw)

553 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

554 
blkaddr
 = 
nix_hw
->blkaddr;

555 
u64
 
cfg
, 
vÆ
;

560 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_VWQE_TIMER
, 0x3FULL);

565 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
);

566 
cfg
 |
	`BIT_ULL
(1) | BIT_ULL(2);

567 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
, 
cfg
);

572 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST
);

573 i‡(!(
vÆ
 & 
	`BIT_ULL
(62)Ë&& 
	`is_˙10ka_a1
(
rvu
)) {

574 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_RQM_ECO
);

575 
cfg
 |
	`BIT_ULL
(63);

576 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RQM_ECO
, 
cfg
);

579 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST
);

581 i‡(!(
cfg
 & 
	`BIT_ULL
(62))) {

582 
hw
->
ˇp
.
£c⁄d_˝t_∑ss
 = 
Ál£
;

586 
hw
->
ˇp
.
£c⁄d_˝t_∑ss
 = 
åue
;

587 
nix_hw
->
rq_msk
.
tŸÆ
 = 
NIX_RQ_MSK_PROFILES
;

588 
	}
}

590 
	$rvu_≠r_block_˙10k_öô
(
rvu
 *rvu)

592 
u64
 
ªg
;

594 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_APR
, 
APR_AF_LMT_CFG
);

595 
ªg
 |= 0xFULL << 35;

596 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_APR
, 
APR_AF_LMT_CFG
, 
ªg
);

597 
	}
}

	@rvu_cpt.c

8 
	~<löux/bôfõld.h
>

9 
	~<löux/pci.h
>

10 
	~"rvu_°ru˘.h
"

11 
	~"rvu_ªg.h
"

12 
	~"mbox.h
"

13 
	~"rvu.h
"

16 
	#PCI_DEVID_OTX2_CPT_PF
 0xA0FD

	)

17 
	#PCI_DEVID_OTX2_CPT10K_PF
 0xA0F2

	)

20 
	#CPT_CTX_ILEN
 1ULL

	)

22 
	#˝t_gë_íg_°s
(
e_mö
, 
e_max
, 
r•
, 
ëy≥
) \

24 
u64
 
‰ì_°s
 = 0, 
busy_°s
 = 0; \

25 
	`ty≥of
(
r•
Ë
_r•
 =Ñsp; \

26 
u32
 
e
, 
i
; \

28 
e
 = (
e_mö
), 
i
 = 0;É < (
e_max
);É++, i++) { \

29 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_STS
(
e
)); \

30 i‡(
ªg
 & 0x1) \

31 
busy_°s
 |1ULL << 
i
; \

33 i‡(
ªg
 & 0x2) \

34 
‰ì_°s
 |1ULL << 
i
; \

36 (
_r•
)->
busy_°s_
##
ëy≥
 = 
busy_°s
; \

37 (
_r•
)->
‰ì_°s_
##
ëy≥
 = 
‰ì_°s
; \

38 })

	)

40 
úqªtu∫_t
 
	$˝t_af_Êt_öå_h™dÀr
(
vec
, *
±r
)

42 
rvu_block
 *
block
 = 
±r
;

43 
rvu
 *rvu = 
block
->rvu;

44 
blkaddr
 = 
block
->
addr
;

45 
u64
 
ªg
, 
vÆ
;

46 
i
, 
íg
;

47 
u8
 
gΩ
;

49 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT
(
vec
));

50 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Re˚ived CPTAF FLT%d irq : 0x%Œx", 
vec
, 
ªg
);

52 
i
 = -1;

53 (
i
 = 
	`föd_√xt_bô
((*)&
ªg
, 64, i + 1)) < 64) {

54 
vec
) {

56 
íg
 = 
i
;

59 
íg
 = 
i
 + 64;

62 
íg
 = 
i
 + 128;

65 
gΩ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_CTL2
(
íg
)) & 0xFF;

67 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_CTL2
(
íg
), 0x0);

68 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_CTL
(
íg
));

69 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_CTL
(
íg
), 
vÆ
 & ~1ULL);

71 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_CTL2
(
íg
), 
gΩ
);

72 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_CTL
(
íg
), 
vÆ
 | 1ULL);

74 
	`•ö_lock
(&
rvu
->
˝t_öå_lock
);

75 
block
->
˝t_Êt_íg_m≠
[
vec
] |
	`BIT_ULL
(
i
);

76 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_STS
(
íg
));

77 i‡((
vÆ
 & 0x2) || (!(val & 0x2) && (val & 0x1)))

78 
block
->
˝t_rcvrd_íg_m≠
[
vec
] |
	`BIT_ULL
(
i
);

79 
	`•ö_u∆ock
(&
rvu
->
˝t_öå_lock
);

81 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT
(
vec
), 
ªg
);

83  
IRQ_HANDLED
;

84 
	}
}

86 
úqªtu∫_t
 
	$rvu_˝t_af_Êt0_öå_h™dÀr
(
úq
, *
±r
)

88  
	`˝t_af_Êt_öå_h™dÀr
(
CPT_AF_INT_VEC_FLT0
, 
±r
);

89 
	}
}

91 
úqªtu∫_t
 
	$rvu_˝t_af_Êt1_öå_h™dÀr
(
úq
, *
±r
)

93  
	`˝t_af_Êt_öå_h™dÀr
(
CPT_AF_INT_VEC_FLT1
, 
±r
);

94 
	}
}

96 
úqªtu∫_t
 
	$rvu_˝t_af_Êt2_öå_h™dÀr
(
úq
, *
±r
)

98  
	`˝t_af_Êt_öå_h™dÀr
(
CPT_10K_AF_INT_VEC_FLT2
, 
±r
);

99 
	}
}

101 
úqªtu∫_t
 
	$rvu_˝t_af_rvu_öå_h™dÀr
(
úq
, *
±r
)

103 
rvu_block
 *
block
 = 
±r
;

104 
rvu
 *rvu = 
block
->rvu;

105 
blkaddr
 = 
block
->
addr
;

106 
u64
 
ªg
;

108 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RVU_INT
);

109 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Re˚ived CPTAF RVU irq : 0x%Œx", 
ªg
);

111 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RVU_INT
, 
ªg
);

112  
IRQ_HANDLED
;

113 
	}
}

115 
úqªtu∫_t
 
	$rvu_˝t_af_øs_öå_h™dÀr
(
úq
, *
±r
)

117 
rvu_block
 *
block
 = 
±r
;

118 
rvu
 *rvu = 
block
->rvu;

119 
blkaddr
 = 
block
->
addr
;

120 
u64
 
ªg
;

122 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RAS_INT
);

123 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Re˚ived CPTAF RAS irq : 0x%Œx", 
ªg
);

125 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RAS_INT
, 
ªg
);

126  
IRQ_HANDLED
;

127 
	}
}

129 
	$rvu_˝t_do_ªgi°î_öãºu±
(
rvu_block
 *
block
, 
úq_offs
,

130 
úq_h™dÀr_t
 
h™dÀr
,

131 c⁄° *
«me
)

133 
rvu
 *rvu = 
block
->rvu;

134 
ªt
;

136 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
úq_offs
), 
h™dÀr
, 0,

137 
«me
, 
block
);

138 i‡(
ªt
) {

139 
	`dev_îr
(
rvu
->
dev
, "RVUAF: %†úqÑegi°øti⁄ faûed", 
«me
);

140  
ªt
;

143 
	`WARN_ON
(
rvu
->
úq_Æloˇãd
[
úq_offs
]);

144 
rvu
->
úq_Æloˇãd
[
úq_offs
] = 
åue
;

146 
	}
}

148 
	$˝t_10k_uƒegi°î_öãºu±s
(
rvu_block
 *
block
, 
off
)

150 
rvu
 *rvu = 
block
->rvu;

151 
blkaddr
 = 
block
->
addr
;

152 
i
;

155 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT_ENA_W1C
(0), ~0ULL);

156 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT_ENA_W1C
(1), ~0ULL);

157 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT_ENA_W1C
(2), 0xFFFF);

159 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RVU_INT_ENA_W1C
, 0x1);

160 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RAS_INT_ENA_W1C
, 0x1);

162 
i
 = 0; i < 
CPT_10K_AF_INT_VEC_CNT
; i++)

163 i‡(
rvu
->
úq_Æloˇãd
[
off
 + 
i
]) {

164 
	`‰ì_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
off
 + 
i
), 
block
);

165 
rvu
->
úq_Æloˇãd
[
off
 + 
i
] = 
Ál£
;

167 
	}
}

169 
	$˝t_uƒegi°î_öãºu±s
(
rvu
 *rvu, 
blkaddr
)

171 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

172 
rvu_block
 *
block
;

173 
i
, 
offs
;

175 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

177 
offs
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_PRIV_AF_INT_CFG
) & 0x7FF;

178 i‡(!
offs
) {

179 
	`dev_w¨n
(
rvu
->
dev
,

183 
block
 = &
hw
->block[
blkaddr
];

184 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

185  
	`˝t_10k_uƒegi°î_öãºu±s
(
block
, 
offs
);

188 
i
 = 0; i < 
CPT_AF_INT_VEC_RVU
; i++)

189 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT_ENA_W1C
(
i
), ~0ULL);

190 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RVU_INT_ENA_W1C
, 0x1);

191 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RAS_INT_ENA_W1C
, 0x1);

193 
i
 = 0; i < 
CPT_AF_INT_VEC_CNT
; i++)

194 i‡(
rvu
->
úq_Æloˇãd
[
offs
 + 
i
]) {

195 
	`‰ì_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
offs
 + 
i
), 
block
);

196 
rvu
->
úq_Æloˇãd
[
offs
 + 
i
] = 
Ál£
;

198 
	}
}

200 
	$rvu_˝t_uƒegi°î_öãºu±s
(
rvu
 *rvu)

202 
	`˝t_uƒegi°î_öãºu±s
(
rvu
, 
BLKADDR_CPT0
);

203 
	`˝t_uƒegi°î_öãºu±s
(
rvu
, 
BLKADDR_CPT1
);

204 
	}
}

206 
	$˝t_10k_ªgi°î_öãºu±s
(
rvu_block
 *
block
, 
off
)

208 
rvu
 *rvu = 
block
->rvu;

209 
blkaddr
 = 
block
->
addr
;

210 
úq_h™dÀr_t
 
Êt_‚
;

211 
i
, 
ªt
;

213 
i
 = 
CPT_10K_AF_INT_VEC_FLT0
; i < 
CPT_10K_AF_INT_VEC_RVU
; i++) {

214 
	`•rötf
(&
rvu
->
úq_«me
[(
off
 + 
i
Ë* 
NAME_SIZE
], "CPTAF FLT%d", i);

216 
i
) {

217 
CPT_10K_AF_INT_VEC_FLT0
:

218 
Êt_‚
 = 
rvu_˝t_af_Êt0_öå_h™dÀr
;

220 
CPT_10K_AF_INT_VEC_FLT1
:

221 
Êt_‚
 = 
rvu_˝t_af_Êt1_öå_h™dÀr
;

223 
CPT_10K_AF_INT_VEC_FLT2
:

224 
Êt_‚
 = 
rvu_˝t_af_Êt2_öå_h™dÀr
;

227 
ªt
 = 
	`rvu_˝t_do_ªgi°î_öãºu±
(
block
, 
off
 + 
i
,

228 
Êt_‚
, &
rvu
->
úq_«me
[(
off
 + 
i
Ë* 
NAME_SIZE
]);

229 i‡(
ªt
)

230 
îr
;

231 i‡(
i
 =
CPT_10K_AF_INT_VEC_FLT2
)

232 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT_ENA_W1S
(
i
), 0xFFFF);

234 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT_ENA_W1S
(
i
), ~0ULL);

237 
ªt
 = 
	`rvu_˝t_do_ªgi°î_öãºu±
(
block
, 
off
 + 
CPT_10K_AF_INT_VEC_RVU
,

238 
rvu_˝t_af_rvu_öå_h™dÀr
,

240 i‡(
ªt
)

241 
îr
;

242 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RVU_INT_ENA_W1S
, 0x1);

244 
ªt
 = 
	`rvu_˝t_do_ªgi°î_öãºu±
(
block
, 
off
 + 
CPT_10K_AF_INT_VEC_RAS
,

245 
rvu_˝t_af_øs_öå_h™dÀr
,

247 i‡(
ªt
)

248 
îr
;

249 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RAS_INT_ENA_W1S
, 0x1);

252 
îr
:

253 
	`rvu_˝t_uƒegi°î_öãºu±s
(
rvu
);

254  
ªt
;

255 
	}
}

257 
	$˝t_ªgi°î_öãºu±s
(
rvu
 *rvu, 
blkaddr
)

259 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

260 
rvu_block
 *
block
;

261 
úq_h™dÀr_t
 
Êt_‚
;

262 
i
, 
offs
, 
ªt
 = 0;

264 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

267 
block
 = &
hw
->block[
blkaddr
];

268 
offs
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_PRIV_AF_INT_CFG
) & 0x7FF;

269 i‡(!
offs
) {

270 
	`dev_w¨n
(
rvu
->
dev
,

275 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

276  
	`˝t_10k_ªgi°î_öãºu±s
(
block
, 
offs
);

278 
i
 = 
CPT_AF_INT_VEC_FLT0
; i < 
CPT_AF_INT_VEC_RVU
; i++) {

279 
	`•rötf
(&
rvu
->
úq_«me
[(
offs
 + 
i
Ë* 
NAME_SIZE
], "CPTAF FLT%d", i);

280 
i
) {

281 
CPT_AF_INT_VEC_FLT0
:

282 
Êt_‚
 = 
rvu_˝t_af_Êt0_öå_h™dÀr
;

284 
CPT_AF_INT_VEC_FLT1
:

285 
Êt_‚
 = 
rvu_˝t_af_Êt1_öå_h™dÀr
;

288 
ªt
 = 
	`rvu_˝t_do_ªgi°î_öãºu±
(
block
, 
offs
 + 
i
,

289 
Êt_‚
, &
rvu
->
úq_«me
[(
offs
 + 
i
Ë* 
NAME_SIZE
]);

290 i‡(
ªt
)

291 
îr
;

292 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT_ENA_W1S
(
i
), ~0ULL);

295 
ªt
 = 
	`rvu_˝t_do_ªgi°î_öãºu±
(
block
, 
offs
 + 
CPT_AF_INT_VEC_RVU
,

296 
rvu_˝t_af_rvu_öå_h™dÀr
,

298 i‡(
ªt
)

299 
îr
;

300 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RVU_INT_ENA_W1S
, 0x1);

302 
ªt
 = 
	`rvu_˝t_do_ªgi°î_öãºu±
(
block
, 
offs
 + 
CPT_AF_INT_VEC_RAS
,

303 
rvu_˝t_af_øs_öå_h™dÀr
,

305 i‡(
ªt
)

306 
îr
;

307 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RAS_INT_ENA_W1S
, 0x1);

310 
îr
:

311 
	`rvu_˝t_uƒegi°î_öãºu±s
(
rvu
);

312  
ªt
;

313 
	}
}

315 
	$rvu_˝t_ªgi°î_öãºu±s
(
rvu
 *rvu)

317 
ªt
;

319 
ªt
 = 
	`˝t_ªgi°î_öãºu±s
(
rvu
, 
BLKADDR_CPT0
);

320 i‡(
ªt
)

321  
ªt
;

323  
	`˝t_ªgi°î_öãºu±s
(
rvu
, 
BLKADDR_CPT1
);

324 
	}
}

326 
	$gë_˝t_pf_num
(
rvu
 *rvu)

328 
i
, 
domaö_ƒ
, 
˝t_pf_num
 = -1;

329 
pci_dev
 *
pdev
;

331 
domaö_ƒ
 = 
	`pci_domaö_ƒ
(
rvu
->
pdev
->
bus
);

332 
i
 = 0; i < 
rvu
->
hw
->
tŸÆ_pfs
; i++) {

333 
pdev
 = 
	`pci_gë_domaö_bus_™d_¶Ÿ
(
domaö_ƒ
, 
i
 + 1, 0);

334 i‡(!
pdev
)

337 i‡(
pdev
->
devi˚
 =
PCI_DEVID_OTX2_CPT_PF
 ||

338 
pdev
->
devi˚
 =
PCI_DEVID_OTX2_CPT10K_PF
) {

339 
˝t_pf_num
 = 
i
;

340 
	`put_devi˚
(&
pdev
->
dev
);

343 
	`put_devi˚
(&
pdev
->
dev
);

345  
˝t_pf_num
;

346 
	}
}

348 
boﬁ
 
	$is_˝t_pf
(
rvu
 *rvu, 
u16
 
pcifunc
)

350 
˝t_pf_num
 = 
rvu
->cpt_pf_num;

352 i‡(
	`rvu_gë_pf
(
pcifunc
Ë!
˝t_pf_num
)

353  
Ál£
;

354 i‡(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)

355  
Ál£
;

357  
åue
;

358 
	}
}

360 
boﬁ
 
	$is_˝t_vf
(
rvu
 *rvu, 
u16
 
pcifunc
)

362 
˝t_pf_num
 = 
rvu
->cpt_pf_num;

364 i‡(
	`rvu_gë_pf
(
pcifunc
Ë!
˝t_pf_num
)

365  
Ál£
;

366 i‡(!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
))

367  
Ál£
;

369  
åue
;

370 
	}
}

372 
	$vÆid©e_™d_gë_˝t_blkaddr
(
ªq_blkaddr
)

374 
blkaddr
;

376 
blkaddr
 = 
ªq_blkaddr
 ?Ñeq_blkadd∏: 
BLKADDR_CPT0
;

377 i‡(
blkaddr
 !
BLKADDR_CPT0
 && blkadd∏!
BLKADDR_CPT1
)

378  -
EINVAL
;

380  
blkaddr
;

381 
	}
}

383 
	$rvu_mbox_h™dÀr_˝t_lf_Æloc
(
rvu
 *rvu,

384 
˝t_lf_Æloc_ªq_msg
 *
ªq
,

385 
msg_r•
 *
r•
)

387 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

388 
rvu_block
 *
block
;

389 
˝éf
, 
blkaddr
;

390 
num_lfs
, 
¶Ÿ
;

391 
u64
 
vÆ
;

393 
blkaddr
 = 
	`vÆid©e_™d_gë_˝t_blkaddr
(
ªq
->blkaddr);

394 i‡(
blkaddr
 < 0)

395  
blkaddr
;

397 i‡(
ªq
->
íg_gΩmsk
 == 0x0)

398  
CPT_AF_ERR_GRP_INVALID
;

400 
block
 = &
rvu
->
hw
->block[
blkaddr
];

401 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
),

402 
block
->
addr
);

403 i‡(!
num_lfs
)

404  
CPT_AF_ERR_LF_INVALID
;

407 i‡(
ªq
->
nix_pf_func
) {

409 i‡(
ªq
->
nix_pf_func
 =
RVU_DEFAULT_PF_FUNC
)

410 
ªq
->
nix_pf_func
 = 
pcifunc
;

411 i‡(!
	`is_pffunc_m≠_vÆid
(
rvu
, 
ªq
->
nix_pf_func
, 
BLKTYPE_NIX
))

412  
CPT_AF_ERR_NIX_PF_FUNC_INVALID
;

416 i‡(
ªq
->
sso_pf_func
) {

418 i‡(
ªq
->
sso_pf_func
 =
RVU_DEFAULT_PF_FUNC
)

419 
ªq
->
sso_pf_func
 = 
pcifunc
;

420 i‡(!
	`is_pffunc_m≠_vÆid
(
rvu
, 
ªq
->
sso_pf_func
, 
BLKTYPE_SSO
))

421  
CPT_AF_ERR_SSO_PF_FUNC_INVALID
;

424 
¶Ÿ
 = 0; slŸ < 
num_lfs
; slot++) {

425 
˝éf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 
¶Ÿ
);

426 i‡(
˝éf
 < 0)

427  
CPT_AF_ERR_LF_INVALID
;

430 
vÆ
 = (
u64
)
ªq
->
íg_gΩmsk
 << 48 | 1;

431 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

432 
vÆ
 |(
CPT_CTX_ILEN
 << 17);

434 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
˝éf
), 
vÆ
);

439 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL2
(
˝éf
));

440 
vÆ
 &~(
	`GENMASK_ULL
(63, 48) | GENMASK_ULL(47, 32));

441 
vÆ
 |((
u64
)
ªq
->
nix_pf_func
 << 48 |

442 (
u64
)
ªq
->
sso_pf_func
 << 32);

443 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL2
(
˝éf
), 
vÆ
);

447 
	}
}

449 
	$˝t_lf_‰ì
(
rvu
 *rvu, 
msg_ªq
 *
ªq
, 
blkaddr
)

451 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

452 
num_lfs
, 
˝éf
, 
¶Ÿ
, 
îr
;

453 
rvu_block
 *
block
;

455 
block
 = &
rvu
->
hw
->block[
blkaddr
];

456 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
),

457 
block
->
addr
);

458 i‡(!
num_lfs
)

461 
¶Ÿ
 = 0; slŸ < 
num_lfs
; slot++) {

462 
˝éf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 
¶Ÿ
);

463 i‡(
˝éf
 < 0)

464  
CPT_AF_ERR_LF_INVALID
;

467 
	`rvu_˝t_lf_ã¨down
(
rvu
, 
pcifunc
, 
blkaddr
, 
˝éf
, 
¶Ÿ
);

470 
îr
 = 
	`rvu_lf_ª£t
(
rvu
, 
block
, 
˝éf
);

471 i‡(
îr
) {

472 
	`dev_îr
(
rvu
->
dev
, "FailedÅoÑeset blkaddr %d LF%d\n",

473 
block
->
addr
, 
˝éf
);

478 
	}
}

480 
	$rvu_mbox_h™dÀr_˝t_lf_‰ì
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

481 
msg_r•
 *
r•
)

483 
ªt
;

485 
ªt
 = 
	`˝t_lf_‰ì
(
rvu
, 
ªq
, 
BLKADDR_CPT0
);

486 i‡(
ªt
)

487  
ªt
;

489 i‡(
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_CPT1
))

490 
ªt
 = 
	`˝t_lf_‰ì
(
rvu
, 
ªq
, 
BLKADDR_CPT1
);

492  
ªt
;

493 
	}
}

495 
	$˝t_ölöe_ù£c_cfg_öbound
(
rvu
 *rvu, 
blkaddr
, 
u8
 
˝éf
,

496 
˝t_ölöe_ù£c_cfg_msg
 *
ªq
)

498 
u16
 
sso_pf_func
 = 
ªq
->sso_pf_func;

499 
u8
 
nix_£l
;

500 
u64
 
vÆ
;

502 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
˝éf
));

503 i‡(
ªq
->
íabÀ
 && (
vÆ
 & 
	`BIT_ULL
(16))) {

508  
CPT_AF_ERR_INLINE_IPSEC_INB_ENA
;

511 i‡(
sso_pf_func
 && !
	`is_pffunc_m≠_vÆid
(
rvu
, sso_pf_func, 
BLKTYPE_SSO
))

512  
CPT_AF_ERR_SSO_PF_FUNC_INVALID
;

514 
nix_£l
 = (
blkaddr
 =
BLKADDR_CPT1
) ? 1 : 0;

516 i‡(
ªq
->
íabÀ
)

517 
vÆ
 |
	`BIT_ULL
(9);

519 
vÆ
 &~
	`BIT_ULL
(9);

521 
vÆ
 |(
u64
)
nix_£l
 << 8;

522 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
˝éf
), 
vÆ
);

524 i‡(
sso_pf_func
) {

526 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL2
(
˝éf
));

527 
vÆ
 |(
u64
)
sso_pf_func
 << 32;

528 
vÆ
 |(
u64
)
ªq
->
nix_pf_func
 << 48;

529 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL2
(
˝éf
), 
vÆ
);

531 i‡(
ªq
->
sso_pf_func_ovrd
)

533 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_ECO
, 0x1);

538 i‡(!
	`is_rvu_Ÿx2
(
rvu
)) {

539 
vÆ
 = (
	`ûog2
(
NIX_CHAN_CPT_X2P_MASK
 + 1) << 16);

540 
vÆ
 |(
u64
)
rvu
->
hw
->
˝t_ch™_ba£
;

542 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_X2PX_LINK_CFG
(0), 
vÆ
);

543 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_X2PX_LINK_CFG
(1), 
vÆ
);

547 
	}
}

549 
	$˝t_ölöe_ù£c_cfg_outbound
(
rvu
 *rvu, 
blkaddr
, 
u8
 
˝éf
,

550 
˝t_ölöe_ù£c_cfg_msg
 *
ªq
)

552 
u16
 
nix_pf_func
 = 
ªq
->nix_pf_func;

553 
nix_blkaddr
;

554 
u8
 
nix_£l
;

555 
u64
 
vÆ
;

557 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
˝éf
));

558 i‡(
ªq
->
íabÀ
 && (
vÆ
 & 
	`BIT_ULL
(9))) {

563  
CPT_AF_ERR_INLINE_IPSEC_OUT_ENA
;

567 i‡(
nix_pf_func
 && !
	`is_pffunc_m≠_vÆid
(
rvu
,Çix_pf_func, 
BLKTYPE_NIX
))

568  
CPT_AF_ERR_NIX_PF_FUNC_INVALID
;

571 i‡(
ªq
->
íabÀ
)

572 
vÆ
 |
	`BIT_ULL
(16);

574 
vÆ
 &~
	`BIT_ULL
(16);

575 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
˝éf
), 
vÆ
);

577 i‡(
nix_pf_func
) {

579 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL2
(
˝éf
));

580 
vÆ
 |(
u64
)
nix_pf_func
 << 48;

581 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL2
(
˝éf
), 
vÆ
);

583 
nix_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
nix_pf_func
);

584 
nix_£l
 = (
nix_blkaddr
 =
BLKADDR_NIX0
) ? 0 : 1;

586 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
˝éf
));

587 
vÆ
 |(
u64
)
nix_£l
 << 8;

588 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
˝éf
), 
vÆ
);

592 
	}
}

594 
	$rvu_mbox_h™dÀr_˝t_ölöe_ù£c_cfg
(
rvu
 *rvu,

595 
˝t_ölöe_ù£c_cfg_msg
 *
ªq
,

596 
msg_r•
 *
r•
)

598 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

599 
rvu_block
 *
block
;

600 
˝éf
, 
blkaddr
, 
ªt
;

601 
u16
 
a˘uÆ_¶Ÿ
;

603 
blkaddr
 = 
	`rvu_gë_blkaddr_‰om_¶Ÿ
(
rvu
, 
BLKTYPE_CPT
, 
pcifunc
,

604 
ªq
->
¶Ÿ
, &
a˘uÆ_¶Ÿ
);

605 i‡(
blkaddr
 < 0)

606  
CPT_AF_ERR_LF_INVALID
;

608 
block
 = &
rvu
->
hw
->block[
blkaddr
];

610 
˝éf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 
a˘uÆ_¶Ÿ
);

611 i‡(
˝éf
 < 0)

612  
CPT_AF_ERR_LF_INVALID
;

614 
ªq
->
dú
) {

615 
CPT_INLINE_INBOUND
:

616 
ªt
 = 
	`˝t_ölöe_ù£c_cfg_öbound
(
rvu
, 
blkaddr
, 
˝éf
, 
ªq
);

619 
CPT_INLINE_OUTBOUND
:

620 
ªt
 = 
	`˝t_ölöe_ù£c_cfg_outbound
(
rvu
, 
blkaddr
, 
˝éf
, 
ªq
);

624  
CPT_AF_ERR_PARAM
;

627  
ªt
;

628 
	}
}

630 
boﬁ
 
	$is_vÆid_off£t
(
rvu
 *rvu, 
˝t_rd_wr_ªg_msg
 *
ªq
)

632 
u64
 
off£t
 = 
ªq
->
ªg_off£t
;

633 
blkaddr
, 
num_lfs
, 
lf
;

634 
rvu_block
 *
block
;

635 
rvu_pfvf
 *
pfvf
;

637 
blkaddr
 = 
	`vÆid©e_™d_gë_˝t_blkaddr
(
ªq
->blkaddr);

638 i‡(
blkaddr
 < 0)

639  
Ál£
;

642 i‡((
off£t
 & 0xFF000Ë=
	`CPT_AF_LFX_CTL
(0) ||

643 (
off£t
 & 0xFF000Ë=
	`CPT_AF_LFX_CTL2
(0)) {

644 i‡(
off£t
 & 7)

645  
Ál£
;

647 
lf
 = (
off£t
 & 0xFFF) >> 3;

648 
block
 = &
rvu
->
hw
->block[
blkaddr
];

649 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

650 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

651 i‡(
lf
 >
num_lfs
)

653  
Ál£
;

656 
lf
 = 
	`rvu_gë_lf
(
rvu
, &rvu->
hw
->
block
[
blkaddr
],

657 
ªq
->
hdr
.
pcifunc
, 
lf
);

658 i‡(
lf
 < 0)

659  
Ál£
;

661 
ªq
->
ªg_off£t
 &= 0xFF000;

662 
ªq
->
ªg_off£t
 +
lf
 << 3;

663  
åue
;

664 } i‡(!(
ªq
->
hdr
.
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)) {

666 
off£t
) {

667 
CPT_AF_DIAG
:

668 
CPT_AF_CTL
:

669 
CPT_AF_PF_FUNC
:

670 
CPT_AF_BLK_RST
:

671 
CPT_AF_CONSTANTS1
:

672 
CPT_AF_CTX_FLUSH_TIMER
:

673  
åue
;

676 
off£t
 & 0xFF000) {

677 
	`CPT_AF_EXEX_STS
(0):

678 
	`CPT_AF_EXEX_CTL
(0):

679 
	`CPT_AF_EXEX_CTL2
(0):

680 
	`CPT_AF_EXEX_UCODE_BASE
(0):

681 i‡(
off£t
 & 7)

682  
Ál£
;

685  
Ál£
;

687  
åue
;

689  
Ál£
;

690 
	}
}

692 
	$rvu_mbox_h™dÀr_˝t_rd_wr_ªgi°î
(
rvu
 *rvu,

693 
˝t_rd_wr_ªg_msg
 *
ªq
,

694 
˝t_rd_wr_ªg_msg
 *
r•
)

696 
blkaddr
;

698 
blkaddr
 = 
	`vÆid©e_™d_gë_˝t_blkaddr
(
ªq
->blkaddr);

699 i‡(
blkaddr
 < 0)

700  
blkaddr
;

703 i‡(!
	`is_˝t_pf
(
rvu
, 
ªq
->
hdr
.
pcifunc
) &&

704 !
	`is_˝t_vf
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

705  
CPT_AF_ERR_ACCESS_DENIED
;

707 i‡(!
	`is_vÆid_off£t
(
rvu
, 
ªq
))

708  
CPT_AF_ERR_ACCESS_DENIED
;

710 
r•
->
ªg_off£t
 = 
ªq
->reg_offset;

711 
r•
->
ªt_vÆ
 = 
ªq
->ret_val;

712 
r•
->
is_wrôe
 = 
ªq
->is_write;

715 i‡(
ªq
->
is_wrôe
)

716 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªq
->
ªg_off£t
,Ñeq->
vÆ
);

718 
r•
->
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
ªq
->
ªg_off£t
);

721 
	}
}

723 
	$gë_˘x_pc
(
rvu
 *rvu, 
˝t_°s_r•
 *
r•
, 
blkaddr
)

725 i‡(
	`is_rvu_Ÿx2
(
rvu
))

728 
r•
->
˘x_mis_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_MIS_PC
);

729 
r•
->
˘x_hô_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_HIT_PC
);

730 
r•
->
˘x_a›_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_AOP_PC
);

731 
r•
->
˘x_a›_œt_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

732 
CPT_AF_CTX_AOP_LATENCY_PC
);

733 
r•
->
˘x_i„tch_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_IFETCH_PC
);

734 
r•
->
˘x_i„tch_œt_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

735 
CPT_AF_CTX_IFETCH_LATENCY_PC
);

736 
r•
->
˘x_f„tch_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_FFETCH_PC
);

737 
r•
->
˘x_f„tch_œt_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

738 
CPT_AF_CTX_FFETCH_LATENCY_PC
);

739 
r•
->
˘x_wback_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_FFETCH_PC
);

740 
r•
->
˘x_wback_œt_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

741 
CPT_AF_CTX_FFETCH_LATENCY_PC
);

742 
r•
->
˘x_psh_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_FFETCH_PC
);

743 
r•
->
˘x_psh_œt_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

744 
CPT_AF_CTX_FFETCH_LATENCY_PC
);

745 
r•
->
˘x_îr
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_ERR
);

746 
r•
->
˘x_íc_id
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_ENC_ID
);

747 
r•
->
˘x_Êush_timî
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CTX_FLUSH_TIMER
);

749 
r•
->
rxc_time
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_TIME
);

750 
r•
->
rxc_time_cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_TIME_CFG
);

751 
r•
->
rxc_a˘ive_°s
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_ACTIVE_STS
);

752 
r•
->
rxc_zombõ_°s
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_ZOMBIE_STS
);

753 
r•
->
rxc_d‰g
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_DFRG
);

754 
r•
->
x2p_lök_cfg0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_X2PX_LINK_CFG
(0));

755 
r•
->
x2p_lök_cfg1
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_X2PX_LINK_CFG
(1));

756 
	}
}

758 
	$gë_íg_°s
(
rvu
 *rvu, 
˝t_°s_r•
 *
r•
, 
blkaddr
)

760 
u16
 
max_£s
, 
max_õs
, 
max_´s
;

761 
u32
 
e_mö
 = 0, 
e_max
 = 0;

762 
u64
 
ªg
;

764 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CONSTANTS1
);

765 
max_£s
 = 
ªg
 & 0xffff;

766 
max_õs
 = (
ªg
 >> 16) & 0xffff;

767 
max_´s
 = (
ªg
 >> 32) & 0xffff;

770 
e_mö
 = 
max_£s
 + 
max_õs
;

771 
e_max
 = 
max_£s
 + 
max_õs
 + 
max_´s
;

772 
	`˝t_gë_íg_°s
(
e_mö
, 
e_max
, 
r•
, 
´
);

774 
e_mö
 = 0;

775 
e_max
 = 
max_£s
;

776 
	`˝t_gë_íg_°s
(
e_mö
, 
e_max
, 
r•
, 
£
);

778 
e_mö
 = 
max_£s
;

779 
e_max
 = 
max_£s
 + 
max_õs
;

780 
	`˝t_gë_íg_°s
(
e_mö
, 
e_max
, 
r•
, 
õ
);

781 
	}
}

783 
	$rvu_mbox_h™dÀr_˝t_°s
(
rvu
 *rvu, 
˝t_°s_ªq
 *
ªq
,

784 
˝t_°s_r•
 *
r•
)

786 
blkaddr
;

788 
blkaddr
 = 
	`vÆid©e_™d_gë_˝t_blkaddr
(
ªq
->blkaddr);

789 i‡(
blkaddr
 < 0)

790  
blkaddr
;

793 i‡(!
	`is_˝t_pf
(
rvu
, 
ªq
->
hdr
.
pcifunc
) &&

794 !
	`is_˝t_vf
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

795  
CPT_AF_ERR_ACCESS_DENIED
;

797 
	`gë_˘x_pc
(
rvu
, 
r•
, 
blkaddr
);

800 
	`gë_íg_°s
(
rvu
, 
r•
, 
blkaddr
);

803 
r•
->
ö°_ªq_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_INST_REQ_PC
);

804 
r•
->
ö°_œt_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_INST_LATENCY_PC
);

805 
r•
->
rd_ªq_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RD_REQ_PC
);

806 
r•
->
rd_œt_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RD_LATENCY_PC
);

807 
r•
->
rd_uc_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RD_UC_PC
);

808 
r•
->
a˘ive_cy˛es_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

809 
CPT_AF_ACTIVE_CYCLES_PC
);

810 
r•
->
exe_îr_öfo
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_EXE_ERR_INFO
);

811 
r•
->
˝t˛k_˙t
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CPTCLK_CNT
);

812 
r•
->
düg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_DIAG
);

815 
	}
}

817 
	#RXC_ZOMBIE_THRES
 
	`GENMASK_ULL
(59, 48)

	)

818 
	#RXC_ZOMBIE_LIMIT
 
	`GENMASK_ULL
(43, 32)

	)

819 
	#RXC_ACTIVE_THRES
 
	`GENMASK_ULL
(27, 16)

	)

820 
	#RXC_ACTIVE_LIMIT
 
	`GENMASK_ULL
(11, 0)

	)

821 
	#RXC_ACTIVE_COUNT
 
	`GENMASK_ULL
(60, 48)

	)

822 
	#RXC_ZOMBIE_COUNT
 
	`GENMASK_ULL
(60, 48)

	)

824 
	$˝t_rxc_time_cfg
(
rvu
 *rvu, 
˝t_rxc_time_cfg_ªq
 *
ªq
,

825 
blkaddr
, 
˝t_rxc_time_cfg_ªq
 *
ßve
)

827 
u64
 
d‰g_ªg
;

829 i‡(
ßve
) {

831 
d‰g_ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_DFRG
);

832 
ßve
->
zombõ_thªs
 = 
	`FIELD_GET
(
RXC_ZOMBIE_THRES
, 
d‰g_ªg
);

833 
ßve
->
zombõ_limô
 = 
	`FIELD_GET
(
RXC_ZOMBIE_LIMIT
, 
d‰g_ªg
);

834 
ßve
->
a˘ive_thªs
 = 
	`FIELD_GET
(
RXC_ACTIVE_THRES
, 
d‰g_ªg
);

835 
ßve
->
a˘ive_limô
 = 
	`FIELD_GET
(
RXC_ACTIVE_LIMIT
, 
d‰g_ªg
);

837 
ßve
->
°ï
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_TIME_CFG
);

840 
d‰g_ªg
 = 
	`FIELD_PREP
(
RXC_ZOMBIE_THRES
, 
ªq
->
zombõ_thªs
);

841 
d‰g_ªg
 |
	`FIELD_PREP
(
RXC_ZOMBIE_LIMIT
, 
ªq
->
zombõ_limô
);

842 
d‰g_ªg
 |
	`FIELD_PREP
(
RXC_ACTIVE_THRES
, 
ªq
->
a˘ive_thªs
);

843 
d‰g_ªg
 |
	`FIELD_PREP
(
RXC_ACTIVE_LIMIT
, 
ªq
->
a˘ive_limô
);

845 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_TIME_CFG
, 
ªq
->
°ï
);

846 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_DFRG
, 
d‰g_ªg
);

847 
	}
}

849 
	$rvu_mbox_h™dÀr_˝t_rxc_time_cfg
(
rvu
 *rvu,

850 
˝t_rxc_time_cfg_ªq
 *
ªq
,

851 
msg_r•
 *
r•
)

853 
blkaddr
;

855 
blkaddr
 = 
	`vÆid©e_™d_gë_˝t_blkaddr
(
ªq
->blkaddr);

856 i‡(
blkaddr
 < 0)

857  
blkaddr
;

860 i‡(!
	`is_˝t_pf
(
rvu
, 
ªq
->
hdr
.
pcifunc
) &&

861 !
	`is_˝t_vf
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

862  
CPT_AF_ERR_ACCESS_DENIED
;

864 
	`˝t_rxc_time_cfg
(
rvu
, 
ªq
, 
blkaddr
, 
NULL
);

867 
	}
}

869 
	$rvu_mbox_h™dÀr_˝t_˘x_ˇche_sync
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

870 
msg_r•
 *
r•
)

872  
	`rvu_˝t_˘x_Êush
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

873 
	}
}

875 
	$rvu_mbox_h™dÀr_˝t_lf_ª£t
(
rvu
 *rvu, 
˝t_lf_r°_ªq
 *
ªq
,

876 
msg_r•
 *
r•
)

878 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

879 
rvu_block
 *
block
;

880 
˝éf
, 
blkaddr
, 
ªt
;

881 
u16
 
a˘uÆ_¶Ÿ
;

882 
u64
 
˘l
, 
˘l2
;

884 
blkaddr
 = 
	`rvu_gë_blkaddr_‰om_¶Ÿ
(
rvu
, 
BLKTYPE_CPT
, 
pcifunc
,

885 
ªq
->
¶Ÿ
, &
a˘uÆ_¶Ÿ
);

886 i‡(
blkaddr
 < 0)

887  
CPT_AF_ERR_LF_INVALID
;

889 
block
 = &
rvu
->
hw
->block[
blkaddr
];

891 
˝éf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 
a˘uÆ_¶Ÿ
);

892 i‡(
˝éf
 < 0)

893  
CPT_AF_ERR_LF_INVALID
;

894 
˘l
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
˝éf
));

895 
˘l2
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL2
(
˝éf
));

897 
ªt
 = 
	`rvu_lf_ª£t
(
rvu
, 
block
, 
˝éf
);

898 i‡(
ªt
)

899 
	`dev_îr
(
rvu
->
dev
, "FailedÅoÑeset blkaddr %d LF%d\n",

900 
block
->
addr
, 
˝éf
);

902 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
˝éf
), 
˘l
);

903 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL2
(
˝éf
), 
˘l2
);

906 
	}
}

908 
	$rvu_mbox_h™dÀr_˝t_Êt_íg_öfo
(
rvu
 *rvu, 
˝t_Êt_íg_öfo_ªq
 *
ªq
,

909 
˝t_Êt_íg_öfo_r•
 *
r•
)

911 
rvu_block
 *
block
;

912 
Êags
;

913 
blkaddr
, 
vec
;

915 
blkaddr
 = 
	`vÆid©e_™d_gë_˝t_blkaddr
(
ªq
->blkaddr);

916 i‡(
blkaddr
 < 0)

917  
blkaddr
;

919 
block
 = &
rvu
->
hw
->block[
blkaddr
];

920 
vec
 = 0; ve¯< 
CPT_10K_AF_INT_VEC_RVU
; vec++) {

921 
	`•ö_lock_úqßve
(&
rvu
->
˝t_öå_lock
, 
Êags
);

922 
r•
->
Êt_íg_m≠
[
vec
] = 
block
->
˝t_Êt_íg_m≠
[vec];

923 
r•
->
rcvrd_íg_m≠
[
vec
] = 
block
->
˝t_rcvrd_íg_m≠
[vec];

924 i‡(
ªq
->
ª£t
) {

925 
block
->
˝t_Êt_íg_m≠
[
vec
] = 0x0;

926 
block
->
˝t_rcvrd_íg_m≠
[
vec
] = 0x0;

928 
	`•ö_u∆ock_úqª°‹e
(&
rvu
->
˝t_öå_lock
, 
Êags
);

931 
	}
}

933 
	$˝t_rxc_ã¨down
(
rvu
 *rvu, 
blkaddr
)

935 
˝t_rxc_time_cfg_ªq
 
ªq
, 
¥ev
;

936 
timeout
 = 2000;

937 
u64
 
ªg
;

939 i‡(
	`is_rvu_Ÿx2
(
rvu
))

945 
ªq
.
°ï
 = 1;

946 
ªq
.
zombõ_thªs
 = 1;

947 
ªq
.
zombõ_limô
 = 1;

948 
ªq
.
a˘ive_thªs
 = 1;

949 
ªq
.
a˘ive_limô
 = 1;

951 
	`˝t_rxc_time_cfg
(
rvu
, &
ªq
, 
blkaddr
, &
¥ev
);

954 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_ACTIVE_STS
);

955 
	`udñay
(1);

956 i‡(
	`FIELD_GET
(
RXC_ACTIVE_COUNT
, 
ªg
))

957 
timeout
--;

960 } 
timeout
);

962 i‡(
timeout
 == 0)

963 
	`dev_w¨n
(
rvu
->
dev
, "Poll for RXCáctive count hits hardÜoop counter\n");

965 
timeout
 = 2000;

967 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RXC_ZOMBIE_STS
);

968 
	`udñay
(1);

969 i‡(
	`FIELD_GET
(
RXC_ZOMBIE_COUNT
, 
ªg
))

970 
timeout
--;

973 } 
timeout
);

975 i‡(
timeout
 == 0)

976 
	`dev_w¨n
(
rvu
->
dev
, "Poll for RXC zombie count hits hardÜoop counter\n");

979 
	`˝t_rxc_time_cfg
(
rvu
, &
¥ev
, 
blkaddr
, 
NULL
);

980 
	}
}

982 
	#INFLIGHT
 
	`GENMASK_ULL
(8, 0)

	)

983 
	#GRB_CNT
 
	`GENMASK_ULL
(39, 32)

	)

984 
	#GWB_CNT
 
	`GENMASK_ULL
(47, 40)

	)

985 
	#XQ_XOR
 
	`GENMASK_ULL
(63, 63)

	)

986 
	#DQPTR
 
	`GENMASK_ULL
(19, 0)

	)

987 
	#NQPTR
 
	`GENMASK_ULL
(51, 32)

	)

989 
	$˝t_lf_dißbÀ_iqueue
(
rvu
 *rvu, 
blkaddr
, 
¶Ÿ
)

991 
timeout
 = 1000000;

992 
u64
 
ö¥og
, 
ö°_±r
;

993 
u64
 
qsize
, 
≥ndög
;

994 
i
 = 0;

997 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`CPT_AF_BAR2_ALIASX
(
¶Ÿ
, 
CPT_LF_CTL
), 0x0);

999 
ö¥og
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1000 
	`CPT_AF_BAR2_ALIASX
(
¶Ÿ
, 
CPT_LF_INPROG
));

1001 
ö¥og
 |
	`BIT_ULL
(16);

1002 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1003 
	`CPT_AF_BAR2_ALIASX
(
¶Ÿ
, 
CPT_LF_INPROG
), 
ö¥og
);

1005 
qsize
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1006 
	`CPT_AF_BAR2_ALIASX
(
¶Ÿ
, 
CPT_LF_Q_SIZE
)) & 0x7FFF;

1008 
ö°_±r
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1009 
	`CPT_AF_BAR2_ALIASX
(
¶Ÿ
, 
CPT_LF_Q_INST_PTR
));

1010 
≥ndög
 = (
	`FIELD_GET
(
XQ_XOR
, 
ö°_±r
Ë* 
qsize
 * 40) +

1011 
	`FIELD_GET
(
NQPTR
, 
ö°_±r
) -

1012 
	`FIELD_GET
(
DQPTR
, 
ö°_±r
);

1013 
	`udñay
(1);

1014 
timeout
--;

1015 } (
≥ndög
 !0Ë&& (
timeout
 != 0));

1017 i‡(
timeout
 == 0)

1018 
	`dev_w¨n
(
rvu
->
dev
, "TIMEOUT: CPTÖoll onÖending instructions\n");

1020 
timeout
 = 1000000;

1023 
ö¥og
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1024 
	`CPT_AF_BAR2_ALIASX
(
¶Ÿ
, 
CPT_LF_INPROG
));

1026 i‡((
	`FIELD_GET
(
INFLIGHT
, 
ö¥og
) == 0) &&

1027 (
	`FIELD_GET
(
GRB_CNT
, 
ö¥og
) == 0)) {

1028 
i
++;

1030 
i
 = 0;

1031 
timeout
--;

1033 } (
timeout
 !0Ë&& (
i
 < 10));

1035 i‡(
timeout
 == 0)

1036 
	`dev_w¨n
(
rvu
->
dev
, "TIMEOUT: CPTÖoll on inflight count\n");

1038 
	`udñay
(2);

1039 
	}
}

1041 
	$rvu_˝t_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
blkaddr
, 
lf
, 
¶Ÿ
)

1043 
u64
 
ªg
;

1045 i‡(
	`is_˝t_pf
(
rvu
, 
pcifunc
Ë|| 
	`is_˝t_vf
(rvu,Öcifunc))

1046 
	`˝t_rxc_ã¨down
(
rvu
, 
blkaddr
);

1048 
	`muãx_lock
(&
rvu
->
Æüs_lock
);

1050 
ªg
 = 
	`BIT_ULL
(16Ë| 
pcifunc
;

1051 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_BAR2_SEL
, 
ªg
);

1053 
	`˝t_lf_dißbÀ_iqueue
(
rvu
, 
blkaddr
, 
¶Ÿ
);

1055 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_BAR2_SEL
, 0);

1056 
	`muãx_u∆ock
(&
rvu
->
Æüs_lock
);

1059 
	}
}

1061 
	#CPT_RES_LEN
 16

	)

1062 
	#CPT_SE_IE_EGRP
 1ULL

	)

1064 
	$˝t_ölöe_öb_lf_cmd_£nd
(
rvu
 *rvu, 
blkaddr
,

1065 
nix_blkaddr
)

1067 
˝t_pf_num
 = 
rvu
->cpt_pf_num;

1068 
˝t_ö°_lmt°_ªq
 *
ªq
;

1069 
dma_addr_t
 
ªs_daddr
;

1070 
timeout
 = 3000;

1071 
u8
 
˝t_idx
;

1072 
u64
 *
ö°
;

1073 
u16
 *
ªs
;

1074 
rc
;

1076 
ªs
 = 
	`kzÆloc
(
CPT_RES_LEN
, 
GFP_KERNEL
);

1077 i‡(!
ªs
)

1078  -
ENOMEM
;

1080 
ªs_daddr
 = 
	`dma_m≠_sögÀ
(
rvu
->
dev
, 
ªs
, 
CPT_RES_LEN
,

1081 
DMA_BIDIRECTIONAL
);

1082 i‡(
	`dma_m≠pög_îr‹
(
rvu
->
dev
, 
ªs_daddr
)) {

1083 
	`dev_îr
(
rvu
->
dev
, "DMA mapping failed for CPTÑesult\n");

1084 
rc
 = -
EFAULT
;

1085 
ªs_‰ì
;

1087 *
ªs
 = 0xFFFF;

1090 
ªq
 = (
˝t_ö°_lmt°_ªq
 *)

1091 
	`Ÿx2_mbox_Æloc_msg_r•
(&
rvu
->
aÂf_wq_öfo
.
mbox_up
,

1092 
˝t_pf_num
, (*
ªq
),

1093 (
msg_r•
));

1094 i‡(!
ªq
) {

1095 
rc
 = -
ENOMEM
;

1096 
ªs_daddr_unm≠
;

1098 
ªq
->
hdr
.
sig
 = 
OTX2_MBOX_REQ_SIG
;

1099 
ªq
->
hdr
.
id
 = 
MBOX_MSG_CPT_INST_LMTST
;

1101 
ö°
 = 
ªq
->inst;

1103 
ö°
[0] = 0;

1104 
ö°
[1] = 
ªs_daddr
;

1106 
ö°
[2] = 0;

1108 
ö°
[3] = 1;

1109 
ö°
[4] = 0;

1110 
ö°
[5] = 0;

1111 
ö°
[6] = 0;

1113 
ö°
[7] = 
CPT_SE_IE_EGRP
 << 61;

1118 
˝t_idx
 = (
blkaddr
 =
BLKADDR_CPT0
) ? 0 : 1;

1119 
	`rvu_wrôe64
(
rvu
, 
nix_blkaddr
, 
	`NIX_AF_RX_CPTX_CREDIT
(
˝t_idx
),

1120 
	`BIT_ULL
(22) - 1);

1122 
	`Ÿx2_mbox_msg_£nd
(&
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
˝t_pf_num
);

1123 
rc
 = 
	`Ÿx2_mbox_waô_f‹_r•
(&
rvu
->
aÂf_wq_öfo
.
mbox_up
, 
˝t_pf_num
);

1124 i‡(
rc
)

1125 
	`dev_w¨n
(
rvu
->
dev
, "notificationÅoÖf %d failed\n",

1126 
˝t_pf_num
);

1129 
	`mdñay
(1);

1130 i‡(*
ªs
 == 0xFFFF)

1131 
timeout
--;

1134 } 
timeout
);

1136 i‡(
timeout
 == 0)

1137 
	`dev_w¨n
(
rvu
->
dev
, "Poll forÑesult hits hardÜoop counter\n");

1139 
ªs_daddr_unm≠
:

1140 
	`dma_unm≠_sögÀ
(
rvu
->
dev
, 
ªs_daddr
, 
CPT_RES_LEN
, 
DMA_BIDIRECTIONAL
);

1141 
ªs_‰ì
:

1142 
	`k‰ì
(
ªs
);

1145 
	}
}

1147 
	#CTX_CAM_PF_FUNC
 
	`GENMASK_ULL
(61, 46)

	)

1148 
	#CTX_CAM_CPTR
 
	`GENMASK_ULL
(45, 0)

	)

1150 
	$rvu_˝t_˘x_Êush
(
rvu
 *rvu, 
u16
 
pcifunc
)

1152 
nix_blkaddr
, 
blkaddr
;

1153 
u16
 
max_˘x_íåõs
, 
i
;

1154 
¶Ÿ
 = 0, 
num_lfs
;

1155 
u64
 
ªg
, 
ˇm_d©a
;

1156 
rc
;

1158 
nix_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

1159 i‡(
nix_blkaddr
 < 0)

1160  -
EINVAL
;

1162 i‡(
	`is_rvu_Ÿx2
(
rvu
))

1165 
blkaddr
 = (
nix_blkaddr
 =
BLKADDR_NIX1
Ë? 
BLKADDR_CPT1
 : 
BLKADDR_CPT0
;

1170 
rc
 = 
	`˝t_ölöe_öb_lf_cmd_£nd
(
rvu
, 
blkaddr
, 
nix_blkaddr
);

1171 i‡(
rc
)

1172  
rc
;

1175 
	`˝t_rxc_ã¨down
(
rvu
, 
blkaddr
);

1177 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CONSTANTS0
);

1178 
max_˘x_íåõs
 = (
ªg
 >> 48) & 0xFFF;

1180 
	`muãx_lock
(&
rvu
->
r§c_lock
);

1182 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
),

1183 
blkaddr
);

1184 i‡(
num_lfs
 == 0) {

1185 
	`dev_w¨n
(
rvu
->
dev
, "CPT LF isÇot configured\n");

1186 
u∆ock
;

1190 
ªg
 = 
	`BIT_ULL
(16Ë| 
pcifunc
;

1191 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_BAR2_SEL
, 
ªg
);

1193 
i
 = 0; i < 
max_˘x_íåõs
; i++) {

1194 
ˇm_d©a
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_CTX_CAM_DATA
(
i
));

1196 i‡((
	`FIELD_GET
(
CTX_CAM_PF_FUNC
, 
ˇm_d©a
Ë=
pcifunc
) &&

1197 
	`FIELD_GET
(
CTX_CAM_CPTR
, 
ˇm_d©a
)) {

1198 
ªg
 = 
	`BIT_ULL
(46Ë| 
	`FIELD_GET
(
CTX_CAM_CPTR
, 
ˇm_d©a
);

1199 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1200 
	`CPT_AF_BAR2_ALIASX
(
¶Ÿ
, 
CPT_LF_CTX_FLUSH
),

1201 
ªg
);

1204 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
blkaddr
, 
CPT_AF_BAR2_SEL
, 0);

1206 
u∆ock
:

1207 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

1210 
	}
}

1212 
	$rvu_˝t_öô
(
rvu
 *rvu)

1215 
rvu
->
˝t_pf_num
 = 
	`gë_˝t_pf_num
(rvu);

1216 
	`•ö_lock_öô
(&
rvu
->
˝t_öå_lock
);

1219 
	}
}

	@rvu_debugfs.c

8 #ifde‡
CONFIG_DEBUG_FS


10 
	~<löux/fs.h
>

11 
	~<löux/debugfs.h
>

12 
	~<löux/moduÀ.h
>

13 
	~<löux/pci.h
>

15 
	~"rvu_°ru˘.h
"

16 
	~"rvu_ªg.h
"

17 
	~"rvu.h
"

18 
	~"cgx.h
"

19 
	~"lmac_comm⁄.h
"

20 
	~"≈c.h
"

21 
	~"mcs.h
"

22 
	~"rvu_≈c_hash.h
"

24 
	#DEBUGFS_DIR_NAME
 "o˘e⁄tx2"

	)

27 
	mCGX_STAT0
,

28 
	mCGX_STAT1
,

29 
	mCGX_STAT2
,

30 
	mCGX_STAT3
,

31 
	mCGX_STAT4
,

32 
	mCGX_STAT5
,

33 
	mCGX_STAT6
,

34 
	mCGX_STAT7
,

35 
	mCGX_STAT8
,

36 
	mCGX_STAT9
,

37 
	mCGX_STAT10
,

38 
	mCGX_STAT11
,

39 
	mCGX_STAT12
,

40 
	mCGX_STAT13
,

41 
	mCGX_STAT14
,

42 
	mCGX_STAT15
,

43 
	mCGX_STAT16
,

44 
	mCGX_STAT17
,

45 
	mCGX_STAT18
,

49 
	enix_°©_lf_tx
 {

50 
	mTX_UCAST
 = 0x0,

51 
	mTX_BCAST
 = 0x1,

52 
	mTX_MCAST
 = 0x2,

53 
	mTX_DROP
 = 0x3,

54 
	mTX_OCTS
 = 0x4,

55 
	mTX_STATS_ENUM_LAST
,

59 
	enix_°©_lf_rx
 {

60 
	mRX_OCTS
 = 0x0,

61 
	mRX_UCAST
 = 0x1,

62 
	mRX_BCAST
 = 0x2,

63 
	mRX_MCAST
 = 0x3,

64 
	mRX_DROP
 = 0x4,

65 
	mRX_DROP_OCTS
 = 0x5,

66 
	mRX_FCS
 = 0x6,

67 
	mRX_ERR
 = 0x7,

68 
	mRX_DRP_BCAST
 = 0x8,

69 
	mRX_DRP_MCAST
 = 0x9,

70 
	mRX_DRP_L3BCAST
 = 0xa,

71 
	mRX_DRP_L3MCAST
 = 0xb,

72 
	mRX_STATS_ENUM_LAST
,

75 *
	gcgx_rx_°©s_fõlds
[] = {

76 [
CGX_STAT0
] = "ReceivedÖackets",

77 [
CGX_STAT1
] = "Octets ofÑeceivedÖackets",

78 [
CGX_STAT2
] = "Received PAUSEÖackets",

79 [
CGX_STAT3
] = "Received PAUSEánd controlÖackets",

80 [
CGX_STAT4
] = "Filtered DMAC0 (NIX-bound)Öackets",

81 [
CGX_STAT5
] = "Filtered DMAC0 (NIX-bound) octets",

82 [
CGX_STAT6
] = "Packets dropped dueÅo RX FIFO full",

83 [
CGX_STAT7
] = "Octets dropped dueÅo RX FIFO full",

84 [
CGX_STAT8
] = "ErrorÖackets",

85 [
CGX_STAT9
] = "Filtered DMAC1 (NCSI-bound)Öackets",

86 [
CGX_STAT10
] = "Filtered DMAC1 (NCSI-bound) octets",

87 [
CGX_STAT11
] = "NCSI-boundÖackets dropped",

88 [
CGX_STAT12
] = "NCSI-bound octets dropped",

91 *
	gcgx_tx_°©s_fõlds
[] = {

92 [
CGX_STAT0
] = "Packets dropped dueÅoÉxcessive collisions",

93 [
CGX_STAT1
] = "Packets dropped dueÅoÉxcessive deferral",

94 [
CGX_STAT2
] = "Multiple collisions before successfulÅransmission",

95 [
CGX_STAT3
] = "Single collisions before successfulÅransmission",

96 [
CGX_STAT4
] = "Total octets sent onÅhe interface",

97 [
CGX_STAT5
] = "Total frames sent onÅhe interface",

98 [
CGX_STAT6
] = "Packets sent withán octet count < 64",

99 [
CGX_STAT7
] = "Packets sent withán octet count == 64",

100 [
CGX_STAT8
] = "Packets sent withán octet count of 65-127",

101 [
CGX_STAT9
] = "Packets sent withán octet count of 128-255",

102 [
CGX_STAT10
] = "Packets sent withán octet count of 256-511",

103 [
CGX_STAT11
] = "Packets sent withán octet count of 512-1023",

104 [
CGX_STAT12
] = "Packets sent withán octet count of 1024-1518",

105 [
CGX_STAT13
] = "Packets sent withán octet count of > 1518",

106 [
CGX_STAT14
] = "Packets sentÅoá broadcast DMAC",

107 [
CGX_STAT15
] = "Packets sentÅoÅhe multicast DMAC",

108 [
CGX_STAT16
] = "Transmit underflowánd wereÅruncated",

109 [
CGX_STAT17
] = "Control/PAUSEÖackets sent",

112 *
	gΩm_rx_°©s_fõlds
[] = {

158 *
	gΩm_tx_°©s_fõlds
[] = {

195 
	#rvu_dbg_NULL
 
NULL


	)

196 
	#rvu_dbg_›í_NULL
 
NULL


	)

198 
	#RVU_DEBUG_SEQ_FOPS
(
«me
, 
ªad_›
, 
wrôe_›
) \

199 
rvu_dbg_›í_
##
	`«me
(
öode
 *öode, 
fûe
 *file) \

201  
	`sögÀ_›í
(
fûe
, 
rvu_dbg_
##
ªad_›
, 
öode
->
i_¥iv©e
); \

203 c⁄° 
fûe_›î©i⁄s
 
rvu_dbg_
##
«me
##
_f›s
 = { \

204 .
ow√r
 = 
THIS_MODULE
, \

205 .
›í
 = 
rvu_dbg_›í_
##
«me
, \

206 .
ªad
 = 
£q_ªad
, \

207 .
wrôe
 = 
rvu_dbg_
##
wrôe_›
, \

208 .
Œ£ek
 = 
£q_l£ek
, \

209 .
ªÀa£
 = 
sögÀ_ªÀa£
, \

210 }

	)

212 
	#RVU_DEBUG_FOPS
(
«me
, 
ªad_›
, 
wrôe_›
) \

213 c⁄° 
fûe_›î©i⁄s
 
rvu_dbg_
##
«me
##
_f›s
 = { \

214 .
ow√r
 = 
THIS_MODULE
, \

215 .
›í
 = 
sim∂e_›í
, \

216 .
ªad
 = 
rvu_dbg_
##
ªad_›
, \

217 .
wrôe
 = 
rvu_dbg_
##
wrôe_›
 \

218 }

	)

220 
¥öt_nix_qsize
(
£q_fûe
 *
fûp
, 
rvu_pfvf
 *
pfvf
);

222 
	$rvu_dbg_mcs_p‹t_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
, 
dú
)

224 
mcs
 *mc†
fûp
->
¥iv©e
;

225 
mcs_p‹t_°©s
 
°©s
;

226 
lmac
;

228 
	`£q_puts
(
fûp
, "\nÖort stats\n");

229 
	`muãx_lock
(&
mcs
->
°©s_lock
);

230 
	`f‹_óch_£t_bô
(
lmac
, &
mcs
->
hw
->
lmac_bm≠
, mcs->hw->
lmac_˙t
) {

231 
	`mcs_gë_p‹t_°©s
(
mcs
, &
°©s
, 
lmac
, 
dú
);

232 
	`£q_¥ötf
(
fûp
, "p‹t%d: Tˇm Miss: %Œd\n", 
lmac
, 
°©s
.
tˇm_miss_˙t
);

233 
	`£q_¥ötf
(
fûp
, "p‹t%d: P¨£∏îr‹s: %Œd\n", 
lmac
, 
°©s
.
∑r£r_îr_˙t
);

235 i‡(
dú
 =
MCS_RX
 && 
mcs
->
hw
->
mcs_blks
 > 1)

236 
	`£q_¥ötf
(
fûp
, "p‹t%d: Pªem±Éº‹: %Œd\n", 
lmac
,

237 
°©s
.
¥ìm±_îr_˙t
);

238 i‡(
dú
 =
MCS_TX
)

239 
	`£q_¥ötf
(
fûp
, "p‹t%d: Se˘ag in£πÉº‹: %Œd\n", 
lmac
,

240 
°©s
.
£˘ag_ö£π_îr_˙t
);

242 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

244 
	}
}

246 
	$rvu_dbg_mcs_rx_p‹t_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

248  
	`rvu_dbg_mcs_p‹t_°©s_di•œy
(
fûp
, 
unu£d
, 
MCS_RX
);

249 
	}
}

251 
RVU_DEBUG_SEQ_FOPS
(
mcs_rx_p‹t_°©s
, 
mcs_rx_p‹t_°©s_di•œy
, 
NULL
);

253 
	$rvu_dbg_mcs_tx_p‹t_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

255  
	`rvu_dbg_mcs_p‹t_°©s_di•œy
(
fûp
, 
unu£d
, 
MCS_TX
);

256 
	}
}

258 
RVU_DEBUG_SEQ_FOPS
(
mcs_tx_p‹t_°©s
, 
mcs_tx_p‹t_°©s_di•œy
, 
NULL
);

260 
	$rvu_dbg_mcs_ß_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
, 
dú
)

262 
mcs
 *mc†
fûp
->
¥iv©e
;

263 
mcs_ß_°©s
 
°©s
;

264 
r§c_bm≠
 *
m≠
;

265 
ß_id
;

267 i‡(
dú
 =
MCS_TX
) {

268 
m≠
 = &
mcs
->
tx
.
ß
;

269 
	`muãx_lock
(&
mcs
->
°©s_lock
);

270 
	`f‹_óch_£t_bô
(
ß_id
, 
m≠
->
bm≠
, 
mcs
->
hw
->
ß_íåõs
) {

271 
	`£q_puts
(
fûp
, "\n TX SA stats\n");

272 
	`mcs_gë_ß_°©s
(
mcs
, &
°©s
, 
ß_id
, 
MCS_TX
);

273 
	`£q_¥ötf
(
fûp
, "ß%d: Pkt†í¸y±ed: %Œd\n", 
ß_id
,

274 
°©s
.
pkt_í¸y±_˙t
);

276 
	`£q_¥ötf
(
fûp
, "ß%d: Pkt†¥Ÿe˘ed: %Œd\n", 
ß_id
,

277 
°©s
.
pkt_¥Ÿe˘ed_˙t
);

279 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

284 
m≠
 = &
mcs
->
rx
.
ß
;

285 
	`muãx_lock
(&
mcs
->
°©s_lock
);

286 
	`f‹_óch_£t_bô
(
ß_id
, 
m≠
->
bm≠
, 
mcs
->
hw
->
ß_íåõs
) {

287 
	`£q_puts
(
fûp
, "\n RX SA stats\n");

288 
	`mcs_gë_ß_°©s
(
mcs
, &
°©s
, 
ß_id
, 
MCS_RX
);

289 
	`£q_¥ötf
(
fûp
, "ß%d: InvÆidÖkts: %Œd\n", 
ß_id
, 
°©s
.
pkt_övÆid_˙t
);

290 
	`£q_¥ötf
(
fûp
, "ß%d: Pkt†nÿßÉº‹: %Œd\n", 
ß_id
, 
°©s
.
pkt_noßîr‹_˙t
);

291 
	`£q_¥ötf
(
fûp
, "ß%d: Pkt†nŸ vÆid: %Œd\n", 
ß_id
, 
°©s
.
pkt_nŸvÆid_˙t
);

292 
	`£q_¥ötf
(
fûp
, "ß%d: Pkt†ok: %Œd\n", 
ß_id
, 
°©s
.
pkt_ok_˙t
);

293 
	`£q_¥ötf
(
fûp
, "ß%d: Pkt†nÿß: %Œd\n", 
ß_id
, 
°©s
.
pkt_noß_˙t
);

295 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

297 
	}
}

299 
	$rvu_dbg_mcs_rx_ß_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

301  
	`rvu_dbg_mcs_ß_°©s_di•œy
(
fûp
, 
unu£d
, 
MCS_RX
);

302 
	}
}

304 
RVU_DEBUG_SEQ_FOPS
(
mcs_rx_ß_°©s
, 
mcs_rx_ß_°©s_di•œy
, 
NULL
);

306 
	$rvu_dbg_mcs_tx_ß_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

308  
	`rvu_dbg_mcs_ß_°©s_di•œy
(
fûp
, 
unu£d
, 
MCS_TX
);

309 
	}
}

311 
RVU_DEBUG_SEQ_FOPS
(
mcs_tx_ß_°©s
, 
mcs_tx_ß_°©s_di•œy
, 
NULL
);

313 
	$rvu_dbg_mcs_tx_sc_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

315 
mcs
 *mc†
fûp
->
¥iv©e
;

316 
mcs_sc_°©s
 
°©s
;

317 
r§c_bm≠
 *
m≠
;

318 
sc_id
;

320 
m≠
 = &
mcs
->
tx
.
sc
;

321 
	`£q_puts
(
fûp
, "\n SC stats\n");

323 
	`muãx_lock
(&
mcs
->
°©s_lock
);

324 
	`f‹_óch_£t_bô
(
sc_id
, 
m≠
->
bm≠
, 
mcs
->
hw
->
sc_íåõs
) {

325 
	`mcs_gë_sc_°©s
(
mcs
, &
°©s
, 
sc_id
, 
MCS_TX
);

326 
	`£q_¥ötf
(
fûp
, "\n=======sc%d======\n\n", 
sc_id
);

327 
	`£q_¥ötf
(
fûp
, "sc%d: Pkt†í¸y±ed: %Œd\n", 
sc_id
, 
°©s
.
pkt_í¸y±_˙t
);

328 
	`£q_¥ötf
(
fûp
, "sc%d: Pkt†¥Ÿe˘ed: %Œd\n", 
sc_id
, 
°©s
.
pkt_¥Ÿe˘ed_˙t
);

330 i‡(
mcs
->
hw
->
mcs_blks
 == 1) {

331 
	`£q_¥ötf
(
fûp
, "sc%d: O˘ë†í¸y±ed: %Œd\n", 
sc_id
,

332 
°©s
.
o˘ë_í¸y±_˙t
);

333 
	`£q_¥ötf
(
fûp
, "sc%d: O˘ë†¥Ÿe˘ed: %Œd\n", 
sc_id
,

334 
°©s
.
o˘ë_¥Ÿe˘ed_˙t
);

337 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

339 
	}
}

341 
RVU_DEBUG_SEQ_FOPS
(
mcs_tx_sc_°©s
, 
mcs_tx_sc_°©s_di•œy
, 
NULL
);

343 
	$rvu_dbg_mcs_rx_sc_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

345 
mcs
 *mc†
fûp
->
¥iv©e
;

346 
mcs_sc_°©s
 
°©s
;

347 
r§c_bm≠
 *
m≠
;

348 
sc_id
;

350 
m≠
 = &
mcs
->
rx
.
sc
;

351 
	`£q_puts
(
fûp
, "\n SC stats\n");

353 
	`muãx_lock
(&
mcs
->
°©s_lock
);

354 
	`f‹_óch_£t_bô
(
sc_id
, 
m≠
->
bm≠
, 
mcs
->
hw
->
sc_íåõs
) {

355 
	`mcs_gë_sc_°©s
(
mcs
, &
°©s
, 
sc_id
, 
MCS_RX
);

356 
	`£q_¥ötf
(
fûp
, "\n=======sc%d======\n\n", 
sc_id
);

357 
	`£q_¥ötf
(
fûp
, "sc%d: Cam hôs: %Œd\n", 
sc_id
, 
°©s
.
hô_˙t
);

358 
	`£q_¥ötf
(
fûp
, "sc%d: InvÆidÖkts: %Œd\n", 
sc_id
, 
°©s
.
pkt_övÆid_˙t
);

359 
	`£q_¥ötf
(
fûp
, "sc%d: L©êpkts: %Œd\n", 
sc_id
, 
°©s
.
pkt_œã_˙t
);

360 
	`£q_¥ötf
(
fûp
, "sc%d: NŸvÆidÖkts: %Œd\n", 
sc_id
, 
°©s
.
pkt_nŸvÆid_˙t
);

361 
	`£q_¥ötf
(
fûp
, "sc%d: UncheckedÖkts: %Œd\n", 
sc_id
, 
°©s
.
pkt_unchecked_˙t
);

363 i‡(
mcs
->
hw
->
mcs_blks
 > 1) {

364 
	`£q_¥ötf
(
fûp
, "sc%d: DñayÖkts: %Œd\n", 
sc_id
, 
°©s
.
pkt_dñay_˙t
);

365 
	`£q_¥ötf
(
fûp
, "sc%d: Pkt†ok: %Œd\n", 
sc_id
, 
°©s
.
pkt_ok_˙t
);

367 i‡(
mcs
->
hw
->
mcs_blks
 == 1) {

368 
	`£q_¥ötf
(
fûp
, "sc%d: O˘ë†de¸y±ed: %Œd\n", 
sc_id
,

369 
°©s
.
o˘ë_de¸y±_˙t
);

370 
	`£q_¥ötf
(
fûp
, "sc%d: O˘ë†vÆid©ed: %Œd\n", 
sc_id
,

371 
°©s
.
o˘ë_vÆid©e_˙t
);

374 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

376 
	}
}

378 
RVU_DEBUG_SEQ_FOPS
(
mcs_rx_sc_°©s
, 
mcs_rx_sc_°©s_di•œy
, 
NULL
);

380 
	$rvu_dbg_mcs_Êowid_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
, 
dú
)

382 
mcs
 *mc†
fûp
->
¥iv©e
;

383 
mcs_Êowid_°©s
 
°©s
;

384 
r§c_bm≠
 *
m≠
;

385 
Êow_id
;

387 
	`£q_puts
(
fûp
, "\n Flowid stats\n");

389 i‡(
dú
 =
MCS_RX
)

390 
m≠
 = &
mcs
->
rx
.
Êow_ids
;

392 
m≠
 = &
mcs
->
tx
.
Êow_ids
;

394 
	`muãx_lock
(&
mcs
->
°©s_lock
);

395 
	`f‹_óch_£t_bô
(
Êow_id
, 
m≠
->
bm≠
, 
mcs
->
hw
->
tˇm_íåõs
) {

396 
	`mcs_gë_Êowid_°©s
(
mcs
, &
°©s
, 
Êow_id
, 
dú
);

397 
	`£q_¥ötf
(
fûp
, "Flowid%d: Hô:%Œd\n", 
Êow_id
, 
°©s
.
tˇm_hô_˙t
);

399 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

401 
	}
}

403 
	$rvu_dbg_mcs_tx_Êowid_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

405  
	`rvu_dbg_mcs_Êowid_°©s_di•œy
(
fûp
, 
unu£d
, 
MCS_TX
);

406 
	}
}

408 
RVU_DEBUG_SEQ_FOPS
(
mcs_tx_Êowid_°©s
, 
mcs_tx_Êowid_°©s_di•œy
, 
NULL
);

410 
	$rvu_dbg_mcs_rx_Êowid_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

412  
	`rvu_dbg_mcs_Êowid_°©s_di•œy
(
fûp
, 
unu£d
, 
MCS_RX
);

413 
	}
}

415 
RVU_DEBUG_SEQ_FOPS
(
mcs_rx_Êowid_°©s
, 
mcs_rx_Êowid_°©s_di•œy
, 
NULL
);

417 
	$rvu_dbg_mcs_tx_£cy_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

419 
mcs
 *mc†
fûp
->
¥iv©e
;

420 
mcs_£cy_°©s
 
°©s
;

421 
r§c_bm≠
 *
m≠
;

422 
£cy_id
;

424 
m≠
 = &
mcs
->
tx
.
£cy
;

425 
	`£q_puts
(
fûp
, "\n MCS TX secy stats\n");

427 
	`muãx_lock
(&
mcs
->
°©s_lock
);

428 
	`f‹_óch_£t_bô
(
£cy_id
, 
m≠
->
bm≠
, 
mcs
->
hw
->
£cy_íåõs
) {

429 
	`mcs_gë_tx_£cy_°©s
(
mcs
, &
°©s
, 
£cy_id
);

430 
	`£q_¥ötf
(
fûp
, "\n=======Secy%d======\n\n", 
£cy_id
);

431 
	`£q_¥ötf
(
fûp
, "£cy%d: Cå»bˇ°Ökts: %Œd\n", 
£cy_id
,

432 
°©s
.
˘l_pkt_bˇ°_˙t
);

433 
	`£q_¥ötf
(
fûp
, "£cy%d: Cå»Mˇ°Ökts: %Œd\n", 
£cy_id
,

434 
°©s
.
˘l_pkt_mˇ°_˙t
);

435 
	`£q_¥ötf
(
fûp
, "£cy%d: Cå»uˇ°Ökts: %Œd\n", 
£cy_id
,

436 
°©s
.
˘l_pkt_uˇ°_˙t
);

437 
	`£q_¥ötf
(
fûp
, "£cy%d: Cå»o˘ës: %Œd\n", 
£cy_id
, 
°©s
.
˘l_o˘ë_˙t
);

438 
	`£q_¥ötf
(
fûp
, "£cy%d: Un˘æ bˇ° c¡: %Œd\n", 
£cy_id
,

439 
°©s
.
un˘l_pkt_bˇ°_˙t
);

440 
	`£q_¥ötf
(
fûp
, "£cy%d: Un˘æ mˇ°Ökts: %Œd\n", 
£cy_id
,

441 
°©s
.
un˘l_pkt_mˇ°_˙t
);

442 
	`£q_¥ötf
(
fûp
, "£cy%d: Un˘æ uˇ°Ökts: %Œd\n", 
£cy_id
,

443 
°©s
.
un˘l_pkt_uˇ°_˙t
);

444 
	`£q_¥ötf
(
fûp
, "£cy%d: Un˘æ o˘ës: %Œd\n", 
£cy_id
, 
°©s
.
un˘l_o˘ë_˙t
);

445 
	`£q_¥ötf
(
fûp
, "£cy%d: O˘ëÉn¸y±ed: %Œd\n", 
£cy_id
,

446 
°©s
.
o˘ë_í¸y±ed_˙t
);

447 
	`£q_¥ötf
(
fûp
, "£cy%d: o˘ëÖrŸe˘ed: %Œd\n", 
£cy_id
,

448 
°©s
.
o˘ë_¥Ÿe˘ed_˙t
);

449 
	`£q_¥ötf
(
fûp
, "£cy%d: Pkt†⁄á˘ivêß: %Œd\n", 
£cy_id
,

450 
°©s
.
pkt_nﬂ˘iveß_˙t
);

451 
	`£q_¥ötf
(
fûp
, "£cy%d: Pkt†toÿl⁄g: %Œd\n", 
£cy_id
, 
°©s
.
pkt_toﬁ⁄g_˙t
);

452 
	`£q_¥ötf
(
fûp
, "£cy%d: Pkt†u¡agged: %Œd\n", 
£cy_id
, 
°©s
.
pkt_u¡agged_˙t
);

454 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

456 
	}
}

458 
RVU_DEBUG_SEQ_FOPS
(
mcs_tx_£cy_°©s
, 
mcs_tx_£cy_°©s_di•œy
, 
NULL
);

460 
	$rvu_dbg_mcs_rx_£cy_°©s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

462 
mcs
 *mc†
fûp
->
¥iv©e
;

463 
mcs_£cy_°©s
 
°©s
;

464 
r§c_bm≠
 *
m≠
;

465 
£cy_id
;

467 
m≠
 = &
mcs
->
rx
.
£cy
;

468 
	`£q_puts
(
fûp
, "\n MCS secy stats\n");

470 
	`muãx_lock
(&
mcs
->
°©s_lock
);

471 
	`f‹_óch_£t_bô
(
£cy_id
, 
m≠
->
bm≠
, 
mcs
->
hw
->
£cy_íåõs
) {

472 
	`mcs_gë_rx_£cy_°©s
(
mcs
, &
°©s
, 
£cy_id
);

473 
	`£q_¥ötf
(
fûp
, "\n=======Secy%d======\n\n", 
£cy_id
);

474 
	`£q_¥ötf
(
fûp
, "£cy%d: Cå»bˇ°Ökts: %Œd\n", 
£cy_id
,

475 
°©s
.
˘l_pkt_bˇ°_˙t
);

476 
	`£q_¥ötf
(
fûp
, "£cy%d: Cå»Mˇ°Ökts: %Œd\n", 
£cy_id
,

477 
°©s
.
˘l_pkt_mˇ°_˙t
);

478 
	`£q_¥ötf
(
fûp
, "£cy%d: Cå»uˇ°Ökts: %Œd\n", 
£cy_id
,

479 
°©s
.
˘l_pkt_uˇ°_˙t
);

480 
	`£q_¥ötf
(
fûp
, "£cy%d: Cå»o˘ës: %Œd\n", 
£cy_id
, 
°©s
.
˘l_o˘ë_˙t
);

481 
	`£q_¥ötf
(
fûp
, "£cy%d: Un˘æ bˇ° c¡: %Œd\n", 
£cy_id
,

482 
°©s
.
un˘l_pkt_bˇ°_˙t
);

483 
	`£q_¥ötf
(
fûp
, "£cy%d: Un˘æ mˇ°Ökts: %Œd\n", 
£cy_id
,

484 
°©s
.
un˘l_pkt_mˇ°_˙t
);

485 
	`£q_¥ötf
(
fûp
, "£cy%d: Un˘æ uˇ°Ökts: %Œd\n", 
£cy_id
,

486 
°©s
.
un˘l_pkt_uˇ°_˙t
);

487 
	`£q_¥ötf
(
fûp
, "£cy%d: Un˘æ o˘ës: %Œd\n", 
£cy_id
, 
°©s
.
un˘l_o˘ë_˙t
);

488 
	`£q_¥ötf
(
fûp
, "£cy%d: O˘ë de¸y±ed: %Œd\n", 
£cy_id
,

489 
°©s
.
o˘ë_de¸y±ed_˙t
);

490 
	`£q_¥ötf
(
fûp
, "£cy%d: o˘ë vÆid©ed: %Œd\n", 
£cy_id
,

491 
°©s
.
o˘ë_vÆid©ed_˙t
);

492 
	`£q_¥ötf
(
fûp
, "£cy%d: Pkt†⁄ dißbÀÖ‹t: %Œd\n", 
£cy_id
,

493 
°©s
.
pkt_p‹t_dißbÀd_˙t
);

494 
	`£q_¥ötf
(
fûp
, "£cy%d: O˘ë†vÆid©ed: %Œd\n", 
£cy_id
, 
°©s
.
pkt_badèg_˙t
);

495 
	`£q_¥ötf
(
fûp
, "£cy%d: O˘ë†vÆid©ed: %Œd\n", 
£cy_id
, 
°©s
.
pkt_noß_˙t
);

496 
	`£q_¥ötf
(
fûp
, "£cy%d: Pkt†wôhÇoßîr‹: %Œd\n", 
£cy_id
,

497 
°©s
.
pkt_noßîr‹_˙t
);

498 
	`£q_¥ötf
(
fûp
, "£cy%d: Tagged cå»pkts: %Œd\n", 
£cy_id
,

499 
°©s
.
pkt_ègged_˘l_˙t
);

500 
	`£q_¥ötf
(
fûp
, "£cy%d: U¡agedÖkts: %Œd\n", 
£cy_id
, 
°©s
.
pkt_u¡aged_˙t
);

501 
	`£q_¥ötf
(
fûp
, "£cy%d: Cå»pkts: %Œd\n", 
£cy_id
, 
°©s
.
pkt_˘l_˙t
);

502 i‡(
mcs
->
hw
->
mcs_blks
 > 1)

503 
	`£q_¥ötf
(
fûp
, "£cy%d:Ökt†nŸag: %Œd\n", 
£cy_id
,

504 
°©s
.
pkt_nŸag_˙t
);

506 
	`muãx_u∆ock
(&
mcs
->
°©s_lock
);

508 
	}
}

510 
RVU_DEBUG_SEQ_FOPS
(
mcs_rx_£cy_°©s
, 
mcs_rx_£cy_°©s_di•œy
, 
NULL
);

512 
	$rvu_dbg_mcs_öô
(
rvu
 *rvu)

514 
mcs
 *mcs;

515 
d«me
[10];

516 
i
;

518 i‡(!
rvu
->
mcs_blk_˙t
)

521 
rvu
->
rvu_dbg
.
mcs_roŸ
 = 
	`debugfs_¸óã_dú
("mcs",Ñvu->rvu_dbg.
roŸ
);

523 
i
 = 0; i < 
rvu
->
mcs_blk_˙t
; i++) {

524 
mcs
 = 
	`mcs_gë_pd©a
(
i
);

526 
	`•rötf
(
d«me
, "mcs%d", 
i
);

527 
rvu
->
rvu_dbg
.
mcs
 = 
	`debugfs_¸óã_dú
(
d«me
,

528 
rvu
->
rvu_dbg
.
mcs_roŸ
);

530 
rvu
->
rvu_dbg
.
mcs_rx
 = 
	`debugfs_¸óã_dú
("rx_°©s",Ñvu->rvu_dbg.
mcs
);

532 
	`debugfs_¸óã_fûe
("Êowid", 0600, 
rvu
->
rvu_dbg
.
mcs_rx
, 
mcs
,

533 &
rvu_dbg_mcs_rx_Êowid_°©s_f›s
);

535 
	`debugfs_¸óã_fûe
("£cy", 0600, 
rvu
->
rvu_dbg
.
mcs_rx
, 
mcs
,

536 &
rvu_dbg_mcs_rx_£cy_°©s_f›s
);

538 
	`debugfs_¸óã_fûe
("sc", 0600, 
rvu
->
rvu_dbg
.
mcs_rx
, 
mcs
,

539 &
rvu_dbg_mcs_rx_sc_°©s_f›s
);

541 
	`debugfs_¸óã_fûe
("ß", 0600, 
rvu
->
rvu_dbg
.
mcs_rx
, 
mcs
,

542 &
rvu_dbg_mcs_rx_ß_°©s_f›s
);

544 
	`debugfs_¸óã_fûe
("p‹t", 0600, 
rvu
->
rvu_dbg
.
mcs_rx
, 
mcs
,

545 &
rvu_dbg_mcs_rx_p‹t_°©s_f›s
);

547 
rvu
->
rvu_dbg
.
mcs_tx
 = 
	`debugfs_¸óã_dú
("tx_°©s",Ñvu->rvu_dbg.
mcs
);

549 
	`debugfs_¸óã_fûe
("Êowid", 0600, 
rvu
->
rvu_dbg
.
mcs_tx
, 
mcs
,

550 &
rvu_dbg_mcs_tx_Êowid_°©s_f›s
);

552 
	`debugfs_¸óã_fûe
("£cy", 0600, 
rvu
->
rvu_dbg
.
mcs_tx
, 
mcs
,

553 &
rvu_dbg_mcs_tx_£cy_°©s_f›s
);

555 
	`debugfs_¸óã_fûe
("sc", 0600, 
rvu
->
rvu_dbg
.
mcs_tx
, 
mcs
,

556 &
rvu_dbg_mcs_tx_sc_°©s_f›s
);

558 
	`debugfs_¸óã_fûe
("ß", 0600, 
rvu
->
rvu_dbg
.
mcs_tx
, 
mcs
,

559 &
rvu_dbg_mcs_tx_ß_°©s_f›s
);

561 
	`debugfs_¸óã_fûe
("p‹t", 0600, 
rvu
->
rvu_dbg
.
mcs_tx
, 
mcs
,

562 &
rvu_dbg_mcs_tx_p‹t_°©s_f›s
);

564 
	}
}

566 
	#LMT_MAPTBL_ENTRY_SIZE
 16

	)

568 
ssize_t
 
	$rvu_dbg_lmt°_m≠_èbÀ_di•œy
(
fûe
 *
fûp
,

569 
__u£r
 *
buf„r
,

570 
size_t
 
cou¡
, 
loff_t
 *
µos
)

572 
rvu
 *rvu = 
fûp
->
¥iv©e_d©a
;

573 
u64
 
lmt_addr
, 
vÆ
, 
tbl_ba£
;

574 
pf
, 
vf
, 
num_vfs
, 
hw_vfs
;

575 
__iomem
 *
lmt_m≠_ba£
;

576 
ödex
 = 0, 
off
 = 0;

577 
byãs_nŸ_c›õd
;

578 
buf_size
 = 10240;

579 *
buf
;

582 i‡(*
µos
 != 0)

585 
buf
 = 
	`kzÆloc
(
buf_size
, 
GFP_KERNEL
);

586 i‡(!
buf
)

587  -
ENOSPC
;

589 
tbl_ba£
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_APR
, 
APR_AF_LMT_MAP_BASE
);

591 
lmt_m≠_ba£
 = 
	`i‹em≠_wc
(
tbl_ba£
, 128 * 1024);

592 i‡(!
lmt_m≠_ba£
) {

593 
	`dev_îr
(
rvu
->
dev
, "FailedÅo setupÜmt mapÅable mapping!!\n");

594 
	`k‰ì
(
buf
);

595  
Ál£
;

598 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

600 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

602 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off, "\nPcifunc\t\t\t");

603 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off, "Table Index\t\t");

604 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

606 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

608 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off, "\n");

609 
pf
 = 0;Ö‡< 
rvu
->
hw
->
tŸÆ_pfs
;Öf++) {

610 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off, "PF%d \t\t\t",

611 
pf
);

613 
ödex
 = 
pf
 * 
rvu
->
hw
->
tŸÆ_vfs
 * 
LMT_MAPTBL_ENTRY_SIZE
;

614 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off, " 0x%llx\t\t",

615 (
tbl_ba£
 + 
ödex
));

616 
lmt_addr
 = 
	`ªadq
(
lmt_m≠_ba£
 + 
ödex
);

617 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

618 " 0x%016Œx\t\t", 
lmt_addr
);

619 
ödex
 += 8;

620 
vÆ
 = 
	`ªadq
(
lmt_m≠_ba£
 + 
ödex
);

621 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off, " 0x%016llx\n",

622 
vÆ
);

624 
	`rvu_gë_pf_numvfs
(
rvu
, 
pf
, &
num_vfs
, &
hw_vfs
);

625 
vf
 = 0; v‡< 
num_vfs
; vf++) {

626 
ödex
 = (
pf
 * 
rvu
->
hw
->
tŸÆ_vfs
 * 16) +

627 ((
vf
 + 1Ë* 
LMT_MAPTBL_ENTRY_SIZE
);

628 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

629 "PF%d:VF%d \t\t", 
pf
, 
vf
);

630 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

631 " 0x%Œx\t\t", (
tbl_ba£
 + 
ödex
));

632 
lmt_addr
 = 
	`ªadq
(
lmt_m≠_ba£
 + 
ödex
);

633 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

634 " 0x%016Œx\t\t", 
lmt_addr
);

635 
ödex
 += 8;

636 
vÆ
 = 
	`ªadq
(
lmt_m≠_ba£
 + 
ödex
);

637 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

638 " 0x%016Œx\n", 
vÆ
);

641 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off, "\n");

643 
byãs_nŸ_c›õd
 = 
	`c›y_to_u£r
(
buf„r
, 
buf
, 
off
);

644 
	`k‰ì
(
buf
);

646 
	`iounm≠
(
lmt_m≠_ba£
);

647 i‡(
byãs_nŸ_c›õd
)

648  -
EFAULT
;

650 *
µos
 = 
off
;

651  
off
;

652 
	}
}

654 
RVU_DEBUG_FOPS
(
lmt°_m≠_èbÀ
, 
lmt°_m≠_èbÀ_di•œy
, 
NULL
);

656 
	$gë_lf_°r_li°
(
rvu_block
 
block
, 
pcifunc
,

657 *
lfs
)

659 
lf
 = 0, 
£q
 = 0, 
Àn
 = 0, 
¥ev_lf
 = 
block
.lf.
max
;

661 
	`f‹_óch_£t_bô
(
lf
, 
block
.lf.
bm≠
, block.lf.
max
) {

662 i‡(
lf
 >
block
.lf.
max
)

665 i‡(
block
.
‚_m≠
[
lf
] !
pcifunc
)

668 i‡(
lf
 =
¥ev_lf
 + 1) {

669 
¥ev_lf
 = 
lf
;

670 
£q
 = 1;

674 i‡(
£q
)

675 
Àn
 +
	`•rötf
(
lfs
 +Üí, "-%d,%d", 
¥ev_lf
, 
lf
);

677 
Àn
 +÷í ? 
	`•rötf
(
lfs
 +Üí, ",%d", 
lf
) :

678 
	`•rötf
(
lfs
 + 
Àn
, "%d", 
lf
));

680 
¥ev_lf
 = 
lf
;

681 
£q
 = 0;

684 i‡(
£q
)

685 
Àn
 +
	`•rötf
(
lfs
 +Üí, "-%d", 
¥ev_lf
);

687 
lfs
[
Àn
] = '\0';

688 
	}
}

690 
	$gë_max_cﬁumn_width
(
rvu
 *rvu)

692 
ödex
, 
pf
, 
vf
, 
lf_°r_size
 = 12, 
buf_size
 = 256;

693 
rvu_block
 
block
;

694 
u16
 
pcifunc
;

695 *
buf
;

697 
buf
 = 
	`kzÆloc
(
buf_size
, 
GFP_KERNEL
);

698 i‡(!
buf
)

699  -
ENOMEM
;

701 
pf
 = 0;Ö‡< 
rvu
->
hw
->
tŸÆ_pfs
;Öf++) {

702 
vf
 = 0; v‡<
rvu
->
hw
->
tŸÆ_vfs
; vf++) {

703 
pcifunc
 = 
pf
 << 10 | 
vf
;

704 i‡(!
pcifunc
)

707 
ödex
 = 0; index < 
BLK_COUNT
; index++) {

708 
block
 = 
rvu
->
hw
->block[
ödex
];

709 i‡(!
	`°æí
(
block
.
«me
))

712 
	`gë_lf_°r_li°
(
block
, 
pcifunc
, 
buf
);

713 i‡(
lf_°r_size
 <
	`°æí
(
buf
))

714 
lf_°r_size
 = 
	`°æí
(
buf
) + 1;

719 
	`k‰ì
(
buf
);

720  
lf_°r_size
;

721 
	}
}

724 
ssize_t
 
	$rvu_dbg_r§c_©èch_°©us
(
fûe
 *
fûp
,

725 
__u£r
 *
buf„r
,

726 
size_t
 
cou¡
, 
loff_t
 *
µos
)

728 
ödex
, 
off
 = 0, 
Êag
 = 0, 
Àn
 = 0, 
i
 = 0;

729 
rvu
 *rvu = 
fûp
->
¥iv©e_d©a
;

730 
byãs_nŸ_c›õd
 = 0;

731 
rvu_block
 
block
;

732 
pf
, 
vf
, 
pcifunc
;

733 
buf_size
 = 2048;

734 
lf_°r_size
;

735 *
lfs
;

736 *
buf
;

739 i‡(*
µos
 != 0)

742 
buf
 = 
	`kzÆloc
(
buf_size
, 
GFP_KERNEL
);

743 i‡(!
buf
)

744  -
ENOSPC
;

747 
lf_°r_size
 = 
	`gë_max_cﬁumn_width
(
rvu
);

749 
lfs
 = 
	`kzÆloc
(
lf_°r_size
, 
GFP_KERNEL
);

750 i‡(!
lfs
) {

751 
	`k‰ì
(
buf
);

752  -
ENOMEM
;

754 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off, "%-*s", 
lf_°r_size
,

756 
ödex
 = 0; index < 
BLK_COUNT
; index++)

757 i‡(
	`°æí
(
rvu
->
hw
->
block
[
ödex
].
«me
)) {

758 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

759 "%-*s", 
lf_°r_size
,

760 
rvu
->
hw
->
block
[
ödex
].
«me
);

763 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off, "\n");

764 
byãs_nŸ_c›õd
 = 
	`c›y_to_u£r
(
buf„r
 + (
i
 * 
off
), 
buf
, off);

765 i‡(
byãs_nŸ_c›õd
)

766 
out
;

768 
i
++;

769 *
µos
 +
off
;

770 
pf
 = 0;Ö‡< 
rvu
->
hw
->
tŸÆ_pfs
;Öf++) {

771 
vf
 = 0; v‡<
rvu
->
hw
->
tŸÆ_vfs
; vf++) {

772 
off
 = 0;

773 
Êag
 = 0;

774 
pcifunc
 = 
pf
 << 10 | 
vf
;

775 i‡(!
pcifunc
)

778 i‡(
vf
) {

779 
	`•rötf
(
lfs
, "PF%d:VF%d", 
pf
, 
vf
 - 1);

780 
off
 = 
	`s˙¥ötf
(&
buf
[off],

781 
buf_size
 - 1 - 
off
,

782 "%-*s", 
lf_°r_size
, 
lfs
);

784 
	`•rötf
(
lfs
, "PF%d", 
pf
);

785 
off
 = 
	`s˙¥ötf
(&
buf
[off],

786 
buf_size
 - 1 - 
off
,

787 "%-*s", 
lf_°r_size
, 
lfs
);

790 
ödex
 = 0; index < 
BLK_COUNT
; index++) {

791 
block
 = 
rvu
->
hw
->block[
ödex
];

792 i‡(!
	`°æí
(
block
.
«me
))

794 
Àn
 = 0;

795 
lfs
[
Àn
] = '\0';

796 
	`gë_lf_°r_li°
(
block
, 
pcifunc
, 
lfs
);

797 i‡(
	`°æí
(
lfs
))

798 
Êag
 = 1;

800 
off
 +
	`s˙¥ötf
(&
buf
[off], 
buf_size
 - 1 - off,

801 "%-*s", 
lf_°r_size
, 
lfs
);

803 i‡(
Êag
) {

804 
off
 +
	`s˙¥ötf
(&
buf
[off],

805 
buf_size
 - 1 - 
off
, "\n");

806 
byãs_nŸ_c›õd
 = 
	`c›y_to_u£r
(
buf„r
 +

807 (
i
 * 
off
),

808 
buf
, 
off
);

809 i‡(
byãs_nŸ_c›õd
)

810 
out
;

812 
i
++;

813 *
µos
 +
off
;

818 
out
:

819 
	`k‰ì
(
lfs
);

820 
	`k‰ì
(
buf
);

821 i‡(
byãs_nŸ_c›õd
)

822  -
EFAULT
;

824  *
µos
;

825 
	}
}

827 
RVU_DEBUG_FOPS
(
r§c_°©us
, 
r§c_©èch_°©us
, 
NULL
);

829 
	$rvu_dbg_rvu_pf_cgx_m≠_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

831 
rvu
 *rvu = 
fûp
->
¥iv©e
;

832 
pci_dev
 *
pdev
 = 
NULL
;

833 
mac_›s
 *mac_ops;

834 
cgx
[10], 
lmac
[10];

835 
rvu_pfvf
 *
pfvf
;

836 
pf
, 
domaö
, 
blkid
;

837 
u8
 
cgx_id
, 
lmac_id
;

838 
u16
 
pcifunc
;

840 
domaö
 = 2;

841 
mac_›s
 = 
	`gë_mac_›s
(
	`rvu_fú°_cgx_pd©a
(
rvu
));

843 i‡(!
mac_›s
)

845 
	`£q_¥ötf
(
fûp
, "PCI dev\t\tRVU PF Func\tNIX block\t%s\tLMAC\n",

846 
mac_›s
->
«me
);

847 
pf
 = 0;Ö‡< 
rvu
->
hw
->
tŸÆ_pfs
;Öf++) {

848 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

851 
pdev
 = 
	`pci_gë_domaö_bus_™d_¶Ÿ
(
domaö
, 
pf
 + 1, 0);

852 i‡(!
pdev
)

855 
cgx
[0] = 0;

856 
lmac
[0] = 0;

857 
pcifunc
 = 
pf
 << 10;

858 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

860 i‡(
pfvf
->
nix_blkaddr
 =
BLKADDR_NIX0
)

861 
blkid
 = 0;

863 
blkid
 = 1;

865 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
,

866 &
lmac_id
);

867 
	`•rötf
(
cgx
, "%s%d", 
mac_›s
->
«me
, 
cgx_id
);

868 
	`•rötf
(
lmac
, "LMAC%d", 
lmac_id
);

869 
	`£q_¥ötf
(
fûp
, "%s\t0x%x\t\tNIX%d\t\t%s\t%s\n",

870 
	`dev_«me
(&
pdev
->
dev
), 
pcifunc
, 
blkid
, 
cgx
, 
lmac
);

873 
	}
}

875 
RVU_DEBUG_SEQ_FOPS
(
rvu_pf_cgx_m≠
, 
rvu_pf_cgx_m≠_di•œy
, 
NULL
);

877 
boﬁ
 
	$rvu_dbg_is_vÆid_lf
(
rvu
 *rvu, 
blkaddr
, 
lf
,

878 
u16
 *
pcifunc
)

880 
rvu_block
 *
block
;

881 
rvu_hwöfo
 *
hw
;

883 
hw
 = 
rvu
->hw;

884 
block
 = &
hw
->block[
blkaddr
];

886 i‡(
lf
 < 0 ||Ü‡>
block
->lf.
max
) {

887 
	`dev_w¨n
(
rvu
->
dev
, "Invalid LF: validÑange: 0-%d\n",

888 
block
->
lf
.
max
 - 1);

889  
Ál£
;

892 *
pcifunc
 = 
block
->
‚_m≠
[
lf
];

893 i‡(!*
pcifunc
) {

894 
	`dev_w¨n
(
rvu
->
dev
,

896  
Ál£
;

898  
åue
;

899 
	}
}

901 
	$¥öt_≈a_qsize
(
£q_fûe
 *
m
, 
rvu_pfvf
 *
pfvf
)

903 *
buf
;

905 
buf
 = 
	`kmÆloc
(
PAGE_SIZE
, 
GFP_KERNEL
);

906 i‡(!
buf
)

909 i‡(!
pfvf
->
auø_˘x
) {

910 
	`£q_puts
(
m
, "Aura context isÇot initialized\n");

912 
	`bôm≠_¥öt_to_∑gebuf
(
Ál£
, 
buf
, 
pfvf
->
auø_bm≠
,

913 
pfvf
->
auø_˘x
->
qsize
);

914 
	`£q_¥ötf
(
m
, "Auø cou¡ : %d\n", 
pfvf
->
auø_˘x
->
qsize
);

915 
	`£q_¥ötf
(
m
, "Auø c⁄ãxàía/di†bôm≠ : %s\n", 
buf
);

918 i‡(!
pfvf
->
poﬁ_˘x
) {

919 
	`£q_puts
(
m
, "Pool context isÇot initialized\n");

921 
	`bôm≠_¥öt_to_∑gebuf
(
Ál£
, 
buf
, 
pfvf
->
poﬁ_bm≠
,

922 
pfvf
->
poﬁ_˘x
->
qsize
);

923 
	`£q_¥ötf
(
m
, "Poﬁ cou¡ : %d\n", 
pfvf
->
poﬁ_˘x
->
qsize
);

924 
	`£q_¥ötf
(
m
, "Poﬁ c⁄ãxàía/di†bôm≠ : %s\n", 
buf
);

926 
	`k‰ì
(
buf
);

927 
	}
}

932 
	$rvu_dbg_qsize_di•œy
(
£q_fûe
 *
fûp
, *
unsu£d
,

933 
blkty≥
)

935 (*
¥öt_qsize
)(
£q_fûe
 *
fûp
,

936 
rvu_pfvf
 *
pfvf
Ë
NULL
;

937 
díåy
 *
cuºít_dú
;

938 
rvu_pfvf
 *
pfvf
;

939 
rvu
 *rvu;

940 
qsize_id
;

941 
u16
 
pcifunc
;

942 
blkaddr
;

944 
rvu
 = 
fûp
->
¥iv©e
;

945 
blkty≥
) {

946 
BLKTYPE_NPA
:

947 
qsize_id
 = 
rvu
->
rvu_dbg
.
≈a_qsize_id
;

948 
¥öt_qsize
 = 
¥öt_≈a_qsize
;

951 
BLKTYPE_NIX
:

952 
qsize_id
 = 
rvu
->
rvu_dbg
.
nix_qsize_id
;

953 
¥öt_qsize
 = 
¥öt_nix_qsize
;

957  -
EINVAL
;

960 i‡(
blkty≥
 =
BLKTYPE_NPA
) {

961 
blkaddr
 = 
BLKADDR_NPA
;

963 
cuºít_dú
 = 
fûp
->
fûe
->
f_∑th
.
díåy
->
d_∑ª¡
;

964 
blkaddr
 = (!
	`°rcmp
(
cuºít_dú
->
d_«me
.
«me
, "nix1") ?

965 
BLKADDR_NIX1
 : 
BLKADDR_NIX0
);

968 i‡(!
	`rvu_dbg_is_vÆid_lf
(
rvu
, 
blkaddr
, 
qsize_id
, &
pcifunc
))

969  -
EINVAL
;

971 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

972 
	`¥öt_qsize
(
fûp
, 
pfvf
);

975 
	}
}

977 
ssize_t
 
	$rvu_dbg_qsize_wrôe
(
fûe
 *
fûp
,

978 c⁄° 
__u£r
 *
buf„r
, 
size_t
 
cou¡
,

979 
loff_t
 *
µos
, 
blkty≥
)

981 *
blk_°rög
 = (
blkty≥
 =
BLKTYPE_NPA
) ? "npa" : "nix";

982 
£q_fûe
 *
£qfûe
 = 
fûp
->
¥iv©e_d©a
;

983 *
cmd_buf
, *
cmd_buf_tmp
, *
subtokí
;

984 
rvu
 *rvu = 
£qfûe
->
¥iv©e
;

985 
díåy
 *
cuºít_dú
;

986 
blkaddr
;

987 
u16
 
pcifunc
;

988 
ªt
, 
lf
;

990 
cmd_buf
 = 
	`memdup_u£r
(
buf„r
, 
cou¡
 + 1);

991 i‡(
	`IS_ERR
(
cmd_buf
))

992  -
ENOMEM
;

994 
cmd_buf
[
cou¡
] = '\0';

996 
cmd_buf_tmp
 = 
	`°rchr
(
cmd_buf
, '\n');

997 i‡(
cmd_buf_tmp
) {

998 *
cmd_buf_tmp
 = '\0';

999 
cou¡
 = 
cmd_buf_tmp
 - 
cmd_buf
 + 1;

1002 
cmd_buf_tmp
 = 
cmd_buf
;

1003 
subtokí
 = 
	`°r£p
(&
cmd_buf
, " ");

1004 
ªt
 = 
subtokí
 ? 
	`k°πoöt
(subtokí, 10, &
lf
Ë: -
EINVAL
;

1005 i‡(
cmd_buf
)

1006 
ªt
 = -
EINVAL
;

1008 i‡(
ªt
 < 0 || !
	`°∫cmp
(
subtokí
, "help", 4)) {

1009 
	`dev_öfo
(
rvu
->
dev
, "U£Échÿ<%s-l‡> qsize\n", 
blk_°rög
);

1010 
qsize_wrôe_d⁄e
;

1013 i‡(
blkty≥
 =
BLKTYPE_NPA
) {

1014 
blkaddr
 = 
BLKADDR_NPA
;

1016 
cuºít_dú
 = 
fûp
->
f_∑th
.
díåy
->
d_∑ª¡
;

1017 
blkaddr
 = (!
	`°rcmp
(
cuºít_dú
->
d_«me
.
«me
, "nix1") ?

1018 
BLKADDR_NIX1
 : 
BLKADDR_NIX0
);

1021 i‡(!
	`rvu_dbg_is_vÆid_lf
(
rvu
, 
blkaddr
, 
lf
, &
pcifunc
)) {

1022 
ªt
 = -
EINVAL
;

1023 
qsize_wrôe_d⁄e
;

1025 i‡(
blkty≥
 =
BLKTYPE_NPA
)

1026 
rvu
->
rvu_dbg
.
≈a_qsize_id
 = 
lf
;

1028 
rvu
->
rvu_dbg
.
nix_qsize_id
 = 
lf
;

1030 
qsize_wrôe_d⁄e
:

1031 
	`k‰ì
(
cmd_buf_tmp
);

1032  
ªt
 ?Ñë : 
cou¡
;

1033 
	}
}

1035 
ssize_t
 
	$rvu_dbg_≈a_qsize_wrôe
(
fûe
 *
fûp
,

1036 c⁄° 
__u£r
 *
buf„r
,

1037 
size_t
 
cou¡
, 
loff_t
 *
µos
)

1039  
	`rvu_dbg_qsize_wrôe
(
fûp
, 
buf„r
, 
cou¡
, 
µos
,

1040 
BLKTYPE_NPA
);

1041 
	}
}

1043 
	$rvu_dbg_≈a_qsize_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

1045  
	`rvu_dbg_qsize_di•œy
(
fûp
, 
unu£d
, 
BLKTYPE_NPA
);

1046 
	}
}

1048 
RVU_DEBUG_SEQ_FOPS
(
≈a_qsize
, 
≈a_qsize_di•œy
, 
≈a_qsize_wrôe
);

1051 
	$¥öt_≈a_auø_˘x
(
£q_fûe
 *
m
, 
≈a_aq_íq_r•
 *
r•
)

1053 
≈a_auø_s
 *
auø
 = &
r•
->aura;

1054 
rvu
 *rvu = 
m
->
¥iv©e
;

1056 
	`£q_¥ötf
(
m
, "W0: Poﬁáddr\t\t%Œx\n", 
auø
->
poﬁ_addr
);

1058 
	`£q_¥ötf
(
m
, "W1:Éna\t\t\t%d\nW1:Öool caching\t%d\n",

1059 
auø
->
ía
,áuø->
poﬁ_ˇchög
);

1060 
	`£q_¥ötf
(
m
, "W1:Öool way mask\t%d\nW1:ávg con\t\t%d\n",

1061 
auø
->
poﬁ_way_mask
,áuø->
avg_c⁄
);

1062 
	`£q_¥ötf
(
m
, "W1:Öool dropÉna\t%d\nW1:áura dropÉna\t%d\n",

1063 
auø
->
poﬁ_dr›_ía
,áuø->
auø_dr›_ía
);

1064 
	`£q_¥ötf
(
m
, "W1: bp_ena\t\t%d\nW1:áura drop\t\t%d\n",

1065 
auø
->
bp_ía
,áuø->
auø_dr›
);

1066 
	`£q_¥ötf
(
m
, "W1:áura shift\t\t%d\nW1:ávg_level\t\t%d\n",

1067 
auø
->
shi·
,áuø->
avg_Àvñ
);

1069 
	`£q_¥ötf
(
m
, "W2: count\t\t%llu\nW2:Çix0_bpid\t\t%d\nW2:Çix1_bpid\t\t%d\n",

1070 (
u64
)
auø
->
cou¡
,áuø->
nix0_bpid
,áuø->
nix1_bpid
);

1072 
	`£q_¥ötf
(
m
, "W3:Üimit\t\t%llu\nW3: bp\t\t\t%d\nW3: fc_ena\t\t%d\n",

1073 (
u64
)
auø
->
limô
,áuø->
bp
,áuø->
fc_ía
);

1075 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

1076 
	`£q_¥ötf
(
m
, "W3: fc_be\t\t%d\n", 
auø
->
fc_be
);

1077 
	`£q_¥ötf
(
m
, "W3: fc_up_crossing\t%d\nW3: fc_stype\t\t%d\n",

1078 
auø
->
fc_up_¸ossög
,áuø->
fc_°y≥
);

1079 
	`£q_¥ötf
(
m
, "W3: fc_hy°_bôs\t%d\n", 
auø
->
fc_hy°_bôs
);

1081 
	`£q_¥ötf
(
m
, "W4: fc_addr\t\t%Œx\n", 
auø
->
fc_addr
);

1083 
	`£q_¥ötf
(
m
, "W5:Öool_drop\t\t%d\nW5: update_time\t\t%d\n",

1084 
auø
->
poﬁ_dr›
,áuø->
upd©e_time
);

1085 
	`£q_¥ötf
(
m
, "W5:Érr_int \t\t%d\nW5:Érr_int_ena\t\t%d\n",

1086 
auø
->
îr_öt
,áuø->
îr_öt_ía
);

1087 
	`£q_¥ötf
(
m
, "W5:Åhresh_int\t\t%d\nW5:Åhresh_int_ena \t%d\n",

1088 
auø
->
thªsh_öt
,áuø->
thªsh_öt_ía
);

1089 
	`£q_¥ötf
(
m
, "W5:Åhresh_up\t\t%d\nW5:Åhresh_qint_idx\t%d\n",

1090 
auø
->
thªsh_up
,áuø->
thªsh_qöt_idx
);

1091 
	`£q_¥ötf
(
m
, "W5:Éº_qöt_idx \t%d\n", 
auø
->
îr_qöt_idx
);

1093 
	`£q_¥ötf
(
m
, "W6:Åhªsh\t\t%Œu\n", (
u64
)
auø
->
thªsh
);

1094 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

1095 
	`£q_¥ötf
(
m
, "W6: fc_msh_d°\t\t%d\n", 
auø
->
fc_msh_d°
);

1096 
	}
}

1099 
	$¥öt_≈a_poﬁ_˘x
(
£q_fûe
 *
m
, 
≈a_aq_íq_r•
 *
r•
)

1101 
≈a_poﬁ_s
 *
poﬁ
 = &
r•
->pool;

1102 
rvu
 *rvu = 
m
->
¥iv©e
;

1104 
	`£q_¥ötf
(
m
, "W0: Sèck ba£\t\t%Œx\n", 
poﬁ
->
°ack_ba£
);

1106 
	`£q_¥ötf
(
m
, "W1:Éna \t\t%d\nW1:Çat_align \t\t%d\n",

1107 
poﬁ
->
ía
,Öoﬁ->
«t_Æign
);

1108 
	`£q_¥ötf
(
m
, "W1: stack_caching\t%d\nW1: stack_way_mask\t%d\n",

1109 
poﬁ
->
°ack_ˇchög
,Öoﬁ->
°ack_way_mask
);

1110 
	`£q_¥ötf
(
m
, "W1: buf_offset\t\t%d\nW1: buf_size\t\t%d\n",

1111 
poﬁ
->
buf_off£t
,Öoﬁ->
buf_size
);

1113 
	`£q_¥ötf
(
m
, "W2: stack_max_pages \t%d\nW2: stack_pages\t\t%d\n",

1114 
poﬁ
->
°ack_max_∑ges
,Öoﬁ->
°ack_∑ges
);

1116 
	`£q_¥ötf
(
m
, "W3: op_p¯\t\t%Œu\n", (
u64
)
poﬁ
->
›_pc
);

1118 
	`£q_¥ötf
(
m
, "W4: stack_offset\t%d\nW4: shift\t\t%d\nW4:ávg_level\t\t%d\n",

1119 
poﬁ
->
°ack_off£t
,Öoﬁ->
shi·
,Öoﬁ->
avg_Àvñ
);

1120 
	`£q_¥ötf
(
m
, "W4:ávg_con \t\t%d\nW4: fc_ena\t\t%d\nW4: fc_stype\t\t%d\n",

1121 
poﬁ
->
avg_c⁄
,Öoﬁ->
fc_ía
,Öoﬁ->
fc_°y≥
);

1122 
	`£q_¥ötf
(
m
, "W4: fc_hyst_bits\t%d\nW4: fc_up_crossing\t%d\n",

1123 
poﬁ
->
fc_hy°_bôs
,Öoﬁ->
fc_up_¸ossög
);

1124 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

1125 
	`£q_¥ötf
(
m
, "W4: fc_be\t\t%d\n", 
poﬁ
->
fc_be
);

1126 
	`£q_¥ötf
(
m
, "W4: upd©e_time\t\t%d\n", 
poﬁ
->
upd©e_time
);

1128 
	`£q_¥ötf
(
m
, "W5: fc_addr\t\t%Œx\n", 
poﬁ
->
fc_addr
);

1130 
	`£q_¥ötf
(
m
, "W6:Öå_°¨t\t\t%Œx\n", 
poﬁ
->
±r_°¨t
);

1132 
	`£q_¥ötf
(
m
, "W7:Öå_íd\t\t%Œx\n", 
poﬁ
->
±r_íd
);

1134 
	`£q_¥ötf
(
m
, "W8:Érr_int\t\t%d\nW8:Érr_int_ena\t\t%d\n",

1135 
poﬁ
->
îr_öt
,Öoﬁ->
îr_öt_ía
);

1136 
	`£q_¥ötf
(
m
, "W8:Åhªsh_öt\t\t%d\n", 
poﬁ
->
thªsh_öt
);

1137 
	`£q_¥ötf
(
m
, "W8:Åhresh_int_ena\t%d\nW8:Åhresh_up\t\t%d\n",

1138 
poﬁ
->
thªsh_öt_ía
,Öoﬁ->
thªsh_up
);

1139 
	`£q_¥ötf
(
m
, "W8:Åhresh_qint_idx\t%d\nW8:Érr_qint_idx\t%d\n",

1140 
poﬁ
->
thªsh_qöt_idx
,Öoﬁ->
îr_qöt_idx
);

1141 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

1142 
	`£q_¥ötf
(
m
, "W8: fc_msh_d°\t\t%d\n", 
poﬁ
->
fc_msh_d°
);

1143 
	}
}

1146 
	$rvu_dbg_≈a_˘x_di•œy
(
£q_fûe
 *
m
, *
unu£d
, 
˘y≥
)

1148 (*
¥öt_≈a_˘x
)(
£q_fûe
 *
m
, 
≈a_aq_íq_r•
 *
r•
);

1149 
≈a_aq_íq_ªq
 
aq_ªq
;

1150 
≈a_aq_íq_r•
 
r•
;

1151 
rvu_pfvf
 *
pfvf
;

1152 
auø
, 
rc
, 
max_id
;

1153 
≈Æf
, 
id
, 
Æl
;

1154 
rvu
 *rvu;

1155 
u16
 
pcifunc
;

1157 
rvu
 = 
m
->
¥iv©e
;

1159 
˘y≥
) {

1160 
NPA_AQ_CTYPE_AURA
:

1161 
≈Æf
 = 
rvu
->
rvu_dbg
.
≈a_auø_˘x
.
lf
;

1162 
id
 = 
rvu
->
rvu_dbg
.
≈a_auø_˘x
.id;

1163 
Æl
 = 
rvu
->
rvu_dbg
.
≈a_auø_˘x
.all;

1166 
NPA_AQ_CTYPE_POOL
:

1167 
≈Æf
 = 
rvu
->
rvu_dbg
.
≈a_poﬁ_˘x
.
lf
;

1168 
id
 = 
rvu
->
rvu_dbg
.
≈a_poﬁ_˘x
.id;

1169 
Æl
 = 
rvu
->
rvu_dbg
.
≈a_poﬁ_˘x
.all;

1172  -
EINVAL
;

1175 i‡(!
	`rvu_dbg_is_vÆid_lf
(
rvu
, 
BLKADDR_NPA
, 
≈Æf
, &
pcifunc
))

1176  -
EINVAL
;

1178 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1179 i‡(
˘y≥
 =
NPA_AQ_CTYPE_AURA
 && !
pfvf
->
auø_˘x
) {

1180 
	`£q_puts
(
m
, "Aura context isÇot initialized\n");

1181  -
EINVAL
;

1182 } i‡(
˘y≥
 =
NPA_AQ_CTYPE_POOL
 && !
pfvf
->
poﬁ_˘x
) {

1183 
	`£q_puts
(
m
, "Pool context isÇot initialized\n");

1184  -
EINVAL
;

1187 
	`mem£t
(&
aq_ªq
, 0, (
≈a_aq_íq_ªq
));

1188 
aq_ªq
.
hdr
.
pcifunc
 =Öcifunc;

1189 
aq_ªq
.
˘y≥
 = ctype;

1190 
aq_ªq
.
›
 = 
NPA_AQ_INSTOP_READ
;

1191 i‡(
˘y≥
 =
NPA_AQ_CTYPE_AURA
) {

1192 
max_id
 = 
pfvf
->
auø_˘x
->
qsize
;

1193 
¥öt_≈a_˘x
 = 
¥öt_≈a_auø_˘x
;

1195 
max_id
 = 
pfvf
->
poﬁ_˘x
->
qsize
;

1196 
¥öt_≈a_˘x
 = 
¥öt_≈a_poﬁ_˘x
;

1199 i‡(
id
 < 0 || id >
max_id
) {

1200 
	`£q_¥ötf
(
m
, "Invalid %s, validÑange is 0-%d\n",

1201 (
˘y≥
 =
NPA_AQ_CTYPE_AURA
) ? "aura" : "pool",

1202 
max_id
 - 1);

1203  -
EINVAL
;

1206 i‡(
Æl
)

1207 
id
 = 0;

1209 
max_id
 = 
id
 + 1;

1211 
auø
 = 
id
;áuø < 
max_id
;áura++) {

1212 
aq_ªq
.
auø_id
 = 
auø
;

1214 i‡(
˘y≥
 =
NPA_AQ_CTYPE_POOL
 && !
	`ã°_bô
(
auø
, 
pfvf
->
poﬁ_bm≠
))

1217 
	`£q_¥ötf
(
m
, "======%s : %d=======\n",

1218 (
˘y≥
 =
NPA_AQ_CTYPE_AURA
) ? "AURA" : "POOL",

1219 
aq_ªq
.
auø_id
);

1220 
rc
 = 
	`rvu_≈a_aq_íq_ö°
(
rvu
, &
aq_ªq
, &
r•
);

1221 i‡(
rc
) {

1222 
	`£q_puts
(
m
, "FailedÅoÑead context\n");

1223  -
EINVAL
;

1225 
	`¥öt_≈a_˘x
(
m
, &
r•
);

1228 
	}
}

1230 
	$wrôe_≈a_˘x
(
rvu
 *rvu, 
boﬁ
 
Æl
,

1231 
≈Æf
, 
id
, 
˘y≥
)

1233 
rvu_pfvf
 *
pfvf
;

1234 
max_id
 = 0;

1235 
u16
 
pcifunc
;

1237 i‡(!
	`rvu_dbg_is_vÆid_lf
(
rvu
, 
BLKADDR_NPA
, 
≈Æf
, &
pcifunc
))

1238  -
EINVAL
;

1240 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1242 i‡(
˘y≥
 =
NPA_AQ_CTYPE_AURA
) {

1243 i‡(!
pfvf
->
auø_˘x
) {

1244 
	`dev_w¨n
(
rvu
->
dev
, "Aura context isÇot initialized\n");

1245  -
EINVAL
;

1247 
max_id
 = 
pfvf
->
auø_˘x
->
qsize
;

1248 } i‡(
˘y≥
 =
NPA_AQ_CTYPE_POOL
) {

1249 i‡(!
pfvf
->
poﬁ_˘x
) {

1250 
	`dev_w¨n
(
rvu
->
dev
, "Pool context isÇot initialized\n");

1251  -
EINVAL
;

1253 
max_id
 = 
pfvf
->
poﬁ_˘x
->
qsize
;

1256 i‡(
id
 < 0 || id >
max_id
) {

1257 
	`dev_w¨n
(
rvu
->
dev
, "Invalid %s, validÑange is 0-%d\n",

1258 (
˘y≥
 =
NPA_AQ_CTYPE_AURA
) ? "aura" : "pool",

1259 
max_id
 - 1);

1260  -
EINVAL
;

1263 
˘y≥
) {

1264 
NPA_AQ_CTYPE_AURA
:

1265 
rvu
->
rvu_dbg
.
≈a_auø_˘x
.
lf
 = 
≈Æf
;

1266 
rvu
->
rvu_dbg
.
≈a_auø_˘x
.
id
 = id;

1267 
rvu
->
rvu_dbg
.
≈a_auø_˘x
.
Æl
 =áll;

1270 
NPA_AQ_CTYPE_POOL
:

1271 
rvu
->
rvu_dbg
.
≈a_poﬁ_˘x
.
lf
 = 
≈Æf
;

1272 
rvu
->
rvu_dbg
.
≈a_poﬁ_˘x
.
id
 = id;

1273 
rvu
->
rvu_dbg
.
≈a_poﬁ_˘x
.
Æl
 =áll;

1276  -
EINVAL
;

1279 
	}
}

1281 
	$∑r£_cmd_buf„r_˘x
(*
cmd_buf
, 
size_t
 *
cou¡
,

1282 c⁄° 
__u£r
 *
buf„r
, *
≈Æf
,

1283 *
id
, 
boﬁ
 *
Æl
)

1285 
byãs_nŸ_c›õd
;

1286 *
cmd_buf_tmp
;

1287 *
subtokí
;

1288 
ªt
;

1290 
byãs_nŸ_c›õd
 = 
	`c›y_‰om_u£r
(
cmd_buf
, 
buf„r
, *
cou¡
);

1291 i‡(
byãs_nŸ_c›õd
)

1292  -
EFAULT
;

1294 
cmd_buf
[*
cou¡
] = '\0';

1295 
cmd_buf_tmp
 = 
	`°rchr
(
cmd_buf
, '\n');

1297 i‡(
cmd_buf_tmp
) {

1298 *
cmd_buf_tmp
 = '\0';

1299 *
cou¡
 = 
cmd_buf_tmp
 - 
cmd_buf
 + 1;

1302 
subtokí
 = 
	`°r£p
(&
cmd_buf
, " ");

1303 
ªt
 = 
subtokí
 ? 
	`k°πoöt
(subtokí, 10, 
≈Æf
Ë: -
EINVAL
;

1304 i‡(
ªt
 < 0)

1305  
ªt
;

1306 
subtokí
 = 
	`°r£p
(&
cmd_buf
, " ");

1307 i‡(
subtokí
 && 
	`°rcmp
(subtoken, "all") == 0) {

1308 *
Æl
 = 
åue
;

1310 
ªt
 = 
subtokí
 ? 
	`k°πoöt
(subtokí, 10, 
id
Ë: -
EINVAL
;

1311 i‡(
ªt
 < 0)

1312  
ªt
;

1314 i‡(
cmd_buf
)

1315  -
EINVAL
;

1316  
ªt
;

1317 
	}
}

1319 
ssize_t
 
	$rvu_dbg_≈a_˘x_wrôe
(
fûe
 *
fûp
,

1320 c⁄° 
__u£r
 *
buf„r
,

1321 
size_t
 
cou¡
, 
loff_t
 *
µos
, 
˘y≥
)

1323 *
cmd_buf
, *
˘y≥_°rög
 = (
˘y≥
 =
NPA_AQ_CTYPE_AURA
) ?

1325 
£q_fûe
 *
£qÂ
 = 
fûp
->
¥iv©e_d©a
;

1326 
rvu
 *rvu = 
£qÂ
->
¥iv©e
;

1327 
≈Æf
, 
id
 = 0, 
ªt
;

1328 
boﬁ
 
Æl
 = 
Ál£
;

1330 i‡((*
µos
 !0Ë|| !
cou¡
)

1331  -
EINVAL
;

1333 
cmd_buf
 = 
	`kzÆloc
(
cou¡
 + 1, 
GFP_KERNEL
);

1334 i‡(!
cmd_buf
)

1335  
cou¡
;

1336 
ªt
 = 
	`∑r£_cmd_buf„r_˘x
(
cmd_buf
, &
cou¡
, 
buf„r
,

1337 &
≈Æf
, &
id
, &
Æl
);

1338 i‡(
ªt
 < 0) {

1339 
	`dev_öfo
(
rvu
->
dev
,

1341 
˘y≥_°rög
, ctype_string);

1342 
d⁄e
;

1344 
ªt
 = 
	`wrôe_≈a_˘x
(
rvu
, 
Æl
, 
≈Æf
, 
id
, 
˘y≥
);

1346 
d⁄e
:

1347 
	`k‰ì
(
cmd_buf
);

1348  
ªt
 ?Ñë : 
cou¡
;

1349 
	}
}

1351 
ssize_t
 
	$rvu_dbg_≈a_auø_˘x_wrôe
(
fûe
 *
fûp
,

1352 c⁄° 
__u£r
 *
buf„r
,

1353 
size_t
 
cou¡
, 
loff_t
 *
µos
)

1355  
	`rvu_dbg_≈a_˘x_wrôe
(
fûp
, 
buf„r
, 
cou¡
, 
µos
,

1356 
NPA_AQ_CTYPE_AURA
);

1357 
	}
}

1359 
	$rvu_dbg_≈a_auø_˘x_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

1361  
	`rvu_dbg_≈a_˘x_di•œy
(
fûp
, 
unu£d
, 
NPA_AQ_CTYPE_AURA
);

1362 
	}
}

1364 
RVU_DEBUG_SEQ_FOPS
(
≈a_auø_˘x
, 
≈a_auø_˘x_di•œy
, 
≈a_auø_˘x_wrôe
);

1366 
ssize_t
 
	$rvu_dbg_≈a_poﬁ_˘x_wrôe
(
fûe
 *
fûp
,

1367 c⁄° 
__u£r
 *
buf„r
,

1368 
size_t
 
cou¡
, 
loff_t
 *
µos
)

1370  
	`rvu_dbg_≈a_˘x_wrôe
(
fûp
, 
buf„r
, 
cou¡
, 
µos
,

1371 
NPA_AQ_CTYPE_POOL
);

1372 
	}
}

1374 
	$rvu_dbg_≈a_poﬁ_˘x_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

1376  
	`rvu_dbg_≈a_˘x_di•œy
(
fûp
, 
unu£d
, 
NPA_AQ_CTYPE_POOL
);

1377 
	}
}

1379 
RVU_DEBUG_SEQ_FOPS
(
≈a_poﬁ_˘x
, 
≈a_poﬁ_˘x_di•œy
, 
≈a_poﬁ_˘x_wrôe
);

1381 
	$ndc_ˇche_°©s
(
£q_fûe
 *
s
, 
blk_addr
,

1382 
˘y≥
, 
å™ß˘i⁄
)

1384 
u64
 
ªq
, 
out_ªq
, 
œt
, 
ˇ¡_Æloc
;

1385 
nix_hw
 *nix_hw;

1386 
rvu
 *rvu;

1387 
p‹t
;

1389 i‡(
blk_addr
 =
BLKADDR_NDC_NPA0
) {

1390 
rvu
 = 
s
->
¥iv©e
;

1392 
nix_hw
 = 
s
->
¥iv©e
;

1393 
rvu
 = 
nix_hw
->rvu;

1396 
p‹t
 = 0;Ö‹à< 
NDC_MAX_PORT
;Öort++) {

1397 
ªq
 = 
	`rvu_ªad64
(
rvu
, 
blk_addr
, 
NDC_AF_PORTX_RTX_RWX_REQ_PC


1398 (
p‹t
, 
˘y≥
, 
å™ß˘i⁄
));

1399 
œt
 = 
	`rvu_ªad64
(
rvu
, 
blk_addr
, 
NDC_AF_PORTX_RTX_RWX_LAT_PC


1400 (
p‹t
, 
˘y≥
, 
å™ß˘i⁄
));

1401 
out_ªq
 = 
	`rvu_ªad64
(
rvu
, 
blk_addr
,

1402 
NDC_AF_PORTX_RTX_RWX_OSTDN_PC


1403 (
p‹t
, 
˘y≥
, 
å™ß˘i⁄
));

1404 
ˇ¡_Æloc
 = 
	`rvu_ªad64
(
rvu
, 
blk_addr
,

1405 
NDC_AF_PORTX_RTX_CANT_ALLOC_PC


1406 (
p‹t
, 
å™ß˘i⁄
));

1407 
	`£q_¥ötf
(
s
, "\nP‹t:%d\n", 
p‹t
);

1408 
	`£q_¥ötf
(
s
, "\tTŸÆ Reque°s:\t\t%Œd\n", 
ªq
);

1409 
	`£q_¥ötf
(
s
, "\tTŸÆ TimêTakí:\t%Œd cy˛es\n", 
œt
);

1410 
	`£q_¥ötf
(
s
, "\tAvg L©ícy:\t\t%Œd cy˛es\n", 
œt
 / 
ªq
);

1411 
	`£q_¥ötf
(
s
, "\tOut°™dög Reque°s:\t%Œd\n", 
out_ªq
);

1412 
	`£q_¥ötf
(
s
, "\tC™àAŒo¯Reque°s:\t%Œd\n", 
ˇ¡_Æloc
);

1414 
	}
}

1416 
	$ndc_blk_ˇche_°©s
(
£q_fûe
 *
s
, 
idx
, 
blk_addr
)

1418 
	`£q_puts
(
s
, "\n***** CACHE modeÑead stats *****\n");

1419 
	`ndc_ˇche_°©s
(
s
, 
blk_addr
, 
CACHING
, 
NDC_READ_TRANS
);

1420 
	`£q_puts
(
s
, "\n***** CACHE mode write stats *****\n");

1421 
	`ndc_ˇche_°©s
(
s
, 
blk_addr
, 
CACHING
, 
NDC_WRITE_TRANS
);

1422 
	`£q_puts
(
s
, "\n***** BY-PASS modeÑead stats *****\n");

1423 
	`ndc_ˇche_°©s
(
s
, 
blk_addr
, 
BYPASS
, 
NDC_READ_TRANS
);

1424 
	`£q_puts
(
s
, "\n***** BY-PASS mode write stats *****\n");

1425 
	`ndc_ˇche_°©s
(
s
, 
blk_addr
, 
BYPASS
, 
NDC_WRITE_TRANS
);

1427 
	}
}

1429 
	$rvu_dbg_≈a_ndc_ˇche_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

1431  
	`ndc_blk_ˇche_°©s
(
fûp
, 
NPA0_U
, 
BLKADDR_NDC_NPA0
);

1432 
	}
}

1434 
RVU_DEBUG_SEQ_FOPS
(
≈a_ndc_ˇche
, 
≈a_ndc_ˇche_di•œy
, 
NULL
);

1436 
	$ndc_blk_hôs_miss_°©s
(
£q_fûe
 *
s
, 
idx
, 
blk_addr
)

1438 
nix_hw
 *nix_hw;

1439 
rvu
 *rvu;

1440 
b™k
, 
max_b™k
;

1442 i‡(
blk_addr
 =
BLKADDR_NDC_NPA0
) {

1443 
rvu
 = 
s
->
¥iv©e
;

1445 
nix_hw
 = 
s
->
¥iv©e
;

1446 
rvu
 = 
nix_hw
->rvu;

1449 
max_b™k
 = 
	`NDC_MAX_BANK
(
rvu
, 
blk_addr
);

1450 
b™k
 = 0; b™k < 
max_b™k
; bank++) {

1451 
	`£q_¥ötf
(
s
, "BANK:%d\n", 
b™k
);

1452 
	`£q_¥ötf
(
s
, "\tHits:\t%lld\n",

1453 (
u64
)
	`rvu_ªad64
(
rvu
, 
blk_addr
,

1454 
	`NDC_AF_BANKX_HIT_PC
(
b™k
)));

1455 
	`£q_¥ötf
(
s
, "\tMiss:\t%lld\n",

1456 (
u64
)
	`rvu_ªad64
(
rvu
, 
blk_addr
,

1457 
	`NDC_AF_BANKX_MISS_PC
(
b™k
)));

1460 
	}
}

1462 
	$rvu_dbg_nix_ndc_rx_ˇche_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

1464 
nix_hw
 *nix_hw = 
fûp
->
¥iv©e
;

1465 
blkaddr
 = 0;

1466 
ndc_idx
 = 0;

1468 
blkaddr
 = (
nix_hw
->blkadd∏=
BLKADDR_NIX1
 ?

1469 
BLKADDR_NDC_NIX1_RX
 : 
BLKADDR_NDC_NIX0_RX
);

1470 
ndc_idx
 = (
nix_hw
->
blkaddr
 =
BLKADDR_NIX1
 ? 
NIX1_RX
 : 
NIX0_RX
);

1472  
	`ndc_blk_ˇche_°©s
(
fûp
, 
ndc_idx
, 
blkaddr
);

1473 
	}
}

1475 
RVU_DEBUG_SEQ_FOPS
(
nix_ndc_rx_ˇche
, 
nix_ndc_rx_ˇche_di•œy
, 
NULL
);

1477 
	$rvu_dbg_nix_ndc_tx_ˇche_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

1479 
nix_hw
 *nix_hw = 
fûp
->
¥iv©e
;

1480 
blkaddr
 = 0;

1481 
ndc_idx
 = 0;

1483 
blkaddr
 = (
nix_hw
->blkadd∏=
BLKADDR_NIX1
 ?

1484 
BLKADDR_NDC_NIX1_TX
 : 
BLKADDR_NDC_NIX0_TX
);

1485 
ndc_idx
 = (
nix_hw
->
blkaddr
 =
BLKADDR_NIX1
 ? 
NIX1_TX
 : 
NIX0_TX
);

1487  
	`ndc_blk_ˇche_°©s
(
fûp
, 
ndc_idx
, 
blkaddr
);

1488 
	}
}

1490 
RVU_DEBUG_SEQ_FOPS
(
nix_ndc_tx_ˇche
, 
nix_ndc_tx_ˇche_di•œy
, 
NULL
);

1492 
	$rvu_dbg_≈a_ndc_hôs_miss_di•œy
(
£q_fûe
 *
fûp
,

1493 *
unu£d
)

1495  
	`ndc_blk_hôs_miss_°©s
(
fûp
, 
NPA0_U
, 
BLKADDR_NDC_NPA0
);

1496 
	}
}

1498 
RVU_DEBUG_SEQ_FOPS
(
≈a_ndc_hôs_miss
, 
≈a_ndc_hôs_miss_di•œy
, 
NULL
);

1500 
	$rvu_dbg_nix_ndc_rx_hôs_miss_di•œy
(
£q_fûe
 *
fûp
,

1501 *
unu£d
)

1503 
nix_hw
 *nix_hw = 
fûp
->
¥iv©e
;

1504 
ndc_idx
 = 
NPA0_U
;

1505 
blkaddr
 = 0;

1507 
blkaddr
 = (
nix_hw
->blkadd∏=
BLKADDR_NIX1
 ?

1508 
BLKADDR_NDC_NIX1_RX
 : 
BLKADDR_NDC_NIX0_RX
);

1510  
	`ndc_blk_hôs_miss_°©s
(
fûp
, 
ndc_idx
, 
blkaddr
);

1511 
	}
}

1513 
RVU_DEBUG_SEQ_FOPS
(
nix_ndc_rx_hôs_miss
, 
nix_ndc_rx_hôs_miss_di•œy
, 
NULL
);

1515 
	$rvu_dbg_nix_ndc_tx_hôs_miss_di•œy
(
£q_fûe
 *
fûp
,

1516 *
unu£d
)

1518 
nix_hw
 *nix_hw = 
fûp
->
¥iv©e
;

1519 
ndc_idx
 = 
NPA0_U
;

1520 
blkaddr
 = 0;

1522 
blkaddr
 = (
nix_hw
->blkadd∏=
BLKADDR_NIX1
 ?

1523 
BLKADDR_NDC_NIX1_TX
 : 
BLKADDR_NDC_NIX0_TX
);

1525  
	`ndc_blk_hôs_miss_°©s
(
fûp
, 
ndc_idx
, 
blkaddr
);

1526 
	}
}

1528 
RVU_DEBUG_SEQ_FOPS
(
nix_ndc_tx_hôs_miss
, 
nix_ndc_tx_hôs_miss_di•œy
, 
NULL
);

1530 
	$¥öt_nix_˙10k_sq_˘x
(
£q_fûe
 *
m
,

1531 
nix_˙10k_sq_˘x_s
 *
sq_˘x
)

1533 
	`£q_¥ötf
(
m
, "W0:Éna \t\t\t%d\nW0: qint_idx \t\t\t%d\n",

1534 
sq_˘x
->
ía
, sq_˘x->
qöt_idx
);

1535 
	`£q_¥ötf
(
m
, "W0: substream \t\t\t0x%03x\nW0: sdp_mcast \t\t\t%d\n",

1536 
sq_˘x
->
sub°ªam
, sq_˘x->
sdp_mˇ°
);

1537 
	`£q_¥ötf
(
m
, "W0: cq \t\t\t\t%d\nW0: sqe_way_mask \t\t%d\n\n",

1538 
sq_˘x
->
cq
, sq_˘x->
sqe_way_mask
);

1540 
	`£q_¥ötf
(
m
, "W1: smq \t\t\t%d\nW1: cq_ena \t\t\t%d\nW1: xoff\t\t\t%d\n",

1541 
sq_˘x
->
smq
, sq_˘x->
cq_ía
, sq_˘x->
xoff
);

1542 
	`£q_¥ötf
(
m
, "W1: sso_ena \t\t\t%d\nW1: smq_rr_weight\t\t%d\n",

1543 
sq_˘x
->
sso_ía
, sq_˘x->
smq_º_weight
);

1544 
	`£q_¥ötf
(
m
, "W1: default_chan\t\t%d\nW1: sqb_count\t\t\t%d\n\n",

1545 
sq_˘x
->
deÁu…_ch™
, sq_˘x->
sqb_cou¡
);

1547 
	`£q_¥ötf
(
m
, "W2: smq_º_cou¡_lb \t\t%d\n", 
sq_˘x
->
smq_º_cou¡_lb
);

1548 
	`£q_¥ötf
(
m
, "W2: smq_º_cou¡_ub \t\t%d\n", 
sq_˘x
->
smq_º_cou¡_ub
);

1549 
	`£q_¥ötf
(
m
, "W2: sqb_aura \t\t\t%d\nW2: sq_int \t\t\t%d\n",

1550 
sq_˘x
->
sqb_auø
, sq_˘x->
sq_öt
);

1551 
	`£q_¥ötf
(
m
, "W2: sq_int_ena \t\t\t%d\nW2: sqe_stype \t\t\t%d\n",

1552 
sq_˘x
->
sq_öt_ía
, sq_˘x->
sqe_°y≥
);

1554 
	`£q_¥ötf
(
m
, "W3: max_sqe_size\t\t%d\nW3: cq_limit\t\t\t%d\n",

1555 
sq_˘x
->
max_sqe_size
, sq_˘x->
cq_limô
);

1556 
	`£q_¥ötf
(
m
, "W3:Ümt_dis \t\t\t%d\nW3: mnq_dis \t\t\t%d\n",

1557 
sq_˘x
->
mnq_dis
, sq_˘x->
lmt_dis
);

1558 
	`£q_¥ötf
(
m
, "W3: smq_next_sq\t\t\t%d\nW3: smq_lso_segnum\t\t%d\n",

1559 
sq_˘x
->
smq_√xt_sq
, sq_˘x->
smq_lso_£gnum
);

1560 
	`£q_¥ötf
(
m
, "W3:Åail_offset \t\t%d\nW3: smenq_offset\t\t%d\n",

1561 
sq_˘x
->
èû_off£t
, sq_˘x->
smíq_off£t
);

1562 
	`£q_¥ötf
(
m
, "W3: head_offset\t\t\t%d\nW3: smenq_next_sqb_vld\t\t%d\n\n",

1563 
sq_˘x
->
hód_off£t
, sq_˘x->
smíq_√xt_sqb_vld
);

1565 
	`£q_¥ötf
(
m
, "W3: smq_next_sq_vld\t\t%d\nW3: smq_pend\t\t\t%d\n",

1566 
sq_˘x
->
smq_√xt_sq_vld
, sq_˘x->
smq_≥nd
);

1567 
	`£q_¥ötf
(
m
, "W4:Çext_sqb \t\t\t%Œx\n\n", 
sq_˘x
->
√xt_sqb
);

1568 
	`£q_¥ötf
(
m
, "W5:Åaû_sqb \t\t\t%Œx\n\n", 
sq_˘x
->
èû_sqb
);

1569 
	`£q_¥ötf
(
m
, "W6: smíq_sqb \t\t\t%Œx\n\n", 
sq_˘x
->
smíq_sqb
);

1570 
	`£q_¥ötf
(
m
, "W7: smenq_next_sqb \t\t%llx\n\n",

1571 
sq_˘x
->
smíq_√xt_sqb
);

1573 
	`£q_¥ötf
(
m
, "W8: hód_sqb\t\t\t%Œx\n\n", 
sq_˘x
->
hód_sqb
);

1575 
	`£q_¥ötf
(
m
, "W9: vfi_lso_tŸÆ\t\t%d\n", 
sq_˘x
->
vfi_lso_tŸÆ
);

1576 
	`£q_¥ötf
(
m
, "W9: vfi_lso_sizem1\t\t%d\nW9: vfi_lso_sb\t\t\t%d\n",

1577 
sq_˘x
->
vfi_lso_sizem1
, sq_˘x->
vfi_lso_sb
);

1578 
	`£q_¥ötf
(
m
, "W9: vfi_lso_mps\t\t\t%d\nW9: vfi_lso_vlan0_ins_ena\t%d\n",

1579 
sq_˘x
->
vfi_lso_mps
, sq_˘x->
vfi_lso_vœn0_ös_ía
);

1580 
	`£q_¥ötf
(
m
, "W9: vfi_lso_vlan1_ins_ena\t%d\nW9: vfi_lso_vld \t\t%d\n\n",

1581 
sq_˘x
->
vfi_lso_vld
, sq_˘x->
vfi_lso_vœn1_ös_ía
);

1583 
	`£q_¥ötf
(
m
, "W10: scm_lso_rem \t\t%llu\n\n",

1584 (
u64
)
sq_˘x
->
scm_lso_ªm
);

1585 
	`£q_¥ötf
(
m
, "W11: o˘†\t\t\t%Œu\n\n", (
u64
)
sq_˘x
->
o˘s
);

1586 
	`£q_¥ötf
(
m
, "W12:Ökt†\t\t\t%Œu\n\n", (
u64
)
sq_˘x
->
pkts
);

1587 
	`£q_¥ötf
(
m
, "W14: dropped_octs \t\t%llu\n\n",

1588 (
u64
)
sq_˘x
->
dr›≥d_o˘s
);

1589 
	`£q_¥ötf
(
m
, "W15: dropped_pkts \t\t%llu\n\n",

1590 (
u64
)
sq_˘x
->
dr›≥d_pkts
);

1591 
	}
}

1594 
	$¥öt_nix_sq_˘x
(
£q_fûe
 *
m
, 
nix_aq_íq_r•
 *
r•
)

1596 
nix_sq_˘x_s
 *
sq_˘x
 = &
r•
->
sq
;

1597 
nix_hw
 *nix_hw = 
m
->
¥iv©e
;

1598 
rvu
 *rvu = 
nix_hw
->rvu;

1600 i‡(!
	`is_rvu_Ÿx2
(
rvu
)) {

1601 
	`¥öt_nix_˙10k_sq_˘x
(
m
, (
nix_˙10k_sq_˘x_s
 *)
sq_˘x
);

1604 
	`£q_¥ötf
(
m
, "W0: sqe_way_mask \t\t%d\nW0: cq \t\t\t\t%d\n",

1605 
sq_˘x
->
sqe_way_mask
, sq_˘x->
cq
);

1606 
	`£q_¥ötf
(
m
, "W0: sdp_mcast \t\t\t%d\nW0: substream \t\t\t0x%03x\n",

1607 
sq_˘x
->
sdp_mˇ°
, sq_˘x->
sub°ªam
);

1608 
	`£q_¥ötf
(
m
, "W0: qint_idx \t\t\t%d\nW0:Éna \t\t\t%d\n\n",

1609 
sq_˘x
->
qöt_idx
, sq_˘x->
ía
);

1611 
	`£q_¥ötf
(
m
, "W1: sqb_count \t\t\t%d\nW1: default_chan \t\t%d\n",

1612 
sq_˘x
->
sqb_cou¡
, sq_˘x->
deÁu…_ch™
);

1613 
	`£q_¥ötf
(
m
, "W1: smq_rr_quantum \t\t%d\nW1: sso_ena \t\t\t%d\n",

1614 
sq_˘x
->
smq_º_qu™tum
, sq_˘x->
sso_ía
);

1615 
	`£q_¥ötf
(
m
, "W1: xoff \t\t\t%d\nW1: cq_ena \t\t\t%d\nW1: smq\t\t\t\t%d\n\n",

1616 
sq_˘x
->
xoff
, sq_˘x->
cq_ía
, sq_˘x->
smq
);

1618 
	`£q_¥ötf
(
m
, "W2: sqe_stype \t\t\t%d\nW2: sq_int_ena \t\t\t%d\n",

1619 
sq_˘x
->
sqe_°y≥
, sq_˘x->
sq_öt_ía
);

1620 
	`£q_¥ötf
(
m
, "W2: sq_int \t\t\t%d\nW2: sqb_aura \t\t\t%d\n",

1621 
sq_˘x
->
sq_öt
, sq_˘x->
sqb_auø
);

1622 
	`£q_¥ötf
(
m
, "W2: smq_º_cou¡ \t\t%d\n\n", 
sq_˘x
->
smq_º_cou¡
);

1624 
	`£q_¥ötf
(
m
, "W3: smq_next_sq_vld\t\t%d\nW3: smq_pend\t\t\t%d\n",

1625 
sq_˘x
->
smq_√xt_sq_vld
, sq_˘x->
smq_≥nd
);

1626 
	`£q_¥ötf
(
m
, "W3: smenq_next_sqb_vld \t\t%d\nW3: head_offset\t\t\t%d\n",

1627 
sq_˘x
->
smíq_√xt_sqb_vld
, sq_˘x->
hód_off£t
);

1628 
	`£q_¥ötf
(
m
, "W3: smenq_offset\t\t%d\nW3:Åail_offset\t\t\t%d\n",

1629 
sq_˘x
->
smíq_off£t
, sq_˘x->
èû_off£t
);

1630 
	`£q_¥ötf
(
m
, "W3: smq_lso_segnum \t\t%d\nW3: smq_next_sq\t\t\t%d\n",

1631 
sq_˘x
->
smq_lso_£gnum
, sq_˘x->
smq_√xt_sq
);

1632 
	`£q_¥ötf
(
m
, "W3: mnq_dis \t\t\t%d\nW3:Ümt_dis \t\t\t%d\n",

1633 
sq_˘x
->
mnq_dis
, sq_˘x->
lmt_dis
);

1634 
	`£q_¥ötf
(
m
, "W3: cq_limit\t\t\t%d\nW3: max_sqe_size\t\t%d\n\n",

1635 
sq_˘x
->
cq_limô
, sq_˘x->
max_sqe_size
);

1637 
	`£q_¥ötf
(
m
, "W4:Çext_sqb \t\t\t%Œx\n\n", 
sq_˘x
->
√xt_sqb
);

1638 
	`£q_¥ötf
(
m
, "W5:Åaû_sqb \t\t\t%Œx\n\n", 
sq_˘x
->
èû_sqb
);

1639 
	`£q_¥ötf
(
m
, "W6: smíq_sqb \t\t\t%Œx\n\n", 
sq_˘x
->
smíq_sqb
);

1640 
	`£q_¥ötf
(
m
, "W7: smenq_next_sqb \t\t%llx\n\n",

1641 
sq_˘x
->
smíq_√xt_sqb
);

1643 
	`£q_¥ötf
(
m
, "W8: hód_sqb\t\t\t%Œx\n\n", 
sq_˘x
->
hód_sqb
);

1645 
	`£q_¥ötf
(
m
, "W9: vfi_lso_vld\t\t\t%d\nW9: vfi_lso_vlan1_ins_ena\t%d\n",

1646 
sq_˘x
->
vfi_lso_vld
, sq_˘x->
vfi_lso_vœn1_ös_ía
);

1647 
	`£q_¥ötf
(
m
, "W9: vfi_lso_vlan0_ins_ena\t%d\nW9: vfi_lso_mps\t\t\t%d\n",

1648 
sq_˘x
->
vfi_lso_vœn0_ös_ía
, sq_˘x->
vfi_lso_mps
);

1649 
	`£q_¥ötf
(
m
, "W9: vfi_lso_sb\t\t\t%d\nW9: vfi_lso_sizem1\t\t%d\n",

1650 
sq_˘x
->
vfi_lso_sb
, sq_˘x->
vfi_lso_sizem1
);

1651 
	`£q_¥ötf
(
m
, "W9: vfi_lso_tŸÆ\t\t%d\n\n", 
sq_˘x
->
vfi_lso_tŸÆ
);

1653 
	`£q_¥ötf
(
m
, "W10: scm_lso_rem \t\t%llu\n\n",

1654 (
u64
)
sq_˘x
->
scm_lso_ªm
);

1655 
	`£q_¥ötf
(
m
, "W11: o˘†\t\t\t%Œu\n\n", (
u64
)
sq_˘x
->
o˘s
);

1656 
	`£q_¥ötf
(
m
, "W12:Ökt†\t\t\t%Œu\n\n", (
u64
)
sq_˘x
->
pkts
);

1657 
	`£q_¥ötf
(
m
, "W14: dropped_octs \t\t%llu\n\n",

1658 (
u64
)
sq_˘x
->
dr›≥d_o˘s
);

1659 
	`£q_¥ötf
(
m
, "W15: dropped_pkts \t\t%llu\n\n",

1660 (
u64
)
sq_˘x
->
dr›≥d_pkts
);

1661 
	}
}

1663 
	$¥öt_nix_˙10k_rq_˘x
(
£q_fûe
 *
m
,

1664 
nix_˙10k_rq_˘x_s
 *
rq_˘x
)

1666 
	`£q_¥ötf
(
m
, "W0:Éna \t\t\t%d\nW0: sso_ena \t\t\t%d\n",

1667 
rq_˘x
->
ía
,Ñq_˘x->
sso_ía
);

1668 
	`£q_¥ötf
(
m
, "W0: ipsech_ena \t\t\t%d\nW0:Éna_wqwd \t\t\t%d\n",

1669 
rq_˘x
->
ù£ch_ía
,Ñq_˘x->
ía_wqwd
);

1670 
	`£q_¥ötf
(
m
, "W0: cq \t\t\t\t%d\nW0:Üenerr_dis \t\t\t%d\n",

1671 
rq_˘x
->
cq
,Ñq_˘x->
À√º_dis
);

1672 
	`£q_¥ötf
(
m
, "W0: csum_il4_dis \t\t%d\nW0: csum_ol4_dis \t\t%d\n",

1673 
rq_˘x
->
csum_û4_dis
,Ñq_˘x->
csum_ﬁ4_dis
);

1674 
	`£q_¥ötf
(
m
, "W0:Üen_il4_dis \t\t%d\nW0:Üen_il3_dis \t\t%d\n",

1675 
rq_˘x
->
Àn_û4_dis
,Ñq_˘x->
Àn_û3_dis
);

1676 
	`£q_¥ötf
(
m
, "W0:Üen_ol4_dis \t\t%d\nW0:Üen_ol3_dis \t\t%d\n",

1677 
rq_˘x
->
Àn_ﬁ4_dis
,Ñq_˘x->
Àn_ﬁ3_dis
);

1678 
	`£q_¥ötf
(
m
, "W0: wqe_auø \t\t\t%d\n\n", 
rq_˘x
->
wqe_auø
);

1680 
	`£q_¥ötf
(
m
, "W1: spb_aura \t\t\t%d\nW1:Üpb_aura \t\t\t%d\n",

1681 
rq_˘x
->
•b_auø
,Ñq_˘x->
Õb_auø
);

1682 
	`£q_¥ötf
(
m
, "W1: spb_auø \t\t\t%d\n", 
rq_˘x
->
•b_auø
);

1683 
	`£q_¥ötf
(
m
, "W1: sso_grp \t\t\t%d\nW1: sso_tt \t\t\t%d\n",

1684 
rq_˘x
->
sso_gΩ
,Ñq_˘x->
sso_â
);

1685 
	`£q_¥ötf
(
m
, "W1:Öb_caching \t\t\t%d\nW1: wqe_caching \t\t%d\n",

1686 
rq_˘x
->
pb_ˇchög
,Ñq_˘x->
wqe_ˇchög
);

1687 
	`£q_¥ötf
(
m
, "W1: xqe_drop_ena \t\t%d\nW1: spb_drop_ena \t\t%d\n",

1688 
rq_˘x
->
xqe_dr›_ía
,Ñq_˘x->
•b_dr›_ía
);

1689 
	`£q_¥ötf
(
m
, "W1:Üpb_drop_ena \t\t%d\nW1:Öb_stashing \t\t%d\n",

1690 
rq_˘x
->
Õb_dr›_ía
,Ñq_˘x->
pb_°ashög
);

1691 
	`£q_¥ötf
(
m
, "W1: ipsecd_drop_ena \t\t%d\nW1: chi_ena \t\t\t%d\n\n",

1692 
rq_˘x
->
ù£cd_dr›_ía
,Ñq_˘x->
chi_ía
);

1694 
	`£q_¥ötf
(
m
, "W2: b™d_¥of_id \t\t%d\n", 
rq_˘x
->
b™d_¥of_id
);

1695 
	`£q_¥ötf
(
m
, "W2:Öﬁi˚r_í®\t\t%d\n", 
rq_˘x
->
pﬁi˚r_ía
);

1696 
	`£q_¥ötf
(
m
, "W2: spb_sizem1 \t\t\t%d\n", 
rq_˘x
->
•b_sizem1
);

1697 
	`£q_¥ötf
(
m
, "W2: wqe_skip \t\t\t%d\nW2: sqb_ena \t\t\t%d\n",

1698 
rq_˘x
->
wqe_skù
,Ñq_˘x->
•b_ía
);

1699 
	`£q_¥ötf
(
m
, "W2:Üpb_size1 \t\t\t%d\nW2: first_skip \t\t\t%d\n",

1700 
rq_˘x
->
Õb_sizem1
,Ñq_˘x->
fú°_skù
);

1701 
	`£q_¥ötf
(
m
, "W2:Üater_skip\t\t\t%d\nW2: xqe_imm_size\t\t%d\n",

1702 
rq_˘x
->
œãr_skù
,Ñq_˘x->
xqe_imm_size
);

1703 
	`£q_¥ötf
(
m
, "W2: xqe_imm_copy \t\t%d\nW2: xqe_hdr_split \t\t%d\n\n",

1704 
rq_˘x
->
xqe_imm_c›y
,Ñq_˘x->
xqe_hdr_•lô
);

1706 
	`£q_¥ötf
(
m
, "W3: xqe_drop \t\t\t%d\nW3: xqe_pass \t\t\t%d\n",

1707 
rq_˘x
->
xqe_dr›
,Ñq_˘x->
xqe_∑ss
);

1708 
	`£q_¥ötf
(
m
, "W3: wqe_pool_drop \t\t%d\nW3: wqe_pool_pass \t\t%d\n",

1709 
rq_˘x
->
wqe_poﬁ_dr›
,Ñq_˘x->
wqe_poﬁ_∑ss
);

1710 
	`£q_¥ötf
(
m
, "W3: spb_pool_drop \t\t%d\nW3: spb_pool_pass \t\t%d\n",

1711 
rq_˘x
->
•b_poﬁ_dr›
,Ñq_˘x->
•b_poﬁ_∑ss
);

1712 
	`£q_¥ötf
(
m
, "W3: spb_aura_drop \t\t%d\nW3: spb_aura_pass \t\t%d\n\n",

1713 
rq_˘x
->
•b_auø_∑ss
,Ñq_˘x->
•b_auø_dr›
);

1715 
	`£q_¥ötf
(
m
, "W4:Üpb_aura_drop \t\t%d\nW3:Üpb_aura_pass \t\t%d\n",

1716 
rq_˘x
->
Õb_auø_∑ss
,Ñq_˘x->
Õb_auø_dr›
);

1717 
	`£q_¥ötf
(
m
, "W4:Üpb_pool_drop \t\t%d\nW3:Üpb_pool_pass \t\t%d\n",

1718 
rq_˘x
->
Õb_poﬁ_dr›
,Ñq_˘x->
Õb_poﬁ_∑ss
);

1719 
	`£q_¥ötf
(
m
, "W4:Ñq_int \t\t\t%d\nW4:Ñq_int_ena\t\t\t%d\n",

1720 
rq_˘x
->
rq_öt
,Ñq_˘x->
rq_öt_ía
);

1721 
	`£q_¥ötf
(
m
, "W4: qöt_idx \t\t\t%d\n\n", 
rq_˘x
->
qöt_idx
);

1723 
	`£q_¥ötf
(
m
, "W5:Ütag \t\t\t%d\nW5: good_utag \t\t\t%d\n",

1724 
rq_˘x
->
…ag
,Ñq_˘x->
good_uèg
);

1725 
	`£q_¥ötf
(
m
, "W5: bad_utag \t\t\t%d\nW5: flow_tagw \t\t\t%d\n",

1726 
rq_˘x
->
bad_uèg
,Ñq_˘x->
Êow_ègw
);

1727 
	`£q_¥ötf
(
m
, "W5: ipsec_vwqe \t\t\t%d\nW5: vwqe_ena \t\t\t%d\n",

1728 
rq_˘x
->
ù£c_vwqe
,Ñq_˘x->
vwqe_ía
);

1729 
	`£q_¥ötf
(
m
, "W5: vwqe_wait \t\t\t%d\nW5: max_vsize_exp\t\t%d\n",

1730 
rq_˘x
->
vwqe_waô
,Ñq_˘x->
max_vsize_exp
);

1731 
	`£q_¥ötf
(
m
, "W5: vwqe_skù \t\t\t%d\n\n", 
rq_˘x
->
vwqe_skù
);

1733 
	`£q_¥ötf
(
m
, "W6: o˘†\t\t\t%Œu\n\n", (
u64
)
rq_˘x
->
o˘s
);

1734 
	`£q_¥ötf
(
m
, "W7:Ökt†\t\t\t%Œu\n\n", (
u64
)
rq_˘x
->
pkts
);

1735 
	`£q_¥ötf
(
m
, "W8: dr›_o˘†\t\t\t%Œu\n\n", (
u64
)
rq_˘x
->
dr›_o˘s
);

1736 
	`£q_¥ötf
(
m
, "W9: dr›_pkt†\t\t\t%Œu\n\n", (
u64
)
rq_˘x
->
dr›_pkts
);

1737 
	`£q_¥ötf
(
m
, "W10:Ñe_pkt†\t\t\t%Œu\n", (
u64
)
rq_˘x
->
ª_pkts
);

1738 
	}
}

1741 
	$¥öt_nix_rq_˘x
(
£q_fûe
 *
m
, 
nix_aq_íq_r•
 *
r•
)

1743 
nix_rq_˘x_s
 *
rq_˘x
 = &
r•
->
rq
;

1744 
nix_hw
 *nix_hw = 
m
->
¥iv©e
;

1745 
rvu
 *rvu = 
nix_hw
->rvu;

1747 i‡(!
	`is_rvu_Ÿx2
(
rvu
)) {

1748 
	`¥öt_nix_˙10k_rq_˘x
(
m
, (
nix_˙10k_rq_˘x_s
 *)
rq_˘x
);

1752 
	`£q_¥ötf
(
m
, "W0: wqe_aura \t\t\t%d\nW0: substream \t\t\t0x%03x\n",

1753 
rq_˘x
->
wqe_auø
,Ñq_˘x->
sub°ªam
);

1754 
	`£q_¥ötf
(
m
, "W0: cq \t\t\t\t%d\nW0:Éna_wqwd \t\t\t%d\n",

1755 
rq_˘x
->
cq
,Ñq_˘x->
ía_wqwd
);

1756 
	`£q_¥ötf
(
m
, "W0: ipsech_ena \t\t\t%d\nW0: sso_ena \t\t\t%d\n",

1757 
rq_˘x
->
ù£ch_ía
,Ñq_˘x->
sso_ía
);

1758 
	`£q_¥ötf
(
m
, "W0:É« \t\t\t%d\n\n", 
rq_˘x
->
ía
);

1760 
	`£q_¥ötf
(
m
, "W1:Üpb_drop_ena \t\t%d\nW1: spb_drop_ena \t\t%d\n",

1761 
rq_˘x
->
Õb_dr›_ía
,Ñq_˘x->
•b_dr›_ía
);

1762 
	`£q_¥ötf
(
m
, "W1: xqe_drop_ena \t\t%d\nW1: wqe_caching \t\t%d\n",

1763 
rq_˘x
->
xqe_dr›_ía
,Ñq_˘x->
wqe_ˇchög
);

1764 
	`£q_¥ötf
(
m
, "W1:Öb_caching \t\t\t%d\nW1: sso_tt \t\t\t%d\n",

1765 
rq_˘x
->
pb_ˇchög
,Ñq_˘x->
sso_â
);

1766 
	`£q_¥ötf
(
m
, "W1: sso_grp \t\t\t%d\nW1:Üpb_aura \t\t\t%d\n",

1767 
rq_˘x
->
sso_gΩ
,Ñq_˘x->
Õb_auø
);

1768 
	`£q_¥ötf
(
m
, "W1: spb_auø \t\t\t%d\n\n", 
rq_˘x
->
•b_auø
);

1770 
	`£q_¥ötf
(
m
, "W2: xqe_hdr_split \t\t%d\nW2: xqe_imm_copy \t\t%d\n",

1771 
rq_˘x
->
xqe_hdr_•lô
,Ñq_˘x->
xqe_imm_c›y
);

1772 
	`£q_¥ötf
(
m
, "W2: xqe_imm_size \t\t%d\nW2:Üater_skip \t\t\t%d\n",

1773 
rq_˘x
->
xqe_imm_size
,Ñq_˘x->
œãr_skù
);

1774 
	`£q_¥ötf
(
m
, "W2: first_skip \t\t\t%d\nW2:Üpb_sizem1 \t\t\t%d\n",

1775 
rq_˘x
->
fú°_skù
,Ñq_˘x->
Õb_sizem1
);

1776 
	`£q_¥ötf
(
m
, "W2: spb_ena \t\t\t%d\nW2: wqe_skip \t\t\t%d\n",

1777 
rq_˘x
->
•b_ía
,Ñq_˘x->
wqe_skù
);

1778 
	`£q_¥ötf
(
m
, "W2: spb_sizem1 \t\t\t%d\n\n", 
rq_˘x
->
•b_sizem1
);

1780 
	`£q_¥ötf
(
m
, "W3: spb_pool_pass \t\t%d\nW3: spb_pool_drop \t\t%d\n",

1781 
rq_˘x
->
•b_poﬁ_∑ss
,Ñq_˘x->
•b_poﬁ_dr›
);

1782 
	`£q_¥ötf
(
m
, "W3: spb_aura_pass \t\t%d\nW3: spb_aura_drop \t\t%d\n",

1783 
rq_˘x
->
•b_auø_∑ss
,Ñq_˘x->
•b_auø_dr›
);

1784 
	`£q_¥ötf
(
m
, "W3: wqe_pool_pass \t\t%d\nW3: wqe_pool_drop \t\t%d\n",

1785 
rq_˘x
->
wqe_poﬁ_∑ss
,Ñq_˘x->
wqe_poﬁ_dr›
);

1786 
	`£q_¥ötf
(
m
, "W3: xqe_pass \t\t\t%d\nW3: xqe_drop \t\t\t%d\n\n",

1787 
rq_˘x
->
xqe_∑ss
,Ñq_˘x->
xqe_dr›
);

1789 
	`£q_¥ötf
(
m
, "W4: qint_idx \t\t\t%d\nW4:Ñq_int_ena \t\t\t%d\n",

1790 
rq_˘x
->
qöt_idx
,Ñq_˘x->
rq_öt_ía
);

1791 
	`£q_¥ötf
(
m
, "W4:Ñq_int \t\t\t%d\nW4:Üpb_pool_pass \t\t%d\n",

1792 
rq_˘x
->
rq_öt
,Ñq_˘x->
Õb_poﬁ_∑ss
);

1793 
	`£q_¥ötf
(
m
, "W4:Üpb_pool_drop \t\t%d\nW4:Üpb_aura_pass \t\t%d\n",

1794 
rq_˘x
->
Õb_poﬁ_dr›
,Ñq_˘x->
Õb_auø_∑ss
);

1795 
	`£q_¥ötf
(
m
, "W4:Üpb_auø_dr› \t\t%d\n\n", 
rq_˘x
->
Õb_auø_dr›
);

1797 
	`£q_¥ötf
(
m
, "W5: flow_tagw \t\t\t%d\nW5: bad_utag \t\t\t%d\n",

1798 
rq_˘x
->
Êow_ègw
,Ñq_˘x->
bad_uèg
);

1799 
	`£q_¥ötf
(
m
, "W5: good_utag \t\t\t%d\nW5:Ütag \t\t\t%d\n\n",

1800 
rq_˘x
->
good_uèg
,Ñq_˘x->
…ag
);

1802 
	`£q_¥ötf
(
m
, "W6: o˘†\t\t\t%Œu\n\n", (
u64
)
rq_˘x
->
o˘s
);

1803 
	`£q_¥ötf
(
m
, "W7:Ökt†\t\t\t%Œu\n\n", (
u64
)
rq_˘x
->
pkts
);

1804 
	`£q_¥ötf
(
m
, "W8: dr›_o˘†\t\t\t%Œu\n\n", (
u64
)
rq_˘x
->
dr›_o˘s
);

1805 
	`£q_¥ötf
(
m
, "W9: dr›_pkt†\t\t\t%Œu\n\n", (
u64
)
rq_˘x
->
dr›_pkts
);

1806 
	`£q_¥ötf
(
m
, "W10:Ñe_pkt†\t\t\t%Œu\n", (
u64
)
rq_˘x
->
ª_pkts
);

1807 
	}
}

1810 
	$¥öt_nix_cq_˘x
(
£q_fûe
 *
m
, 
nix_aq_íq_r•
 *
r•
)

1812 
nix_cq_˘x_s
 *
cq_˘x
 = &
r•
->
cq
;

1814 
	`£q_¥ötf
(
m
, "W0: ba£ \t\t\t%Œx\n\n", 
cq_˘x
->
ba£
);

1816 
	`£q_¥ötf
(
m
, "W1: wΩå \t\t\t%Œx\n", (
u64
)
cq_˘x
->
wΩå
);

1817 
	`£q_¥ötf
(
m
, "W1:ávg_con \t\t\t%d\nW1: cint_idx \t\t\t%d\n",

1818 
cq_˘x
->
avg_c⁄
, cq_˘x->
cöt_idx
);

1819 
	`£q_¥ötf
(
m
, "W1: cq_err \t\t\t%d\nW1: qint_idx \t\t\t%d\n",

1820 
cq_˘x
->
cq_îr
, cq_˘x->
qöt_idx
);

1821 
	`£q_¥ötf
(
m
, "W1: bpid \t\t\t%d\nW1: bp_ena \t\t\t%d\n\n",

1822 
cq_˘x
->
bpid
, cq_˘x->
bp_ía
);

1824 
	`£q_¥ötf
(
m
, "W2: update_time \t\t%d\nW2:avg_level \t\t\t%d\n",

1825 
cq_˘x
->
upd©e_time
, cq_˘x->
avg_Àvñ
);

1826 
	`£q_¥ötf
(
m
, "W2: head \t\t\t%d\nW2:tail \t\t\t%d\n\n",

1827 
cq_˘x
->
hód
, cq_˘x->
èû
);

1829 
	`£q_¥ötf
(
m
, "W3: cq_err_int_ena \t\t%d\nW3:cq_err_int \t\t\t%d\n",

1830 
cq_˘x
->
cq_îr_öt_ía
, cq_˘x->
cq_îr_öt
);

1831 
	`£q_¥ötf
(
m
, "W3: qsize \t\t\t%d\nW3:caching \t\t\t%d\n",

1832 
cq_˘x
->
qsize
, cq_˘x->
ˇchög
);

1833 
	`£q_¥ötf
(
m
, "W3: substream \t\t\t0x%03x\nW3:Éna \t\t\t%d\n",

1834 
cq_˘x
->
sub°ªam
, cq_˘x->
ía
);

1835 
	`£q_¥ötf
(
m
, "W3: drop_ena \t\t\t%d\nW3: drop \t\t\t%d\n",

1836 
cq_˘x
->
dr›_ía
, cq_˘x->
dr›
);

1837 
	`£q_¥ötf
(
m
, "W3: b∞\t\t\t\t%d\n\n", 
cq_˘x
->
bp
);

1838 
	}
}

1840 
	$rvu_dbg_nix_queue_˘x_di•œy
(
£q_fûe
 *
fûp
,

1841 *
unu£d
, 
˘y≥
)

1843 (*
¥öt_nix_˘x
)(
£q_fûe
 *
fûp
,

1844 
nix_aq_íq_r•
 *
r•
Ë
NULL
;

1845 
nix_hw
 *nix_hw = 
fûp
->
¥iv©e
;

1846 
rvu
 *rvu = 
nix_hw
->rvu;

1847 
nix_aq_íq_ªq
 
aq_ªq
;

1848 
nix_aq_íq_r•
 
r•
;

1849 *
˘y≥_°rög
 = 
NULL
;

1850 
qidx
, 
rc
, 
max_id
 = 0;

1851 
rvu_pfvf
 *
pfvf
;

1852 
nixlf
, 
id
, 
Æl
;

1853 
u16
 
pcifunc
;

1855 
˘y≥
) {

1856 
NIX_AQ_CTYPE_CQ
:

1857 
nixlf
 = 
rvu
->
rvu_dbg
.
nix_cq_˘x
.
lf
;

1858 
id
 = 
rvu
->
rvu_dbg
.
nix_cq_˘x
.id;

1859 
Æl
 = 
rvu
->
rvu_dbg
.
nix_cq_˘x
.all;

1862 
NIX_AQ_CTYPE_SQ
:

1863 
nixlf
 = 
rvu
->
rvu_dbg
.
nix_sq_˘x
.
lf
;

1864 
id
 = 
rvu
->
rvu_dbg
.
nix_sq_˘x
.id;

1865 
Æl
 = 
rvu
->
rvu_dbg
.
nix_sq_˘x
.all;

1868 
NIX_AQ_CTYPE_RQ
:

1869 
nixlf
 = 
rvu
->
rvu_dbg
.
nix_rq_˘x
.
lf
;

1870 
id
 = 
rvu
->
rvu_dbg
.
nix_rq_˘x
.id;

1871 
Æl
 = 
rvu
->
rvu_dbg
.
nix_rq_˘x
.all;

1875  -
EINVAL
;

1878 i‡(!
	`rvu_dbg_is_vÆid_lf
(
rvu
, 
nix_hw
->
blkaddr
, 
nixlf
, &
pcifunc
))

1879  -
EINVAL
;

1881 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1882 i‡(
˘y≥
 =
NIX_AQ_CTYPE_SQ
 && !
pfvf
->
sq_˘x
) {

1883 
	`£q_puts
(
fûp
, "SQ context isÇot initialized\n");

1884  -
EINVAL
;

1885 } i‡(
˘y≥
 =
NIX_AQ_CTYPE_RQ
 && !
pfvf
->
rq_˘x
) {

1886 
	`£q_puts
(
fûp
, "RQ context isÇot initialized\n");

1887  -
EINVAL
;

1888 } i‡(
˘y≥
 =
NIX_AQ_CTYPE_CQ
 && !
pfvf
->
cq_˘x
) {

1889 
	`£q_puts
(
fûp
, "CQ context isÇot initialized\n");

1890  -
EINVAL
;

1893 i‡(
˘y≥
 =
NIX_AQ_CTYPE_SQ
) {

1894 
max_id
 = 
pfvf
->
sq_˘x
->
qsize
;

1895 
˘y≥_°rög
 = "sq";

1896 
¥öt_nix_˘x
 = 
¥öt_nix_sq_˘x
;

1897 } i‡(
˘y≥
 =
NIX_AQ_CTYPE_RQ
) {

1898 
max_id
 = 
pfvf
->
rq_˘x
->
qsize
;

1899 
˘y≥_°rög
 = "rq";

1900 
¥öt_nix_˘x
 = 
¥öt_nix_rq_˘x
;

1901 } i‡(
˘y≥
 =
NIX_AQ_CTYPE_CQ
) {

1902 
max_id
 = 
pfvf
->
cq_˘x
->
qsize
;

1903 
˘y≥_°rög
 = "cq";

1904 
¥öt_nix_˘x
 = 
¥öt_nix_cq_˘x
;

1907 
	`mem£t
(&
aq_ªq
, 0, (
nix_aq_íq_ªq
));

1908 
aq_ªq
.
hdr
.
pcifunc
 =Öcifunc;

1909 
aq_ªq
.
˘y≥
 = ctype;

1910 
aq_ªq
.
›
 = 
NIX_AQ_INSTOP_READ
;

1911 i‡(
Æl
)

1912 
id
 = 0;

1914 
max_id
 = 
id
 + 1;

1915 
qidx
 = 
id
; qidx < 
max_id
; qidx++) {

1916 
aq_ªq
.
qidx
 = qidx;

1917 
	`£q_¥ötf
(
fûp
, "=====%s_ctx forÇixlf:%dánd qidx:%d is=====\n",

1918 
˘y≥_°rög
, 
nixlf
, 
aq_ªq
.
qidx
);

1919 
rc
 = 
	`rvu_mbox_h™dÀr_nix_aq_íq
(
rvu
, &
aq_ªq
, &
r•
);

1920 i‡(
rc
) {

1921 
	`£q_puts
(
fûp
, "FailedÅoÑeadÅhe context\n");

1922  -
EINVAL
;

1924 
	`¥öt_nix_˘x
(
fûp
, &
r•
);

1927 
	}
}

1929 
	$wrôe_nix_queue_˘x
(
rvu
 *rvu, 
boﬁ
 
Æl
, 
nixlf
,

1930 
id
, 
˘y≥
, *
˘y≥_°rög
,

1931 
£q_fûe
 *
m
)

1933 
nix_hw
 *nix_hw = 
m
->
¥iv©e
;

1934 
rvu_pfvf
 *
pfvf
;

1935 
max_id
 = 0;

1936 
u16
 
pcifunc
;

1938 i‡(!
	`rvu_dbg_is_vÆid_lf
(
rvu
, 
nix_hw
->
blkaddr
, 
nixlf
, &
pcifunc
))

1939  -
EINVAL
;

1941 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1943 i‡(
˘y≥
 =
NIX_AQ_CTYPE_SQ
) {

1944 i‡(!
pfvf
->
sq_˘x
) {

1945 
	`dev_w¨n
(
rvu
->
dev
, "SQ context isÇot initialized\n");

1946  -
EINVAL
;

1948 
max_id
 = 
pfvf
->
sq_˘x
->
qsize
;

1949 } i‡(
˘y≥
 =
NIX_AQ_CTYPE_RQ
) {

1950 i‡(!
pfvf
->
rq_˘x
) {

1951 
	`dev_w¨n
(
rvu
->
dev
, "RQ context isÇot initialized\n");

1952  -
EINVAL
;

1954 
max_id
 = 
pfvf
->
rq_˘x
->
qsize
;

1955 } i‡(
˘y≥
 =
NIX_AQ_CTYPE_CQ
) {

1956 i‡(!
pfvf
->
cq_˘x
) {

1957 
	`dev_w¨n
(
rvu
->
dev
, "CQ context isÇot initialized\n");

1958  -
EINVAL
;

1960 
max_id
 = 
pfvf
->
cq_˘x
->
qsize
;

1963 i‡(
id
 < 0 || id >
max_id
) {

1964 
	`dev_w¨n
(
rvu
->
dev
, "Invalid %s_ctx validÑange 0-%d\n",

1965 
˘y≥_°rög
, 
max_id
 - 1);

1966  -
EINVAL
;

1968 
˘y≥
) {

1969 
NIX_AQ_CTYPE_CQ
:

1970 
rvu
->
rvu_dbg
.
nix_cq_˘x
.
lf
 = 
nixlf
;

1971 
rvu
->
rvu_dbg
.
nix_cq_˘x
.
id
 = id;

1972 
rvu
->
rvu_dbg
.
nix_cq_˘x
.
Æl
 =áll;

1975 
NIX_AQ_CTYPE_SQ
:

1976 
rvu
->
rvu_dbg
.
nix_sq_˘x
.
lf
 = 
nixlf
;

1977 
rvu
->
rvu_dbg
.
nix_sq_˘x
.
id
 = id;

1978 
rvu
->
rvu_dbg
.
nix_sq_˘x
.
Æl
 =áll;

1981 
NIX_AQ_CTYPE_RQ
:

1982 
rvu
->
rvu_dbg
.
nix_rq_˘x
.
lf
 = 
nixlf
;

1983 
rvu
->
rvu_dbg
.
nix_rq_˘x
.
id
 = id;

1984 
rvu
->
rvu_dbg
.
nix_rq_˘x
.
Æl
 =áll;

1987  -
EINVAL
;

1990 
	}
}

1992 
ssize_t
 
	$rvu_dbg_nix_queue_˘x_wrôe
(
fûe
 *
fûp
,

1993 c⁄° 
__u£r
 *
buf„r
,

1994 
size_t
 
cou¡
, 
loff_t
 *
µos
,

1995 
˘y≥
)

1997 
£q_fûe
 *
m
 = 
fûp
->
¥iv©e_d©a
;

1998 
nix_hw
 *nix_hw = 
m
->
¥iv©e
;

1999 
rvu
 *rvu = 
nix_hw
->rvu;

2000 *
cmd_buf
, *
˘y≥_°rög
;

2001 
nixlf
, 
id
 = 0, 
ªt
;

2002 
boﬁ
 
Æl
 = 
Ál£
;

2004 i‡((*
µos
 !0Ë|| !
cou¡
)

2005  -
EINVAL
;

2007 
˘y≥
) {

2008 
NIX_AQ_CTYPE_SQ
:

2009 
˘y≥_°rög
 = "sq";

2011 
NIX_AQ_CTYPE_RQ
:

2012 
˘y≥_°rög
 = "rq";

2014 
NIX_AQ_CTYPE_CQ
:

2015 
˘y≥_°rög
 = "cq";

2018  -
EINVAL
;

2021 
cmd_buf
 = 
	`kzÆloc
(
cou¡
 + 1, 
GFP_KERNEL
);

2023 i‡(!
cmd_buf
)

2024  
cou¡
;

2026 
ªt
 = 
	`∑r£_cmd_buf„r_˘x
(
cmd_buf
, &
cou¡
, 
buf„r
,

2027 &
nixlf
, &
id
, &
Æl
);

2028 i‡(
ªt
 < 0) {

2029 
	`dev_öfo
(
rvu
->
dev
,

2031 
˘y≥_°rög
, ctype_string);

2032 
d⁄e
;

2034 
ªt
 = 
	`wrôe_nix_queue_˘x
(
rvu
, 
Æl
, 
nixlf
, 
id
, 
˘y≥
,

2035 
˘y≥_°rög
, 
m
);

2037 
d⁄e
:

2038 
	`k‰ì
(
cmd_buf
);

2039  
ªt
 ?Ñë : 
cou¡
;

2040 
	}
}

2042 
ssize_t
 
	$rvu_dbg_nix_sq_˘x_wrôe
(
fûe
 *
fûp
,

2043 c⁄° 
__u£r
 *
buf„r
,

2044 
size_t
 
cou¡
, 
loff_t
 *
µos
)

2046  
	`rvu_dbg_nix_queue_˘x_wrôe
(
fûp
, 
buf„r
, 
cou¡
, 
µos
,

2047 
NIX_AQ_CTYPE_SQ
);

2048 
	}
}

2050 
	$rvu_dbg_nix_sq_˘x_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

2052  
	`rvu_dbg_nix_queue_˘x_di•œy
(
fûp
, 
unu£d
, 
NIX_AQ_CTYPE_SQ
);

2053 
	}
}

2055 
RVU_DEBUG_SEQ_FOPS
(
nix_sq_˘x
, 
nix_sq_˘x_di•œy
, 
nix_sq_˘x_wrôe
);

2057 
ssize_t
 
	$rvu_dbg_nix_rq_˘x_wrôe
(
fûe
 *
fûp
,

2058 c⁄° 
__u£r
 *
buf„r
,

2059 
size_t
 
cou¡
, 
loff_t
 *
µos
)

2061  
	`rvu_dbg_nix_queue_˘x_wrôe
(
fûp
, 
buf„r
, 
cou¡
, 
µos
,

2062 
NIX_AQ_CTYPE_RQ
);

2063 
	}
}

2065 
	$rvu_dbg_nix_rq_˘x_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

2067  
	`rvu_dbg_nix_queue_˘x_di•œy
(
fûp
, 
unu£d
, 
NIX_AQ_CTYPE_RQ
);

2068 
	}
}

2070 
RVU_DEBUG_SEQ_FOPS
(
nix_rq_˘x
, 
nix_rq_˘x_di•œy
, 
nix_rq_˘x_wrôe
);

2072 
ssize_t
 
	$rvu_dbg_nix_cq_˘x_wrôe
(
fûe
 *
fûp
,

2073 c⁄° 
__u£r
 *
buf„r
,

2074 
size_t
 
cou¡
, 
loff_t
 *
µos
)

2076  
	`rvu_dbg_nix_queue_˘x_wrôe
(
fûp
, 
buf„r
, 
cou¡
, 
µos
,

2077 
NIX_AQ_CTYPE_CQ
);

2078 
	}
}

2080 
	$rvu_dbg_nix_cq_˘x_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

2082  
	`rvu_dbg_nix_queue_˘x_di•œy
(
fûp
, 
unu£d
, 
NIX_AQ_CTYPE_CQ
);

2083 
	}
}

2085 
RVU_DEBUG_SEQ_FOPS
(
nix_cq_˘x
, 
nix_cq_˘x_di•œy
, 
nix_cq_˘x_wrôe
);

2087 
	$¥öt_nix_q˘x_qsize
(
£q_fûe
 *
fûp
, 
qsize
,

2088 *
bm≠
, *
qty≥
)

2090 *
buf
;

2092 
buf
 = 
	`kmÆloc
(
PAGE_SIZE
, 
GFP_KERNEL
);

2093 i‡(!
buf
)

2096 
	`bôm≠_¥öt_to_∑gebuf
(
Ál£
, 
buf
, 
bm≠
, 
qsize
);

2097 
	`£q_¥ötf
(
fûp
, "%†c⁄ãxàcou¡ : %d\n", 
qty≥
, 
qsize
);

2098 
	`£q_¥ötf
(
fûp
, "%s contextÉna/dis bitmap : %s\n",

2099 
qty≥
, 
buf
);

2100 
	`k‰ì
(
buf
);

2101 
	}
}

2103 
	$¥öt_nix_qsize
(
£q_fûe
 *
fûp
, 
rvu_pfvf
 *
pfvf
)

2105 i‡(!
pfvf
->
cq_˘x
)

2106 
	`£q_puts
(
fûp
, "cq context isÇot initialized\n");

2108 
	`¥öt_nix_q˘x_qsize
(
fûp
, 
pfvf
->
cq_˘x
->
qsize
,Öfvf->
cq_bm≠
,

2111 i‡(!
pfvf
->
rq_˘x
)

2112 
	`£q_puts
(
fûp
, "rq context isÇot initialized\n");

2114 
	`¥öt_nix_q˘x_qsize
(
fûp
, 
pfvf
->
rq_˘x
->
qsize
,Öfvf->
rq_bm≠
,

2117 i‡(!
pfvf
->
sq_˘x
)

2118 
	`£q_puts
(
fûp
, "sq context isÇot initialized\n");

2120 
	`¥öt_nix_q˘x_qsize
(
fûp
, 
pfvf
->
sq_˘x
->
qsize
,Öfvf->
sq_bm≠
,

2122 
	}
}

2124 
ssize_t
 
	$rvu_dbg_nix_qsize_wrôe
(
fûe
 *
fûp
,

2125 c⁄° 
__u£r
 *
buf„r
,

2126 
size_t
 
cou¡
, 
loff_t
 *
µos
)

2128  
	`rvu_dbg_qsize_wrôe
(
fûp
, 
buf„r
, 
cou¡
, 
µos
,

2129 
BLKTYPE_NIX
);

2130 
	}
}

2132 
	$rvu_dbg_nix_qsize_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

2134  
	`rvu_dbg_qsize_di•œy
(
fûp
, 
unu£d
, 
BLKTYPE_NIX
);

2135 
	}
}

2137 
RVU_DEBUG_SEQ_FOPS
(
nix_qsize
, 
nix_qsize_di•œy
, 
nix_qsize_wrôe
);

2139 
ssize_t
 
	$rvu_dbg_nix_tx_°Æl_hwissue_di•œy
(
fûe
 *
fûp
,

2140 
__u£r
 *
buf„r
,

2141 
size_t
 
cou¡
, 
loff_t
 *
µos
)

2143  
	`rvu_nix_gë_tx_°Æl_cou¡îs
(
fûp
->
¥iv©e_d©a
, 
buf„r
, 
µos
);

2144 
	}
}

2146 
RVU_DEBUG_FOPS
(
nix_tx_°Æl_hwissue
, 
nix_tx_°Æl_hwissue_di•œy
, 
NULL
);

2148 
	$¥öt_b™d_¥of_˘x
(
£q_fûe
 *
m
,

2149 
nix_b™d¥of_s
 *
¥of
)

2151 *
°r
;

2153 
¥of
->
pc_mode
) {

2154 
NIX_RX_PC_MODE_VLAN
:

2155 
°r
 = "VLAN";

2157 
NIX_RX_PC_MODE_DSCP
:

2158 
°r
 = "DSCP";

2160 
NIX_RX_PC_MODE_GEN
:

2161 
°r
 = "Generic";

2163 
NIX_RX_PC_MODE_RSVD
:

2164 
°r
 = "Reserved";

2167 
	`£q_¥ötf
(
m
, "W0:Öc_mode\t\t%s\n", 
°r
);

2168 
°r
 = (
¥of
->
icﬁ‹
 == 3) ? "Color blind" :

2169 (
¥of
->
icﬁ‹
 == 0) ? "Green" :

2170 (
¥of
->
icﬁ‹
 == 1) ? "Yellow" : "Red";

2171 
	`£q_¥ötf
(
m
, "W0: icﬁ‹\t\t%s\n", 
°r
);

2172 
	`£q_¥ötf
(
m
, "W0:Å∆_ía\t\t%d\n", 
¥of
->
äl_ía
);

2173 
	`£q_¥ötf
(
m
, "W0:Öeú_exp⁄ít\t%d\n", 
¥of
->
≥ú_exp⁄ít
);

2174 
	`£q_¥ötf
(
m
, "W0:Öebs_exp⁄ít\t%d\n", 
¥of
->
≥bs_exp⁄ít
);

2175 
	`£q_¥ötf
(
m
, "W0: cú_exp⁄ít\t%d\n", 
¥of
->
cú_exp⁄ít
);

2176 
	`£q_¥ötf
(
m
, "W0: cbs_exp⁄ít\t%d\n", 
¥of
->
cbs_exp⁄ít
);

2177 
	`£q_¥ötf
(
m
, "W0:Öeú_m™tisß\t%d\n", 
¥of
->
≥ú_m™tisß
);

2178 
	`£q_¥ötf
(
m
, "W0:Öebs_m™tisß\t%d\n", 
¥of
->
≥bs_m™tisß
);

2179 
	`£q_¥ötf
(
m
, "W0: cú_m™tisß\t%d\n", 
¥of
->
cú_m™tisß
);

2181 
	`£q_¥ötf
(
m
, "W1: cbs_m™tisß\t%d\n", 
¥of
->
cbs_m™tisß
);

2182 
°r
 = (
¥of
->
lmode
 == 0) ? "byte" : "packet";

2183 
	`£q_¥ötf
(
m
, "W1:Ümode\t\t%s\n", 
°r
);

2184 
	`£q_¥ötf
(
m
, "W1:Ü_£À˘\t\t%d\n", 
¥of
->
l_£Œe˘
);

2185 
	`£q_¥ötf
(
m
, "W1:Ñdiv\t\t%d\n", 
¥of
->
rdiv
);

2186 
	`£q_¥ötf
(
m
, "W1:ádju°_exp⁄ít\t%d\n", 
¥of
->
adju°_exp⁄ít
);

2187 
	`£q_¥ötf
(
m
, "W1:ádju°_m™tisß\t%d\n", 
¥of
->
adju°_m™tisß
);

2188 
°r
 = (
¥of
->
gc_a˘i⁄
 == 0) ? "PASS" :

2189 (
¥of
->
gc_a˘i⁄
 == 1) ? "DROP" : "RED";

2190 
	`£q_¥ötf
(
m
, "W1: gc_a˘i⁄\t\t%s\n", 
°r
);

2191 
°r
 = (
¥of
->
yc_a˘i⁄
 == 0) ? "PASS" :

2192 (
¥of
->
yc_a˘i⁄
 == 1) ? "DROP" : "RED";

2193 
	`£q_¥ötf
(
m
, "W1: yc_a˘i⁄\t\t%s\n", 
°r
);

2194 
°r
 = (
¥of
->
rc_a˘i⁄
 == 0) ? "PASS" :

2195 (
¥of
->
rc_a˘i⁄
 == 1) ? "DROP" : "RED";

2196 
	`£q_¥ötf
(
m
, "W1:Ñc_a˘i⁄\t\t%s\n", 
°r
);

2197 
	`£q_¥ötf
(
m
, "W1: mëî_Ægo\t\t%d\n", 
¥of
->
mëî_Ægo
);

2198 
	`£q_¥ötf
(
m
, "W1: b™d_¥of_id\t%d\n", 
¥of
->
b™d_¥of_id
);

2199 
	`£q_¥ötf
(
m
, "W1: hl_í\t\t%d\n", 
¥of
->
hl_í
);

2201 
	`£q_¥ötf
(
m
, "W2:Ås\t\t\t%Œd\n", (
u64
)
¥of
->
ts
);

2202 
	`£q_¥ötf
(
m
, "W3:Öe_accum\t\t%d\n", 
¥of
->
≥_accum
);

2203 
	`£q_¥ötf
(
m
, "W3: c_accum\t\t%d\n", 
¥of
->
c_accum
);

2204 
	`£q_¥ötf
(
m
, "W4: green_pkt_pass\t%lld\n",

2205 (
u64
)
¥of
->
gªí_pkt_∑ss
);

2206 
	`£q_¥ötf
(
m
, "W5: yellow_pkt_pass\t%lld\n",

2207 (
u64
)
¥of
->
yñlow_pkt_∑ss
);

2208 
	`£q_¥ötf
(
m
, "W6:Ñed_pkt_∑ss\t%Œd\n", (
u64
)
¥of
->
ªd_pkt_∑ss
);

2209 
	`£q_¥ötf
(
m
, "W7: green_octs_pass\t%lld\n",

2210 (
u64
)
¥of
->
gªí_o˘s_∑ss
);

2211 
	`£q_¥ötf
(
m
, "W8: yellow_octs_pass\t%lld\n",

2212 (
u64
)
¥of
->
yñlow_o˘s_∑ss
);

2213 
	`£q_¥ötf
(
m
, "W9:Ñed_o˘s_∑ss\t%Œd\n", (
u64
)
¥of
->
ªd_o˘s_∑ss
);

2214 
	`£q_¥ötf
(
m
, "W10: green_pkt_drop\t%lld\n",

2215 (
u64
)
¥of
->
gªí_pkt_dr›
);

2216 
	`£q_¥ötf
(
m
, "W11: yellow_pkt_drop\t%lld\n",

2217 (
u64
)
¥of
->
yñlow_pkt_dr›
);

2218 
	`£q_¥ötf
(
m
, "W12:Ñed_pkt_dr›\t%Œd\n", (
u64
)
¥of
->
ªd_pkt_dr›
);

2219 
	`£q_¥ötf
(
m
, "W13: green_octs_drop\t%lld\n",

2220 (
u64
)
¥of
->
gªí_o˘s_dr›
);

2221 
	`£q_¥ötf
(
m
, "W14: yellow_octs_drop\t%lld\n",

2222 (
u64
)
¥of
->
yñlow_o˘s_dr›
);

2223 
	`£q_¥ötf
(
m
, "W15:Ñed_o˘s_dr›\t%Œd\n", (
u64
)
¥of
->
ªd_o˘s_dr›
);

2224 
	`£q_puts
(
m
, "==============================\n");

2225 
	}
}

2227 
	$rvu_dbg_nix_b™d_¥of_˘x_di•œy
(
£q_fûe
 *
m
, *
unu£d
)

2229 
nix_hw
 *nix_hw = 
m
->
¥iv©e
;

2230 
nix_˙10k_aq_íq_ªq
 
aq_ªq
;

2231 
nix_˙10k_aq_íq_r•
 
aq_r•
;

2232 
rvu
 *rvu = 
nix_hw
->rvu;

2233 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

2234 
œyî
, 
¥of_idx
, 
idx
, 
rc
;

2235 
u16
 
pcifunc
;

2236 *
°r
;

2239 i‡(!
nix_hw
->
ùﬁi˚r
)

2242 
œyî
 = 0;Üayî < 
BAND_PROF_NUM_LAYERS
;Üayer++) {

2243 i‡(
œyî
 =
BAND_PROF_INVAL_LAYER
)

2245 
°r
 = (
œyî
 =
BAND_PROF_LEAF_LAYER
) ? "Leaf" :

2246 (
œyî
 =
BAND_PROF_MID_LAYER
) ? "Mid" : "Top";

2248 
	`£q_¥ötf
(
m
, "\n%†b™dwidthÖrofûes\n", 
°r
);

2249 
	`£q_puts
(
m
, "=======================\n");

2251 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
œyî
];

2253 
idx
 = 0; idx < 
ùﬁi˚r
->
b™d_¥of
.
max
; idx++) {

2254 i‡(
	`is_r§c_‰ì
(&
ùﬁi˚r
->
b™d_¥of
, 
idx
))

2257 
¥of_idx
 = (
idx
 & 0x3FFFË| (
œyî
 << 14);

2258 
rc
 = 
	`nix_aq_c⁄ãxt_ªad
(
rvu
, 
nix_hw
, &
aq_ªq
, &
aq_r•
,

2259 0x00, 
NIX_AQ_CTYPE_BANDPROF
,

2260 
¥of_idx
);

2261 i‡(
rc
) {

2262 
	`dev_îr
(
rvu
->
dev
,

2264 
__func__
, 
°r
, 
idx
, 
rc
);

2267 
	`£q_¥ötf
(
m
, "\n%†b™dwidthÖrofûe:: %d\n", 
°r
, 
idx
);

2268 
pcifunc
 = 
ùﬁi˚r
->
pfvf_m≠
[
idx
];

2269 i‡(!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
))

2270 
	`£q_¥ötf
(
m
, "AllocatedÅo :: PF %d\n",

2271 
	`rvu_gë_pf
(
pcifunc
));

2273 
	`£q_¥ötf
(
m
, "AllocatedÅo :: PF %d VF %d\n",

2274 
	`rvu_gë_pf
(
pcifunc
),

2275 (
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) - 1);

2276 
	`¥öt_b™d_¥of_˘x
(
m
, &
aq_r•
.
¥of
);

2280 
	}
}

2282 
RVU_DEBUG_SEQ_FOPS
(
nix_b™d_¥of_˘x
, 
nix_b™d_¥of_˘x_di•œy
, 
NULL
);

2284 
	$rvu_dbg_nix_b™d_¥of_r§c_di•œy
(
£q_fûe
 *
m
, *
unu£d
)

2286 
nix_hw
 *nix_hw = 
m
->
¥iv©e
;

2287 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

2288 
œyî
;

2289 *
°r
;

2292 i‡(!
nix_hw
->
ùﬁi˚r
)

2295 
	`£q_puts
(
m
, "\nBandwidthÖrofileÑesource free count\n");

2296 
	`£q_puts
(
m
, "=====================================\n");

2297 
œyî
 = 0;Üayî < 
BAND_PROF_NUM_LAYERS
;Üayer++) {

2298 i‡(
œyî
 =
BAND_PROF_INVAL_LAYER
)

2300 
°r
 = (
œyî
 =
BAND_PROF_LEAF_LAYER
) ? "Leaf" :

2301 (
œyî
 =
BAND_PROF_MID_LAYER
) ? "Mid " : "Top ";

2303 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
œyî
];

2304 
	`£q_¥ötf
(
m
, "%†:: Max: %4d Fªe: %4d\n", 
°r
,

2305 
ùﬁi˚r
->
b™d_¥of
.
max
,

2306 
	`rvu_r§c_‰ì_cou¡
(&
ùﬁi˚r
->
b™d_¥of
));

2308 
	`£q_puts
(
m
, "=====================================\n");

2311 
	}
}

2313 
RVU_DEBUG_SEQ_FOPS
(
nix_b™d_¥of_r§c
, 
nix_b™d_¥of_r§c_di•œy
, 
NULL
);

2315 
	$rvu_dbg_nix_öô
(
rvu
 *rvu, 
blkaddr
)

2317 
nix_hw
 *nix_hw;

2319 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

2322 i‡(
blkaddr
 =
BLKADDR_NIX0
) {

2323 
rvu
->
rvu_dbg
.
nix
 = 
	`debugfs_¸óã_dú
("nix",Ñvu->rvu_dbg.
roŸ
);

2324 
nix_hw
 = &
rvu
->
hw
->
nix
[0];

2326 
rvu
->
rvu_dbg
.
nix
 = 
	`debugfs_¸óã_dú
("nix1",

2327 
rvu
->
rvu_dbg
.
roŸ
);

2328 
nix_hw
 = &
rvu
->
hw
->
nix
[1];

2331 
	`debugfs_¸óã_fûe
("sq_˘x", 0600, 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2332 &
rvu_dbg_nix_sq_˘x_f›s
);

2333 
	`debugfs_¸óã_fûe
("rq_˘x", 0600, 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2334 &
rvu_dbg_nix_rq_˘x_f›s
);

2335 
	`debugfs_¸óã_fûe
("cq_˘x", 0600, 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2336 &
rvu_dbg_nix_cq_˘x_f›s
);

2337 
	`debugfs_¸óã_fûe
("ndc_tx_ˇche", 0600, 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2338 &
rvu_dbg_nix_ndc_tx_ˇche_f›s
);

2339 
	`debugfs_¸óã_fûe
("ndc_rx_ˇche", 0600, 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2340 &
rvu_dbg_nix_ndc_rx_ˇche_f›s
);

2341 
	`debugfs_¸óã_fûe
("ndc_tx_hôs_miss", 0600, 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2342 &
rvu_dbg_nix_ndc_tx_hôs_miss_f›s
);

2343 
	`debugfs_¸óã_fûe
("ndc_rx_hôs_miss", 0600, 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2344 &
rvu_dbg_nix_ndc_rx_hôs_miss_f›s
);

2345 
	`debugfs_¸óã_fûe
("qsize", 0600, 
rvu
->
rvu_dbg
.
nix
,Ñvu,

2346 &
rvu_dbg_nix_qsize_f›s
);

2347 
	`debugfs_¸óã_fûe
("ögªss_pﬁi˚r_˘x", 0600, 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2348 &
rvu_dbg_nix_b™d_¥of_˘x_f›s
);

2349 
	`debugfs_¸óã_fûe
("ögªss_pﬁi˚r_r§c", 0600, 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2350 &
rvu_dbg_nix_b™d_¥of_r§c_f›s
);

2351 i‡(
	`is_rvu_96xx_A0
(
rvu
)) {

2352 
	`debugfs_¸óã_fûe
("tx_stall_hwissue", 0600,

2353 
rvu
->
rvu_dbg
.
nix
, 
nix_hw
,

2354 &
rvu_dbg_nix_tx_°Æl_hwissue_f›s
);

2356 
	}
}

2358 
	$rvu_dbg_≈a_öô
(
rvu
 *rvu)

2360 
rvu
->
rvu_dbg
.
≈a
 = 
	`debugfs_¸óã_dú
("≈a",Ñvu->rvu_dbg.
roŸ
);

2362 
	`debugfs_¸óã_fûe
("qsize", 0600, 
rvu
->
rvu_dbg
.
≈a
,Ñvu,

2363 &
rvu_dbg_≈a_qsize_f›s
);

2364 
	`debugfs_¸óã_fûe
("auø_˘x", 0600, 
rvu
->
rvu_dbg
.
≈a
,Ñvu,

2365 &
rvu_dbg_≈a_auø_˘x_f›s
);

2366 
	`debugfs_¸óã_fûe
("poﬁ_˘x", 0600, 
rvu
->
rvu_dbg
.
≈a
,Ñvu,

2367 &
rvu_dbg_≈a_poﬁ_˘x_f›s
);

2368 
	`debugfs_¸óã_fûe
("ndc_ˇche", 0600, 
rvu
->
rvu_dbg
.
≈a
,Ñvu,

2369 &
rvu_dbg_≈a_ndc_ˇche_f›s
);

2370 
	`debugfs_¸óã_fûe
("ndc_hôs_miss", 0600, 
rvu
->
rvu_dbg
.
≈a
,Ñvu,

2371 &
rvu_dbg_≈a_ndc_hôs_miss_f›s
);

2372 
	}
}

2374 
	#PRINT_CGX_CUML_NIXRX_STATUS
(
idx
, 
«me
) \

2376 
u64
 
˙t
; \

2377 
îr
 = 
	`rvu_cgx_nix_cuml_°©s
(
rvu
, 
cgxd
, 
lmac_id
, (
idx
), \

2378 
NIX_STATS_RX
, &(
˙t
)); \

2379 i‡(!
îr
) \

2380 
	`£q_¥ötf
(
s
, "%s: %Œu\n", 
«me
, 
˙t
); \

2381 
˙t
; \

2382 })

	)

2384 
	#PRINT_CGX_CUML_NIXTX_STATUS
(
idx
, 
«me
) \

2386 
u64
 
˙t
; \

2387 
îr
 = 
	`rvu_cgx_nix_cuml_°©s
(
rvu
, 
cgxd
, 
lmac_id
, (
idx
), \

2388 
NIX_STATS_TX
, &(
˙t
)); \

2389 i‡(!
îr
) \

2390 
	`£q_¥ötf
(
s
, "%s: %Œu\n", 
«me
, 
˙t
); \

2391 
˙t
; \

2392 })

	)

2394 
	$cgx_¥öt_°©s
(
£q_fûe
 *
s
, 
lmac_id
)

2396 
cgx_lök_u£r_öfo
 
löfo
;

2397 
cgx_„c_°©s_r•
 
„c_r•
;

2398 
mac_›s
 *mac_ops;

2399 *
cgxd
 = 
s
->
¥iv©e
;

2400 
u64
 
uˇ°
, 
mˇ°
, 
bˇ°
;

2401 
°©
 = 0, 
îr
 = 0;

2402 
u64
 
tx_°©
, 
rx_°©
;

2403 
rvu
 *rvu;

2405 
rvu
 = 
	`pci_gë_drvd©a
(
	`pci_gë_devi˚
(
PCI_VENDOR_ID_CAVIUM
,

2406 
PCI_DEVID_OCTEONTX2_RVU_AF
, 
NULL
));

2407 i‡(!
rvu
)

2408  -
ENODEV
;

2410 
mac_›s
 = 
	`gë_mac_›s
(
cgxd
);

2412 i‡(!
mac_›s
)

2416 
	`£q_puts
(
s
, "\n=======Link Status======\n\n");

2417 
îr
 = 
	`cgx_gë_lök_öfo
(
cgxd
, 
lmac_id
, &
löfo
);

2418 i‡(
îr
)

2419 
	`£q_puts
(
s
, "FailedÅoÑeadÜink status\n");

2420 
	`£q_¥ötf
(
s
, "\nLink is %s %d Mbps\n\n",

2421 
löfo
.
lök_up
 ? "UP" : "DOWN",Üöfo.
•ìd
);

2424 
	`£q_¥ötf
(
s
, "\n=======NIX RX_STATS(%sÖortÜevel)======\n\n",

2425 
mac_›s
->
«me
);

2426 
uˇ°
 = 
	`PRINT_CGX_CUML_NIXRX_STATUS
(
RX_UCAST
, "rx_ucast_frames");

2427 i‡(
îr
)

2428  
îr
;

2429 
mˇ°
 = 
	`PRINT_CGX_CUML_NIXRX_STATUS
(
RX_MCAST
, "rx_mcast_frames");

2430 i‡(
îr
)

2431  
îr
;

2432 
bˇ°
 = 
	`PRINT_CGX_CUML_NIXRX_STATUS
(
RX_BCAST
, "rx_bcast_frames");

2433 i‡(
îr
)

2434  
îr
;

2435 
	`£q_¥ötf
(
s
, "rx_‰ames: %Œu\n", 
uˇ°
 + 
mˇ°
 + 
bˇ°
);

2436 
	`PRINT_CGX_CUML_NIXRX_STATUS
(
RX_OCTS
, "rx_bytes");

2437 i‡(
îr
)

2438  
îr
;

2439 
	`PRINT_CGX_CUML_NIXRX_STATUS
(
RX_DROP
, "rx_drops");

2440 i‡(
îr
)

2441  
îr
;

2442 
	`PRINT_CGX_CUML_NIXRX_STATUS
(
RX_ERR
, "rx_errors");

2443 i‡(
îr
)

2444  
îr
;

2447 
	`£q_¥ötf
(
s
, "\n=======NIX TX_STATS(%sÖortÜevel)======\n\n",

2448 
mac_›s
->
«me
);

2449 
uˇ°
 = 
	`PRINT_CGX_CUML_NIXTX_STATUS
(
TX_UCAST
, "tx_ucast_frames");

2450 i‡(
îr
)

2451  
îr
;

2452 
mˇ°
 = 
	`PRINT_CGX_CUML_NIXTX_STATUS
(
TX_MCAST
, "tx_mcast_frames");

2453 i‡(
îr
)

2454  
îr
;

2455 
bˇ°
 = 
	`PRINT_CGX_CUML_NIXTX_STATUS
(
TX_BCAST
, "tx_bcast_frames");

2456 i‡(
îr
)

2457  
îr
;

2458 
	`£q_¥ötf
(
s
, "tx_‰ames: %Œu\n", 
uˇ°
 + 
mˇ°
 + 
bˇ°
);

2459 
	`PRINT_CGX_CUML_NIXTX_STATUS
(
TX_OCTS
, "tx_bytes");

2460 i‡(
îr
)

2461  
îr
;

2462 
	`PRINT_CGX_CUML_NIXTX_STATUS
(
TX_DROP
, "tx_drops");

2463 i‡(
îr
)

2464  
îr
;

2467 
	`£q_¥ötf
(
s
, "\n=======%†RX_STATS======\n\n", 
mac_›s
->
«me
);

2468 
°©
 < 
mac_›s
->
rx_°©s_˙t
) {

2469 
îr
 = 
mac_›s
->
	`mac_gë_rx_°©s
(
cgxd
, 
lmac_id
, 
°©
, &
rx_°©
);

2470 i‡(
îr
)

2471  
îr
;

2472 i‡(
	`is_rvu_Ÿx2
(
rvu
))

2473 
	`£q_¥ötf
(
s
, "%s: %Œu\n", 
cgx_rx_°©s_fõlds
[
°©
],

2474 
rx_°©
);

2476 
	`£q_¥ötf
(
s
, "%s: %Œu\n", 
Ωm_rx_°©s_fõlds
[
°©
],

2477 
rx_°©
);

2478 
°©
++;

2482 
°©
 = 0;

2483 
	`£q_¥ötf
(
s
, "\n=======%†TX_STATS======\n\n", 
mac_›s
->
«me
);

2484 
°©
 < 
mac_›s
->
tx_°©s_˙t
) {

2485 
îr
 = 
mac_›s
->
	`mac_gë_tx_°©s
(
cgxd
, 
lmac_id
, 
°©
, &
tx_°©
);

2486 i‡(
îr
)

2487  
îr
;

2489 i‡(
	`is_rvu_Ÿx2
(
rvu
))

2490 
	`£q_¥ötf
(
s
, "%s: %Œu\n", 
cgx_tx_°©s_fõlds
[
°©
],

2491 
tx_°©
);

2493 
	`£q_¥ötf
(
s
, "%s: %Œu\n", 
Ωm_tx_°©s_fõlds
[
°©
],

2494 
tx_°©
);

2495 
°©
++;

2498 
„c_r•
.
„c_c‹r_blks
 = 0;

2499 
„c_r•
.
„c_unc‹r_blks
 = 0;

2501 
	`£q_¥ötf
(
s
, "\n=======%†FEC_STATS======\n\n", 
mac_›s
->
«me
);

2502 
îr
 = 
mac_›s
->
	`gë_„c_°©s
(
cgxd
, 
lmac_id
, &
„c_r•
);

2503 i‡(
îr
)

2504  
îr
;

2505 
	`£q_¥ötf
(
s
, "Fe¯C‹ª˘ed Eº‹s: %Œu\n", 
„c_r•
.
„c_c‹r_blks
);

2506 
	`£q_¥ötf
(
s
, "Fe¯Unc‹ª˘ed Eº‹s: %Œu\n", 
„c_r•
.
„c_unc‹r_blks
);

2508  
îr
;

2509 
	}
}

2511 
	$rvu_dbg_dîive_lmacid
(
£q_fûe
 *
fûp
, *
lmac_id
)

2513 
díåy
 *
cuºít_dú
;

2514 *
buf
;

2516 
cuºít_dú
 = 
fûp
->
fûe
->
f_∑th
.
díåy
->
d_∑ª¡
;

2517 
buf
 = 
	`°ºchr
(
cuºít_dú
->
d_«me
.
«me
, 'c');

2518 i‡(!
buf
)

2519  -
EINVAL
;

2521  
	`k°πoöt
(
buf
 + 1, 10, 
lmac_id
);

2522 
	}
}

2524 
	$rvu_dbg_cgx_°©_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

2526 
lmac_id
, 
îr
;

2528 
îr
 = 
	`rvu_dbg_dîive_lmacid
(
fûp
, &
lmac_id
);

2529 i‡(!
îr
)

2530  
	`cgx_¥öt_°©s
(
fûp
, 
lmac_id
);

2532  
îr
;

2533 
	}
}

2535 
RVU_DEBUG_SEQ_FOPS
(
cgx_°©
, 
cgx_°©_di•œy
, 
NULL
);

2537 
	$cgx_¥öt_dmac_Êt
(
£q_fûe
 *
s
, 
lmac_id
)

2539 
pci_dev
 *
pdev
 = 
NULL
;

2540 *
cgxd
 = 
s
->
¥iv©e
;

2541 *
bˇ°
, *
mˇ°
;

2542 
u16
 
ödex
, 
domaö
;

2543 
u8
 
dmac
[
ETH_ALEN
];

2544 
rvu
 *rvu;

2545 
u64
 
cfg
, 
mac
;

2546 
pf
;

2548 
rvu
 = 
	`pci_gë_drvd©a
(
	`pci_gë_devi˚
(
PCI_VENDOR_ID_CAVIUM
,

2549 
PCI_DEVID_OCTEONTX2_RVU_AF
, 
NULL
));

2550 i‡(!
rvu
)

2551  -
ENODEV
;

2553 
pf
 = 
	`cgxlmac_to_pf
(
rvu
, 
	`cgx_gë_cgxid
(
cgxd
), 
lmac_id
);

2554 
domaö
 = 2;

2556 
pdev
 = 
	`pci_gë_domaö_bus_™d_¶Ÿ
(
domaö
, 
pf
 + 1, 0);

2557 i‡(!
pdev
)

2560 
cfg
 = 
	`cgx_ªad_dmac_˘æ
(
cgxd
, 
lmac_id
);

2561 
bˇ°
 = 
cfg
 & 
CGX_DMAC_BCAST_MODE
 ? "ACCEPT" : "REJECT";

2562 
mˇ°
 = 
cfg
 & 
CGX_DMAC_MCAST_MODE
 ? "ACCEPT" : "REJECT";

2564 
	`£q_puts
(
s
,

2566 
	`£q_¥ötf
(
s
, "%s PF%d %9s %9s",

2567 
	`dev_«me
(&
pdev
->
dev
), 
pf
, 
bˇ°
, 
mˇ°
);

2568 i‡(
cfg
 & 
CGX_DMAC_CAM_ACCEPT
)

2569 
	`£q_¥ötf
(
s
, "%12s\n\n", "UNICAST");

2571 
	`£q_¥ötf
(
s
, "%16s\n\n", "PROMISCUOUS");

2573 
	`£q_puts
(
s
, "\nDMAC-INDEX ADDRESS\n");

2575 
ödex
 = 0 ; index < 32 ; index++) {

2576 
cfg
 = 
	`cgx_ªad_dmac_íåy
(
cgxd
, 
ödex
);

2578 i‡(
lmac_id
 =
	`FIELD_GET
(
CGX_DMAC_CAM_ENTRY_LMACID
, 
cfg
) &&

2579 
	`FIELD_GET
(
CGX_DMAC_CAM_ADDR_ENABLE
, 
cfg
)) {

2580 
mac
 = 
	`FIELD_GET
(
CGX_RX_DMAC_ADR_MASK
, 
cfg
);

2581 
	`u64_to_ëhî_addr
(
mac
, 
dmac
);

2582 
	`£q_¥ötf
(
s
, "%7d %pM\n", 
ödex
, 
dmac
);

2586 
	`£q_¥ötf
(
s
, "\nDMAC filter drop count: %lld\n",

2587 
	`rvu_cgx_gë_dmacÊt_dr›≥d_pkt˙t
(
cgxd
, 
lmac_id
));

2590 
	}
}

2592 
	$rvu_dbg_cgx_dmac_Êt_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

2594 
îr
, 
lmac_id
;

2596 
îr
 = 
	`rvu_dbg_dîive_lmacid
(
fûp
, &
lmac_id
);

2597 i‡(!
îr
)

2598  
	`cgx_¥öt_dmac_Êt
(
fûp
, 
lmac_id
);

2600  
îr
;

2601 
	}
}

2603 
RVU_DEBUG_SEQ_FOPS
(
cgx_dmac_Êt
, 
cgx_dmac_Êt_di•œy
, 
NULL
);

2605 
	$rvu_dbg_cgx_öô
(
rvu
 *rvu)

2607 
mac_›s
 *mac_ops;

2608 
lmac_bm≠
;

2609 
i
, 
lmac_id
;

2610 
d«me
[20];

2611 *
cgx
;

2613 i‡(!
	`cgx_gë_cgx˙t_max
())

2616 
mac_›s
 = 
	`gë_mac_›s
(
	`rvu_fú°_cgx_pd©a
(
rvu
));

2617 i‡(!
mac_›s
)

2620 
rvu
->
rvu_dbg
.
cgx_roŸ
 = 
	`debugfs_¸óã_dú
(
mac_›s
->
«me
,

2621 
rvu
->
rvu_dbg
.
roŸ
);

2623 
i
 = 0; i < 
	`cgx_gë_cgx˙t_max
(); i++) {

2624 
cgx
 = 
	`rvu_cgx_pd©a
(
i
, 
rvu
);

2625 i‡(!
cgx
)

2627 
lmac_bm≠
 = 
	`cgx_gë_lmac_bm≠
(
cgx
);

2629 
	`•rötf
(
d«me
, "%s%d", 
mac_›s
->
«me
, 
i
);

2630 
rvu
->
rvu_dbg
.
cgx
 = 
	`debugfs_¸óã_dú
(
d«me
,

2631 
rvu
->
rvu_dbg
.
cgx_roŸ
);

2633 
	`f‹_óch_£t_bô
(
lmac_id
, &
lmac_bm≠
, 
rvu
->
hw
->
lmac_≥r_cgx
) {

2635 
	`•rötf
(
d«me
, "lmac%d", 
lmac_id
);

2636 
rvu
->
rvu_dbg
.
lmac
 =

2637 
	`debugfs_¸óã_dú
(
d«me
, 
rvu
->
rvu_dbg
.
cgx
);

2639 
	`debugfs_¸óã_fûe
("°©s", 0600, 
rvu
->
rvu_dbg
.
lmac
,

2640 
cgx
, &
rvu_dbg_cgx_°©_f›s
);

2641 
	`debugfs_¸óã_fûe
("mac_filter", 0600,

2642 
rvu
->
rvu_dbg
.
lmac
, 
cgx
,

2643 &
rvu_dbg_cgx_dmac_Êt_f›s
);

2646 
	}
}

2649 
	$rvu_¥öt_≈c_mˇm_öfo
(
£q_fûe
 *
s
,

2650 
u16
 
pcifunc
, 
blkaddr
)

2652 
rvu
 *rvu = 
s
->
¥iv©e
;

2653 
íåy_a˙t
, 
íåy_e˙t
;

2654 
˙å_a˙t
, 
˙å_e˙t
;

2656 
	`rvu_≈c_gë_mˇm_íåy_Æloc_öfo
(
rvu
, 
pcifunc
, 
blkaddr
,

2657 &
íåy_a˙t
, &
íåy_e˙t
);

2658 
	`rvu_≈c_gë_mˇm_cou¡î_Æloc_öfo
(
rvu
, 
pcifunc
, 
blkaddr
,

2659 &
˙å_a˙t
, &
˙å_e˙t
);

2660 i‡(!
íåy_a˙t
 && !
˙å_a˙t
)

2663 i‡(!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
))

2664 
	`£q_¥ötf
(
s
, "\n\t\t Device \t\t: PF%d\n",

2665 
	`rvu_gë_pf
(
pcifunc
));

2667 
	`£q_¥ötf
(
s
, "\n\t\t Device \t\t: PF%d VF%d\n",

2668 
	`rvu_gë_pf
(
pcifunc
),

2669 (
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) - 1);

2671 i‡(
íåy_a˙t
) {

2672 
	`£q_¥ötf
(
s
, "\t\àE¡rõ†Æloˇãd \t: %d\n", 
íåy_a˙t
);

2673 
	`£q_¥ötf
(
s
, "\t\àE¡rõ†íabÀd \t: %d\n", 
íåy_e˙t
);

2675 i‡(
˙å_a˙t
) {

2676 
	`£q_¥ötf
(
s
, "\t\àCou¡î†Æloˇãd \t: %d\n", 
˙å_a˙t
);

2677 
	`£q_¥ötf
(
s
, "\t\àCou¡î†íabÀd \t: %d\n", 
˙å_e˙t
);

2679 
	}
}

2681 
	$rvu_dbg_≈c_mˇm_öfo_di•œy
(
£q_fûe
 *
fûp
, *
unsued
)

2683 
rvu
 *rvu = 
fûp
->
¥iv©e
;

2684 
pf
, 
vf
, 
numvfs
, 
blkaddr
;

2685 
≈c_mˇm
 *
mˇm
;

2686 
u16
 
pcifunc
, 
cou¡îs
;

2687 
u64
 
cfg
;

2689 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2690 i‡(
blkaddr
 < 0)

2691  -
ENODEV
;

2693 
mˇm
 = &
rvu
->
hw
->mcam;

2694 
cou¡îs
 = 
rvu
->
hw
->
≈c_cou¡îs
;

2696 
	`£q_puts
(
fûp
, "\nNPC MCAM info:\n");

2698 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_KEX_CFG
(
NIX_INTF_RX
));

2699 
cfg
 = (cfg >> 32) & 0x07;

2700 
	`£q_¥ötf
(
fûp
, "\t\àRX keywidth \t: %s\n", (
cfg
 =
NPC_MCAM_KEY_X1
) ?

2701 "112bôs" : ((
cfg
 =
NPC_MCAM_KEY_X2
) ?

2703 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_KEX_CFG
(
NIX_INTF_TX
));

2704 
cfg
 = (cfg >> 32) & 0x07;

2705 
	`£q_¥ötf
(
fûp
, "\t\àTX keywidth \t: %s\n", (
cfg
 =
NPC_MCAM_KEY_X1
) ?

2706 "112bôs" : ((
cfg
 =
NPC_MCAM_KEY_X2
) ?

2709 
	`muãx_lock
(&
mˇm
->
lock
);

2711 
	`£q_¥ötf
(
fûp
, "\n\t\àMCAMÉ¡rõ†\t: %d\n", 
mˇm
->
tŸÆ_íåõs
);

2712 
	`£q_¥ötf
(
fûp
, "\t\t Reserved \t: %d\n",

2713 
mˇm
->
tŸÆ_íåõs
 - mˇm->
bm≠_íåõs
);

2714 
	`£q_¥ötf
(
fûp
, "\t\àAvaûabÀ \t: %d\n", 
mˇm
->
bm≠_f˙t
);

2717 
	`£q_¥ötf
(
fûp
, "\n\t\àMCAM cou¡î†\t: %d\n", 
cou¡îs
);

2718 
	`£q_¥ötf
(
fûp
, "\t\t Reserved \t: %d\n",

2719 
cou¡îs
 - 
mˇm
->cou¡îs.
max
);

2720 
	`£q_¥ötf
(
fûp
, "\t\t Available \t: %d\n",

2721 
	`rvu_r§c_‰ì_cou¡
(&
mˇm
->
cou¡îs
));

2723 i‡(
mˇm
->
bm≠_íåõs
 =mˇm->
bm≠_f˙t
) {

2724 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2728 
	`£q_puts
(
fûp
, "\n\t\t Currentállocation\n");

2729 
	`£q_puts
(
fûp
, "\t\t====================\n");

2730 
pf
 = 0;Ö‡< 
rvu
->
hw
->
tŸÆ_pfs
;Öf++) {

2731 
pcifunc
 = (
pf
 << 
RVU_PFVF_PF_SHIFT
);

2732 
	`rvu_¥öt_≈c_mˇm_öfo
(
fûp
, 
pcifunc
, 
blkaddr
);

2734 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
pf
));

2735 
numvfs
 = (
cfg
 >> 12) & 0xFF;

2736 
vf
 = 0; v‡< 
numvfs
; vf++) {

2737 
pcifunc
 = (
pf
 << 
RVU_PFVF_PF_SHIFT
Ë| (
vf
 + 1);

2738 
	`rvu_¥öt_≈c_mˇm_öfo
(
fûp
, 
pcifunc
, 
blkaddr
);

2742 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2744 
	}
}

2746 
RVU_DEBUG_SEQ_FOPS
(
≈c_mˇm_öfo
, 
≈c_mˇm_öfo_di•œy
, 
NULL
);

2748 
	$rvu_dbg_≈c_rx_miss_°©s_di•œy
(
£q_fûe
 *
fûp
,

2749 *
unu£d
)

2751 
rvu
 *rvu = 
fûp
->
¥iv©e
;

2752 
≈c_mˇm
 *
mˇm
;

2753 
blkaddr
;

2755 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2756 i‡(
blkaddr
 < 0)

2757  -
ENODEV
;

2759 
mˇm
 = &
rvu
->
hw
->mcam;

2761 
	`£q_puts
(
fûp
, "\nNPC MCAM RX missáction stats\n");

2762 
	`£q_¥ötf
(
fûp
, "\t\tSèà%d: \t%Œd\n", 
mˇm
->
rx_miss_a˘_˙å
,

2763 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

2764 
	`NPC_AF_MATCH_STATX
(
mˇm
->
rx_miss_a˘_˙å
)));

2767 
	}
}

2769 
RVU_DEBUG_SEQ_FOPS
(
≈c_rx_miss_a˘
, 
≈c_rx_miss_°©s_di•œy
, 
NULL
);

2771 
	$rvu_dbg_≈c_mˇm_show_Êows
(
£q_fûe
 *
s
,

2772 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
)

2774 
u8
 
bô
;

2776 
	`f‹_óch_£t_bô
(
bô
, (*)&
ruÀ
->
„©uªs
, 64) {

2777 
	`£q_¥ötf
(
s
, "\t%† ", 
	`≈c_gë_fõld_«me
(
bô
));

2778 
bô
) {

2779 
NPC_LXMB
:

2780 i‡(
ruÀ
->
lxmb
 == 1)

2781 
	`£q_puts
(
s
, "\tL2MÇibble is set\n");

2783 
	`£q_puts
(
s
, "\tL2BÇibble is set\n");

2785 
NPC_DMAC
:

2786 
	`£q_¥ötf
(
s
, "%pM ", 
ruÀ
->
∑ckë
.
dmac
);

2787 
	`£q_¥ötf
(
s
, "mask %pM\n", 
ruÀ
->
mask
.
dmac
);

2789 
NPC_SMAC
:

2790 
	`£q_¥ötf
(
s
, "%pM ", 
ruÀ
->
∑ckë
.
smac
);

2791 
	`£q_¥ötf
(
s
, "mask %pM\n", 
ruÀ
->
mask
.
smac
);

2793 
NPC_ETYPE
:

2794 
	`£q_¥ötf
(
s
, "0x%x ", 
	`¡ohs
(
ruÀ
->
∑ckë
.
ëy≥
));

2795 
	`£q_¥ötf
(
s
, "mask 0x%x\n", 
	`¡ohs
(
ruÀ
->
mask
.
ëy≥
));

2797 
NPC_OUTER_VID
:

2798 
NPC_FDSA_VAL
:

2799 
	`£q_¥ötf
(
s
, "0x%x ", 
	`¡ohs
(
ruÀ
->
∑ckë
.
vœn_tci
));

2800 
	`£q_¥ötf
(
s
, "mask 0x%x\n",

2801 
	`¡ohs
(
ruÀ
->
mask
.
vœn_tci
));

2803 
NPC_TOS
:

2804 
	`£q_¥ötf
(
s
, "%d ", 
ruÀ
->
∑ckë
.
tos
);

2805 
	`£q_¥ötf
(
s
, "mask 0x%x\n", 
ruÀ
->
mask
.
tos
);

2807 
NPC_SIP_IPV4
:

2808 
	`£q_¥ötf
(
s
, "%pI4 ", &
ruÀ
->
∑ckë
.
ù4§c
);

2809 
	`£q_¥ötf
(
s
, "mask %pI4\n", &
ruÀ
->
mask
.
ù4§c
);

2811 
NPC_DIP_IPV4
:

2812 
	`£q_¥ötf
(
s
, "%pI4 ", &
ruÀ
->
∑ckë
.
ù4d°
);

2813 
	`£q_¥ötf
(
s
, "mask %pI4\n", &
ruÀ
->
mask
.
ù4d°
);

2815 
NPC_SIP_IPV6
:

2816 
	`£q_¥ötf
(
s
, "%pI6 ", 
ruÀ
->
∑ckë
.
ù6§c
);

2817 
	`£q_¥ötf
(
s
, "mask %pI6\n", 
ruÀ
->
mask
.
ù6§c
);

2819 
NPC_DIP_IPV6
:

2820 
	`£q_¥ötf
(
s
, "%pI6 ", 
ruÀ
->
∑ckë
.
ù6d°
);

2821 
	`£q_¥ötf
(
s
, "mask %pI6\n", 
ruÀ
->
mask
.
ù6d°
);

2823 
NPC_IPFRAG_IPV6
:

2824 
	`£q_¥ötf
(
s
, "%d ", 
ruÀ
->
∑ckë
.
√xt_hódî
);

2825 
	`£q_¥ötf
(
s
, "mask 0x%x\n", 
ruÀ
->
mask
.
√xt_hódî
);

2827 
NPC_IPFRAG_IPV4
:

2828 
	`£q_¥ötf
(
s
, "%d ", 
ruÀ
->
∑ckë
.
ù_Êag
);

2829 
	`£q_¥ötf
(
s
, "mask 0x%x\n", 
ruÀ
->
mask
.
ù_Êag
);

2831 
NPC_SPORT_TCP
:

2832 
NPC_SPORT_UDP
:

2833 
NPC_SPORT_SCTP
:

2834 
	`£q_¥ötf
(
s
, "%d ", 
	`¡ohs
(
ruÀ
->
∑ckë
.
•‹t
));

2835 
	`£q_¥ötf
(
s
, "mask 0x%x\n", 
	`¡ohs
(
ruÀ
->
mask
.
•‹t
));

2837 
NPC_DPORT_TCP
:

2838 
NPC_DPORT_UDP
:

2839 
NPC_DPORT_SCTP
:

2840 
	`£q_¥ötf
(
s
, "%d ", 
	`¡ohs
(
ruÀ
->
∑ckë
.
dp‹t
));

2841 
	`£q_¥ötf
(
s
, "mask 0x%x\n", 
	`¡ohs
(
ruÀ
->
mask
.
dp‹t
));

2844 
	`£q_puts
(
s
, "\n");

2848 
	}
}

2850 
	$rvu_dbg_≈c_mˇm_show_a˘i⁄
(
£q_fûe
 *
s
,

2851 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
)

2853 i‡(
	`is_≈c_ötf_tx
(
ruÀ
->
ötf
)) {

2854 
ruÀ
->
tx_a˘i⁄
.
›
) {

2855 
NIX_TX_ACTIONOP_DROP
:

2856 
	`£q_puts
(
s
, "\taction: Drop\n");

2858 
NIX_TX_ACTIONOP_UCAST_DEFAULT
:

2859 
	`£q_puts
(
s
, "\taction: UnicastÅo default channel\n");

2861 
NIX_TX_ACTIONOP_UCAST_CHAN
:

2862 
	`£q_¥ötf
(
s
, "\taction: UnicastÅo channel %d\n",

2863 
ruÀ
->
tx_a˘i⁄
.
ödex
);

2865 
NIX_TX_ACTIONOP_MCAST
:

2866 
	`£q_puts
(
s
, "\taction: Multicast\n");

2868 
NIX_TX_ACTIONOP_DROP_VIOL
:

2869 
	`£q_puts
(
s
, "\taction: Lockdown Violation Drop\n");

2875 
ruÀ
->
rx_a˘i⁄
.
›
) {

2876 
NIX_RX_ACTIONOP_DROP
:

2877 
	`£q_puts
(
s
, "\taction: Drop\n");

2879 
NIX_RX_ACTIONOP_UCAST
:

2880 
	`£q_¥ötf
(
s
, "\taction: DirectÅo queue %d\n",

2881 
ruÀ
->
rx_a˘i⁄
.
ödex
);

2883 
NIX_RX_ACTIONOP_RSS
:

2884 
	`£q_puts
(
s
, "\taction: RSS\n");

2886 
NIX_RX_ACTIONOP_UCAST_IPSEC
:

2887 
	`£q_puts
(
s
, "\taction: Unicast ipsec\n");

2889 
NIX_RX_ACTIONOP_MCAST
:

2890 
	`£q_puts
(
s
, "\taction: Multicast\n");

2896 
	}
}

2898 c⁄° *
	$rvu_dbg_gë_ötf_«me
(
ötf
)

2900 
ötf
) {

2901 
	`NIX_INTFX_RX
(0):

2903 
	`NIX_INTFX_RX
(1):

2905 
	`NIX_INTFX_TX
(0):

2907 
	`NIX_INTFX_TX
(1):

2914 
	}
}

2916 
	$rvu_dbg_≈c_mˇm_show_ruÀs
(
£q_fûe
 *
s
, *
unu£d
)

2918 
rvu_≈c_mˇm_ruÀ
 *
ôî
;

2919 
rvu
 *rvu = 
s
->
¥iv©e
;

2920 
≈c_mˇm
 *
mˇm
;

2921 
pf
, 
vf
 = -1;

2922 
boﬁ
 
íabÀd
;

2923 
blkaddr
;

2924 
u16
 
èrgë
;

2925 
u64
 
hôs
;

2927 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2928 i‡(
blkaddr
 < 0)

2931 
mˇm
 = &
rvu
->
hw
->mcam;

2933 
	`muãx_lock
(&
mˇm
->
lock
);

2934 
	`li°_f‹_óch_íåy
(
ôî
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

2935 
pf
 = (
ôî
->
ow√r
 >> 
RVU_PFVF_PF_SHIFT
Ë& 
RVU_PFVF_PF_MASK
;

2936 
	`£q_¥ötf
(
s
, "\n\tIn°ÆÀd by: PF%d ", 
pf
);

2938 i‡(
ôî
->
ow√r
 & 
RVU_PFVF_FUNC_MASK
) {

2939 
vf
 = (
ôî
->
ow√r
 & 
RVU_PFVF_FUNC_MASK
) - 1;

2940 
	`£q_¥ötf
(
s
, "VF%d", 
vf
);

2942 
	`£q_puts
(
s
, "\n");

2944 
	`£q_¥ötf
(
s
, "\tdúe˘i⁄: %s\n", 
	`is_≈c_ötf_rx
(
ôî
->
ötf
) ?

2946 
	`£q_¥ötf
(
s
, "\tinterface: %s\n",

2947 
	`rvu_dbg_gë_ötf_«me
(
ôî
->
ötf
));

2948 
	`£q_¥ötf
(
s
, "\tmˇmÉ¡ry: %d\n", 
ôî
->
íåy
);

2950 
	`rvu_dbg_≈c_mˇm_show_Êows
(
s
, 
ôî
);

2951 i‡(
	`is_≈c_ötf_rx
(
ôî
->
ötf
)) {

2952 
èrgë
 = 
ôî
->
rx_a˘i⁄
.
pf_func
;

2953 
pf
 = (
èrgë
 >> 
RVU_PFVF_PF_SHIFT
Ë& 
RVU_PFVF_PF_MASK
;

2954 
	`£q_¥ötf
(
s
, "\tF‹w¨dÅo: PF%d ", 
pf
);

2956 i‡(
èrgë
 & 
RVU_PFVF_FUNC_MASK
) {

2957 
vf
 = (
èrgë
 & 
RVU_PFVF_FUNC_MASK
) - 1;

2958 
	`£q_¥ötf
(
s
, "VF%d", 
vf
);

2960 
	`£q_puts
(
s
, "\n");

2961 
	`£q_¥ötf
(
s
, "\tch™√l: 0x%x\n", 
ôî
->
ch™
);

2962 
	`£q_¥ötf
(
s
, "\tch™√l_mask: 0x%x\n", 
ôî
->
ch™_mask
);

2965 
	`rvu_dbg_≈c_mˇm_show_a˘i⁄
(
s
, 
ôî
);

2967 
íabÀd
 = 
	`is_mˇm_íåy_íabÀd
(
rvu
, 
mˇm
, 
blkaddr
, 
ôî
->
íåy
);

2968 
	`£q_¥ötf
(
s
, "\ã«bÀd: %s\n", 
íabÀd
 ? "yes" : "no");

2970 i‡(!
ôî
->
has_˙å
)

2972 
	`£q_¥ötf
(
s
, "\tcou¡î: %d\n", 
ôî
->
˙å
);

2974 
hôs
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_MATCH_STATX
(
ôî
->
˙å
));

2975 
	`£q_¥ötf
(
s
, "\thôs: %Œd\n", 
hôs
);

2977 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2980 
	}
}

2982 
RVU_DEBUG_SEQ_FOPS
(
≈c_mˇm_ruÀs
, 
≈c_mˇm_show_ruÀs
, 
NULL
);

2984 
	$rvu_dbg_≈c_exa˘_show_íåõs
(
£q_fûe
 *
s
, *
unu£d
)

2986 
≈c_exa˘_èbÀ_íåy
 *
mem_íåy
[
NPC_EXACT_TBL_MAX_WAYS
] = { 0 };

2987 
≈c_exa˘_èbÀ_íåy
 *
ˇm_íåy
;

2988 
≈c_exa˘_èbÀ
 *
èbÀ
;

2989 
rvu
 *rvu = 
s
->
¥iv©e
;

2990 
i
, 
j
;

2992 
u8
 
bôm≠
 = 0;

2994 
èbÀ
 = 
rvu
->
hw
->table;

2996 
	`muãx_lock
(&
èbÀ
->
lock
);

2999 i‡(!
èbÀ
->
mem_tbl_íåy_˙t
)

3000 
dump_ˇm_èbÀ
;

3003 
	`£q_puts
(
s
, "\n\tExact Match MEM Table\n");

3004 
	`£q_puts
(
s
, "Index\t");

3006 
i
 = 0; i < 
èbÀ
->
mem_èbÀ
.
ways
; i++) {

3007 
mem_íåy
[
i
] = 
	`li°_fú°_íåy_‹_nuŒ
(&
èbÀ
->
lhód_mem_tbl_íåy
[i],

3008 
≈c_exa˘_èbÀ_íåy
, 
li°
);

3010 
	`£q_¥ötf
(
s
, "Way-%d\t\t\t\t\t", 
i
);

3013 
	`£q_puts
(
s
, "\n");

3014 
i
 = 0; i < 
èbÀ
->
mem_èbÀ
.
ways
; i++)

3015 
	`£q_puts
(
s
, "\tChan MAC \t");

3017 
	`£q_puts
(
s
, "\n\n");

3020 
i
 = 0; i < 
èbÀ
->
mem_èbÀ
.
dïth
; i++) {

3021 
bôm≠
 = 0;

3022 
j
 = 0; j < 
èbÀ
->
mem_èbÀ
.
ways
; j++) {

3023 i‡(!
mem_íåy
[
j
])

3026 i‡(
mem_íåy
[
j
]->
ödex
 !
i
)

3029 
bôm≠
 |
	`BIT
(
j
);

3033 i‡(!
bôm≠
)

3036 
	`£q_¥ötf
(
s
, "%d\t", 
i
);

3037 
j
 = 0; j < 
èbÀ
->
mem_èbÀ
.
ways
; j++) {

3038 i‡(!(
bôm≠
 & 
	`BIT
(
j
))) {

3039 
	`£q_puts
(
s
, "nil\t\t\t\t\t");

3043 
	`£q_¥ötf
(
s
, "0x%x %pM\t\t\t", 
mem_íåy
[
j
]->
ch™
,

3044 
mem_íåy
[
j
]->
mac
);

3045 
mem_íåy
[
j
] = 
	`li°_√xt_íåy
(mem_íåy[j], 
li°
);

3047 
	`£q_puts
(
s
, "\n");

3050 
dump_ˇm_èbÀ
:

3052 i‡(!
èbÀ
->
ˇm_tbl_íåy_˙t
)

3053 
d⁄e
;

3055 
	`£q_puts
(
s
, "\n\tExact Match CAM Table\n");

3056 
	`£q_puts
(
s
, "index\tchan\tMAC\n");

3059 
	`li°_f‹_óch_íåy
(
ˇm_íåy
, &
èbÀ
->
lhód_ˇm_tbl_íåy
, 
li°
) {

3060 
	`£q_¥ötf
(
s
, "%d\t0x%x\t%pM\n", 
ˇm_íåy
->
ödex
, cam_íåy->
ch™
,

3061 
ˇm_íåy
->
mac
);

3064 
d⁄e
:

3065 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

3067 
	}
}

3069 
RVU_DEBUG_SEQ_FOPS
(
≈c_exa˘_íåõs
, 
≈c_exa˘_show_íåõs
, 
NULL
);

3071 
	$rvu_dbg_≈c_exa˘_show_öfo
(
£q_fûe
 *
s
, *
unu£d
)

3073 
≈c_exa˘_èbÀ
 *
èbÀ
;

3074 
rvu
 *rvu = 
s
->
¥iv©e
;

3075 
i
;

3077 
èbÀ
 = 
rvu
->
hw
->table;

3079 
	`£q_puts
(
s
, "\n\tExact Table Info\n");

3080 
	`£q_¥ötf
(
s
, "Exact Match Feature : %s\n",

3081 
rvu
->
hw
->
ˇp
.
≈c_exa˘_m©ch_íabÀd
 ? "enabled" : "disable");

3082 i‡(!
rvu
->
hw
->
ˇp
.
≈c_exa˘_m©ch_íabÀd
)

3085 
	`£q_puts
(
s
, "\nMCAM Index\tMAC Filter Rules Count\n");

3086 
i
 = 0; i < 
èbÀ
->
num_dr›_ruÀs
; i++)

3087 
	`£q_¥ötf
(
s
, "%d\t\t%d\n", 
i
, 
èbÀ
->
˙t_cmd_ruÀs
[i]);

3089 
	`£q_puts
(
s
, "\nMcam Index\tPromisc Mode Status\n");

3090 
i
 = 0; i < 
èbÀ
->
num_dr›_ruÀs
; i++)

3091 
	`£q_¥ötf
(
s
, "%d\t\t%s\n", 
i
, 
èbÀ
->
¥omisc_mode
[i] ? "on" : "off");

3093 
	`£q_puts
(
s
, "\n\tMEM Table Info\n");

3094 
	`£q_¥ötf
(
s
, "Way†: %d\n", 
èbÀ
->
mem_èbÀ
.
ways
);

3095 
	`£q_¥ötf
(
s
, "Dïth : %d\n", 
èbÀ
->
mem_èbÀ
.
dïth
);

3096 
	`£q_¥ötf
(
s
, "Mask : 0x%Œx\n", 
èbÀ
->
mem_èbÀ
.
mask
);

3097 
	`£q_¥ötf
(
s
, "Hash Mask : 0x%x\n", 
èbÀ
->
mem_èbÀ
.
hash_mask
);

3098 
	`£q_¥ötf
(
s
, "Hash Off£à: 0x%x\n", 
èbÀ
->
mem_èbÀ
.
hash_off£t
);

3100 
	`£q_puts
(
s
, "\n\tCAM Table Info\n");

3101 
	`£q_¥ötf
(
s
, "Dïth : %d\n", 
èbÀ
->
ˇm_èbÀ
.
dïth
);

3104 
	}
}

3106 
RVU_DEBUG_SEQ_FOPS
(
≈c_exa˘_öfo
, 
≈c_exa˘_show_öfo
, 
NULL
);

3108 
	$rvu_dbg_≈c_exa˘_dr›_˙t
(
£q_fûe
 *
s
, *
unu£d
)

3110 
≈c_exa˘_èbÀ
 *
èbÀ
;

3111 
rvu
 *rvu = 
s
->
¥iv©e
;

3112 
≈c_key_fõld
 *
fõld
;

3113 
u16
 
ch™
, 
pcifunc
;

3114 
blkaddr
, 
i
;

3115 
u64
 
cfg
, 
ˇm1
;

3116 *
°r
;

3118 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

3119 
èbÀ
 = 
rvu
->
hw
->table;

3121 
fõld
 = &
rvu
->
hw
->
mˇm
.
rx_key_fõlds
[
NPC_CHAN
];

3123 
	`£q_puts
(
s
, "\n\t Exact Hit on drop status\n");

3124 
	`£q_puts
(
s
, "\npcifunc\tmcam_idx\tHits\tchan\tstatus\n");

3126 
i
 = 0; i < 
èbÀ
->
num_dr›_ruÀs
; i++) {

3127 
pcifunc
 = 
	`rvu_≈c_exa˘_dr›_ruÀ_to_pcifunc
(
rvu
, 
i
);

3128 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_MCAMEX_BANKX_CFG
(
i
, 0));

3131 
ˇm1
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3132 
	`NPC_AF_MCAMEX_BANKX_CAMX_W0
(
i
, 0, 1));

3133 
ch™
 = 
fõld
->
kw_mask
[0] & 
ˇm1
;

3135 
°r
 = (
cfg
 & 1) ? "enabled" : "disabled";

3137 
	`£q_¥ötf
(
s
, "0x%x\t%d\t\t%Œu\t0x%x\t%s\n", 
pcifunc
, 
i
,

3138 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3139 
	`NPC_AF_MATCH_STATX
(
èbÀ
->
cou¡î_idx
[
i
])),

3140 
ch™
, 
°r
);

3144 
	}
}

3146 
RVU_DEBUG_SEQ_FOPS
(
≈c_exa˘_dr›_˙t
,Çpc_exa˘_dr›_˙t, 
NULL
);

3148 
	$rvu_dbg_≈c_öô
(
rvu
 *rvu)

3150 
rvu
->
rvu_dbg
.
≈c
 = 
	`debugfs_¸óã_dú
("≈c",Ñvu->rvu_dbg.
roŸ
);

3152 
	`debugfs_¸óã_fûe
("mˇm_öfo", 0444, 
rvu
->
rvu_dbg
.
≈c
,Ñvu,

3153 &
rvu_dbg_≈c_mˇm_öfo_f›s
);

3154 
	`debugfs_¸óã_fûe
("mˇm_ruÀs", 0444, 
rvu
->
rvu_dbg
.
≈c
,Ñvu,

3155 &
rvu_dbg_≈c_mˇm_ruÀs_f›s
);

3157 
	`debugfs_¸óã_fûe
("rx_miss_a˘_°©s", 0444, 
rvu
->
rvu_dbg
.
≈c
,Ñvu,

3158 &
rvu_dbg_≈c_rx_miss_a˘_f›s
);

3160 i‡(!
rvu
->
hw
->
ˇp
.
≈c_exa˘_m©ch_íabÀd
)

3163 
	`debugfs_¸óã_fûe
("exa˘_íåõs", 0444, 
rvu
->
rvu_dbg
.
≈c
,Ñvu,

3164 &
rvu_dbg_≈c_exa˘_íåõs_f›s
);

3166 
	`debugfs_¸óã_fûe
("exa˘_öfo", 0444, 
rvu
->
rvu_dbg
.
≈c
,Ñvu,

3167 &
rvu_dbg_≈c_exa˘_öfo_f›s
);

3169 
	`debugfs_¸óã_fûe
("exa˘_dr›_˙t", 0444, 
rvu
->
rvu_dbg
.
≈c
,Ñvu,

3170 &
rvu_dbg_≈c_exa˘_dr›_˙t_f›s
);

3172 
	}
}

3173 
	$∑r£_sso_cmd_buf„r
(*
cmd_buf
, 
size_t
 *
cou¡
,

3174 c⁄° 
__u£r
 *
buf„r
, *
ssﬁf
,

3175 
boﬁ
 *
Æl
)

3177 
ªt
, 
byãs_nŸ_c›õd
;

3178 *
cmd_buf_tmp
;

3179 *
subtokí
;

3181 
byãs_nŸ_c›õd
 = 
	`c›y_‰om_u£r
(
cmd_buf
, 
buf„r
, *
cou¡
);

3182 i‡(
byãs_nŸ_c›õd
)

3183  -
EFAULT
;

3185 
cmd_buf
[*
cou¡
] = '\0';

3186 
cmd_buf_tmp
 = 
	`°rchr
(
cmd_buf
, '\n');

3188 i‡(
cmd_buf_tmp
) {

3189 *
cmd_buf_tmp
 = '\0';

3190 *
cou¡
 = 
cmd_buf_tmp
 - 
cmd_buf
 + 1;

3193 
subtokí
 = 
	`°r£p
(&
cmd_buf
, " ");

3194 i‡(
subtokí
 && 
	`°rcmp
(subtoken, "all") == 0) {

3195 *
Æl
 = 
åue
;

3197 
ªt
 = 
subtokí
 ? 
	`k°πoöt
(subtokí, 10, 
ssﬁf
Ë: -
EINVAL
;

3198 i‡(
ªt
 < 0)

3199  
ªt
;

3201 i‡(
cmd_buf
)

3202  -
EINVAL
;

3205 
	}
}

3207 
	$sso_hwgΩ_di•œy_iq_li°
(
rvu
 *rvu, 
ssﬁf
, 
u16
 
idx
,

3208 
u16
 
èû_idx
, 
u8
 
queue_ty≥
)

3210 c⁄° *
queue
[3] = {"DQ", "CQ", "AQ"};

3211 
blkaddr
;

3212 
u64
 
ªg
;

3214 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3215 i‡(
blkaddr
 < 0)

3218 
	`¥_öfo
("SSO HWGGRP[%d] [%s] Chaö queuêhód[%d]", 
ssﬁf
,

3219 
queue
[
queue_ty≥
], 
idx
);

3220 
	`¥_öfo
("SSO HWGGRP[%d] [%s] Chaö queuêèû[%d]", 
ssﬁf
,

3221 
queue
[
queue_ty≥
], 
èû_idx
);

3222 
	`¥_öfo
("--------------------------------------------------\n");

3224 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_TAG
(
idx
));

3225 
	`¥_öfo
("SSO HWGGRP[%d] [%s] IE[%d] TAG 0x%Œx\n", 
ssﬁf
,

3226 
queue
[
queue_ty≥
], 
idx
, 
ªg
);

3228 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_GRP
(
idx
));

3229 
	`¥_öfo
("SSO HWGGRP[%d] [%s] IE[%d] GRP 0x%Œx\n", 
ssﬁf
,

3230 
queue
[
queue_ty≥
], 
idx
, 
ªg
);

3232 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_PENDTAG
(
idx
));

3233 
	`¥_öfo
("SSO HWGGRP[%d] [%s] IE[%d] PENDTAG 0x%Œx\n", 
ssﬁf
,

3234 
queue
[
queue_ty≥
], 
idx
, 
ªg
);

3236 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_LINKS
(
idx
));

3237 
	`¥_öfo
("SSO HWGGRP[%d] [%s] IE[%d] LINKS 0x%Œx\n", 
ssﬁf
,

3238 
queue
[
queue_ty≥
], 
idx
, 
ªg
);

3240 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_QLINKS
(
idx
));

3241 
	`¥_öfo
("SSO HWGGRP[%d] [%s] IE[%d] QLINKS 0x%Œx\n", 
ssﬁf
,

3242 
queue
[
queue_ty≥
], 
idx
, 
ªg
);

3243 
	`¥_öfo
("--------------------------------------------------\n");

3244 i‡(
idx
 =
èû_idx
)

3246 
idx
 = 
ªg
 & 0x1FFF;

3247 } 
idx
 != 0x1FFF);

3248 
	}
}

3250 
	$sso_hwgΩ_di•œy_èq_li°
(
rvu
 *rvu, 
ssﬁf
, 
u8
 
w´_hód
,

3251 
u16
 
ít_hód
, 
u8
 
w´_u£d
, u8 
èq_löes
)

3253 
i
, 
blkaddr
;

3254 
u64
 
ªg
;

3256 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3257 i‡(
blkaddr
 < 0)

3260 
	`¥_öfo
("--------------------------------------------------\n");

3262 
i
 = 
w´_hód
; i < 
èq_löes
 && 
w´_u£d
; i++) {

3263 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3264 
	`SSO_AF_TAQX_WAEY_TAG
(
ít_hód
, 
i
));

3265 
	`¥_öfo
("SSO HWGGRP[%d] TAQ[%d] WAE[%d] TAG 0x%llx\n",

3266 
ssﬁf
, 
ít_hód
, 
i
, 
ªg
);

3268 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3269 
	`SSO_AF_TAQX_WAEY_WQP
(
ít_hód
, 
i
));

3270 
	`¥_öfo
("SSO HWGGRP[%d] TAQ[%d] WAE[%d] WQP 0x%llx\n",

3271 
ssﬁf
, 
ít_hód
, 
i
, 
ªg
);

3272 
w´_u£d
--;

3275 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3276 
	`SSO_AF_TAQX_LINK
(
ít_hód
));

3277 
	`¥_öfo
("SSO HWGGRP[%d] TAQ[%d] LINK 0x%llx\n",

3278 
ssﬁf
, 
ít_hód
, 
ªg
);

3279 
ít_hód
 = 
ªg
 & 0x7FF;

3280 
	`¥_öfo
("--------------------------------------------------\n");

3281 } 
ít_hód
 && 
w´_u£d
);

3282 
	}
}

3284 
	$ªad_sso_pc
(
rvu
 *rvu)

3286 
blkaddr
;

3287 
u64
 
ªg
;

3289 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3290 i‡(
blkaddr
 < 0)

3291  -
ENODEV
;

3293 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_ACTIVE_CYCLES0
);

3294 
	`¥_öfo
("SSO Add-W‹ká˘ivêcy˛es %Œd\n", 
ªg
);

3295 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_ACTIVE_CYCLES1
);

3296 
	`¥_öfo
("SSO Gë-W‹ká˘ivêcy˛es %Œd\n", 
ªg
);

3297 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_ACTIVE_CYCLES2
);

3298 
	`¥_öfo
("SSO W‹k-SlŸá˘ivêcy˛es %Œd\n", 
ªg
);

3299 
	`¥_öfo
("\n");

3301 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_NOS_CNT
) & 0x1FFF;

3302 
	`¥_öfo
("SSO w‹k-queuêíåõ†⁄Åhêno-scheduÀÜi° %Œd\n", 
ªg
);

3303 
	`¥_öfo
("\n");

3305 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_AW_READ_ARB
);

3306 
	`¥_öfo
("SSO XAQÑeads outstanding %lld\n",

3307 (
ªg
 >> 24) & 0x3F);

3309 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_XAQ_REQ_PC
);

3310 
	`¥_öfo
("SSO XAQÑód†ªque°s %Œd\n", 
ªg
);

3311 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_XAQ_LATENCY_PC
);

3312 
	`¥_öfo
("SSO XAQÑódÜ©ícy cy˛es %Œd\n", 
ªg
);

3313 
	`¥_öfo
("\n");

3315 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_AW_WE
);

3316 
	`¥_öfo
("SSO IAQÑeserved %lld\n",

3317 (
ªg
 >> 16) & 0x3FFF);

3318 
	`¥_öfo
("SSO IAQÅŸÆ %Œd\n", 
ªg
 & 0x3FFF);

3319 
	`¥_öfo
("\n");

3321 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_TAQ_CNT
);

3322 
	`¥_öfo
("SSO TAQÑeserved %lld\n",

3323 (
ªg
 >> 16) & 0x7FF);

3324 
	`¥_öfo
("SSO TAQÅŸÆ %Œd\n", 
ªg
 & 0x7FF);

3325 
	`¥_öfo
("\n");

3328 
	}
}

3331 
	$ªad_sso_hwgΩ_pc
(
rvu
 *rvu, 
ssﬁf
, 
boﬁ
 
Æl
)

3333 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

3334 
rvu_block
 *
block
;

3335 
blkaddr
, 
max_id
;

3336 
u64
 
ªg
;

3338 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3339 i‡(
blkaddr
 < 0)

3342 
block
 = &
hw
->block[
blkaddr
];

3343 i‡(
ssﬁf
 < 0 || ssﬁ‡>
block
->
lf
.
max
) {

3344 
	`¥_öfo
("Invalid SSOLF(HWGRP), validÑange is 0-%d\n",

3345 
block
->
lf
.
max
 - 1);

3348 
max_id
 = 
block
->
lf
.
max
;

3350 i‡(
Æl
)

3351 
ssﬁf
 = 0;

3353 
max_id
 = 
ssﬁf
 + 1;

3355 
	`¥_öfo
("==================================================\n");

3356 ; 
ssﬁf
 < 
max_id
; ssolf++) {

3357 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_WS_PC
(
ssﬁf
));

3358 
	`¥_öfo
("SSO HWGGRP[%d] W‹k-ScheduÀ PC 0x%Œx\n", 
ssﬁf
,

3359 
ªg
);

3361 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_EXT_PC
(
ssﬁf
));

3362 
	`¥_öfo
("SSO HWGGRP[%d] Exã∫Æ ScheduÀ PC 0x%Œx\n", 
ssﬁf
,

3363 
ªg
);

3365 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_WA_PC
(
ssﬁf
));

3366 
	`¥_öfo
("SSO HWGGRP[%d] W‹k-Add PC 0x%Œx\n", 
ssﬁf
,

3367 
ªg
);

3369 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TS_PC
(
ssﬁf
));

3370 
	`¥_öfo
("SSO HWGGRP[%d] Tag Swôch PC 0x%Œx\n", 
ssﬁf
,

3371 
ªg
);

3373 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_DS_PC
(
ssﬁf
));

3374 
	`¥_öfo
("SSO HWGGRP[%d] DescheduÀ PC 0x%Œx\n", 
ssﬁf
,

3375 
ªg
);

3377 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_DQ_PC
(
ssﬁf
));

3378 
	`¥_öfo
("SSO HWGGRP[%d] W‹k-DescheduÀd PC 0x%Œx\n", 
ssﬁf
,

3379 
ªg
);

3381 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3382 
	`SSO_AF_HWGRPX_PAGE_CNT
(
ssﬁf
));

3383 
	`¥_öfo
("SSO HWGGRP[%d] In-u£ PagêCou¡ 0x%Œx\n", 
ssﬁf
,

3384 
ªg
);

3385 
	`¥_öfo
("==================================================\n");

3387 
	}
}

3390 
	$ªad_sso_hwgΩ_thªsh
(
rvu
 *rvu, 
ssﬁf
, 
boﬁ
 
Æl
)

3392 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

3393 
rvu_block
 *
block
;

3394 
blkaddr
, 
max_id
;

3395 
u64
 
ªg
;

3397 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3398 i‡(
blkaddr
 < 0)

3401 
block
 = &
hw
->block[
blkaddr
];

3402 i‡(
ssﬁf
 < 0 || ssﬁ‡>
block
->
lf
.
max
) {

3403 
	`¥_öfo
("Invalid SSOLF(HWGRP), validÑange is 0-%d\n",

3404 
block
->
lf
.
max
 - 1);

3407 
max_id
 = 
block
->
lf
.
max
;

3409 i‡(
Æl
)

3410 
ssﬁf
 = 0;

3412 
max_id
 = 
ssﬁf
 + 1;

3414 
	`¥_öfo
("==================================================\n");

3415 ; 
ssﬁf
 < 
max_id
; ssolf++) {

3416 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3417 
	`SSO_AF_HWGRPX_IAQ_THR
(
ssﬁf
));

3418 
	`¥_öfo
("SSO HWGGRP[%d] IAQ Thªshﬁd 0x%Œx\n", 
ssﬁf
,

3419 
ªg
);

3421 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3422 
	`SSO_AF_HWGRPX_TAQ_THR
(
ssﬁf
));

3423 
	`¥_öfo
("SSO HWGGRP[%d] TAQ Thªshﬁd 0x%Œx\n", 
ssﬁf
,

3424 
ªg
);

3426 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3427 
	`SSO_AF_HWGRPX_XAQ_AURA
(
ssﬁf
));

3428 
	`¥_öfo
("SSO HWGGRP[%d] XAQ Auø 0x%Œx\n", 
ssﬁf
,

3429 
ªg
);

3431 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3432 
	`SSO_AF_HWGRPX_XAQ_LIMIT
(
ssﬁf
));

3433 
	`¥_öfo
("SSO HWGGRP[%d] XAQ Limô 0x%Œx\n", 
ssﬁf
,

3434 
ªg
);

3436 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3437 
	`SSO_AF_HWGRPX_IU_ACCNT
(
ssﬁf
));

3438 
	`¥_öfo
("SSO HWGGRP[%d] IU Accou¡ Index 0x%Œx\n", 
ssﬁf
,

3439 
ªg
);

3441 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3442 
	`SSO_AF_IU_ACCNTX_CFG
(
ªg
 & 0xFF));

3443 
	`¥_öfo
("SSO HWGGRP[%d] IU Accou¡ög Cfg 0x%Œx\n", 
ssﬁf
,

3444 
ªg
);

3445 
	`¥_öfo
("==================================================\n");

3447 
	}
}

3450 
	$ªad_sso_hwgΩ_èq_li°
(
rvu
 *rvu, 
ssﬁf
, 
boﬁ
 
Æl
)

3452 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

3453 
u8
 
èq_íåõs
, 
w´_hód
;

3454 
rvu_block
 *
block
;

3455 
u16
 
ít_hód
, 
˛_u£d
;

3456 
blkaddr
, 
max_id
;

3457 
u64
 
ªg
;

3459 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3460 i‡(
blkaddr
 < 0)

3463 
block
 = &
hw
->block[
blkaddr
];

3464 i‡(
ssﬁf
 < 0 || ssﬁ‡>
block
->
lf
.
max
) {

3465 
	`¥_öfo
("Invalid SSOLF(HWGRP), validÑange is 0-%d\n",

3466 
block
->
lf
.
max
 - 1);

3469 
max_id
 = 
block
->
lf
.
max
;

3471 i‡(
Æl
)

3472 
ssﬁf
 = 0;

3474 
max_id
 = 
ssﬁf
 + 1;

3475 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_CONST
);

3476 
èq_íåõs
 = (
ªg
 >> 48) & 0xFF;

3477 
	`¥_öfo
("==================================================\n");

3478 ; 
ssﬁf
 < 
max_id
; ssolf++) {

3479 
	`¥_öfo
("++++++++++++++++++++++++++++++++++++++++++++++++++\n");

3480 
	`¥_öfo
("SSO HWGGRP[%d] Transitory Output Admission Queue",

3481 
ssﬁf
);

3482 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_TOAQX_STATUS
(
ssﬁf
));

3483 
	`¥_öfo
("SSO HWGGRP[%d] TOAQ Sètu† 0x%Œx\n", 
ssﬁf
,

3484 
ªg
);

3485 
ít_hód
 = (
ªg
 >> 12) & 0x7FF;

3486 
˛_u£d
 = (
ªg
 >> 32) & 0x7FF;

3487 i‡(
ªg
 & 
	`BIT_ULL
(61Ë&& 
˛_u£d
) {

3488 
	`¥_öfo
("SSO HWGGRP[%d] TOAQ CL_USED 0x%x\n",

3489 
ssﬁf
, 
˛_u£d
);

3490 
	`sso_hwgΩ_di•œy_èq_li°
(
rvu
, 
ssﬁf
, 
ít_hód
, 0,

3491 
˛_u£d
 * 
èq_íåõs
,

3492 
èq_íåõs
);

3494 
	`¥_öfo
("++++++++++++++++++++++++++++++++++++++++++++++++++\n");

3495 
	`¥_öfo
("SSO HWGGRP[%d] Transitory Input Admission Queue",

3496 
ssﬁf
);

3497 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_TIAQX_STATUS
(
ssﬁf
));

3498 
	`¥_öfo
("SSO HWGGRP[%d] TIAQ Sètu† 0x%Œx\n", 
ssﬁf
,

3499 
ªg
);

3500 
w´_hód
 = (
ªg
 >> 60) & 0xF;

3501 
˛_u£d
 = (
ªg
 >> 32) & 0x7FFF;

3502 
ít_hód
 = (
ªg
 >> 12) & 0x7FF;

3503 i‡(
ªg
 & 
	`BIT_ULL
(61Ë&& 
˛_u£d
) {

3504 
	`¥_öfo
("SSO HWGGRP[%d] TIAQ WAE_USED 0x%x\n",

3505 
ssﬁf
, 
˛_u£d
);

3506 
	`sso_hwgΩ_di•œy_èq_li°
(
rvu
, 
ssﬁf
, 
ít_hód
,

3507 
w´_hód
, 
˛_u£d
,

3508 
èq_íåõs
);

3510 
	`¥_öfo
("++++++++++++++++++++++++++++++++++++++++++++++++++\n");

3511 
	`¥_öfo
("==================================================\n");

3513 
	}
}

3516 
	$ªad_sso_hwgΩ_üq_li°
(
rvu
 *rvu, 
ssﬁf
, 
boﬁ
 
Æl
)

3518 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

3519 
rvu_block
 *
block
;

3520 
u16
 
hód_idx
, 
èû_idx
;

3521 
blkaddr
, 
max_id
;

3522 
u64
 
ªg
;

3524 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3525 i‡(
blkaddr
 < 0)

3528 
block
 = &
hw
->block[
blkaddr
];

3529 i‡(
ssﬁf
 < 0 || ssﬁ‡>
block
->
lf
.
max
) {

3530 
	`¥_öfo
("Invalid SSOLF(HWGRP), validÑange is 0-%d\n",

3531 
block
->
lf
.
max
 - 1);

3534 
max_id
 = 
block
->
lf
.
max
;

3536 i‡(
Æl
)

3537 
ssﬁf
 = 0;

3539 
max_id
 = 
ssﬁf
 + 1;

3540 
	`¥_öfo
("==================================================\n");

3541 ; 
ssﬁf
 < 
max_id
; ssolf++) {

3542 
	`¥_öfo
("++++++++++++++++++++++++++++++++++++++++++++++++++\n");

3543 
	`¥_öfo
("SSO HWGGRP[%d] DescheduÀ Queue(DQ)\n", 
ssﬁf
);

3544 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IPL_DESCHEDX
(
ssﬁf
));

3545 
	`¥_öfo
("SSO HWGGRP[%d] DQ Li° 0x%Œx\n", 
ssﬁf
,

3546 
ªg
);

3547 
hód_idx
 = (
ªg
 >> 13) & 0x1FFF;

3548 
èû_idx
 = 
ªg
 & 0x1FFF;

3549 i‡(
ªg
 & (
	`BIT_ULL
(26) | BIT_ULL(27)))

3550 
	`sso_hwgΩ_di•œy_iq_li°
(
rvu
, 
ssﬁf
, 
hód_idx
,

3551 
èû_idx
, 0);

3552 
	`¥_öfo
("++++++++++++++++++++++++++++++++++++++++++++++++++\n");

3553 
	`¥_öfo
("SSO HWGGRP[%d] C⁄Êi˘ Queue(CQ)\n", 
ssﬁf
);

3554 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IPL_CONFX
(
ssﬁf
));

3555 
	`¥_öfo
("SSO HWGGRP[%d] CQ Li° 0x%Œx\n", 
ssﬁf
,

3556 
ªg
);

3557 
hód_idx
 = (
ªg
 >> 13) & 0x1FFF;

3558 
èû_idx
 = 
ªg
 & 0x1FFF;

3559 i‡(
ªg
 & (
	`BIT_ULL
(26) | BIT_ULL(27)))

3560 
	`sso_hwgΩ_di•œy_iq_li°
(
rvu
, 
ssﬁf
, 
hód_idx
,

3561 
èû_idx
, 1);

3562 
	`¥_öfo
("++++++++++++++++++++++++++++++++++++++++++++++++++\n");

3563 
	`¥_öfo
("SSO HWGGRP[%d] Admissi⁄ Queue(AQ)\n", 
ssﬁf
);

3564 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IPL_IAQX
(
ssﬁf
));

3565 
	`¥_öfo
("SSO HWGGRP[%d] AQ Li° 0x%Œx\n", 
ssﬁf
,

3566 
ªg
);

3567 
hód_idx
 = (
ªg
 >> 13) & 0x1FFF;

3568 
èû_idx
 = 
ªg
 & 0x1FFF;

3569 i‡(
ªg
 & (
	`BIT_ULL
(26) | BIT_ULL(27)))

3570 
	`sso_hwgΩ_di•œy_iq_li°
(
rvu
, 
ssﬁf
, 
hód_idx
,

3571 
èû_idx
, 2);

3572 
	`¥_öfo
("++++++++++++++++++++++++++++++++++++++++++++++++++\n");

3573 
	`¥_öfo
("==================================================\n");

3575 
	}
}

3578 
	$ªad_sso_hwgΩ_õ¡_li°
(
rvu
 *rvu)

3580 c⁄° *
â_c
[4] = {"SSO_TT_ORDERED_", "SSO_TT_ATOMIC__",

3582 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

3583 
max_idx
 = 
hw
->
sso
.
sso_iue
;

3584 
u64
 
≥ndèg
, 
qlöks
, 
löks
;

3585 
Àn
, 
idx
, 
blkaddr
;

3586 
u64
 
èg
, 
gΩ
, 
wqp
;

3587 
°r
[300];

3589 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3590 i‡(
blkaddr
 < 0)

3591  -
ENODEV
;

3593 
idx
 = 0; idx < 
max_idx
; idx++) {

3594 
Àn
 = 0;

3595 
èg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_TAG
(
idx
));

3596 
gΩ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_GRP
(
idx
));

3597 
≥ndèg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3598 
	`SSO_AF_IENTX_PENDTAG
(
idx
));

3599 
löks
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_LINKS
(
idx
));

3600 
qlöks
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3601 
	`SSO_AF_IENTX_QLINKS
(
idx
));

3602 
wqp
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_WQP
(
idx
));

3603 
Àn
 = 
	`¢¥ötf
(
°r
 +Üen, 300,

3604 "SSO IENT[%4d] TT [%s] HWGRP [%3Œd] ", 
idx
,

3605 
â_c
[(
èg
 >> 32Ë& 0x3], (
gΩ
 >> 48) & 0x1f);

3606 
Àn
 +
	`¢¥ötf
(
°r
 +Üen, 300 -Üen,

3607 "TAG [0x%010Œx] GRP [0x%016Œx] ", 
èg
, 
gΩ
);

3608 
Àn
 +
	`¢¥ötf
(
°r
 +Üen, 300 -Üen, "PENDTAG [0x%010llx] ",

3609 
≥ndèg
);

3610 
Àn
 +
	`¢¥ötf
(
°r
 +Üen, 300 -Üen,

3611 "LINKS [0x%016Œx] QLINKS [0x%010Œx] ", 
löks
,

3612 
qlöks
);

3613 
	`¢¥ötf
(
°r
 + 
Àn
, 300 -Üí, "WQP [0x%016Œx]\n", 
wqp
);

3614 
	`¥_öfo
("%s", 
°r
);

3618 
	}
}

3621 
	$ªad_sso_hwgΩ_‰ì_li°
(
rvu
 *rvu)

3623 
blkaddr
;

3624 
u64
 
ªg
;

3625 
u8
 
idx
;

3627 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3628 i‡(
blkaddr
 < 0)

3629  -
ENODEV
;

3631 
	`¥_öfo
("==================================================\n");

3632 
idx
 = 0; idx < 4; idx++) {

3633 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IPL_FREEX
(
idx
));

3634 
	`¥_öfo
("SSO FREE LIST[%d]\n", 
idx
);

3635 
	`¥_öfo
("qnum_head : %lld qnum_tail : %lld\n",

3636 (
ªg
 >> 58) & 0x3, (reg >> 56) & 0x3);

3637 
	`¥_öfo
("queue_˙à: %Œx\n", (
ªg
 >> 26) & 0x7fff);

3638 
	`¥_öfo
("queue_val : %lld queue_head : %4lld queue_tail %4lld\n"

3639 , (
ªg
 >> 40) & 0x1, (reg >> 13) & 0x1fff,

3640 
ªg
 & 0x1fff);

3641 
	`¥_öfo
("==================================================\n");

3645 
	}
}

3648 
	$ªad_sso_hws_öfo
(
rvu
 *rvu, 
ssowlf
, 
boﬁ
 
Æl
)

3650 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

3651 
rvu_block
 *
block
;

3652 
blkaddr
;

3653 
max_id
;

3654 
u64
 
ªg
;

3655 
u8
 
mask
;

3656 
u8
 
£t
;

3658 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 0);

3659 i‡(
blkaddr
 < 0)

3662 
block
 = &
hw
->block[
blkaddr
];

3663 i‡(
ssowlf
 < 0 || ssowl‡>
block
->
lf
.
max
) {

3664 
	`¥_öfo
("Invalid SSOWLF(HWS), validÑange is 0-%d\n",

3665 
block
->
lf
.
max
 - 1);

3668 
max_id
 = 
block
->
lf
.
max
;

3670 i‡(
Æl
)

3671 
ssowlf
 = 0;

3673 
max_id
 = 
ssowlf
 + 1;

3675 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

3676 i‡(
blkaddr
 < 0)

3679 
	`¥_öfo
("==================================================\n");

3680 ; 
ssowlf
 < 
max_id
; ssowlf++) {

3681 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_ARB
(
ssowlf
));

3682 
	`¥_öfo
("SSOW HWS[%d] Arbôøti⁄ Sèã 0x%Œx\n", 
ssowlf
,

3683 
ªg
);

3684 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_GMCTL
(
ssowlf
));

3685 
	`¥_öfo
("SSOW HWS[%d] Gue° MachöêC⁄åﬁ 0x%Œx\n", 
ssowlf
,

3686 
ªg
);

3687 
£t
 = 0; set < 2; set++)

3688 
mask
 = 0; mask < 4; mask++) {

3689 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3690 
	`SSO_AF_HWSX_SX_GRPMSKX
(
ssowlf
,

3691 
£t
,

3692 
mask
));

3693 
	`¥_öfo
(

3695 
ssowlf
, 
£t
, 
mask
, 
ªg
);

3697 
	`¥_öfo
("==================================================\n");

3699 
	}
}

3701 (*
	tsso_dump_cb
)(
	trvu
 *rvu, 
	tssﬁf
, 
	tboﬁ
 
	tÆl
);

3703 
ssize_t
 
	$rvu_dbg_sso_cmd_∑r£r
(
fûe
 *
fûp
,

3704 c⁄° 
__u£r
 *
buf„r
, 
size_t
 
cou¡
,

3705 
loff_t
 *
µos
, *
lf_ty≥
,

3706 *
fûe_nm
, 
sso_dump_cb
 
‚
)

3708 
rvu
 *rvu = 
fûp
->
¥iv©e_d©a
;

3709 
boﬁ
 
Æl
 = 
Ál£
;

3710 *
cmd_buf
;

3711 
lf
 = 0;

3713 i‡((*
µos
 !0Ë|| !
cou¡
)

3714  -
EINVAL
;

3716 
cmd_buf
 = 
	`kzÆloc
(
cou¡
 + 1, 
GFP_KERNEL
);

3717 i‡(!
cmd_buf
)

3718  -
ENOSPC
;

3720 i‡(
	`∑r£_sso_cmd_buf„r
(
cmd_buf
, &
cou¡
, 
buf„r
,

3721 &
lf
, &
Æl
) < 0) {

3722 
	`¥_öfo
("Ußge:Échÿ[<%s>/Æl] > %s\n", 
lf_ty≥
, 
fûe_nm
);

3724 
	`‚
(
rvu
, 
lf
, 
Æl
);

3726 
	`k‰ì
(
cmd_buf
);

3728  
cou¡
;

3729 
	}
}

3732 
ssize_t
 
	$rvu_dbg_sso_pc_di•œy
(
fûe
 *
fûp
,

3733 
__u£r
 *
buf„r
,

3734 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3736  
	`ªad_sso_pc
(
fûp
->
¥iv©e_d©a
);

3737 
	}
}

3739 
ssize_t
 
	$rvu_dbg_sso_hwgΩ_pc_di•œy
(
fûe
 *
fûp
,

3740 c⁄° 
__u£r
 *
buf„r
,

3741 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3743  
	`rvu_dbg_sso_cmd_∑r£r
(
fûp
, 
buf„r
, 
cou¡
, 
µos
, "hwgrp",

3744 "sso_hwgΩ_pc", 
ªad_sso_hwgΩ_pc
);

3745 
	}
}

3747 
ssize_t
 
	$rvu_dbg_sso_hwgΩ_thªsh_di•œy
(
fûe
 *
fûp
,

3748 c⁄° 
__u£r
 *
buf„r
,

3749 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3751  
	`rvu_dbg_sso_cmd_∑r£r
(
fûp
, 
buf„r
, 
cou¡
, 
µos
, "hwgrp",

3752 "sso_hwgΩ_thªsh", 
ªad_sso_hwgΩ_thªsh
);

3753 
	}
}

3755 
ssize_t
 
	$rvu_dbg_sso_hwgΩ_èq_wlk_di•œy
(
fûe
 *
fûp
,

3756 c⁄° 
__u£r
 *
buf„r
,

3757 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3759  
	`rvu_dbg_sso_cmd_∑r£r
(
fûp
, 
buf„r
, 
cou¡
, 
µos
, "hwgrp",

3760 "sso_hwgΩ_èq_wlk", 
ªad_sso_hwgΩ_èq_li°
);

3761 
	}
}

3763 
ssize_t
 
	$rvu_dbg_sso_hwgΩ_üq_wlk_di•œy
(
fûe
 *
fûp
,

3764 c⁄° 
__u£r
 *
buf„r
,

3765 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3767  
	`rvu_dbg_sso_cmd_∑r£r
(
fûp
, 
buf„r
, 
cou¡
, 
µos
, "hwgrp",

3768 "sso_hwgΩ_üq_wlk", 
ªad_sso_hwgΩ_üq_li°
);

3769 
	}
}

3771 
ssize_t
 
	$rvu_dbg_sso_hwgΩ_õ¡_wlk_di•œy
(
fûe
 *
fûp
,

3772 
__u£r
 *
buf„r
,

3773 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3775  
	`ªad_sso_hwgΩ_õ¡_li°
(
fûp
->
¥iv©e_d©a
);

3776 
	}
}

3778 
ssize_t
 
	$rvu_dbg_sso_hwgΩ_Ê_wlk_di•œy
(
fûe
 *
fûp
,

3779 
__u£r
 *
buf„r
,

3780 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3782  
	`ªad_sso_hwgΩ_‰ì_li°
(
fûp
->
¥iv©e_d©a
);

3783 
	}
}

3785 
ssize_t
 
	$rvu_dbg_sso_hws_öfo_di•œy
(
fûe
 *
fûp
,

3786 c⁄° 
__u£r
 *
buf„r
,

3787 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3789  
	`rvu_dbg_sso_cmd_∑r£r
(
fûp
, 
buf„r
, 
cou¡
, 
µos
, "hws",

3790 "sso_hws_öfo", 
ªad_sso_hws_öfo
);

3791 
	}
}

3793 
RVU_DEBUG_FOPS
(
sso_pc
, 
sso_pc_di•œy
, 
NULL
);

3794 
RVU_DEBUG_FOPS
(
sso_hwgΩ_pc
, 
NULL
, 
sso_hwgΩ_pc_di•œy
);

3795 
RVU_DEBUG_FOPS
(
sso_hwgΩ_thªsh
, 
NULL
, 
sso_hwgΩ_thªsh_di•œy
);

3796 
RVU_DEBUG_FOPS
(
sso_hwgΩ_èq_wlk
, 
NULL
, 
sso_hwgΩ_èq_wlk_di•œy
);

3797 
RVU_DEBUG_FOPS
(
sso_hwgΩ_üq_wlk
, 
NULL
, 
sso_hwgΩ_üq_wlk_di•œy
);

3798 
RVU_DEBUG_FOPS
(
sso_hwgΩ_õ¡_wlk
, 
sso_hwgΩ_õ¡_wlk_di•œy
, 
NULL
);

3799 
RVU_DEBUG_FOPS
(
sso_hwgΩ_Ê_wlk
, 
sso_hwgΩ_Ê_wlk_di•œy
, 
NULL
);

3800 
RVU_DEBUG_FOPS
(
sso_hws_öfo
, 
NULL
, 
sso_hws_öfo_di•œy
);

3802 
	$rvu_dbg_sso_öô
(
rvu
 *rvu)

3804 
rvu
->
rvu_dbg
.
sso
 = 
	`debugfs_¸óã_dú
("sso",Ñvu->rvu_dbg.
roŸ
);

3805 
rvu
->
rvu_dbg
.
sso_hwgΩ
 = 
	`debugfs_¸óã_dú
("hwgΩ",Ñvu->rvu_dbg.
sso
);

3806 
rvu
->
rvu_dbg
.
sso_hws
 = 
	`debugfs_¸óã_dú
("hws",Ñvu->rvu_dbg.
sso
);

3808 
	`debugfs_¸óã_fûe
("sso_pc", 0600, 
rvu
->
rvu_dbg
.
sso
,Ñvu,

3809 &
rvu_dbg_sso_pc_f›s
);

3811 
	`debugfs_¸óã_fûe
("sso_hwgΩ_pc", 0600, 
rvu
->
rvu_dbg
.
sso_hwgΩ
,

3812 
rvu
, &
rvu_dbg_sso_hwgΩ_pc_f›s
);

3814 
	`debugfs_¸óã_fûe
("sso_hwgΩ_thªsh", 0600, 
rvu
->
rvu_dbg
.
sso_hwgΩ
,

3815 
rvu
, &
rvu_dbg_sso_hwgΩ_thªsh_f›s
);

3817 
	`debugfs_¸óã_fûe
("sso_hwgΩ_èq_wÆk", 0600, 
rvu
->
rvu_dbg
.
sso_hwgΩ
,

3818 
rvu
, &
rvu_dbg_sso_hwgΩ_èq_wlk_f›s
);

3820 
	`debugfs_¸óã_fûe
("sso_hwgΩ_üq_wÆk", 0600, 
rvu
->
rvu_dbg
.
sso_hwgΩ
,

3821 
rvu
, &
rvu_dbg_sso_hwgΩ_üq_wlk_f›s
);

3823 
	`debugfs_¸óã_fûe
("sso_hwgΩ_õ¡_wÆk", 0600, 
rvu
->
rvu_dbg
.
sso_hwgΩ
,

3824 
rvu
, &
rvu_dbg_sso_hwgΩ_õ¡_wlk_f›s
);

3826 
	`debugfs_¸óã_fûe
("sso_hwgrp_free_list_walk", 0600,

3827 
rvu
->
rvu_dbg
.
sso_hwgΩ
,Ñvu,

3828 &
rvu_dbg_sso_hwgΩ_Ê_wlk_f›s
);

3830 
	`debugfs_¸óã_fûe
("sso_hws_öfo", 0600, 
rvu
->
rvu_dbg
.
sso_hws
,

3831 
rvu
, &
rvu_dbg_sso_hws_öfo_f›s
);

3832 
	}
}

3835 
	$∑r£_˝t_cmd_buf„r
(*
cmd_buf
, 
size_t
 *
cou¡
,

3836 c⁄° 
__u£r
 *
buf„r
, *
e_ty≥
)

3838 
byãs_nŸ_c›õd
;

3839 *
cmd_buf_tmp
;

3840 *
subtokí
;

3842 
byãs_nŸ_c›õd
 = 
	`c›y_‰om_u£r
(
cmd_buf
, 
buf„r
, *
cou¡
);

3843 i‡(
byãs_nŸ_c›õd
)

3844  -
EFAULT
;

3846 
cmd_buf
[*
cou¡
] = '\0';

3847 
cmd_buf_tmp
 = 
	`°rchr
(
cmd_buf
, '\n');

3849 i‡(
cmd_buf_tmp
) {

3850 *
cmd_buf_tmp
 = '\0';

3851 *
cou¡
 = 
cmd_buf_tmp
 - 
cmd_buf
 + 1;

3854 
subtokí
 = 
	`°r£p
(&
cmd_buf
, " ");

3855 i‡(
subtokí
)

3856 
	`°r˝y
(
e_ty≥
, 
subtokí
);

3858  -
EINVAL
;

3860 i‡(
cmd_buf
)

3861  -
EINVAL
;

3863 i‡(
	`°rcmp
(
e_ty≥
, "SE") && strcmp(e_type, "IE") &&

3864 
	`°rcmp
(
e_ty≥
, "AE") && strcmp(e_type, "all"))

3865  -
EINVAL
;

3868 
	}
}

3870 
ssize_t
 
	$rvu_dbg_˝t_cmd_∑r£r
(
fûe
 *
fûp
,

3871 c⁄° 
__u£r
 *
buf„r
, 
size_t
 
cou¡
,

3872 
loff_t
 *
µos
)

3874 
£q_fûe
 *
s
 = 
fûp
->
¥iv©e_d©a
;

3875 
rvu
 *rvu = 
s
->
¥iv©e
;

3876 *
cmd_buf
;

3877 
ªt
 = 0;

3879 i‡((*
µos
 !0Ë|| !
cou¡
)

3880  -
EINVAL
;

3882 
cmd_buf
 = 
	`kzÆloc
(
cou¡
 + 1, 
GFP_KERNEL
);

3883 i‡(!
cmd_buf
)

3884  -
ENOSPC
;

3886 i‡(
	`∑r£_˝t_cmd_buf„r
(
cmd_buf
, &
cou¡
, 
buf„r
,

3887 
rvu
->
rvu_dbg
.
˝t_˘x
.
e_ty≥
) < 0)

3888 
ªt
 = -
EINVAL
;

3890 
	`k‰ì
(
cmd_buf
);

3892 i‡(
ªt
)

3893  -
EINVAL
;

3895  
cou¡
;

3896 
	}
}

3898 
ssize_t
 
	$rvu_dbg_˝t_ígöes_°s_wrôe
(
fûe
 *
fûp
,

3899 c⁄° 
__u£r
 *
buf„r
,

3900 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3902  
	`rvu_dbg_˝t_cmd_∑r£r
(
fûp
, 
buf„r
, 
cou¡
, 
µos
);

3903 
	}
}

3905 
	$rvu_dbg_˝t_ígöes_°s_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

3907 
u64
 
busy_°s
[3] = {0}, 
‰ì_°s
[3] = {0};

3908 
rvu
 *rvu = 
fûp
->
¥iv©e
;

3909 
u16
 
max_£s
, 
max_õs
, 
max_´s
;

3910 
u32
 
e_mö
 = 0, 
e_max
 = 0, 
e
;

3911 
díåy
 *
cuºít_dú
;

3912 
blkaddr
;

3913 *
e_ty≥
;

3914 
u64
 
ªg
;

3916 
cuºít_dú
 = 
fûp
->
fûe
->
f_∑th
.
díåy
->
d_∑ª¡
;

3917 
blkaddr
 = (!
	`°rcmp
(
cuºít_dú
->
d_«me
.
«me
, "cpt1") ?

3918 
BLKADDR_CPT1
 : 
BLKADDR_CPT0
);

3920 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CONSTANTS1
);

3921 
max_£s
 = 
ªg
 & 0xffff;

3922 
max_õs
 = (
ªg
 >> 16) & 0xffff;

3923 
max_´s
 = (
ªg
 >> 32) & 0xffff;

3925 
e_ty≥
 = 
rvu
->
rvu_dbg
.
˝t_˘x
.e_type;

3927 i‡(
	`°rcmp
(
e_ty≥
, "SE") == 0) {

3928 
e_mö
 = 0;

3929 
e_max
 = 
max_£s
 - 1;

3930 } i‡(
	`°rcmp
(
e_ty≥
, "IE") == 0) {

3931 
e_mö
 = 
max_£s
;

3932 
e_max
 = 
max_£s
 + 
max_õs
 - 1;

3933 } i‡(
	`°rcmp
(
e_ty≥
, "AE") == 0) {

3934 
e_mö
 = 
max_£s
 + 
max_õs
;

3935 
e_max
 = 
max_£s
 + 
max_õs
 + 
max_´s
 - 1;

3936 } i‡(
	`°rcmp
(
e_ty≥
, "all") == 0) {

3937 
e_mö
 = 0;

3938 
e_max
 = 
max_£s
 + 
max_õs
 + 
max_´s
 - 1;

3940  -
EINVAL
;

3943 
e
 = 
e_mö
;É <
e_max
;É++) {

3944 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_STS
(
e
));

3945 i‡(
ªg
 & 0x1) {

3946 i‡(
e
 < 64)

3947 
busy_°s
[0] |1ULL << 
e
;

3948 i‡(
e
 < 128)

3949 
busy_°s
[1] |1ULL << (
e
 - 64);

3951 
busy_°s
[2] |1ULL << (
e
 - 128);

3953 i‡(
ªg
 & 0x2) {

3954 i‡(
e
 < 64)

3955 
‰ì_°s
[0] |1ULL << 
e
;

3956 i‡(
e
 < 128)

3957 
‰ì_°s
[1] |1ULL << (
e
 - 64);

3959 
‰ì_°s
[2] |1ULL << (
e
 - 128);

3962 
	`£q_puts
(
fûp
, "FREE STS : ");

3963 i‡(
e_max
 > 128)

3964 
	`£q_¥ötf
(
fûp
, "0x%016Œx ", 
‰ì_°s
[2]);

3965 i‡(
e_max
 > 64)

3966 
	`£q_¥ötf
(
fûp
, "0x%016Œx ", 
‰ì_°s
[1]);

3967 
	`£q_¥ötf
(
fûp
, "0x%016Œx\n", 
‰ì_°s
[0]);

3969 
	`£q_puts
(
fûp
, "BUSY STS : ");

3970 i‡(
e_max
 > 128)

3971 
	`£q_¥ötf
(
fûp
, "0x%016Œx ", 
busy_°s
[2]);

3972 i‡(
e_max
 > 64)

3973 
	`£q_¥ötf
(
fûp
, "0x%016Œx ", 
busy_°s
[1]);

3974 
	`£q_¥ötf
(
fûp
, "0x%016Œx\n", 
busy_°s
[0]);

3977 
	}
}

3979 
RVU_DEBUG_SEQ_FOPS
(
˝t_ígöes_°s
, 
˝t_ígöes_°s_di•œy
,

3980 
˝t_ígöes_°s_wrôe
);

3982 
ssize_t
 
	$rvu_dbg_˝t_ígöes_öfo_wrôe
(
fûe
 *
fûp
,

3983 c⁄° 
__u£r
 *
buf„r
,

3984 
size_t
 
cou¡
, 
loff_t
 *
µos
)

3986  
	`rvu_dbg_˝t_cmd_∑r£r
(
fûp
, 
buf„r
, 
cou¡
, 
µos
);

3987 
	}
}

3989 
	$rvu_dbg_˝t_ígöes_öfo_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

3991 
rvu
 *rvu = 
fûp
->
¥iv©e
;

3992 
u16
 
max_£s
, 
max_õs
, 
max_´s
;

3993 
díåy
 *
cuºít_dú
;

3994 
u32
 
e_mö
, 
e_max
, 
e
;

3995 
blkaddr
;

3996 *
e_ty≥
;

3997 
u64
 
ªg
;

3999 
cuºít_dú
 = 
fûp
->
fûe
->
f_∑th
.
díåy
->
d_∑ª¡
;

4000 
blkaddr
 = (!
	`°rcmp
(
cuºít_dú
->
d_«me
.
«me
, "cpt1") ?

4001 
BLKADDR_CPT1
 : 
BLKADDR_CPT0
);

4003 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CONSTANTS1
);

4004 
max_£s
 = 
ªg
 & 0xffff;

4005 
max_õs
 = (
ªg
 >> 16) & 0xffff;

4006 
max_´s
 = (
ªg
 >> 32) & 0xffff;

4008 
e_ty≥
 = 
rvu
->
rvu_dbg
.
˝t_˘x
.e_type;

4010 i‡(
	`°rcmp
(
e_ty≥
, "SE") == 0) {

4011 
e_mö
 = 0;

4012 
e_max
 = 
max_£s
 - 1;

4013 } i‡(
	`°rcmp
(
e_ty≥
, "IE") == 0) {

4014 
e_mö
 = 
max_£s
;

4015 
e_max
 = 
max_£s
 + 
max_õs
 - 1;

4016 } i‡(
	`°rcmp
(
e_ty≥
, "AE") == 0) {

4017 
e_mö
 = 
max_£s
 + 
max_õs
;

4018 
e_max
 = 
max_£s
 + 
max_õs
 + 
max_´s
 - 1;

4019 } i‡(
	`°rcmp
(
e_ty≥
, "all") == 0) {

4020 
e_mö
 = 0;

4021 
e_max
 = 
max_£s
 + 
max_õs
 + 
max_´s
 - 1;

4023  -
EINVAL
;

4026 
	`£q_puts
(
fûp
, "===========================================\n");

4027 
e
 = 
e_mö
;É <
e_max
;É++) {

4028 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_CTL2
(
e
));

4029 
	`£q_¥ötf
(
fûp
, "CPT Engöe[%u] Grou∞E«bÀ 0x%02Œx\n", 
e
,

4030 
ªg
 & 0xff);

4031 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_ACTIVE
(
e
));

4032 
	`£q_¥ötf
(
fûp
, "CPT Engöe[%u] A˘ivêInfÿ 0x%Œx\n", 
e
,

4033 
ªg
);

4034 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_EXEX_CTL
(
e
));

4035 
	`£q_¥ötf
(
fûp
, "CPT Engöe[%u] C⁄åﬁ 0x%Œx\n", 
e
,

4036 
ªg
);

4037 
	`£q_puts
(
fûp
, "===========================================\n");

4040 
	}
}

4042 
RVU_DEBUG_SEQ_FOPS
(
˝t_ígöes_öfo
, 
˝t_ígöes_öfo_di•œy
,

4043 
˝t_ígöes_öfo_wrôe
);

4045 
	$rvu_dbg_˝t_lfs_öfo_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

4047 
rvu
 *rvu = 
fûp
->
¥iv©e
;

4048 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

4049 
díåy
 *
cuºít_dú
;

4050 
rvu_block
 *
block
;

4051 
blkaddr
;

4052 
u64
 
ªg
;

4053 
u32
 
lf
;

4055 
cuºít_dú
 = 
fûp
->
fûe
->
f_∑th
.
díåy
->
d_∑ª¡
;

4056 
blkaddr
 = (!
	`°rcmp
(
cuºít_dú
->
d_«me
.
«me
, "cpt1") ?

4057 
BLKADDR_CPT1
 : 
BLKADDR_CPT0
);

4059 
block
 = &
hw
->block[
blkaddr
];

4060 i‡(!
block
->
lf
.
bm≠
)

4061  -
ENODEV
;

4063 
	`£q_puts
(
fûp
, "===========================================\n");

4064 
lf
 = 0;Ü‡< 
block
->lf.
max
;Üf++) {

4065 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL
(
lf
));

4066 
	`£q_¥ötf
(
fûp
, "CPT Lf[%u] CTL 0x%Œx\n", 
lf
, 
ªg
);

4067 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_CTL2
(
lf
));

4068 
	`£q_¥ötf
(
fûp
, "CPT Lf[%u] CTL2 0x%Œx\n", 
lf
, 
ªg
);

4069 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_LFX_PTR_CTL
(
lf
));

4070 
	`£q_¥ötf
(
fûp
, "CPT Lf[%u] PTR_CTL 0x%Œx\n", 
lf
, 
ªg
);

4071 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
block
->
lfcfg_ªg
 |

4072 (
lf
 << 
block
->
lfshi·
));

4073 
	`£q_¥ötf
(
fûp
, "CPT Lf[%u] CFG 0x%Œx\n", 
lf
, 
ªg
);

4074 
	`£q_puts
(
fûp
, "===========================================\n");

4077 
	}
}

4079 
RVU_DEBUG_SEQ_FOPS
(
˝t_lfs_öfo
, 
˝t_lfs_öfo_di•œy
, 
NULL
);

4081 
	$rvu_dbg_˝t_îr_öfo_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

4083 
rvu
 *rvu = 
fûp
->
¥iv©e
;

4084 
díåy
 *
cuºít_dú
;

4085 
u64
 
ªg0
, 
ªg1
;

4086 
blkaddr
;

4088 
cuºít_dú
 = 
fûp
->
fûe
->
f_∑th
.
díåy
->
d_∑ª¡
;

4089 
blkaddr
 = (!
	`°rcmp
(
cuºít_dú
->
d_«me
.
«me
, "cpt1") ?

4090 
BLKADDR_CPT1
 : 
BLKADDR_CPT0
);

4092 
ªg0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT
(0));

4093 
ªg1
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_FLTX_INT
(1));

4094 
	`£q_¥ötf
(
fûp
, "CPT_AF_FLTX_INT: 0x%Œx 0x%Œx\n", 
ªg0
, 
ªg1
);

4095 
ªg0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_PSNX_EXE
(0));

4096 
ªg1
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_PSNX_EXE
(1));

4097 
	`£q_¥ötf
(
fûp
, "CPT_AF_PSNX_EXE: 0x%Œx 0x%Œx\n", 
ªg0
, 
ªg1
);

4098 
ªg0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`CPT_AF_PSNX_LF
(0));

4099 
	`£q_¥ötf
(
fûp
, "CPT_AF_PSNX_LF: 0x%Œx\n", 
ªg0
);

4100 
ªg0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RVU_INT
);

4101 
	`£q_¥ötf
(
fûp
, "CPT_AF_RVU_INT: 0x%Œx\n", 
ªg0
);

4102 
ªg0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RAS_INT
);

4103 
	`£q_¥ötf
(
fûp
, "CPT_AF_RAS_INT: 0x%Œx\n", 
ªg0
);

4104 
ªg0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_EXE_ERR_INFO
);

4105 
	`£q_¥ötf
(
fûp
, "CPT_AF_EXE_ERR_INFO: 0x%Œx\n", 
ªg0
);

4108 
	}
}

4110 
RVU_DEBUG_SEQ_FOPS
(
˝t_îr_öfo
, 
˝t_îr_öfo_di•œy
, 
NULL
);

4112 
	$rvu_dbg_˝t_pc_di•œy
(
£q_fûe
 *
fûp
, *
unu£d
)

4114 
díåy
 *
cuºít_dú
;

4115 
rvu
 *rvu;

4116 
blkaddr
;

4117 
u64
 
ªg
;

4119 
rvu
 = 
fûp
->
¥iv©e
;

4121 
cuºít_dú
 = 
fûp
->
fûe
->
f_∑th
.
díåy
->
d_∑ª¡
;

4122 
blkaddr
 = (!
	`°rcmp
(
cuºít_dú
->
d_«me
.
«me
, "cpt1") ?

4123 
BLKADDR_CPT1
 : 
BLKADDR_CPT0
);

4125 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_INST_REQ_PC
);

4126 
	`£q_¥ötf
(
fûp
, "CPT in°ru˘i⁄Ñeque°† %Œu\n", 
ªg
);

4127 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_INST_LATENCY_PC
);

4128 
	`£q_¥ötf
(
fûp
, "CPT in°ru˘i⁄Ü©ícy %Œu\n", 
ªg
);

4129 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RD_REQ_PC
);

4130 
	`£q_¥ötf
(
fûp
, "CPT NCBÑódÑeque°† %Œu\n", 
ªg
);

4131 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RD_LATENCY_PC
);

4132 
	`£q_¥ötf
(
fûp
, "CPT NCBÑódÜ©ícy %Œu\n", 
ªg
);

4133 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_RD_UC_PC
);

4134 
	`£q_¥ötf
(
fûp
, "CPTÑódÑeque°†ˇu£d by UC fûl† %Œu\n", 
ªg
);

4135 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_ACTIVE_CYCLES_PC
);

4136 
	`£q_¥ötf
(
fûp
, "CPTá˘ivêcy˛e†p¯ %Œu\n", 
ªg
);

4137 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
CPT_AF_CPTCLK_CNT
);

4138 
	`£q_¥ötf
(
fûp
, "CPT clock cou¡Ö¯ %Œu\n", 
ªg
);

4141 
	}
}

4143 
RVU_DEBUG_SEQ_FOPS
(
˝t_pc
, 
˝t_pc_di•œy
, 
NULL
);

4145 
	$rvu_dbg_˝t_öô
(
rvu
 *rvu, 
blkaddr
)

4147 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

4150 i‡(
blkaddr
 =
BLKADDR_CPT0
) {

4151 
rvu
->
rvu_dbg
.
˝t
 = 
	`debugfs_¸óã_dú
("˝t",Ñvu->rvu_dbg.
roŸ
);

4153 
rvu
->
rvu_dbg
.
˝t
 = 
	`debugfs_¸óã_dú
("cpt1",

4154 
rvu
->
rvu_dbg
.
roŸ
);

4157 
	`debugfs_¸óã_fûe
("˝t_pc", 0600, 
rvu
->
rvu_dbg
.
˝t
,Ñvu,

4158 &
rvu_dbg_˝t_pc_f›s
);

4159 
	`debugfs_¸óã_fûe
("˝t_ígöes_°s", 0600, 
rvu
->
rvu_dbg
.
˝t
,Ñvu,

4160 &
rvu_dbg_˝t_ígöes_°s_f›s
);

4161 
	`debugfs_¸óã_fûe
("˝t_ígöes_öfo", 0600, 
rvu
->
rvu_dbg
.
˝t
,Ñvu,

4162 &
rvu_dbg_˝t_ígöes_öfo_f›s
);

4163 
	`debugfs_¸óã_fûe
("˝t_lfs_öfo", 0600, 
rvu
->
rvu_dbg
.
˝t
,Ñvu,

4164 &
rvu_dbg_˝t_lfs_öfo_f›s
);

4165 
	`debugfs_¸óã_fûe
("˝t_îr_öfo", 0600, 
rvu
->
rvu_dbg
.
˝t
,Ñvu,

4166 &
rvu_dbg_˝t_îr_öfo_f›s
);

4167 
	}
}

4169 c⁄° *
	$rvu_gë_dbg_dú_«me
(
rvu
 *rvu)

4171 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

4175 
	}
}

4177 
	$rvu_dbg_öô
(
rvu
 *rvu)

4179 
rvu
->
rvu_dbg
.
roŸ
 = 
	`debugfs_¸óã_dú
(
	`rvu_gë_dbg_dú_«me
‘vu), 
NULL
);

4181 
	`debugfs_¸óã_fûe
("r§c_Æloc", 0444, 
rvu
->
rvu_dbg
.
roŸ
,Ñvu,

4182 &
rvu_dbg_r§c_°©us_f›s
);

4184 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

4185 
	`debugfs_¸óã_fûe
("lmt°_m≠_èbÀ", 0444, 
rvu
->
rvu_dbg
.
roŸ
,

4186 
rvu
, &
rvu_dbg_lmt°_m≠_èbÀ_f›s
);

4188 i‡(!
	`cgx_gë_cgx˙t_max
())

4189 
¸óã
;

4191 i‡(
	`is_rvu_Ÿx2
(
rvu
))

4192 
	`debugfs_¸óã_fûe
("rvu_pf_cgx_m≠", 0444, 
rvu
->
rvu_dbg
.
roŸ
,

4193 
rvu
, &
rvu_dbg_rvu_pf_cgx_m≠_f›s
);

4195 
	`debugfs_¸óã_fûe
("rvu_pf_Ωm_m≠", 0444, 
rvu
->
rvu_dbg
.
roŸ
,

4196 
rvu
, &
rvu_dbg_rvu_pf_cgx_m≠_f›s
);

4198 
¸óã
:

4199 
	`rvu_dbg_≈a_öô
(
rvu
);

4200 
	`rvu_dbg_nix_öô
(
rvu
, 
BLKADDR_NIX0
);

4202 
	`rvu_dbg_nix_öô
(
rvu
, 
BLKADDR_NIX1
);

4203 
	`rvu_dbg_cgx_öô
(
rvu
);

4204 
	`rvu_dbg_≈c_öô
(
rvu
);

4205 
	`rvu_dbg_sso_öô
(
rvu
);

4206 
	`rvu_dbg_˝t_öô
(
rvu
, 
BLKADDR_CPT0
);

4207 
	`rvu_dbg_˝t_öô
(
rvu
, 
BLKADDR_CPT1
);

4208 
	`rvu_dbg_mcs_öô
(
rvu
);

4209 
	}
}

4211 
	$rvu_dbg_exô
(
rvu
 *rvu)

4213 
	`debugfs_ªmove_ªcursive
(
rvu
->
rvu_dbg
.
roŸ
);

4214 
	}
}

	@rvu_devlink.c

8 
	~<löux/bôfõld.h
>

10 
	~"rvu.h
"

11 
	~"rvu_ªg.h
"

12 
	~"rvu_°ru˘.h
"

13 
	~"rvu_≈c_hash.h
"

15 
	#DRV_NAME
 "o˘e⁄tx2-af"

	)

17 
	$rvu_ªp‹t_∑ú_°¨t
(
devlök_fmsg
 *
fmsg
, c⁄° *
«me
)

19 
îr
;

21 
îr
 = 
	`devlök_fmsg_∑ú_√°_°¨t
(
fmsg
, 
«me
);

22 i‡(
îr
)

23  
îr
;

25  
	`devlök_fmsg_obj_√°_°¨t
(
fmsg
);

26 
	}
}

28 
	$rvu_ªp‹t_∑ú_íd
(
devlök_fmsg
 *
fmsg
)

30 
îr
;

32 
îr
 = 
	`devlök_fmsg_obj_√°_íd
(
fmsg
);

33 i‡(
îr
)

34  
îr
;

36  
	`devlök_fmsg_∑ú_√°_íd
(
fmsg
);

37 
	}
}

39 
boﬁ
 
	$rvu_comm⁄_ªque°_úq
(
rvu
 *rvu, 
off£t
,

40 c⁄° *
«me
, 
úq_h™dÀr_t
 
‚
)

42 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

43 
rc
;

45 
	`•rötf
(&
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], "%s", 
«me
);

46 
rc
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
off£t
), 
‚
, 0,

47 &
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], 
rvu_dl
);

48 i‡(
rc
)

49 
	`dev_w¨n
(
rvu
->
dev
, "FaûedÅÿªgi°î %†úq\n", 
«me
);

51 
rvu
->
úq_Æloˇãd
[
off£t
] = 
åue
;

53  
rvu
->
úq_Æloˇãd
[
off£t
];

54 
	}
}

56 
	$rvu_nix_öå_w‹k
(
w‹k_°ru˘
 *
w‹k
)

58 
rvu_nix_hó…h_ªp‹ãrs
 *
rvu_nix_hó…h_ªp‹ãr
;

60 
rvu_nix_hó…h_ªp‹ãr
 = 
	`c⁄èöî_of
(
w‹k
, 
rvu_nix_hó…h_ªp‹ãrs
, 
öå_w‹k
);

61 
	`devlök_hó…h_ªp‹t
(
rvu_nix_hó…h_ªp‹ãr
->
rvu_hw_nix_öå_ªp‹ãr
,

63 
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
);

64 
	}
}

66 
úqªtu∫_t
 
	$rvu_nix_af_rvu_öå_h™dÀr
(
úq
, *
rvu_úq
)

68 
rvu_nix_evít_˘x
 *
nix_evít_c⁄ãxt
;

69 
rvu_devlök
 *
rvu_dl
 = 
rvu_úq
;

70 
rvu
 *rvu;

71 
blkaddr
;

72 
u64
 
öå
;

74 
rvu
 = 
rvu_dl
->rvu;

75 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

76 i‡(
blkaddr
 < 0)

77  
IRQ_NONE
;

79 
nix_evít_c⁄ãxt
 = 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
;

80 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_RVU_INT
);

81 
nix_evít_c⁄ãxt
->
nix_af_rvu_öt
 = 
öå
;

84 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RVU_INT
, 
öå
);

85 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RVU_INT_ENA_W1C
, ~0ULL);

86 
	`queue_w‹k
(
rvu_dl
->
devlök_wq
, &rvu_dl->
rvu_nix_hó…h_ªp‹ãr
->
öå_w‹k
);

88  
IRQ_HANDLED
;

89 
	}
}

91 
	$rvu_nix_gí_w‹k
(
w‹k_°ru˘
 *
w‹k
)

93 
rvu_nix_hó…h_ªp‹ãrs
 *
rvu_nix_hó…h_ªp‹ãr
;

95 
rvu_nix_hó…h_ªp‹ãr
 = 
	`c⁄èöî_of
(
w‹k
, 
rvu_nix_hó…h_ªp‹ãrs
, 
gí_w‹k
);

96 
	`devlök_hó…h_ªp‹t
(
rvu_nix_hó…h_ªp‹ãr
->
rvu_hw_nix_gí_ªp‹ãr
,

98 
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
);

99 
	}
}

101 
úqªtu∫_t
 
	$rvu_nix_af_rvu_gí_h™dÀr
(
úq
, *
rvu_úq
)

103 
rvu_nix_evít_˘x
 *
nix_evít_c⁄ãxt
;

104 
rvu_devlök
 *
rvu_dl
 = 
rvu_úq
;

105 
rvu
 *rvu;

106 
blkaddr
;

107 
u64
 
öå
;

109 
rvu
 = 
rvu_dl
->rvu;

110 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

111 i‡(
blkaddr
 < 0)

112  
IRQ_NONE
;

114 
nix_evít_c⁄ãxt
 = 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
;

115 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_GEN_INT
);

116 
nix_evít_c⁄ãxt
->
nix_af_rvu_gí
 = 
öå
;

119 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_GEN_INT
, 
öå
);

120 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_GEN_INT_ENA_W1C
, ~0ULL);

121 
	`queue_w‹k
(
rvu_dl
->
devlök_wq
, &rvu_dl->
rvu_nix_hó…h_ªp‹ãr
->
gí_w‹k
);

123  
IRQ_HANDLED
;

124 
	}
}

126 
	$rvu_nix_îr_w‹k
(
w‹k_°ru˘
 *
w‹k
)

128 
rvu_nix_hó…h_ªp‹ãrs
 *
rvu_nix_hó…h_ªp‹ãr
;

130 
rvu_nix_hó…h_ªp‹ãr
 = 
	`c⁄èöî_of
(
w‹k
, 
rvu_nix_hó…h_ªp‹ãrs
, 
îr_w‹k
);

131 
	`devlök_hó…h_ªp‹t
(
rvu_nix_hó…h_ªp‹ãr
->
rvu_hw_nix_îr_ªp‹ãr
,

133 
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
);

134 
	}
}

136 
úqªtu∫_t
 
	$rvu_nix_af_rvu_îr_h™dÀr
(
úq
, *
rvu_úq
)

138 
rvu_nix_evít_˘x
 *
nix_evít_c⁄ãxt
;

139 
rvu_devlök
 *
rvu_dl
 = 
rvu_úq
;

140 
rvu
 *rvu;

141 
blkaddr
;

142 
u64
 
öå
;

144 
rvu
 = 
rvu_dl
->rvu;

145 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

146 i‡(
blkaddr
 < 0)

147  
IRQ_NONE
;

149 
nix_evít_c⁄ãxt
 = 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
;

150 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_ERR_INT
);

151 
nix_evít_c⁄ãxt
->
nix_af_rvu_îr
 = 
öå
;

154 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_ERR_INT
, 
öå
);

155 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_ERR_INT_ENA_W1C
, ~0ULL);

156 
	`queue_w‹k
(
rvu_dl
->
devlök_wq
, &rvu_dl->
rvu_nix_hó…h_ªp‹ãr
->
îr_w‹k
);

158  
IRQ_HANDLED
;

159 
	}
}

161 
	$rvu_nix_øs_w‹k
(
w‹k_°ru˘
 *
w‹k
)

163 
rvu_nix_hó…h_ªp‹ãrs
 *
rvu_nix_hó…h_ªp‹ãr
;

165 
rvu_nix_hó…h_ªp‹ãr
 = 
	`c⁄èöî_of
(
w‹k
, 
rvu_nix_hó…h_ªp‹ãrs
, 
øs_w‹k
);

166 
	`devlök_hó…h_ªp‹t
(
rvu_nix_hó…h_ªp‹ãr
->
rvu_hw_nix_øs_ªp‹ãr
,

168 
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
);

169 
	}
}

171 
úqªtu∫_t
 
	$rvu_nix_af_rvu_øs_h™dÀr
(
úq
, *
rvu_úq
)

173 
rvu_nix_evít_˘x
 *
nix_evít_c⁄ãxt
;

174 
rvu_devlök
 *
rvu_dl
 = 
rvu_úq
;

175 
rvu
 *rvu;

176 
blkaddr
;

177 
u64
 
öå
;

179 
rvu
 = 
rvu_dl
->rvu;

180 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

181 i‡(
blkaddr
 < 0)

182  
IRQ_NONE
;

184 
nix_evít_c⁄ãxt
 = 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
;

185 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_ERR_INT
);

186 
nix_evít_c⁄ãxt
->
nix_af_rvu_øs
 = 
öå
;

189 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RAS
, 
öå
);

190 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RAS_ENA_W1C
, ~0ULL);

191 
	`queue_w‹k
(
rvu_dl
->
devlök_wq
, &rvu_dl->
rvu_nix_hó…h_ªp‹ãr
->
øs_w‹k
);

193  
IRQ_HANDLED
;

194 
	}
}

196 
	$rvu_nix_uƒegi°î_öãºu±s
(
rvu
 *rvu)

198 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

199 
offs
, 
i
, 
blkaddr
;

201 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

202 i‡(
blkaddr
 < 0)

205 
offs
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_PRIV_AF_INT_CFG
) & 0x3ff;

206 i‡(!
offs
)

209 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RVU_INT_ENA_W1C
, ~0ULL);

210 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_GEN_INT_ENA_W1C
, ~0ULL);

211 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_ERR_INT_ENA_W1C
, ~0ULL);

212 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RAS_ENA_W1C
, ~0ULL);

214 i‡(
rvu
->
úq_Æloˇãd
[
offs
 + 
NIX_AF_INT_VEC_RVU
]) {

215 
	`‰ì_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
offs
 + 
NIX_AF_INT_VEC_RVU
),

216 
rvu_dl
);

217 
rvu
->
úq_Æloˇãd
[
offs
 + 
NIX_AF_INT_VEC_RVU
] = 
Ál£
;

220 
i
 = 
NIX_AF_INT_VEC_GEN
; i < 
NIX_AF_INT_VEC_CNT
; i++)

221 i‡(
rvu
->
úq_Æloˇãd
[
offs
 + 
i
]) {

222 
	`‰ì_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
offs
 + 
i
), 
rvu_dl
);

223 
rvu
->
úq_Æloˇãd
[
offs
 + 
i
] = 
Ál£
;

225 
	}
}

227 
	$rvu_nix_ªgi°î_öãºu±s
(
rvu
 *rvu)

229 
blkaddr
, 
ba£
;

230 
boﬁ
 
rc
;

232 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

233 i‡(
blkaddr
 < 0)

234  
blkaddr
;

237 
ba£
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_PRIV_AF_INT_CFG
) & 0x3ff;

238 i‡(!
ba£
) {

239 
	`dev_w¨n
(
rvu
->
dev
,

241 
blkaddr
 - 
BLKADDR_NIX0
);

245 
rc
 = 
	`rvu_comm⁄_ªque°_úq
(
rvu
, 
ba£
 + 
NIX_AF_INT_VEC_RVU
,

247 
rvu_nix_af_rvu_öå_h™dÀr
);

248 i‡(!
rc
)

249 
îr
;

250 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RVU_INT_ENA_W1S
, ~0ULL);

253 
rc
 = 
	`rvu_comm⁄_ªque°_úq
(
rvu
, 
ba£
 + 
NIX_AF_INT_VEC_GEN
,

255 
rvu_nix_af_rvu_gí_h™dÀr
);

256 i‡(!
rc
)

257 
îr
;

258 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_GEN_INT_ENA_W1S
, ~0ULL);

261 
rc
 = 
	`rvu_comm⁄_ªque°_úq
(
rvu
, 
ba£
 + 
NIX_AF_INT_VEC_AF_ERR
,

263 
rvu_nix_af_rvu_îr_h™dÀr
);

264 i‡(!
rc
)

265 
îr
;

266 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_ERR_INT_ENA_W1S
, ~0ULL);

269 
rc
 = 
	`rvu_comm⁄_ªque°_úq
(
rvu
, 
ba£
 + 
NIX_AF_INT_VEC_POISON
,

271 
rvu_nix_af_rvu_øs_h™dÀr
);

272 i‡(!
rc
)

273 
îr
;

274 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RAS_ENA_W1S
, ~0ULL);

277 
îr
:

278 
	`rvu_nix_uƒegi°î_öãºu±s
(
rvu
);

279  
rc
;

280 
	}
}

282 
	$rvu_nix_ªp‹t_show
(
devlök_fmsg
 *
fmsg
, *
˘x
,

283 
nix_af_rvu_hó…h
 
hó…h_ªp‹ãr
)

285 
rvu_nix_evít_˘x
 *
nix_evít_c⁄ãxt
;

286 
u64
 
öå_vÆ
;

287 
îr
;

289 
nix_evít_c⁄ãxt
 = 
˘x
;

290 
hó…h_ªp‹ãr
) {

291 
NIX_AF_RVU_INTR
:

292 
öå_vÆ
 = 
nix_evít_c⁄ãxt
->
nix_af_rvu_öt
;

293 
îr
 = 
	`rvu_ªp‹t_∑ú_°¨t
(
fmsg
, "NIX_AF_RVU");

294 i‡(
îr
)

295  
îr
;

296 
îr
 = 
	`devlök_fmsg_u64_∑ú_put
(
fmsg
, "\tNIX RVU Interrupt Reg ",

297 
nix_evít_c⁄ãxt
->
nix_af_rvu_öt
);

298 i‡(
îr
)

299  
îr
;

300 i‡(
öå_vÆ
 & 
	`BIT_ULL
(0)) {

301 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tUnmap Slot Error");

302 i‡(
îr
)

303  
îr
;

305 
îr
 = 
	`rvu_ªp‹t_∑ú_íd
(
fmsg
);

306 i‡(
îr
)

307  
îr
;

309 
NIX_AF_RVU_GEN
:

310 
öå_vÆ
 = 
nix_evít_c⁄ãxt
->
nix_af_rvu_gí
;

311 
îr
 = 
	`rvu_ªp‹t_∑ú_°¨t
(
fmsg
, "NIX_AF_GENERAL");

312 i‡(
îr
)

313  
îr
;

314 
îr
 = 
	`devlök_fmsg_u64_∑ú_put
(
fmsg
, "\tNIX General Interrupt Reg ",

315 
nix_evít_c⁄ãxt
->
nix_af_rvu_gí
);

316 i‡(
îr
)

317  
îr
;

318 i‡(
öå_vÆ
 & 
	`BIT_ULL
(0)) {

319 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tRx multicastÖkt drop");

320 i‡(
îr
)

321  
îr
;

323 i‡(
öå_vÆ
 & 
	`BIT_ULL
(1)) {

324 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tRx mirrorÖkt drop");

325 i‡(
îr
)

326  
îr
;

328 i‡(
öå_vÆ
 & 
	`BIT_ULL
(4)) {

329 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tSMQ flush done");

330 i‡(
îr
)

331  
îr
;

333 
îr
 = 
	`rvu_ªp‹t_∑ú_íd
(
fmsg
);

334 i‡(
îr
)

335  
îr
;

337 
NIX_AF_RVU_ERR
:

338 
öå_vÆ
 = 
nix_evít_c⁄ãxt
->
nix_af_rvu_îr
;

339 
îr
 = 
	`rvu_ªp‹t_∑ú_°¨t
(
fmsg
, "NIX_AF_ERR");

340 i‡(
îr
)

341  
îr
;

342 
îr
 = 
	`devlök_fmsg_u64_∑ú_put
(
fmsg
, "\tNIX Error Interrupt Reg ",

343 
nix_evít_c⁄ãxt
->
nix_af_rvu_îr
);

344 i‡(
îr
)

345  
îr
;

346 i‡(
öå_vÆ
 & 
	`BIT_ULL
(14)) {

347 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFault on NIX_AQ_INST_SÑead");

348 i‡(
îr
)

349  
îr
;

351 i‡(
öå_vÆ
 & 
	`BIT_ULL
(13)) {

352 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFault on NIX_AQ_RES_S write");

353 i‡(
îr
)

354  
îr
;

356 i‡(
öå_vÆ
 & 
	`BIT_ULL
(12)) {

357 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tAQ Doorbell Error");

358 i‡(
îr
)

359  
îr
;

361 i‡(
öå_vÆ
 & 
	`BIT_ULL
(6)) {

362 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tRx on unmapped PF_FUNC");

363 i‡(
îr
)

364  
îr
;

366 i‡(
öå_vÆ
 & 
	`BIT_ULL
(5)) {

367 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tRx multicastÑeplicationÉrror");

368 i‡(
îr
)

369  
îr
;

371 i‡(
öå_vÆ
 & 
	`BIT_ULL
(4)) {

372 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFault on NIX_RX_MCE_SÑead");

373 i‡(
îr
)

374  
îr
;

376 i‡(
öå_vÆ
 & 
	`BIT_ULL
(3)) {

377 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFault on multicast WQEÑead");

378 i‡(
îr
)

379  
îr
;

381 i‡(
öå_vÆ
 & 
	`BIT_ULL
(2)) {

382 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFault on mirror WQEÑead");

383 i‡(
îr
)

384  
îr
;

386 i‡(
öå_vÆ
 & 
	`BIT_ULL
(1)) {

387 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFault on mirrorÖkt write");

388 i‡(
îr
)

389  
îr
;

391 i‡(
öå_vÆ
 & 
	`BIT_ULL
(0)) {

392 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFault on multicastÖkt write");

393 i‡(
îr
)

394  
îr
;

396 
îr
 = 
	`rvu_ªp‹t_∑ú_íd
(
fmsg
);

397 i‡(
îr
)

398  
îr
;

400 
NIX_AF_RVU_RAS
:

401 
öå_vÆ
 = 
nix_evít_c⁄ãxt
->
nix_af_rvu_îr
;

402 
îr
 = 
	`rvu_ªp‹t_∑ú_°¨t
(
fmsg
, "NIX_AF_RAS");

403 i‡(
îr
)

404  
îr
;

405 
îr
 = 
	`devlök_fmsg_u64_∑ú_put
(
fmsg
, "\tNIX RAS Interrupt Reg ",

406 
nix_evít_c⁄ãxt
->
nix_af_rvu_îr
);

407 i‡(
îr
)

408  
îr
;

409 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tPoison Data on:");

410 i‡(
îr
)

411  
îr
;

412 i‡(
öå_vÆ
 & 
	`BIT_ULL
(34)) {

413 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX_AQ_INST_S");

414 i‡(
îr
)

415  
îr
;

417 i‡(
öå_vÆ
 & 
	`BIT_ULL
(33)) {

418 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX_AQ_RES_S");

419 i‡(
îr
)

420  
îr
;

422 i‡(
öå_vÆ
 & 
	`BIT_ULL
(32)) {

423 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tHW ctx");

424 i‡(
îr
)

425  
îr
;

427 i‡(
öå_vÆ
 & 
	`BIT_ULL
(4)) {

428 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tPacket from mirror buffer");

429 i‡(
îr
)

430  
îr
;

432 i‡(
öå_vÆ
 & 
	`BIT_ULL
(3)) {

433 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tPacket from multicast buffer");

435 i‡(
îr
)

436  
îr
;

438 i‡(
öå_vÆ
 & 
	`BIT_ULL
(2)) {

439 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tWQEÑead from mirror buffer");

440 i‡(
îr
)

441  
îr
;

443 i‡(
öå_vÆ
 & 
	`BIT_ULL
(1)) {

444 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tWQEÑead from multicast buffer");

445 i‡(
îr
)

446  
îr
;

448 i‡(
öå_vÆ
 & 
	`BIT_ULL
(0)) {

449 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX_RX_MCE_SÑead");

450 i‡(
îr
)

451  
îr
;

453 
îr
 = 
	`rvu_ªp‹t_∑ú_íd
(
fmsg
);

454 i‡(
îr
)

455  
îr
;

458  -
EINVAL
;

462 
	}
}

464 
	$rvu_hw_nix_öå_dump
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

465 
devlök_fmsg
 *
fmsg
, *
˘x
)

467 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

468 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

469 
rvu_nix_evít_˘x
 *
nix_˘x
;

471 
nix_˘x
 = 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
;

473  
˘x
 ? 
	`rvu_nix_ªp‹t_show
(
fmsg
, ctx, 
NIX_AF_RVU_INTR
) :

474 
	`rvu_nix_ªp‹t_show
(
fmsg
, 
nix_˘x
, 
NIX_AF_RVU_INTR
);

475 
	}
}

477 
	$rvu_hw_nix_öå_ªcovî
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

478 *
˘x
)

480 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

481 
rvu_nix_evít_˘x
 *
nix_evít_˘x
 = 
˘x
;

482 
blkaddr
;

484 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

485 i‡(
blkaddr
 < 0)

486  
blkaddr
;

488 i‡(
nix_evít_˘x
->
nix_af_rvu_öt
)

489 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RVU_INT_ENA_W1S
, ~0ULL);

492 
	}
}

494 
	$rvu_hw_nix_gí_dump
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

495 
devlök_fmsg
 *
fmsg
, *
˘x
)

497 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

498 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

499 
rvu_nix_evít_˘x
 *
nix_˘x
;

501 
nix_˘x
 = 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
;

503  
˘x
 ? 
	`rvu_nix_ªp‹t_show
(
fmsg
, ctx, 
NIX_AF_RVU_GEN
) :

504 
	`rvu_nix_ªp‹t_show
(
fmsg
, 
nix_˘x
, 
NIX_AF_RVU_GEN
);

505 
	}
}

507 
	$rvu_hw_nix_gí_ªcovî
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

508 *
˘x
)

510 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

511 
rvu_nix_evít_˘x
 *
nix_evít_˘x
 = 
˘x
;

512 
blkaddr
;

514 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

515 i‡(
blkaddr
 < 0)

516  
blkaddr
;

518 i‡(
nix_evít_˘x
->
nix_af_rvu_gí
)

519 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_GEN_INT_ENA_W1S
, ~0ULL);

522 
	}
}

524 
	$rvu_hw_nix_îr_dump
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

525 
devlök_fmsg
 *
fmsg
, *
˘x
)

527 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

528 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

529 
rvu_nix_evít_˘x
 *
nix_˘x
;

531 
nix_˘x
 = 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
;

533  
˘x
 ? 
	`rvu_nix_ªp‹t_show
(
fmsg
, ctx, 
NIX_AF_RVU_ERR
) :

534 
	`rvu_nix_ªp‹t_show
(
fmsg
, 
nix_˘x
, 
NIX_AF_RVU_ERR
);

535 
	}
}

537 
	$rvu_hw_nix_îr_ªcovî
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

538 *
˘x
)

540 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

541 
rvu_nix_evít_˘x
 *
nix_evít_˘x
 = 
˘x
;

542 
blkaddr
;

544 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

545 i‡(
blkaddr
 < 0)

546  
blkaddr
;

548 i‡(
nix_evít_˘x
->
nix_af_rvu_îr
)

549 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_ERR_INT_ENA_W1S
, ~0ULL);

552 
	}
}

554 
	$rvu_hw_nix_øs_dump
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

555 
devlök_fmsg
 *
fmsg
, *
˘x
)

557 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

558 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

559 
rvu_nix_evít_˘x
 *
nix_˘x
;

561 
nix_˘x
 = 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
;

563  
˘x
 ? 
	`rvu_nix_ªp‹t_show
(
fmsg
, ctx, 
NIX_AF_RVU_RAS
) :

564 
	`rvu_nix_ªp‹t_show
(
fmsg
, 
nix_˘x
, 
NIX_AF_RVU_RAS
);

565 
	}
}

567 
	$rvu_hw_nix_øs_ªcovî
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

568 *
˘x
)

570 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

571 
rvu_nix_evít_˘x
 *
nix_evít_˘x
 = 
˘x
;

572 
blkaddr
;

574 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

575 i‡(
blkaddr
 < 0)

576  
blkaddr
;

578 i‡(
nix_evít_˘x
->
nix_af_rvu_öt
)

579 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RAS_ENA_W1S
, ~0ULL);

582 
	}
}

584 
RVU_REPORTERS
(
hw_nix_öå
);

585 
RVU_REPORTERS
(
hw_nix_gí
);

586 
RVU_REPORTERS
(
hw_nix_îr
);

587 
RVU_REPORTERS
(
hw_nix_øs
);

589 
rvu_nix_hó…h_ªp‹ãrs_de°roy
(
rvu_devlök
 *
rvu_dl
);

591 
	$rvu_nix_ªgi°î_ªp‹ãrs
(
rvu_devlök
 *
rvu_dl
)

593 
rvu_nix_hó…h_ªp‹ãrs
 *
rvu_ªp‹ãrs
;

594 
rvu_nix_evít_˘x
 *
nix_evít_c⁄ãxt
;

595 
rvu
 *rvu = 
rvu_dl
->rvu;

597 
rvu_ªp‹ãrs
 = 
	`kzÆloc
((*rvu_ªp‹ãrs), 
GFP_KERNEL
);

598 i‡(!
rvu_ªp‹ãrs
)

599  -
ENOMEM
;

601 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
 = 
rvu_ªp‹ãrs
;

602 
nix_evít_c⁄ãxt
 = 
	`kzÆloc
((*nix_evít_c⁄ãxt), 
GFP_KERNEL
);

603 i‡(!
nix_evít_c⁄ãxt
)

604  -
ENOMEM
;

606 
rvu_ªp‹ãrs
->
nix_evít_˘x
 = 
nix_evít_c⁄ãxt
;

607 
rvu_ªp‹ãrs
->
rvu_hw_nix_öå_ªp‹ãr
 =

608 
	`devlök_hó…h_ªp‹ãr_¸óã
(
rvu_dl
->
dl
, &
rvu_hw_nix_öå_ªp‹ãr_›s
, 0, 1, 
rvu
);

609 i‡(
	`IS_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_öå_ªp‹ãr
)) {

610 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo create hw_nix_intrÑeporter,Érr=%ld\n",

611 
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_öå_ªp‹ãr
));

612  
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_öå_ªp‹ãr
);

615 
rvu_ªp‹ãrs
->
rvu_hw_nix_gí_ªp‹ãr
 =

616 
	`devlök_hó…h_ªp‹ãr_¸óã
(
rvu_dl
->
dl
, &
rvu_hw_nix_gí_ªp‹ãr_›s
, 0, 1, 
rvu
);

617 i‡(
	`IS_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_gí_ªp‹ãr
)) {

618 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo create hw_nix_genÑeporter,Érr=%ld\n",

619 
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_gí_ªp‹ãr
));

620  
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_gí_ªp‹ãr
);

623 
rvu_ªp‹ãrs
->
rvu_hw_nix_îr_ªp‹ãr
 =

624 
	`devlök_hó…h_ªp‹ãr_¸óã
(
rvu_dl
->
dl
, &
rvu_hw_nix_îr_ªp‹ãr_›s
, 0, 1, 
rvu
);

625 i‡(
	`IS_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_îr_ªp‹ãr
)) {

626 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo create hw_nix_errÑeporter,Érr=%ld\n",

627 
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_îr_ªp‹ãr
));

628  
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_îr_ªp‹ãr
);

631 
rvu_ªp‹ãrs
->
rvu_hw_nix_øs_ªp‹ãr
 =

632 
	`devlök_hó…h_ªp‹ãr_¸óã
(
rvu_dl
->
dl
, &
rvu_hw_nix_øs_ªp‹ãr_›s
, 0, 1, 
rvu
);

633 i‡(
	`IS_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_øs_ªp‹ãr
)) {

634 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo create hw_nix_rasÑeporter,Érr=%ld\n",

635 
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_øs_ªp‹ãr
));

636  
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_nix_øs_ªp‹ãr
);

639 
rvu_dl
->
devlök_wq
 = 
	`¸óã_w‹kqueue
("rvu_devlink_wq");

640 i‡(!
rvu_dl
->
devlök_wq
)

641 
îr
;

643 
	`INIT_WORK
(&
rvu_ªp‹ãrs
->
öå_w‹k
, 
rvu_nix_öå_w‹k
);

644 
	`INIT_WORK
(&
rvu_ªp‹ãrs
->
gí_w‹k
, 
rvu_nix_gí_w‹k
);

645 
	`INIT_WORK
(&
rvu_ªp‹ãrs
->
îr_w‹k
, 
rvu_nix_îr_w‹k
);

646 
	`INIT_WORK
(&
rvu_ªp‹ãrs
->
øs_w‹k
, 
rvu_nix_øs_w‹k
);

649 
îr
:

650 
	`rvu_nix_hó…h_ªp‹ãrs_de°roy
(
rvu_dl
);

651  -
ENOMEM
;

652 
	}
}

654 
	$rvu_nix_hó…h_ªp‹ãrs_¸óã
(
rvu_devlök
 *
rvu_dl
)

656 
rvu
 *rvu = 
rvu_dl
->rvu;

657 
îr
;

659 
îr
 = 
	`rvu_nix_ªgi°î_ªp‹ãrs
(
rvu_dl
);

660 i‡(
îr
) {

661 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo createÇixÑeporter,Érr =%d\n",

662 
îr
);

663  
îr
;

665 
	`rvu_nix_ªgi°î_öãºu±s
(
rvu
);

668 
	}
}

670 
	$rvu_nix_hó…h_ªp‹ãrs_de°roy
(
rvu_devlök
 *
rvu_dl
)

672 
rvu_nix_hó…h_ªp‹ãrs
 *
nix_ªp‹ãrs
;

673 
rvu
 *rvu = 
rvu_dl
->rvu;

675 
nix_ªp‹ãrs
 = 
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
;

677 i‡(!
nix_ªp‹ãrs
->
rvu_hw_nix_øs_ªp‹ãr
)

679 i‡(!
	`IS_ERR_OR_NULL
(
nix_ªp‹ãrs
->
rvu_hw_nix_öå_ªp‹ãr
))

680 
	`devlök_hó…h_ªp‹ãr_de°roy
(
nix_ªp‹ãrs
->
rvu_hw_nix_öå_ªp‹ãr
);

682 i‡(!
	`IS_ERR_OR_NULL
(
nix_ªp‹ãrs
->
rvu_hw_nix_gí_ªp‹ãr
))

683 
	`devlök_hó…h_ªp‹ãr_de°roy
(
nix_ªp‹ãrs
->
rvu_hw_nix_gí_ªp‹ãr
);

685 i‡(!
	`IS_ERR_OR_NULL
(
nix_ªp‹ãrs
->
rvu_hw_nix_îr_ªp‹ãr
))

686 
	`devlök_hó…h_ªp‹ãr_de°roy
(
nix_ªp‹ãrs
->
rvu_hw_nix_îr_ªp‹ãr
);

688 i‡(!
	`IS_ERR_OR_NULL
(
nix_ªp‹ãrs
->
rvu_hw_nix_øs_ªp‹ãr
))

689 
	`devlök_hó…h_ªp‹ãr_de°roy
(
nix_ªp‹ãrs
->
rvu_hw_nix_øs_ªp‹ãr
);

691 
	`rvu_nix_uƒegi°î_öãºu±s
(
rvu
);

692 
	`k‰ì
(
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
->
nix_evít_˘x
);

693 
	`k‰ì
(
rvu_dl
->
rvu_nix_hó…h_ªp‹ãr
);

694 
	}
}

696 
	$rvu_≈a_öå_w‹k
(
w‹k_°ru˘
 *
w‹k
)

698 
rvu_≈a_hó…h_ªp‹ãrs
 *
rvu_≈a_hó…h_ªp‹ãr
;

700 
rvu_≈a_hó…h_ªp‹ãr
 = 
	`c⁄èöî_of
(
w‹k
, 
rvu_≈a_hó…h_ªp‹ãrs
, 
öå_w‹k
);

701 
	`devlök_hó…h_ªp‹t
(
rvu_≈a_hó…h_ªp‹ãr
->
rvu_hw_≈a_öå_ªp‹ãr
,

703 
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
);

704 
	}
}

706 
úqªtu∫_t
 
	$rvu_≈a_af_rvu_öå_h™dÀr
(
úq
, *
rvu_úq
)

708 
rvu_≈a_evít_˘x
 *
≈a_evít_c⁄ãxt
;

709 
rvu_devlök
 *
rvu_dl
 = 
rvu_úq
;

710 
rvu
 *rvu;

711 
blkaddr
;

712 
u64
 
öå
;

714 
rvu
 = 
rvu_dl
->rvu;

715 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

716 i‡(
blkaddr
 < 0)

717  
IRQ_NONE
;

719 
≈a_evít_c⁄ãxt
 = 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
;

720 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPA_AF_RVU_INT
);

721 
≈a_evít_c⁄ãxt
->
≈a_af_rvu_öt
 = 
öå
;

724 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RVU_INT
, 
öå
);

725 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RVU_INT_ENA_W1C
, ~0ULL);

726 
	`queue_w‹k
(
rvu_dl
->
devlök_wq
, &rvu_dl->
rvu_≈a_hó…h_ªp‹ãr
->
öå_w‹k
);

728  
IRQ_HANDLED
;

729 
	}
}

731 
	$rvu_≈a_gí_w‹k
(
w‹k_°ru˘
 *
w‹k
)

733 
rvu_≈a_hó…h_ªp‹ãrs
 *
rvu_≈a_hó…h_ªp‹ãr
;

735 
rvu_≈a_hó…h_ªp‹ãr
 = 
	`c⁄èöî_of
(
w‹k
, 
rvu_≈a_hó…h_ªp‹ãrs
, 
gí_w‹k
);

736 
	`devlök_hó…h_ªp‹t
(
rvu_≈a_hó…h_ªp‹ãr
->
rvu_hw_≈a_gí_ªp‹ãr
,

738 
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
);

739 
	}
}

741 
úqªtu∫_t
 
	$rvu_≈a_af_gí_öå_h™dÀr
(
úq
, *
rvu_úq
)

743 
rvu_≈a_evít_˘x
 *
≈a_evít_c⁄ãxt
;

744 
rvu_devlök
 *
rvu_dl
 = 
rvu_úq
;

745 
rvu
 *rvu;

746 
blkaddr
;

747 
u64
 
öå
;

749 
rvu
 = 
rvu_dl
->rvu;

750 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

751 i‡(
blkaddr
 < 0)

752  
IRQ_NONE
;

754 
≈a_evít_c⁄ãxt
 = 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
;

755 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPA_AF_GEN_INT
);

756 
≈a_evít_c⁄ãxt
->
≈a_af_rvu_gí
 = 
öå
;

759 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_GEN_INT
, 
öå
);

760 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_GEN_INT_ENA_W1C
, ~0ULL);

761 
	`queue_w‹k
(
rvu_dl
->
devlök_wq
, &rvu_dl->
rvu_≈a_hó…h_ªp‹ãr
->
gí_w‹k
);

763  
IRQ_HANDLED
;

764 
	}
}

766 
	$rvu_≈a_îr_w‹k
(
w‹k_°ru˘
 *
w‹k
)

768 
rvu_≈a_hó…h_ªp‹ãrs
 *
rvu_≈a_hó…h_ªp‹ãr
;

770 
rvu_≈a_hó…h_ªp‹ãr
 = 
	`c⁄èöî_of
(
w‹k
, 
rvu_≈a_hó…h_ªp‹ãrs
, 
îr_w‹k
);

771 
	`devlök_hó…h_ªp‹t
(
rvu_≈a_hó…h_ªp‹ãr
->
rvu_hw_≈a_îr_ªp‹ãr
,

773 
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
);

774 
	}
}

776 
úqªtu∫_t
 
	$rvu_≈a_af_îr_öå_h™dÀr
(
úq
, *
rvu_úq
)

778 
rvu_≈a_evít_˘x
 *
≈a_evít_c⁄ãxt
;

779 
rvu_devlök
 *
rvu_dl
 = 
rvu_úq
;

780 
rvu
 *rvu;

781 
blkaddr
;

782 
u64
 
öå
;

784 
rvu
 = 
rvu_dl
->rvu;

785 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

786 i‡(
blkaddr
 < 0)

787  
IRQ_NONE
;

788 
≈a_evít_c⁄ãxt
 = 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
;

789 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPA_AF_ERR_INT
);

790 
≈a_evít_c⁄ãxt
->
≈a_af_rvu_îr
 = 
öå
;

793 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_ERR_INT
, 
öå
);

794 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_ERR_INT_ENA_W1C
, ~0ULL);

795 
	`queue_w‹k
(
rvu_dl
->
devlök_wq
, &rvu_dl->
rvu_≈a_hó…h_ªp‹ãr
->
îr_w‹k
);

797  
IRQ_HANDLED
;

798 
	}
}

800 
	$rvu_≈a_øs_w‹k
(
w‹k_°ru˘
 *
w‹k
)

802 
rvu_≈a_hó…h_ªp‹ãrs
 *
rvu_≈a_hó…h_ªp‹ãr
;

804 
rvu_≈a_hó…h_ªp‹ãr
 = 
	`c⁄èöî_of
(
w‹k
, 
rvu_≈a_hó…h_ªp‹ãrs
, 
øs_w‹k
);

805 
	`devlök_hó…h_ªp‹t
(
rvu_≈a_hó…h_ªp‹ãr
->
rvu_hw_≈a_øs_ªp‹ãr
,

807 
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
);

808 
	}
}

810 
úqªtu∫_t
 
	$rvu_≈a_af_øs_öå_h™dÀr
(
úq
, *
rvu_úq
)

812 
rvu_≈a_evít_˘x
 *
≈a_evít_c⁄ãxt
;

813 
rvu_devlök
 *
rvu_dl
 = 
rvu_úq
;

814 
rvu
 *rvu;

815 
blkaddr
;

816 
u64
 
öå
;

818 
rvu
 = 
rvu_dl
->rvu;

819 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

820 i‡(
blkaddr
 < 0)

821  
IRQ_NONE
;

823 
≈a_evít_c⁄ãxt
 = 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
;

824 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPA_AF_RAS
);

825 
≈a_evít_c⁄ãxt
->
≈a_af_rvu_øs
 = 
öå
;

828 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RAS
, 
öå
);

829 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RAS_ENA_W1C
, ~0ULL);

830 
	`queue_w‹k
(
rvu_dl
->
devlök_wq
, &rvu_dl->
rvu_≈a_hó…h_ªp‹ãr
->
øs_w‹k
);

832  
IRQ_HANDLED
;

833 
	}
}

835 
	$rvu_≈a_uƒegi°î_öãºu±s
(
rvu
 *rvu)

837 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

838 
i
, 
offs
, 
blkaddr
;

839 
u64
 
ªg
;

841 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

842 i‡(
blkaddr
 < 0)

845 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPA_PRIV_AF_INT_CFG
);

846 
offs
 = 
ªg
 & 0x3FF;

848 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RVU_INT_ENA_W1C
, ~0ULL);

849 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_GEN_INT_ENA_W1C
, ~0ULL);

850 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_ERR_INT_ENA_W1C
, ~0ULL);

851 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RAS_ENA_W1C
, ~0ULL);

853 
i
 = 0; i < 
NPA_AF_INT_VEC_CNT
; i++)

854 i‡(
rvu
->
úq_Æloˇãd
[
offs
 + 
i
]) {

855 
	`‰ì_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
offs
 + 
i
), 
rvu_dl
);

856 
rvu
->
úq_Æloˇãd
[
offs
 + 
i
] = 
Ál£
;

858 
	}
}

860 
	$rvu_≈a_ªgi°î_öãºu±s
(
rvu
 *rvu)

862 
blkaddr
, 
ba£
;

863 
boﬁ
 
rc
;

865 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

866 i‡(
blkaddr
 < 0)

867  
blkaddr
;

870 
ba£
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPA_PRIV_AF_INT_CFG
) & 0x3ff;

871 i‡(!
ba£
) {

872 
	`dev_w¨n
(
rvu
->
dev
,

878 
rc
 = 
	`rvu_comm⁄_ªque°_úq
(
rvu
, 
ba£
 + 
NPA_AF_INT_VEC_RVU
,

880 
rvu_≈a_af_rvu_öå_h™dÀr
);

881 i‡(!
rc
)

882 
îr
;

883 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RVU_INT_ENA_W1S
, ~0ULL);

886 
rc
 = 
	`rvu_comm⁄_ªque°_úq
(
rvu
, 
ba£
 + 
NPA_AF_INT_VEC_GEN
,

888 
rvu_≈a_af_gí_öå_h™dÀr
);

889 i‡(!
rc
)

890 
îr
;

891 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_GEN_INT_ENA_W1S
, ~0ULL);

894 
rc
 = 
	`rvu_comm⁄_ªque°_úq
(
rvu
, 
ba£
 + 
NPA_AF_INT_VEC_AF_ERR
,

896 
rvu_≈a_af_îr_öå_h™dÀr
);

897 i‡(!
rc
)

898 
îr
;

899 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_ERR_INT_ENA_W1S
, ~0ULL);

902 
rc
 = 
	`rvu_comm⁄_ªque°_úq
(
rvu
, 
ba£
 + 
NPA_AF_INT_VEC_POISON
,

904 
rvu_≈a_af_øs_öå_h™dÀr
);

905 i‡(!
rc
)

906 
îr
;

907 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RAS_ENA_W1S
, ~0ULL);

910 
îr
:

911 
	`rvu_≈a_uƒegi°î_öãºu±s
(
rvu
);

912  
rc
;

913 
	}
}

915 
	$rvu_≈a_ªp‹t_show
(
devlök_fmsg
 *
fmsg
, *
˘x
,

916 
≈a_af_rvu_hó…h
 
hó…h_ªp‹ãr
)

918 
rvu_≈a_evít_˘x
 *
≈a_evít_c⁄ãxt
;

919 
öå_vÆ
, 
Æloc_dis
, 
‰ì_dis
;

920 
îr
;

922 
≈a_evít_c⁄ãxt
 = 
˘x
;

923 
hó…h_ªp‹ãr
) {

924 
NPA_AF_RVU_GEN
:

925 
öå_vÆ
 = 
≈a_evít_c⁄ãxt
->
≈a_af_rvu_gí
;

926 
îr
 = 
	`rvu_ªp‹t_∑ú_°¨t
(
fmsg
, "NPA_AF_GENERAL");

927 i‡(
îr
)

928  
îr
;

929 
îr
 = 
	`devlök_fmsg_u64_∑ú_put
(
fmsg
, "\tNPA General Interrupt Reg ",

930 
≈a_evít_c⁄ãxt
->
≈a_af_rvu_gí
);

931 i‡(
îr
)

932  
îr
;

933 i‡(
öå_vÆ
 & 
	`BIT_ULL
(32)) {

934 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tUnmap PF Error");

935 i‡(
îr
)

936  
îr
;

939 
‰ì_dis
 = 
	`FIELD_GET
(
	`GENMASK
(15, 0), 
öå_vÆ
);

940 i‡(
‰ì_dis
 & 
	`BIT
(
NPA_INPQ_NIX0_RX
)) {

941 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX0: free disabled RX");

942 i‡(
îr
)

943  
îr
;

945 i‡(
‰ì_dis
 & 
	`BIT
(
NPA_INPQ_NIX0_TX
)) {

946 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX0:free disabled TX");

947 i‡(
îr
)

948  
îr
;

950 i‡(
‰ì_dis
 & 
	`BIT
(
NPA_INPQ_NIX1_RX
)) {

951 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX1: free disabled RX");

952 i‡(
îr
)

953  
îr
;

955 i‡(
‰ì_dis
 & 
	`BIT
(
NPA_INPQ_NIX1_TX
)) {

956 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX1:free disabled TX");

957 i‡(
îr
)

958  
îr
;

960 i‡(
‰ì_dis
 & 
	`BIT
(
NPA_INPQ_SSO
)) {

961 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFree Disabled for SSO");

962 i‡(
îr
)

963  
îr
;

965 i‡(
‰ì_dis
 & 
	`BIT
(
NPA_INPQ_TIM
)) {

966 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFree Disabled for TIM");

967 i‡(
îr
)

968  
îr
;

970 i‡(
‰ì_dis
 & 
	`BIT
(
NPA_INPQ_DPI
)) {

971 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFree Disabled for DPI");

972 i‡(
îr
)

973  
îr
;

975 i‡(
‰ì_dis
 & 
	`BIT
(
NPA_INPQ_AURA_OP
)) {

976 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFree Disabled for AURA");

977 i‡(
îr
)

978  
îr
;

981 
Æloc_dis
 = 
	`FIELD_GET
(
	`GENMASK
(31, 16), 
öå_vÆ
);

982 i‡(
Æloc_dis
 & 
	`BIT
(
NPA_INPQ_NIX0_RX
)) {

983 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX0:álloc disabled RX");

984 i‡(
îr
)

985  
îr
;

987 i‡(
Æloc_dis
 & 
	`BIT
(
NPA_INPQ_NIX0_TX
)) {

988 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX0:alloc disabled TX");

989 i‡(
îr
)

990  
îr
;

992 i‡(
Æloc_dis
 & 
	`BIT
(
NPA_INPQ_NIX1_RX
)) {

993 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX1:álloc disabled RX");

994 i‡(
îr
)

995  
îr
;

997 i‡(
Æloc_dis
 & 
	`BIT
(
NPA_INPQ_NIX1_TX
)) {

998 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tNIX1:alloc disabled TX");

999 i‡(
îr
)

1000  
îr
;

1002 i‡(
Æloc_dis
 & 
	`BIT
(
NPA_INPQ_SSO
)) {

1003 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tAlloc Disabled for SSO");

1004 i‡(
îr
)

1005  
îr
;

1007 i‡(
Æloc_dis
 & 
	`BIT
(
NPA_INPQ_TIM
)) {

1008 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tAlloc Disabled for TIM");

1009 i‡(
îr
)

1010  
îr
;

1012 i‡(
Æloc_dis
 & 
	`BIT
(
NPA_INPQ_DPI
)) {

1013 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tAlloc Disabled for DPI");

1014 i‡(
îr
)

1015  
îr
;

1017 i‡(
Æloc_dis
 & 
	`BIT
(
NPA_INPQ_AURA_OP
)) {

1018 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tAlloc Disabled for AURA");

1019 i‡(
îr
)

1020  
îr
;

1022 
îr
 = 
	`rvu_ªp‹t_∑ú_íd
(
fmsg
);

1023 i‡(
îr
)

1024  
îr
;

1026 
NPA_AF_RVU_ERR
:

1027 
îr
 = 
	`rvu_ªp‹t_∑ú_°¨t
(
fmsg
, "NPA_AF_ERR");

1028 i‡(
îr
)

1029  
îr
;

1030 
îr
 = 
	`devlök_fmsg_u64_∑ú_put
(
fmsg
, "\tNPA Error Interrupt Reg ",

1031 
≈a_evít_c⁄ãxt
->
≈a_af_rvu_îr
);

1032 i‡(
îr
)

1033  
îr
;

1035 i‡(
≈a_evít_c⁄ãxt
->
≈a_af_rvu_îr
 & 
	`BIT_ULL
(14)) {

1036 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFault on NPA_AQ_INST_SÑead");

1037 i‡(
îr
)

1038  
îr
;

1040 i‡(
≈a_evít_c⁄ãxt
->
≈a_af_rvu_îr
 & 
	`BIT_ULL
(13)) {

1041 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tFault on NPA_AQ_RES_S write");

1042 i‡(
îr
)

1043  
îr
;

1045 i‡(
≈a_evít_c⁄ãxt
->
≈a_af_rvu_îr
 & 
	`BIT_ULL
(12)) {

1046 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tAQ Doorbell Error");

1047 i‡(
îr
)

1048  
îr
;

1050 
îr
 = 
	`rvu_ªp‹t_∑ú_íd
(
fmsg
);

1051 i‡(
îr
)

1052  
îr
;

1054 
NPA_AF_RVU_RAS
:

1055 
îr
 = 
	`rvu_ªp‹t_∑ú_°¨t
(
fmsg
, "NPA_AF_RVU_RAS");

1056 i‡(
îr
)

1057  
îr
;

1058 
îr
 = 
	`devlök_fmsg_u64_∑ú_put
(
fmsg
, "\tNPA RAS Interrupt Reg ",

1059 
≈a_evít_c⁄ãxt
->
≈a_af_rvu_øs
);

1060 i‡(
îr
)

1061  
îr
;

1062 i‡(
≈a_evít_c⁄ãxt
->
≈a_af_rvu_øs
 & 
	`BIT_ULL
(34)) {

1063 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tPoison data on NPA_AQ_INST_S");

1064 i‡(
îr
)

1065  
îr
;

1067 i‡(
≈a_evít_c⁄ãxt
->
≈a_af_rvu_øs
 & 
	`BIT_ULL
(33)) {

1068 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tPoison data on NPA_AQ_RES_S");

1069 i‡(
îr
)

1070  
îr
;

1072 i‡(
≈a_evít_c⁄ãxt
->
≈a_af_rvu_øs
 & 
	`BIT_ULL
(32)) {

1073 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tPoison data on HW context");

1074 i‡(
îr
)

1075  
îr
;

1077 
îr
 = 
	`rvu_ªp‹t_∑ú_íd
(
fmsg
);

1078 i‡(
îr
)

1079  
îr
;

1081 
NPA_AF_RVU_INTR
:

1082 
îr
 = 
	`rvu_ªp‹t_∑ú_°¨t
(
fmsg
, "NPA_AF_RVU");

1083 i‡(
îr
)

1084  
îr
;

1085 
îr
 = 
	`devlök_fmsg_u64_∑ú_put
(
fmsg
, "\tNPA RVU Interrupt Reg ",

1086 
≈a_evít_c⁄ãxt
->
≈a_af_rvu_öt
);

1087 i‡(
îr
)

1088  
îr
;

1089 i‡(
≈a_evít_c⁄ãxt
->
≈a_af_rvu_öt
 & 
	`BIT_ULL
(0)) {

1090 
îr
 = 
	`devlök_fmsg_°rög_put
(
fmsg
, "\n\tUnmap Slot Error");

1091 i‡(
îr
)

1092  
îr
;

1094  
	`rvu_ªp‹t_∑ú_íd
(
fmsg
);

1096  -
EINVAL
;

1100 
	}
}

1102 
	$rvu_hw_≈a_öå_dump
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

1103 
devlök_fmsg
 *
fmsg
, *
˘x
)

1105 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

1106 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

1107 
rvu_≈a_evít_˘x
 *
≈a_˘x
;

1109 
≈a_˘x
 = 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
;

1111  
˘x
 ? 
	`rvu_≈a_ªp‹t_show
(
fmsg
, ctx, 
NPA_AF_RVU_INTR
) :

1112 
	`rvu_≈a_ªp‹t_show
(
fmsg
, 
≈a_˘x
, 
NPA_AF_RVU_INTR
);

1113 
	}
}

1115 
	$rvu_hw_≈a_öå_ªcovî
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

1116 *
˘x
)

1118 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

1119 
rvu_≈a_evít_˘x
 *
≈a_evít_˘x
 = 
˘x
;

1120 
blkaddr
;

1122 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

1123 i‡(
blkaddr
 < 0)

1124  
blkaddr
;

1126 i‡(
≈a_evít_˘x
->
≈a_af_rvu_öt
)

1127 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RVU_INT_ENA_W1S
, ~0ULL);

1130 
	}
}

1132 
	$rvu_hw_≈a_gí_dump
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

1133 
devlök_fmsg
 *
fmsg
, *
˘x
)

1135 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

1136 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

1137 
rvu_≈a_evít_˘x
 *
≈a_˘x
;

1139 
≈a_˘x
 = 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
;

1141  
˘x
 ? 
	`rvu_≈a_ªp‹t_show
(
fmsg
, ctx, 
NPA_AF_RVU_GEN
) :

1142 
	`rvu_≈a_ªp‹t_show
(
fmsg
, 
≈a_˘x
, 
NPA_AF_RVU_GEN
);

1143 
	}
}

1145 
	$rvu_hw_≈a_gí_ªcovî
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

1146 *
˘x
)

1148 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

1149 
rvu_≈a_evít_˘x
 *
≈a_evít_˘x
 = 
˘x
;

1150 
blkaddr
;

1152 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

1153 i‡(
blkaddr
 < 0)

1154  
blkaddr
;

1156 i‡(
≈a_evít_˘x
->
≈a_af_rvu_gí
)

1157 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_GEN_INT_ENA_W1S
, ~0ULL);

1160 
	}
}

1162 
	$rvu_hw_≈a_îr_dump
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

1163 
devlök_fmsg
 *
fmsg
, *
˘x
)

1165 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

1166 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

1167 
rvu_≈a_evít_˘x
 *
≈a_˘x
;

1169 
≈a_˘x
 = 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
;

1171  
˘x
 ? 
	`rvu_≈a_ªp‹t_show
(
fmsg
, ctx, 
NPA_AF_RVU_ERR
) :

1172 
	`rvu_≈a_ªp‹t_show
(
fmsg
, 
≈a_˘x
, 
NPA_AF_RVU_ERR
);

1173 
	}
}

1175 
	$rvu_hw_≈a_îr_ªcovî
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

1176 *
˘x
)

1178 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

1179 
rvu_≈a_evít_˘x
 *
≈a_evít_˘x
 = 
˘x
;

1180 
blkaddr
;

1182 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

1183 i‡(
blkaddr
 < 0)

1184  
blkaddr
;

1186 i‡(
≈a_evít_˘x
->
≈a_af_rvu_îr
)

1187 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_ERR_INT_ENA_W1S
, ~0ULL);

1190 
	}
}

1192 
	$rvu_hw_≈a_øs_dump
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

1193 
devlök_fmsg
 *
fmsg
, *
˘x
)

1195 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

1196 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

1197 
rvu_≈a_evít_˘x
 *
≈a_˘x
;

1199 
≈a_˘x
 = 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
;

1201  
˘x
 ? 
	`rvu_≈a_ªp‹t_show
(
fmsg
, ctx, 
NPA_AF_RVU_RAS
) :

1202 
	`rvu_≈a_ªp‹t_show
(
fmsg
, 
≈a_˘x
, 
NPA_AF_RVU_RAS
);

1203 
	}
}

1205 
	$rvu_hw_≈a_øs_ªcovî
(
devlök_hó…h_ªp‹ãr
 *
ªp‹ãr
,

1206 *
˘x
)

1208 
rvu
 *rvu = 
	`devlök_hó…h_ªp‹ãr_¥iv
(
ªp‹ãr
);

1209 
rvu_≈a_evít_˘x
 *
≈a_evít_˘x
 = 
˘x
;

1210 
blkaddr
;

1212 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

1213 i‡(
blkaddr
 < 0)

1214  
blkaddr
;

1216 i‡(
≈a_evít_˘x
->
≈a_af_rvu_øs
)

1217 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPA_AF_RAS_ENA_W1S
, ~0ULL);

1220 
	}
}

1222 
RVU_REPORTERS
(
hw_≈a_öå
);

1223 
RVU_REPORTERS
(
hw_≈a_gí
);

1224 
RVU_REPORTERS
(
hw_≈a_îr
);

1225 
RVU_REPORTERS
(
hw_≈a_øs
);

1227 
rvu_≈a_hó…h_ªp‹ãrs_de°roy
(
rvu_devlök
 *
rvu_dl
);

1229 
	$rvu_≈a_ªgi°î_ªp‹ãrs
(
rvu_devlök
 *
rvu_dl
)

1231 
rvu_≈a_hó…h_ªp‹ãrs
 *
rvu_ªp‹ãrs
;

1232 
rvu_≈a_evít_˘x
 *
≈a_evít_c⁄ãxt
;

1233 
rvu
 *rvu = 
rvu_dl
->rvu;

1235 
rvu_ªp‹ãrs
 = 
	`kzÆloc
((*rvu_ªp‹ãrs), 
GFP_KERNEL
);

1236 i‡(!
rvu_ªp‹ãrs
)

1237  -
ENOMEM
;

1239 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
 = 
rvu_ªp‹ãrs
;

1240 
≈a_evít_c⁄ãxt
 = 
	`kzÆloc
((*≈a_evít_c⁄ãxt), 
GFP_KERNEL
);

1241 i‡(!
≈a_evít_c⁄ãxt
)

1242  -
ENOMEM
;

1244 
rvu_ªp‹ãrs
->
≈a_evít_˘x
 = 
≈a_evít_c⁄ãxt
;

1245 
rvu_ªp‹ãrs
->
rvu_hw_≈a_öå_ªp‹ãr
 =

1246 
	`devlök_hó…h_ªp‹ãr_¸óã
(
rvu_dl
->
dl
, &
rvu_hw_≈a_öå_ªp‹ãr_›s
, 0, 1, 
rvu
);

1247 i‡(
	`IS_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_öå_ªp‹ãr
)) {

1248 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo create hw_npa_intrÑeporter,Érr=%ld\n",

1249 
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_öå_ªp‹ãr
));

1250  
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_öå_ªp‹ãr
);

1253 
rvu_ªp‹ãrs
->
rvu_hw_≈a_gí_ªp‹ãr
 =

1254 
	`devlök_hó…h_ªp‹ãr_¸óã
(
rvu_dl
->
dl
, &
rvu_hw_≈a_gí_ªp‹ãr_›s
, 0, 1, 
rvu
);

1255 i‡(
	`IS_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_gí_ªp‹ãr
)) {

1256 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo create hw_npa_genÑeporter,Érr=%ld\n",

1257 
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_gí_ªp‹ãr
));

1258  
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_gí_ªp‹ãr
);

1261 
rvu_ªp‹ãrs
->
rvu_hw_≈a_îr_ªp‹ãr
 =

1262 
	`devlök_hó…h_ªp‹ãr_¸óã
(
rvu_dl
->
dl
, &
rvu_hw_≈a_îr_ªp‹ãr_›s
, 0, 1, 
rvu
);

1263 i‡(
	`IS_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_îr_ªp‹ãr
)) {

1264 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo create hw_npa_errÑeporter,Érr=%ld\n",

1265 
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_îr_ªp‹ãr
));

1266  
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_îr_ªp‹ãr
);

1269 
rvu_ªp‹ãrs
->
rvu_hw_≈a_øs_ªp‹ãr
 =

1270 
	`devlök_hó…h_ªp‹ãr_¸óã
(
rvu_dl
->
dl
, &
rvu_hw_≈a_øs_ªp‹ãr_›s
, 0, 1, 
rvu
);

1271 i‡(
	`IS_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_øs_ªp‹ãr
)) {

1272 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo create hw_npa_rasÑeporter,Érr=%ld\n",

1273 
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_øs_ªp‹ãr
));

1274  
	`PTR_ERR
(
rvu_ªp‹ãrs
->
rvu_hw_≈a_øs_ªp‹ãr
);

1277 
rvu_dl
->
devlök_wq
 = 
	`¸óã_w‹kqueue
("rvu_devlink_wq");

1278 i‡(!
rvu_dl
->
devlök_wq
)

1279 
îr
;

1281 
	`INIT_WORK
(&
rvu_ªp‹ãrs
->
öå_w‹k
, 
rvu_≈a_öå_w‹k
);

1282 
	`INIT_WORK
(&
rvu_ªp‹ãrs
->
îr_w‹k
, 
rvu_≈a_îr_w‹k
);

1283 
	`INIT_WORK
(&
rvu_ªp‹ãrs
->
gí_w‹k
, 
rvu_≈a_gí_w‹k
);

1284 
	`INIT_WORK
(&
rvu_ªp‹ãrs
->
øs_w‹k
, 
rvu_≈a_øs_w‹k
);

1287 
îr
:

1288 
	`rvu_≈a_hó…h_ªp‹ãrs_de°roy
(
rvu_dl
);

1289  -
ENOMEM
;

1290 
	}
}

1292 
	$rvu_≈a_hó…h_ªp‹ãrs_¸óã
(
rvu_devlök
 *
rvu_dl
)

1294 
rvu
 *rvu = 
rvu_dl
->rvu;

1295 
îr
;

1297 
îr
 = 
	`rvu_≈a_ªgi°î_ªp‹ãrs
(
rvu_dl
);

1298 i‡(
îr
) {

1299 
	`dev_w¨n
(
rvu
->
dev
, "FailedÅo createÇpaÑeporter,Érr =%d\n",

1300 
îr
);

1301  
îr
;

1303 
	`rvu_≈a_ªgi°î_öãºu±s
(
rvu
);

1306 
	}
}

1308 
	$rvu_≈a_hó…h_ªp‹ãrs_de°roy
(
rvu_devlök
 *
rvu_dl
)

1310 
rvu_≈a_hó…h_ªp‹ãrs
 *
≈a_ªp‹ãrs
;

1311 
rvu
 *rvu = 
rvu_dl
->rvu;

1313 
≈a_ªp‹ãrs
 = 
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
;

1315 i‡(!
≈a_ªp‹ãrs
->
rvu_hw_≈a_øs_ªp‹ãr
)

1317 i‡(!
	`IS_ERR_OR_NULL
(
≈a_ªp‹ãrs
->
rvu_hw_≈a_öå_ªp‹ãr
))

1318 
	`devlök_hó…h_ªp‹ãr_de°roy
(
≈a_ªp‹ãrs
->
rvu_hw_≈a_öå_ªp‹ãr
);

1320 i‡(!
	`IS_ERR_OR_NULL
(
≈a_ªp‹ãrs
->
rvu_hw_≈a_gí_ªp‹ãr
))

1321 
	`devlök_hó…h_ªp‹ãr_de°roy
(
≈a_ªp‹ãrs
->
rvu_hw_≈a_gí_ªp‹ãr
);

1323 i‡(!
	`IS_ERR_OR_NULL
(
≈a_ªp‹ãrs
->
rvu_hw_≈a_îr_ªp‹ãr
))

1324 
	`devlök_hó…h_ªp‹ãr_de°roy
(
≈a_ªp‹ãrs
->
rvu_hw_≈a_îr_ªp‹ãr
);

1326 i‡(!
	`IS_ERR_OR_NULL
(
≈a_ªp‹ãrs
->
rvu_hw_≈a_øs_ªp‹ãr
))

1327 
	`devlök_hó…h_ªp‹ãr_de°roy
(
≈a_ªp‹ãrs
->
rvu_hw_≈a_øs_ªp‹ãr
);

1329 
	`rvu_≈a_uƒegi°î_öãºu±s
(
rvu
);

1330 
	`k‰ì
(
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
->
≈a_evít_˘x
);

1331 
	`k‰ì
(
rvu_dl
->
rvu_≈a_hó…h_ªp‹ãr
);

1332 
	}
}

1334 
	$rvu_hó…h_ªp‹ãrs_¸óã
(
rvu
 *rvu)

1336 
rvu_devlök
 *
rvu_dl
;

1337 
îr
;

1339 
rvu_dl
 = 
rvu
->rvu_dl;

1340 
îr
 = 
	`rvu_≈a_hó…h_ªp‹ãrs_¸óã
(
rvu_dl
);

1341 i‡(
îr
)

1342  
îr
;

1344  
	`rvu_nix_hó…h_ªp‹ãrs_¸óã
(
rvu_dl
);

1345 
	}
}

1347 
	$rvu_hó…h_ªp‹ãrs_de°roy
(
rvu
 *rvu)

1349 
rvu_devlök
 *
rvu_dl
;

1351 i‡(!
rvu
->
rvu_dl
)

1354 
rvu_dl
 = 
rvu
->rvu_dl;

1355 
	`rvu_≈a_hó…h_ªp‹ãrs_de°roy
(
rvu_dl
);

1356 
	`rvu_nix_hó…h_ªp‹ãrs_de°roy
(
rvu_dl
);

1357 
	}
}

1359 
	ervu_af_dl_∑øm_id
 {

1360 
	mRVU_AF_DEVLINK_PARAM_ID_BASE
 = 
DEVLINK_PARAM_GENERIC_ID_MAX
,

1361 
	mRVU_AF_DEVLINK_PARAM_ID_DWRR_MTU
,

1362 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_TIMERS
,

1363 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_TENNS
,

1364 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_GPIOS
,

1365 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_GTI
,

1366 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_PTP
,

1367 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_SYNC
,

1368 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_BTS
,

1369 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_EXT_GTI
,

1370 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_TIMERS
,

1371 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_TENNS
,

1372 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_GPIOS
,

1373 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_GTI
,

1374 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_PTP
,

1375 
	mRVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_BTS
,

1376 
	mRVU_AF_DEVLINK_PARAM_ID_NPC_EXACT_FEATURE_DISABLE
,

1379 
u64
 
	$rvu_af_dl_tim_∑øm_id_to_off£t
(
u32
 
id
)

1381 
u64
 
off£t
 = 0;

1383 
id
) {

1384 
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_TENNS
:

1385 
off£t
 = 
TIM_AF_CAPTURE_TENNS
;

1387 
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_GPIOS
:

1388 
off£t
 = 
TIM_AF_CAPTURE_GPIOS
;

1390 
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_GTI
:

1391 
off£t
 = 
TIM_AF_CAPTURE_GTI
;

1393 
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_PTP
:

1394 
off£t
 = 
TIM_AF_CAPTURE_PTP
;

1396 
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_BTS
:

1397 
off£t
 = 
TIM_AF_CAPTURE_BTS
;

1399 
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_EXT_GTI
:

1400 
off£t
 = 
TIM_AF_CAPTURE_EXT_GTI
;

1402 
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_TENNS
:

1403 
off£t
 = 
TIM_AF_ADJUST_TENNS
;

1405 
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_GPIOS
:

1406 
off£t
 = 
TIM_AF_ADJUST_GPIOS
;

1408 
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_GTI
:

1409 
off£t
 = 
TIM_AF_ADJUST_GTI
;

1411 
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_PTP
:

1412 
off£t
 = 
TIM_AF_ADJUST_PTP
;

1414 
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_BTS
:

1415 
off£t
 = 
TIM_AF_ADJUST_BTS
;

1419  
off£t
;

1420 
	}
}

1423 
	$rvu_af_dl_dwº_mtu_vÆid©e
(
devlök
 *devlök, 
u32
 
id
,

1424 
devlök_∑øm_vÆue
 
vÆ
,

1425 
√éök_ext_ack
 *
exèck
)

1427 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1428 
rvu
 *rvu = 
rvu_dl
->rvu;

1429 
dwº_mtu
 = 
vÆ
.
vu32
;

1430 
nix_txsch
 *
txsch
;

1431 
nix_hw
 *nix_hw;

1433 i‡(!
rvu
->
hw
->
ˇp
.
nix_comm⁄_dwº_mtu
) {

1434 
	`NL_SET_ERR_MSG_MOD
(
exèck
,

1436  -
EOPNOTSUPP
;

1439 i‡((
dwº_mtu
 > 65536 || !
	`is_powî_of_2
(dwrr_mtu)) &&

1440 (
dwº_mtu
 != 9728 && dwrr_mtu != 10240)) {

1441 
	`NL_SET_ERR_MSG_MOD
(
exèck
,

1443  -
EINVAL
;

1446 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
BLKADDR_NIX0
);

1447 i‡(!
nix_hw
)

1448  -
ENODEV
;

1450 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_SMQ
];

1451 i‡(
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
Ë!txsch->schq.
max
) {

1452 
	`NL_SET_ERR_MSG_MOD
(
exèck
,

1454 
	`NL_SET_ERR_MSG_MOD
(
exèck
,

1456  -
EOPNOTSUPP
;

1460 
	}
}

1462 
	$rvu_af_dl_dwº_mtu_£t
(
devlök
 *devlök, 
u32
 
id
,

1463 
devlök_∑øm_g£t_˘x
 *
˘x
)

1465 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1466 
rvu
 *rvu = 
rvu_dl
->rvu;

1467 
u64
 
dwº_mtu
;

1469 
dwº_mtu
 = 
	`c⁄vît_byãs_to_dwº_mtu
(
˘x
->
vÆ
.
vu32
);

1470 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_NIX0
,

1471 
	`nix_gë_dwº_mtu_ªg
(
rvu
->
hw
, 
SMQ_LINK_TYPE_RPM
), 
dwº_mtu
);

1474 
	}
}

1476 
	$rvu_af_dl_dwº_mtu_gë
(
devlök
 *devlök, 
u32
 
id
,

1477 
devlök_∑øm_g£t_˘x
 *
˘x
)

1479 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1480 
rvu
 *rvu = 
rvu_dl
->rvu;

1481 
u64
 
dwº_mtu
;

1483 i‡(!
rvu
->
hw
->
ˇp
.
nix_comm⁄_dwº_mtu
)

1484  -
EOPNOTSUPP
;

1486 
dwº_mtu
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NIX0
,

1487 
	`nix_gë_dwº_mtu_ªg
(
rvu
->
hw
, 
SMQ_LINK_TYPE_RPM
));

1488 
˘x
->
vÆ
.
vu32
 = 
	`c⁄vît_dwº_mtu_to_byãs
(
dwº_mtu
);

1491 
	}
}

1493 
	$rvu_af_dl_tim_ˇ±uª_timîs_gë
(
devlök
 *devlök, 
u32
 
id
,

1494 
devlök_∑øm_g£t_˘x
 *
˘x
)

1496 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1497 
rvu
 *rvu = 
rvu_dl
->rvu;

1498 
u64
 
ˇ±_timîs
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_TIM
, 
TIM_AF_CAPTURE_TIMERS
);

1500 
˘x
->
vÆ
.
vu8
 = (
u8
)(
ˇ±_timîs
 & 
TIM_AF_CAPTURE_TIMERS_MASK
);

1503 
	}
}

1505 
	$rvu_af_dl_tim_ˇ±uª_timîs_£t
(
devlök
 *devlök, 
u32
 
id
,

1506 
devlök_∑øm_g£t_˘x
 *
˘x
)

1508 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1509 
rvu
 *rvu = 
rvu_dl
->rvu;

1511 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_TIM
, 
TIM_AF_CAPTURE_TIMERS
, (
u64
)
˘x
->
vÆ
.
vu8
);

1514 
	}
}

1516 
	$rvu_af_dl_tim_ˇ±uª_timîs_vÆid©e
(
devlök
 *devlink,

1517 
u32
 
id
,

1518 
devlök_∑øm_vÆue
 
vÆ
,

1519 
√éök_ext_ack
 *
exèck
)

1521 i‡(
vÆ
.
vu8
 > 
TIM_AF_CAPTURE_TIMERS_MASK
) {

1522 
	`NL_SET_ERR_MSG_MOD
(
exèck
,

1524  -
EINVAL
;

1528 
	}
}

1530 
boﬁ
 
	$˙10k_tim_±p_îøè
(
pci_dev
 *
pdev
)

1532 i‡(
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CN10K_A
 ||

1533 
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CNF10K_A
 ||

1534 
pdev
->
subsy°em_devi˚
 =
PCI_SUBSYS_DEVID_CNF10K_B
)

1535  
åue
;

1536  
Ál£
;

1537 
	}
}

1539 
u64
 
	$˙10k_tim_±p_rﬁlovî_îøè_fix
(
rvu
 *rvu, 
u64
 
time
)

1541 
off£t
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_TIM
, 
TIM_AF_ADJUST_PTP
);

1542 
u32
 
£c
, 
n£c
, 
max_n£c
 = 
NSEC_PER_SEC
;

1544 
£c
 = (
u32
)(
time
 >> 32);

1545 
n£c
 = (
u32
)
time
;

1547 i‡(!
off£t
 || 
n£c
 < 
max_n£c
)

1548  
time
;

1550 i‡(
off£t
 < 0) {

1551 
n£c
 +
max_n£c
;

1552 
£c
 -= 1;

1554 
n£c
 -
max_n£c
;

1555 
£c
 += 1;

1558  (
u64
)
£c
 << 32 | 
n£c
;

1559 
	}
}

1561 
	$rvu_af_dl_tim_ˇ±uª_time_gë
(
devlök
 *devlök, 
u32
 
id
,

1562 
devlök_∑øm_g£t_˘x
 *
˘x
)

1564 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1565 
rvu
 *rvu = 
rvu_dl
->rvu;

1566 
u64
 
time
, 
off£t
;

1568 
off£t
 = 
	`rvu_af_dl_tim_∑øm_id_to_off£t
(
id
);

1569 
time
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_TIM
, 
off£t
);

1570 i‡(
off£t
 =
TIM_AF_CAPTURE_PTP
 && 
	`˙10k_tim_±p_îøè
(
rvu
->
pdev
))

1571 
time
 = 
	`˙10k_tim_±p_rﬁlovî_îøè_fix
(
rvu
,Åime);

1572 
	`¢¥ötf
(
˘x
->
vÆ
.
v°r
, (˘x->vÆ.v°r), "%Œu", 
time
);

1575 
	}
}

1577 
	$rvu_af_dl_tim_ˇ±uª_time_£t
(
devlök
 
__Æways_unu£d
 *devlink,

1578 
u32
 
__Æways_unu£d
 
id
,

1579 
devlök_∑øm_g£t_˘x
 
__Æways_unu£d
 *
˘x
)

1582 
	}
}

1584 
	$rvu_af_dl_tim_adju°_timîs_gë
(
devlök
 *devlök, 
u32
 
id
,

1585 
devlök_∑øm_g£t_˘x
 *
˘x
)

1587 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1588 
rvu
 *rvu = 
rvu_dl
->rvu;

1589 
u64
 
adju°_timî
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_TIM
, 
TIM_AF_ADJUST_TIMERS
);

1591 i‡(
adju°_timî
 & 
TIM_AF_ADJUST_TIMERS_MASK
)

1592 
˘x
->
vÆ
.
vboﬁ
 = 
åue
;

1594 
˘x
->
vÆ
.
vboﬁ
 = 
Ál£
;

1597 
	}
}

1599 
	$rvu_af_dl_tim_adju°_timîs_£t
(
devlök
 *devlök, 
u32
 
id
,

1600 
devlök_∑øm_g£t_˘x
 *
˘x
)

1602 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1603 
rvu
 *rvu = 
rvu_dl
->rvu;

1604 
u64
 
adju°_timî
 = 
˘x
->
vÆ
.
vboﬁ
 ? 
	`BIT_ULL
(0) : 0;

1606 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_TIM
, 
TIM_AF_ADJUST_TIMERS
, 
adju°_timî
);

1609 
	}
}

1611 
boﬁ
 
	$˙10k_tim_adju°_gti_îøè
(
rvu
 *rvu)

1613 i‡(
	`is_˙f10ka_a1
(
rvu
))

1614  
åue
;

1615  
Ál£
;

1616 
	}
}

1618 
	$rvu_af_dl_tim_adju°_timî_gë
(
devlök
 *devlök, 
u32
 
id
,

1619 
devlök_∑øm_g£t_˘x
 *
˘x
)

1621 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1622 
rvu
 *rvu = 
rvu_dl
->rvu;

1623 
u64
 
off£t
, 
dñè
;

1625 i‡(
id
 =
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_GTI
 &&

1626 
	`˙10k_tim_adju°_gti_îøè
(
rvu
))

1627  -
ENXIO
;

1629 
off£t
 = 
	`rvu_af_dl_tim_∑øm_id_to_off£t
(
id
);

1630 
dñè
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_TIM
, 
off£t
);

1631 
	`¢¥ötf
(
˘x
->
vÆ
.
v°r
, (˘x->vÆ.v°r), "%Œu", 
dñè
);

1634 
	}
}

1636 
	$rvu_af_dl_tim_adju°_timî_£t
(
devlök
 *devlök, 
u32
 
id
,

1637 
devlök_∑øm_g£t_˘x
 *
˘x
)

1639 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1640 
rvu
 *rvu = 
rvu_dl
->rvu;

1641 
u64
 
off£t
, 
dñè
;

1643 i‡(
	`k°πouŒ
(
˘x
->
vÆ
.
v°r
, 10, &
dñè
))

1644  -
EINVAL
;

1646 i‡(
id
 =
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_GTI
 &&

1647 
	`˙10k_tim_adju°_gti_îøè
(
rvu
))

1648  -
ENXIO
;

1650 
off£t
 = 
	`rvu_af_dl_tim_∑øm_id_to_off£t
(
id
);

1651 
	`rvu_wrôe64
(
rvu
, 
BLKADDR_TIM
, 
off£t
, 
dñè
);

1654 
	}
}

1656 
	$rvu_af_dl_tim_adju°_timî_vÆid©e
(
devlök
 *devlök, 
u32
 
id
,

1657 
devlök_∑øm_vÆue
 
vÆ
,

1658 
√éök_ext_ack
 *
exèck
)

1660 
u64
 
dñè
;

1662 i‡(
	`k°πouŒ
(
vÆ
.
v°r
, 10, &
dñè
)) {

1663 
	`NL_SET_ERR_MSG_MOD
(
exèck
,

1665  -
EINVAL
;

1669 
	}
}

1671 
	$rvu_af_≈c_exa˘_„©uª_gë
(
devlök
 *devlök, 
u32
 
id
,

1672 
devlök_∑øm_g£t_˘x
 *
˘x
)

1674 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1675 
rvu
 *rvu = 
rvu_dl
->rvu;

1676 
boﬁ
 
íabÀd
;

1678 
íabÀd
 = 
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
);

1680 
	`¢¥ötf
(
˘x
->
vÆ
.
v°r
, (ctx->val.vstr), "%s",

1681 
íabÀd
 ? "enabled" : "disabled");

1684 
	}
}

1686 
	$rvu_af_≈c_exa˘_„©uª_dißbÀ
(
devlök
 *devlök, 
u32
 
id
,

1687 
devlök_∑øm_g£t_˘x
 *
˘x
)

1689 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1690 
rvu
 *rvu = 
rvu_dl
->rvu;

1692 
	`rvu_≈c_exa˘_dißbÀ_„©uª
(
rvu
);

1695 
	}
}

1697 
	$rvu_af_≈c_exa˘_„©uª_vÆid©e
(
devlök
 *devlök, 
u32
 
id
,

1698 
devlök_∑øm_vÆue
 
vÆ
,

1699 
√éök_ext_ack
 *
exèck
)

1701 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1702 
rvu
 *rvu = 
rvu_dl
->rvu;

1703 
u64
 
íabÀ
;

1705 i‡(
	`k°πouŒ
(
vÆ
.
v°r
, 10, &
íabÀ
)) {

1706 
	`NL_SET_ERR_MSG_MOD
(
exèck
,

1708  -
EINVAL
;

1711 i‡(
íabÀ
 != 1) {

1712 
	`NL_SET_ERR_MSG_MOD
(
exèck
,

1714  -
EINVAL
;

1717 i‡(
	`rvu_≈c_exa˘_ˇn_dißbÀ_„©uª
(
rvu
))

1720 
	`NL_SET_ERR_MSG_MOD
(
exèck
,

1722  -
EFAULT
;

1723 
	}
}

1725 c⁄° 
devlök_∑øm
 
	grvu_af_dl_∑øms
[] = {

1726 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_DWRR_MTU
,

1727 "dwº_mtu", 
DEVLINK_PARAM_TYPE_U32
,

1728 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1729 
rvu_af_dl_dwº_mtu_gë
, 
rvu_af_dl_dwº_mtu_£t
,

1730 
rvu_af_dl_dwº_mtu_vÆid©e
),

1731 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_TIMERS
,

1732 "tim_ˇ±uª_timîs", 
DEVLINK_PARAM_TYPE_U8
,

1733 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1734 
rvu_af_dl_tim_ˇ±uª_timîs_gë
,

1735 
rvu_af_dl_tim_ˇ±uª_timîs_£t
,

1736 
rvu_af_dl_tim_ˇ±uª_timîs_vÆid©e
),

1737 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_TENNS
,

1738 "tim_ˇ±uª_ã¬s", 
DEVLINK_PARAM_TYPE_STRING
,

1739 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1740 
rvu_af_dl_tim_ˇ±uª_time_gë
,

1741 
rvu_af_dl_tim_ˇ±uª_time_£t
, 
NULL
),

1742 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_GPIOS
,

1743 "tim_ˇ±uª_gpios", 
DEVLINK_PARAM_TYPE_STRING
,

1744 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1745 
rvu_af_dl_tim_ˇ±uª_time_gë
,

1746 
rvu_af_dl_tim_ˇ±uª_time_£t
, 
NULL
),

1747 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_GTI
,

1748 "tim_ˇ±uª_gti", 
DEVLINK_PARAM_TYPE_STRING
,

1749 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1750 
rvu_af_dl_tim_ˇ±uª_time_gë
,

1751 
rvu_af_dl_tim_ˇ±uª_time_£t
, 
NULL
),

1752 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_PTP
,

1753 "tim_ˇ±uª_±p", 
DEVLINK_PARAM_TYPE_STRING
,

1754 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1755 
rvu_af_dl_tim_ˇ±uª_time_gë
,

1756 
rvu_af_dl_tim_ˇ±uª_time_£t
, 
NULL
),

1757 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_SYNC
,

1758 "tim_ˇ±uª_sync", 
DEVLINK_PARAM_TYPE_STRING
,

1759 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1760 
rvu_af_dl_tim_ˇ±uª_time_gë
,

1761 
rvu_af_dl_tim_ˇ±uª_time_£t
, 
NULL
),

1762 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_BTS
,

1763 "tim_ˇ±uª_bts", 
DEVLINK_PARAM_TYPE_STRING
,

1764 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1765 
rvu_af_dl_tim_ˇ±uª_time_gë
,

1766 
rvu_af_dl_tim_ˇ±uª_time_£t
, 
NULL
),

1767 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_CAPTURE_EXT_GTI
,

1768 "tim_ˇ±uª_ext_gti", 
DEVLINK_PARAM_TYPE_STRING
,

1769 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1770 
rvu_af_dl_tim_ˇ±uª_time_gë
,

1771 
rvu_af_dl_tim_ˇ±uª_time_£t
, 
NULL
),

1772 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_TIMERS
,

1773 "tim_adju°_timîs", 
DEVLINK_PARAM_TYPE_BOOL
,

1774 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1775 
rvu_af_dl_tim_adju°_timîs_gë
,

1776 
rvu_af_dl_tim_adju°_timîs_£t
, 
NULL
),

1777 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_TENNS
,

1778 "tim_adju°_ã¬s", 
DEVLINK_PARAM_TYPE_STRING
,

1779 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1780 
rvu_af_dl_tim_adju°_timî_gë
,

1781 
rvu_af_dl_tim_adju°_timî_£t
,

1782 
rvu_af_dl_tim_adju°_timî_vÆid©e
),

1783 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_GPIOS
,

1784 "tim_adju°_gpios", 
DEVLINK_PARAM_TYPE_STRING
,

1785 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1786 
rvu_af_dl_tim_adju°_timî_gë
,

1787 
rvu_af_dl_tim_adju°_timî_£t
,

1788 
rvu_af_dl_tim_adju°_timî_vÆid©e
),

1789 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_GTI
,

1790 "tim_adju°_gti", 
DEVLINK_PARAM_TYPE_STRING
,

1791 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1792 
rvu_af_dl_tim_adju°_timî_gë
,

1793 
rvu_af_dl_tim_adju°_timî_£t
,

1794 
rvu_af_dl_tim_adju°_timî_vÆid©e
),

1795 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_PTP
,

1796 "tim_adju°_±p", 
DEVLINK_PARAM_TYPE_STRING
,

1797 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1798 
rvu_af_dl_tim_adju°_timî_gë
,

1799 
rvu_af_dl_tim_adju°_timî_£t
,

1800 
rvu_af_dl_tim_adju°_timî_vÆid©e
),

1801 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_TIM_ADJUST_BTS
,

1802 "tim_adju°_bts", 
DEVLINK_PARAM_TYPE_STRING
,

1803 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1804 
rvu_af_dl_tim_adju°_timî_gë
,

1805 
rvu_af_dl_tim_adju°_timî_£t
,

1806 
rvu_af_dl_tim_adju°_timî_vÆid©e
),

1807 
DEVLINK_PARAM_DRIVER
(
RVU_AF_DEVLINK_PARAM_ID_NPC_EXACT_FEATURE_DISABLE
,

1808 "≈c_exa˘_„©uª_dißbÀ", 
DEVLINK_PARAM_TYPE_STRING
,

1809 
BIT
(
DEVLINK_PARAM_CMODE_RUNTIME
),

1810 
rvu_af_≈c_exa˘_„©uª_gë
,

1811 
rvu_af_≈c_exa˘_„©uª_dißbÀ
,

1812 
rvu_af_≈c_exa˘_„©uª_vÆid©e
),

1816 
	$rvu_devlök_eswôch_mode_gë
(
devlök
 *devlök, 
u16
 *
mode
)

1818 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1819 
rvu
 *rvu = 
rvu_dl
->rvu;

1820 
rvu_swôch
 *
rswôch
;

1822 
rswôch
 = &
rvu
->rswitch;

1823 *
mode
 = 
rswôch
->mode;

1826 
	}
}

1828 
	$rvu_devlök_eswôch_mode_£t
(
devlök
 *devlök, 
u16
 
mode
,

1829 
√éök_ext_ack
 *
exèck
)

1831 
rvu_devlök
 *
rvu_dl
 = 
	`devlök_¥iv
(
devlök
);

1832 
rvu
 *rvu = 
rvu_dl
->rvu;

1833 
rvu_swôch
 *
rswôch
;

1835 
rswôch
 = &
rvu
->rswitch;

1836 
mode
) {

1837 
DEVLINK_ESWITCH_MODE_LEGACY
:

1838 
DEVLINK_ESWITCH_MODE_SWITCHDEV
:

1839 i‡(
rswôch
->
mode
 == mode)

1841 
rswôch
->
mode
 = mode;

1842 i‡(
mode
 =
DEVLINK_ESWITCH_MODE_SWITCHDEV
)

1843 
	`rvu_swôch_íabÀ
(
rvu
);

1845 
	`rvu_swôch_dißbÀ
(
rvu
);

1848  -
EINVAL
;

1852 
	}
}

1854 
	$rvu_devlök_öfo_gë
(
devlök
 *devlök, 
devlök_öfo_ªq
 *
ªq
,

1855 
√éök_ext_ack
 *
exèck
)

1857  
	`devlök_öfo_drivî_«me_put
(
ªq
, 
DRV_NAME
);

1858 
	}
}

1860 c⁄° 
devlök_›s
 
	grvu_devlök_›s
 = {

1861 .
öfo_gë
 = 
rvu_devlök_öfo_gë
,

1862 .
	geswôch_mode_gë
 = 
rvu_devlök_eswôch_mode_gë
,

1863 .
	geswôch_mode_£t
 = 
rvu_devlök_eswôch_mode_£t
,

1866 
	$rvu_ªgi°î_dl
(
rvu
 *rvu)

1868 
rvu_devlök
 *
rvu_dl
;

1869 
devlök
 *
dl
;

1870 
size_t
 
size
;

1871 
îr
;

1873 
dl
 = 
	`devlök_Æloc
(&
rvu_devlök_›s
, (
rvu_devlök
));

1874 i‡(!
dl
) {

1875 
	`dev_w¨n
(
rvu
->
dev
, "devlink_alloc failed\n");

1876  -
ENOMEM
;

1879 
îr
 = 
	`devlök_ªgi°î
(
dl
, 
rvu
->
dev
);

1880 i‡(
îr
) {

1881 
	`dev_îr
(
rvu
->
dev
, "devlökÑegi°î faûed wôhÉº‹ %d\n", 
îr
);

1882 
	`devlök_‰ì
(
dl
);

1883  
îr
;

1886 
rvu_dl
 = 
	`devlök_¥iv
(
dl
);

1887 
rvu_dl
->
dl
 = dl;

1888 
rvu_dl
->
rvu
 =Ñvu;

1889 
rvu
->
rvu_dl
 =Ñvu_dl;

1891 
îr
 = 
	`rvu_hó…h_ªp‹ãrs_¸óã
(
rvu
);

1892 i‡(
îr
) {

1893 
	`dev_îr
(
rvu
->
dev
,

1894 "devlök hó…hÑï‹ã∏¸óti⁄ faûed wôhÉº‹ %d\n", 
îr
);

1895 
îr_dl_hó…h
;

1899 
size
 = 
	`ARRAY_SIZE
(
rvu_af_dl_∑øms
);

1900 i‡(!
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

1901 
size
 -= 1;

1903 
îr
 = 
	`devlök_∑øms_ªgi°î
(
dl
, 
rvu_af_dl_∑øms
, 
size
);

1904 i‡(
îr
) {

1905 
	`dev_îr
(
rvu
->
dev
,

1906 "devlökÖ¨am†ªgi°î faûed wôhÉº‹ %d", 
îr
);

1907 
îr_dl_hó…h
;

1910 
	`devlök_∑øms_publish
(
dl
);

1914 
îr_dl_hó…h
:

1915 
	`rvu_hó…h_ªp‹ãrs_de°roy
(
rvu
);

1916 
	`devlök_uƒegi°î
(
dl
);

1917 
	`devlök_‰ì
(
dl
);

1918  
îr
;

1919 
	}
}

1921 
	$rvu_uƒegi°î_dl
(
rvu
 *rvu)

1923 
rvu_devlök
 *
rvu_dl
 = 
rvu
->rvu_dl;

1924 
devlök
 *
dl
 = 
rvu_dl
->dl;

1926 i‡(!
dl
)

1929 
	`devlök_∑øms_uƒegi°î
(
dl
, 
rvu_af_dl_∑øms
,

1930 
	`ARRAY_SIZE
(
rvu_af_dl_∑øms
));

1931 
	`rvu_hó…h_ªp‹ãrs_de°roy
(
rvu
);

1932 
	`devlök_uƒegi°î
(
dl
);

1933 
	`devlök_‰ì
(
dl
);

1934 
	}
}

	@rvu_devlink.h

8 #i‚de‡
RVU_DEVLINK_H


9 
	#RVU_DEVLINK_H


	)

11 
	#RVU_REPORTERS
(
_«me
) \

12 c⁄° 
devlök_hó…h_ªp‹ãr_›s
 
rvu_
 ## 
_«me
 ## 
_ªp‹ãr_›s
 = { \

13 .
«me
 = #_name, \

14 .
ªcovî
 = 
rvu_
 ## 
_«me
 ## 
_ªcovî
, \

15 .
dump
 = 
rvu_
 ## 
_«me
 ## 
_dump
, \

16 }

	)

18 
	e≈a_af_rvu_hó…h
 {

19 
	mNPA_AF_RVU_INTR
,

20 
	mNPA_AF_RVU_GEN
,

21 
	mNPA_AF_RVU_ERR
,

22 
	mNPA_AF_RVU_RAS
,

25 
	srvu_≈a_evít_˘x
 {

26 
u64
 
	m≈a_af_rvu_öt
;

27 
u64
 
	m≈a_af_rvu_gí
;

28 
u64
 
	m≈a_af_rvu_îr
;

29 
u64
 
	m≈a_af_rvu_øs
;

32 
	srvu_≈a_hó…h_ªp‹ãrs
 {

33 
rvu_≈a_evít_˘x
 *
	m≈a_evít_˘x
;

34 
devlök_hó…h_ªp‹ãr
 *
	mrvu_hw_≈a_öå_ªp‹ãr
;

35 
w‹k_°ru˘
 
	möå_w‹k
;

36 
devlök_hó…h_ªp‹ãr
 *
	mrvu_hw_≈a_gí_ªp‹ãr
;

37 
w‹k_°ru˘
 
	mgí_w‹k
;

38 
devlök_hó…h_ªp‹ãr
 *
	mrvu_hw_≈a_îr_ªp‹ãr
;

39 
w‹k_°ru˘
 
	mîr_w‹k
;

40 
devlök_hó…h_ªp‹ãr
 *
	mrvu_hw_≈a_øs_ªp‹ãr
;

41 
w‹k_°ru˘
 
	møs_w‹k
;

44 
	enix_af_rvu_hó…h
 {

45 
	mNIX_AF_RVU_INTR
,

46 
	mNIX_AF_RVU_GEN
,

47 
	mNIX_AF_RVU_ERR
,

48 
	mNIX_AF_RVU_RAS
,

51 
	srvu_nix_evít_˘x
 {

52 
u64
 
	mnix_af_rvu_öt
;

53 
u64
 
	mnix_af_rvu_gí
;

54 
u64
 
	mnix_af_rvu_îr
;

55 
u64
 
	mnix_af_rvu_øs
;

58 
	srvu_nix_hó…h_ªp‹ãrs
 {

59 
rvu_nix_evít_˘x
 *
	mnix_evít_˘x
;

60 
devlök_hó…h_ªp‹ãr
 *
	mrvu_hw_nix_öå_ªp‹ãr
;

61 
w‹k_°ru˘
 
	möå_w‹k
;

62 
devlök_hó…h_ªp‹ãr
 *
	mrvu_hw_nix_gí_ªp‹ãr
;

63 
w‹k_°ru˘
 
	mgí_w‹k
;

64 
devlök_hó…h_ªp‹ãr
 *
	mrvu_hw_nix_îr_ªp‹ãr
;

65 
w‹k_°ru˘
 
	mîr_w‹k
;

66 
devlök_hó…h_ªp‹ãr
 *
	mrvu_hw_nix_øs_ªp‹ãr
;

67 
w‹k_°ru˘
 
	møs_w‹k
;

70 
	srvu_devlök
 {

71 
devlök
 *
	mdl
;

72 
rvu
 *
	mrvu
;

73 
w‹kqueue_°ru˘
 *
	mdevlök_wq
;

74 
rvu_≈a_hó…h_ªp‹ãrs
 *
	mrvu_≈a_hó…h_ªp‹ãr
;

75 
rvu_nix_hó…h_ªp‹ãrs
 *
	mrvu_nix_hó…h_ªp‹ãr
;

79 
rvu_ªgi°î_dl
(
rvu
 *rvu);

80 
rvu_uƒegi°î_dl
(
rvu
 *rvu);

	@rvu_fixes.c

8 
	~<löux/kthªad.h
>

9 
	~<löux/pci.h
>

10 
	~<löux/˝u.h
>

11 
	~<löux/sched/sig«l.h
>

13 
	~"rvu_°ru˘.h
"

14 
	~"rvu_ªg.h
"

15 
	~"comm⁄.h
"

16 
	~"mbox.h
"

17 
	~"rvu.h
"

18 
	~"cgx.h
"

19 
	~"rvu_fixes.h
"

21 
	#OTX2_MAX_CQ_CNT
 64

	)

23 
	snix_tx_°Æl
 {

24 
rvu
 *
	mrvu
;

25 
	mblkaddr
;

26 
	msmq_cou¡
;

27 
	mé4_cou¡
;

28 
	mé3_cou¡
;

29 
	mé2_cou¡
;

30 
	msq_cou¡
;

31 
u16
 *
	msmq_é2_m≠
;

32 
u16
 *
	mé4_é2_m≠
;

33 
u16
 *
	mé3_é2_m≠
;

34 
u16
 *
	mé2_é1_m≠
;

35 
u16
 *
	msq_smq_m≠
;

36 
	#LINK_TYPE_SHIFT
 7

	)

37 
	#EXPR_LINK
(
m≠
Ë(m≠ & (1 << 
LINK_TYPE_SHIFT
))

	)

38 
	#LINK_CHAN_SHIFT
 8

	)

39 
	#LINK_CHAN
(
m≠
Ë(m≠ >> 
LINK_CHAN_SHIFT
)

	)

40 
u16
 *
	mé2_lök_m≠
;

41 
u8
 *
	mnixlf_é2_cou¡
;

42 
u64
 *
	mnixlf_pﬁl_cou¡
;

43 
u64
 *
	mnixlf_°Æl_cou¡
;

44 
u64
 *
	m∆ök_¸edôs
;

45 
u64
 
	mpﬁl_˙å
;

46 
u64
 
	m°ÆÀd_˙å
;

47 
	mp£_lök_bp_Àvñ
;

48 
boﬁ
 
	mtxsch_c⁄fig_ch™ged
;

49 
muãx
 
	mtxsch_lock
;

50 
èsk_°ru˘
 *
	mpﬁl_thªad
;

58 
ölöe
 
	$rvu_wr64
(
rvu
 *rvu, 
u64
 
block
, u64 
off£t
, u64 
vÆ
)

60 
	`wrôeq_ªœxed
(
vÆ
, 
rvu
->
a‰eg_ba£
 + ((
block
 << 28Ë| 
off£t
));

61 
	}
}

63 
ölöe
 
u64
 
	$rvu_rd64
(
rvu
 *rvu, 
u64
 
block
, u64 
off£t
)

65  
	`ªadq_ªœxed
(
rvu
->
a‰eg_ba£
 + ((
block
 << 28Ë| 
off£t
));

66 
	}
}

75 
	$rvu_u¶ìp_öãºu±ibÀ
(
u£cs
)

77 
timeout
 = 
	`u£cs_to_jiffõs
(
u£cs
) + 1;

79 
timeout
 && !
	`sig«l_≥ndög
(
cuºít
))

80 
timeout
 = 
	`scheduÀ_timeout_öãºu±ibÀ
(timeout);

81  
	`jiffõs_to_u£cs
(
timeout
);

82 
	}
}

84 
	$rvu_nix_txsch_lock
(
nix_hw
 *nix_hw)

86 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

88 i‡(
tx_°Æl
)

89 
	`muãx_lock
(&
tx_°Æl
->
txsch_lock
);

90 
	}
}

92 
	$rvu_nix_txsch_u∆ock
(
nix_hw
 *nix_hw)

94 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

96 i‡(
tx_°Æl
)

97 
	`muãx_u∆ock
(&
tx_°Æl
->
txsch_lock
);

98 
	}
}

100 
	$rvu_nix_txsch_c⁄fig_ch™ged
(
nix_hw
 *nix_hw)

102 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

104 i‡(
tx_°Æl
)

105 
tx_°Æl
->
txsch_c⁄fig_ch™ged
 = 
åue
;

106 
	}
}

108 
	$rvu_nix_upd©e_lök_¸edôs
(
rvu
 *rvu, 
blkaddr
,

109 
lök
, 
u64
 
n¸edôs
)

111 
nix_tx_°Æl
 *
tx_°Æl
;

112 
nix_hw
 *nix_hw;

114 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

115 i‡(!
nix_hw
)

118 
tx_°Æl
 = 
nix_hw
->tx_stall;

119 i‡(!
tx_°Æl
)

122 
	`rvu_nix_txsch_lock
(
nix_hw
);

123 
tx_°Æl
->
∆ök_¸edôs
[
lök
] = 
n¸edôs
;

124 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

125 
	}
}

127 
	$rvu_nix_upd©e_sq_smq_m≠pög
(
rvu
 *rvu, 
blkaddr
, 
nixlf
,

128 
u16
 
sq
, u16 
smq
)

130 
nix_tx_°Æl
 *
tx_°Æl
;

131 
nix_hw
 *nix_hw;

132 
sq_cou¡
;

134 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

135 i‡(!
nix_hw
)

138 
tx_°Æl
 = 
nix_hw
->tx_stall;

139 i‡(!
tx_°Æl
)

142 
sq_cou¡
 = 
tx_°Æl
->sq_count;

144 
	`rvu_nix_txsch_lock
(
nix_hw
);

145 
tx_°Æl
->
sq_smq_m≠
[
nixlf
 * 
sq_cou¡
 + 
sq
] = 
smq
;

146 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

147 
	}
}

149 
	$rvu_nix_sˇn_lök_¸edôs
(
rvu
 *rvu, 
blkaddr
,

150 
nix_tx_°Æl
 *
tx_°Æl
)

152 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

153 
u64
 
¸edôs
;

154 
lök
;

156 
lök
 = 0;Üök < (
hw
->
cgx_löks
 + hw->
lbk_löks
);Üink++) {

157 
¸edôs
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
,

158 
	`NIX_AF_TX_LINKX_NORM_CREDIT
(
lök
));

159 
tx_°Æl
->
∆ök_¸edôs
[
lök
] = 
¸edôs
;

161 
	}
}

163 
	$rvu_nix_sˇn_é2_lök_m≠pög
(
rvu
 *rvu,

164 
nix_tx_°Æl
 *
tx_°Æl
,

165 
blkaddr
, 
é2
, 
smq
)

167 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

168 
lök
, 
ch™
;

169 
u64
 
lök_cfg
;

171 
lök
 = 0;Üök < (
hw
->
cgx_löks
 + hw->
lbk_löks
);Üink++) {

172 
lök_cfg
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
,

173 
	`NIX_AF_TL3_TL2X_LINKX_CFG
(
é2
, 
lök
));

174 i‡(!(
lök_cfg
 & 
	`BIT_ULL
(12)))

178 
ch™
 = 
lök_cfg
 & 0x3F;

179 
tx_°Æl
->
é2_lök_m≠
[
é2
] = 
ch™
 << 
LINK_CHAN_SHIFT
;

182 
tx_°Æl
->
é2_lök_m≠
[
é2
] |(
lök
 & 0x7F);

189 
	}
}

191 
boﬁ
 
	$is_sq_Æloˇãd
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
,

192 
blkaddr
, 
sq
)

194 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

195 
rvu_block
 *
block
;

196 
admö_queue
 *
aq
;

198 
block
 = &
hw
->block[
blkaddr
];

199 
aq
 = 
block
->aq;

200 
	`•ö_lock
(&
aq
->
lock
);

201 i‡(
	`ã°_bô
(
sq
, 
pfvf
->
sq_bm≠
)) {

202 
	`•ö_u∆ock
(&
aq
->
lock
);

203  
åue
;

205 
	`•ö_u∆ock
(&
aq
->
lock
);

206  
Ál£
;

207 
	}
}

209 
boﬁ
 
	$is_schq_Æloˇãd
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

210 
lvl
, 
schq
)

212 
nix_txsch
 *
txsch
 = &
nix_hw
->txsch[
lvl
];

214 
	`muãx_lock
(&
rvu
->
r§c_lock
);

215 i‡(
	`ã°_bô
(
schq
, 
txsch
->schq.
bm≠
)) {

216 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

217  
åue
;

219 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

220  
Ál£
;

221 
	}
}

223 
boﬁ
 
	$is_sw_xoff_£t
(
rvu
 *rvu, 
blkaddr
, 
lvl
, 
schq
)

225 
u64
 
cfg
, 
swxoff_ªg
 = 0x00;

227 
lvl
) {

228 
NIX_TXSCH_LVL_MDQ
:

229 
swxoff_ªg
 = 
	`NIX_AF_MDQX_SW_XOFF
(
schq
);

231 
NIX_TXSCH_LVL_TL4
:

232 
swxoff_ªg
 = 
	`NIX_AF_TL4X_SW_XOFF
(
schq
);

234 
NIX_TXSCH_LVL_TL3
:

235 
swxoff_ªg
 = 
	`NIX_AF_TL3X_SW_XOFF
(
schq
);

237 
NIX_TXSCH_LVL_TL2
:

238 
swxoff_ªg
 = 
	`NIX_AF_TL2X_SW_XOFF
(
schq
);

240 
NIX_TXSCH_LVL_TL1
:

241 
swxoff_ªg
 = 
	`NIX_AF_TL1X_SW_XOFF
(
schq
);

244 i‡(!
swxoff_ªg
)

245  
Ál£
;

247 
cfg
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
swxoff_ªg
);

248 i‡(
cfg
 & 
	`BIT_ULL
(0))

249  
åue
;

251  
Ál£
;

252 
	}
}

254 
	$rvu_nix_sˇn_txsch_hõørchy
(
rvu
 *rvu,

255 
nix_hw
 *nix_hw, 
blkaddr
)

257 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

258 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

259 
nix_txsch
 *
é2_txsch
;

260 
rvu_block
 *
block
;

261 
é4
, 
é3
, 
é2
, 
é1
;

262 
lf
, 
smq
, 
size
;

263 
u16
 
pcifunc
;

264 
u64
 
cfg
;

267 
size
 = (
u16
);

268 
	`mem£t
(
tx_°Æl
->
smq_é2_m≠
, 
U16_MAX
,Åx_°Æl->
smq_cou¡
 * 
size
);

269 
	`mem£t
(
tx_°Æl
->
é4_é2_m≠
, 
U16_MAX
,Åx_°Æl->
é4_cou¡
 * 
size
);

270 
	`mem£t
(
tx_°Æl
->
é3_é2_m≠
, 
U16_MAX
,Åx_°Æl->
é3_cou¡
 * 
size
);

271 
	`mem£t
(
tx_°Æl
->
é2_é1_m≠
, 
U16_MAX
,Åx_°Æl->
é2_cou¡
 * 
size
);

272 
	`mem£t
(
tx_°Æl
->
é2_lök_m≠
, 
U16_MAX
,Åx_°Æl->
é2_cou¡
 * 
size
);

274 
smq
 = 0; smq < 
tx_°Æl
->
smq_cou¡
; smq++) {

276 i‡(!
	`is_schq_Æloˇãd
(
rvu
, 
nix_hw
, 
NIX_TXSCH_LVL_SMQ
, 
smq
))

280 
cfg
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SMQX_CFG
(
smq
));

281 i‡(
cfg
 & 
	`BIT_ULL
(50))

283 i‡(
	`is_sw_xoff_£t
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_MDQ
, 
smq
))

286 
cfg
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_MDQX_PARENT
(
smq
));

287 
é4
 = (
cfg
 >> 16) & 0x1FF;

288 i‡(
	`is_sw_xoff_£t
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_TL4
, 
é4
))

291 
cfg
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL4X_PARENT
(
é4
));

292 
é3
 = (
cfg
 >> 16) & 0x1FF;

293 i‡(
	`is_sw_xoff_£t
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_TL3
, 
é3
))

296 
cfg
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL3X_PARENT
(
é3
));

297 
é2
 = (
cfg
 >> 16) & 0x1FF;

298 i‡(
	`is_sw_xoff_£t
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_TL2
, 
é2
))

301 
cfg
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL2X_PARENT
(
é2
));

302 
é1
 = (
cfg
 >> 16) & 0x1FF;

303 i‡(
	`is_sw_xoff_£t
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_TL1
, 
é1
))

306 
tx_°Æl
->
smq_é2_m≠
[
smq
] = 
é2
;

307 
tx_°Æl
->
é4_é2_m≠
[
é4
] = 
é2
;

308 
tx_°Æl
->
é3_é2_m≠
[
é3
] = 
é2
;

309 
tx_°Æl
->
é2_é1_m≠
[
é2
] = 
é1
;

310 
	`rvu_nix_sˇn_é2_lök_m≠pög
(
rvu
, 
tx_°Æl
, 
blkaddr
, 
é2
, 
smq
);

314 
é2_txsch
 = &
nix_hw
->
txsch
[
NIX_TXSCH_LVL_TL2
];

315 
block
 = &
hw
->block[
blkaddr
];

316 
	`mem£t
(
tx_°Æl
->
nixlf_é2_cou¡
, 0, 
block
->
lf
.
max
 * (
u8
));

317 
lf
 = 0;Ü‡< 
block
->lf.
max
;Üf++) {

318 
	`muãx_lock
(&
rvu
->
r§c_lock
);

319 i‡(!
	`ã°_bô
(
lf
, 
block
->lf.
bm≠
)) {

320 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

323 
pcifunc
 = 
block
->
‚_m≠
[
lf
];

324 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

326 
é2
 = 0;Ål2 < 
tx_°Æl
->
é2_cou¡
;Ål2++) {

327 i‡(!
	`is_schq_Æloˇãd
(
rvu
, 
nix_hw
,

328 
NIX_TXSCH_LVL_TL2
, 
é2
))

330 i‡(
pcifunc
 =
	`TXSCH_MAP_FUNC
(
é2_txsch
->
pfvf_m≠
[
é2
]))

331 
tx_°Æl
->
nixlf_é2_cou¡
[
lf
]++;

334 
	}
}

336 
	#TX_OCTS
 4

	)

337 
	#RVU_AF_BAR2_SEL
 (0x9000000uŒ)

	)

338 
	#NIX_LF_SQ_OP_OCTS
 (0xa10)

	)

340 
boﬁ
 
	$is_sq_°ÆÀd
(
rvu
 *rvu, 
nix_hw
 *nix_hw, 
smq
)

342 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

343 
u64
 
btx_o˘s
, 
©x_o˘s
, 
cfg
, 
ö¸
;

344 
sq_cou¡
 = 
tx_°Æl
->sq_count;

345 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

346 
blkaddr
 = 
tx_°Æl
->blkaddr;

347 
nix_txsch
 *
smq_txsch
;

348 
rvu_pfvf
 *
pfvf
;

349 
©omic64_t
 *
±r
;

350 
nixlf
, 
sq
;

351 
u16
 
pcifunc
;

353 
smq_txsch
 = &
nix_hw
->
txsch
[
NIX_TXSCH_LVL_SMQ
];

354 
pcifunc
 = 
	`TXSCH_MAP_FUNC
(
smq_txsch
->
pfvf_m≠
[
smq
]);

355 
nixlf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

356 i‡(
nixlf
 < 0)

357  
Ál£
;

362 i‡(
tx_°Æl
->
nixlf_é2_cou¡
[
nixlf
] != 1)

363 
pﬁl_sq_°©s
;

365 
tx_°Æl
->
nixlf_pﬁl_cou¡
[
nixlf
]++;

366 
btx_o˘s
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_STATX
(
nixlf
, 
TX_OCTS
));

367 
	`u¶ìp_ønge
(50, 60);

368 
©x_o˘s
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_STATX
(
nixlf
, 
TX_OCTS
));

369 i‡(
btx_o˘s
 =
©x_o˘s
) {

370 
tx_°Æl
->
nixlf_°Æl_cou¡
[
nixlf
]++;

371  
åue
;

373  
Ál£
;

375 
pﬁl_sq_°©s
:

376 i‡(!
tx_°Æl
->
nixlf_é2_cou¡
[
nixlf
])

377  
Ál£
;

379 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

382 
cfg
 = 
	`BIT_ULL
(16Ë| 
pcifunc
;

383 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
RVU_AF_BAR2_SEL
, 
cfg
);

385 
sq
 = 0; sq < 
pfvf
->
sq_˘x
->
qsize
; sq++) {

386 i‡(!
	`is_sq_Æloˇãd
(
rvu
, 
pfvf
, 
blkaddr
, 
sq
))

389 
	`rvu_nix_txsch_lock
(
nix_hw
);

390 i‡(
tx_°Æl
->
sq_smq_m≠
[
nixlf
 * 
sq_cou¡
 + 
sq
] !
smq
) {

391 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

394 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

396 
ö¸
 = (
u64
)
sq
 << 32;

397 
±r
 = (
__f‹˚
 
©omic64_t
 *)(
rvu
->
a‰eg_ba£
 + ((
blkaddr
 << 28)

398 | 
	`RVU_AF_BAR2_ALIASX
(
nixlf
, 
NIX_LF_SQ_OP_OCTS
)));

400 
btx_o˘s
 = 
	`©omic64_„tch_add_ªœxed
(
ö¸
, 
±r
);

401 
	`u¶ìp_ønge
(50, 60);

402 
©x_o˘s
 = 
	`©omic64_„tch_add_ªœxed
(
ö¸
, 
±r
);

406 i‡(
btx_o˘s
 !
©x_o˘s
)

407  
Ál£
;

409 
tx_°Æl
->
nixlf_°Æl_cou¡
[
nixlf
]++;

411  
åue
;

412 
	}
}

414 
boﬁ
 
	$rvu_nix_check_smq_°Æl
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

415 
é2
)

417 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

418 
blkaddr
 = 
tx_°Æl
->blkaddr;

419 
u64
 
mdesc_˙t
;

420 
smq
;

422 
smq
 = 0; smq < 
tx_°Æl
->
smq_cou¡
; smq++) {

423 i‡(
tx_°Æl
->
smq_é2_m≠
[
smq
] !
é2
)

426 
mdesc_˙t
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SMQX_STATUS
(
smq
));

427 i‡(!(
mdesc_˙t
 & 0x7F))

429 i‡(
	`is_sq_°ÆÀd
(
rvu
, 
nix_hw
, 
smq
))

430  
åue
;

432  
Ál£
;

433 
	}
}

435 
boﬁ
 
	$is_cgx_idÀ
(
u64
 
°©us
, 
u8
 
lök_m≠
)

437 i‡(
	`EXPR_LINK
(
lök_m≠
))

438  
°©us
 & 
CGXX_CMRX_TX_LMAC_E_IDLE
;

439  
°©us
 & 
CGXX_CMRX_TX_LMAC_IDLE
;

440 
	}
}

442 
boﬁ
 
	$rvu_cgx_tx_idÀ
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

443 
nix_txsch
 *
é2_txsch
, 
é2
)

445 
timeout
 = 
jiffõs
 + 
	`u£cs_to_jiffõs
(20);

446 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

447 
u16
 
pcifunc
, 
lök_m≠
;

448 
u8
 
cgx_id
, 
lmac_id
;

449 
u64
 
°©us
;

450 *
cgxd
;

451 
pf
;

453 
pcifunc
 = 
	`TXSCH_MAP_FUNC
(
é2_txsch
->
pfvf_m≠
[
é2
]);

454 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

455 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

456  
Ál£
;

458 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

459 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

460 i‡(!
cgxd
)

461  
Ál£
;

463 
lök_m≠
 = 
tx_°Æl
->
é2_lök_m≠
[
é2
];

466 
	`time_bef‹e
(
jiffõs
, 
timeout
)) {

467 
°©us
 = 
	`cgx_gë_lmac_tx_fifo_°©us
(
cgxd
, 
lmac_id
);

468 i‡(
	`is_cgx_idÀ
(
°©us
, 
lök_m≠
))

469  
åue
;

470 
	`u¶ìp_ønge
(1, 2);

472  
Ál£
;

473 
	}
}

475 
	$rvu_nix_ª°‹e_tx
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

476 
blkaddr
, 
é2
)

478 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

479 
nix_txsch
 *
é2_txsch
;

480 
é
, 
lök
;

482 
lök
 = 
tx_°Æl
->
é2_lök_m≠
[
é2
] & 0x7F;

484 
tx_°Æl
->
°ÆÀd_˙å
++;

486 
é2_txsch
 = &
nix_hw
->
txsch
[
NIX_TXSCH_LVL_TL2
];

487 
	`rvu_nix_txsch_lock
(
nix_hw
);

492 
é
 = 0;Å»< 
tx_°Æl
->
é2_cou¡
;Ål++) {

493 i‡((
tx_°Æl
->
é2_lök_m≠
[
é
] & 0x7FË!
lök
)

501 i‡(
tx_°Æl
->
p£_lök_bp_Àvñ
 =
NIX_TXSCH_LVL_TL2
)

502 
	`rvu_wr64
(
rvu
, 
blkaddr
,

503 
	`NIX_AF_TL2X_SW_XOFF
(
é
), 
	`BIT_ULL
(0));

505 
	`rvu_wr64
(
rvu
, 
blkaddr
,

506 
	`NIX_AF_TL3X_SW_XOFF
(
é
), 
	`BIT_ULL
(0));

508 
	`u¶ìp_ønge
(20, 25);

511 i‡(
lök
 < 
rvu
->
hw
->
cgx_löks
) {

512 i‡(!
	`rvu_cgx_tx_idÀ
(
rvu
, 
nix_hw
, 
é2_txsch
, 
é2
))

513 
˛ór_sw_xoff
;

517 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TX_LINKX_NORM_CREDIT
(
lök
),

518 
tx_°Æl
->
∆ök_¸edôs
[
lök
]);

523 
é
 = 0;Å»< 
tx_°Æl
->
smq_cou¡
;Ål++) {

524 i‡(
tx_°Æl
->
smq_é2_m≠
[
é
] !
é2
)

526 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
	`NIX_AF_MDQX_SW_XOFF
(
é
), 
	`BIT_ULL
(0));

527 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
	`NIX_AF_MDQX_SW_XOFF
(
é
), 0x00);

530 
é
 = 0;Å»< 
tx_°Æl
->
é4_cou¡
;Ål++) {

531 i‡(
tx_°Æl
->
é4_é2_m≠
[
é
] !
é2
)

533 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL4X_SW_XOFF
(
é
), 
	`BIT_ULL
(0));

534 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL4X_SW_XOFF
(
é
), 0x00);

537 
é
 = 0;Å»< 
tx_°Æl
->
é3_cou¡
;Ål++) {

538 i‡(
tx_°Æl
->
é3_é2_m≠
[
é
] !
é2
)

540 i‡(
tx_°Æl
->
p£_lök_bp_Àvñ
 =
NIX_TXSCH_LVL_TL2
) {

541 
	`rvu_wr64
(
rvu
, 
blkaddr
,

542 
	`NIX_AF_TL3X_SW_XOFF
(
é
), 
	`BIT_ULL
(0));

543 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL3X_SW_XOFF
(
é
), 0x00);

546 
	`rvu_wr64
(
rvu
, 
blkaddr
,

547 
	`NIX_AF_TL2X_SW_XOFF
(
é
), 
	`BIT_ULL
(0));

548 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL2X_SW_XOFF
(
é
), 0x00);

552 
˛ór_sw_xoff
:

554 
é
 = 0;Å»< 
tx_°Æl
->
é2_cou¡
;Ål++) {

555 i‡((
tx_°Æl
->
é2_lök_m≠
[
é
] & 0x7FË!
lök
)

557 i‡(
tx_°Æl
->
p£_lök_bp_Àvñ
 =
NIX_TXSCH_LVL_TL2
)

558 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL2X_SW_XOFF
(
é
), 0x00);

560 
	`rvu_wr64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL3X_SW_XOFF
(
é
), 0x00);

562 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

563 
	}
}

565 
boﬁ
 
	$is_lök_back¥essuªd
(
nix_tx_°Æl
 *
tx_°Æl
,

566 
nix_hw
 *nix_hw,

567 
blkaddr
, 
é2
)

569 
rvu
 *rvu = 
tx_°Æl
->rvu;

570 
nix_txsch
 *
é2_txsch
;

571 
pkt_˙t
, 
unô_˙t
;

572 
lök
, 
ch™
;

573 
u64
 
cfg
;

576 i‡(
tx_°Æl
->
é2_lök_m≠
[
é2
] =
U16_MAX
)

577  
åue
;

579 
lök
 = 
tx_°Æl
->
é2_lök_m≠
[
é2
] & 0x7F;

580 
ch™
 = 
	`LINK_CHAN
(
tx_°Æl
->
é2_lök_m≠
[
é2
]);

582 
cfg
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TX_LINKX_HW_XOFF
(
lök
));

583 i‡(
cfg
 & 
	`BIT_ULL
(
ch™
))

584  
åue
;

587 i‡(
lök
 >
rvu
->
hw
->
cgx_löks
)

588  
Ál£
;

590 
cfg
 = 
	`rvu_rd64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TX_LINKX_NORM_CREDIT
(
lök
));

595 
pkt_˙t
 = (
cfg
 >> 2) & 0x3FF;

596 
unô_˙t
 = (
cfg
 >> 12) & 0xFFFFF;

597 i‡(
pkt_˙t
 > ((
tx_°Æl
->
∆ök_¸edôs
[
lök
] >> 2) & 0x3FF) ||

598 
unô_˙t
 > ((
tx_°Æl
->
∆ök_¸edôs
[
lök
] >> 12) & 0xFFFFF)) {

599  
Ál£
;

602 
é2_txsch
 = &
nix_hw
->
txsch
[
NIX_TXSCH_LVL_TL2
];

603 i‡(
	`rvu_cgx_tx_idÀ
(
rvu
, 
nix_hw
, 
é2_txsch
, 
é2
))

604  
Ál£
;

606  
åue
;

607 
	}
}

609 
	$rvu_nix_pﬁl_f‹_tx_°Æl
(*
¨g
)

611 
nix_tx_°Æl
 *
tx_°Æl
 = 
¨g
;

612 
rvu
 *rvu = 
tx_°Æl
->rvu;

613 
blkaddr
 = 
tx_°Æl
->blkaddr;

614 
nix_hw
 *nix_hw;

615 
é2
;

617 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

618 i‡(!
nix_hw
)

619  -
EINVAL
;

621 !
	`kthªad_should_°›
()) {

622 
é2
 = 0;Ål2 < 
tx_°Æl
->
é2_cou¡
;Ål2++) {

624 i‡(!
	`is_schq_Æloˇãd
(
rvu
, 
nix_hw
,

625 
NIX_TXSCH_LVL_TL2
, 
é2
))

628 
tx_°Æl
->
pﬁl_˙å
++;

630 i‡(
tx_°Æl
->
txsch_c⁄fig_ch™ged
) {

631 
	`rvu_nix_txsch_lock
(
nix_hw
);

632 
	`rvu_nix_sˇn_txsch_hõørchy
(
rvu
, 
nix_hw
,

633 
blkaddr
);

634 
tx_°Æl
->
txsch_c⁄fig_ch™ged
 = 
Ál£
;

635 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

638 
	`rvu_nix_txsch_lock
(
nix_hw
);

639 i‡(
	`is_lök_back¥essuªd
(
tx_°Æl
, 
nix_hw
,

640 
blkaddr
, 
é2
)) {

641 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

644 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

646 i‡(!
	`rvu_nix_check_smq_°Æl
(
rvu
, 
nix_hw
, 
é2
))

649 
	`rvu_nix_ª°‹e_tx
(
rvu
, 
nix_hw
, 
blkaddr
, 
é2
);

651 
	`rvu_u¶ìp_öãºu±ibÀ
(250);

655 
	}
}

657 
	$rvu_nix_öô_é_m≠
(
rvu
 *rvu, 
nix_hw
 *nix_hw, 
lvl
)

659 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

660 
nix_txsch
 *
txsch
;

661 
u16
 *
é_m≠
;

663 
txsch
 = &
nix_hw
->txsch[
lvl
];

664 
é_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
txsch
->
schq
.
max
,

665 (
u16
), 
GFP_KERNEL
);

666 i‡(!
é_m≠
)

667  -
ENOMEM
;

669 
lvl
) {

670 
NIX_TXSCH_LVL_SMQ
:

671 
tx_°Æl
->
smq_cou¡
 = 
txsch
->
schq
.
max
;

672 
tx_°Æl
->
smq_é2_m≠
 = 
é_m≠
;

674 
NIX_TXSCH_LVL_TL4
:

675 
tx_°Æl
->
é4_cou¡
 = 
txsch
->
schq
.
max
;

676 
tx_°Æl
->
é4_é2_m≠
 = 
é_m≠
;

678 
NIX_TXSCH_LVL_TL3
:

679 
tx_°Æl
->
é3_cou¡
 = 
txsch
->
schq
.
max
;

680 
tx_°Æl
->
é3_é2_m≠
 = 
é_m≠
;

682 
NIX_TXSCH_LVL_TL2
:

683 
tx_°Æl
->
é2_cou¡
 = 
txsch
->
schq
.
max
;

684 
tx_°Æl
->
é2_é1_m≠
 = 
é_m≠
;

687 
	`mem£t
(
é_m≠
, 
U16_MAX
, 
txsch
->
schq
.
max
 * (
u16
));

689 
	}
}

691 
	$rvu_nix_tx_°Æl_w‹k¨ound_öô
(
rvu
 *rvu,

692 
nix_hw
 *nix_hw, 
blkaddr
)

694 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

695 
nix_tx_°Æl
 *
tx_°Æl
;

696 
rvu_block
 *
block
;

697 
löks
, 
îr
;

699 i‡(!
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
)

702 
tx_°Æl
 = 
	`devm_kzÆloc
(
rvu
->
dev
,

703 (
nix_tx_°Æl
), 
GFP_KERNEL
);

704 i‡(!
tx_°Æl
)

705  -
ENOMEM
;

707 
tx_°Æl
->
blkaddr
 = blkaddr;

708 
tx_°Æl
->
rvu
 =Ñvu;

709 
nix_hw
->
tx_°Æl
 =Åx_stall;

712 i‡(
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_PSE_CHANNEL_LEVEL
))

713 
tx_°Æl
->
p£_lök_bp_Àvñ
 = 
NIX_TXSCH_LVL_TL3
;

715 
tx_°Æl
->
p£_lök_bp_Àvñ
 = 
NIX_TXSCH_LVL_TL2
;

717 
	`muãx_öô
(&
tx_°Æl
->
txsch_lock
);

720 
îr
 = 
	`rvu_nix_öô_é_m≠
(
rvu
, 
nix_hw
, 
NIX_TXSCH_LVL_SMQ
);

721 i‡(
îr
)

722  
îr
;

723 
îr
 = 
	`rvu_nix_öô_é_m≠
(
rvu
, 
nix_hw
, 
NIX_TXSCH_LVL_TL4
);

724 i‡(
îr
)

725  
îr
;

726 
îr
 = 
	`rvu_nix_öô_é_m≠
(
rvu
, 
nix_hw
, 
NIX_TXSCH_LVL_TL3
);

727 i‡(
îr
)

728  
îr
;

729 
îr
 = 
	`rvu_nix_öô_é_m≠
(
rvu
, 
nix_hw
, 
NIX_TXSCH_LVL_TL2
);

730 i‡(
îr
)

731  
îr
;

733 
block
 = &
hw
->block[
blkaddr
];

734 
tx_°Æl
->
sq_cou¡
 = 
	`mö_t
(, 
	`num_⁄löe_˝us
(), 
OTX2_MAX_CQ_CNT
);

737 
tx_°Æl
->
sq_smq_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
,

738 
block
->
lf
.
max
 * 
tx_°Æl
->
sq_cou¡
,

739 (
u16
), 
GFP_KERNEL
);

740 i‡(!
tx_°Æl
->
sq_smq_m≠
)

741  -
ENOMEM
;

742 
	`mem£t
(
tx_°Æl
->
sq_smq_m≠
, 
U16_MAX
,

743 
block
->
lf
.
max
 * 
tx_°Æl
->
sq_cou¡
 * (
u16
));

746 
tx_°Æl
->
é2_lök_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
,Åx_°Æl->
é2_cou¡
,

747 (
u16
), 
GFP_KERNEL
);

748 i‡(!
tx_°Æl
->
é2_lök_m≠
)

749  -
ENOMEM
;

750 
	`mem£t
(
tx_°Æl
->
é2_lök_m≠
, 
U16_MAX
,

751 
tx_°Æl
->
é2_cou¡
 * (
u16
));

754 
tx_°Æl
->
nixlf_é2_cou¡
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
block
->
lf
.
max
,

755 (
u8
), 
GFP_KERNEL
);

756 i‡(!
tx_°Æl
->
nixlf_é2_cou¡
)

757  -
ENOMEM
;

758 
	`mem£t
(
tx_°Æl
->
nixlf_é2_cou¡
, 0, 
block
->
lf
.
max
 * (
u8
));

761 
tx_°Æl
->
nixlf_pﬁl_cou¡
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
block
->
lf
.
max
,

762 (
u64
), 
GFP_KERNEL
);

763 i‡(!
tx_°Æl
->
nixlf_pﬁl_cou¡
)

764  -
ENOMEM
;

765 
	`mem£t
(
tx_°Æl
->
nixlf_pﬁl_cou¡
, 0, 
block
->
lf
.
max
 * (
u64
));

767 
tx_°Æl
->
nixlf_°Æl_cou¡
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
block
->
lf
.
max
,

768 (
u64
), 
GFP_KERNEL
);

769 i‡(!
tx_°Æl
->
nixlf_°Æl_cou¡
)

770  -
ENOMEM
;

771 
	`mem£t
(
tx_°Æl
->
nixlf_°Æl_cou¡
, 0, 
block
->
lf
.
max
 * (
u64
));

774 
löks
 = 
rvu
->
hw
->
cgx_löks
 +Ñvu->hw->
lbk_löks
;

775 
tx_°Æl
->
∆ök_¸edôs
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
löks
,

776 (
u64
), 
GFP_KERNEL
);

777 i‡(!
tx_°Æl
->
∆ök_¸edôs
)

778  -
ENOMEM
;

779 
	`rvu_nix_sˇn_lök_¸edôs
(
rvu
, 
blkaddr
, 
tx_°Æl
);

781 
tx_°Æl
->
pﬁl_thªad
 = 
	`kthªad_¸óã
(
rvu_nix_pﬁl_f‹_tx_°Æl
,

782 (*)
tx_°Æl
,

784 i‡(
	`IS_ERR
(
tx_°Æl
->
pﬁl_thªad
))

785  
	`PTR_ERR
(
tx_°Æl
->
pﬁl_thªad
);

787 
	`kthªad_böd
(
tx_°Æl
->
pﬁl_thªad
, 
	`˝umask_fú°
(
˝u_⁄löe_mask
));

788 
	`wake_up_¥o˚ss
(
tx_°Æl
->
pﬁl_thªad
);

790 
	}
}

792 
	$rvu_nix_tx_°Æl_w‹k¨ound_exô
(
rvu
 *rvu,

793 
nix_hw
 *nix_hw)

795 
nix_tx_°Æl
 *
tx_°Æl
 = 
nix_hw
->tx_stall;

797 i‡(!
tx_°Æl
)

800 i‡(
tx_°Æl
->
pﬁl_thªad
)

801 
	`kthªad_°›
(
tx_°Æl
->
pﬁl_thªad
);

802 
	`muãx_de°roy
(&
tx_°Æl
->
txsch_lock
);

803 
	}
}

805 
ssize_t
 
	$rvu_nix_gë_tx_°Æl_cou¡îs
(
nix_hw
 *nix_hw,

806 
__u£r
 *
buf„r
, 
loff_t
 *
µos
)

808 
rvu
 *rvu = 
nix_hw
->rvu;

809 
rvu_hwöfo
 *
hw
;

810 
nix_tx_°Æl
 *
tx_°Æl
;

811 
rvu_block
 *
block
;

812 
blkaddr
, 
Àn
, 
lf
;

813 
size_t
 
kbuÊí
;

814 *
kbuf
;

816 
hw
 = 
rvu
->hw;

817 i‡(*
µos
)

820 
blkaddr
 = 
nix_hw
->blkaddr;

822 
tx_°Æl
 = 
nix_hw
->tx_stall;

823 i‡(!
tx_°Æl
)

824  -
EFAULT
;

826 
kbuf
 = 
	`vmÆloc
(2000);

827 i‡(!
kbuf
)

828  -
ENOMEM
;

830 
kbuÊí
 = (
kbuf
);

831 
Àn
 = 
	`¢¥ötf
(
kbuf
, 
kbuÊí
, "\n NIXÅransmit stall stats\n");

832 
Àn
 +
	`¢¥ötf
(
kbuf
 +Üí, 
kbuÊí
 -Üen,

833 "\t\tPﬁÀd: \t\t%Œd\n", 
tx_°Æl
->
pﬁl_˙å
);

834 
Àn
 +
	`¢¥ötf
(
kbuf
 +Üí, 
kbuÊí
 -Üen,

836 
tx_°Æl
->
°ÆÀd_˙å
);

838 
block
 = &
hw
->block[
blkaddr
];

839 
	`muãx_lock
(&
rvu
->
r§c_lock
);

840 
lf
 = 0;Ü‡< 
block
->lf.
max
;Üf++) {

841 i‡(!
	`ã°_bô
(
lf
, 
block
->lf.
bm≠
))

843 
Àn
 +
	`¢¥ötf
(
kbuf
 +Üí, 
kbuÊí
 -Üen,

845 
lf
, 
tx_°Æl
->
nixlf_pﬁl_cou¡
[lf],

846 
tx_°Æl
->
nixlf_°Æl_cou¡
[
lf
]);

848 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

850 i‡(
Àn
 > 0) {

851 i‡(
	`c›y_to_u£r
(
buf„r
, 
kbuf
, 
Àn
))

852 
Àn
 = -
EFAULT
;

855 
	`v‰ì
(
kbuf
);

856 i‡(
Àn
 > 0)

857 *
µos
 +
Àn
;

859  
Àn
;

860 
	}
}

862 
	$rvu_nix_íabÀ_öã∫Æ_bp
(
rvu
 *rvu, 
blkaddr
)

869 i‡(
	`is_rvu_96xx_A0
(
rvu
)) {

871 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RQM_BP_TEST
,

872 
	`BIT_ULL
(51) | BIT_ULL(23) | BIT_ULL(22) | 0x100ULL);

874 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_CQM_BP_TEST
,

875 
	`BIT_ULL
(43) | BIT_ULL(23) | BIT_ULL(22) | 0x100ULL);

877 
	}
}

879 
	$rvu_nix_fixes_öô
(
rvu
 *rvu, 
nix_hw
 *nix_hw, 
blkaddr
)

881 
îr
;

882 
u64
 
cfg
;

889 i‡(
	`is_rvu_96xx_A0
(
rvu
))

890 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
,

891 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
) | 0x5EULL);

892 i‡(
	`is_rvu_¥e_96xx_C0
(
rvu
))

893 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
,

894 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
) | 0x40ULL);

897 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_PSE_CHANNEL_LEVEL
, 0x01);

905 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_SQM_DBG_CTL_STATUS
);

906 
cfg
 &~(
	`BIT_ULL
(15) | BIT_ULL(14) | BIT_ULL(23));

910 
cfg
 |
	`BIT_ULL
(21);

911 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_SQM_DBG_CTL_STATUS
, 
cfg
);

913 
	`rvu_nix_íabÀ_öã∫Æ_bp
(
rvu
, 
blkaddr
);

915 i‡(!
	`is_rvu_96xx_A0
(
rvu
))

918 
îr
 = 
	`rvu_nix_tx_°Æl_w‹k¨ound_öô
(
rvu
, 
nix_hw
, 
blkaddr
);

919 i‡(
îr
)

920  
îr
;

923 
	}
}

925 
	$rvu_nix_fixes_exô
(
rvu
 *rvu, 
nix_hw
 *nix_hw)

927 i‡(!
	`is_rvu_96xx_A0
(
rvu
))

930 
	`rvu_nix_tx_°Æl_w‹k¨ound_exô
(
rvu
, 
nix_hw
);

931 
	}
}

933 
	$rvu_tim_lookup_r§c
(
rvu
 *rvu, 
rvu_block
 *
block
,

934 
u16
 
pcifunc
, 
¶Ÿ
)

936 
lf
, 
blkaddr
;

937 
u64
 
vÆ
;

943 i‡(
	`is_rvu_96xx_B0
(
rvu
)) {

944 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
, 
pcifunc
);

945 i‡(
blkaddr
 < 0)

946  
TIM_AF_LF_INVALID
;

948 
lf
 = 0;Ü‡< 
block
->lf.
max
;Üf++) {

949 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, block->
lfcfg_ªg
 |

950 (
lf
 << 
block
->
lfshi·
));

951 i‡((((
vÆ
 >> 8Ë& 0xffffË=
pcifunc
) &&

952 (
vÆ
 & 0xffË=
¶Ÿ
)

953  
lf
;

958 
vÆ
 = ((
u64
)
pcifunc
 << 24Ë| (
¶Ÿ
 << 16) | (1ULL << 13);

959 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, block->
lookup_ªg
, 
vÆ
);

962 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, block->
lookup_ªg
) & (1ULL << 13))

965 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, block->
lookup_ªg
);

968 i‡(!(
vÆ
 & (1ULL << 12)))

971  (
vÆ
 & 0xFFF);

972 
	}
}

974 
	$rvu_≈c_gë_tx_nibbÀ_cfg
(
rvu
 *rvu, 
u64
 
nibbÀ_ía
)

979 i‡(
	`is_rvu_96xx_B0
(
rvu
))

980  
nibbÀ_ía
;

982 
	}
}

984 
boﬁ
 
	$is_∑r£_nibbÀ_c⁄fig_vÆid
(
rvu
 *rvu,

985 
≈c_mˇm_kex
 *
mˇm_kex
)

987 i‡(!
	`is_rvu_96xx_B0
(
rvu
))

988  
åue
;

993 i‡(
mˇm_kex
->
keyx_cfg
[
NIX_INTF_RX
] !mˇm_kex->keyx_cfg[
NIX_INTF_TX
])

994  
Ál£
;

995  
åue
;

996 
	}
}

998 
__wók
 
	$Ÿx2smqvf_xmô
()

1001 
	}
}

1003 
	$rvu_smqvf_xmô
(
rvu
 *rvu)

1005 i‡(
	`is_rvu_95xx_A0
(
rvu
Ë|| 
	`is_rvu_96xx_A0
(rvu)) {

1006 
	`u¶ìp_ønge
(50, 60);

1007 
	`Ÿx2smqvf_xmô
();

1009 
	}
}

1011 
	$rvu_tim_hw_fixes
(
rvu
 *rvu, 
blkaddr
)

1013 
u64
 
cfg
;

1017 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
TIM_AF_FLAGS_REG
);

1018 
cfg
 |
	`BIT_ULL
(1);

1019 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
TIM_AF_FLAGS_REG
, 
cfg
);

1020 
	}
}

1029 
	$rvu_ndc_fix_locked_ˇchñöe
(
rvu
 *rvu, 
blkaddr
)

1031 
b™k
, 
max_b™k
, 
löe
, 
max_löe
, 
îr
;

1032 
u64
 
ªg
;

1035 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NDC_AF_CAMS_RD_INTERVAL
);

1036 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NDC_AF_CAMS_RD_INTERVAL
, 
ªg
 & 
	`GENMASK_ULL
(62, 0));

1039 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
NDC_AF_CAMS_RD_INTERVAL
, 
	`GENMASK_ULL
(47, 32), 
åue
);

1040 i‡(
îr
) {

1041 
	`dev_îr
(
rvu
->
dev
, "Timed out whileÖolling for NDC CAM busy bits.\n");

1042  
îr
;

1045 
max_b™k
 = 
	`NDC_MAX_BANK
(
rvu
, 
blkaddr
);

1046 
max_löe
 = 
	`NDC_MAX_LINE_PER_BANK
(
rvu
, 
blkaddr
);

1047 
b™k
 = 0; b™k < 
max_b™k
; bank++) {

1048 
löe
 = 0;Üöê< 
max_löe
;Üine++) {

1053 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1054 
	`NDC_AF_BANKX_LINEX_METADATA
(
b™k
, 
löe
));

1055 i‡(!(
ªg
 & 
	`BIT_ULL
(63)) && (reg & BIT_ULL(60))) {

1056 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1057 
	`NDC_AF_BANKX_LINEX_METADATA
(
b™k
, 
löe
),

1058 
ªg
 & ~
	`BIT_ULL
(60));

1064 
	}
}

	@rvu_fixes.h

8 #i‚de‡
RVU_FIXES_H


9 
	#RVU_FIXES_H


	)

11 
	#RVU_SMQVF_PCIFUNC
 17

	)

13 
	grvu
;

15 
Ÿx2smqvf_xmô
();

16 
rvu_smqvf_xmô
(
rvu
 *rvu);

	@rvu_nix.c

8 
	~<löux/moduÀ.h
>

9 
	~<löux/pci.h
>

11 
	~"rvu_°ru˘.h
"

12 
	~"rvu_ªg.h
"

13 
	~"rvu.h
"

14 
	~"≈c.h
"

15 
	~"cgx.h
"

16 
	~"lmac_comm⁄.h
"

17 
	~"rvu_fixes.h
"

18 
	~"rvu_≈c_hash.h
"

20 
nix_‰ì_tx_vèg_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
);

21 
rvu_nix_gë_bpid
(
rvu
 *rvu, 
nix_bp_cfg_ªq
 *
ªq
,

22 
ty≥
, 
ch™_id
);

23 
nix_£tup_ùﬁi˚rs
(
rvu
 *rvu,

24 
nix_hw
 *nix_hw, 
blkaddr
);

25 
nix_ùﬁi˚r_‰ìmem
(
rvu
 *rvu, 
nix_hw
 *nix_hw);

26 
nix_vîify_b™d¥of
(
nix_˙10k_aq_íq_ªq
 *
ªq
,

27 
nix_hw
 *nix_hw, 
u16
 
pcifunc
);

28 
nix_‰ì_Æl_b™d¥of
(
rvu
 *rvu, 
u16
 
pcifunc
);

29 
nix_˛ór_øãlimô_aggr
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

30 
u32
 
Àaf_¥of
);

31 
nix_upd©e_m˚_ruÀ
(
rvu
 *rvu, 
u16
 
pcifunc
,

32 
ty≥
, 
boﬁ
 
add
);

33 c⁄° *
nix_gë_˘x_«me
(
˘y≥
);

35 
	emc_tbl_sz
 {

36 
	mMC_TBL_SZ_256
,

37 
	mMC_TBL_SZ_512
,

38 
	mMC_TBL_SZ_1K
,

39 
	mMC_TBL_SZ_2K
,

40 
	mMC_TBL_SZ_4K
,

41 
	mMC_TBL_SZ_8K
,

42 
	mMC_TBL_SZ_16K
,

43 
	mMC_TBL_SZ_32K
,

44 
	mMC_TBL_SZ_64K
,

47 
	emc_buf_˙t
 {

48 
	mMC_BUF_CNT_8
,

49 
	mMC_BUF_CNT_16
,

50 
	mMC_BUF_CNT_32
,

51 
	mMC_BUF_CNT_64
,

52 
	mMC_BUF_CNT_128
,

53 
	mMC_BUF_CNT_256
,

54 
	mMC_BUF_CNT_512
,

55 
	mMC_BUF_CNT_1024
,

56 
	mMC_BUF_CNT_2048
,

59 
	enix_makr_fmt_ödexes
 {

60 
	mNIX_MARK_CFG_IP_DSCP_RED
,

61 
	mNIX_MARK_CFG_IP_DSCP_YELLOW
,

62 
	mNIX_MARK_CFG_IP_DSCP_YELLOW_RED
,

63 
	mNIX_MARK_CFG_IP_ECN_RED
,

64 
	mNIX_MARK_CFG_IP_ECN_YELLOW
,

65 
	mNIX_MARK_CFG_IP_ECN_YELLOW_RED
,

66 
	mNIX_MARK_CFG_VLAN_DEI_RED
,

67 
	mNIX_MARK_CFG_VLAN_DEI_YELLOW
,

68 
	mNIX_MARK_CFG_VLAN_DEI_YELLOW_RED
,

69 
	mNIX_MARK_CFG_MAX
,

75 
	#MC_TBL_SIZE
 
MC_TBL_SZ_512


	)

76 
	#MC_BUF_CNT
 
MC_BUF_CNT_128


	)

78 
	sm˚
 {

79 
hli°_node
 
	mnode
;

80 
u16
 
	mpcifunc
;

83 
	$rvu_gë_√xt_nix_blkaddr
(
rvu
 *rvu, 
blkaddr
)

85 
i
 = 0;

88 i‡(
blkaddr
 == 0)

89  
rvu
->
nix_blkaddr
[
blkaddr
];

91 
i
 + 1 < 
MAX_NIX_BLKS
) {

92 i‡(
rvu
->
nix_blkaddr
[
i
] =
blkaddr
)

93  
rvu
->
nix_blkaddr
[
i
 + 1];

94 
i
++;

98 
	}
}

100 
boﬁ
 
	$is_nixlf_©èched
(
rvu
 *rvu, 
u16
 
pcifunc
)

102 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

103 
blkaddr
;

105 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

106 i‡(!
pfvf
->
nixlf
 || 
blkaddr
 < 0)

107  
Ál£
;

108  
åue
;

109 
	}
}

111 
	$rvu_gë_nixlf_cou¡
(
rvu
 *rvu)

113 
blkaddr
 = 0, 
max
 = 0;

114 
rvu_block
 *
block
;

116 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

117 
blkaddr
) {

118 
block
 = &
rvu
->
hw
->block[
blkaddr
];

119 
max
 +
block
->
lf
.max;

120 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

122  
max
;

123 
	}
}

125 
	$nix_gë_nixlf
(
rvu
 *rvu, 
u16
 
pcifunc
, *
nixlf
, *
nix_blkaddr
)

127 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

128 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

129 
blkaddr
;

131 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

132 i‡(!
pfvf
->
nixlf
 || 
blkaddr
 < 0)

133  
NIX_AF_ERR_AF_LF_INVALID
;

135 *
nixlf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

136 i‡(*
nixlf
 < 0)

137  
NIX_AF_ERR_AF_LF_INVALID
;

139 i‡(
nix_blkaddr
)

140 *
nix_blkaddr
 = 
blkaddr
;

143 
	}
}

145 
	$nix_gë_°ru˘_±rs
(
rvu
 *rvu, 
u16
 
pcifunc
,

146 
nix_hw
 **nix_hw, *
blkaddr
)

148 
rvu_pfvf
 *
pfvf
;

150 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

151 *
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

152 i‡(!
pfvf
->
nixlf
 || *
blkaddr
 < 0)

153  
NIX_AF_ERR_AF_LF_INVALID
;

155 *
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, *
blkaddr
);

156 i‡(!*
nix_hw
)

157  
NIX_AF_ERR_INVALID_NIXBLK
;

159 
	}
}

161 
	$nix_m˚_li°_öô
(
nix_m˚_li°
 *
li°
, 
max
)

163 
	`INIT_HLIST_HEAD
(&
li°
->
hód
);

164 
li°
->
cou¡
 = 0;

165 
li°
->
max
 = max;

166 
	}
}

168 
u16
 
	$nix_Æloc_m˚_li°
(
nix_mˇ°
 *
mˇ°
, 
cou¡
)

170 
idx
;

172 i‡(!
mˇ°
)

175 
idx
 = 
mˇ°
->
√xt_‰ì_m˚
;

176 
mˇ°
->
√xt_‰ì_m˚
 +
cou¡
;

177  
idx
;

178 
	}
}

180 
nix_hw
 *
	$gë_nix_hw
(
rvu_hwöfo
 *
hw
, 
blkaddr
)

182 
nix_blkaddr
 = 0, 
i
 = 0;

183 
rvu
 *rvu = 
hw
->rvu;

185 
nix_blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
,Çix_blkaddr);

186 
nix_blkaddr
) {

187 i‡(
blkaddr
 =
nix_blkaddr
 && 
hw
->
nix
)

188  &
hw
->
nix
[
i
];

189 
nix_blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
,Çix_blkaddr);

190 
i
++;

192  
NULL
;

193 
	}
}

195 
	$nix_gë_dwº_mtu_ªg
(
rvu_hwöfo
 *
hw
, 
smq_lök_ty≥
)

197 i‡(
hw
->
ˇp
.
nix_mu…ùÀ_dwº_mtu
)

198  
	`NIX_AF_DWRR_MTUX
(
smq_lök_ty≥
);

200 i‡(
smq_lök_ty≥
 =
SMQ_LINK_TYPE_SDP
)

201  
NIX_AF_DWRR_SDP_MTU
;

204  
NIX_AF_DWRR_RPM_MTU
;

205 
	}
}

207 
u32
 
	$c⁄vît_dwº_mtu_to_byãs
(
u8
 
dwº_mtu
)

209 
dwº_mtu
 &= 0x1FULL;

215 
dwº_mtu
) {

221  
	`BIT_ULL
(
dwº_mtu
);

225 
	}
}

227 
u32
 
	$c⁄vît_byãs_to_dwº_mtu
(
u32
 
byãs
)

233 i‡(
byãs
 > 
	`BIT_ULL
(16))

236 
byãs
) {

242  
	`ûog2
(
byãs
);

246 
	}
}

248 
	$nix_rx_sync
(
rvu
 *rvu, 
blkaddr
)

250 
îr
;

253 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_SW_SYNC
, 
	`BIT_ULL
(0));

254 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
NIX_AF_RX_SW_SYNC
, 
	`BIT_ULL
(0), 
åue
);

255 i‡(
îr
)

256 
	`dev_îr
(
rvu
->
dev
, "SYNC1: NIX RX software sync failed\n");

264 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_SW_SYNC
, 
	`BIT_ULL
(0));

265 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
NIX_AF_RX_SW_SYNC
, 
	`BIT_ULL
(0), 
åue
);

266 i‡(
îr
)

267 
	`dev_îr
(
rvu
->
dev
, "SYNC2: NIX RX software sync failed\n");

272 i‡(
	`is_rvu_96xx_A0
(
rvu
))

273 
	`u¶ìp_ønge
(50, 60);

274 
	}
}

276 
boﬁ
 
	$is_vÆid_txschq
(
rvu
 *rvu, 
blkaddr
,

277 
lvl
, 
u16
 
pcifunc
, u16 
schq
)

279 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

280 
nix_txsch
 *
txsch
;

281 
nix_hw
 *nix_hw;

282 
u16
 
m≠_func
;

284 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

285 i‡(!
nix_hw
)

286  
Ál£
;

288 
txsch
 = &
nix_hw
->txsch[
lvl
];

290 i‡(
schq
 >
txsch
->schq.
max
)

291  
Ál£
;

293 
	`muãx_lock
(&
rvu
->
r§c_lock
);

294 
m≠_func
 = 
	`TXSCH_MAP_FUNC
(
txsch
->
pfvf_m≠
[
schq
]);

295 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

298 i‡(
lvl
 >
hw
->
ˇp
.
nix_tx_aggr_lvl
) {

299 i‡(
	`rvu_gë_pf
(
m≠_func
Ë!rvu_gë_pf(
pcifunc
))

300  
Ál£
;

302  
åue
;

305 i‡(
m≠_func
 !
pcifunc
)

306  
Ál£
;

308  
åue
;

309 
	}
}

311 
	$nix_öãrÁ˚_öô
(
rvu
 *rvu, 
u16
 
pcifunc
, 
ty≥
, 
nixlf
,

312 
nix_lf_Æloc_r•
 *
r•
, 
boﬁ
 
lo›
)

314 
rvu_pfvf
 *
∑ª¡_pf
, *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

315 
u16
 
ªq_ch™_ba£
, 
ªq_ch™_íd
, 
ªq_ch™_˙t
;

316 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

317 
sdp_node_öfo
 *
sdp_öfo
;

318 
pköd
, 
pf
, 
vf
, 
lbkid
, 
vfid
;

319 
u8
 
cgx_id
, 
lmac_id
;

320 
boﬁ
 
‰om_vf
;

321 
îr
;

323 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

324 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
Ë&& 
ty≥
 !
NIX_INTF_TYPE_LBK
 &&

325 
ty≥
 !
NIX_INTF_TYPE_SDP
)

328 
ty≥
) {

329 
NIX_INTF_TYPE_CGX
:

330 
	`¥_îr
("\n #################### \n");

332 
	`¥_îr
("pcifunc=0x%xÖf=0x%xÅype=%dÇixlf=%dÜoop=%d\n",

333 
pcifunc
, 
pf
, 
ty≥
, 
nixlf
, 
lo›
);

335 
pfvf
->
cgx_lmac
 = 
rvu
->
pf2cgxlmac_m≠
[
pf
];

337 
	`rvu_gë_cgx_lmac_id
(
pfvf
->
cgx_lmac
, &
cgx_id
, &
lmac_id
);

339 
pköd
 = 
	`rvu_≈c_gë_pköd
(
rvu
, 
pf
);

340 i‡(
pköd
 < 0) {

341 
	`dev_îr
(
rvu
->
dev
,

342 "PF_Fun¯0x%x: InvÆidÖköd\n", 
pcifunc
);

343  -
EINVAL
;

346 
	`¥_îr
("pfvf->cgx_lmac=%d cgx_id=%dÜmac=%dÖkind=%d\n",

347 
pfvf
->
cgx_lmac
, 
cgx_id
, 
lmac_id
, 
pköd
);

353 
	`¥_îr
("rvu->hw->cgx_chan_base=0x%xÑvu->hw->lmac_per_cgx=%d\n",

354 
rvu
->
hw
->
cgx_ch™_ba£
,Ñvu->hw->
lmac_≥r_cgx
);

356 
pfvf
->
rx_ch™_ba£
 = 
	`rvu_nix_ch™_cgx
(
rvu
, 
cgx_id
, 
lmac_id
, 0);

357 
pfvf
->
tx_ch™_ba£
 =Öfvf->
rx_ch™_ba£
;

358 
pfvf
->
rx_ch™_˙t
 = 1;

359 
pfvf
->
tx_ch™_˙t
 = 1;

360 
r•
->
tx_lök
 = 
cgx_id
 * 
hw
->
lmac_≥r_cgx
 + 
lmac_id
;

361 
	`¥_îr
("Öfvf->rx_ch™_ba£=0x%xÑ•->tx_lök=%d\n", 
pfvf
->
rx_ch™_ba£
, 
r•
->
tx_lök
);

363 i‡(
	`rvu_cgx_is_pköd_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
)) {

364 
	`cgx_£t_pköd
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
), 
lmac_id
,

365 
pköd
);

366 
	`rvu_≈c_£t_pköd
(
rvu
, 
pköd
, 
pfvf
);

370 
NIX_INTF_TYPE_LBK
:

371 
vf
 = (
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) - 1;

379 
lbkid
 = 0;

380 i‡(
rvu
->
hw
->
lbk_löks
 > 1)

381 
lbkid
 = 
vf
 & 0x1 ? 0 : 1;

399 i‡(
lo›
)

400 
lbkid
 = !lbkid;

406 
pfvf
->
rx_ch™_ba£
 = 
	`rvu_nix_ch™_lbk
(
rvu
, 
lbkid
, 
vf
);

407 
pfvf
->
tx_ch™_ba£
 = 
vf
 & 0x1 ?

408 
	`rvu_nix_ch™_lbk
(
rvu
, 
lbkid
, 
vf
 - 1) :

409 
	`rvu_nix_ch™_lbk
(
rvu
, 
lbkid
, 
vf
 + 1);

410 
pfvf
->
rx_ch™_˙t
 = 1;

411 
pfvf
->
tx_ch™_˙t
 = 1;

412 
r•
->
tx_lök
 = 
hw
->
cgx_löks
 + 
lbkid
;

413 
pfvf
->
lbkid
 =Übkid;

414 
	`rvu_≈c_£t_pköd
(
rvu
, 
NPC_RX_LBK_PKIND
, 
pfvf
);

415 
	`rvu_≈c_ö°Æl_¥omisc_íåy
(
rvu
, 
pcifunc
, 
nixlf
,

416 
pfvf
->
rx_ch™_ba£
,

417 
pfvf
->
rx_ch™_˙t
);

420 
NIX_INTF_TYPE_SDP
:

421 
‰om_vf
 = !!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
);

422 
∑ª¡_pf
 = &
rvu
->
pf
[
	`rvu_gë_pf
(
pcifunc
)];

423 
sdp_öfo
 = 
∑ª¡_pf
->sdp_info;

424 i‡(!
sdp_öfo
) {

425 
	`dev_îr
(
rvu
->
dev
, "Invalid sdp_infoÖointer\n");

426  -
EINVAL
;

428 i‡(
‰om_vf
) {

429 
ªq_ch™_ba£
 = 
	`rvu_nix_ch™_sdp
(
rvu
, 0Ë+ 
sdp_öfo
->
pf_§n
 +

430 
sdp_öfo
->
num_pf_rögs
;

431 
vf
 = (
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) - 1;

432 
vfid
 = 0; vfid < 
vf
; vfid++)

433 
ªq_ch™_ba£
 +
sdp_öfo
->
vf_rögs
[
vfid
];

434 
ªq_ch™_˙t
 = 
sdp_öfo
->
vf_rögs
[
vf
];

435 
ªq_ch™_íd
 = 
ªq_ch™_ba£
 + 
ªq_ch™_˙t
 - 1;

436 i‡(
ªq_ch™_ba£
 < 
	`rvu_nix_ch™_sdp
(
rvu
, 0) ||

437 
ªq_ch™_íd
 > 
	`rvu_nix_ch™_sdp
(
rvu
, 255)) {

438 
	`dev_îr
(
rvu
->
dev
,

440 
pcifunc
);

441  -
EINVAL
;

444 
ªq_ch™_ba£
 = 
	`rvu_nix_ch™_sdp
(
rvu
, 0Ë+ 
sdp_öfo
->
pf_§n
;

445 
ªq_ch™_˙t
 = 
sdp_öfo
->
num_pf_rögs
;

448 
pfvf
->
rx_ch™_ba£
 = 
ªq_ch™_ba£
;

449 
pfvf
->
rx_ch™_˙t
 = 
ªq_ch™_˙t
;

450 
pfvf
->
tx_ch™_ba£
 =Öfvf->
rx_ch™_ba£
;

451 
pfvf
->
tx_ch™_˙t
 =Öfvf->
rx_ch™_˙t
;

453 
r•
->
tx_lök
 = 
hw
->
cgx_löks
 + hw->
lbk_löks
;

454 
	`rvu_≈c_ö°Æl_¥omisc_íåy
(
rvu
, 
pcifunc
, 
nixlf
,

455 
pfvf
->
rx_ch™_ba£
,

456 
pfvf
->
rx_ch™_˙t
);

463 
	`rvu_≈c_ö°Æl_uˇ°_íåy
(
rvu
, 
pcifunc
, 
nixlf
,

464 
pfvf
->
rx_ch™_ba£
,Öfvf->
mac_addr
);

467 
îr
 = 
	`nix_upd©e_m˚_ruÀ
(
rvu
, 
pcifunc
, 
NIXLF_BCAST_ENTRY
, 
åue
);

468 i‡(
îr
) {

469 
	`dev_îr
(
rvu
->
dev
,

471 
pcifunc
);

472  
îr
;

475 
	`rvu_≈c_ö°Æl_bˇ°_m©ch_íåy
(
rvu
, 
pcifunc
,

476 
nixlf
, 
pfvf
->
rx_ch™_ba£
);

478 
pfvf
->
maxÀn
 = 
NIC_HW_MIN_FRS
;

479 
pfvf
->
möÀn
 = 
NIC_HW_MIN_FRS
;

482 
	}
}

484 
	$nix_öãrÁ˚_deöô
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u8
 
nixlf
)

486 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

487 
îr
;

489 
pfvf
->
maxÀn
 = 0;

490 
pfvf
->
möÀn
 = 0;

493 
îr
 = 
	`nix_upd©e_m˚_ruÀ
(
rvu
, 
pcifunc
, 
NIXLF_BCAST_ENTRY
, 
Ál£
);

494 i‡(
îr
) {

495 
	`dev_îr
(
rvu
->
dev
,

497 
pcifunc
);

501 
	`rvu_cgx_dißbÀ_dmac_íåõs
(
rvu
, 
pcifunc
);

502 
	}
}

504 
	$nix_bp_dißbÀ
(
rvu
 *rvu,

505 
nix_bp_cfg_ªq
 *
ªq
,

506 
msg_r•
 *
r•
, 
boﬁ
 
˝t_lök
)

508 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

509 
rvu_pfvf
 *
pfvf
;

510 
blkaddr
, 
pf
, 
ty≥
;

511 
u16
 
ch™_ba£
, 
ch™
;

512 
u16
 
ch™_v
;

513 
u64
 
cfg
;

515 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

516 
ty≥
 = 
	`is_afvf
(
pcifunc
Ë? 
NIX_INTF_TYPE_LBK
 : 
NIX_INTF_TYPE_CGX
;

517 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
Ë&& 
ty≥
 !
NIX_INTF_TYPE_LBK
)

520 i‡(
˝t_lök
 && !
rvu
->
hw
->
˝t_löks
)

523 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

524 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

526 
ch™_ba£
 = 
pfvf
->
rx_ch™_ba£
 + 
ªq
->chan_base;

527 
ch™
 = 
ch™_ba£
; ch™ < (ch™_ba£ + 
ªq
->
ch™_˙t
); chan++) {

531 i‡(
˝t_lök
)

532 
ch™_v
 = 
ch™
 | 
	`BIT
(11);

534 
ch™_v
 = 
ch™
;

536 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_CHANX_CFG
(
ch™_v
));

537 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_CHANX_CFG
(
ch™_v
),

538 
cfg
 & ~
	`BIT_ULL
(16));

541 
	}
}

543 
	$rvu_mbox_h™dÀr_nix_bp_dißbÀ
(
rvu
 *rvu,

544 
nix_bp_cfg_ªq
 *
ªq
,

545 
msg_r•
 *
r•
)

547  
	`nix_bp_dißbÀ
(
rvu
, 
ªq
, 
r•
, 
Ál£
);

548 
	}
}

550 
	$rvu_mbox_h™dÀr_nix_˝t_bp_dißbÀ
(
rvu
 *rvu,

551 
nix_bp_cfg_ªq
 *
ªq
,

552 
msg_r•
 *
r•
)

554  
	`nix_bp_dißbÀ
(
rvu
, 
ªq
, 
r•
, 
åue
);

555 
	}
}

557 
	$rvu_nix_gë_bpid
(
rvu
 *rvu, 
nix_bp_cfg_ªq
 *
ªq
,

558 
ty≥
, 
ch™_id
)

560 
bpid
, 
blkaddr
, 
lmac_ch™_˙t
, 
sdp_ch™_˙t
, 
vf
, 
sdp_ch™_ba£
;

561 
u16
 
cgx_bpid_˙t
, 
lbk_bpid_˙t
, 
sdp_bpid_˙t
;

562 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

563 
rvu_pfvf
 *
pfvf
;

564 
u8
 
cgx_id
, 
lmac_id
;

565 
u64
 
cfg
;

567 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
ªq
->
hdr
.
pcifunc
);

568 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST
);

569 
lmac_ch™_˙t
 = 
cfg
 & 0xFF;

571 
cgx_bpid_˙t
 = 
hw
->
cgx_löks
 * 
lmac_ch™_˙t
;

572 
lbk_bpid_˙t
 = 
hw
->
lbk_löks
 * ((
cfg
 >> 16) & 0xFF);

574 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST1
);

575 
sdp_ch™_˙t
 = 
cfg
 & 0xFFF;

576 
sdp_bpid_˙t
 = 
hw
->
sdp_löks
 * 
sdp_ch™_˙t
;

578 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

590 
ty≥
) {

591 
NIX_INTF_TYPE_CGX
:

592 i‡((
ªq
->
ch™_ba£
 +Ñeq->
ch™_˙t
) > 16)

593  -
EINVAL
;

594 
	`rvu_gë_cgx_lmac_id
(
pfvf
->
cgx_lmac
, &
cgx_id
, &
lmac_id
);

596 
bpid
 = (
cgx_id
 * 
hw
->
lmac_≥r_cgx
 * 
lmac_ch™_˙t
) +

597 (
lmac_id
 * 
lmac_ch™_˙t
Ë+ 
ªq
->
ch™_ba£
;

599 i‡(
ªq
->
bpid_≥r_ch™
)

600 
bpid
 +
ch™_id
;

601 i‡(
bpid
 > 
cgx_bpid_˙t
)

602  -
EINVAL
;

605 
NIX_INTF_TYPE_LBK
:

606 i‡((
ªq
->
ch™_ba£
 +Ñeq->
ch™_˙t
) > 1)

607  -
EINVAL
;

611 
vf
 = (
ªq
->
hdr
.
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) - 1;

613 
bpid
 = 
cgx_bpid_˙t
 + 
ªq
->
ch™_ba£
 + 
vf
;

614 i‡(
ªq
->
bpid_≥r_ch™
)

615 
bpid
 +
ch™_id
;

616 i‡(
bpid
 > (
cgx_bpid_˙t
 + 
lbk_bpid_˙t
))

617  -
EINVAL
;

619 
NIX_INTF_TYPE_SDP
:

620 i‡((
ªq
->
ch™_ba£
 +Ñeq->
ch™_˙t
Ë> 
sdp_ch™_˙t
)

621  -
EINVAL
;

624 i‡(!
hw
->
ˇp
.
¥ogømmabÀ_ch™s
)

625 
sdp_ch™_ba£
 = 
pfvf
->
rx_ch™_ba£
 - 
NIX_CHAN_SDP_CH_START
;

627 
sdp_ch™_ba£
 = 
pfvf
->
rx_ch™_ba£
 - 
hw
->sdp_chan_base;

632 
vf
 = (
ªq
->
hdr
.
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) - 1;

634 
bpid
 = 
sdp_bpid_˙t
 + 
ªq
->
ch™_ba£
 + 
sdp_ch™_ba£
 + 
vf
;

636 i‡(
ªq
->
bpid_≥r_ch™
)

637 
bpid
 +
ch™_id
;

639 i‡(
bpid
 > (
cgx_bpid_˙t
 + 
lbk_bpid_˙t
 + 
sdp_bpid_˙t
))

640  -
EINVAL
;

643  -
EINVAL
;

645  
bpid
;

646 
	}
}

648 
	$nix_bp_íabÀ
(
rvu
 *rvu,

649 
nix_bp_cfg_ªq
 *
ªq
,

650 
nix_bp_cfg_r•
 *
r•
,

651 
boﬁ
 
˝t_lök
)

653 
blkaddr
, 
pf
, 
ty≥
, 
ch™_id
 = 0;

654 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

655 
rvu_pfvf
 *
pfvf
;

656 
u16
 
ch™_ba£
, 
ch™
;

657 
s16
 
bpid
, 
bpid_ba£
;

658 
u16
 
ch™_v
;

659 
u64
 
cfg
;

661 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

662 
ty≥
 = 
	`is_afvf
(
pcifunc
Ë? 
NIX_INTF_TYPE_LBK
 : 
NIX_INTF_TYPE_CGX
;

663 i‡(
	`is_sdp_pfvf
(
pcifunc
))

664 
ty≥
 = 
NIX_INTF_TYPE_SDP
;

667 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
Ë&& 
ty≥
 !
NIX_INTF_TYPE_LBK
 &&

668 
ty≥
 !
NIX_INTF_TYPE_SDP
)

671 i‡(
˝t_lök
 && !
rvu
->
hw
->
˝t_löks
)

674 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

675 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

677 
bpid_ba£
 = 
	`rvu_nix_gë_bpid
(
rvu
, 
ªq
, 
ty≥
, 
ch™_id
);

678 
ch™_ba£
 = 
pfvf
->
rx_ch™_ba£
 + 
ªq
->chan_base;

679 
bpid
 = 
bpid_ba£
;

681 
ch™
 = 
ch™_ba£
; ch™ < (ch™_ba£ + 
ªq
->
ch™_˙t
); chan++) {

682 i‡(
bpid
 < 0) {

683 
	`dev_w¨n
(
rvu
->
dev
, "FailÅoÉnable backpressure\n");

684  -
EINVAL
;

691 i‡(
˝t_lök
)

692 
ch™_v
 = 
ch™
 | 
	`BIT
(11);

694 
ch™_v
 = 
ch™
;

696 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_CHANX_CFG
(
ch™_v
));

697 
cfg
 &~
	`GENMASK_ULL
(8, 0);

698 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_CHANX_CFG
(
ch™_v
),

699 
cfg
 | (
bpid
 & 
	`GENMASK_ULL
(8, 0)Ë| 
	`BIT_ULL
(16));

700 
ch™_id
++;

701 
bpid
 = 
	`rvu_nix_gë_bpid
(
rvu
, 
ªq
, 
ty≥
, 
ch™_id
);

704 
ch™
 = 0; ch™ < 
ªq
->
ch™_˙t
; chan++) {

706 
r•
->
ch™_bpid
[
ch™
] = ((
ªq
->
ch™_ba£
 + chan) & 0x7F) << 10 |

707 (
bpid_ba£
 & 0x3FF);

708 i‡(
ªq
->
bpid_≥r_ch™
)

709 
bpid_ba£
++;

711 
r•
->
ch™_˙t
 = 
ªq
->chan_cnt;

714 
	}
}

716 
	$rvu_mbox_h™dÀr_nix_bp_íabÀ
(
rvu
 *rvu,

717 
nix_bp_cfg_ªq
 *
ªq
,

718 
nix_bp_cfg_r•
 *
r•
)

720  
	`nix_bp_íabÀ
(
rvu
, 
ªq
, 
r•
, 
Ál£
);

721 
	}
}

723 
	$rvu_mbox_h™dÀr_nix_˝t_bp_íabÀ
(
rvu
 *rvu,

724 
nix_bp_cfg_ªq
 *
ªq
,

725 
nix_bp_cfg_r•
 *
r•
)

727  
	`nix_bp_íabÀ
(
rvu
, 
ªq
, 
r•
, 
åue
);

728 
	}
}

730 
	$nix_£tup_lso_tso_l3
(
rvu
 *rvu, 
blkaddr
,

731 
u64
 
f‹m©
, 
boﬁ
 
v4
, u64 *
fidx
)

733 
nix_lso_f‹m©
 
fõld
 = {0};

736 
fõld
.
œyî
 = 
NIX_TXLAYER_OL3
;

738 
fõld
.
off£t
 = 
v4
 ? 2 : 4;

739 
fõld
.
sizem1
 = 1;

740 
fõld
.
Æg
 = 
NIX_LSOALG_ADD_PAYLEN
;

741 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

742 
	`NIX_AF_LSO_FORMATX_FIELDX
(
f‹m©
, (*
fidx
)++),

743 *(
u64
 *)&
fõld
);

746 i‡(!
v4
)

750 
fõld
.
œyî
 = 
NIX_TXLAYER_OL3
;

751 
fõld
.
off£t
 = 4;

752 
fõld
.
sizem1
 = 1;

753 
fõld
.
Æg
 = 
NIX_LSOALG_ADD_SEGNUM
;

754 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

755 
	`NIX_AF_LSO_FORMATX_FIELDX
(
f‹m©
, (*
fidx
)++),

756 *(
u64
 *)&
fõld
);

757 
	}
}

759 
	$nix_£tup_lso_tso_l4
(
rvu
 *rvu, 
blkaddr
,

760 
u64
 
f‹m©
, u64 *
fidx
)

762 
nix_lso_f‹m©
 
fõld
 = {0};

765 
fõld
.
œyî
 = 
NIX_TXLAYER_OL4
;

766 
fõld
.
off£t
 = 4;

767 
fõld
.
sizem1
 = 3;

768 
fõld
.
Æg
 = 
NIX_LSOALG_ADD_OFFSET
;

769 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

770 
	`NIX_AF_LSO_FORMATX_FIELDX
(
f‹m©
, (*
fidx
)++),

771 *(
u64
 *)&
fõld
);

774 
fõld
.
œyî
 = 
NIX_TXLAYER_OL4
;

775 
fõld
.
off£t
 = 12;

776 
fõld
.
sizem1
 = 1;

777 
fõld
.
Æg
 = 
NIX_LSOALG_TCP_FLAGS
;

778 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

779 
	`NIX_AF_LSO_FORMATX_FIELDX
(
f‹m©
, (*
fidx
)++),

780 *(
u64
 *)&
fõld
);

781 
	}
}

783 
	$nix_£tup_lso
(
rvu
 *rvu, 
nix_hw
 *nix_hw, 
blkaddr
)

785 
u64
 
cfg
, 
idx
, 
fidx
 = 0;

788 
cfg
 = (
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST1
) >> 48) & 0xFF;

789 
nix_hw
->
lso
.
tŸÆ
 = 
cfg
;

792 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_LSO_CFG
);

796 
cfg
 &= ~((0xFFFFULL << 32) | (0xFFFFULL << 16));

797 
cfg
 |= (0xFFF2ULL << 32) | (0xFFF2ULL << 16);

798 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_LSO_CFG
, 
cfg
 | 
	`BIT_ULL
(63));

804 
idx
 = 
NIX_LSO_FORMAT_IDX_TSOV4
;

805 
	`nix_£tup_lso_tso_l3
(
rvu
, 
blkaddr
, 
idx
, 
åue
, &
fidx
);

806 
	`nix_£tup_lso_tso_l4
(
rvu
, 
blkaddr
, 
idx
, &
fidx
);

809 ; 
fidx
 < 8; fidx++) {

810 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

811 
	`NIX_AF_LSO_FORMATX_FIELDX
(
idx
, 
fidx
), 0x0ULL);

813 
nix_hw
->
lso
.
ö_u£
++;

816 
idx
 = 
NIX_LSO_FORMAT_IDX_TSOV6
;

817 
fidx
 = 0;

818 
	`nix_£tup_lso_tso_l3
(
rvu
, 
blkaddr
, 
idx
, 
Ál£
, &
fidx
);

819 
	`nix_£tup_lso_tso_l4
(
rvu
, 
blkaddr
, 
idx
, &
fidx
);

822 ; 
fidx
 < 8; fidx++) {

823 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

824 
	`NIX_AF_LSO_FORMATX_FIELDX
(
idx
, 
fidx
), 0x0ULL);

826 
nix_hw
->
lso
.
ö_u£
++;

827 
	}
}

829 
	$nix_˘x_‰ì
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
)

831 
	`k‰ì
(
pfvf
->
rq_bm≠
);

832 
	`k‰ì
(
pfvf
->
sq_bm≠
);

833 
	`k‰ì
(
pfvf
->
cq_bm≠
);

834 i‡(
pfvf
->
rq_˘x
)

835 
	`qmem_‰ì
(
rvu
->
dev
, 
pfvf
->
rq_˘x
);

836 i‡(
pfvf
->
sq_˘x
)

837 
	`qmem_‰ì
(
rvu
->
dev
, 
pfvf
->
sq_˘x
);

838 i‡(
pfvf
->
cq_˘x
)

839 
	`qmem_‰ì
(
rvu
->
dev
, 
pfvf
->
cq_˘x
);

840 i‡(
pfvf
->
rss_˘x
)

841 
	`qmem_‰ì
(
rvu
->
dev
, 
pfvf
->
rss_˘x
);

842 i‡(
pfvf
->
nix_qöts_˘x
)

843 
	`qmem_‰ì
(
rvu
->
dev
, 
pfvf
->
nix_qöts_˘x
);

844 i‡(
pfvf
->
cq_öts_˘x
)

845 
	`qmem_‰ì
(
rvu
->
dev
, 
pfvf
->
cq_öts_˘x
);

847 
pfvf
->
rq_bm≠
 = 
NULL
;

848 
pfvf
->
cq_bm≠
 = 
NULL
;

849 
pfvf
->
sq_bm≠
 = 
NULL
;

850 
pfvf
->
rq_˘x
 = 
NULL
;

851 
pfvf
->
sq_˘x
 = 
NULL
;

852 
pfvf
->
cq_˘x
 = 
NULL
;

853 
pfvf
->
rss_˘x
 = 
NULL
;

854 
pfvf
->
nix_qöts_˘x
 = 
NULL
;

855 
pfvf
->
cq_öts_˘x
 = 
NULL
;

856 
	}
}

858 
	$nixlf_rss_˘x_öô
(
rvu
 *rvu, 
blkaddr
,

859 
rvu_pfvf
 *
pfvf
, 
nixlf
,

860 
rss_sz
, 
rss_gΩs
, 
hw˘x_size
,

861 
u64
 
way_mask
, 
boﬁ
 
èg_lsb_as_addî
)

863 
îr
, 
gΩ
, 
num_ödi˚s
;

864 
u64
 
vÆ
;

867 i‡(!
rss_sz
)

869 
num_ödi˚s
 = 
rss_sz
 * 
rss_gΩs
;

872 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
pfvf
->
rss_˘x
, 
num_ödi˚s
, 
hw˘x_size
);

873 i‡(
îr
)

874  
îr
;

876 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RSS_BASE
(
nixlf
),

877 (
u64
)
pfvf
->
rss_˘x
->
iova
);

880 
vÆ
 = 
	`BIT_ULL
(36Ë| BIT_ULL(4Ë| 
way_mask
 << 20 |

881 
	`ûog2
(
num_ödi˚s
 / 
MAX_RSS_INDIR_TBL_SIZE
);

883 i‡(
èg_lsb_as_addî
)

884 
vÆ
 |
	`BIT_ULL
(5);

886 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RSS_CFG
(
nixlf
), 
vÆ
);

888 
gΩ
 = 0; gΩ < 
rss_gΩs
; grp++)

889 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RSS_GRPX
(
nixlf
, 
gΩ
),

890 ((
	`ûog2
(
rss_sz
Ë- 1Ë<< 16Ë| (rss_sz * 
gΩ
));

892 
	}
}

894 
	$nix_aq_íqueue_waô
(
rvu
 *rvu, 
rvu_block
 *
block
,

895 
nix_aq_ö°_s
 *
ö°
)

897 
admö_queue
 *
aq
 = 
block
->aq;

898 
nix_aq_ªs_s
 *
ªsu…
;

899 
timeout
 = 1000;

900 
u64
 
ªg
, 
hód
;

901 
ªt
;

903 
ªsu…
 = (
nix_aq_ªs_s
 *)
aq
->
ªs
->
ba£
;

906 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
NIX_AF_AQ_STATUS
);

907 
hód
 = (
ªg
 >> 4Ë& 
AQ_PTR_MASK
;

909 
	`mem˝y
((*)(
aq
->
ö°
->
ba£
 + (
hód
 *áq->ö°->
íåy_sz
)),

910 (*)
ö°
, 
aq
->ö°->
íåy_sz
);

911 
	`mem£t
(
ªsu…
, 0, (*result));

913 
	`wmb
();

916 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NIX_AF_AQ_DOOR
, 1);

917 
ªsu…
->
compcode
 =
NIX_AQ_COMP_NOTDONE
) {

918 
	`˝u_ªœx
();

919 
	`udñay
(1);

920 
timeout
--;

921 i‡(!
timeout
)

922  -
EBUSY
;

925 i‡(
ªsu…
->
compcode
 !
NIX_AQ_COMP_GOOD
) {

927 i‡(
ªsu…
->
compcode
 =
NPA_AQ_COMP_CTX_FAULT
 ||

928 
ªsu…
->
compcode
 =
NPA_AQ_COMP_LOCKERR
 ||

929 
ªsu…
->
compcode
 =
NPA_AQ_COMP_CTX_POISON
) {

930 
ªt
 = 
	`rvu_ndc_fix_locked_ˇchñöe
(
rvu
, 
BLKADDR_NDC_NIX0_RX
);

931 
ªt
 |
	`rvu_ndc_fix_locked_ˇchñöe
(
rvu
, 
BLKADDR_NDC_NIX0_TX
);

932 
ªt
 |
	`rvu_ndc_fix_locked_ˇchñöe
(
rvu
, 
BLKADDR_NDC_NIX1_RX
);

933 
ªt
 |
	`rvu_ndc_fix_locked_ˇchñöe
(
rvu
, 
BLKADDR_NDC_NIX1_TX
);

934 i‡(
ªt
)

935 
	`dev_îr
(
rvu
->
dev
,

936 "%s: NŸábÀÅÿu∆ock cachñöes\n", 
__func__
);

939  -
EBUSY
;

943 
	}
}

945 
	$rvu_nix_blk_aq_íq_ö°
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

946 
nix_aq_íq_ªq
 *
ªq
,

947 
nix_aq_íq_r•
 *
r•
)

949 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

950 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

951 
nixlf
, 
blkaddr
, 
rc
 = 0;

952 
nix_aq_ö°_s
 
ö°
;

953 
rvu_block
 *
block
;

954 
admö_queue
 *
aq
;

955 
rvu_pfvf
 *
pfvf
;

956 *
˘x
, *
mask
;

957 
boﬁ
 
ía
;

958 
u64
 
cfg
;

960 
blkaddr
 = 
nix_hw
->blkaddr;

961 
block
 = &
hw
->block[
blkaddr
];

962 
aq
 = 
block
->aq;

963 i‡(!
aq
) {

964 
	`dev_w¨n
(
rvu
->
dev
, "%s: NIX AQÇŸ inôülized\n", 
__func__
);

965  
NIX_AF_ERR_AQ_ENQUEUE
;

968 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

969 
nixlf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 0);

974 i‡(!((!
r•
 && 
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_MCE
) ||

975 (
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_BANDPROF
 && !
pcifunc
))) {

976 i‡(!
pfvf
->
nixlf
 ||Çixlf < 0)

977  
NIX_AF_ERR_AF_LF_INVALID
;

980 
ªq
->
˘y≥
) {

981 
NIX_AQ_CTYPE_RQ
:

983 i‡(!
pfvf
->
rq_˘x
 || 
ªq
->
qidx
 >pfvf->rq_˘x->
qsize
)

984 
rc
 = 
NIX_AF_ERR_AQ_ENQUEUE
;

986 
NIX_AQ_CTYPE_SQ
:

987 i‡(!
pfvf
->
sq_˘x
 || 
ªq
->
qidx
 >pfvf->sq_˘x->
qsize
)

988 
rc
 = 
NIX_AF_ERR_AQ_ENQUEUE
;

990 
NIX_AQ_CTYPE_CQ
:

991 i‡(!
pfvf
->
cq_˘x
 || 
ªq
->
qidx
 >pfvf->cq_˘x->
qsize
)

992 
rc
 = 
NIX_AF_ERR_AQ_ENQUEUE
;

994 
NIX_AQ_CTYPE_RSS
:

996 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RSS_CFG
(
nixlf
));

997 i‡(!(
cfg
 & 
	`BIT_ULL
(4)Ë|| !
pfvf
->
rss_˘x
 ||

998 (
ªq
->
qidx
 >(256UL << (
cfg
 & 0xF))))

999 
rc
 = 
NIX_AF_ERR_AQ_ENQUEUE
;

1001 
NIX_AQ_CTYPE_MCE
:

1002 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_MCAST_CFG
);

1005 i‡(!
nix_hw
->
mˇ°
.
m˚_˘x
 ||

1006 (
ªq
->
qidx
 >(256UL << (
cfg
 & 0xF))))

1007 
rc
 = 
NIX_AF_ERR_AQ_ENQUEUE
;

1012 i‡(
r•
)

1013 
rc
 = 
NIX_AF_ERR_AQ_ENQUEUE
;

1015 
NIX_AQ_CTYPE_BANDPROF
:

1016 i‡(
	`nix_vîify_b™d¥of
((
nix_˙10k_aq_íq_ªq
 *)
ªq
,

1017 
nix_hw
, 
pcifunc
))

1018 
rc
 = 
NIX_AF_ERR_INVALID_BANDPROF
;

1021 
rc
 = 
NIX_AF_ERR_AQ_ENQUEUE
;

1024 i‡(
rc
)

1025  
rc
;

1028 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_SQ
 &&

1029 ((
ªq
->
›
 =
NIX_AQ_INSTOP_INIT
 &&Ñeq->
sq
.
ía
) ||

1030 (
ªq
->
›
 =
NIX_AQ_INSTOP_WRITE
 &&

1031 
ªq
->
sq_mask
.
ía
 &&Ñeq->sq_mask.
smq
 &&Ñeq->
sq
.ena))) {

1032 i‡(!
	`is_vÆid_txschq
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_SMQ
,

1033 
pcifunc
, 
ªq
->
sq
.
smq
))

1034  
NIX_AF_ERR_AQ_ENQUEUE
;

1035 
	`rvu_nix_upd©e_sq_smq_m≠pög
(
rvu
, 
blkaddr
, 
nixlf
, 
ªq
->
qidx
,

1036 
ªq
->
sq
.
smq
);

1039 
	`mem£t
(&
ö°
, 0, (
nix_aq_ö°_s
));

1040 
ö°
.
lf
 = 
nixlf
;

1041 
ö°
.
cödex
 = 
ªq
->
qidx
;

1042 
ö°
.
˘y≥
 = 
ªq
->ctype;

1043 
ö°
.
›
 = 
ªq
->op;

1047 
ö°
.
ªs_addr
 = (
u64
)
aq
->
ªs
->
iova
;

1052 
	`•ö_lock
(&
aq
->
lock
);

1055 
	`mem£t
(
aq
->
ªs
->
ba£
, 0,áq->ªs->
íåy_sz
);

1057 
˘x
 = 
aq
->
ªs
->
ba£
 + 128;

1059 
mask
 = 
aq
->
ªs
->
ba£
 + 256;

1061 
ªq
->
›
) {

1062 
NIX_AQ_INSTOP_WRITE
:

1063 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_RQ
)

1064 
	`mem˝y
(
mask
, &
ªq
->
rq_mask
,

1065 (
nix_rq_˘x_s
));

1066 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_SQ
)

1067 
	`mem˝y
(
mask
, &
ªq
->
sq_mask
,

1068 (
nix_sq_˘x_s
));

1069 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_CQ
)

1070 
	`mem˝y
(
mask
, &
ªq
->
cq_mask
,

1071 (
nix_cq_˘x_s
));

1072 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_RSS
)

1073 
	`mem˝y
(
mask
, &
ªq
->
rss_mask
,

1074 (
nix_rs£_s
));

1075 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_MCE
)

1076 
	`mem˝y
(
mask
, &
ªq
->
m˚_mask
,

1077 (
nix_rx_m˚_s
));

1078 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_BANDPROF
)

1079 
	`mem˝y
(
mask
, &
ªq
->
¥of_mask
,

1080 (
nix_b™d¥of_s
));

1081 
ÁŒthrough
;

1082 
NIX_AQ_INSTOP_INIT
:

1083 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_RQ
)

1084 
	`mem˝y
(
˘x
, &
ªq
->
rq
, (
nix_rq_˘x_s
));

1085 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_SQ
)

1086 
	`mem˝y
(
˘x
, &
ªq
->
sq
, (
nix_sq_˘x_s
));

1087 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_CQ
)

1088 
	`mem˝y
(
˘x
, &
ªq
->
cq
, (
nix_cq_˘x_s
));

1089 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_RSS
)

1090 
	`mem˝y
(
˘x
, &
ªq
->
rss
, (
nix_rs£_s
));

1091 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_MCE
)

1092 
	`mem˝y
(
˘x
, &
ªq
->
m˚
, (
nix_rx_m˚_s
));

1093 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_BANDPROF
)

1094 
	`mem˝y
(
˘x
, &
ªq
->
¥of
, (
nix_b™d¥of_s
));

1096 
NIX_AQ_INSTOP_NOP
:

1097 
NIX_AQ_INSTOP_READ
:

1098 
NIX_AQ_INSTOP_LOCK
:

1099 
NIX_AQ_INSTOP_UNLOCK
:

1102 
rc
 = 
NIX_AF_ERR_AQ_ENQUEUE
;

1103 
	`•ö_u∆ock
(&
aq
->
lock
);

1104  
rc
;

1108 
rc
 = 
	`nix_aq_íqueue_waô
(
rvu
, 
block
, &
ö°
);

1109 i‡(
rc
) {

1110 
	`•ö_u∆ock
(&
aq
->
lock
);

1111  
rc
;

1115 i‡(
ªq
->
›
 =
NIX_AQ_INSTOP_INIT
) {

1116 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_RQ
 &&Ñeq->
rq
.
ía
)

1117 
	`__£t_bô
(
ªq
->
qidx
, 
pfvf
->
rq_bm≠
);

1118 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_SQ
 &&Ñeq->
sq
.
ía
)

1119 
	`__£t_bô
(
ªq
->
qidx
, 
pfvf
->
sq_bm≠
);

1120 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_CQ
 &&Ñeq->
cq
.
ía
)

1121 
	`__£t_bô
(
ªq
->
qidx
, 
pfvf
->
cq_bm≠
);

1124 i‡(
ªq
->
›
 =
NIX_AQ_INSTOP_WRITE
) {

1125 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_RQ
) {

1126 
ía
 = (
ªq
->
rq
.í®&Ñeq->
rq_mask
.ena) |

1127 (
	`ã°_bô
(
ªq
->
qidx
, 
pfvf
->
rq_bm≠
) &

1128 ~
ªq
->
rq_mask
.
ía
);

1129 i‡(
ía
)

1130 
	`__£t_bô
(
ªq
->
qidx
, 
pfvf
->
rq_bm≠
);

1132 
	`__˛ór_bô
(
ªq
->
qidx
, 
pfvf
->
rq_bm≠
);

1134 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_SQ
) {

1135 
ía
 = (
ªq
->
rq
.í®&Ñeq->
sq_mask
.ena) |

1136 (
	`ã°_bô
(
ªq
->
qidx
, 
pfvf
->
sq_bm≠
) &

1137 ~
ªq
->
sq_mask
.
ía
);

1138 i‡(
ía
)

1139 
	`__£t_bô
(
ªq
->
qidx
, 
pfvf
->
sq_bm≠
);

1141 
	`__˛ór_bô
(
ªq
->
qidx
, 
pfvf
->
sq_bm≠
);

1143 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_CQ
) {

1144 
ía
 = (
ªq
->
rq
.í®&Ñeq->
cq_mask
.ena) |

1145 (
	`ã°_bô
(
ªq
->
qidx
, 
pfvf
->
cq_bm≠
) &

1146 ~
ªq
->
cq_mask
.
ía
);

1147 i‡(
ía
)

1148 
	`__£t_bô
(
ªq
->
qidx
, 
pfvf
->
cq_bm≠
);

1150 
	`__˛ór_bô
(
ªq
->
qidx
, 
pfvf
->
cq_bm≠
);

1154 i‡(
r•
) {

1156 i‡(
ªq
->
›
 =
NIX_AQ_INSTOP_READ
) {

1157 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_RQ
)

1158 
	`mem˝y
(&
r•
->
rq
, 
˘x
,

1159 (
nix_rq_˘x_s
));

1160 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_SQ
)

1161 
	`mem˝y
(&
r•
->
sq
, 
˘x
,

1162 (
nix_sq_˘x_s
));

1163 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_CQ
)

1164 
	`mem˝y
(&
r•
->
cq
, 
˘x
,

1165 (
nix_cq_˘x_s
));

1166 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_RSS
)

1167 
	`mem˝y
(&
r•
->
rss
, 
˘x
,

1168 (
nix_rs£_s
));

1169 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_MCE
)

1170 
	`mem˝y
(&
r•
->
m˚
, 
˘x
,

1171 (
nix_rx_m˚_s
));

1172 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_BANDPROF
)

1173 
	`mem˝y
(&
r•
->
¥of
, 
˘x
,

1174 (
nix_b™d¥of_s
));

1178 
	`•ö_u∆ock
(&
aq
->
lock
);

1180 
	}
}

1182 
	$rvu_nix_vîify_aq_˘x
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

1183 
nix_aq_íq_ªq
 *
ªq
, 
u8
 
˘y≥
)

1185 
nix_˙10k_aq_íq_ªq
 
aq_ªq
;

1186 
nix_˙10k_aq_íq_r•
 
aq_r•
;

1187 
rc
, 
w‹d
;

1189 i‡(
ªq
->
˘y≥
 !
NIX_AQ_CTYPE_CQ
)

1192 
rc
 = 
	`nix_aq_c⁄ãxt_ªad
(
rvu
, 
nix_hw
, &
aq_ªq
, &
aq_r•
,

1193 
ªq
->
hdr
.
pcifunc
, 
˘y≥
,Ñeq->
qidx
);

1194 i‡(
rc
) {

1195 
	`dev_îr
(
rvu
->
dev
,

1197 
__func__
, 
	`nix_gë_˘x_«me
(
˘y≥
), 
ªq
->
qidx
,

1198 
ªq
->
hdr
.
pcifunc
);

1199  
rc
;

1205 
	`mem˝y
(&
aq_ªq
.
cq_mask
, &
ªq
->cq_mask, (
nix_cq_˘x_s
));

1206 
	`mem˝y
(&
aq_ªq
.
cq
, &
ªq
->cq, (
nix_cq_˘x_s
));

1209 
aq_ªq
.
cq_mask
.
cq_îr
 = 0;

1210 
aq_ªq
.
cq_mask
.
wΩå
 = 0;

1211 
aq_ªq
.
cq_mask
.
èû
 = 0;

1212 
aq_ªq
.
cq_mask
.
hód
 = 0;

1213 
aq_ªq
.
cq_mask
.
avg_Àvñ
 = 0;

1214 
aq_ªq
.
cq_mask
.
upd©e_time
 = 0;

1215 
aq_ªq
.
cq_mask
.
sub°ªam
 = 0;

1225 
w‹d
 = 0; w‹d < (
nix_cq_˘x_s
Ë/ (
u64
);

1226 
w‹d
++) {

1227 *(
u64
 *)((
u8
 *)&
aq_r•
.
cq
 + 
w‹d
 * 8) &=

1228 (*(
u64
 *)((
u8
 *)&
aq_ªq
.
cq_mask
 + 
w‹d
 * 8));

1229 *(
u64
 *)((
u8
 *)&
aq_ªq
.
cq
 + 
w‹d
 * 8) &=

1230 (*(
u64
 *)((
u8
 *)&
aq_ªq
.
cq_mask
 + 
w‹d
 * 8));

1233 i‡(
	`memcmp
(&
aq_ªq
.
cq
, &
aq_r•
.cq, (
nix_cq_˘x_s
)))

1234  
NIX_AF_ERR_AQ_CTX_RETRY_WRITE
;

1237 
	}
}

1239 
	$rvu_nix_aq_íq_ö°
(
rvu
 *rvu, 
nix_aq_íq_ªq
 *
ªq
,

1240 
nix_aq_íq_r•
 *
r•
)

1242 
nix_hw
 *nix_hw;

1243 
îr
, 
ªåõs
 = 5;

1244 
blkaddr
;

1246 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
ªq
->
hdr
.
pcifunc
);

1247 i‡(
blkaddr
 < 0)

1248  
NIX_AF_ERR_AF_LF_INVALID
;

1250 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

1251 i‡(!
nix_hw
)

1252  
NIX_AF_ERR_INVALID_NIXBLK
;

1254 
ªåy
:

1255 
îr
 = 
	`rvu_nix_blk_aq_íq_ö°
(
rvu
, 
nix_hw
, 
ªq
, 
r•
);

1261 i‡(!
îr
 && 
ªq
->
›
 =
NIX_AQ_INSTOP_WRITE
) {

1262 
îr
 = 
	`rvu_nix_vîify_aq_˘x
(
rvu
, 
nix_hw
, 
ªq
, 
NIX_AQ_CTYPE_CQ
);

1263 i‡(
îr
 =
NIX_AF_ERR_AQ_CTX_RETRY_WRITE
) {

1264 i‡(
ªåõs
--)

1265 
ªåy
;

1267  
NIX_AF_ERR_CQ_CTX_WRITE_ERR
;

1271  
îr
;

1272 
	}
}

1274 c⁄° *
	$nix_gë_˘x_«me
(
˘y≥
)

1276 
˘y≥
) {

1277 
NIX_AQ_CTYPE_CQ
:

1279 
NIX_AQ_CTYPE_SQ
:

1281 
NIX_AQ_CTYPE_RQ
:

1283 
NIX_AQ_CTYPE_RSS
:

1287 
	}
}

1289 
	$nix_lf_hw˘x_dißbÀ
(
rvu
 *rvu, 
hw˘x_dißbÀ_ªq
 *
ªq
)

1291 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

1292 
nix_aq_íq_ªq
 
aq_ªq
;

1293 *
bm≠
;

1294 
qidx
, 
q_˙t
 = 0;

1295 
îr
 = 0, 
rc
;

1297 i‡(!
pfvf
->
cq_˘x
 || !pfvf->
sq_˘x
 || !pfvf->
rq_˘x
)

1298  
NIX_AF_ERR_AQ_ENQUEUE
;

1300 
	`mem£t
(&
aq_ªq
, 0, (
nix_aq_íq_ªq
));

1301 
aq_ªq
.
hdr
.
pcifunc
 = 
ªq
->hdr.pcifunc;

1303 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_CQ
) {

1304 
aq_ªq
.
cq
.
ía
 = 0;

1305 
aq_ªq
.
cq_mask
.
ía
 = 1;

1306 
aq_ªq
.
cq
.
bp_ía
 = 0;

1307 
aq_ªq
.
cq_mask
.
bp_ía
 = 1;

1308 
q_˙t
 = 
pfvf
->
cq_˘x
->
qsize
;

1309 
bm≠
 = 
pfvf
->
cq_bm≠
;

1311 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_SQ
) {

1312 
aq_ªq
.
sq
.
ía
 = 0;

1313 
aq_ªq
.
sq_mask
.
ía
 = 1;

1314 
q_˙t
 = 
pfvf
->
sq_˘x
->
qsize
;

1315 
bm≠
 = 
pfvf
->
sq_bm≠
;

1317 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_RQ
) {

1318 
aq_ªq
.
rq
.
ía
 = 0;

1319 
aq_ªq
.
rq_mask
.
ía
 = 1;

1320 
q_˙t
 = 
pfvf
->
rq_˘x
->
qsize
;

1321 
bm≠
 = 
pfvf
->
rq_bm≠
;

1324 
aq_ªq
.
˘y≥
 = 
ªq
->ctype;

1325 
aq_ªq
.
›
 = 
NIX_AQ_INSTOP_WRITE
;

1327 
qidx
 = 0; qidx < 
q_˙t
; qidx++) {

1328 i‡(!
	`ã°_bô
(
qidx
, 
bm≠
))

1330 
aq_ªq
.
qidx
 = qidx;

1331 
rc
 = 
	`rvu_nix_aq_íq_ö°
(
rvu
, &
aq_ªq
, 
NULL
);

1332 i‡(
rc
) {

1333 
îr
 = 
rc
;

1334 
	`dev_îr
(
rvu
->
dev
, "FailedÅo disable %s:%d context\n",

1335 
	`nix_gë_˘x_«me
(
ªq
->
˘y≥
), 
qidx
);

1339  
îr
;

1340 
	}
}

1342 #ifde‡
CONFIG_NDC_DIS_DYNAMIC_CACHING


1343 
	$nix_lf_hw˘x_lockdown
(
rvu
 *rvu, 
nix_aq_íq_ªq
 *
ªq
)

1345 
nix_aq_íq_ªq
 
lock_˘x_ªq
;

1346 
îr
;

1348 i‡(
ªq
->
›
 !
NIX_AQ_INSTOP_INIT
)

1351 i‡(
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_MCE
 ||

1352 
ªq
->
˘y≥
 =
NIX_AQ_CTYPE_DYNO
)

1355 
	`mem£t
(&
lock_˘x_ªq
, 0, (
nix_aq_íq_ªq
));

1356 
lock_˘x_ªq
.
hdr
.
pcifunc
 = 
ªq
->hdr.pcifunc;

1357 
lock_˘x_ªq
.
˘y≥
 = 
ªq
->ctype;

1358 
lock_˘x_ªq
.
›
 = 
NIX_AQ_INSTOP_LOCK
;

1359 
lock_˘x_ªq
.
qidx
 = 
ªq
->qidx;

1360 
îr
 = 
	`rvu_nix_aq_íq_ö°
(
rvu
, &
lock_˘x_ªq
, 
NULL
);

1361 i‡(
îr
)

1362 
	`dev_îr
(
rvu
->
dev
,

1364 
ªq
->
hdr
.
pcifunc
,

1365 
	`nix_gë_˘x_«me
(
ªq
->
˘y≥
),Ñeq->
qidx
);

1366  
îr
;

1367 
	}
}

1369 
	$rvu_mbox_h™dÀr_nix_aq_íq
(
rvu
 *rvu,

1370 
nix_aq_íq_ªq
 *
ªq
,

1371 
nix_aq_íq_r•
 *
r•
)

1373 
îr
;

1375 
îr
 = 
	`rvu_nix_aq_íq_ö°
(
rvu
, 
ªq
, 
r•
);

1376 i‡(!
îr
)

1377 
îr
 = 
	`nix_lf_hw˘x_lockdown
(
rvu
, 
ªq
);

1378  
îr
;

1379 
	}
}

1382 
	$rvu_mbox_h™dÀr_nix_aq_íq
(
rvu
 *rvu,

1383 
nix_aq_íq_ªq
 *
ªq
,

1384 
nix_aq_íq_r•
 *
r•
)

1386  
	`rvu_nix_aq_íq_ö°
(
rvu
, 
ªq
, 
r•
);

1387 
	}
}

1389 
EXPORT_SYMBOL
(
rvu_mbox_h™dÀr_nix_aq_íq
);

1392 
	$rvu_mbox_h™dÀr_nix_˙10k_aq_íq
(
rvu
 *rvu,

1393 
nix_˙10k_aq_íq_ªq
 *
ªq
,

1394 
nix_˙10k_aq_íq_r•
 *
r•
)

1396  
	`rvu_nix_aq_íq_ö°
(
rvu
, (
nix_aq_íq_ªq
 *)
ªq
,

1397 (
nix_aq_íq_r•
 *)
r•
);

1398 
	}
}

1399 
EXPORT_SYMBOL
(
rvu_mbox_h™dÀr_nix_˙10k_aq_íq
);

1401 
	$rvu_mbox_h™dÀr_nix_hw˘x_dißbÀ
(
rvu
 *rvu,

1402 
hw˘x_dißbÀ_ªq
 *
ªq
,

1403 
msg_r•
 *
r•
)

1405  
	`nix_lf_hw˘x_dißbÀ
(
rvu
, 
ªq
);

1406 
	}
}

1408 
	$rvu_mbox_h™dÀr_nix_lf_Æloc
(
rvu
 *rvu,

1409 
nix_lf_Æloc_ªq
 *
ªq
,

1410 
nix_lf_Æloc_r•
 *
r•
)

1412 
nixlf
, 
qöts
, 
hw˘x_size
, 
ötf
, 
îr
, 
rc
 = 0;

1413 
rvu_pfvf
 *
pfvf
, *
∑ª¡_pf
;

1414 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1415 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1416 
rvu_block
 *
block
;

1417 
u64
 
cfg
, 
˘x_cfg
;

1418 
blkaddr
;

1420 i‡(!
ªq
->
rq_˙t
 || !ªq->
sq_˙t
 || !ªq->
cq_˙t
)

1421  
NIX_AF_ERR_PARAM
;

1423 i‡(
ªq
->
way_mask
)

1424 
ªq
->
way_mask
 &= 0xFFFF;

1426 
∑ª¡_pf
 = &
rvu
->
pf
[
	`rvu_gë_pf
(
pcifunc
)];

1427 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1428 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

1429 i‡(!
pfvf
->
nixlf
 || 
blkaddr
 < 0)

1430  
NIX_AF_ERR_AF_LF_INVALID
;

1432 
block
 = &
hw
->block[
blkaddr
];

1433 
nixlf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 0);

1434 i‡(
nixlf
 < 0)

1435  
NIX_AF_ERR_AF_LF_INVALID
;

1438 i‡(
ªq
->
≈a_func
) {

1440 i‡(
ªq
->
≈a_func
 =
RVU_DEFAULT_PF_FUNC
)

1441 
ªq
->
≈a_func
 = 
pcifunc
;

1442 i‡(!
	`is_pffunc_m≠_vÆid
(
rvu
, 
ªq
->
≈a_func
, 
BLKTYPE_NPA
))

1443  
NIX_AF_INVAL_NPA_PF_FUNC
;

1447 i‡(
ªq
->
sso_func
) {

1449 i‡(
ªq
->
sso_func
 =
RVU_DEFAULT_PF_FUNC
)

1450 
ªq
->
sso_func
 = 
pcifunc
;

1451 i‡(!
	`is_pffunc_m≠_vÆid
(
rvu
, 
ªq
->
sso_func
, 
BLKTYPE_SSO
))

1452  
NIX_AF_INVAL_SSO_PF_FUNC
;

1460 i‡(
ªq
->
rss_sz
 && (ªq->rss_sz > 
MAX_RSS_INDIR_TBL_SIZE
 ||

1461 !
	`is_powî_of_2
(
ªq
->
rss_sz
)))

1462  
NIX_AF_ERR_RSS_SIZE_INVALID
;

1464 i‡(
ªq
->
rss_sz
 &&

1465 (!
ªq
->
rss_gΩs
 ||Ñeq->rss_gΩ†> 
MAX_RSS_GROUPS
))

1466  
NIX_AF_ERR_RSS_GRPS_INVALID
;

1469 
îr
 = 
	`rvu_lf_ª£t
(
rvu
, 
block
, 
nixlf
);

1470 i‡(
îr
) {

1471 
	`dev_îr
(
rvu
->
dev
, "FailedÅoÑeset NIX%d LF%d\n",

1472 
block
->
addr
 - 
BLKADDR_NIX0
, 
nixlf
);

1473  
NIX_AF_ERR_LF_RESET
;

1476 
˘x_cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST3
);

1479 
hw˘x_size
 = 1UL << ((
˘x_cfg
 >> 4) & 0xF);

1480 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
pfvf
->
rq_˘x
, 
ªq
->
rq_˙t
, 
hw˘x_size
);

1481 i‡(
îr
)

1482 
‰ì_mem
;

1484 
pfvf
->
rq_bm≠
 = 
	`kˇŒoc
(
ªq
->
rq_˙t
, (), 
GFP_KERNEL
);

1485 i‡(!
pfvf
->
rq_bm≠
)

1486 
‰ì_mem
;

1488 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RQS_BASE
(
nixlf
),

1489 (
u64
)
pfvf
->
rq_˘x
->
iova
);

1492 
cfg
 = 
	`BIT_ULL
(36Ë| (
ªq
->
rq_˙t
 - 1Ë|Ñeq->
way_mask
 << 20;

1493 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RQS_CFG
(
nixlf
), 
cfg
);

1496 
hw˘x_size
 = 1UL << (
˘x_cfg
 & 0xF);

1497 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
pfvf
->
sq_˘x
, 
ªq
->
sq_˙t
, 
hw˘x_size
);

1498 i‡(
îr
)

1499 
‰ì_mem
;

1501 
pfvf
->
sq_bm≠
 = 
	`kˇŒoc
(
ªq
->
sq_˙t
, (), 
GFP_KERNEL
);

1502 i‡(!
pfvf
->
sq_bm≠
)

1503 
‰ì_mem
;

1505 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_SQS_BASE
(
nixlf
),

1506 (
u64
)
pfvf
->
sq_˘x
->
iova
);

1508 
cfg
 = 
	`BIT_ULL
(36Ë| (
ªq
->
sq_˙t
 - 1Ë|Ñeq->
way_mask
 << 20;

1509 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_SQS_CFG
(
nixlf
), 
cfg
);

1512 
hw˘x_size
 = 1UL << ((
˘x_cfg
 >> 8) & 0xF);

1513 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
pfvf
->
cq_˘x
, 
ªq
->
cq_˙t
, 
hw˘x_size
);

1514 i‡(
îr
)

1515 
‰ì_mem
;

1517 
pfvf
->
cq_bm≠
 = 
	`kˇŒoc
(
ªq
->
cq_˙t
, (), 
GFP_KERNEL
);

1518 i‡(!
pfvf
->
cq_bm≠
)

1519 
‰ì_mem
;

1521 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_CQS_BASE
(
nixlf
),

1522 (
u64
)
pfvf
->
cq_˘x
->
iova
);

1524 
cfg
 = 
	`BIT_ULL
(36Ë| (
ªq
->
cq_˙t
 - 1Ë|Ñeq->
way_mask
 << 20;

1525 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_CQS_CFG
(
nixlf
), 
cfg
);

1528 
hw˘x_size
 = 1UL << ((
˘x_cfg
 >> 12) & 0xF);

1529 
îr
 = 
	`nixlf_rss_˘x_öô
(
rvu
, 
blkaddr
, 
pfvf
, 
nixlf
, 
ªq
->
rss_sz
,

1530 
ªq
->
rss_gΩs
, 
hw˘x_size
,Ñeq->
way_mask
,

1531 !!(
ªq
->
Êags
 & 
NIX_LF_RSS_TAG_LSB_AS_ADDER
));

1532 i‡(
îr
)

1533 
‰ì_mem
;

1536 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST2
);

1537 
qöts
 = (
cfg
 >> 24) & 0xFFF;

1538 
hw˘x_size
 = 1UL << ((
˘x_cfg
 >> 24) & 0xF);

1539 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
pfvf
->
cq_öts_˘x
, 
qöts
, 
hw˘x_size
);

1540 i‡(
îr
)

1541 
‰ì_mem
;

1543 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_CINTS_BASE
(
nixlf
),

1544 (
u64
)
pfvf
->
cq_öts_˘x
->
iova
);

1546 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_CINTS_CFG
(
nixlf
),

1547 
	`BIT_ULL
(36Ë| 
ªq
->
way_mask
 << 20);

1550 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST2
);

1551 
qöts
 = (
cfg
 >> 12) & 0xFFF;

1552 
hw˘x_size
 = 1UL << ((
˘x_cfg
 >> 20) & 0xF);

1553 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
pfvf
->
nix_qöts_˘x
, 
qöts
, 
hw˘x_size
);

1554 i‡(
îr
)

1555 
‰ì_mem
;

1557 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_QINTS_BASE
(
nixlf
),

1558 (
u64
)
pfvf
->
nix_qöts_˘x
->
iova
);

1559 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_QINTS_CFG
(
nixlf
),

1560 
	`BIT_ULL
(36Ë| 
ªq
->
way_mask
 << 20);

1566 
cfg
 = (0x8100ULL << 16) | 0x88A8ULL;

1567 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_CFG
(
nixlf
), 
cfg
);

1570 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_CFG2
(
nixlf
), 
	`BIT_ULL
(0));

1573 i‡(
ªq
->
≈a_func
)

1574 
cfg
 = 
ªq
->
≈a_func
;

1575 i‡(
ªq
->
sso_func
)

1576 
cfg
 |(
u64
)
ªq
->
sso_func
 << 16;

1578 
cfg
 |(
u64
)
ªq
->
xqe_sz
 << 33;

1579 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_CFG
(
nixlf
), 
cfg
);

1582 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_CFG
(
nixlf
), 
ªq
->
rx_cfg
);

1585 i‡(
	`rvu_cgx_is_pköd_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
)) {

1586 
cfg
 = 
NPC_TX_DEF_PKIND
;

1587 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_PARSE_CFG
(
nixlf
), 
cfg
);

1590 
ötf
 = 
	`is_afvf
(
pcifunc
Ë? 
NIX_INTF_TYPE_LBK
 : 
NIX_INTF_TYPE_CGX
;

1591 i‡(
	`is_sdp_pfvf
(
pcifunc
))

1592 
ötf
 = 
NIX_INTF_TYPE_SDP
;

1594 
îr
 = 
	`nix_öãrÁ˚_öô
(
rvu
, 
pcifunc
, 
ötf
, 
nixlf
, 
r•
,

1595 !!(
ªq
->
Êags
 & 
NIX_LF_LBK_BLK_SEL
));

1596 i‡(
îr
)

1597 
‰ì_mem
;

1600 
	`rvu_≈c_dißbÀ_deÁu…_íåõs
(
rvu
, 
pcifunc
, 
nixlf
);

1603 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1604 
	`NIX_AF_LFX_RX_VTAG_TYPEX
(
nixlf
, 
NIX_AF_LFX_RX_VTAG_TYPE7
),

1605 
VTAGSIZE_T4
 | 
VTAG_STRIP
);

1607 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1608 
	`NIX_AF_LFX_RX_VTAG_TYPEX
(
nixlf
, 
NIX_AF_LFX_RX_VTAG_TYPE6
),

1609 
VTAGSIZE_T4
 | 
VTAG_STRIP
 | 
VTAG_CAPTURE
);

1611 
exô
;

1613 
‰ì_mem
:

1614 
	`nix_˘x_‰ì
(
rvu
, 
pfvf
);

1615 
rc
 = -
ENOMEM
;

1617 
exô
:

1619 
	`ëhî_addr_c›y
(
r•
->
mac_addr
, 
pfvf
->mac_addr);

1622 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_SQ_CONST
);

1623 
r•
->
sqb_size
 = (
cfg
 >> 34) & 0xFFFF;

1624 
r•
->
rx_ch™_ba£
 = 
pfvf
->rx_chan_base;

1625 
r•
->
tx_ch™_ba£
 = 
pfvf
->tx_chan_base;

1626 
r•
->
rx_ch™_˙t
 = 
pfvf
->rx_chan_cnt;

1627 
r•
->
tx_ch™_˙t
 = 
pfvf
->tx_chan_cnt;

1628 
r•
->
lso_tsov4_idx
 = 
NIX_LSO_FORMAT_IDX_TSOV4
;

1629 
r•
->
lso_tsov6_idx
 = 
NIX_LSO_FORMAT_IDX_TSOV6
;

1631 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST1
);

1632 
r•
->
lf_rx_°©s
 = ((
cfg
 >> 32) & 0xFF);

1633 
r•
->
lf_tx_°©s
 = ((
cfg
 >> 24) & 0xFF);

1635 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST2
);

1636 
r•
->
qöts
 = ((
cfg
 >> 12) & 0xFFF);

1637 
r•
->
cöts
 = ((
cfg
 >> 24) & 0xFFF);

1638 
r•
->
hw_rx_t°amp_í
 = 
∑ª¡_pf
->hw_rx_tstamp_en;

1639 
r•
->
cgx_löks
 = 
hw
->cgx_links;

1640 
r•
->
lbk_löks
 = 
hw
->lbk_links;

1641 
r•
->
sdp_löks
 = 
hw
->sdp_links;

1643  
rc
;

1644 
	}
}

1646 
	$rvu_mbox_h™dÀr_nix_lf_‰ì
(
rvu
 *rvu, 
nix_lf_‰ì_ªq
 *
ªq
,

1647 
msg_r•
 *
r•
)

1649 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1650 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1651 
rvu_block
 *
block
;

1652 
blkaddr
, 
nixlf
, 
îr
;

1653 
rvu_pfvf
 *
pfvf
;

1655 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1656 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

1657 i‡(!
pfvf
->
nixlf
 || 
blkaddr
 < 0)

1658  
NIX_AF_ERR_AF_LF_INVALID
;

1660 
block
 = &
hw
->block[
blkaddr
];

1661 
nixlf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 0);

1662 i‡(
nixlf
 < 0)

1663  
NIX_AF_ERR_AF_LF_INVALID
;

1665 i‡(
ªq
->
Êags
 & 
NIX_LF_DISABLE_FLOWS
)

1666 
	`rvu_≈c_dißbÀ_mˇm_íåõs
(
rvu
, 
pcifunc
, 
nixlf
);

1668 
	`rvu_≈c_‰ì_mˇm_íåõs
(
rvu
, 
pcifunc
, 
nixlf
);

1671 
	`rvu_nix_‰ì_•i_to_ß_èbÀ
(
rvu
, 
pcifunc
);

1674 i‡(!(
ªq
->
Êags
 & 
NIX_LF_DONT_FREE_TX_VTAG
))

1675 
	`nix_‰ì_tx_vèg_íåõs
(
rvu
, 
pcifunc
);

1677 
	`nix_öãrÁ˚_deöô
(
rvu
, 
pcifunc
, 
nixlf
);

1680 
îr
 = 
	`rvu_lf_ª£t
(
rvu
, 
block
, 
nixlf
);

1681 i‡(
îr
) {

1682 
	`dev_îr
(
rvu
->
dev
, "FailedÅoÑeset NIX%d LF%d\n",

1683 
block
->
addr
 - 
BLKADDR_NIX0
, 
nixlf
);

1684  
NIX_AF_ERR_LF_RESET
;

1687 
	`nix_˘x_‰ì
(
rvu
, 
pfvf
);

1690 
	}
}

1692 
	$rvu_mbox_h™dÀr_nix_m¨k_f‹m©_cfg
(
rvu
 *rvu,

1693 
nix_m¨k_f‹m©_cfg
 *
ªq
,

1694 
nix_m¨k_f‹m©_cfg_r•
 *
r•
)

1696 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1697 
nix_hw
 *nix_hw;

1698 
rvu_pfvf
 *
pfvf
;

1699 
blkaddr
, 
rc
;

1700 
u32
 
cfg
;

1702 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1703 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

1704 i‡(!
pfvf
->
nixlf
 || 
blkaddr
 < 0)

1705  
NIX_AF_ERR_AF_LF_INVALID
;

1707 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

1708 i‡(!
nix_hw
)

1709  
NIX_AF_ERR_INVALID_NIXBLK
;

1711 
cfg
 = (((
u32
)
ªq
->
off£t
 & 0x7) << 16) |

1712 (((
u32
)
ªq
->
y_mask
 & 0xF) << 12) |

1713 (((
u32
)
ªq
->
y_vÆ
 & 0xF) << 8) |

1714 (((
u32
)
ªq
->
r_mask
 & 0xFË<< 4Ë| ((u32Ïeq->
r_vÆ
 & 0xF);

1716 
rc
 = 
	`rvu_nix_ª£rve_m¨k_f‹m©
(
rvu
, 
nix_hw
, 
blkaddr
, 
cfg
);

1717 i‡(
rc
 < 0) {

1718 
	`dev_îr
(
rvu
->
dev
, "No mark_format_ctl for (pf:%d, vf:%d)",

1719 
	`rvu_gë_pf
(
pcifunc
),Öcifun¯& 
RVU_PFVF_FUNC_MASK
);

1720  
NIX_AF_ERR_MARK_CFG_FAIL
;

1723 
r•
->
m¨k_f‹m©_idx
 = 
rc
;

1725 
	}
}

1728 
boﬁ


1729 
	$h™dÀ_txschq_sh≠î_upd©e
(
rvu
 *rvu, 
blkaddr
, 
nixlf
,

1730 
lvl
, 
u64
 
ªg
, u64 
ªgvÆ
)

1732 
u64
 
ªgba£
, 
ﬁdvÆ
, 
sw_xoff
 = 0;

1733 
u64
 
dbgvÆ
, 
md_debug0
 = 0;

1734 
pﬁl_tmo
;

1735 
boﬁ
 
øã_ªg
 = 0;

1736 
u32
 
schq
;

1738 
ªgba£
 = 
ªg
 & 0xFFFF;

1739 
schq
 = 
	`TXSCHQ_IDX
(
ªg
, 
TXSCHQ_IDX_SHIFT
);

1742 
lvl
) {

1743 
NIX_TXSCH_LVL_TL1
:

1744 
md_debug0
 = 
	`NIX_AF_TL1X_MD_DEBUG0
(
schq
);

1745 
sw_xoff
 = 
	`NIX_AF_TL1X_SW_XOFF
(
schq
);

1747 
øã_ªg
 = !!(
ªgba£
 =
	`NIX_AF_TL1X_CIR
(0));

1749 
NIX_TXSCH_LVL_TL2
:

1750 
md_debug0
 = 
	`NIX_AF_TL2X_MD_DEBUG0
(
schq
);

1751 
sw_xoff
 = 
	`NIX_AF_TL2X_SW_XOFF
(
schq
);

1753 
øã_ªg
 = (
ªgba£
 =
	`NIX_AF_TL2X_CIR
(0) ||

1754 
ªgba£
 =
	`NIX_AF_TL2X_PIR
(0));

1756 
NIX_TXSCH_LVL_TL3
:

1757 
md_debug0
 = 
	`NIX_AF_TL3X_MD_DEBUG0
(
schq
);

1758 
sw_xoff
 = 
	`NIX_AF_TL3X_SW_XOFF
(
schq
);

1760 
øã_ªg
 = (
ªgba£
 =
	`NIX_AF_TL3X_CIR
(0) ||

1761 
ªgba£
 =
	`NIX_AF_TL3X_PIR
(0));

1763 
NIX_TXSCH_LVL_TL4
:

1764 
md_debug0
 = 
	`NIX_AF_TL4X_MD_DEBUG0
(
schq
);

1765 
sw_xoff
 = 
	`NIX_AF_TL4X_SW_XOFF
(
schq
);

1767 
øã_ªg
 = (
ªgba£
 =
	`NIX_AF_TL4X_CIR
(0) ||

1768 
ªgba£
 =
	`NIX_AF_TL4X_PIR
(0));

1770 
NIX_TXSCH_LVL_MDQ
:

1771 
sw_xoff
 = 
	`NIX_AF_MDQX_SW_XOFF
(
schq
);

1772 
øã_ªg
 = (
ªgba£
 =
	`NIX_AF_MDQX_CIR
(0) ||

1773 
ªgba£
 =
	`NIX_AF_MDQX_PIR
(0));

1777 i‡(!
øã_ªg
)

1778  
Ál£
;

1781 
ﬁdvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
ªg
);

1782 i‡((
ﬁdvÆ
 & 0x1Ë=(
ªgvÆ
 & 0x1)) {

1783 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªg
, 
ªgvÆ
);

1784  
åue
;

1788 i‡(!(
ªgvÆ
 & 0x1)) {

1789 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
sw_xoff
, 1);

1790 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªg
, 0);

1791 
	`udñay
(4);

1792 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
sw_xoff
, 0);

1793  
åue
;

1797 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
sw_xoff
, 1);

1798 i‡(
md_debug0
) {

1799 
pﬁl_tmo
 = 
jiffõs
 + 
	`u£cs_to_jiffõs
(10000);

1802 i‡(
	`time_a·î
(
jiffõs
, 
pﬁl_tmo
)) {

1803 
	`dev_îr
(
rvu
->
dev
,

1805 
nixlf
, 
schq
, 
lvl
);

1806 
exô
;

1808 
	`u¶ìp_ønge
(1, 5);

1809 
dbgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
md_debug0
);

1810 } !(
dbgvÆ
 & 
	`BIT_ULL
(32)) && (dbgval & BIT_ULL(48)));

1812 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªg
, 
ªgvÆ
);

1813 
exô
:

1814 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
sw_xoff
, 0);

1815  
åue
;

1816 
	}
}

1818 
	$nix_ª£t_tx_scheduÀ
(
rvu
 *rvu, 
blkaddr
,

1819 
lvl
, 
schq
)

1821 
u64
 
éx_∑ª¡
 = 0, 
éx_scheduÀ
 = 0;

1823 
lvl
) {

1824 
NIX_TXSCH_LVL_TL2
:

1825 
éx_∑ª¡
 = 
	`NIX_AF_TL2X_PARENT
(
schq
);

1826 
éx_scheduÀ
 = 
	`NIX_AF_TL2X_SCHEDULE
(
schq
);

1828 
NIX_TXSCH_LVL_TL3
:

1829 
éx_∑ª¡
 = 
	`NIX_AF_TL3X_PARENT
(
schq
);

1830 
éx_scheduÀ
 = 
	`NIX_AF_TL3X_SCHEDULE
(
schq
);

1832 
NIX_TXSCH_LVL_TL4
:

1833 
éx_∑ª¡
 = 
	`NIX_AF_TL4X_PARENT
(
schq
);

1834 
éx_scheduÀ
 = 
	`NIX_AF_TL4X_SCHEDULE
(
schq
);

1836 
NIX_TXSCH_LVL_MDQ
:

1840 
éx_∑ª¡
 = 
	`NIX_AF_MDQX_PARENT
(
schq
);

1841 
éx_scheduÀ
 = 
	`NIX_AF_MDQX_SCHEDULE
(
schq
);

1847 i‡(
éx_∑ª¡
)

1848 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
éx_∑ª¡
, 0x0);

1850 i‡(
éx_scheduÀ
)

1851 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
éx_scheduÀ
, 0x0);

1852 
	}
}

1857 
	$nix_ª£t_tx_sh≠ög
(
rvu
 *rvu, 
blkaddr
,

1858 
nixlf
, 
lvl
, 
schq
)

1860 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1861 
u64
 
cú_ªg
 = 0, 
pú_ªg
 = 0;

1862 
u64
 
cfg
;

1864 
lvl
) {

1865 
NIX_TXSCH_LVL_TL1
:

1866 
cú_ªg
 = 
	`NIX_AF_TL1X_CIR
(
schq
);

1867 
pú_ªg
 = 0;

1869 
NIX_TXSCH_LVL_TL2
:

1870 
cú_ªg
 = 
	`NIX_AF_TL2X_CIR
(
schq
);

1871 
pú_ªg
 = 
	`NIX_AF_TL2X_PIR
(
schq
);

1873 
NIX_TXSCH_LVL_TL3
:

1874 
cú_ªg
 = 
	`NIX_AF_TL3X_CIR
(
schq
);

1875 
pú_ªg
 = 
	`NIX_AF_TL3X_PIR
(
schq
);

1877 
NIX_TXSCH_LVL_TL4
:

1878 
cú_ªg
 = 
	`NIX_AF_TL4X_CIR
(
schq
);

1879 
pú_ªg
 = 
	`NIX_AF_TL4X_PIR
(
schq
);

1881 
NIX_TXSCH_LVL_MDQ
:

1882 
cú_ªg
 = 
	`NIX_AF_MDQX_CIR
(
schq
);

1883 
pú_ªg
 = 
	`NIX_AF_MDQX_PIR
(
schq
);

1888 i‡(
hw
->
ˇp
.
nix_sh≠î_toggÀ_waô
) {

1889 i‡(
cú_ªg
)

1890 
	`h™dÀ_txschq_sh≠î_upd©e
(
rvu
, 
blkaddr
, 
nixlf
,

1891 
lvl
, 
cú_ªg
, 0);

1892 i‡(
pú_ªg
)

1893 
	`h™dÀ_txschq_sh≠î_upd©e
(
rvu
, 
blkaddr
, 
nixlf
,

1894 
lvl
, 
pú_ªg
, 0);

1898 i‡(!
cú_ªg
)

1900 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
cú_ªg
);

1901 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
cú_ªg
, 
cfg
 & ~
	`BIT_ULL
(0));

1903 i‡(!
pú_ªg
)

1905 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
pú_ªg
);

1906 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
pú_ªg
, 
cfg
 & ~
	`BIT_ULL
(0));

1907 
	}
}

1909 
	$nix_ª£t_tx_lökcfg
(
rvu
 *rvu, 
blkaddr
,

1910 
lvl
, 
schq
)

1912 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1913 
lök_Àvñ
;

1914 
lök
;

1916 i‡(
lvl
 >
hw
->
ˇp
.
nix_tx_aggr_lvl
)

1920 i‡(
lvl
 =
NIX_TXSCH_LVL_TL4
)

1921 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL4X_SDP_LINK_CFG
(
schq
), 0x00);

1923 
lök_Àvñ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_PSE_CHANNEL_LEVEL
) & 0x01 ?

1924 
NIX_TXSCH_LVL_TL3
 : 
NIX_TXSCH_LVL_TL2
;

1925 i‡(
lvl
 !
lök_Àvñ
)

1929 
lök
 = 0;Üök < (
hw
->
cgx_löks
 + hw->
lbk_löks
);Üink++)

1930 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1931 
	`NIX_AF_TL3_TL2X_LINKX_CFG
(
schq
, 
lök
), 0x00);

1932 
	}
}

1934 
	$nix_˛ór_tx_xoff
(
rvu
 *rvu, 
blkaddr
,

1935 
lvl
, 
schq
)

1937 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1938 
u64
 
ªg
;

1941 i‡(!
hw
->
ˇp
.
nix_sh≠ög
)

1945 
lvl
) {

1946 
NIX_TXSCH_LVL_TL1
:

1947 
ªg
 = 
	`NIX_AF_TL1X_SW_XOFF
(
schq
);

1949 
NIX_TXSCH_LVL_TL2
:

1950 
ªg
 = 
	`NIX_AF_TL2X_SW_XOFF
(
schq
);

1952 
NIX_TXSCH_LVL_TL3
:

1953 
ªg
 = 
	`NIX_AF_TL3X_SW_XOFF
(
schq
);

1955 
NIX_TXSCH_LVL_TL4
:

1956 
ªg
 = 
	`NIX_AF_TL4X_SW_XOFF
(
schq
);

1958 
NIX_TXSCH_LVL_MDQ
:

1959 
ªg
 = 
	`NIX_AF_MDQX_SW_XOFF
(
schq
);

1965 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªg
, 0x0);

1966 
	}
}

1968 
	$nix_gë_tx_lök
(
rvu
 *rvu, 
u16
 
pcifunc
)

1970 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1971 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

1972 
u8
 
cgx_id
 = 0, 
lmac_id
 = 0;

1974 i‡(
	`is_afvf
(
pcifunc
)) {

1975  
hw
->
cgx_löks
;

1976 } i‡(
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
)) {

1977 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1978  (
cgx_id
 * 
hw
->
lmac_≥r_cgx
Ë+ 
lmac_id
;

1982  
hw
->
cgx_löks
 + hw->
lbk_löks
;

1983 
	}
}

1985 
	$nix_gë_txschq_ønge
(
rvu
 *rvu, 
u16
 
pcifunc
,

1986 
lök
, *
°¨t
, *
íd
)

1988 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1989 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

1991 i‡(
	`is_afvf
(
pcifunc
)) {

1992 *
°¨t
 = 
hw
->
ˇp
.
nix_txsch_≥r_cgx_lmac
 * 
lök
;

1993 *
íd
 = *
°¨t
 + 
hw
->
ˇp
.
nix_txsch_≥r_lbk_lmac
;

1994 } i‡(
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
)) {

1995 *
°¨t
 = 
hw
->
ˇp
.
nix_txsch_≥r_cgx_lmac
 * 
lök
;

1996 *
íd
 = *
°¨t
 + 
hw
->
ˇp
.
nix_txsch_≥r_cgx_lmac
;

1998 *
°¨t
 = (
hw
->
ˇp
.
nix_txsch_≥r_cgx_lmac
 * hw->
cgx_löks
) +

1999 (
hw
->
ˇp
.
nix_txsch_≥r_lbk_lmac
 * hw->
lbk_löks
);

2000 *
íd
 = *
°¨t
 + 
hw
->
ˇp
.
nix_txsch_≥r_sdp_lmac
;

2002 
	}
}

2004 
	$nix_check_txschq_Æloc_ªq
(
rvu
 *rvu, 
lvl
, 
u16
 
pcifunc
,

2005 
nix_hw
 *nix_hw,

2006 
nix_txsch_Æloc_ªq
 *
ªq
)

2008 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2009 
schq
, 
ªq_schq
, 
‰ì_˙t
;

2010 
nix_txsch
 *
txsch
;

2011 
lök
, 
°¨t
, 
íd
;

2013 
txsch
 = &
nix_hw
->txsch[
lvl
];

2014 
ªq_schq
 = 
ªq
->
schq_c⁄tig
[
lvl
] +Ñeq->
schq
[lvl];

2016 i‡(!
ªq_schq
)

2019 
lök
 = 
	`nix_gë_tx_lök
(
rvu
, 
pcifunc
);

2022 i‡(
lvl
 >
hw
->
ˇp
.
nix_tx_aggr_lvl
) {

2023 i‡(
ªq_schq
 != 1)

2024  
NIX_AF_ERR_TLX_ALLOC_FAIL
;

2029 i‡(
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
) {

2030 
	`nix_gë_txschq_ønge
(
rvu
, 
pcifunc
, 
lök
, &
°¨t
, &
íd
);

2031 
schq
 = 
°¨t
 + (
pcifunc
 & 
RVU_PFVF_FUNC_MASK
);

2032 i‡(
íd
 <
txsch
->
schq
.
max
 && schq <Énd &&

2033 !
	`ã°_bô
(
schq
, 
txsch
->schq.
bm≠
))

2034 
‰ì_˙t
 = 1;

2036 
‰ì_˙t
 = 0;

2038 
‰ì_˙t
 = 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

2041 i‡(
‰ì_˙t
 < 
ªq_schq
 || 
ªq
->
schq
[
lvl
] > 
MAX_TXSCHQ_PER_FUNC
 ||

2042 
ªq
->
schq_c⁄tig
[
lvl
] > 
MAX_TXSCHQ_PER_FUNC
)

2043  
NIX_AF_ERR_TLX_ALLOC_FAIL
;

2046 i‡(!
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
 && 
ªq
->
schq_c⁄tig
[
lvl
] &&

2047 !
	`rvu_r§c_check_c⁄tig
(&
txsch
->
schq
, 
ªq
->
schq_c⁄tig
[
lvl
]))

2048  
NIX_AF_ERR_TLX_ALLOC_FAIL
;

2051 
	}
}

2053 
	$nix_txsch_Æloc
(
rvu
 *rvu, 
nix_txsch
 *
txsch
,

2054 
nix_txsch_Æloc_r•
 *
r•
,

2055 
lvl
, 
°¨t
, 
íd
)

2057 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2058 
u16
 
pcifunc
 = 
r•
->
hdr
.pcifunc;

2059 
idx
, 
schq
;

2064 i‡(
lvl
 >
hw
->
ˇp
.
nix_tx_aggr_lvl
) {

2066 i‡(
r•
->
schq_c⁄tig
[
lvl
]) {

2067 
r•
->
schq_c⁄tig
[
lvl
] = 1;

2068 
r•
->
schq_c⁄tig_li°
[
lvl
][0] = 
°¨t
;

2072 i‡(
r•
->
schq_c⁄tig
[
lvl
])

2073 
r•
->
schq
[
lvl
] = 0;

2075 i‡(
r•
->
schq
[
lvl
]) {

2076 
r•
->
schq
[
lvl
] = 1;

2077 
r•
->
schq_li°
[
lvl
][0] = 
°¨t
;

2085 i‡(
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
) {

2086 
idx
 = 
pcifunc
 & 
RVU_PFVF_FUNC_MASK
;

2087 
schq
 = 
°¨t
 + 
idx
;

2088 i‡(
idx
 >(
íd
 - 
°¨t
Ë|| 
	`ã°_bô
(
schq
, 
txsch
->schq.
bm≠
)) {

2089 
r•
->
schq_c⁄tig
[
lvl
] = 0;

2090 
r•
->
schq
[
lvl
] = 0;

2094 i‡(
r•
->
schq_c⁄tig
[
lvl
]) {

2095 
r•
->
schq_c⁄tig
[
lvl
] = 1;

2096 
	`£t_bô
(
schq
, 
txsch
->schq.
bm≠
);

2097 
r•
->
schq_c⁄tig_li°
[
lvl
][0] = 
schq
;

2098 
r•
->
schq
[
lvl
] = 0;

2099 } i‡(
r•
->
schq
[
lvl
]) {

2100 
r•
->
schq
[
lvl
] = 1;

2101 
	`£t_bô
(
schq
, 
txsch
->schq.
bm≠
);

2102 
r•
->
schq_li°
[
lvl
][0] = 
schq
;

2108 i‡(
r•
->
schq_c⁄tig
[
lvl
]) {

2109 
schq
 = 
	`bôm≠_föd_√xt_zîo_¨ó
(
txsch
->schq.
bm≠
,

2110 
txsch
->
schq
.
max
, 
°¨t
,

2111 
r•
->
schq_c⁄tig
[
lvl
], 0);

2112 i‡(
schq
 >
íd
)

2113 
r•
->
schq_c⁄tig
[
lvl
] = 0;

2114 
idx
 = 0; idx < 
r•
->
schq_c⁄tig
[
lvl
]; idx++) {

2115 
	`£t_bô
(
schq
, 
txsch
->schq.
bm≠
);

2116 
r•
->
schq_c⁄tig_li°
[
lvl
][
idx
] = 
schq
;

2117 
schq
++;

2122 i‡(
r•
->
schq
[
lvl
]) {

2123 
idx
 = 0;

2124 
schq
 = 
°¨t
; schq < 
íd
; schq++) {

2125 i‡(!
	`ã°_bô
(
schq
, 
txsch
->schq.
bm≠
)) {

2126 
	`£t_bô
(
schq
, 
txsch
->schq.
bm≠
);

2127 
r•
->
schq_li°
[
lvl
][
idx
++] = 
schq
;

2129 i‡(
idx
 =
r•
->
schq
[
lvl
])

2133 
r•
->
schq
[
lvl
] = 
idx
;

2135 
	}
}

2137 
	$rvu_mbox_h™dÀr_nix_txsch_Æloc
(
rvu
 *rvu,

2138 
nix_txsch_Æloc_ªq
 *
ªq
,

2139 
nix_txsch_Æloc_r•
 *
r•
)

2141 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2142 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2143 
rvu_pfvf
 *
∑ª¡_pf
;

2144 
lök
, 
blkaddr
, 
rc
 = 0;

2145 
lvl
, 
idx
, 
°¨t
, 
íd
;

2146 
nix_txsch
 *
txsch
;

2147 
nix_hw
 *nix_hw;

2148 
u32
 *
pfvf_m≠
;

2149 
nixlf
;

2150 
u16
 
schq
;

2152 
rc
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

2153 i‡(
rc
)

2154  
rc
;

2156 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

2157 i‡(!
nix_hw
)

2158  
NIX_AF_ERR_INVALID_NIXBLK
;

2160 
∑ª¡_pf
 = &
rvu
->
pf
[
	`rvu_gë_pf
(
pcifunc
)];

2162 
	`muãx_lock
(&
rvu
->
r§c_lock
);

2165 i‡(!
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
 &&

2166 
	`rvu_check_txsch_pﬁicy
(
rvu
, 
ªq
, 
pcifunc
)) {

2167 
	`dev_îr
(
rvu
->
dev
, "Func 0x%x: TXSCHÖolicy check failed\n",

2168 
pcifunc
);

2169 
îr
;

2175 
lvl
 = 0;Üv»< 
NIX_TXSCH_LVL_CNT
;Üvl++) {

2176 
rc
 = 
	`nix_check_txschq_Æloc_ªq
(
rvu
, 
lvl
, 
pcifunc
, 
nix_hw
, 
ªq
);

2177 i‡(
rc
)

2178 
îr
;

2182 
lvl
 = 0;Üv»< 
NIX_TXSCH_LVL_CNT
;Üvl++) {

2183 
txsch
 = &
nix_hw
->txsch[
lvl
];

2184 
pfvf_m≠
 = 
txsch
->pfvf_map;

2186 i‡(!
ªq
->
schq
[
lvl
] && !ªq->
schq_c⁄tig
[lvl])

2189 
r•
->
schq
[
lvl
] = 
ªq
->schq[lvl];

2190 
r•
->
schq_c⁄tig
[
lvl
] = 
ªq
->schq_contig[lvl];

2192 
lök
 = 
	`nix_gë_tx_lök
(
rvu
, 
pcifunc
);

2194 i‡(
lvl
 >
hw
->
ˇp
.
nix_tx_aggr_lvl
) {

2195 
°¨t
 = 
lök
;

2196 
íd
 = 
lök
;

2197 } i‡(
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
) {

2198 
	`nix_gë_txschq_ønge
(
rvu
, 
pcifunc
, 
lök
, &
°¨t
, &
íd
);

2200 
°¨t
 = 0;

2201 
íd
 = 
txsch
->
schq
.
max
;

2204 
	`nix_txsch_Æloc
(
rvu
, 
txsch
, 
r•
, 
lvl
, 
°¨t
, 
íd
);

2207 
idx
 = 0; idx < 
ªq
->
schq_c⁄tig
[
lvl
]; idx++) {

2208 
schq
 = 
r•
->
schq_c⁄tig_li°
[
lvl
][
idx
];

2209 i‡(!(
	`TXSCH_MAP_FLAGS
(
pfvf_m≠
[
schq
]) &

2210 
NIX_TXSCHQ_CFG_DONE
))

2211 
pfvf_m≠
[
schq
] = 
	`TXSCH_MAP
(
pcifunc
, 0);

2212 
	`nix_ª£t_tx_lökcfg
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2213 
	`nix_ª£t_tx_sh≠ög
(
rvu
, 
blkaddr
, 
nixlf
, 
lvl
, 
schq
);

2214 
	`nix_ª£t_tx_scheduÀ
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2217 
idx
 = 0; idx < 
ªq
->
schq
[
lvl
]; idx++) {

2218 
schq
 = 
r•
->
schq_li°
[
lvl
][
idx
];

2219 i‡(!(
	`TXSCH_MAP_FLAGS
(
pfvf_m≠
[
schq
]) &

2220 
NIX_TXSCHQ_CFG_DONE
))

2221 
pfvf_m≠
[
schq
] = 
	`TXSCH_MAP
(
pcifunc
, 0);

2222 
	`nix_ª£t_tx_lökcfg
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2223 
	`nix_ª£t_tx_sh≠ög
(
rvu
, 
blkaddr
, 
nixlf
, 
lvl
, 
schq
);

2224 
	`nix_ª£t_tx_scheduÀ
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2228 
r•
->
aggr_Àvñ
 = 
hw
->
ˇp
.
nix_tx_aggr_lvl
;

2229 
r•
->
aggr_lvl_º_¥io
 = 
∑ª¡_pf
->
é1_º_¥io
;

2230 
r•
->
lök_cfg_lvl
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

2231 
NIX_AF_PSE_CHANNEL_LEVEL
) & 0x01 ?

2232 
NIX_TXSCH_LVL_TL3
 : 
NIX_TXSCH_LVL_TL2
;

2233 
exô
;

2234 
îr
:

2235 
rc
 = 
NIX_AF_ERR_TLX_ALLOC_FAIL
;

2236 
exô
:

2237 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

2238  
rc
;

2239 
	}
}

2241 
	$nix_smq_Êush
(
rvu
 *rvu, 
blkaddr
,

2242 
smq
, 
u16
 
pcifunc
, 
nixlf
)

2244 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

2245 
u8
 
cgx_id
 = 0, 
lmac_id
 = 0;

2246 
îr
, 
ª°‹e_tx_í
 = 0;

2247 
u64
 
cfg
;

2249 i‡(!
	`is_rvu_Ÿx2
(
rvu
)) {

2251 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_MDQX_IN_MD_COUNT
(
smq
));

2252 i‡(!
cfg
) {

2254 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SMQX_CFG
(
smq
), 0);

2260 i‡(
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
)) {

2261 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

2262 
ª°‹e_tx_í
 = !
	`rvu_cgx_c⁄fig_tx
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
),

2263 
lmac_id
, 
åue
);

2266 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SMQX_CFG
(
smq
));

2268 
cfg
 |
	`BIT_ULL
(50) | BIT_ULL(49);

2269 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SMQX_CFG
(
smq
), 
cfg
);

2274 
	`rvu_cgx_íadis_rx_bp
(
rvu
, 
pf
, 
Ál£
);

2276 
	`rvu_smqvf_xmô
(
rvu
);

2279 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
,

2280 
	`NIX_AF_SMQX_CFG
(
smq
), 
	`BIT_ULL
(49), 
åue
);

2281 i‡(
îr
)

2282 
	`dev_öfo
(
rvu
->
dev
,

2284 
nixlf
, 
smq
);

2286 
	`rvu_cgx_íadis_rx_bp
(
rvu
, 
pf
, 
åue
);

2288 i‡(
ª°‹e_tx_í
)

2289 
	`rvu_cgx_c⁄fig_tx
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
), 
lmac_id
, 
Ál£
);

2291 
	}
}

2293 
	$nix_txschq_‰ì
(
rvu
 *rvu, 
u16
 
pcifunc
)

2295 
blkaddr
, 
nixlf
, 
lvl
, 
schq
, 
îr
;

2296 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2297 
nix_txsch
 *
txsch
;

2298 
nix_hw
 *nix_hw;

2299 
u16
 
m≠_func
;

2301 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

2302 i‡(
blkaddr
 < 0)

2303  
NIX_AF_ERR_AF_LF_INVALID
;

2305 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

2306 i‡(!
nix_hw
)

2307  
NIX_AF_ERR_INVALID_NIXBLK
;

2309 
nixlf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

2310 i‡(
nixlf
 < 0)

2311  
NIX_AF_ERR_AF_LF_INVALID
;

2314 
	`muãx_lock
(&
rvu
->
r§c_lock
);

2315 
lvl
 = 
NIX_TXSCH_LVL_MDQ
;Üv»< 
NIX_TXSCH_LVL_CNT
;Üvl++) {

2316 
txsch
 = &
nix_hw
->txsch[
lvl
];

2318 i‡(
lvl
 >
hw
->
ˇp
.
nix_tx_aggr_lvl
)

2321 
schq
 = 0; schq < 
txsch
->schq.
max
; schq++) {

2322 i‡(
	`TXSCH_MAP_FUNC
(
txsch
->
pfvf_m≠
[
schq
]Ë!
pcifunc
)

2324 
	`nix_ª£t_tx_lökcfg
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2325 
	`nix_˛ór_tx_xoff
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2326 
	`nix_ª£t_tx_sh≠ög
(
rvu
, 
blkaddr
, 
nixlf
, 
lvl
, 
schq
);

2327 
	`nix_ª£t_tx_scheduÀ
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2330 
	`nix_˛ór_tx_xoff
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_TL1
,

2331 
	`nix_gë_tx_lök
(
rvu
, 
pcifunc
));

2336 i‡(!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)) {

2337 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL1
];

2338 
schq
 = 
	`nix_gë_tx_lök
(
rvu
, 
pcifunc
);

2342 
m≠_func
 = 
	`TXSCH_MAP_FUNC
(
txsch
->
pfvf_m≠
[
schq
]);

2343 
txsch
->
pfvf_m≠
[
schq
] = 
	`TXSCH_SET_FLAG
(
m≠_func
, 0x0);

2347 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_SMQ
];

2348 
schq
 = 0; schq < 
txsch
->schq.
max
; schq++) {

2349 i‡(
	`TXSCH_MAP_FUNC
(
txsch
->
pfvf_m≠
[
schq
]Ë!
pcifunc
)

2351 
	`nix_smq_Êush
(
rvu
, 
blkaddr
, 
schq
, 
pcifunc
, 
nixlf
);

2355 
lvl
 = 0;Üv»< 
NIX_TXSCH_LVL_CNT
;Üvl++) {

2359 i‡(
lvl
 >
hw
->
ˇp
.
nix_tx_aggr_lvl
)

2362 
txsch
 = &
nix_hw
->txsch[
lvl
];

2363 
schq
 = 0; schq < 
txsch
->schq.
max
; schq++) {

2364 i‡(
	`TXSCH_MAP_FUNC
(
txsch
->
pfvf_m≠
[
schq
]Ë!
pcifunc
)

2366 
	`rvu_‰ì_r§c
(&
txsch
->
schq
, schq);

2367 
txsch
->
pfvf_m≠
[
schq
] = 
	`TXSCH_MAP
(0, 
NIX_TXSCHQ_FREE
);

2370 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

2372 
îr
 = 
	`rvu_ndc_sync
(
rvu
, 
blkaddr
, 
nixlf
, 
NIX_AF_NDC_TX_SYNC
);

2373 i‡(
îr
)

2374 
	`dev_îr
(
rvu
->
dev
, "NDC-TX syn¯Áûed f‹ NIXLF %d\n", 
nixlf
);

2377 
	}
}

2379 
	$nix_txschq_‰ì_⁄e
(
rvu
 *rvu,

2380 
nix_txsch_‰ì_ªq
 *
ªq
)

2382 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2383 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2384 
lvl
, 
schq
, 
nixlf
, 
blkaddr
;

2385 
nix_txsch
 *
txsch
;

2386 
nix_hw
 *nix_hw;

2387 
u32
 *
pfvf_m≠
;

2388 
rc
;

2390 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

2391 i‡(
blkaddr
 < 0)

2392  
NIX_AF_ERR_AF_LF_INVALID
;

2394 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

2395 i‡(!
nix_hw
)

2396  
NIX_AF_ERR_INVALID_NIXBLK
;

2398 
nixlf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

2399 i‡(
nixlf
 < 0)

2400  
NIX_AF_ERR_AF_LF_INVALID
;

2402 
lvl
 = 
ªq
->
schq_lvl
;

2403 
schq
 = 
ªq
->schq;

2404 
txsch
 = &
nix_hw
->txsch[
lvl
];

2406 i‡(
lvl
 >
hw
->
ˇp
.
nix_tx_aggr_lvl
 || 
schq
 >
txsch
->schq.
max
)

2409 
pfvf_m≠
 = 
txsch
->pfvf_map;

2410 
	`muãx_lock
(&
rvu
->
r§c_lock
);

2412 i‡(
	`TXSCH_MAP_FUNC
(
pfvf_m≠
[
schq
]Ë!
pcifunc
) {

2413 
rc
 = 
NIX_AF_ERR_TLX_INVALID
;

2414 
îr
;

2421 
	`nix_˛ór_tx_xoff
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2423 
	`nix_ª£t_tx_lökcfg
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2424 
	`nix_ª£t_tx_sh≠ög
(
rvu
, 
blkaddr
, 
nixlf
, 
lvl
, 
schq
);

2425 
	`nix_ª£t_tx_scheduÀ
(
rvu
, 
blkaddr
, 
lvl
, 
schq
);

2430 i‡(
lvl
 =
NIX_TXSCH_LVL_SMQ
 &&

2431 
	`nix_smq_Êush
(
rvu
, 
blkaddr
, 
schq
, 
pcifunc
, 
nixlf
)) {

2432 
rc
 = 
NIX_AF_SMQ_FLUSH_FAILED
;

2433 
îr
;

2437 
	`rvu_‰ì_r§c
(&
txsch
->
schq
, schq);

2438 
txsch
->
pfvf_m≠
[
schq
] = 
	`TXSCH_MAP
(0, 
NIX_TXSCHQ_FREE
);

2439 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

2441 
îr
:

2442 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

2443  
rc
;

2444 
	}
}

2446 
	$rvu_mbox_h™dÀr_nix_txsch_‰ì
(
rvu
 *rvu,

2447 
nix_txsch_‰ì_ªq
 *
ªq
,

2448 
msg_r•
 *
r•
)

2450 i‡(
ªq
->
Êags
 & 
TXSCHQ_FREE_ALL
)

2451  
	`nix_txschq_‰ì
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

2453  
	`nix_txschq_‰ì_⁄e
(
rvu
, 
ªq
);

2454 
	}
}

2456 
boﬁ
 
	$is_txschq_hõørchy_vÆid
(
rvu
 *rvu, 
u16
 
pcifunc
, 
blkaddr
,

2457 
lvl
, 
u64
 
ªg
, u64 
ªgvÆ
)

2459 
u64
 
ªgba£
 = 
ªg
 & 0xFFFF;

2460 
u16
 
schq
, 
∑ª¡
;

2462 i‡(!
	`rvu_check_vÆid_ªg
(
TXSCHQ_HWREGMAP
, 
lvl
, 
ªg
))

2463  
Ál£
;

2465 
schq
 = 
	`TXSCHQ_IDX
(
ªg
, 
TXSCHQ_IDX_SHIFT
);

2467 i‡(!
	`is_vÆid_txschq
(
rvu
, 
blkaddr
, 
lvl
, 
pcifunc
, 
schq
))

2468  
Ál£
;

2470 
∑ª¡
 = (
ªgvÆ
 >> 16) & 0x1FF;

2472 i‡(
ªgba£
 =
	`NIX_AF_MDQX_PARENT
(0) &&

2473 !
	`is_vÆid_txschq
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_TL4
, 
pcifunc
, 
∑ª¡
))

2474  
Ál£
;

2477 i‡(
ªgba£
 =
	`NIX_AF_TL4X_PARENT
(0) &&

2478 !
	`is_vÆid_txschq
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_TL3
, 
pcifunc
, 
∑ª¡
))

2479  
Ál£
;

2482 i‡(
ªgba£
 =
	`NIX_AF_TL3X_PARENT
(0) &&

2483 !
	`is_vÆid_txschq
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_TL2
, 
pcifunc
, 
∑ª¡
))

2484  
Ál£
;

2487 i‡(
ªgba£
 =
	`NIX_AF_TL2X_PARENT
(0) &&

2488 !
	`is_vÆid_txschq
(
rvu
, 
blkaddr
, 
NIX_TXSCH_LVL_TL1
, 
pcifunc
, 
∑ª¡
))

2489  
Ál£
;

2491  
åue
;

2492 
	}
}

2494 
boﬁ
 
	$is_txschq_sh≠ög_vÆid
(
rvu_hwöfo
 *
hw
, 
lvl
, 
u64
 
ªg
)

2496 
u64
 
ªgba£
;

2498 i‡(
hw
->
ˇp
.
nix_sh≠ög
)

2499  
åue
;

2504 
ªgba£
 = 
ªg
 & 0xFFFF;

2506 
lvl
) {

2507 
NIX_TXSCH_LVL_TL1
:

2508 i‡(
ªgba£
 =
	`NIX_AF_TL1X_CIR
(0))

2509  
Ál£
;

2511 
NIX_TXSCH_LVL_TL2
:

2512 i‡(
ªgba£
 =
	`NIX_AF_TL2X_CIR
(0) ||

2513 
ªgba£
 =
	`NIX_AF_TL2X_PIR
(0))

2514  
Ál£
;

2516 
NIX_TXSCH_LVL_TL3
:

2517 i‡(
ªgba£
 =
	`NIX_AF_TL3X_CIR
(0) ||

2518 
ªgba£
 =
	`NIX_AF_TL3X_PIR
(0))

2519  
Ál£
;

2521 
NIX_TXSCH_LVL_TL4
:

2522 i‡(
ªgba£
 =
	`NIX_AF_TL4X_CIR
(0) ||

2523 
ªgba£
 =
	`NIX_AF_TL4X_PIR
(0))

2524  
Ál£
;

2526 
NIX_TXSCH_LVL_MDQ
:

2527 i‡(
ªgba£
 =
	`NIX_AF_MDQX_CIR
(0) ||

2528 
ªgba£
 =
	`NIX_AF_MDQX_PIR
(0))

2529  
Ál£
;

2532  
åue
;

2533 
	}
}

2535 
	$nix_é1_deÁu…_cfg
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

2536 
u16
 
pcifunc
, 
blkaddr
)

2538 
rvu_pfvf
 *
∑ª¡_pf
 = &
rvu
->
pf
[
	`rvu_gë_pf
(
pcifunc
)];

2539 
u32
 *
pfvf_m≠
;

2541 
schq
;

2543 
schq
 = 
	`nix_gë_tx_lök
(
rvu
, 
pcifunc
);

2544 
pfvf_m≠
 = 
nix_hw
->
txsch
[
NIX_TXSCH_LVL_TL1
].pfvf_map;

2546 i‡(
	`TXSCH_MAP_FLAGS
(
pfvf_m≠
[
schq
]Ë& 
NIX_TXSCHQ_CFG_DONE
)

2548 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL1X_TOPOLOGY
(
schq
),

2549 (
∑ª¡_pf
->
é1_º_¥io
 << 1));

2554 i‡(!
rvu
->
hw
->
ˇp
.
nix_comm⁄_dwº_mtu
)

2555 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL1X_SCHEDULE
(
schq
),

2556 
TXSCH_TL1_DFLT_RR_QTM
);

2558 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL1X_SCHEDULE
(
schq
),

2559 
CN10K_MAX_DWRR_WEIGHT
);

2561 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL1X_CIR
(
schq
), 0x00);

2562 
pfvf_m≠
[
schq
] = 
	`TXSCH_SET_FLAG
’fvf_m≠[schq], 
NIX_TXSCHQ_CFG_DONE
);

2563 
	}
}

2568 
	#NIX_TX_SCHQ_MASK
 
	`GENMASK_ULL
(25, 0)

	)

2570 
	$nix_txschq_cfg_ªad
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

2571 
blkaddr
, 
nix_txschq_c⁄fig
 *
ªq
,

2572 
nix_txschq_c⁄fig
 *
r•
)

2574 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2575 
idx
, 
schq
;

2576 
u64
 
ªg
;

2578 
	`rvu_nix_txsch_lock
(
nix_hw
);

2579 
idx
 = 0; idx < 
ªq
->
num_ªgs
; idx++) {

2580 
ªg
 = 
ªq
->ªg[
idx
];

2581 
ªg
 &
NIX_TX_SCHQ_MASK
;

2582 
schq
 = 
	`TXSCHQ_IDX
(
ªg
, 
TXSCHQ_IDX_SHIFT
);

2583 i‡(!
	`rvu_check_vÆid_ªg
(
TXSCHQ_HWREGMAP
, 
ªq
->
lvl
, 
ªg
) ||

2584 !
	`is_vÆid_txschq
(
rvu
, 
blkaddr
, 
ªq
->
lvl
, 
pcifunc
, 
schq
)) {

2585 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

2586  
NIX_AF_INVAL_TXSCHQ_CFG
;

2588 
r•
->
ªgvÆ
[
idx
] = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
ªg
);

2590 
r•
->
lvl
 = 
ªq
->lvl;

2591 
r•
->
num_ªgs
 = 
ªq
->num_regs;

2592 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

2594 
	}
}

2596 
	$rvu_nix_tx_é2_cfg
(
rvu
 *rvu, 
blkaddr
, 
u16
 
pcifunc
,

2597 
nix_txsch
 *
txsch
, 
boﬁ
 
íabÀ
)

2599 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2600 
lbk_lök_°¨t
, 
lbk_löks
;

2601 
u8
 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

2602 
schq
;

2603 
u64
 
cfg
;

2605 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

2608 
cfg
 = 
íabÀ
 ? (
	`BIT_ULL
(12Ë| 
RVU_SWITCH_LBK_CHAN
) : 0;

2609 
lbk_lök_°¨t
 = 
hw
->
cgx_löks
;

2611 
schq
 = 0; schq < 
txsch
->schq.
max
; schq++) {

2612 i‡(
	`TXSCH_MAP_FUNC
(
txsch
->
pfvf_m≠
[
schq
]Ë!
pcifunc
)

2617 
lbk_löks
 = 
hw
->lbk_links;

2618 
lbk_löks
--)

2619 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2620 
	`NIX_AF_TL3_TL2X_LINKX_CFG
(
schq
,

2621 
lbk_lök_°¨t
 +

2622 
lbk_löks
), 
cfg
);

2624 
	}
}

2626 
	$rvu_mbox_h™dÀr_nix_txschq_cfg
(
rvu
 *rvu,

2627 
nix_txschq_c⁄fig
 *
ªq
,

2628 
nix_txschq_c⁄fig
 *
r•
)

2630 
u64
 
ªg
, 
vÆ
, 
ªgvÆ
, 
schq_ªgba£
, 
vÆ_mask
;

2631 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2632 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2633 
nix_txsch
 *
txsch
;

2634 
nix_hw
 *nix_hw;

2635 
blkaddr
, 
idx
, 
îr
;

2636 
nixlf
, 
schq
;

2637 
u32
 *
pfvf_m≠
;

2639 i‡(
ªq
->
lvl
 >
NIX_TXSCH_LVL_CNT
 ||

2640 
ªq
->
num_ªgs
 > 
MAX_REGS_PER_MBOX_MSG
)

2641  
NIX_AF_INVAL_TXSCHQ_CFG
;

2643 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

2644 i‡(
îr
)

2645  
îr
;

2647 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

2648 i‡(!
nix_hw
)

2649  
NIX_AF_ERR_INVALID_NIXBLK
;

2651 i‡(
ªq
->
ªad
)

2652  
	`nix_txschq_cfg_ªad
(
rvu
, 
nix_hw
, 
blkaddr
, 
ªq
, 
r•
);

2654 
txsch
 = &
nix_hw
->txsch[
ªq
->
lvl
];

2655 
pfvf_m≠
 = 
txsch
->pfvf_map;

2657 i‡(
ªq
->
lvl
 >
hw
->
ˇp
.
nix_tx_aggr_lvl
 &&

2658 
pcifunc
 & 
RVU_PFVF_FUNC_MASK
) {

2659 
	`muãx_lock
(&
rvu
->
r§c_lock
);

2660 i‡(
ªq
->
lvl
 =
NIX_TXSCH_LVL_TL1
)

2661 
	`nix_é1_deÁu…_cfg
(
rvu
, 
nix_hw
, 
pcifunc
, 
blkaddr
);

2662 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

2666 
	`rvu_nix_txsch_lock
(
nix_hw
);

2667 
idx
 = 0; idx < 
ªq
->
num_ªgs
; idx++) {

2668 
ªg
 = 
ªq
->ªg[
idx
];

2669 
ªg
 &
NIX_TX_SCHQ_MASK
;

2670 
ªgvÆ
 = 
ªq
->ªgvÆ[
idx
];

2671 
schq_ªgba£
 = 
ªg
 & 0xFFFF;

2672 
vÆ_mask
 = 
ªq
->
ªgvÆ_mask
[
idx
];

2674 i‡(!
	`is_txschq_hõørchy_vÆid
(
rvu
, 
pcifunc
, 
blkaddr
,

2675 
txsch
->
lvl
, 
ªg
, 
ªgvÆ
)) {

2676 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

2677  
NIX_AF_INVAL_TXSCHQ_CFG
;

2681 i‡(!
	`is_txschq_sh≠ög_vÆid
(
hw
, 
ªq
->
lvl
, 
ªg
))

2684 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
ªg
);

2685 
ªgvÆ
 = (
vÆ
 & 
vÆ_mask
) | (regval & ~val_mask);

2688 i‡(
hw
->
ˇp
.
nix_sh≠î_toggÀ_waô
 &&

2689 
	`h™dÀ_txschq_sh≠î_upd©e
(
rvu
, 
blkaddr
, 
nixlf
,

2690 
ªq
->
lvl
, 
ªg
, 
ªgvÆ
))

2694 i‡(
schq_ªgba£
 =
	`NIX_AF_SMQX_CFG
(0)) {

2695 
nixlf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
],

2696 
pcifunc
, 0);

2697 
ªgvÆ
 &= ~(0x7FULL << 24);

2698 
ªgvÆ
 |((
u64
)
nixlf
 << 24);

2702 i‡(!
hw
->
ˇp
.
nix_tx_lök_bp
) {

2703 i‡(
schq_ªgba£
 =
	`NIX_AF_TL4X_SDP_LINK_CFG
(0) ||

2704 (
schq_ªgba£
 & 0xFF00) ==

2705 
	`NIX_AF_TL3_TL2X_LINKX_CFG
(0, 0))

2706 
ªgvÆ
 &~
	`BIT_ULL
(13);

2710 i‡(
schq_ªgba£
 >
	`NIX_AF_TL1X_SCHEDULE
(0) &&

2711 
schq_ªgba£
 <
	`NIX_AF_TL1X_GREEN_BYTES
(0)) {

2712 
schq
 = 
	`TXSCHQ_IDX
(
ªg
, 
TXSCHQ_IDX_SHIFT
);

2713 
	`muãx_lock
(&
rvu
->
r§c_lock
);

2714 
pfvf_m≠
[
schq
] = 
	`TXSCH_SET_FLAG
(pfvf_map[schq],

2715 
NIX_TXSCHQ_CFG_DONE
);

2716 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

2722 i‡(
schq_ªgba£
 =
	`NIX_AF_SMQX_CFG
(0) &&

2723 (
ªgvÆ
 & 
	`BIT_ULL
(49))) {

2724 
schq
 = 
	`TXSCHQ_IDX
(
ªg
, 
TXSCHQ_IDX_SHIFT
);

2725 
	`nix_smq_Êush
(
rvu
, 
blkaddr
, 
schq
, 
pcifunc
, 
nixlf
);

2726 
ªgvÆ
 &~
	`BIT_ULL
(49);

2728 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªg
, 
ªgvÆ
);

2731 
	`rvu_nix_txsch_c⁄fig_ch™ged
(
nix_hw
);

2732 
	`rvu_nix_txsch_u∆ock
(
nix_hw
);

2734 
	}
}

2736 
	$nix_rx_vèg_cfg
(
rvu
 *rvu, 
nixlf
, 
blkaddr
,

2737 
nix_vèg_c⁄fig
 *
ªq
)

2739 
u64
 
ªgvÆ
 = 
ªq
->
vèg_size
;

2741 i‡(
ªq
->
rx
.
vèg_ty≥
 > 
NIX_AF_LFX_RX_VTAG_TYPE7
 ||

2742 
ªq
->
vèg_size
 > 
VTAGSIZE_T8
)

2743  -
EINVAL
;

2746 i‡(
ªq
->
rx
.
vèg_ty≥
 >
NIX_AF_LFX_RX_VTAG_TYPE6
)

2747  
NIX_AF_ERR_RX_VTAG_INUSE
;

2749 i‡(
ªq
->
rx
.
ˇ±uª_vèg
)

2750 
ªgvÆ
 |
	`BIT_ULL
(5);

2751 i‡(
ªq
->
rx
.
°rù_vèg
)

2752 
ªgvÆ
 |
	`BIT_ULL
(4);

2754 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2755 
	`NIX_AF_LFX_RX_VTAG_TYPEX
(
nixlf
, 
ªq
->
rx
.
vèg_ty≥
), 
ªgvÆ
);

2757 
	}
}

2759 
	$nix_tx_vèg_‰ì
(
rvu
 *rvu, 
blkaddr
,

2760 
u16
 
pcifunc
, 
ödex
)

2762 
nix_hw
 *nix_hw = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

2763 
nix_txvœn
 *
vœn
;

2765 i‡(!
nix_hw
)

2766  
NIX_AF_ERR_INVALID_NIXBLK
;

2768 
vœn
 = &
nix_hw
->
txvœn
;

2769 i‡(
vœn
->
íåy2pfvf_m≠
[
ödex
] !
pcifunc
)

2770  
NIX_AF_ERR_PARAM
;

2772 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2773 
	`NIX_AF_TX_VTAG_DEFX_DATA
(
ödex
), 0x0ull);

2774 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2775 
	`NIX_AF_TX_VTAG_DEFX_CTL
(
ödex
), 0x0ull);

2777 
vœn
->
íåy2pfvf_m≠
[
ödex
] = 0;

2778 
	`rvu_‰ì_r§c
(&
vœn
->
r§c
, 
ödex
);

2781 
	}
}

2783 
	$nix_‰ì_tx_vèg_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
)

2785 
nix_txvœn
 *
vœn
;

2786 
nix_hw
 *nix_hw;

2787 
ödex
, 
blkaddr
;

2789 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

2790 i‡(
blkaddr
 < 0)

2793 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

2794 i‡(!
nix_hw
)

2797 
vœn
 = &
nix_hw
->
txvœn
;

2799 
	`muãx_lock
(&
vœn
->
r§c_lock
);

2801 
ödex
 = 0; index < 
vœn
->
r§c
.
max
; index++) {

2802 i‡(
vœn
->
íåy2pfvf_m≠
[
ödex
] =
pcifunc
)

2803 
	`nix_tx_vèg_‰ì
(
rvu
, 
blkaddr
, 
pcifunc
, 
ödex
);

2805 
	`muãx_u∆ock
(&
vœn
->
r§c_lock
);

2806 
	}
}

2808 
	$nix_tx_vèg_Æloc
(
rvu
 *rvu, 
blkaddr
,

2809 
u64
 
vèg
, 
u8
 
size
)

2811 
nix_hw
 *nix_hw = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

2812 
nix_txvœn
 *
vœn
;

2813 
u64
 
ªgvÆ
;

2814 
ödex
;

2816 i‡(!
nix_hw
)

2817  
NIX_AF_ERR_INVALID_NIXBLK
;

2819 
vœn
 = &
nix_hw
->
txvœn
;

2821 
	`muãx_lock
(&
vœn
->
r§c_lock
);

2823 
ödex
 = 
	`rvu_Æloc_r§c
(&
vœn
->
r§c
);

2824 i‡(
ödex
 < 0) {

2825 
	`muãx_u∆ock
(&
vœn
->
r§c_lock
);

2826  
ödex
;

2829 
	`muãx_u∆ock
(&
vœn
->
r§c_lock
);

2831 
ªgvÆ
 = 
size
 ? 
vèg
 : vtag << 32;

2833 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2834 
	`NIX_AF_TX_VTAG_DEFX_DATA
(
ödex
), 
ªgvÆ
);

2835 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2836 
	`NIX_AF_TX_VTAG_DEFX_CTL
(
ödex
), 
size
);

2838  
ödex
;

2839 
	}
}

2841 
	$nix_tx_vèg_decfg
(
rvu
 *rvu, 
blkaddr
,

2842 
nix_vèg_c⁄fig
 *
ªq
)

2844 
nix_hw
 *nix_hw = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

2845 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2846 
idx0
 = 
ªq
->
tx
.
vèg0_idx
;

2847 
idx1
 = 
ªq
->
tx
.
vèg1_idx
;

2848 
nix_txvœn
 *
vœn
;

2849 
îr
 = 0;

2851 i‡(!
nix_hw
)

2852  
NIX_AF_ERR_INVALID_NIXBLK
;

2854 
vœn
 = &
nix_hw
->
txvœn
;

2855 i‡(
ªq
->
tx
.
‰ì_vèg0
 &&Ñeq->tx.
‰ì_vèg1
)

2856 i‡(
vœn
->
íåy2pfvf_m≠
[
idx0
] !
pcifunc
 ||

2857 
vœn
->
íåy2pfvf_m≠
[
idx1
] !
pcifunc
)

2858  
NIX_AF_ERR_PARAM
;

2860 
	`muãx_lock
(&
vœn
->
r§c_lock
);

2862 i‡(
ªq
->
tx
.
‰ì_vèg0
) {

2863 
îr
 = 
	`nix_tx_vèg_‰ì
(
rvu
, 
blkaddr
, 
pcifunc
, 
idx0
);

2864 i‡(
îr
)

2865 
exô
;

2868 i‡(
ªq
->
tx
.
‰ì_vèg1
)

2869 
îr
 = 
	`nix_tx_vèg_‰ì
(
rvu
, 
blkaddr
, 
pcifunc
, 
idx1
);

2871 
exô
:

2872 
	`muãx_u∆ock
(&
vœn
->
r§c_lock
);

2873  
îr
;

2874 
	}
}

2876 
	$nix_tx_vèg_cfg
(
rvu
 *rvu, 
blkaddr
,

2877 
nix_vèg_c⁄fig
 *
ªq
,

2878 
nix_vèg_c⁄fig_r•
 *
r•
)

2880 
nix_hw
 *nix_hw = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

2881 
nix_txvœn
 *
vœn
;

2882 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2884 i‡(!
nix_hw
)

2885  
NIX_AF_ERR_INVALID_NIXBLK
;

2887 
vœn
 = &
nix_hw
->
txvœn
;

2888 i‡(
ªq
->
tx
.
cfg_vèg0
) {

2889 
r•
->
vèg0_idx
 =

2890 
	`nix_tx_vèg_Æloc
(
rvu
, 
blkaddr
,

2891 
ªq
->
tx
.
vèg0
,Ñeq->
vèg_size
);

2893 i‡(
r•
->
vèg0_idx
 < 0)

2894  
NIX_AF_ERR_TX_VTAG_NOSPC
;

2896 
vœn
->
íåy2pfvf_m≠
[
r•
->
vèg0_idx
] = 
pcifunc
;

2899 i‡(
ªq
->
tx
.
cfg_vèg1
) {

2900 
r•
->
vèg1_idx
 =

2901 
	`nix_tx_vèg_Æloc
(
rvu
, 
blkaddr
,

2902 
ªq
->
tx
.
vèg1
,Ñeq->
vèg_size
);

2904 i‡(
r•
->
vèg1_idx
 < 0)

2905 
îr_‰ì
;

2907 
vœn
->
íåy2pfvf_m≠
[
r•
->
vèg1_idx
] = 
pcifunc
;

2912 
îr_‰ì
:

2913 i‡(
ªq
->
tx
.
cfg_vèg0
)

2914 
	`nix_tx_vèg_‰ì
(
rvu
, 
blkaddr
, 
pcifunc
, 
r•
->
vèg0_idx
);

2916  
NIX_AF_ERR_TX_VTAG_NOSPC
;

2917 
	}
}

2919 
	$rvu_mbox_h™dÀr_nix_vèg_cfg
(
rvu
 *rvu,

2920 
nix_vèg_c⁄fig
 *
ªq
,

2921 
nix_vèg_c⁄fig_r•
 *
r•
)

2923 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2924 
blkaddr
, 
nixlf
, 
îr
;

2926 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

2927 i‡(
îr
)

2928  
îr
;

2930 i‡(
ªq
->
cfg_ty≥
) {

2932 
îr
 = 
	`nix_rx_vèg_cfg
(
rvu
, 
nixlf
, 
blkaddr
, 
ªq
);

2933 i‡(
îr
)

2934  
NIX_AF_ERR_PARAM
;

2937 i‡((
ªq
->
tx
.
cfg_vèg0
 ||Ñeq->tx.
cfg_vèg1
) &&

2938 (
ªq
->
tx
.
‰ì_vèg0
 ||Ñeq->tx.
‰ì_vèg1
))

2939  
NIX_AF_ERR_PARAM
;

2941 i‡(
ªq
->
tx
.
cfg_vèg0
 ||Ñeq->tx.
cfg_vèg1
)

2942  
	`nix_tx_vèg_cfg
(
rvu
, 
blkaddr
, 
ªq
, 
r•
);

2944 i‡(
ªq
->
tx
.
‰ì_vèg0
 ||Ñeq->tx.
‰ì_vèg1
)

2945  
	`nix_tx_vèg_decfg
(
rvu
, 
blkaddr
, 
ªq
);

2949 
	}
}

2951 
	$nix_blk_£tup_m˚
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

2952 
m˚
, 
u8
 
›
, 
u16
 
pcifunc
, 
√xt
, 
boﬁ
 
eﬁ
)

2954 
nix_aq_íq_ªq
 
aq_ªq
;

2955 
îr
;

2957 
aq_ªq
.
hdr
.
pcifunc
 = 0;

2958 
aq_ªq
.
˘y≥
 = 
NIX_AQ_CTYPE_MCE
;

2959 
aq_ªq
.
›
 = op;

2960 
aq_ªq
.
qidx
 = 
m˚
;

2963 
aq_ªq
.
m˚
.
›
 = 1;

2964 
aq_ªq
.
m˚
.
ödex
 = 0;

2965 
aq_ªq
.
m˚
.
eﬁ
 =Éol;

2966 
aq_ªq
.
m˚
.
pf_func
 = 
pcifunc
;

2967 
aq_ªq
.
m˚
.
√xt
 =Çext;

2970 *(
u64
 *)(&
aq_ªq
.
m˚_mask
) = ~0ULL;

2972 
îr
 = 
	`rvu_nix_blk_aq_íq_ö°
(
rvu
, 
nix_hw
, &
aq_ªq
, 
NULL
);

2973 i‡(
îr
) {

2974 
	`dev_îr
(
rvu
->
dev
, "FailedÅo setup Bcast MCE for PF%d:VF%d\n",

2975 
	`rvu_gë_pf
(
pcifunc
),Öcifun¯& 
RVU_PFVF_FUNC_MASK
);

2976  
îr
;

2979 
	}
}

2981 
	$nix_upd©e_m˚_li°_íåy
(
nix_m˚_li°
 *
m˚_li°
,

2982 
u16
 
pcifunc
, 
boﬁ
 
add
)

2984 
m˚
 *m˚, *
èû
 = 
NULL
;

2985 
boﬁ
 
dñëe
 = 
Ál£
;

2988 
	`hli°_f‹_óch_íåy
(
m˚
, &
m˚_li°
->
hód
, 
node
) {

2990 i‡(
m˚
->
pcifunc
 =pcifun¯&& !
add
) {

2991 
dñëe
 = 
åue
;

2993 } i‡(
m˚
->
pcifunc
 =pcifun¯&& 
add
) {

2997 
èû
 = 
m˚
;

3000 i‡(
dñëe
) {

3001 
	`hli°_dñ
(&
m˚
->
node
);

3002 
	`k‰ì
(
m˚
);

3003 
m˚_li°
->
cou¡
--;

3007 i‡(!
add
)

3011 
m˚
 = 
	`kzÆloc
((*m˚), 
GFP_KERNEL
);

3012 i‡(!
m˚
)

3013  -
ENOMEM
;

3014 
m˚
->
pcifunc
 =Öcifunc;

3015 i‡(!
èû
)

3016 
	`hli°_add_hód
(&
m˚
->
node
, &
m˚_li°
->
hód
);

3018 
	`hli°_add_behöd
(&
m˚
->
node
, &
èû
->node);

3019 
m˚_li°
->
cou¡
++;

3021 
	}
}

3023 
	$nix_upd©e_m˚_li°
(
rvu
 *rvu, 
u16
 
pcifunc
,

3024 
nix_m˚_li°
 *
m˚_li°
,

3025 
m˚_idx
, 
mˇm_ödex
, 
boﬁ
 
add
)

3027 
îr
 = 0, 
idx
, 
√xt_idx
, 
œ°_idx
, 
blkaddr
, 
≈c_blkaddr
;

3028 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

3029 
nix_mˇ°
 *
mˇ°
;

3030 
nix_hw
 *nix_hw;

3031 
m˚
 *mce;

3033 i‡(!
m˚_li°
)

3034  -
EINVAL
;

3037 
idx
 = 
m˚_idx
 + (
pcifunc
 & 
RVU_PFVF_FUNC_MASK
);

3039 i‡(
idx
 > (
m˚_idx
 + 
m˚_li°
->
max
)) {

3040 
	`dev_îr
(
rvu
->
dev
,

3042 
__func__
, 
idx
, 
m˚_li°
->
max
,

3043 
pcifunc
 >> 
RVU_PFVF_PF_SHIFT
);

3044  -
EINVAL
;

3047 
îr
 = 
	`nix_gë_°ru˘_±rs
(
rvu
, 
pcifunc
, &
nix_hw
, &
blkaddr
);

3048 i‡(
îr
)

3049  
îr
;

3051 
mˇ°
 = &
nix_hw
->mcast;

3052 
	`muãx_lock
(&
mˇ°
->
m˚_lock
);

3054 
îr
 = 
	`nix_upd©e_m˚_li°_íåy
(
m˚_li°
, 
pcifunc
, 
add
);

3055 i‡(
îr
)

3056 
íd
;

3059 i‡(!
m˚_li°
->
cou¡
) {

3060 
≈c_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

3061 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
≈c_blkaddr
, 
mˇm_ödex
, 
Ál£
);

3062 
íd
;

3066 
idx
 = 
m˚_idx
;

3067 
œ°_idx
 = 
idx
 + 
m˚_li°
->
cou¡
 - 1;

3068 
	`hli°_f‹_óch_íåy
(
m˚
, &
m˚_li°
->
hód
, 
node
) {

3069 i‡(
idx
 > 
œ°_idx
)

3072 
√xt_idx
 = 
idx
 + 1;

3074 
îr
 = 
	`nix_blk_£tup_m˚
(
rvu
, 
nix_hw
, 
idx
, 
NIX_AQ_INSTOP_WRITE
,

3075 
m˚
->
pcifunc
, 
√xt_idx
,

3076 (
√xt_idx
 > 
œ°_idx
Ë? 
åue
 : 
Ál£
);

3077 i‡(
îr
)

3078 
íd
;

3079 
idx
++;

3082 
íd
:

3083 
	`muãx_u∆ock
(&
mˇ°
->
m˚_lock
);

3084  
îr
;

3085 
	}
}

3087 
	$nix_gë_m˚_li°
(
rvu
 *rvu, 
u16
 
pcifunc
, 
ty≥
,

3088 
nix_m˚_li°
 **
m˚_li°
, *
m˚_idx
)

3090 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

3091 
rvu_pfvf
 *
pfvf
;

3093 i‡(!
hw
->
ˇp
.
nix_rx_mu…iˇ°
 ||

3094 !
	`is_pf_cgxm≠≥d
(
rvu
, 
	`rvu_gë_pf
(
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
))) {

3095 *
m˚_li°
 = 
NULL
;

3096 *
m˚_idx
 = 0;

3101 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
);

3103 i‡(
ty≥
 =
NIXLF_BCAST_ENTRY
) {

3104 *
m˚_li°
 = &
pfvf
->
bˇ°_m˚_li°
;

3105 *
m˚_idx
 = 
pfvf
->
bˇ°_m˚_idx
;

3106 } i‡(
ty≥
 =
NIXLF_ALLMULTI_ENTRY
) {

3107 *
m˚_li°
 = &
pfvf
->
mˇ°_m˚_li°
;

3108 *
m˚_idx
 = 
pfvf
->
mˇ°_m˚_idx
;

3109 } i‡(
ty≥
 =
NIXLF_PROMISC_ENTRY
) {

3110 *
m˚_li°
 = &
pfvf
->
¥omisc_m˚_li°
;

3111 *
m˚_idx
 = 
pfvf
->
¥omisc_m˚_idx
;

3113 *
m˚_li°
 = 
NULL
;

3114 *
m˚_idx
 = 0;

3116 
	}
}

3118 
	$nix_upd©e_m˚_ruÀ
(
rvu
 *rvu, 
u16
 
pcifunc
,

3119 
ty≥
, 
boﬁ
 
add
)

3121 
îr
 = 0, 
nixlf
, 
blkaddr
, 
mˇm_ödex
, 
m˚_idx
;

3122 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

3123 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

3124 
nix_m˚_li°
 *
m˚_li°
;

3125 
pf
;

3128 i‡(
	`is_afvf
(
pcifunc
Ë|| 
	`is_sdp_pfvf
(pcifunc))

3131 i‡(!
hw
->
ˇp
.
nix_rx_mu…iˇ°
)

3134 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

3135 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

3138 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

3139 i‡(
blkaddr
 < 0)

3140  -
EINVAL
;

3142 
nixlf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

3143 i‡(
nixlf
 < 0)

3144  -
EINVAL
;

3146 
	`nix_gë_m˚_li°
(
rvu
, 
pcifunc
, 
ty≥
, &
m˚_li°
, &
m˚_idx
);

3148 
mˇm_ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
,

3149 
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
,

3150 
nixlf
, 
ty≥
);

3151 
îr
 = 
	`nix_upd©e_m˚_li°
(
rvu
, 
pcifunc
, 
m˚_li°
,

3152 
m˚_idx
, 
mˇm_ödex
, 
add
);

3153  
îr
;

3154 
	}
}

3156 
	$nix_£tup_m˚_èbÀs
(
rvu
 *rvu, 
nix_hw
 *nix_hw)

3158 
nix_mˇ°
 *
mˇ°
 = &
nix_hw
->mcast;

3159 
îr
, 
pf
, 
numvfs
, 
idx
;

3160 
rvu_pfvf
 *
pfvf
;

3161 
u16
 
pcifunc
;

3162 
u64
 
cfg
;

3165 
pf
 = 1;Ö‡< (
rvu
->
cgx_m≠≥d_pfs
 + 1);Öf++) {

3166 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_RVUM
, 
	`RVU_PRIV_PFX_CFG
(
pf
));

3168 i‡(!((
cfg
 >> 20) & 0x01))

3171 
numvfs
 = (
cfg
 >> 12) & 0xFF;

3173 
pfvf
 = &
rvu
->
pf
[pf];

3176 i‡(
pfvf
->
nix_blkaddr
 !
nix_hw
->
blkaddr
)

3180 
pfvf
->
bˇ°_m˚_idx
 = 
	`nix_Æloc_m˚_li°
(
mˇ°
, 
numvfs
 + 1);

3181 
	`nix_m˚_li°_öô
(&
pfvf
->
bˇ°_m˚_li°
, 
numvfs
 + 1);

3184 
pfvf
->
mˇ°_m˚_idx
 = 
	`nix_Æloc_m˚_li°
(
mˇ°
, 
numvfs
 + 1);

3185 
	`nix_m˚_li°_öô
(&
pfvf
->
mˇ°_m˚_li°
, 
numvfs
 + 1);

3188 
pfvf
->
¥omisc_m˚_idx
 = 
	`nix_Æloc_m˚_li°
(
mˇ°
, 
numvfs
 + 1);

3189 
	`nix_m˚_li°_öô
(&
pfvf
->
¥omisc_m˚_li°
, 
numvfs
 + 1);

3191 
idx
 = 0; idx < (
numvfs
 + 1); idx++) {

3193 
pcifunc
 = (
pf
 << 
RVU_PFVF_PF_SHIFT
);

3194 
pcifunc
 |
idx
;

3200 
îr
 = 
	`nix_blk_£tup_m˚
(
rvu
, 
nix_hw
,

3201 
pfvf
->
bˇ°_m˚_idx
 + 
idx
,

3202 
NIX_AQ_INSTOP_INIT
,

3203 
pcifunc
, 0, 
åue
);

3204 i‡(
îr
)

3205  
îr
;

3208 
îr
 = 
	`nix_blk_£tup_m˚
(
rvu
, 
nix_hw
,

3209 
pfvf
->
mˇ°_m˚_idx
 + 
idx
,

3210 
NIX_AQ_INSTOP_INIT
,

3211 
pcifunc
, 0, 
åue
);

3212 i‡(
îr
)

3213  
îr
;

3216 
îr
 = 
	`nix_blk_£tup_m˚
(
rvu
, 
nix_hw
,

3217 
pfvf
->
¥omisc_m˚_idx
 + 
idx
,

3218 
NIX_AQ_INSTOP_INIT
,

3219 
pcifunc
, 0, 
åue
);

3220 i‡(
îr
)

3221  
îr
;

3225 
	}
}

3227 
	$nix_£tup_mˇ°
(
rvu
 *rvu, 
nix_hw
 *nix_hw, 
blkaddr
)

3229 
nix_mˇ°
 *
mˇ°
 = &
nix_hw
->mcast;

3230 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

3231 
îr
, 
size
;

3233 
size
 = (
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST3
) >> 16) & 0x0F;

3234 
size
 = (1ULL << size);

3237 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
mˇ°
->
m˚_˘x
,

3238 (256UL << 
MC_TBL_SIZE
), 
size
);

3239 i‡(
îr
)

3240  -
ENOMEM
;

3242 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_MCAST_BASE
,

3243 (
u64
)
mˇ°
->
m˚_˘x
->
iova
);

3246 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_MCAST_CFG
,

3247 
	`BIT_ULL
(36Ë| (
hw
->
max_vfs_≥r_pf
 << 4Ë| 
MC_TBL_SIZE
);

3250 
size
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_MC_MIRROR_CONST
) & 0xFFFF;

3251 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
mˇ°
->
mˇ°_buf
,

3252 (8UL << 
MC_BUF_CNT
), 
size
);

3253 i‡(
îr
)

3254  -
ENOMEM
;

3256 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_MCAST_BUF_BASE
,

3257 (
u64
)
mˇ°
->
mˇ°_buf
->
iova
);

3260 
mˇ°
->
ª∂ay_pköd
 = 
	`rvu_Æloc_r§c
(&
hw
->
pköd
.
r§c
);

3262 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_MCAST_BUF_CFG
,

3263 
	`BIT_ULL
(63Ë| (
mˇ°
->
ª∂ay_pköd
 << 24) |

3264 
	`BIT_ULL
(20Ë| 
MC_BUF_CNT
);

3266 
	`muãx_öô
(&
mˇ°
->
m˚_lock
);

3268  
	`nix_£tup_m˚_èbÀs
(
rvu
, 
nix_hw
);

3269 
	}
}

3271 
	$nix_£tup_txvœn
(
rvu
 *rvu, 
nix_hw
 *nix_hw)

3273 
nix_txvœn
 *
vœn
 = &
nix_hw
->
txvœn
;

3274 
îr
;

3277 
vœn
->
r§c
.
max
 = 
NIX_TX_VTAG_DEF_MAX
;

3278 
îr
 = 
	`rvu_Æloc_bôm≠
(&
vœn
->
r§c
);

3279 i‡(
îr
)

3280  -
ENOMEM
;

3283 
vœn
->
íåy2pfvf_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, vœn->
r§c
.
max
,

3284 (
u16
), 
GFP_KERNEL
);

3285 i‡(!
vœn
->
íåy2pfvf_m≠
)

3286 
‰ì_mem
;

3288 
	`muãx_öô
(&
vœn
->
r§c_lock
);

3291 
‰ì_mem
:

3292 
	`k‰ì
(
vœn
->
r§c
.
bm≠
);

3293  -
ENOMEM
;

3294 
	}
}

3296 
	$nix_£tup_txschq
(
rvu
 *rvu, 
nix_hw
 *nix_hw, 
blkaddr
)

3298 
nix_txsch
 *
txsch
;

3299 
îr
, 
lvl
, 
schq
;

3300 
u64
 
cfg
, 
ªg
;

3305 
lvl
 = 0;Üv»< 
NIX_TXSCH_LVL_CNT
;Üvl++) {

3306 
txsch
 = &
nix_hw
->txsch[
lvl
];

3307 
txsch
->
lvl
 =Üvl;

3308 
lvl
) {

3309 
NIX_TXSCH_LVL_SMQ
:

3310 
ªg
 = 
NIX_AF_MDQ_CONST
;

3312 
NIX_TXSCH_LVL_TL4
:

3313 
ªg
 = 
NIX_AF_TL4_CONST
;

3315 
NIX_TXSCH_LVL_TL3
:

3316 
ªg
 = 
NIX_AF_TL3_CONST
;

3318 
NIX_TXSCH_LVL_TL2
:

3319 
ªg
 = 
NIX_AF_TL2_CONST
;

3321 
NIX_TXSCH_LVL_TL1
:

3322 
ªg
 = 
NIX_AF_TL1_CONST
;

3325 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
ªg
);

3326 
txsch
->
schq
.
max
 = 
cfg
 & 0xFFFF;

3327 
îr
 = 
	`rvu_Æloc_bôm≠
(&
txsch
->
schq
);

3328 i‡(
îr
)

3329  
îr
;

3334 
txsch
->
pfvf_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
,Åxsch->
schq
.
max
,

3335 (
u32
), 
GFP_KERNEL
);

3336 i‡(!
txsch
->
pfvf_m≠
)

3337  -
ENOMEM
;

3338 
schq
 = 0; schq < 
txsch
->schq.
max
; schq++)

3339 
txsch
->
pfvf_m≠
[
schq
] = 
	`TXSCH_MAP
(0, 
NIX_TXSCHQ_FREE
);

3343 i‡(
rvu
->
hw
->
ˇp
.
nix_comm⁄_dwº_mtu
 ||

3344 
rvu
->
hw
->
ˇp
.
nix_mu…ùÀ_dwº_mtu
) {

3345 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

3346 
	`nix_gë_dwº_mtu_ªg
(
rvu
->
hw
, 
SMQ_LINK_TYPE_RPM
),

3347 
	`c⁄vît_byãs_to_dwº_mtu
(8192));

3348 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

3349 
	`nix_gë_dwº_mtu_ªg
(
rvu
->
hw
, 
SMQ_LINK_TYPE_LBK
),

3350 
	`c⁄vît_byãs_to_dwº_mtu
(8192));

3351 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

3352 
	`nix_gë_dwº_mtu_ªg
(
rvu
->
hw
, 
SMQ_LINK_TYPE_SDP
),

3353 
	`c⁄vît_byãs_to_dwº_mtu
(8192));

3357 
	}
}

3359 
	$rvu_nix_ª£rve_m¨k_f‹m©
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

3360 
blkaddr
, 
u32
 
cfg
)

3362 
fmt_idx
;

3364 
fmt_idx
 = 0; fmt_idx < 
nix_hw
->
m¨k_f‹m©
.
ö_u£
; fmt_idx++) {

3365 i‡(
nix_hw
->
m¨k_f‹m©
.
cfg
[
fmt_idx
] == cfg)

3366  
fmt_idx
;

3368 i‡(
fmt_idx
 >
nix_hw
->
m¨k_f‹m©
.
tŸÆ
)

3369  -
ERANGE
;

3371 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_MARK_FORMATX_CTL
(
fmt_idx
), 
cfg
);

3372 
nix_hw
->
m¨k_f‹m©
.
cfg
[
fmt_idx
] = cfg;

3373 
nix_hw
->
m¨k_f‹m©
.
ö_u£
++;

3374  
fmt_idx
;

3375 
	}
}

3377 
	$nix_af_m¨k_f‹m©_£tup
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

3378 
blkaddr
)

3380 
u64
 
cfgs
[] = {

3381 [
NIX_MARK_CFG_IP_DSCP_RED
] = 0x10003,

3382 [
NIX_MARK_CFG_IP_DSCP_YELLOW
] = 0x11200,

3383 [
NIX_MARK_CFG_IP_DSCP_YELLOW_RED
] = 0x11203,

3384 [
NIX_MARK_CFG_IP_ECN_RED
] = 0x6000c,

3385 [
NIX_MARK_CFG_IP_ECN_YELLOW
] = 0x60c00,

3386 [
NIX_MARK_CFG_IP_ECN_YELLOW_RED
] = 0x60c0c,

3387 [
NIX_MARK_CFG_VLAN_DEI_RED
] = 0x30008,

3388 [
NIX_MARK_CFG_VLAN_DEI_YELLOW
] = 0x30800,

3389 [
NIX_MARK_CFG_VLAN_DEI_YELLOW_RED
] = 0x30808,

3391 
i
, 
rc
;

3392 
u64
 
tŸÆ
;

3394 
tŸÆ
 = (
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_PSE_CONST
) & 0xFF00) >> 8;

3395 
nix_hw
->
m¨k_f‹m©
.
tŸÆ
 = (
u8
)total;

3396 
nix_hw
->
m¨k_f‹m©
.
cfg
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
tŸÆ
, (
u32
),

3397 
GFP_KERNEL
);

3398 i‡(!
nix_hw
->
m¨k_f‹m©
.
cfg
)

3399  -
ENOMEM
;

3400 
i
 = 0; i < 
NIX_MARK_CFG_MAX
; i++) {

3401 
rc
 = 
	`rvu_nix_ª£rve_m¨k_f‹m©
(
rvu
, 
nix_hw
, 
blkaddr
, 
cfgs
[
i
]);

3402 i‡(
rc
 < 0)

3403 
	`dev_îr
(
rvu
->
dev
, "Err %d in setup mark format %d\n",

3404 
i
, 
rc
);

3408 
	}
}

3410 
	$rvu_gë_lbk_lök_max_‰s
(
rvu
 *rvu, 
u16
 *
max_mtu
)

3413 i‡(
rvu
->
hw
->
lbk_bufsize
 == 0x12000)

3414 *
max_mtu
 = 
CN10K_LBK_LINK_MAX_FRS
;

3416 *
max_mtu
 = 
NIC_HW_MAX_FRS
;

3417 
	}
}

3419 
	$rvu_gë_lmac_lök_max_‰s
(
rvu
 *rvu, 
u16
 *
max_mtu
)

3421 
fifo_size
 = 
	`rvu_cgx_gë_fifﬁí
(
rvu
);

3426 i‡(
fifo_size
 == 0x20000 || fifo_size == 0x40000)

3427 *
max_mtu
 = 
CN10K_LMAC_LINK_MAX_FRS
;

3429 *
max_mtu
 = 
NIC_HW_MAX_FRS
;

3430 
	}
}

3432 
	$rvu_mbox_h™dÀr_nix_gë_hw_öfo
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

3433 
nix_hw_öfo
 *
r•
)

3435 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

3436 
u64
 
dwº_mtu
;

3437 
blkaddr
;

3439 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

3440 i‡(
blkaddr
 < 0)

3441  
NIX_AF_ERR_AF_LF_INVALID
;

3443 
r•
->
vwqe_dñay
 = 0;

3444 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

3445 
r•
->
vwqe_dñay
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_VWQE_TIMER
) &

3446 
	`GENMASK_ULL
(9, 0);

3448 i‡(
	`is_afvf
(
pcifunc
))

3449 
	`rvu_gë_lbk_lök_max_‰s
(
rvu
, &
r•
->
max_mtu
);

3451 
	`rvu_gë_lmac_lök_max_‰s
(
rvu
, &
r•
->
max_mtu
);

3453 
r•
->
mö_mtu
 = 
NIC_HW_MIN_FRS
;

3455 i‡(!
rvu
->
hw
->
ˇp
.
nix_comm⁄_dwº_mtu
 &&

3456 !
rvu
->
hw
->
ˇp
.
nix_mu…ùÀ_dwº_mtu
) {

3458 
r•
->
Ωm_dwº_mtu
 = 1;

3459 
r•
->
sdp_dwº_mtu
 = 1;

3460 
r•
->
lbk_dwº_mtu
 = 1;

3465 
dwº_mtu
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3466 
	`nix_gë_dwº_mtu_ªg
(
rvu
->
hw
, 
SMQ_LINK_TYPE_RPM
));

3467 
r•
->
Ωm_dwº_mtu
 = 
	`c⁄vît_dwº_mtu_to_byãs
(
dwº_mtu
);

3469 
dwº_mtu
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3470 
	`nix_gë_dwº_mtu_ªg
(
rvu
->
hw
, 
SMQ_LINK_TYPE_SDP
));

3471 
r•
->
sdp_dwº_mtu
 = 
	`c⁄vît_dwº_mtu_to_byãs
(
dwº_mtu
);

3473 
dwº_mtu
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

3474 
	`nix_gë_dwº_mtu_ªg
(
rvu
->
hw
, 
SMQ_LINK_TYPE_LBK
));

3475 
r•
->
lbk_dwº_mtu
 = 
	`c⁄vît_dwº_mtu_to_byãs
(
dwº_mtu
);

3478 
	}
}

3480 
	$rvu_mbox_h™dÀr_nix_°©s_r°
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

3481 
msg_r•
 *
r•
)

3483 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

3484 
i
, 
nixlf
, 
blkaddr
, 
îr
;

3485 
u64
 
°©s
;

3487 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

3488 i‡(
îr
)

3489  
îr
;

3492 
°©s
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST1
);

3495 
i
 = 0; i < ((
°©s
 >> 24) & 0xFF); i++)

3496 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_STATX
(
nixlf
, 
i
), 0);

3499 
i
 = 0; i < ((
°©s
 >> 32) & 0xFF); i++)

3500 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_STATX
(
nixlf
, 
i
), 0);

3503 
	}
}

3506 
	$gë_Êowkey_Æg_idx
(
nix_hw
 *nix_hw, 
u32
 
Êow_cfg
)

3508 
i
;

3511 
i
 = 0; i < 
nix_hw
->
Êowkey
.
ö_u£
; i++)

3512 i‡(
nix_hw
->
Êowkey
.Êowkey[
i
] =
Êow_cfg
)

3513  
i
;

3515  -
ERANGE
;

3516 
	}
}

3518 
	$£t_Êowkey_fõlds
(
nix_rx_Êowkey_Æg
 *
Æg
, 
u32
 
Êow_cfg
)

3520 
idx
, 
ƒ_fõld
, 
key_off
, 
fõld_m¨kî
, 
keyoff_m¨kî
;

3521 
max_key_off
, 
max_bô_pos
, 
group_membî
;

3522 
nix_rx_Êowkey_Æg
 *
fõld
;

3523 
nix_rx_Êowkey_Æg
 
tmp
;

3524 
u32
 
key_ty≥
, 
vÆid_key
;

3525 
l4_key_off£t
 = 0;

3526 
u32
 
l3_l4_§c_d°
;

3528 i‡(!
Æg
)

3529  -
EINVAL
;

3531 
	#FIELDS_PER_ALG
 5

	)

3532 
	#MAX_KEY_OFF
 40

	)

3534 
	`mem£t
(
Æg
, 0, (
uöt64_t
Ë* 
FIELDS_PER_ALG
);

3558 
l3_l4_§c_d°
 = 
Êow_cfg
;

3560 
Êow_cfg
 &
NIX_FLOW_KEY_TYPE_L3_L4_MASK
;

3562 
keyoff_m¨kî
 = 0; 
max_key_off
 = 0; 
group_membî
 = 0;

3563 
ƒ_fõld
 = 0; 
key_off
 = 0; 
fõld_m¨kî
 = 1;

3564 
fõld
 = &
tmp
; 
max_bô_pos
 = 
	`Ês
(
Êow_cfg
);

3565 
idx
 = 0;

3566 
idx
 < 
max_bô_pos
 && 
ƒ_fõld
 < 
FIELDS_PER_ALG
 &&

3567 
key_off
 < 
MAX_KEY_OFF
; 
idx
++) {

3568 
key_ty≥
 = 
	`BIT
(
idx
);

3569 
vÆid_key
 = 
Êow_cfg
 & 
key_ty≥
;

3571 i‡(
fõld_m¨kî
)

3572 
	`mem£t
(&
tmp
, 0, (tmp));

3574 
fõld_m¨kî
 = 
åue
;

3575 
keyoff_m¨kî
 = 
åue
;

3576 
key_ty≥
) {

3577 
NIX_FLOW_KEY_TYPE_PORT
:

3578 
fõld
->
£l_ch™
 = 
åue
;

3580 
fõld
->
byãsm1
 = 1;

3582 
NIX_FLOW_KEY_TYPE_IPV4_PROTO
:

3583 
fõld
->
lid
 = 
NPC_LID_LC
;

3584 
fõld
->
hdr_off£t
 = 9;

3585 
fõld
->
byãsm1
 = 0;

3586 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LC_IP
;

3587 
fõld
->
…y≥_mask
 = 0xF;

3589 
NIX_FLOW_KEY_TYPE_IPV4
:

3590 
NIX_FLOW_KEY_TYPE_INNR_IPV4
:

3591 
fõld
->
lid
 = 
NPC_LID_LC
;

3592 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LC_IP
;

3593 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_IPV4
) {

3594 
fõld
->
lid
 = 
NPC_LID_LG
;

3595 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LG_TU_IP
;

3597 
fõld
->
hdr_off£t
 = 12;

3598 
fõld
->
byãsm1
 = 7;

3601 i‡(
l3_l4_§c_d°
 & 
NIX_FLOW_KEY_TYPE_L3_SRC_ONLY
)

3602 
fõld
->
byãsm1
 = 3;

3604 i‡(
l3_l4_§c_d°
 & 
NIX_FLOW_KEY_TYPE_L3_DST_ONLY
) {

3606 i‡(
fõld
->
byãsm1
 == 3) {

3607 
fõld
->
byãsm1
 = 7;

3610 
fõld
->
hdr_off£t
 = 16;

3611 
fõld
->
byãsm1
 = 3;

3615 
fõld
->
…y≥_mask
 = 0xF;

3616 
keyoff_m¨kî
 = 
Ál£
;

3618 
NIX_FLOW_KEY_TYPE_IPV6
:

3619 
NIX_FLOW_KEY_TYPE_INNR_IPV6
:

3620 
fõld
->
lid
 = 
NPC_LID_LC
;

3621 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LC_IP6
;

3622 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_IPV6
) {

3623 
fõld
->
lid
 = 
NPC_LID_LG
;

3624 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LG_TU_IP6
;

3626 
fõld
->
hdr_off£t
 = 8;

3627 
fõld
->
byãsm1
 = 31;

3630 i‡(
l3_l4_§c_d°
 & 
NIX_FLOW_KEY_TYPE_L3_SRC_ONLY
)

3631 
fõld
->
byãsm1
 = 15;

3633 i‡(
l3_l4_§c_d°
 & 
NIX_FLOW_KEY_TYPE_L3_DST_ONLY
) {

3635 i‡(
fõld
->
byãsm1
 == 15) {

3637 
fõld
->
byãsm1
 = 31;

3640 
fõld
->
hdr_off£t
 = 24;

3641 
fõld
->
byãsm1
 = 15;

3644 
fõld
->
…y≥_mask
 = 0xF;

3646 
NIX_FLOW_KEY_TYPE_TCP
:

3647 
NIX_FLOW_KEY_TYPE_UDP
:

3648 
NIX_FLOW_KEY_TYPE_SCTP
:

3649 
NIX_FLOW_KEY_TYPE_INNR_TCP
:

3650 
NIX_FLOW_KEY_TYPE_INNR_UDP
:

3651 
NIX_FLOW_KEY_TYPE_INNR_SCTP
:

3652 
fõld
->
lid
 = 
NPC_LID_LD
;

3653 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_TCP
 ||

3654 
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_UDP
 ||

3655 
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_SCTP
)

3656 
fõld
->
lid
 = 
NPC_LID_LH
;

3657 
fõld
->
byãsm1
 = 3;

3659 i‡(
l3_l4_§c_d°
 & 
NIX_FLOW_KEY_TYPE_L4_SRC_ONLY
)

3660 
fõld
->
byãsm1
 = 1;

3662 i‡(
l3_l4_§c_d°
 & 
NIX_FLOW_KEY_TYPE_L4_DST_ONLY
) {

3664 i‡(
fõld
->
byãsm1
 == 1) {

3666 
fõld
->
byãsm1
 = 3;

3669 
fõld
->
hdr_off£t
 = 2;

3670 
fõld
->
byãsm1
 = 1;

3678 
	`BUILD_BUG_ON
(()
NPC_LT_LD_TCP
 !=

3679 ()
NPC_LT_LH_TU_TCP
);

3680 
	`BUILD_BUG_ON
(()
NPC_LT_LD_UDP
 !=

3681 ()
NPC_LT_LH_TU_UDP
);

3682 
	`BUILD_BUG_ON
(()
NPC_LT_LD_SCTP
 !=

3683 ()
NPC_LT_LH_TU_SCTP
);

3685 i‡((
key_ty≥
 =
NIX_FLOW_KEY_TYPE_TCP
 ||

3686 
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_TCP
) &&

3687 
vÆid_key
) {

3688 
fõld
->
…y≥_m©ch
 |
NPC_LT_LD_TCP
;

3689 
group_membî
 = 
åue
;

3690 } i‡((
key_ty≥
 =
NIX_FLOW_KEY_TYPE_UDP
 ||

3691 
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_UDP
) &&

3692 
vÆid_key
) {

3693 
fõld
->
…y≥_m©ch
 |
NPC_LT_LD_UDP
;

3694 
group_membî
 = 
åue
;

3695 } i‡((
key_ty≥
 =
NIX_FLOW_KEY_TYPE_SCTP
 ||

3696 
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_SCTP
) &&

3697 
vÆid_key
) {

3698 
fõld
->
…y≥_m©ch
 |
NPC_LT_LD_SCTP
;

3699 
group_membî
 = 
åue
;

3701 
fõld
->
…y≥_mask
 = ~fõld->
…y≥_m©ch
;

3702 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_SCTP
 ||

3703 
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_SCTP
) {

3707 i‡(
group_membî
) {

3708 
vÆid_key
 = 
åue
;

3709 
group_membî
 = 
Ál£
;

3712 
fõld_m¨kî
 = 
Ál£
;

3713 
keyoff_m¨kî
 = 
Ál£
;

3719 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_TCP
)

3720 
l4_key_off£t
 = 
key_off
;

3722 
NIX_FLOW_KEY_TYPE_NVGRE
:

3723 
fõld
->
lid
 = 
NPC_LID_LD
;

3724 
fõld
->
hdr_off£t
 = 4;

3725 
fõld
->
byãsm1
 = 2;

3726 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LD_NVGRE
;

3727 
fõld
->
…y≥_mask
 = 0xF;

3729 
NIX_FLOW_KEY_TYPE_VXLAN
:

3730 
NIX_FLOW_KEY_TYPE_GENEVE
:

3731 
fõld
->
lid
 = 
NPC_LID_LE
;

3732 
fõld
->
byãsm1
 = 2;

3733 
fõld
->
hdr_off£t
 = 4;

3734 
fõld
->
…y≥_mask
 = 0xF;

3735 
fõld_m¨kî
 = 
Ál£
;

3736 
keyoff_m¨kî
 = 
Ál£
;

3738 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_VXLAN
 && 
vÆid_key
) {

3739 
fõld
->
…y≥_m©ch
 |
NPC_LT_LE_VXLAN
;

3740 
group_membî
 = 
åue
;

3743 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_GENEVE
 && 
vÆid_key
) {

3744 
fõld
->
…y≥_m©ch
 |
NPC_LT_LE_GENEVE
;

3745 
group_membî
 = 
åue
;

3748 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_GENEVE
) {

3749 i‡(
group_membî
) {

3750 
fõld
->
…y≥_mask
 = ~fõld->
…y≥_m©ch
;

3751 
fõld_m¨kî
 = 
åue
;

3752 
keyoff_m¨kî
 = 
åue
;

3753 
vÆid_key
 = 
åue
;

3754 
group_membî
 = 
Ál£
;

3758 
NIX_FLOW_KEY_TYPE_ETH_DMAC
:

3759 
NIX_FLOW_KEY_TYPE_INNR_ETH_DMAC
:

3760 
fõld
->
lid
 = 
NPC_LID_LA
;

3761 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LA_ETHER
;

3762 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_INNR_ETH_DMAC
) {

3763 
fõld
->
lid
 = 
NPC_LID_LF
;

3764 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LF_TU_ETHER
;

3766 
fõld
->
hdr_off£t
 = 0;

3767 
fõld
->
byãsm1
 = 5;

3768 
fõld
->
…y≥_mask
 = 0xF;

3770 
NIX_FLOW_KEY_TYPE_IPV6_EXT
:

3771 
fõld
->
lid
 = 
NPC_LID_LC
;

3772 
fõld
->
hdr_off£t
 = 40;

3773 
fõld
->
byãsm1
 = 0;

3774 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LC_IP6_EXT
;

3775 
fõld
->
…y≥_mask
 = 0xF;

3777 
NIX_FLOW_KEY_TYPE_GTPU
:

3778 
fõld
->
lid
 = 
NPC_LID_LE
;

3779 
fõld
->
hdr_off£t
 = 4;

3780 
fõld
->
byãsm1
 = 3;

3781 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LE_GTPU
;

3782 
fõld
->
…y≥_mask
 = 0xF;

3784 
NIX_FLOW_KEY_TYPE_CH_LEN_90B
:

3785 
fõld
->
lid
 = 
NPC_LID_LA
;

3786 
fõld
->
hdr_off£t
 = 24;

3787 
fõld
->
byãsm1
 = 1;

3788 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LA_CUSTOM_L2_90B_ETHER
;

3789 
fõld
->
…y≥_mask
 = 0xF;

3791 
NIX_FLOW_KEY_TYPE_CUSTOM0
:

3792 
fõld
->
lid
 = 
NPC_LID_LC
;

3793 
fõld
->
hdr_off£t
 = 6;

3794 
fõld
->
byãsm1
 = 1;

3795 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LC_CUSTOM0
;

3796 
fõld
->
…y≥_mask
 = 0xF;

3798 
NIX_FLOW_KEY_TYPE_VLAN
:

3799 
fõld
->
lid
 = 
NPC_LID_LB
;

3800 
fõld
->
hdr_off£t
 = 2;

3801 
fõld
->
byãsm1
 = 1;

3802 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LB_CTAG
;

3803 
fõld
->
…y≥_mask
 = 0xF;

3804 
fõld
->
‚_mask
 = 1;

3806 
NIX_FLOW_KEY_TYPE_AH
:

3807 
NIX_FLOW_KEY_TYPE_ESP
:

3808 
fõld
->
hdr_off£t
 = 0;

3809 
fõld
->
byãsm1
 = 7;

3810 
fõld
->
…y≥_mask
 = 0xF;

3811 
fõld
->
lid
 = 
NPC_LID_LE
;

3812 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LE_ESP
;

3813 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_AH
) {

3814 
fõld
->
lid
 = 
NPC_LID_LD
;

3815 
fõld
->
…y≥_m©ch
 = 
NPC_LT_LD_AH
;

3816 
fõld
->
hdr_off£t
 = 4;

3817 
keyoff_m¨kî
 = 
Ál£
;

3821 
fõld
->
ía
 = 1;

3824 i‡(
vÆid_key
) {

3828 i‡(
key_ty≥
 =
NIX_FLOW_KEY_TYPE_ESP
 ||

3829 
key_ty≥
 =
NIX_FLOW_KEY_TYPE_AH
)

3830 
key_off
 = 
l4_key_off£t
;

3831 
fõld
->
key_off£t
 = 
key_off
;

3832 
	`mem˝y
(&
Æg
[
ƒ_fõld
], 
fõld
, (*field));

3833 
max_key_off
 = 
	`max
(max_key_off, 
fõld
->
byãsm1
 + 1);

3836 i‡(
fõld_m¨kî
)

3837 
ƒ_fõld
++;

3841 i‡(
keyoff_m¨kî
) {

3842 
key_off
 +
max_key_off
;

3843 
max_key_off
 = 0;

3847 i‡(
idx
 =
max_bô_pos
 && 
key_off
 <
MAX_KEY_OFF
)

3850  
NIX_AF_ERR_RSS_NOSPC_FIELD
;

3851 
	}
}

3853 
	$ª£rve_Êowkey_Æg_idx
(
rvu
 *rvu, 
blkaddr
, 
u32
 
Êow_cfg
)

3855 
u64
 
fõld
[
FIELDS_PER_ALG
];

3856 
nix_hw
 *
hw
;

3857 
fid
, 
rc
;

3859 
hw
 = 
	`gë_nix_hw
(
rvu
->hw, 
blkaddr
);

3860 i‡(!
hw
)

3861  
NIX_AF_ERR_INVALID_NIXBLK
;

3864 i‡(
hw
->
Êowkey
.
ö_u£
 >
NIX_FLOW_KEY_ALG_MAX
)

3865  
NIX_AF_ERR_RSS_NOSPC_ALGO
;

3868 
rc
 = 
	`£t_Êowkey_fõlds
((
nix_rx_Êowkey_Æg
 *)
fõld
, 
Êow_cfg
);

3869 i‡(
rc
)

3870  
rc
;

3873 
fid
 = 0; fid < 
FIELDS_PER_ALG
; fid++)

3874 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

3875 
	`NIX_AF_RX_FLOW_KEY_ALGX_FIELDX
(
hw
->
Êowkey
.
ö_u£
,

3876 
fid
), 
fõld
[fid]);

3879 
rc
 = 
hw
->
Êowkey
.
ö_u£
;

3880 
hw
->
Êowkey
.Êowkey[
rc
] = 
Êow_cfg
;

3881 
hw
->
Êowkey
.
ö_u£
++;

3883  
rc
;

3884 
	}
}

3886 
	$rvu_mbox_h™dÀr_nix_rss_Êowkey_cfg
(
rvu
 *rvu,

3887 
nix_rss_Êowkey_cfg
 *
ªq
,

3888 
nix_rss_Êowkey_cfg_r•
 *
r•
)

3890 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

3891 
Æg_idx
, 
nixlf
, 
blkaddr
;

3892 
nix_hw
 *nix_hw;

3893 
îr
;

3895 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

3896 i‡(
îr
)

3897  
îr
;

3899 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

3900 i‡(!
nix_hw
)

3901  
NIX_AF_ERR_INVALID_NIXBLK
;

3903 
Æg_idx
 = 
	`gë_Êowkey_Æg_idx
(
nix_hw
, 
ªq
->
Êowkey_cfg
);

3905 i‡(
Æg_idx
 < 0) {

3906 
Æg_idx
 = 
	`ª£rve_Êowkey_Æg_idx
(
rvu
, 
blkaddr
,

3907 
ªq
->
Êowkey_cfg
);

3908 i‡(
Æg_idx
 < 0)

3909  
Æg_idx
;

3911 
r•
->
Æg_idx
 =álg_idx;

3912 
	`rvu_≈c_upd©e_Êowkey_Æg_idx
(
rvu
, 
pcifunc
, 
nixlf
, 
ªq
->
group
,

3913 
Æg_idx
, 
ªq
->
mˇm_ödex
);

3915 
	}
}

3917 
	$nix_rx_Êowkey_Æg_cfg
(
rvu
 *rvu, 
blkaddr
)

3919 
u32
 
Êowkey_cfg
, 
mökey_cfg
;

3920 
Æg
, 
fid
, 
rc
;

3923 
Æg
 = 0;álg < 
NIX_FLOW_KEY_ALG_MAX
;álg++) {

3924 
fid
 = 0; fid < 
FIELDS_PER_ALG
; fid++)

3925 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

3926 
	`NIX_AF_RX_FLOW_KEY_ALGX_FIELDX
(
Æg
, 
fid
),

3931 
Êowkey_cfg
 = 
NIX_FLOW_KEY_TYPE_IPV4
 | 
NIX_FLOW_KEY_TYPE_IPV6
;

3932 
rc
 = 
	`ª£rve_Êowkey_Æg_idx
(
rvu
, 
blkaddr
, 
Êowkey_cfg
);

3933 i‡(
rc
 < 0)

3934  
rc
;

3937 
mökey_cfg
 = 
Êowkey_cfg
;

3938 
Êowkey_cfg
 = 
mökey_cfg
 | 
NIX_FLOW_KEY_TYPE_TCP
;

3939 
rc
 = 
	`ª£rve_Êowkey_Æg_idx
(
rvu
, 
blkaddr
, 
Êowkey_cfg
);

3940 i‡(
rc
 < 0)

3941  
rc
;

3944 
Êowkey_cfg
 = 
mökey_cfg
 | 
NIX_FLOW_KEY_TYPE_UDP
;

3945 
rc
 = 
	`ª£rve_Êowkey_Æg_idx
(
rvu
, 
blkaddr
, 
Êowkey_cfg
);

3946 i‡(
rc
 < 0)

3947  
rc
;

3950 
Êowkey_cfg
 = 
mökey_cfg
 | 
NIX_FLOW_KEY_TYPE_SCTP
;

3951 
rc
 = 
	`ª£rve_Êowkey_Æg_idx
(
rvu
, 
blkaddr
, 
Êowkey_cfg
);

3952 i‡(
rc
 < 0)

3953  
rc
;

3956 
Êowkey_cfg
 = 
mökey_cfg
 | 
NIX_FLOW_KEY_TYPE_TCP
 |

3957 
NIX_FLOW_KEY_TYPE_UDP
;

3958 
rc
 = 
	`ª£rve_Êowkey_Æg_idx
(
rvu
, 
blkaddr
, 
Êowkey_cfg
);

3959 i‡(
rc
 < 0)

3960  
rc
;

3963 
Êowkey_cfg
 = 
mökey_cfg
 | 
NIX_FLOW_KEY_TYPE_TCP
 |

3964 
NIX_FLOW_KEY_TYPE_SCTP
;

3965 
rc
 = 
	`ª£rve_Êowkey_Æg_idx
(
rvu
, 
blkaddr
, 
Êowkey_cfg
);

3966 i‡(
rc
 < 0)

3967  
rc
;

3970 
Êowkey_cfg
 = 
mökey_cfg
 | 
NIX_FLOW_KEY_TYPE_UDP
 |

3971 
NIX_FLOW_KEY_TYPE_SCTP
;

3972 
rc
 = 
	`ª£rve_Êowkey_Æg_idx
(
rvu
, 
blkaddr
, 
Êowkey_cfg
);

3973 i‡(
rc
 < 0)

3974  
rc
;

3977 
Êowkey_cfg
 = 
mökey_cfg
 | 
NIX_FLOW_KEY_TYPE_TCP
 |

3978 
NIX_FLOW_KEY_TYPE_UDP
 | 
NIX_FLOW_KEY_TYPE_SCTP
;

3979 
rc
 = 
	`ª£rve_Êowkey_Æg_idx
(
rvu
, 
blkaddr
, 
Êowkey_cfg
);

3980 i‡(
rc
 < 0)

3981  
rc
;

3984 
	}
}

3986 
	$rvu_mbox_h™dÀr_nix_£t_mac_addr
(
rvu
 *rvu,

3987 
nix_£t_mac_addr
 *
ªq
,

3988 
msg_r•
 *
r•
)

3990 
boﬁ
 
‰om_vf
 = !!(
ªq
->
hdr
.
pcifunc
 & 
RVU_PFVF_FUNC_MASK
);

3991 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

3992 
blkaddr
, 
nixlf
, 
îr
;

3993 
rvu_pfvf
 *
pfvf
;

3995 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

3996 i‡(
îr
)

3997  
îr
;

3999 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

4002 i‡(!
	`ã°_bô
(
PF_SET_VF_TRUSTED
, &
pfvf
->
Êags
) &&

4003 (
‰om_vf
 && 
	`ã°_bô
(
PF_SET_VF_MAC
, &
pfvf
->
Êags
))) {

4004 
	`dev_w¨n
(
rvu
->
dev
,

4006  -
EPERM
;

4009 
	`ëhî_addr_c›y
(
pfvf
->
mac_addr
, 
ªq
->mac_addr);

4011 
	`rvu_≈c_ö°Æl_uˇ°_íåy
(
rvu
, 
pcifunc
, 
nixlf
,

4012 
pfvf
->
rx_ch™_ba£
, 
ªq
->
mac_addr
);

4014 i‡(
	`ã°_bô
(
PF_SET_VF_TRUSTED
, &
pfvf
->
Êags
Ë&& 
‰om_vf
)

4015 
	`ëhî_addr_c›y
(
pfvf
->
deÁu…_mac
, 
ªq
->
mac_addr
);

4017 
	`rvu_swôch_upd©e_ruÀs
(
rvu
, 
pcifunc
);

4020 
	}
}

4022 
	$rvu_mbox_h™dÀr_nix_gë_mac_addr
(
rvu
 *rvu,

4023 
msg_ªq
 *
ªq
,

4024 
nix_gë_mac_addr_r•
 *
r•
)

4026 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

4027 
rvu_pfvf
 *
pfvf
;

4029 i‡(!
	`is_nixlf_©èched
(
rvu
, 
pcifunc
))

4030  
NIX_AF_ERR_AF_LF_INVALID
;

4032 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

4034 
	`ëhî_addr_c›y
(
r•
->
mac_addr
, 
pfvf
->mac_addr);

4037 
	}
}

4039 
	$rvu_mbox_h™dÀr_nix_£t_rx_mode
(
rvu
 *rvu, 
nix_rx_mode
 *
ªq
,

4040 
msg_r•
 *
r•
)

4042 
boﬁ
 
Ælmu…i
, 
¥omisc
, 
nix_rx_mu…iˇ°
;

4043 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

4044 
rvu_pfvf
 *
pfvf
;

4045 
nixlf
, 
îr
;

4047 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

4048 
¥omisc
 = 
ªq
->
mode
 & 
NIX_RX_MODE_PROMISC
 ? 
åue
 : 
Ál£
;

4049 
Ælmu…i
 = 
ªq
->
mode
 & 
NIX_RX_MODE_ALLMULTI
 ? 
åue
 : 
Ál£
;

4050 
pfvf
->
u£_m˚_li°
 = 
ªq
->
mode
 & 
NIX_RX_MODE_USE_MCE
 ? 
åue
 : 
Ál£
;

4052 
nix_rx_mu…iˇ°
 = 
rvu
->
hw
->
ˇp
.nix_rx_mu…iˇ° & 
pfvf
->
u£_m˚_li°
;

4054 i‡(
	`is_vf
(
pcifunc
Ë&& !
nix_rx_mu…iˇ°
 &&

4055 (
¥omisc
 || 
Ælmu…i
)) {

4056 
	`dev_w¨n_øãlimôed
(
rvu
->
dev
,

4062 i‡(
	`is_vf
(
pcifunc
Ë&& !
	`ã°_bô
(
PF_SET_VF_TRUSTED
, &
pfvf
->
Êags
) &&

4063 (
¥omisc
 || 
Ælmu…i
))

4066 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, 
NULL
);

4067 i‡(
îr
)

4068  
îr
;

4070 i‡(
nix_rx_mu…iˇ°
) {

4072 
îr
 = 
	`nix_upd©e_m˚_ruÀ
(
rvu
, 
pcifunc
, 
NIXLF_ALLMULTI_ENTRY
,

4073 
Ælmu…i
);

4074 i‡(
îr
) {

4075 
	`dev_îr
(
rvu
->
dev
,

4077 
pcifunc
);

4078  
îr
;

4082 
îr
 = 
	`nix_upd©e_m˚_ruÀ
(
rvu
, 
pcifunc
, 
NIXLF_PROMISC_ENTRY
,

4083 
¥omisc
);

4084 i‡(
îr
) {

4085 
	`dev_îr
(
rvu
->
dev
,

4087 
pcifunc
);

4088  
îr
;

4093 i‡(
Ælmu…i
) {

4094 
	`rvu_≈c_ö°Æl_Ælmu…i_íåy
(
rvu
, 
pcifunc
, 
nixlf
,

4095 
pfvf
->
rx_ch™_ba£
);

4097 i‡(!
nix_rx_mu…iˇ°
)

4098 
	`rvu_≈c_íabÀ_Ælmu…i_íåy
(
rvu
, 
pcifunc
, 
nixlf
, 
Ál£
);

4102 i‡(
¥omisc
) {

4103 
	`rvu_≈c_ö°Æl_¥omisc_íåy
(
rvu
, 
pcifunc
, 
nixlf
,

4104 
pfvf
->
rx_ch™_ba£
,

4105 
pfvf
->
rx_ch™_˙t
);

4107 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

4108 
	`rvu_≈c_exa˘_¥omisc_íabÀ
(
rvu
, 
pcifunc
);

4110 i‡(!
nix_rx_mu…iˇ°
)

4111 
	`rvu_≈c_íabÀ_¥omisc_íåy
(
rvu
, 
pcifunc
, 
nixlf
, 
Ál£
);

4113 i‡(
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
))

4114 
	`rvu_≈c_exa˘_¥omisc_dißbÀ
(
rvu
, 
pcifunc
);

4118 
	}
}

4120 
	$nix_föd_lök_‰s
(
rvu
 *rvu,

4121 
nix_‰s_cfg
 *
ªq
, 
u16
 
pcifunc
)

4123 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

4124 
rvu_pfvf
 *
pfvf
;

4125 
maxÀn
, 
möÀn
;

4126 
numvfs
, 
hwvf
;

4127 
vf
;

4130 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

4131 
pfvf
->
maxÀn
 = 
ªq
->maxlen;

4132 i‡(
ªq
->
upd©e_möÀn
)

4133 
pfvf
->
möÀn
 = 
ªq
->minlen;

4135 
maxÀn
 = 
ªq
->maxlen;

4136 
möÀn
 = 
ªq
->
upd©e_möÀn
 ?Ñeq->minlen : 0;

4139 
	`rvu_gë_pf_numvfs
(
rvu
, 
pf
, &
numvfs
, &
hwvf
);

4142 
vf
 = 0; v‡< 
numvfs
; vf++) {

4143 
pfvf
 = &
rvu
->
hwvf
[hwv‡+ 
vf
];

4144 i‡(
pfvf
->
maxÀn
 > maxlen)

4145 
maxÀn
 = 
pfvf
->maxlen;

4146 i‡(
ªq
->
upd©e_möÀn
 &&

4147 
pfvf
->
möÀn
 &&Öfvf->minlen < minlen)

4148 
möÀn
 = 
pfvf
->minlen;

4152 
pfvf
 = &
rvu
->
pf
[pf];

4153 i‡(
pfvf
->
maxÀn
 > maxlen)

4154 
maxÀn
 = 
pfvf
->maxlen;

4155 i‡(
ªq
->
upd©e_möÀn
 &&

4156 
pfvf
->
möÀn
 &&Öfvf->minlen < minlen)

4157 
möÀn
 = 
pfvf
->minlen;

4160 
ªq
->
maxÀn
 = maxlen;

4161 i‡(
ªq
->
upd©e_möÀn
)

4162 
ªq
->
möÀn
 = minlen;

4163 
	}
}

4166 
	$nix_c⁄fig_lök_¸edôs
(
rvu
 *rvu, 
blkaddr
, 
lök
,

4167 
u16
 
pcifunc
, 
u64
 
tx_¸edôs
)

4169 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

4170 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

4171 
u8
 
cgx_id
 = 0, 
lmac_id
 = 0;

4172 
pﬁl_tmo
;

4173 
boﬁ
 
ª°‹e_tx_í
 = 0;

4174 
nix_hw
 *nix_hw;

4175 
u64
 
cfg
, 
sw_xoff
 = 0;

4176 
u32
 
schq
 = 0;

4177 
u32
 
¸edôs
;

4178 
rc
;

4180 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

4181 i‡(!
nix_hw
)

4182  
NIX_AF_ERR_INVALID_NIXBLK
;

4184 i‡(
tx_¸edôs
 =
nix_hw
->tx_¸edôs[
lök
])

4188 i‡(
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
)) {

4189 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

4190 
ª°‹e_tx_í
 = !
	`rvu_cgx_c⁄fig_tx
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
),

4191 
lmac_id
, 
åue
);

4194 
	`muãx_lock
(&
rvu
->
r§c_lock
);

4196 i‡(
hw
->
ˇp
.
nix_sh≠ög
) {

4197 
schq
 = 
	`nix_gë_tx_lök
(
rvu
, 
pcifunc
);

4198 
sw_xoff
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL1X_SW_XOFF
(
schq
));

4199 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

4200 
	`NIX_AF_TL1X_SW_XOFF
(
schq
), 
	`BIT_ULL
(0));

4203 
rc
 = 
NIX_AF_ERR_LINK_CREDITS
;

4204 
pﬁl_tmo
 = 
jiffõs
 + 
	`u£cs_to_jiffõs
(200000);

4207 i‡(
	`time_a·î
(
jiffõs
, 
pﬁl_tmo
))

4208 
exô
;

4209 
	`u¶ìp_ønge
(100, 200);

4211 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

4212 
	`NIX_AF_TX_LINKX_NORM_CREDIT
(
lök
));

4213 
¸edôs
 = (
cfg
 >> 12) & 0xFFFFFULL;

4214 } 
¸edôs
 !
nix_hw
->
tx_¸edôs
[
lök
]);

4216 
cfg
 &= ~(0xFFFFFULL << 12);

4217 
cfg
 |(
tx_¸edôs
 << 12);

4218 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TX_LINKX_NORM_CREDIT
(
lök
), 
cfg
);

4219 
rc
 = 0;

4221 
nix_hw
->
tx_¸edôs
[
lök
] =Åx_credits;

4222 
	`rvu_nix_upd©e_lök_¸edôs
(
rvu
, 
blkaddr
, 
lök
, 
cfg
);

4224 
exô
:

4226 i‡(
hw
->
ˇp
.
nix_sh≠ög
 && !
sw_xoff
)

4227 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL1X_SW_XOFF
(
schq
), 0);

4230 i‡(
ª°‹e_tx_í
)

4231 
	`rvu_cgx_c⁄fig_tx
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
), 
lmac_id
, 
Ál£
);

4233 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

4234  
rc
;

4235 
	}
}

4237 
	$rvu_mbox_h™dÀr_nix_£t_hw_‰s
(
rvu
 *rvu, 
nix_‰s_cfg
 *
ªq
,

4238 
msg_r•
 *
r•
)

4240 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

4241 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

4242 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

4243 
blkaddr
, 
schq
, 
lök
 = -1;

4244 
nix_txsch
 *
txsch
;

4245 
u64
 
cfg
, 
lmac_fifo_Àn
;

4246 
nix_hw
 *nix_hw;

4247 
rvu_pfvf
 *
pfvf
;

4248 
u8
 
cgx
 = 0, 
lmac
 = 0;

4249 
u16
 
max_mtu
;

4251 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

4252 i‡(
blkaddr
 < 0)

4253  
NIX_AF_ERR_AF_LF_INVALID
;

4255 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

4256 i‡(!
nix_hw
)

4257  
NIX_AF_ERR_INVALID_NIXBLK
;

4259 i‡(
	`is_afvf
(
pcifunc
))

4260 
	`rvu_gë_lbk_lök_max_‰s
(
rvu
, &
max_mtu
);

4262 
	`rvu_gë_lmac_lök_max_‰s
(
rvu
, &
max_mtu
);

4264 i‡(!
ªq
->
sdp_lök
 &&Ñeq->
maxÀn
 > 
max_mtu
)

4265  
NIX_AF_ERR_FRS_INVALID
;

4267 i‡(
ªq
->
upd©e_möÀn
 &&Ñeq->
möÀn
 < 
NIC_HW_MIN_FRS
)

4268  
NIX_AF_ERR_FRS_INVALID
;

4271 i‡(!
ªq
->
upd©e_smq
)

4272 
rx_‰scfg
;

4275 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_SMQ
];

4276 
	`muãx_lock
(&
rvu
->
r§c_lock
);

4277 
schq
 = 0; schq < 
txsch
->schq.
max
; schq++) {

4278 i‡(
	`TXSCH_MAP_FUNC
(
txsch
->
pfvf_m≠
[
schq
]Ë!
pcifunc
)

4280 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SMQX_CFG
(
schq
));

4281 
cfg
 = (cfg & ~(0xFFFFULL << 8)Ë| ((
u64
)
ªq
->
maxÀn
 << 8);

4282 i‡(
ªq
->
upd©e_möÀn
)

4283 
cfg
 = (cfg & ~0x7FULLË| ((
u64
)
ªq
->
möÀn
 & 0x7F);

4284 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SMQX_CFG
(
schq
), 
cfg
);

4286 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

4288 
rx_‰scfg
:

4290 i‡(
ªq
->
sdp_lök
) {

4291 i‡(!
hw
->
sdp_löks
)

4292  
NIX_AF_ERR_RX_LINK_INVALID
;

4293 
lök
 = 
hw
->
cgx_löks
 + hw->
lbk_löks
;

4294 
lökcfg
;

4298 i‡(
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
)) {

4300 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx
, &
lmac
);

4301 
lök
 = (
cgx
 * 
hw
->
lmac_≥r_cgx
Ë+ 
lmac
;

4302 } i‡(
pf
 == 0) {

4304 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

4305 
lök
 = 
hw
->
cgx_löks
 + 
pfvf
->
lbkid
;

4308 i‡(
lök
 < 0)

4309  
NIX_AF_ERR_RX_LINK_INVALID
;

4311 
	`nix_föd_lök_‰s
(
rvu
, 
ªq
, 
pcifunc
);

4313 
lökcfg
:

4314 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_LINKX_CFG
(
lök
));

4315 
cfg
 = (cfg & ~(0xFFFFULL << 16)Ë| ((
u64
)
ªq
->
maxÀn
 << 16);

4316 i‡(
ªq
->
upd©e_möÀn
)

4317 
cfg
 = (cfg & ~0xFFFFULLË| 
ªq
->
möÀn
;

4318 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_LINKX_CFG
(
lök
), 
cfg
);

4320 i‡(
ªq
->
sdp_lök
 || 
pf
 == 0)

4324 
lmac_fifo_Àn
 = 
	`rvu_cgx_gë_lmac_fifﬁí
(
rvu
, 
cgx
, 
lmac
);

4325 i‡(!
lmac_fifo_Àn
) {

4326 
	`dev_îr
(
rvu
->
dev
,

4328 
__func__
, 
cgx
, 
lmac
);

4331  
	`nix_c⁄fig_lök_¸edôs
(
rvu
, 
blkaddr
, 
lök
, 
pcifunc
,

4332 (
lmac_fifo_Àn
 - 
ªq
->
maxÀn
) / 16);

4333 
	}
}

4335 
	$rvu_mbox_h™dÀr_nix_£t_rx_cfg
(
rvu
 *rvu, 
nix_rx_cfg
 *
ªq
,

4336 
msg_r•
 *
r•
)

4338 
nixlf
, 
blkaddr
, 
îr
;

4339 
u64
 
cfg
;

4341 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
ªq
->
hdr
.
pcifunc
, &
nixlf
, &
blkaddr
);

4342 i‡(
îr
)

4343  
îr
;

4345 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_CFG
(
nixlf
));

4347 i‡(
ªq
->
Àn_vîify
 & 
	`BIT
(0))

4348 
cfg
 |
	`BIT_ULL
(41);

4350 
cfg
 &~
	`BIT_ULL
(41);

4352 i‡(
ªq
->
Àn_vîify
 & 
	`BIT
(1))

4353 
cfg
 |
	`BIT_ULL
(40);

4355 
cfg
 &~
	`BIT_ULL
(40);

4357 i‡(
ªq
->
Àn_vîify
 & 
NIX_RX_DROP_RE
)

4358 
cfg
 |
	`BIT_ULL
(32);

4360 
cfg
 &~
	`BIT_ULL
(32);

4362 i‡(
ªq
->
csum_vîify
 & 
	`BIT
(0))

4363 
cfg
 |
	`BIT_ULL
(37);

4365 
cfg
 &~
	`BIT_ULL
(37);

4367 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_CFG
(
nixlf
), 
cfg
);

4370 
	}
}

4372 
u64
 
	$rvu_gë_lbk_lök_¸edôs
(
rvu
 *rvu, 
u16
 
lbk_max_‰s
)

4375 
	}
}

4377 
	$nix_lök_c⁄fig
(
rvu
 *rvu, 
blkaddr
,

4378 
nix_hw
 *nix_hw)

4380 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

4381 
cgx
, 
lmac_˙t
, 
¶ök
, 
lök
;

4382 
u16
 
lbk_max_‰s
, 
lmac_max_‰s
;

4383 
lmac_bm≠
;

4384 
u64
 
tx_¸edôs
, 
cfg
;

4385 
u64
 
lmac_fifo_Àn
;

4386 
ôî
;

4388 
	`rvu_gë_lbk_lök_max_‰s
(
rvu
, &
lbk_max_‰s
);

4389 
	`rvu_gë_lmac_lök_max_‰s
(
rvu
, &
lmac_max_‰s
);

4397 
lök
 = 0;Üök < 
hw
->
cgx_löks
;Üink++) {

4398 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_LINKX_CFG
(
lök
),

4399 ((
u64
)
lmac_max_‰s
 << 16Ë| 
NIC_HW_MIN_FRS
);

4402 
lök
 = 
hw
->
cgx_löks
;Üök < hw->cgx_lök†+ hw->
lbk_löks
;Üink++) {

4403 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_LINKX_CFG
(
lök
),

4404 ((
u64
)
lbk_max_‰s
 << 16Ë| 
NIC_HW_MIN_FRS
);

4406 i‡(
hw
->
sdp_löks
) {

4407 
lök
 = 
hw
->
cgx_löks
 + hw->
lbk_löks
;

4408 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_LINKX_CFG
(
lök
),

4409 
SDP_HW_MAX_FRS
 << 16 | 
NIC_HW_MIN_FRS
);

4413 i‡(
hw
->
˝t_löks
) {

4414 
lök
 = 
hw
->
cgx_löks
 + hw->
lbk_löks
 + hw->
sdp_löks
;

4418 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_LINKX_CFG
(
lök
),

4419 ((
u64
)
lbk_max_‰s
 << 16Ë| 
NIC_HW_MIN_FRS
);

4425 
cgx
 = 0; cgx < 
hw
->cgx; cgx++) {

4426 
lmac_˙t
 = 
	`cgx_gë_lmac_˙t
(
	`rvu_cgx_pd©a
(
cgx
, 
rvu
));

4428 i‡(
lmac_˙t
 <= 0)

4431 
¶ök
 = 
cgx
 * 
hw
->
lmac_≥r_cgx
;

4434 
lmac_bm≠
 = 
	`cgx_gë_lmac_bm≠
(
	`rvu_cgx_pd©a
(
cgx
, 
rvu
));

4435 
	`f‹_óch_£t_bô
(
ôî
, &
lmac_bm≠
, 
rvu
->
hw
->
lmac_≥r_cgx
) {

4436 
lmac_fifo_Àn
 = 
	`rvu_cgx_gë_lmac_fifﬁí
(
rvu
, 
cgx
, 
ôî
);

4437 i‡(!
lmac_fifo_Àn
) {

4438 
	`dev_îr
(
rvu
->
dev
,

4440 
__func__
, 
cgx
, 
ôî
);

4443 
tx_¸edôs
 = (
lmac_fifo_Àn
 - 
lmac_max_‰s
) / 16;

4445 
cfg
 = (
tx_¸edôs
 << 12Ë| (0x1FF << 2Ë| 
	`BIT_ULL
(1);

4447 
lök
 = 
ôî
 + 
¶ök
;

4448 
nix_hw
->
tx_¸edôs
[
lök
] =Åx_credits;

4449 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

4450 
	`NIX_AF_TX_LINKX_NORM_CREDIT
(
lök
), 
cfg
);

4455 
¶ök
 = 
hw
->
cgx_löks
;

4456 
lök
 = 
¶ök
;Üök < (¶ök + 
hw
->
lbk_löks
);Üink++) {

4457 
tx_¸edôs
 = 
	`rvu_gë_lbk_lök_¸edôs
(
rvu
, 
lbk_max_‰s
);

4458 
nix_hw
->
tx_¸edôs
[
lök
] =Åx_credits;

4460 
tx_¸edôs
 = (tx_¸edô†<< 12Ë| (0x1FF << 2Ë| 
	`BIT_ULL
(1);

4461 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

4462 
	`NIX_AF_TX_LINKX_NORM_CREDIT
(
lök
), 
tx_¸edôs
);

4464 
	}
}

4466 
	$nix_ˇlibøã_x2p
(
rvu
 *rvu, 
blkaddr
)

4468 
idx
, 
îr
;

4469 
u64
 
°©us
;

4472 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
,

4473 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
Ë| 
	`BIT_ULL
(9));

4475 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
,

4476 
NIX_AF_STATUS
, 
	`BIT_ULL
(10), 
Ál£
);

4477 i‡(
îr
) {

4478 
	`dev_îr
(
rvu
->
dev
, "NIX X2P bus calibration failed\n");

4479  
îr
;

4482 
°©us
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_STATUS
);

4484 
idx
 = 0; idx < 
rvu
->
cgx_˙t_max
; idx++) {

4486 i‡(!
	`rvu_cgx_pd©a
(
idx
, 
rvu
) ||

4487 (
°©us
 & (
	`BIT_ULL
(16 + 
idx
))))

4489 
	`dev_îr
(
rvu
->
dev
,

4490 "CGX%d didn'àª•⁄dÅÿNIX X2P cÆibøti⁄\n", 
idx
);

4491 
îr
 = -
EBUSY
;

4495 i‡(!(
°©us
 & 
	`BIT_ULL
(19))) {

4496 
	`dev_îr
(
rvu
->
dev
,

4498 
îr
 = -
EBUSY
;

4502 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
,

4503 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CFG
Ë& ~
	`BIT_ULL
(9));

4504 i‡(
îr
 || (
°©us
 & 0x3FFULL))

4505 
	`dev_îr
(
rvu
->
dev
,

4506 "NIX X2P cÆibøti⁄ faûed, sètu†0x%Œx\n", 
°©us
);

4507 i‡(
îr
)

4508  
îr
;

4510 
	}
}

4512 
	$nix_aq_öô
(
rvu
 *rvu, 
rvu_block
 *
block
)

4514 
u64
 
cfg
;

4515 
îr
;

4518 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
NIX_AF_CFG
);

4519 #ifde‡
__BIG_ENDIAN


4520 
cfg
 |
	`BIT_ULL
(8);

4521 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NIX_AF_CFG
, 
cfg
);

4523 
cfg
 &~
	`BIT_ULL
(8);

4524 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NIX_AF_CFG
, 
cfg
);

4528 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
NIX_AF_NDC_CFG
);

4529 
cfg
 &= ~0x3FFEULL;

4530 #ifde‡
CONFIG_NDC_DIS_DYNAMIC_CACHING


4532 
cfg
 |= 0x04ULL;

4534 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NIX_AF_NDC_CFG
, 
cfg
);

4540 
îr
 = 
	`rvu_aq_Æloc
(
rvu
, &
block
->
aq
,

4541 
	`Q_COUNT
(
AQ_SIZE
), (
nix_aq_ö°_s
),

4542 
	`ALIGN
((
nix_aq_ªs_s
), 128) + 256);

4543 i‡(
îr
)

4544  
îr
;

4546 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NIX_AF_AQ_CFG
, 
AQ_SIZE
);

4547 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
,

4548 
NIX_AF_AQ_BASE
, (
u64
)
block
->
aq
->
ö°
->
iova
);

4550 
	}
}

4552 
	$rvu_nix_£tup_ˇ∑bûôõs
(
rvu
 *rvu, 
blkaddr
)

4554 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

4555 
u64
 
hw_c⁄°
;

4557 
hw_c⁄°
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST1
);

4570 i‡((((
hw_c⁄°
 >> 56Ë& 0x10Ë=0x10Ë&& !(hw_c⁄° & 
	`BIT_ULL
(61)))

4571 
hw
->
ˇp
.
nix_comm⁄_dwº_mtu
 = 
åue
;

4573 i‡(
hw_c⁄°
 & 
	`BIT_ULL
(61))

4574 
hw
->
ˇp
.
nix_mu…ùÀ_dwº_mtu
 = 
åue
;

4575 
	}
}

4577 
	$rvu_nix_block_öô
(
rvu
 *rvu, 
nix_hw
 *nix_hw)

4579 c⁄° 
≈c_…_def_cfg
 *
…defs
;

4580 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

4581 
blkaddr
 = 
nix_hw
->blkaddr;

4582 
rvu_block
 *
block
;

4583 
u64
 
cfg
;

4584 
îr
;

4586 
block
 = &
hw
->block[
blkaddr
];

4588 
…defs
 = 
rvu
->
kpu
.
…_def
;

4590 
îr
 = 
	`nix_ˇlibøã_x2p
(
rvu
, 
blkaddr
);

4591 i‡(
îr
)

4592  
îr
;

4595 
	`rvu_nix_£tup_ˇ∑bûôõs
(
rvu
, 
blkaddr
);

4598 
îr
 = 
	`nix_aq_öô
(
rvu
, 
block
);

4599 i‡(
îr
)

4600  
îr
;

4603 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_CINT_DELAY
, 0x0ULL);

4605 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_SEB_CFG
);

4608 
cfg
 |= 1ULL;

4609 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

4610 
cfg
 |
NIX_PTP_1STEP_EN
;

4612 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_SEB_CFG
, 
cfg
);

4614 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

4615 
	`rvu_nix_block_˙10k_öô
(
rvu
, 
nix_hw
);

4617 i‡(
	`is_block_im∂emíãd
(
hw
, 
blkaddr
)) {

4618 
îr
 = 
	`nix_£tup_txschq
(
rvu
, 
nix_hw
, 
blkaddr
);

4619 i‡(
îr
)

4620  
îr
;

4622 
îr
 = 
	`nix_£tup_ùﬁi˚rs
(
rvu
, 
nix_hw
, 
blkaddr
);

4623 i‡(
îr
)

4624  
îr
;

4626 
îr
 = 
	`nix_af_m¨k_f‹m©_£tup
(
rvu
, 
nix_hw
, 
blkaddr
);

4627 i‡(
îr
)

4628  
îr
;

4630 
îr
 = 
	`nix_£tup_mˇ°
(
rvu
, 
nix_hw
, 
blkaddr
);

4631 i‡(
îr
)

4632  
îr
;

4634 
îr
 = 
	`nix_£tup_txvœn
(
rvu
, 
nix_hw
);

4635 i‡(
îr
)

4636  
îr
;

4639 
	`nix_£tup_lso
(
rvu
, 
nix_hw
, 
blkaddr
);

4645 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_OL2
,

4646 (
…defs
->
rx_ﬁ2
.
lid
 << 8) |

4647 (
…defs
->
rx_ﬁ2
.
…y≥_m©ch
 << 4) |

4648 
…defs
->
rx_ﬁ2
.
…y≥_mask
);

4649 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_OIP4
,

4650 (
…defs
->
rx_où4
.
lid
 << 8) |

4651 (
…defs
->
rx_où4
.
…y≥_m©ch
 << 4) |

4652 
…defs
->
rx_où4
.
…y≥_mask
);

4653 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_IIP4
,

4654 (
…defs
->
rx_iù4
.
lid
 << 8) |

4655 (
…defs
->
rx_iù4
.
…y≥_m©ch
 << 4) |

4656 
…defs
->
rx_iù4
.
…y≥_mask
);

4657 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_OIP6
,

4658 (
…defs
->
rx_où6
.
lid
 << 8) |

4659 (
…defs
->
rx_où6
.
…y≥_m©ch
 << 4) |

4660 
…defs
->
rx_où6
.
…y≥_mask
);

4661 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_IIP6
,

4662 (
…defs
->
rx_iù6
.
lid
 << 8) |

4663 (
…defs
->
rx_iù6
.
…y≥_m©ch
 << 4) |

4664 
…defs
->
rx_iù6
.
…y≥_mask
);

4665 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_OTCP
,

4666 (
…defs
->
rx_Ÿ˝
.
lid
 << 8) |

4667 (
…defs
->
rx_Ÿ˝
.
…y≥_m©ch
 << 4) |

4668 
…defs
->
rx_Ÿ˝
.
…y≥_mask
);

4669 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_ITCP
,

4670 (
…defs
->
rx_ô˝
.
lid
 << 8) |

4671 (
…defs
->
rx_ô˝
.
…y≥_m©ch
 << 4) |

4672 
…defs
->
rx_ô˝
.
…y≥_mask
);

4673 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_OUDP
,

4674 (
…defs
->
rx_oudp
.
lid
 << 8) |

4675 (
…defs
->
rx_oudp
.
…y≥_m©ch
 << 4) |

4676 
…defs
->
rx_oudp
.
…y≥_mask
);

4677 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_IUDP
,

4678 (
…defs
->
rx_iudp
.
lid
 << 8) |

4679 (
…defs
->
rx_iudp
.
…y≥_m©ch
 << 4) |

4680 
…defs
->
rx_iudp
.
…y≥_mask
);

4681 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_OSCTP
,

4682 (
…defs
->
rx_os˘p
.
lid
 << 8) |

4683 (
…defs
->
rx_os˘p
.
…y≥_m©ch
 << 4) |

4684 
…defs
->
rx_os˘p
.
…y≥_mask
);

4685 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_ISCTP
,

4686 (
…defs
->
rx_is˘p
.
lid
 << 8) |

4687 (
…defs
->
rx_is˘p
.
…y≥_m©ch
 << 4) |

4688 
…defs
->
rx_is˘p
.
…y≥_mask
);

4690 i‡(!
	`is_rvu_Ÿx2
(
rvu
)) {

4694 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_CST_APAD0
,

4695 (
…defs
->
rx_≠ad0
.
vÆid
 << 11) |

4696 (
…defs
->
rx_≠ad0
.
lid
 << 8) |

4697 (
…defs
->
rx_≠ad0
.
…y≥_m©ch
 << 4) |

4698 
…defs
->
rx_≠ad0
.
…y≥_mask
);

4699 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_CST_APAD1
,

4700 (
…defs
->
rx_≠ad1
.
vÆid
 << 11) |

4701 (
…defs
->
rx_≠ad1
.
lid
 << 8) |

4702 (
…defs
->
rx_≠ad1
.
…y≥_m©ch
 << 4) |

4703 
…defs
->
rx_≠ad1
.
…y≥_mask
);

4710 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_DEF_ET
(0),

4711 (
…defs
->
rx_ë
[0].
off£t
 << 12) |

4712 (
…defs
->
rx_ë
[0].
vÆid
 << 11) |

4713 (
…defs
->
rx_ë
[0].
lid
 << 8) |

4714 (
…defs
->
rx_ë
[0].
…y≥_m©ch
 << 4) |

4715 
…defs
->
rx_ë
[0].
…y≥_mask
);

4716 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_DEF_ET
(1),

4717 (
…defs
->
rx_ë
[1].
off£t
 << 12) |

4718 (
…defs
->
rx_ë
[1].
vÆid
 << 11) |

4719 (
…defs
->
rx_ë
[1].
lid
 << 8) |

4720 (
…defs
->
rx_ë
[1].
…y≥_m©ch
 << 4) |

4721 
…defs
->
rx_ë
[1].
…y≥_mask
);

4724 
îr
 = 
	`nix_rx_Êowkey_Æg_cfg
(
rvu
, 
blkaddr
);

4725 i‡(
îr
)

4726  
îr
;

4728 
nix_hw
->
tx_¸edôs
 = 
	`kˇŒoc
(
hw
->
cgx_löks
 + hw->
lbk_löks
,

4729 (
u64
), 
GFP_KERNEL
);

4730 i‡(!
nix_hw
->
tx_¸edôs
)

4731  -
ENOMEM
;

4734 
	`nix_lök_c⁄fig
(
rvu
, 
blkaddr
, 
nix_hw
);

4737 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_CFG
, 
	`BIT_ULL
(0));

4739 
îr
 = 
	`rvu_nix_fixes_öô
(
rvu
, 
nix_hw
, 
blkaddr
);

4740 i‡(
îr
)

4741  
îr
;

4743 i‡(
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_CPT0
)) {

4745 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_DEF_IPSECX
(0),

4746 (
…defs
->
rx_ù£c
[0].
lid
 << 8) |

4747 (
…defs
->
rx_ù£c
[0].
…y≥_m©ch
 << 4) |

4748 
…defs
->
rx_ù£c
[0].
…y≥_mask
);

4750 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_DEF_IPSECX
(1),

4751 (
…defs
->
rx_ù£c
[1].
•i_off£t
 << 12) |

4752 (
…defs
->
rx_ù£c
[1].
lid
 << 8) |

4753 (
…defs
->
rx_ù£c
[1].
…y≥_m©ch
 << 4) |

4754 
…defs
->
rx_ù£c
[1].
…y≥_mask
);

4759 
	}
}

4761 
	$rvu_nix_öô
(
rvu
 *rvu)

4763 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

4764 
nix_hw
 *nix_hw;

4765 
blkaddr
 = 0, 
îr
;

4766 
i
 = 0;

4768 
hw
->
nix
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
MAX_NIX_BLKS
, (
nix_hw
),

4769 
GFP_KERNEL
);

4770 i‡(!
hw
->
nix
)

4771  -
ENOMEM
;

4773 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

4774 
blkaddr
) {

4775 
nix_hw
 = &
hw
->
nix
[
i
];

4776 
nix_hw
->
rvu
 =Ñvu;

4777 
nix_hw
->
blkaddr
 = blkaddr;

4778 
îr
 = 
	`rvu_nix_block_öô
(
rvu
, 
nix_hw
);

4779 i‡(
îr
)

4780  
îr
;

4781 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

4782 
i
++;

4786 
	}
}

4788 
	$rvu_nix_block_‰ìmem
(
rvu
 *rvu, 
blkaddr
,

4789 
rvu_block
 *
block
)

4791 
nix_txsch
 *
txsch
;

4792 
nix_mˇ°
 *
mˇ°
;

4793 
nix_txvœn
 *
vœn
;

4794 
nix_hw
 *nix_hw;

4795 
lvl
;

4797 
	`rvu_aq_‰ì
(
rvu
, 
block
->
aq
);

4799 i‡(
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
)) {

4800 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

4801 i‡(!
nix_hw
) {

4802 
	`dev_îr
(
rvu
->
dev
, "UnableÅo free %s memory\n",

4803 
block
->
«me
);

4807 
lvl
 = 0;Üv»< 
NIX_TXSCH_LVL_CNT
;Üvl++) {

4808 
txsch
 = &
nix_hw
->txsch[
lvl
];

4809 
	`k‰ì
(
txsch
->
schq
.
bm≠
);

4812 
	`k‰ì
(
nix_hw
->
tx_¸edôs
);

4814 
	`nix_ùﬁi˚r_‰ìmem
(
rvu
, 
nix_hw
);

4816 
vœn
 = &
nix_hw
->
txvœn
;

4817 
	`k‰ì
(
vœn
->
r§c
.
bm≠
);

4818 
	`muãx_de°roy
(&
vœn
->
r§c_lock
);

4820 
mˇ°
 = &
nix_hw
->mcast;

4821 
	`qmem_‰ì
(
rvu
->
dev
, 
mˇ°
->
m˚_˘x
);

4822 
	`qmem_‰ì
(
rvu
->
dev
, 
mˇ°
->
mˇ°_buf
);

4823 
	`muãx_de°roy
(&
mˇ°
->
m˚_lock
);

4824 
	`rvu_nix_fixes_exô
(
rvu
, 
nix_hw
);

4826 
	}
}

4828 
	$rvu_nix_‰ìmem
(
rvu
 *rvu)

4830 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

4831 
rvu_block
 *
block
;

4832 
blkaddr
 = 0;

4834 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

4835 
blkaddr
) {

4836 
block
 = &
hw
->block[
blkaddr
];

4837 
	`rvu_nix_block_‰ìmem
(
rvu
, 
blkaddr
, 
block
);

4838 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

4840 
	}
}

4842 
	$rvu_mbox_h™dÀr_nix_lf_°¨t_rx
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

4843 
msg_r•
 *
r•
)

4845 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

4846 
rvu_pfvf
 *
pfvf
;

4847 
nixlf
, 
îr
;

4849 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, 
NULL
);

4850 i‡(
îr
)

4851  
îr
;

4853 
	`rvu_≈c_íabÀ_deÁu…_íåõs
(
rvu
, 
pcifunc
, 
nixlf
);

4855 
	`≈c_mˇm_íabÀ_Êows
(
rvu
, 
pcifunc
);

4857 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

4858 
	`£t_bô
(
NIXLF_INITIALIZED
, &
pfvf
->
Êags
);

4860 
	`rvu_swôch_upd©e_ruÀs
(
rvu
, 
pcifunc
);

4862  
	`rvu_cgx_°¨t_°›_io
(
rvu
, 
pcifunc
, 
åue
);

4863 
	}
}

4865 
	$rvu_mbox_h™dÀr_nix_lf_°›_rx
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

4866 
msg_r•
 *
r•
)

4868 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

4869 
rvu_pfvf
 *
pfvf
;

4870 
nixlf
, 
îr
;

4872 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, 
NULL
);

4873 i‡(
îr
)

4874  
îr
;

4876 
	`rvu_≈c_dißbÀ_mˇm_íåõs
(
rvu
, 
pcifunc
, 
nixlf
);

4878 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

4879 
	`˛ór_bô
(
NIXLF_INITIALIZED
, &
pfvf
->
Êags
);

4881 
îr
 = 
	`rvu_cgx_°¨t_°›_io
(
rvu
, 
pcifunc
, 
Ál£
);

4882 i‡(
îr
)

4883  
îr
;

4885 
	`rvu_cgx_tx_íabÀ
(
rvu
, 
pcifunc
, 
åue
);

4888 
	}
}

4890 
	#RX_SA_BASE
 
	`GENMASK_ULL
(52, 7)

	)

4892 
	$rvu_nix_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
blkaddr
, 
nixlf
)

4894 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

4895 
hw˘x_dißbÀ_ªq
 
˘x_ªq
;

4896 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

4897 
u8
 
cgx_id
, 
lmac_id
;

4898 
u64
 
ß_ba£
;

4899 *
cgxd
;

4900 
îr
;

4902 
˘x_ªq
.
hdr
.
pcifunc
 =Öcifunc;

4905 
	`rvu_≈c_dißbÀ_mˇm_íåõs
(
rvu
, 
pcifunc
, 
nixlf
);

4906 
	`rvu_≈c_‰ì_mˇm_íåõs
(
rvu
, 
pcifunc
, 
nixlf
);

4907 
	`nix_öãrÁ˚_deöô
(
rvu
, 
pcifunc
, 
nixlf
);

4908 
	`nix_rx_sync
(
rvu
, 
blkaddr
);

4909 
	`nix_txschq_‰ì
(
rvu
, 
pcifunc
);

4912 
	`rvu_nix_‰ì_•i_to_ß_èbÀ
(
rvu
, 
pcifunc
);

4914 
	`˛ór_bô
(
NIXLF_INITIALIZED
, &
pfvf
->
Êags
);

4916 
	`rvu_cgx_°¨t_°›_io
(
rvu
, 
pcifunc
, 
Ál£
);

4918 i‡(
pfvf
->
sq_˘x
) {

4919 
˘x_ªq
.
˘y≥
 = 
NIX_AQ_CTYPE_SQ
;

4920 
îr
 = 
	`nix_lf_hw˘x_dißbÀ
(
rvu
, &
˘x_ªq
);

4921 i‡(
îr
)

4922 
	`dev_îr
(
rvu
->
dev
, "SQ ctx disable failed\n");

4925 i‡(
pfvf
->
rq_˘x
) {

4926 
˘x_ªq
.
˘y≥
 = 
NIX_AQ_CTYPE_RQ
;

4927 
îr
 = 
	`nix_lf_hw˘x_dißbÀ
(
rvu
, &
˘x_ªq
);

4928 i‡(
îr
)

4929 
	`dev_îr
(
rvu
->
dev
, "RQ ctx disable failed\n");

4932 i‡(
pfvf
->
cq_˘x
) {

4933 
˘x_ªq
.
˘y≥
 = 
NIX_AQ_CTYPE_CQ
;

4934 
îr
 = 
	`nix_lf_hw˘x_dißbÀ
(
rvu
, &
˘x_ªq
);

4935 i‡(
îr
)

4936 
	`dev_îr
(
rvu
->
dev
, "CQ ctx disable failed\n");

4940 i‡(
pfvf
->
hw_rx_t°amp_í
) {

4941 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

4942 
cgxd
 = 
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
);

4943 
	`cgx_lmac_±p_c⁄fig
(
cgxd
, 
lmac_id
, 
Ál£
);

4945 i‡(
	`≈c_c⁄fig_ts_kpua˘i⁄
(
rvu
, 
pf
, 
pcifunc
, 
Ál£
))

4946 
	`dev_îr
(
rvu
->
dev
, "NPC config for PTP failed\n");

4947 
pfvf
->
hw_rx_t°amp_í
 = 
Ál£
;

4951 
	`rvu_≈c_£t_∑r£_mode
(
rvu
, 
pcifunc
, 
OTX2_PRIV_FLAGS_DEFAULT
,

4952 (
PKIND_TX
 | 
PKIND_RX
), 0, 0, 0, 0);

4955 
	`rvu_cgx_¥io_Êow_˘æ_cfg
(
rvu
, 
pcifunc
, 0, 0, 0);

4958 
	`rvu_cgx_cfg_∑u£_‰m
(
rvu
, 
pcifunc
, 0, 0);

4960 
	`nix_˘x_‰ì
(
rvu
, 
pfvf
);

4962 
	`nix_‰ì_Æl_b™d¥of
(
rvu
, 
pcifunc
);

4964 
ß_ba£
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_SA_BASE
(
nixlf
));

4965 i‡(
	`FIELD_GET
(
RX_SA_BASE
, 
ß_ba£
)) {

4966 
îr
 = 
	`rvu_˝t_˘x_Êush
(
rvu
, 
pcifunc
);

4967 i‡(
îr
)

4968 
	`dev_îr
(
rvu
->
dev
,

4969 "CPT ctx flush faûed wôhÉº‹: %d\n", 
îr
);

4972 i‡(
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_CPT0
)) {

4974 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG0
(
nixlf
),

4976 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG1
(
nixlf
),

4978 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_SA_BASE
(
nixlf
),

4981 
	}
}

4983 
	$rvu_mbox_h™dÀr_nix_lf_±p_tx_íabÀ
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

4984 
msg_r•
 *
r•
)

4986 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

4987 
blkaddr
, 
nixlf
, 
îr
, 
pf
;

4988 
u64
 
cfg
;

4990 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

4991 i‡(!
	`is_mac_„©uª_suµ‹ãd
(
rvu
, 
pf
, 
RVU_LMAC_FEAT_PTP
))

4995 i‡(
	`rvu_cgx_is_higig2_íabÀd
(
rvu
, 
	`rvu_gë_pf
(
pcifunc
)))

4996  
NIX_AF_ERR_PTP_CONFIG_FAIL
;

4998 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

4999 i‡(
îr
)

5000  
îr
;

5002 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_CFG
(
nixlf
));

5003 
cfg
 |
	`BIT_ULL
(32);

5004 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_CFG
(
nixlf
), 
cfg
);

5006 
	}
}

5008 
	$rvu_mbox_h™dÀr_nix_lf_±p_tx_dißbÀ
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

5009 
msg_r•
 *
r•
)

5011 
blkaddr
, 
nixlf
, 
îr
;

5012 
u64
 
cfg
;

5014 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
ªq
->
hdr
.
pcifunc
, &
nixlf
, &
blkaddr
);

5015 i‡(
îr
)

5016  
îr
;

5018 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_CFG
(
nixlf
));

5019 
cfg
 &~
	`BIT_ULL
(32);

5020 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_CFG
(
nixlf
), 
cfg
);

5022 
	}
}

5024 
	$rvu_mbox_h™dÀr_nix_lso_f‹m©_cfg
(
rvu
 *rvu,

5025 
nix_lso_f‹m©_cfg
 *
ªq
,

5026 
nix_lso_f‹m©_cfg_r•
 *
r•
)

5028 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

5029 
nix_hw
 *nix_hw;

5030 
rvu_pfvf
 *
pfvf
;

5031 
blkaddr
, 
idx
, 
f
;

5032 
u64
 
ªg
;

5034 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

5035 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

5036 i‡(!
pfvf
->
nixlf
 || 
blkaddr
 < 0)

5037  
NIX_AF_ERR_AF_LF_INVALID
;

5039 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

5040 i‡(!
nix_hw
)

5041  
NIX_AF_ERR_INVALID_NIXBLK
;

5044 
idx
 = 0; idx < 
nix_hw
->
lso
.
ö_u£
; idx++) {

5045 
f
 = 0; f < 
NIX_LSO_FIELD_MAX
; f++) {

5046 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

5047 
	`NIX_AF_LSO_FORMATX_FIELDX
(
idx
, 
f
));

5048 i‡(
ªq
->
fõlds
[
f
] !(
ªg
 &Ñeq->
fõld_mask
))

5052 i‡(
f
 =
NIX_LSO_FIELD_MAX
)

5056 i‡(
idx
 < 
nix_hw
->
lso
.
ö_u£
) {

5058 
r•
->
lso_f‹m©_idx
 = 
idx
;

5062 i‡(
nix_hw
->
lso
.
ö_u£
 =nix_hw->lso.
tŸÆ
)

5063  
NIX_AF_ERR_LSO_CFG_FAIL
;

5065 
r•
->
lso_f‹m©_idx
 = 
nix_hw
->
lso
.
ö_u£
++;

5067 
f
 = 0; f < 
NIX_LSO_FIELD_MAX
; f++)

5068 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

5069 
	`NIX_AF_LSO_FORMATX_FIELDX
(
r•
->
lso_f‹m©_idx
, 
f
),

5070 
ªq
->
fõlds
[
f
]);

5073 
	}
}

5075 
	$rvu_mbox_h™dÀr_nix_£t_vœn_çid
(
rvu
 *rvu,

5076 
nix_£t_vœn_çid
 *
ªq
,

5077 
msg_r•
 *
r•
)

5079 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

5080 
nixlf
, 
îr
, 
blkaddr
;

5081 
u64
 
cfg
;

5083 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

5084 i‡(
îr
)

5085  
îr
;

5087 i‡(
ªq
->
vœn_ty≥
 !
NIX_VLAN_TYPE_OUTER
 &&

5088 
ªq
->
vœn_ty≥
 !
NIX_VLAN_TYPE_INNER
)

5089  
NIX_AF_ERR_PARAM
;

5091 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_CFG
(
nixlf
));

5093 i‡(
ªq
->
vœn_ty≥
 =
NIX_VLAN_TYPE_OUTER
)

5094 
cfg
 = (cfg & ~
	`GENMASK_ULL
(15, 0)Ë| 
ªq
->
çid
;

5096 
cfg
 = (cfg & ~
	`GENMASK_ULL
(31, 16)Ë| ((
u64
)
ªq
->
çid
 << 16);

5098 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_CFG
(
nixlf
), 
cfg
);

5100 
	}
}

5102 
	#IPSEC_GEN_CFG_EGRP
 
	`GENMASK_ULL
(50, 48)

	)

5103 
	#IPSEC_GEN_CFG_OPCODE
 
	`GENMASK_ULL
(47, 32)

	)

5104 
	#IPSEC_GEN_CFG_PARAM1
 
	`GENMASK_ULL
(31, 16)

	)

5105 
	#IPSEC_GEN_CFG_PARAM2
 
	`GENMASK_ULL
(15, 0)

	)

5107 
	#CPT_INST_QSEL_BLOCK
 
	`GENMASK_ULL
(28, 24)

	)

5108 
	#CPT_INST_QSEL_PF_FUNC
 
	`GENMASK_ULL
(23, 8)

	)

5109 
	#CPT_INST_QSEL_SLOT
 
	`GENMASK_ULL
(7, 0)

	)

5111 
	$nix_ölöe_ù£c_cfg
(
rvu
 *rvu, 
nix_ölöe_ù£c_cfg
 *
ªq
,

5112 
blkaddr
)

5114 
u8
 
˝t_idx
, 
˝t_blkaddr
;

5115 
u64
 
vÆ
;

5117 
˝t_idx
 = (
blkaddr
 =
BLKADDR_NIX0
) ? 0 : 1;

5118 i‡(
ªq
->
íabÀ
) {

5120 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

5121 
vÆ
 = 
	`BIT_ULL
(51);

5124 
vÆ
 |
	`FIELD_PREP
(
IPSEC_GEN_CFG_EGRP
, 
ªq
->
gí_cfg
.
egΩ
);

5125 
vÆ
 |
	`FIELD_PREP
(
IPSEC_GEN_CFG_OPCODE
, 
ªq
->
gí_cfg
.
›code
);

5126 
vÆ
 |
	`FIELD_PREP
(
IPSEC_GEN_CFG_PARAM1
, 
ªq
->
gí_cfg
.
∑øm1
);

5127 
vÆ
 |
	`FIELD_PREP
(
IPSEC_GEN_CFG_PARAM2
, 
ªq
->
gí_cfg
.
∑øm2
);

5129 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_IPSEC_GEN_CFG
, 
vÆ
);

5132 
vÆ
 = 
	`FIELD_PREP
(
CPT_INST_QSEL_SLOT
, 
ªq
->
ö°_q£l
.
˝t_¶Ÿ
);

5133 
vÆ
 |
	`FIELD_PREP
(
CPT_INST_QSEL_PF_FUNC
,

5134 
ªq
->
ö°_q£l
.
˝t_pf_func
);

5136 i‡(!
	`is_rvu_Ÿx2
(
rvu
)) {

5137 
˝t_blkaddr
 = (
˝t_idx
 =0Ë? 
BLKADDR_CPT0
 :

5138 
BLKADDR_CPT1
;

5139 
vÆ
 |
	`FIELD_PREP
(
CPT_INST_QSEL_BLOCK
, 
˝t_blkaddr
);

5142 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_CPTX_INST_QSEL
(
˝t_idx
),

5143 
vÆ
);

5146 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_CPTX_CREDIT
(
˝t_idx
),

5147 
ªq
->
˝t_¸edô
);

5149 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_IPSEC_GEN_CFG
, 0x0);

5150 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_CPTX_INST_QSEL
(
˝t_idx
),

5152 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_RX_CPTX_CREDIT
(
˝t_idx
),

5155 
	}
}

5157 
	$rvu_mbox_h™dÀr_nix_ölöe_ù£c_cfg
(
rvu
 *rvu,

5158 
nix_ölöe_ù£c_cfg
 *
ªq
,

5159 
msg_r•
 *
r•
)

5161 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_CPT0
))

5164 
	`nix_ölöe_ù£c_cfg
(
rvu
, 
ªq
, 
BLKADDR_NIX0
);

5165 i‡(
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_CPT1
))

5166 
	`nix_ölöe_ù£c_cfg
(
rvu
, 
ªq
, 
BLKADDR_NIX1
);

5169 
	}
}

5171 
	$rvu_mbox_h™dÀr_nix_ªad_ölöe_ù£c_cfg
(
rvu
 *rvu,

5172 
msg_ªq
 *
ªq
,

5173 
nix_ölöe_ù£c_cfg
 *
r•
)

5176 
u64
 
vÆ
;

5178 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_CPT0
))

5181 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NIX0
, 
NIX_AF_RX_IPSEC_GEN_CFG
);

5182 
r•
->
gí_cfg
.
egΩ
 = 
	`FIELD_GET
(
IPSEC_GEN_CFG_EGRP
, 
vÆ
);

5183 
r•
->
gí_cfg
.
›code
 = 
	`FIELD_GET
(
IPSEC_GEN_CFG_OPCODE
, 
vÆ
);

5184 
r•
->
gí_cfg
.
∑øm1
 = 
	`FIELD_GET
(
IPSEC_GEN_CFG_PARAM1
, 
vÆ
);

5185 
r•
->
gí_cfg
.
∑øm2
 = 
	`FIELD_GET
(
IPSEC_GEN_CFG_PARAM2
, 
vÆ
);

5187 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NIX0
, 
	`NIX_AF_RX_CPTX_CREDIT
(0));

5188 
r•
->
˝t_¸edô
 = 
vÆ
 & 0x3FFFFF;

5191 
	}
}

5193 
	$rvu_mbox_h™dÀr_nix_ölöe_ù£c_lf_cfg
(

5194 
rvu
 *rvu, 
nix_ölöe_ù£c_lf_cfg
 *
ªq
, 
msg_r•
 *
r•
)

5196 
lf
, 
blkaddr
, 
îr
;

5197 
u64
 
vÆ
;

5199 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_CPT0
))

5202 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
ªq
->
hdr
.
pcifunc
, &
lf
, &
blkaddr
);

5203 i‡(
îr
)

5204  
îr
;

5206 i‡(
ªq
->
íabÀ
) {

5208 
vÆ
 = (
u64
)
ªq
->
ù£c_cfg0
.
â
 << 44 |

5209 (
u64
)
ªq
->
ù£c_cfg0
.
èg_c⁄°
 << 20 |

5210 (
u64
)
ªq
->
ù£c_cfg0
.
ß_pow2_size
 << 16 |

5211 
ªq
->
ù£c_cfg0
.
Ànm1_max
;

5213 i‡(
blkaddr
 =
BLKADDR_NIX1
)

5214 
vÆ
 |
	`BIT_ULL
(46);

5216 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG0
(
lf
), 
vÆ
);

5219 
vÆ
 = (
u64
)
ªq
->
ù£c_cfg1
.
ß_idx_w
 << 32 |

5220 
ªq
->
ù£c_cfg1
.
ß_idx_max
;

5221 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG1
(
lf
), 
vÆ
);

5224 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_SA_BASE
(
lf
),

5225 
ªq
->
ß_ba£_addr
);

5227 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG0
(
lf
), 0x0);

5228 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG1
(
lf
), 0x0);

5229 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_SA_BASE
(
lf
),

5234 
	}
}

5236 
	$rvu_nix_ª£t_mac
(
rvu_pfvf
 *
pfvf
, 
pcifunc
)

5238 
boﬁ
 
‰om_vf
 = !!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
);

5241 i‡(
‰om_vf
)

5242 
	`ëhî_addr_c›y
(
pfvf
->
mac_addr
,Öfvf->
deÁu…_mac
);

5243 
	}
}

5245 
boﬁ
 
	$rvu_nix_is_±p_tx_íabÀd
(
rvu
 *rvu, 
u16
 
pcifunc
)

5247 
blkaddr
, 
nixlf
, 
îr
;

5248 
u64
 
cfg
;

5250 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

5251 i‡(
îr
)

5252  
Ál£
;

5254 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_CFG
(
nixlf
));

5255  (
cfg
 & 
	`BIT_ULL
(32));

5256 
	}
}

5259 
	$nix_c⁄fig_rx_pkt_pﬁi˚r_¥ecﬁ‹
(
rvu
 *rvu, 
blkaddr
)

5261 
≈c_…_def_cfg
 
defs
, *
…defs
;

5263 
…defs
 = &
defs
;

5264 
	`mem˝y
(
…defs
, 
rvu
->
kpu
.
…_def
, (
≈c_…_def_cfg
));

5271 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_VLAN0_PCP_DEI
,

5272 (2UL << 12Ë| (
…defs
->
ovœn
.
lid
 << 8) |

5273 (
…defs
->
ovœn
.
…y≥_m©ch
 << 4) |

5274 
…defs
->
ovœn
.
…y≥_mask
);

5275 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_VLAN1_PCP_DEI
,

5276 (2UL << 12Ë| (
…defs
->
ivœn
.
lid
 << 8) |

5277 (
…defs
->
ivœn
.
…y≥_m©ch
 << 4) |

5278 
…defs
->
ivœn
.
…y≥_mask
);

5281 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_OIP4_DSCP
,

5282 (1UL << 12Ë| (
…defs
->
rx_où4
.
lid
 << 8) |

5283 (
…defs
->
rx_où4
.
…y≥_m©ch
 << 4) |

5284 
…defs
->
rx_où4
.
…y≥_mask
);

5285 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_IIP4_DSCP
,

5286 (1UL << 12Ë| (
…defs
->
rx_iù4
.
lid
 << 8) |

5287 (
…defs
->
rx_iù4
.
…y≥_m©ch
 << 4) |

5288 
…defs
->
rx_iù4
.
…y≥_mask
);

5291 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_OIP6_DSCP
,

5292 (1UL << 11Ë| (
…defs
->
rx_où6
.
lid
 << 8) |

5293 (
…defs
->
rx_où6
.
…y≥_m©ch
 << 4) |

5294 
…defs
->
rx_où6
.
…y≥_mask
);

5295 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_RX_DEF_IIP6_DSCP
,

5296 (1UL << 11Ë| (
…defs
->
rx_iù6
.
lid
 << 8) |

5297 (
…defs
->
rx_iù6
.
…y≥_m©ch
 << 4) |

5298 
…defs
->
rx_iù6
.
…y≥_mask
);

5299 
	}
}

5301 
	$nix_öô_pﬁi˚r_c⁄ãxt
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

5302 
œyî
, 
¥of_idx
)

5304 
nix_˙10k_aq_íq_ªq
 
aq_ªq
;

5305 
rc
;

5307 
	`mem£t
(&
aq_ªq
, 0, (
nix_˙10k_aq_íq_ªq
));

5309 
aq_ªq
.
qidx
 = (
¥of_idx
 & 0x3FFFË| (
œyî
 << 14);

5310 
aq_ªq
.
˘y≥
 = 
NIX_AQ_CTYPE_BANDPROF
;

5311 
aq_ªq
.
›
 = 
NIX_AQ_INSTOP_INIT
;

5314 
rc
 = 
	`rvu_nix_blk_aq_íq_ö°
(
rvu
, 
nix_hw
,

5315 (
nix_aq_íq_ªq
 *)&
aq_ªq
, 
NULL
);

5316 i‡(
rc
)

5317 
	`dev_îr
(
rvu
->
dev
, "FailedÅo INIT bandwidthÖrofileÜayer %dÖrofile %d\n",

5318 
œyî
, 
¥of_idx
);

5319  
rc
;

5320 
	}
}

5322 
	$nix_£tup_ùﬁi˚rs
(
rvu
 *rvu,

5323 
nix_hw
 *nix_hw, 
blkaddr
)

5325 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

5326 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

5327 
îr
, 
œyî
, 
¥of_idx
;

5328 
u64
 
cfg
;

5330 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST
);

5331 i‡(!(
cfg
 & 
	`BIT_ULL
(61))) {

5332 
hw
->
ˇp
.
ùﬁi˚r
 = 
Ál£
;

5336 
hw
->
ˇp
.
ùﬁi˚r
 = 
åue
;

5337 
nix_hw
->
ùﬁi˚r
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
BAND_PROF_NUM_LAYERS
,

5338 (*
ùﬁi˚r
), 
GFP_KERNEL
);

5339 i‡(!
nix_hw
->
ùﬁi˚r
)

5340  -
ENOMEM
;

5342 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_PL_CONST
);

5344 
œyî
 = 0;Üayî < 
BAND_PROF_NUM_LAYERS
;Üayer++) {

5345 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
œyî
];

5346 
œyî
) {

5347 
BAND_PROF_LEAF_LAYER
:

5348 
ùﬁi˚r
->
b™d_¥of
.
max
 = 
cfg
 & 0XFFFF;

5350 
BAND_PROF_MID_LAYER
:

5351 
ùﬁi˚r
->
b™d_¥of
.
max
 = (
cfg
 >> 16) & 0XFFFF;

5353 
BAND_PROF_TOP_LAYER
:

5354 
ùﬁi˚r
->
b™d_¥of
.
max
 = (
cfg
 >> 32) & 0XFFFF;

5358 i‡(!
ùﬁi˚r
->
b™d_¥of
.
max
)

5361 
îr
 = 
	`rvu_Æloc_bôm≠
(&
ùﬁi˚r
->
b™d_¥of
);

5362 i‡(
îr
)

5363  
îr
;

5365 
ùﬁi˚r
->
pfvf_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
,

5366 
ùﬁi˚r
->
b™d_¥of
.
max
,

5367 (
u16
), 
GFP_KERNEL
);

5368 i‡(!
ùﬁi˚r
->
pfvf_m≠
)

5369  -
ENOMEM
;

5371 
ùﬁi˚r
->
m©ch_id
 = 
	`devm_kˇŒoc
(
rvu
->
dev
,

5372 
ùﬁi˚r
->
b™d_¥of
.
max
,

5373 (
u16
), 
GFP_KERNEL
);

5374 i‡(!
ùﬁi˚r
->
m©ch_id
)

5375  -
ENOMEM
;

5377 
¥of_idx
 = 0;

5378 
¥of_idx
 < 
ùﬁi˚r
->
b™d_¥of
.
max
;Örof_idx++) {

5380 
ùﬁi˚r
->
pfvf_m≠
[
¥of_idx
] = 0x00;

5387 
îr
 = 
	`nix_öô_pﬁi˚r_c⁄ãxt
(
rvu
, 
nix_hw
,

5388 
œyî
, 
¥of_idx
);

5389 i‡(
îr
)

5390  
îr
;

5397 i‡(
œyî
 !
BAND_PROF_MID_LAYER
)

5400 
ùﬁi˚r
->
ªf_cou¡
 = 
	`devm_kˇŒoc
(
rvu
->
dev
,

5401 
ùﬁi˚r
->
b™d_¥of
.
max
,

5402 (
u16
), 
GFP_KERNEL
);

5406 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_PL_TS
, 19);

5408 
	`nix_c⁄fig_rx_pkt_pﬁi˚r_¥ecﬁ‹
(
rvu
, 
blkaddr
);

5411 
	}
}

5413 
	$nix_ùﬁi˚r_‰ìmem
(
rvu
 *rvu, 
nix_hw
 *nix_hw)

5415 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

5416 
œyî
;

5418 i‡(!
rvu
->
hw
->
ˇp
.
ùﬁi˚r
)

5421 
œyî
 = 0;Üayî < 
BAND_PROF_NUM_LAYERS
;Üayer++) {

5422 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
œyî
];

5424 i‡(!
ùﬁi˚r
->
b™d_¥of
.
max
)

5427 
	`k‰ì
(
ùﬁi˚r
->
b™d_¥of
.
bm≠
);

5429 
	}
}

5431 
	$nix_vîify_b™d¥of
(
nix_˙10k_aq_íq_ªq
 *
ªq
,

5432 
nix_hw
 *nix_hw, 
u16
 
pcifunc
)

5434 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

5435 
œyî
, 
hi_œyî
, 
¥of_idx
;

5438 
œyî
 = (
ªq
->
qidx
 >> 14) & 0x03;

5439 
¥of_idx
 = 
ªq
->
qidx
 & 0x3FFF;

5441 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
œyî
];

5442 i‡(
¥of_idx
 >
ùﬁi˚r
->
b™d_¥of
.
max
)

5443  -
EINVAL
;

5448 i‡(
pcifunc
 && 
ùﬁi˚r
->
pfvf_m≠
[
¥of_idx
] !=Öcifunc)

5449  -
EINVAL
;

5455 i‡(!
ªq
->
¥of
.
hl_í
)

5461 i‡(
œyî
 =
BAND_PROF_LEAF_LAYER
)

5462 
hi_œyî
 = 
BAND_PROF_MID_LAYER
;

5463 i‡(
œyî
 =
BAND_PROF_MID_LAYER
)

5464 
hi_œyî
 = 
BAND_PROF_TOP_LAYER
;

5466  -
EINVAL
;

5468 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
hi_œyî
];

5469 
¥of_idx
 = 
ªq
->
¥of
.
b™d_¥of_id
;

5470 i‡(
¥of_idx
 >
ùﬁi˚r
->
b™d_¥of
.
max
 ||

5471 
ùﬁi˚r
->
pfvf_m≠
[
¥of_idx
] !
pcifunc
)

5472  -
EINVAL
;

5475 
	}
}

5477 
	$rvu_mbox_h™dÀr_nix_b™d¥of_Æloc
(
rvu
 *rvu,

5478 
nix_b™d¥of_Æloc_ªq
 *
ªq
,

5479 
nix_b™d¥of_Æloc_r•
 *
r•
)

5481 
blkaddr
, 
œyî
, 
¥of
, 
idx
, 
îr
;

5482 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

5483 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

5484 
nix_hw
 *nix_hw;

5486 i‡(!
rvu
->
hw
->
ˇp
.
ùﬁi˚r
)

5487  
NIX_AF_ERR_IPOLICER_NOTSUPP
;

5489 
îr
 = 
	`nix_gë_°ru˘_±rs
(
rvu
, 
pcifunc
, &
nix_hw
, &
blkaddr
);

5490 i‡(
îr
)

5491  
îr
;

5493 
	`muãx_lock
(&
rvu
->
r§c_lock
);

5494 
œyî
 = 0;Üayî < 
BAND_PROF_NUM_LAYERS
;Üayer++) {

5495 i‡(
œyî
 =
BAND_PROF_INVAL_LAYER
)

5497 i‡(!
ªq
->
¥of_cou¡
[
œyî
])

5500 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
œyî
];

5501 
idx
 = 0; idx < 
ªq
->
¥of_cou¡
[
œyî
]; idx++) {

5503 i‡(
idx
 =
MAX_BANDPROF_PER_PFFUNC
)

5506 
¥of
 = 
	`rvu_Æloc_r§c
(&
ùﬁi˚r
->
b™d_¥of
);

5507 i‡(
¥of
 < 0)

5509 
r•
->
¥of_cou¡
[
œyî
]++;

5510 
r•
->
¥of_idx
[
œyî
][
idx
] = 
¥of
;

5511 
ùﬁi˚r
->
pfvf_m≠
[
¥of
] = 
pcifunc
;

5514 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5516 
	}
}

5518 
	$nix_‰ì_Æl_b™d¥of
(
rvu
 *rvu, 
u16
 
pcifunc
)

5520 
blkaddr
, 
œyî
, 
¥of_idx
, 
îr
;

5521 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

5522 
nix_hw
 *nix_hw;

5524 i‡(!
rvu
->
hw
->
ˇp
.
ùﬁi˚r
)

5525  
NIX_AF_ERR_IPOLICER_NOTSUPP
;

5527 
îr
 = 
	`nix_gë_°ru˘_±rs
(
rvu
, 
pcifunc
, &
nix_hw
, &
blkaddr
);

5528 i‡(
îr
)

5529  
îr
;

5531 
	`muãx_lock
(&
rvu
->
r§c_lock
);

5533 
œyî
 = 0;Üayî < 
BAND_PROF_NUM_LAYERS
;Üayer++) {

5534 i‡(
œyî
 =
BAND_PROF_INVAL_LAYER
)

5536 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
œyî
];

5538 
¥of_idx
 = 0;Örof_idx < 
ùﬁi˚r
->
b™d_¥of
.
max
;Örof_idx++) {

5539 i‡(
ùﬁi˚r
->
pfvf_m≠
[
¥of_idx
] !
pcifunc
)

5543 i‡(
œyî
 =
BAND_PROF_LEAF_LAYER
 &&

5544 
ùﬁi˚r
->
m©ch_id
[
¥of_idx
])

5545 
	`nix_˛ór_øãlimô_aggr
(
rvu
, 
nix_hw
, 
¥of_idx
);

5547 
ùﬁi˚r
->
pfvf_m≠
[
¥of_idx
] = 0x00;

5548 
ùﬁi˚r
->
m©ch_id
[
¥of_idx
] = 0;

5549 
	`rvu_‰ì_r§c
(&
ùﬁi˚r
->
b™d_¥of
, 
¥of_idx
);

5552 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5554 
	}
}

5556 
	$rvu_mbox_h™dÀr_nix_b™d¥of_‰ì
(
rvu
 *rvu,

5557 
nix_b™d¥of_‰ì_ªq
 *
ªq
,

5558 
msg_r•
 *
r•
)

5560 
blkaddr
, 
œyî
, 
¥of_idx
, 
idx
, 
îr
;

5561 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

5562 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

5563 
nix_hw
 *nix_hw;

5565 i‡(
ªq
->
‰ì_Æl
)

5566  
	`nix_‰ì_Æl_b™d¥of
(
rvu
, 
pcifunc
);

5568 i‡(!
rvu
->
hw
->
ˇp
.
ùﬁi˚r
)

5569  
NIX_AF_ERR_IPOLICER_NOTSUPP
;

5571 
îr
 = 
	`nix_gë_°ru˘_±rs
(
rvu
, 
pcifunc
, &
nix_hw
, &
blkaddr
);

5572 i‡(
îr
)

5573  
îr
;

5575 
	`muãx_lock
(&
rvu
->
r§c_lock
);

5577 
œyî
 = 0;Üayî < 
BAND_PROF_NUM_LAYERS
;Üayer++) {

5578 i‡(
œyî
 =
BAND_PROF_INVAL_LAYER
)

5580 i‡(!
ªq
->
¥of_cou¡
[
œyî
])

5583 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
œyî
];

5584 
idx
 = 0; idx < 
ªq
->
¥of_cou¡
[
œyî
]; idx++) {

5585 
¥of_idx
 = 
ªq
->¥of_idx[
œyî
][
idx
];

5586 i‡(
¥of_idx
 >
ùﬁi˚r
->
b™d_¥of
.
max
 ||

5587 
ùﬁi˚r
->
pfvf_m≠
[
¥of_idx
] !
pcifunc
)

5591 i‡(
œyî
 =
BAND_PROF_LEAF_LAYER
 &&

5592 
ùﬁi˚r
->
m©ch_id
[
¥of_idx
])

5593 
	`nix_˛ór_øãlimô_aggr
(
rvu
, 
nix_hw
, 
¥of_idx
);

5595 
ùﬁi˚r
->
pfvf_m≠
[
¥of_idx
] = 0x00;

5596 
ùﬁi˚r
->
m©ch_id
[
¥of_idx
] = 0;

5597 
	`rvu_‰ì_r§c
(&
ùﬁi˚r
->
b™d_¥of
, 
¥of_idx
);

5598 i‡(
idx
 =
MAX_BANDPROF_PER_PFFUNC
)

5602 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5604 
	}
}

5606 
	$nix_aq_c⁄ãxt_ªad
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

5607 
nix_˙10k_aq_íq_ªq
 *
aq_ªq
,

5608 
nix_˙10k_aq_íq_r•
 *
aq_r•
,

5609 
u16
 
pcifunc
, 
u8
 
˘y≥
, 
u32
 
qidx
)

5611 
	`mem£t
(
aq_ªq
, 0, (
nix_˙10k_aq_íq_ªq
));

5612 
aq_ªq
->
hdr
.
pcifunc
 =Öcifunc;

5613 
aq_ªq
->
˘y≥
 = ctype;

5614 
aq_ªq
->
›
 = 
NIX_AQ_INSTOP_READ
;

5615 
aq_ªq
->
qidx
 = qidx;

5617  
	`rvu_nix_blk_aq_íq_ö°
(
rvu
, 
nix_hw
,

5618 (
nix_aq_íq_ªq
 *)
aq_ªq
,

5619 (
nix_aq_íq_r•
 *)
aq_r•
);

5620 
	}
}

5622 
	$nix_ùﬁi˚r_m≠_Àaf_mid¥ofs
(
rvu
 *rvu,

5623 
nix_hw
 *nix_hw,

5624 
nix_˙10k_aq_íq_ªq
 *
aq_ªq
,

5625 
nix_˙10k_aq_íq_r•
 *
aq_r•
,

5626 
u32
 
Àaf_¥of
, 
u16
 
mid_¥of
)

5628 
	`mem£t
(
aq_ªq
, 0, (
nix_˙10k_aq_íq_ªq
));

5629 
aq_ªq
->
hdr
.
pcifunc
 = 0x00;

5630 
aq_ªq
->
˘y≥
 = 
NIX_AQ_CTYPE_BANDPROF
;

5631 
aq_ªq
->
›
 = 
NIX_AQ_INSTOP_WRITE
;

5632 
aq_ªq
->
qidx
 = 
Àaf_¥of
;

5634 
aq_ªq
->
¥of
.
b™d_¥of_id
 = 
mid_¥of
;

5635 
aq_ªq
->
¥of_mask
.
b™d_¥of_id
 = 
	`GENMASK
(6, 0);

5636 
aq_ªq
->
¥of
.
hl_í
 = 1;

5637 
aq_ªq
->
¥of_mask
.
hl_í
 = 1;

5639  
	`rvu_nix_blk_aq_íq_ö°
(
rvu
, 
nix_hw
,

5640 (
nix_aq_íq_ªq
 *)
aq_ªq
,

5641 (
nix_aq_íq_r•
 *)
aq_r•
);

5642 
	}
}

5644 
	$rvu_nix_£tup_øãlimô_aggr
(
rvu
 *rvu, 
u16
 
pcifunc
,

5645 
u16
 
rq_idx
, u16 
m©ch_id
)

5647 
Àaf_¥of
, 
mid_¥of
, 
Àaf_m©ch
;

5648 
nix_˙10k_aq_íq_ªq
 
aq_ªq
;

5649 
nix_˙10k_aq_íq_r•
 
aq_r•
;

5650 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

5651 
nix_hw
 *nix_hw;

5652 
blkaddr
, 
idx
, 
rc
;

5654 i‡(!
rvu
->
hw
->
ˇp
.
ùﬁi˚r
)

5657 
rc
 = 
	`nix_gë_°ru˘_±rs
(
rvu
, 
pcifunc
, &
nix_hw
, &
blkaddr
);

5658 i‡(
rc
)

5659  
rc
;

5662 
rc
 = 
	`nix_aq_c⁄ãxt_ªad
(
rvu
, 
nix_hw
, &
aq_ªq
, &
aq_r•
, 
pcifunc
,

5663 
NIX_AQ_CTYPE_RQ
, 
rq_idx
);

5664 i‡(
rc
) {

5665 
	`dev_îr
(
rvu
->
dev
,

5667 
__func__
, 
rq_idx
, 
pcifunc
);

5668  
rc
;

5671 i‡(!
aq_r•
.
rq
.
pﬁi˚r_ía
)

5675 
Àaf_¥of
 = 
aq_r•
.
rq
.
b™d_¥of_id
;

5677 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
BAND_PROF_LEAF_LAYER
];

5678 
ùﬁi˚r
->
m©ch_id
[
Àaf_¥of
] = match_id;

5681 
idx
 = 0; idx < 
ùﬁi˚r
->
b™d_¥of
.
max
; idx++) {

5682 i‡(
idx
 =
Àaf_¥of
)

5684 i‡(
ùﬁi˚r
->
m©ch_id
[
idx
] != match_id)

5687 
Àaf_m©ch
 = 
idx
;

5691 i‡(
idx
 =
ùﬁi˚r
->
b™d_¥of
.
max
)

5697 
rc
 = 
	`nix_aq_c⁄ãxt_ªad
(
rvu
, 
nix_hw
, &
aq_ªq
, &
aq_r•
, 0x00,

5698 
NIX_AQ_CTYPE_BANDPROF
, 
Àaf_m©ch
);

5699 i‡(
rc
) {

5700 
	`dev_îr
(
rvu
->
dev
,

5702 
__func__
, 
Àaf_m©ch
);

5703  
rc
;

5706 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
BAND_PROF_MID_LAYER
];

5707 i‡(
aq_r•
.
¥of
.
hl_í
) {

5713 
mid_¥of
 = 
aq_r•
.
¥of
.
b™d_¥of_id
;

5714 
rc
 = 
	`nix_ùﬁi˚r_m≠_Àaf_mid¥ofs
(
rvu
, 
nix_hw
,

5715 &
aq_ªq
, &
aq_r•
,

5716 
Àaf_¥of
, 
mid_¥of
);

5717 i‡(
rc
) {

5718 
	`dev_îr
(
rvu
->
dev
,

5720 
__func__
, 
Àaf_¥of
, 
mid_¥of
);

5721 
exô
;

5724 
	`muãx_lock
(&
rvu
->
r§c_lock
);

5725 
ùﬁi˚r
->
ªf_cou¡
[
mid_¥of
]++;

5726 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5727 
exô
;

5733 
	`muãx_lock
(&
rvu
->
r§c_lock
);

5734 
mid_¥of
 = 
	`rvu_Æloc_r§c
(&
ùﬁi˚r
->
b™d_¥of
);

5735 i‡(
mid_¥of
 < 0) {

5736 
	`dev_îr
(
rvu
->
dev
,

5737 "%s: U«bÀÅÿÆloˇã midÜayîÖrofûe\n", 
__func__
);

5738 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5739 
exô
;

5741 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5742 
ùﬁi˚r
->
pfvf_m≠
[
mid_¥of
] = 0x00;

5743 
ùﬁi˚r
->
ªf_cou¡
[
mid_¥of
] = 0;

5746 
rc
 = 
	`nix_aq_c⁄ãxt_ªad
(
rvu
, 
nix_hw
, &
aq_ªq
, &
aq_r•
, 0x00,

5747 
NIX_AQ_CTYPE_BANDPROF
, 
Àaf_¥of
);

5748 i‡(
rc
) {

5749 
	`dev_îr
(
rvu
->
dev
,

5751 
__func__
, 
Àaf_¥of
);

5752 
exô
;

5755 
	`mem£t
(&
aq_ªq
, 0, (
nix_˙10k_aq_íq_ªq
));

5756 
aq_ªq
.
hdr
.
pcifunc
 = 0x00;

5757 
aq_ªq
.
qidx
 = (
mid_¥of
 & 0x3FFFË| (
BAND_PROF_MID_LAYER
 << 14);

5758 
aq_ªq
.
˘y≥
 = 
NIX_AQ_CTYPE_BANDPROF
;

5759 
aq_ªq
.
›
 = 
NIX_AQ_INSTOP_WRITE
;

5760 
	`mem˝y
(&
aq_ªq
.
¥of
, &
aq_r•
.¥of, (
nix_b™d¥of_s
));

5761 
	`mem£t
((*)&
aq_ªq
.
¥of_mask
, 0xff, (
nix_b™d¥of_s
));

5763 
aq_ªq
.
¥of
.
hl_í
 = 0;

5764 
aq_ªq
.
¥of_mask
.
hl_í
 = 1;

5766 
rc
 = 
	`rvu_nix_blk_aq_íq_ö°
(
rvu
, 
nix_hw
,

5767 (
nix_aq_íq_ªq
 *)&
aq_ªq
, 
NULL
);

5768 i‡(
rc
) {

5769 
	`dev_îr
(
rvu
->
dev
,

5771 
__func__
, 
mid_¥of
);

5772 
exô
;

5776 
rc
 = 
	`nix_ùﬁi˚r_m≠_Àaf_mid¥ofs
(
rvu
, 
nix_hw
,

5777 &
aq_ªq
, &
aq_r•
,

5778 
Àaf_¥of
, 
mid_¥of
);

5779 i‡(
rc
) {

5780 
	`dev_îr
(
rvu
->
dev
,

5782 
__func__
, 
Àaf_¥of
, 
mid_¥of
);

5783 
exô
;

5786 
	`muãx_lock
(&
rvu
->
r§c_lock
);

5787 
ùﬁi˚r
->
ªf_cou¡
[
mid_¥of
]++;

5788 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5790 
rc
 = 
	`nix_ùﬁi˚r_m≠_Àaf_mid¥ofs
(
rvu
, 
nix_hw
,

5791 &
aq_ªq
, &
aq_r•
,

5792 
Àaf_m©ch
, 
mid_¥of
);

5793 i‡(
rc
) {

5794 
	`dev_îr
(
rvu
->
dev
,

5796 
__func__
, 
Àaf_m©ch
, 
mid_¥of
);

5797 
ùﬁi˚r
->
ªf_cou¡
[
mid_¥of
]--;

5798 
exô
;

5801 
	`muãx_lock
(&
rvu
->
r§c_lock
);

5802 
ùﬁi˚r
->
ªf_cou¡
[
mid_¥of
]++;

5803 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5805 
exô
:

5806  
rc
;

5807 
	}
}

5810 
	$nix_˛ór_øãlimô_aggr
(
rvu
 *rvu, 
nix_hw
 *nix_hw,

5811 
u32
 
Àaf_¥of
)

5813 
nix_˙10k_aq_íq_ªq
 
aq_ªq
;

5814 
nix_˙10k_aq_íq_r•
 
aq_r•
;

5815 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

5816 
u16
 
mid_¥of
;

5817 
rc
;

5819 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5821 
rc
 = 
	`nix_aq_c⁄ãxt_ªad
(
rvu
, 
nix_hw
, &
aq_ªq
, &
aq_r•
, 0x00,

5822 
NIX_AQ_CTYPE_BANDPROF
, 
Àaf_¥of
);

5824 
	`muãx_lock
(&
rvu
->
r§c_lock
);

5825 i‡(
rc
) {

5826 
	`dev_îr
(
rvu
->
dev
,

5828 
__func__
, 
Àaf_¥of
);

5832 i‡(!
aq_r•
.
¥of
.
hl_í
)

5835 
mid_¥of
 = 
aq_r•
.
¥of
.
b™d_¥of_id
;

5836 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
BAND_PROF_MID_LAYER
];

5837 
ùﬁi˚r
->
ªf_cou¡
[
mid_¥of
]--;

5839 i‡(!
ùﬁi˚r
->
ªf_cou¡
[
mid_¥of
]) {

5840 
ùﬁi˚r
->
pfvf_m≠
[
mid_¥of
] = 0x00;

5841 
	`rvu_‰ì_r§c
(&
ùﬁi˚r
->
b™d_¥of
, 
mid_¥of
);

5843 
	}
}

5845 
	$rvu_mbox_h™dÀr_nix_b™d¥of_gë_hwöfo
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

5846 
nix_b™d¥of_gë_hwöfo_r•
 *
r•
)

5848 
nix_ùﬁi˚r
 *
ùﬁi˚r
;

5849 
blkaddr
, 
œyî
, 
îr
;

5850 
nix_hw
 *nix_hw;

5851 
u64
 
tu
;

5853 i‡(!
rvu
->
hw
->
ˇp
.
ùﬁi˚r
)

5854  
NIX_AF_ERR_IPOLICER_NOTSUPP
;

5856 
îr
 = 
	`nix_gë_°ru˘_±rs
(
rvu
, 
ªq
->
hdr
.
pcifunc
, &
nix_hw
, &
blkaddr
);

5857 i‡(
îr
)

5858  
îr
;

5861 
	`muãx_lock
(&
rvu
->
r§c_lock
);

5862 
œyî
 = 0;Üayî < 
BAND_PROF_NUM_LAYERS
;Üayer++) {

5863 i‡(
œyî
 =
BAND_PROF_INVAL_LAYER
)

5866 
ùﬁi˚r
 = &
nix_hw
->ùﬁi˚r[
œyî
];

5867 
r•
->
¥of_cou¡
[
œyî
] = 
	`rvu_r§c_‰ì_cou¡
(&
ùﬁi˚r
->
b™d_¥of
);

5869 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

5872 
tu
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_PL_TS
Ë& 
	`GENMASK_ULL
(9, 0);

5873 
r•
->
pﬁi˚r_timeunô
 = (
tu
 + 1) * 100;

5876 
	}
}

5878 
	$rvu_mbox_h™dÀr_nix_rx_sw_sync
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

5879 
msg_r•
 *
r•
)

5881 
blkaddr
;

5883 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
ªq
->
hdr
.
pcifunc
);

5884 i‡(
blkaddr
 < 0)

5885  
NIX_AF_ERR_AF_LF_INVALID
;

5887 
	`nix_rx_sync
(
rvu
, 
blkaddr
);

5889 
	}
}

5891 
ölöe
 

5892 
	$c⁄figuª_rq_mask
(
rvu
 *rvu, 
blkaddr
, 
nixlf
,

5893 
u8
 
rq_mask
, 
boﬁ
 
íabÀ
)

5895 
u64
 
cfg
;

5896 
u64
 
ªg
;

5898 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG1
(
nixlf
));

5899 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_CFG
(
nixlf
));

5900 i‡(
íabÀ
) {

5901 
cfg
 |
	`BIT_ULL
(43);

5902 
ªg
 = (ªg & ~
	`GENMASK_ULL
(36, 35)Ë| ((
u64
)
rq_mask
 << 35);

5904 
cfg
 &~
	`BIT_ULL
(43);

5905 
ªg
 = (ªg & ~
	`GENMASK_ULL
(36, 35));

5907 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG1
(
nixlf
), 
cfg
);

5908 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_CFG
(
nixlf
), 
ªg
);

5909 
	}
}

5911 
ölöe
 

5912 
	$c⁄figuª_•b_˝t
(
rvu
 *rvu, 
blkaddr
, 
nixlf
,

5913 
nix_rq_˝t_fõld_mask_cfg_ªq
 *
ªq
, 
boﬁ
 
íabÀ
)

5915 
u64
 
cfg
;

5917 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG1
(
nixlf
));

5918 i‡(
íabÀ
) {

5919 
cfg
 |
	`BIT_ULL
(37);

5920 
cfg
 &~
	`GENMASK_ULL
(42, 38);

5921 
cfg
 |((
u64
)
ªq
->
ù£c_cfg1
.
•b_˝t_sizem1
 << 38);

5922 
cfg
 &~
	`GENMASK_ULL
(63, 44);

5923 
cfg
 |((
u64
)
ªq
->
ù£c_cfg1
.
•b_˝t_auø
 << 44);

5925 
cfg
 &~
	`BIT_ULL
(37);

5926 
cfg
 &~
	`GENMASK_ULL
(42, 38);

5927 
cfg
 &~
	`GENMASK_ULL
(63, 44);

5929 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_RX_IPSEC_CFG1
(
nixlf
), 
cfg
);

5930 
	}
}

5933 
	$nix_ölöe_rq_mask_Æloc
(
rvu
 *rvu,

5934 
nix_rq_˝t_fõld_mask_cfg_ªq
 *
ªq
,

5935 
nix_hw
 *nix_hw, 
blkaddr
)

5937 
u8
 
rq_˝t_mask_£À˘
;

5938 
u64
 
ªg_mask
;

5939 
u64
 
ªg_£t
;

5940 
idx
, 
rq_idx
;

5942 
idx
 = 0; idx < 
nix_hw
->
rq_msk
.
ö_u£
; idx++) {

5943 
rq_idx
 = 0;Ñq_idx < 
RQ_CTX_MASK_MAX
;Ñq_idx++) {

5944 
ªg_mask
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

5945 
	`NIX_AF_RX_RQX_MASKX
(
idx
, 
rq_idx
));

5946 
ªg_£t
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

5947 
	`NIX_AF_RX_RQX_SETX
(
idx
, 
rq_idx
));

5948 i‡(
ªg_mask
 !
ªq
->
rq_˘x_w‹d_mask
[
rq_idx
] &&

5949 
ªg_£t
 !
ªq
->
rq_˘x_w‹d_£t
[
rq_idx
])

5952 i‡(
rq_idx
 =
RQ_CTX_MASK_MAX
)

5956 i‡(
idx
 < 
nix_hw
->
rq_msk
.
ö_u£
) {

5958 
rq_˝t_mask_£À˘
 = 
idx
;

5959  
idx
;

5962 i‡(
nix_hw
->
rq_msk
.
ö_u£
 =nix_hw->rq_msk.
tŸÆ
)

5963  
NIX_AF_ERR_RQ_CPT_MASK
;

5965 
rq_˝t_mask_£À˘
 = 
nix_hw
->
rq_msk
.
ö_u£
++;

5967 
rq_idx
 = 0;Ñq_idx < 
RQ_CTX_MASK_MAX
;Ñq_idx++) {

5968 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

5969 
	`NIX_AF_RX_RQX_MASKX
(
rq_˝t_mask_£À˘
, 
rq_idx
),

5970 
ªq
->
rq_˘x_w‹d_mask
[
rq_idx
]);

5971 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

5972 
	`NIX_AF_RX_RQX_SETX
(
rq_˝t_mask_£À˘
, 
rq_idx
),

5973 
ªq
->
rq_˘x_w‹d_£t
[
rq_idx
]);

5976  
rq_˝t_mask_£À˘
;

5977 
	}
}

5979 
	$rvu_mbox_h™dÀr_nix_lf_ölöe_rq_cfg
(
rvu
 *rvu,

5980 
nix_rq_˝t_fõld_mask_cfg_ªq
 *
ªq
,

5981 
msg_r•
 *
r•
)

5983 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

5984 
nix_hw
 *nix_hw;

5985 
blkaddr
, 
nixlf
;

5986 
rq_mask
, 
îr
;

5988 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
ªq
->
hdr
.
pcifunc
, &
nixlf
, &
blkaddr
);

5989 i‡(
îr
)

5990  
îr
;

5992 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

5993 i‡(!
nix_hw
)

5994  
NIX_AF_ERR_INVALID_NIXBLK
;

5996 i‡(!
hw
->
ˇp
.
£c⁄d_˝t_∑ss
)

5997  
NIX_AF_ERR_INVALID_NIXBLK
;

5999 i‡(
ªq
->
ù£c_cfg1
.
rq_mask_íabÀ
) {

6000 
rq_mask
 = 
	`nix_ölöe_rq_mask_Æloc
(
rvu
, 
ªq
, 
nix_hw
, 
blkaddr
);

6001 i‡(
rq_mask
 < 0)

6002  
NIX_AF_ERR_RQ_CPT_MASK
;

6005 
	`c⁄figuª_rq_mask
(
rvu
, 
blkaddr
, 
nixlf
, 
rq_mask
,

6006 
ªq
->
ù£c_cfg1
.
rq_mask_íabÀ
);

6007 
	`c⁄figuª_•b_˝t
(
rvu
, 
blkaddr
, 
nixlf
, 
ªq
,

6008 
ªq
->
ù£c_cfg1
.
•b_˝t_íabÀ
);

6010 
	}
}

6012 
	$rvu_mbox_h™dÀr_nix_é1_º_¥io
(
rvu
 *rvu,

6013 
nix_é1_º_¥io_ªq
 *
ªq
,

6014 
msg_r•
 *
r•
)

6016 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

6017 
blkaddr
, 
nixlf
, 
schq
, 
îr
;

6018 
rvu_pfvf
 *
pfvf
;

6019 
u16
 
ªgvÆ
;

6021 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

6022 i‡(
îr
)

6023  
îr
;

6025 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

6027 i‡(
	`is_vf
(
pcifunc
))

6028  
NIX_AF_ERR_TL1_RR_PRIO_PERM_DENIED
;

6030 
pfvf
->
é1_º_¥io
 = 
ªq
->tl1_rr_prio;

6033 
schq
 = 
	`nix_gë_tx_lök
(
rvu
, 
pcifunc
);

6034 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL1X_TOPOLOGY
(
schq
));

6035 
ªgvÆ
 &~
	`GENMASK_ULL
(4, 1);

6036 
ªgvÆ
 |
pfvf
->
é1_º_¥io
 << 1;

6037 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_TL1X_TOPOLOGY
(
schq
), 
ªgvÆ
);

6040 
	}
}

	@rvu_nix_spi.c

8 
	~"rvu.h
"

10 
boﬁ
 
	$nix_•i_to_ß_ödex_check_du∂iˇã
(
rvu
 *rvu,

11 
nix_•i_to_ß_add_ªq
 *
ªq
,

12 
nix_•i_to_ß_add_r•
 *
r•
,

13 
blkaddr
, 
öt16_t
 
ödex
, 
u8
 
way
,

14 
boﬁ
 *
is_vÆid
, 
lfidx
)

16 
u32
 
•i_ödex
;

17 
u16
 
m©ch_id
;

18 
boﬁ
 
vÆid
;

19 
u8
 
lfid
;

20 
u64
 
wkey
;

22 
wkey
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SPI_TO_SA_KEYX_WAYX
(
ödex
, 
way
));

23 
•i_ödex
 = (
wkey
 & 0xFFFFFFFF);

24 
m©ch_id
 = ((
wkey
 >> 32) & 0xFFFF);

25 
lfid
 = ((
wkey
 >> 48) & 0x7f);

26 
vÆid
 = ((
wkey
 >> 55) & 0x1);

28 *
is_vÆid
 = 
vÆid
;

29 i‡(!
vÆid
)

32 i‡(
ªq
->
•i_ödex
 =•i_ödex &&Ñeq->
m©ch_id
 == match_id &&

33 
lfidx
 =
lfid
) {

34 
r•
->
hash_ödex
 = 
ödex
;

35 
r•
->
way
 = way;

36 
r•
->
is_du∂iˇã
 = 
åue
;

40 
	}
}

42 
	$nix_•i_to_ß_ödex_èbÀ_upd©e
(
rvu
 *rvu,

43 
nix_•i_to_ß_add_ªq
 *
ªq
,

44 
nix_•i_to_ß_add_r•
 *
r•
,

45 
blkaddr
, 
öt16_t
 
ödex
, 
u8
 
way
,

46 
lfidx
)

48 
u64
 
wvÆue
;

49 
u64
 
wkey
;

51 
wkey
 = (
ªq
->
•i_ödex
 | ((
u64
Ïeq->
m©ch_id
 << 32) |

52 ((
u64
)
lfidx
 < 48Ë| ((u64)
ªq
->
vÆid
 << 55));

53 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SPI_TO_SA_KEYX_WAYX
(
ödex
, 
way
),

54 
wkey
);

55 
wvÆue
 = (
ªq
->
ß_ödex
 & 0xFFFFFFFF);

56 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_SPI_TO_SA_VALUEX_WAYX
(
ödex
, 
way
),

57 
wvÆue
);

58 
r•
->
hash_ödex
 = 
ödex
;

59 
r•
->
way
 = way;

60 
r•
->
is_du∂iˇã
 = 
Ál£
;

61 
	}
}

63 
	$rvu_mbox_h™dÀr_nix_•i_to_ß_dñëe
(
rvu
 *rvu,

64 
nix_•i_to_ß_dñëe_ªq
 *
ªq
,

65 
msg_r•
 *
r•
)

67 
rvu_pfvf
 *
pfvf
, *
∑ª¡_pf
;

68 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

69 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

70 
lfidx
, 
lfid
;

71 
blkaddr
;

72 
u64
 
wvÆue
;

73 
u64
 
wkey
;

74 
ªt
 = 0;

76 i‡(!
hw
->
ˇp
.
•i_to_ßs
)

77  
NIX_AF_ERR_PARAM
;

79 i‡(!
	`is_nixlf_©èched
(
rvu
, 
pcifunc
)) {

80 
ªt
 = 
NIX_AF_ERR_AF_LF_INVALID
;

81 
exô
;

84 
∑ª¡_pf
 = &
rvu
->
pf
[
	`rvu_gë_pf
(
pcifunc
)];

85 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

86 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

87 
lfidx
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

88 i‡(
lfidx
 < 0) {

89 
ªt
 = 
NIX_AF_ERR_AF_LF_INVALID
;

90 
exô
;

93 
	`muãx_lock
(&
rvu
->
r§c_lock
);

95 
wkey
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

96 
	`NIX_AF_SPI_TO_SA_KEYX_WAYX
(
ªq
->
hash_ödex
,

97 
ªq
->
way
));

98 
lfid
 = ((
wkey
 >> 48) & 0x7f);

99 i‡(
lfid
 !
lfidx
) {

100 
ªt
 = 
NIX_AF_ERR_AF_LF_INVALID
;

101 
u∆ock
;

104 
wkey
 = 0;

105 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

106 
	`NIX_AF_SPI_TO_SA_KEYX_WAYX
(
ªq
->
hash_ödex
,Ñeq->
way
),

107 
wkey
);

108 
wvÆue
 = 0;

109 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

110 
	`NIX_AF_SPI_TO_SA_VALUEX_WAYX
(
ªq
->
hash_ödex
,Ñeq->
way
),

111 
wvÆue
);

112 
u∆ock
:

113 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

114 
exô
:

115  
ªt
;

116 
	}
}

118 
	$rvu_mbox_h™dÀr_nix_•i_to_ß_add
(
rvu
 *rvu,

119 
nix_•i_to_ß_add_ªq
 *
ªq
,

120 
nix_•i_to_ß_add_r•
 *
r•
)

122 
u16
 
way0_ödex
, 
way1_ödex
, 
way2_ödex
, 
way3_ödex
;

123 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

124 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

125 
boﬁ
 
way0
, 
way1
, 
way2
, 
way3
;

126 
ªt
 = 0;

127 
blkaddr
;

128 
lfidx
;

129 
u64
 
vÆue
;

130 
u64
 
key
;

132 i‡(!
hw
->
ˇp
.
•i_to_ßs
)

133  
NIX_AF_ERR_PARAM
;

135 i‡(!
	`is_nixlf_©èched
(
rvu
, 
pcifunc
)) {

136 
ªt
 = 
NIX_AF_ERR_AF_LF_INVALID
;

137 
exô
;

140 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

141 
lfidx
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

142 i‡(
lfidx
 < 0) {

143 
ªt
 = 
NIX_AF_ERR_AF_LF_INVALID
;

144 
exô
;

147 
	`muãx_lock
(&
rvu
->
r§c_lock
);

149 
key
 = (((
u64
)
lfidx
 << 48Ë| ((u64)
ªq
->
m©ch_id
 << 32Ë|Ñeq->
•i_ödex
);

150 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NIX_AF_SPI_TO_SA_HASH_KEY
, 
key
);

151 
vÆue
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_SPI_TO_SA_HASH_VALUE
);

152 
way0_ödex
 = (
vÆue
 & 0x7ff);

153 
way1_ödex
 = ((
vÆue
 >> 16) & 0x7ff);

154 
way2_ödex
 = ((
vÆue
 >> 32) & 0x7ff);

155 
way3_ödex
 = ((
vÆue
 >> 48) & 0x7ff);

158 i‡(
	`nix_•i_to_ß_ödex_check_du∂iˇã
(
rvu
, 
ªq
, 
r•
, 
blkaddr
,

159 
way0_ödex
, 0, &
way0
, 
lfidx
) ||

160 
	`nix_•i_to_ß_ödex_check_du∂iˇã
(
rvu
, 
ªq
, 
r•
, 
blkaddr
,

161 
way1_ödex
, 1, &
way1
, 
lfidx
) ||

162 
	`nix_•i_to_ß_ödex_check_du∂iˇã
(
rvu
, 
ªq
, 
r•
, 
blkaddr
,

163 
way2_ödex
, 2, &
way2
, 
lfidx
) ||

164 
	`nix_•i_to_ß_ödex_check_du∂iˇã
(
rvu
, 
ªq
, 
r•
, 
blkaddr
,

165 
way3_ödex
, 3, &
way3
, 
lfidx
)) {

166 
ªt
 = 0;

167 
u∆ock
;

171 i‡(!
way0
)

172 
	`nix_•i_to_ß_ödex_èbÀ_upd©e
(
rvu
, 
ªq
, 
r•
, 
blkaddr
,

173 
way0_ödex
, 0, 
lfidx
);

174 i‡(!
way1
)

175 
	`nix_•i_to_ß_ödex_èbÀ_upd©e
(
rvu
, 
ªq
, 
r•
, 
blkaddr
,

176 
way1_ödex
, 1, 
lfidx
);

177 i‡(!
way2
)

178 
	`nix_•i_to_ß_ödex_èbÀ_upd©e
(
rvu
, 
ªq
, 
r•
, 
blkaddr
,

179 
way2_ödex
, 2, 
lfidx
);

180 i‡(!
way3
)

181 
	`nix_•i_to_ß_ödex_èbÀ_upd©e
(
rvu
, 
ªq
, 
r•
, 
blkaddr
,

182 
way3_ödex
, 3, 
lfidx
);

183 
u∆ock
:

184 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

185 
exô
:

186  
ªt
;

187 
	}
}

189 
	$rvu_nix_‰ì_•i_to_ß_èbÀ
(
rvu
 *rvu, 
uöt16_t
 
pcifunc
)

191 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

192 
ödex
, 
way
;

193 
lfidx
, 
lfid
;

194 
blkaddr
;

195 
u64
 
vÆue
;

196 
u64
 
key
;

198 i‡(!
hw
->
ˇp
.
•i_to_ßs
)

201 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

202 
lfidx
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

203 i‡(
lfidx
 < 0)

204  
NIX_AF_ERR_AF_LF_INVALID
;

206 
	`muãx_lock
(&
rvu
->
r§c_lock
);

207 
ödex
 = 0; index < 
hw
->
ˇp
.
•i_to_ßs
; index++) {

208 
way
 = 0; way < 4; way++) {

209 
key
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

210 
	`NIX_AF_SPI_TO_SA_KEYX_WAYX
(
ödex
,

211 
way
));

212 
lfid
 = ((
key
 >> 48) & 0x7f);

213 i‡(
lfid
 =
lfidx
) {

214 
key
 = 0;

215 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

216 
	`NIX_AF_SPI_TO_SA_KEYX_WAYX
(
ödex
,

217 
way
),

218 
key
);

219 
vÆue
 = 0;

220 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

221 
	`NIX_AF_SPI_TO_SA_VALUEX_WAYX
(
ödex
,

222 
way
),

223 
vÆue
);

227 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

230 
	}
}

	@rvu_npa.c

8 
	~<löux/moduÀ.h
>

9 
	~<löux/pci.h
>

11 
	~"rvu_°ru˘.h
"

12 
	~"rvu_ªg.h
"

13 
	~"rvu.h
"

15 
	$≈a_aq_íqueue_waô
(
rvu
 *rvu, 
rvu_block
 *
block
,

16 
≈a_aq_ö°_s
 *
ö°
)

18 
admö_queue
 *
aq
 = 
block
->aq;

19 
≈a_aq_ªs_s
 *
ªsu…
;

20 
timeout
 = 1000;

21 
u64
 
ªg
, 
hód
;

23 
ªsu…
 = (
≈a_aq_ªs_s
 *)
aq
->
ªs
->
ba£
;

26 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
NPA_AF_AQ_STATUS
);

27 
hód
 = (
ªg
 >> 4Ë& 
AQ_PTR_MASK
;

29 
	`mem˝y
((*)(
aq
->
ö°
->
ba£
 + (
hód
 *áq->ö°->
íåy_sz
)),

30 (*)
ö°
, 
aq
->ö°->
íåy_sz
);

31 
	`mem£t
(
ªsu…
, 0, (*result));

33 
	`wmb
();

36 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NPA_AF_AQ_DOOR
, 1);

37 
ªsu…
->
compcode
 =
NPA_AQ_COMP_NOTDONE
) {

38 
	`˝u_ªœx
();

39 
	`udñay
(1);

40 
timeout
--;

41 i‡(!
timeout
)

42  -
EBUSY
;

45 i‡(
ªsu…
->
compcode
 !
NPA_AQ_COMP_GOOD
) {

47 i‡(
ªsu…
->
compcode
 =
NPA_AQ_COMP_CTX_FAULT
 ||

48 
ªsu…
->
compcode
 =
NPA_AQ_COMP_LOCKERR
 ||

49 
ªsu…
->
compcode
 =
NPA_AQ_COMP_CTX_POISON
) {

50 i‡(
	`rvu_ndc_fix_locked_ˇchñöe
(
rvu
, 
BLKADDR_NDC_NPA0
))

51 
	`dev_îr
(
rvu
->
dev
,

52 "%s: NŸábÀÅÿu∆ock cachñöes\n", 
__func__
);

55  -
EBUSY
;

59 
	}
}

61 
	$rvu_≈a_aq_íq_ö°
(
rvu
 *rvu, 
≈a_aq_íq_ªq
 *
ªq
,

62 
≈a_aq_íq_r•
 *
r•
)

64 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

65 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

66 
blkaddr
, 
≈Æf
, 
rc
 = 0;

67 
≈a_aq_ö°_s
 
ö°
;

68 
rvu_block
 *
block
;

69 
admö_queue
 *
aq
;

70 
rvu_pfvf
 *
pfvf
;

71 *
˘x
, *
mask
;

72 
boﬁ
 
ía
;

74 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

75 i‡(!
pfvf
->
auø_˘x
 || 
ªq
->
auø_id
 >pfvf->auø_˘x->
qsize
)

76  
NPA_AF_ERR_AQ_ENQUEUE
;

78 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 
pcifunc
);

79 i‡(!
pfvf
->
≈Æf
 || 
blkaddr
 < 0)

80  
NPA_AF_ERR_AF_LF_INVALID
;

82 
block
 = &
hw
->block[
blkaddr
];

83 
aq
 = 
block
->aq;

84 i‡(!
aq
) {

85 
	`dev_w¨n
(
rvu
->
dev
, "%s: NPA AQÇŸ inôülized\n", 
__func__
);

86  
NPA_AF_ERR_AQ_ENQUEUE
;

89 
≈Æf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 0);

90 i‡(
≈Æf
 < 0)

91  
NPA_AF_ERR_AF_LF_INVALID
;

93 
	`mem£t
(&
ö°
, 0, (
≈a_aq_ö°_s
));

94 
ö°
.
cödex
 = 
ªq
->
auø_id
;

95 
ö°
.
lf
 = 
≈Æf
;

96 
ö°
.
˘y≥
 = 
ªq
->ctype;

97 
ö°
.
›
 = 
ªq
->op;

101 
ö°
.
ªs_addr
 = (
u64
)
aq
->
ªs
->
iova
;

106 
	`•ö_lock
(&
aq
->
lock
);

109 
	`mem£t
(
aq
->
ªs
->
ba£
, 0,áq->ªs->
íåy_sz
);

111 
˘x
 = 
aq
->
ªs
->
ba£
 + 128;

113 
mask
 = 
aq
->
ªs
->
ba£
 + 256;

115 
ªq
->
›
) {

116 
NPA_AQ_INSTOP_WRITE
:

118 i‡(
ªq
->
˘y≥
 =
NPA_AQ_CTYPE_AURA
) {

119 
	`mem˝y
(
mask
, &
ªq
->
auø_mask
,

120 (
≈a_auø_s
));

121 
	`mem˝y
(
˘x
, &
ªq
->
auø
, (
≈a_auø_s
));

123 
	`mem˝y
(
mask
, &
ªq
->
poﬁ_mask
,

124 (
≈a_poﬁ_s
));

125 
	`mem˝y
(
˘x
, &
ªq
->
poﬁ
, (
≈a_poﬁ_s
));

128 
NPA_AQ_INSTOP_INIT
:

129 i‡(
ªq
->
˘y≥
 =
NPA_AQ_CTYPE_AURA
) {

130 i‡(
ªq
->
auø
.
poﬁ_addr
 >
pfvf
->
poﬁ_˘x
->
qsize
) {

131 
rc
 = 
NPA_AF_ERR_AQ_FULL
;

135 
ªq
->
auø
.
poﬁ_addr
 = 
pfvf
->
poﬁ_˘x
->
iova
 +

136 (
ªq
->
auø
.
poﬁ_addr
 * 
pfvf
->
poﬁ_˘x
->
íåy_sz
);

137 
	`mem˝y
(
˘x
, &
ªq
->
auø
, (
≈a_auø_s
));

139 
	`mem˝y
(
˘x
, &
ªq
->
poﬁ
, (
≈a_poﬁ_s
));

142 
NPA_AQ_INSTOP_NOP
:

143 
NPA_AQ_INSTOP_READ
:

144 
NPA_AQ_INSTOP_LOCK
:

145 
NPA_AQ_INSTOP_UNLOCK
:

148 
rc
 = 
NPA_AF_ERR_AQ_FULL
;

152 i‡(
rc
) {

153 
	`•ö_u∆ock
(&
aq
->
lock
);

154  
rc
;

158 
rc
 = 
	`≈a_aq_íqueue_waô
(
rvu
, 
block
, &
ö°
);

159 i‡(
rc
) {

160 
	`•ö_u∆ock
(&
aq
->
lock
);

161  
rc
;

165 i‡(
ªq
->
˘y≥
 =
NPA_AQ_CTYPE_AURA
) {

166 i‡(
ªq
->
›
 =
NPA_AQ_INSTOP_INIT
 &&Ñeq->
auø
.
ía
)

167 
	`__£t_bô
(
ªq
->
auø_id
, 
pfvf
->
auø_bm≠
);

168 i‡(
ªq
->
›
 =
NPA_AQ_INSTOP_WRITE
) {

169 
ía
 = (
ªq
->
auø
.í®&Ñeq->
auø_mask
.ena) |

170 (
	`ã°_bô
(
ªq
->
auø_id
, 
pfvf
->
auø_bm≠
) &

171 ~
ªq
->
auø_mask
.
ía
);

172 i‡(
ía
)

173 
	`__£t_bô
(
ªq
->
auø_id
, 
pfvf
->
auø_bm≠
);

175 
	`__˛ór_bô
(
ªq
->
auø_id
, 
pfvf
->
auø_bm≠
);

180 i‡(
ªq
->
˘y≥
 =
NPA_AQ_CTYPE_POOL
) {

181 i‡(
ªq
->
›
 =
NPA_AQ_INSTOP_INIT
 &&Ñeq->
poﬁ
.
ía
)

182 
	`__£t_bô
(
ªq
->
auø_id
, 
pfvf
->
poﬁ_bm≠
);

183 i‡(
ªq
->
›
 =
NPA_AQ_INSTOP_WRITE
) {

184 
ía
 = (
ªq
->
poﬁ
.í®&Ñeq->
poﬁ_mask
.ena) |

185 (
	`ã°_bô
(
ªq
->
auø_id
, 
pfvf
->
poﬁ_bm≠
) &

186 ~
ªq
->
poﬁ_mask
.
ía
);

187 i‡(
ía
)

188 
	`__£t_bô
(
ªq
->
auø_id
, 
pfvf
->
poﬁ_bm≠
);

190 
	`__˛ór_bô
(
ªq
->
auø_id
, 
pfvf
->
poﬁ_bm≠
);

193 
	`•ö_u∆ock
(&
aq
->
lock
);

195 i‡(
r•
) {

197 i‡(
ªq
->
›
 =
NPA_AQ_INSTOP_READ
) {

198 i‡(
ªq
->
˘y≥
 =
NPA_AQ_CTYPE_AURA
)

199 
	`mem˝y
(&
r•
->
auø
, 
˘x
,

200 (
≈a_auø_s
));

202 
	`mem˝y
(&
r•
->
poﬁ
, 
˘x
,

203 (
≈a_poﬁ_s
));

208 
	}
}

210 
	$≈a_lf_hw˘x_dißbÀ
(
rvu
 *rvu, 
hw˘x_dißbÀ_ªq
 *
ªq
)

212 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

213 
≈a_aq_íq_ªq
 
aq_ªq
;

214 *
bm≠
;

215 
id
, 
˙t
 = 0;

216 
îr
 = 0, 
rc
;

218 i‡(!
pfvf
->
poﬁ_˘x
 || !pfvf->
auø_˘x
)

219  
NPA_AF_ERR_AQ_ENQUEUE
;

221 
	`mem£t
(&
aq_ªq
, 0, (
≈a_aq_íq_ªq
));

222 
aq_ªq
.
hdr
.
pcifunc
 = 
ªq
->hdr.pcifunc;

224 i‡(
ªq
->
˘y≥
 =
NPA_AQ_CTYPE_POOL
) {

225 
aq_ªq
.
poﬁ
.
ía
 = 0;

226 
aq_ªq
.
poﬁ_mask
.
ía
 = 1;

227 
˙t
 = 
pfvf
->
poﬁ_˘x
->
qsize
;

228 
bm≠
 = 
pfvf
->
poﬁ_bm≠
;

229 } i‡(
ªq
->
˘y≥
 =
NPA_AQ_CTYPE_AURA
) {

230 
aq_ªq
.
auø
.
ía
 = 0;

231 
aq_ªq
.
auø_mask
.
ía
 = 1;

232 
aq_ªq
.
auø
.
bp_ía
 = 0;

233 
aq_ªq
.
auø_mask
.
bp_ía
 = 1;

234 
˙t
 = 
pfvf
->
auø_˘x
->
qsize
;

235 
bm≠
 = 
pfvf
->
auø_bm≠
;

238 
aq_ªq
.
˘y≥
 = 
ªq
->ctype;

239 
aq_ªq
.
›
 = 
NPA_AQ_INSTOP_WRITE
;

241 
id
 = 0; id < 
˙t
; id++) {

242 i‡(!
	`ã°_bô
(
id
, 
bm≠
))

244 
aq_ªq
.
auø_id
 = 
id
;

245 
rc
 = 
	`rvu_≈a_aq_íq_ö°
(
rvu
, &
aq_ªq
, 
NULL
);

246 i‡(
rc
) {

247 
îr
 = 
rc
;

248 
	`dev_îr
(
rvu
->
dev
, "FailedÅo disable %s:%d context\n",

249 (
ªq
->
˘y≥
 =
NPA_AQ_CTYPE_AURA
) ?

250 "Auø" : "Poﬁ", 
id
);

254  
îr
;

255 
	}
}

257 #ifde‡
CONFIG_NDC_DIS_DYNAMIC_CACHING


258 
	$≈a_lf_hw˘x_lockdown
(
rvu
 *rvu, 
≈a_aq_íq_ªq
 *
ªq
)

260 
≈a_aq_íq_ªq
 
lock_˘x_ªq
;

261 
îr
;

263 i‡(
ªq
->
›
 !
NPA_AQ_INSTOP_INIT
)

266 
	`mem£t
(&
lock_˘x_ªq
, 0, (
≈a_aq_íq_ªq
));

267 
lock_˘x_ªq
.
hdr
.
pcifunc
 = 
ªq
->hdr.pcifunc;

268 
lock_˘x_ªq
.
˘y≥
 = 
ªq
->ctype;

269 
lock_˘x_ªq
.
›
 = 
NPA_AQ_INSTOP_LOCK
;

270 
lock_˘x_ªq
.
auø_id
 = 
ªq
->aura_id;

271 
îr
 = 
	`rvu_≈a_aq_íq_ö°
(
rvu
, &
lock_˘x_ªq
, 
NULL
);

272 i‡(
îr
)

273 
	`dev_îr
(
rvu
->
dev
,

275 
ªq
->
hdr
.
pcifunc
,

276 (
ªq
->
˘y≥
 =
NPA_AQ_CTYPE_AURA
) ?

277 "Auø" : "Poﬁ", 
ªq
->
auø_id
);

278  
îr
;

279 
	}
}

281 
	$rvu_mbox_h™dÀr_≈a_aq_íq
(
rvu
 *rvu,

282 
≈a_aq_íq_ªq
 *
ªq
,

283 
≈a_aq_íq_r•
 *
r•
)

285 
îr
;

287 
îr
 = 
	`rvu_≈a_aq_íq_ö°
(
rvu
, 
ªq
, 
r•
);

288 i‡(!
îr
)

289 
îr
 = 
	`≈a_lf_hw˘x_lockdown
(
rvu
, 
ªq
);

290  
îr
;

291 
	}
}

294 
	$rvu_mbox_h™dÀr_≈a_aq_íq
(
rvu
 *rvu,

295 
≈a_aq_íq_ªq
 *
ªq
,

296 
≈a_aq_íq_r•
 *
r•
)

298  
	`rvu_≈a_aq_íq_ö°
(
rvu
, 
ªq
, 
r•
);

299 
	}
}

301 
EXPORT_SYMBOL
(
rvu_mbox_h™dÀr_≈a_aq_íq
);

303 
	$rvu_mbox_h™dÀr_≈a_hw˘x_dißbÀ
(
rvu
 *rvu,

304 
hw˘x_dißbÀ_ªq
 *
ªq
,

305 
msg_r•
 *
r•
)

307  
	`≈a_lf_hw˘x_dißbÀ
(
rvu
, 
ªq
);

308 
	}
}

310 
	$≈a_˘x_‰ì
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
)

312 
	`k‰ì
(
pfvf
->
auø_bm≠
);

313 
pfvf
->
auø_bm≠
 = 
NULL
;

315 
	`qmem_‰ì
(
rvu
->
dev
, 
pfvf
->
auø_˘x
);

316 
pfvf
->
auø_˘x
 = 
NULL
;

318 
	`k‰ì
(
pfvf
->
poﬁ_bm≠
);

319 
pfvf
->
poﬁ_bm≠
 = 
NULL
;

321 
	`qmem_‰ì
(
rvu
->
dev
, 
pfvf
->
poﬁ_˘x
);

322 
pfvf
->
poﬁ_˘x
 = 
NULL
;

324 
	`qmem_‰ì
(
rvu
->
dev
, 
pfvf
->
≈a_qöts_˘x
);

325 
pfvf
->
≈a_qöts_˘x
 = 
NULL
;

326 
	}
}

328 
	$rvu_mbox_h™dÀr_≈a_lf_Æloc
(
rvu
 *rvu,

329 
≈a_lf_Æloc_ªq
 *
ªq
,

330 
≈a_lf_Æloc_r•
 *
r•
)

332 
≈Æf
, 
qöts
, 
hw˘x_size
, 
îr
, 
rc
 = 0;

333 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

334 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

335 
rvu_block
 *
block
;

336 
rvu_pfvf
 *
pfvf
;

337 
u64
 
cfg
, 
˘x_cfg
;

338 
blkaddr
;

340 i‡(
ªq
->
auø_sz
 > 
NPA_AURA_SZ_MAX
 ||

341 
ªq
->
auø_sz
 =
NPA_AURA_SZ_0
 || !ªq->
ƒ_poﬁs
)

342  
NPA_AF_ERR_PARAM
;

344 i‡(
ªq
->
way_mask
)

345 
ªq
->
way_mask
 &= 0xFFFF;

347 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

348 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 
pcifunc
);

349 i‡(!
pfvf
->
≈Æf
 || 
blkaddr
 < 0)

350  
NPA_AF_ERR_AF_LF_INVALID
;

352 
block
 = &
hw
->block[
blkaddr
];

353 
≈Æf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 0);

354 i‡(
≈Æf
 < 0)

355  
NPA_AF_ERR_AF_LF_INVALID
;

358 
îr
 = 
	`rvu_lf_ª£t
(
rvu
, 
block
, 
≈Æf
);

359 i‡(
îr
) {

360 
	`dev_îr
(
rvu
->
dev
, "FaûedÅÿª£àNPALF%d\n", 
≈Æf
);

361  
NPA_AF_ERR_LF_RESET
;

364 
˘x_cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPA_AF_CONST1
);

367 
hw˘x_size
 = 1UL << (
˘x_cfg
 & 0xF);

368 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
pfvf
->
auø_˘x
,

369 
	`NPA_AURA_COUNT
(
ªq
->
auø_sz
), 
hw˘x_size
);

370 i‡(
îr
)

371 
‰ì_mem
;

373 
pfvf
->
auø_bm≠
 = 
	`kˇŒoc
(
	`NPA_AURA_COUNT
(
ªq
->
auø_sz
), (),

374 
GFP_KERNEL
);

375 i‡(!
pfvf
->
auø_bm≠
)

376 
‰ì_mem
;

379 
hw˘x_size
 = 1UL << ((
˘x_cfg
 >> 4) & 0xF);

380 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
pfvf
->
poﬁ_˘x
, 
ªq
->
ƒ_poﬁs
, 
hw˘x_size
);

381 i‡(
îr
)

382 
‰ì_mem
;

384 
pfvf
->
poﬁ_bm≠
 = 
	`kˇŒoc
(
	`NPA_AURA_COUNT
(
ªq
->
auø_sz
), (),

385 
GFP_KERNEL
);

386 i‡(!
pfvf
->
poﬁ_bm≠
)

387 
‰ì_mem
;

390 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPA_AF_CONST
);

391 
qöts
 = (
cfg
 >> 28) & 0xFFF;

394 
hw˘x_size
 = 1UL << ((
˘x_cfg
 >> 8) & 0xF);

395 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
pfvf
->
≈a_qöts_˘x
, 
qöts
, 
hw˘x_size
);

396 i‡(
îr
)

397 
‰ì_mem
;

399 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPA_AF_LFX_AURAS_CFG
(
≈Æf
));

401 
cfg
 &~(
	`BIT_ULL
(34) - 1);

403 
cfg
 |(
ªq
->
auø_sz
 << 16Ë| 
	`BIT_ULL
(34Ë|Ñeq->
way_mask
;

405 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPA_AF_LFX_AURAS_CFG
(
≈Æf
), 
cfg
);

408 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPA_AF_LFX_LOC_AURAS_BASE
(
≈Æf
),

409 (
u64
)
pfvf
->
auø_˘x
->
iova
);

412 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPA_AF_LFX_QINTS_CFG
(
≈Æf
),

413 
	`BIT_ULL
(36Ë| 
ªq
->
way_mask
 << 20);

414 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPA_AF_LFX_QINTS_BASE
(
≈Æf
),

415 (
u64
)
pfvf
->
≈a_qöts_˘x
->
iova
);

417 
exô
;

419 
‰ì_mem
:

420 
	`≈a_˘x_‰ì
(
rvu
, 
pfvf
);

421 
rc
 = -
ENOMEM
;

423 
exô
:

425 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPA_AF_CONST
);

426 
r•
->
°ack_pg_±rs
 = (
cfg
 >> 8) & 0xFF;

427 
r•
->
°ack_pg_byãs
 = 
cfg
 & 0xFF;

428 
r•
->
qöts
 = (
cfg
 >> 28) & 0xFFF;

429 i‡(!
	`is_rvu_Ÿx2
(
rvu
)) {

430 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
NPA_AF_BATCH_CTL
);

431 
r•
->
ˇche_löes
 = (
cfg
 >> 1) & 0x3F;

433  
rc
;

434 
	}
}

436 
	$rvu_mbox_h™dÀr_≈a_lf_‰ì
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

437 
msg_r•
 *
r•
)

439 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

440 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

441 
rvu_block
 *
block
;

442 
rvu_pfvf
 *
pfvf
;

443 
≈Æf
, 
îr
;

444 
blkaddr
;

446 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

447 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 
pcifunc
);

448 i‡(!
pfvf
->
≈Æf
 || 
blkaddr
 < 0)

449  
NPA_AF_ERR_AF_LF_INVALID
;

451 
block
 = &
hw
->block[
blkaddr
];

452 
≈Æf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 0);

453 i‡(
≈Æf
 < 0)

454  
NPA_AF_ERR_AF_LF_INVALID
;

457 
îr
 = 
	`rvu_lf_ª£t
(
rvu
, 
block
, 
≈Æf
);

458 i‡(
îr
) {

459 
	`dev_îr
(
rvu
->
dev
, "FaûedÅÿª£àNPALF%d\n", 
≈Æf
);

460  
NPA_AF_ERR_LF_RESET
;

463 
	`≈a_˘x_‰ì
(
rvu
, 
pfvf
);

466 
	}
}

468 
	$≈a_aq_öô
(
rvu
 *rvu, 
rvu_block
 *
block
)

470 
u64
 
cfg
;

471 
îr
;

474 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
NPA_AF_GEN_CFG
);

475 #ifde‡
__BIG_ENDIAN


476 
cfg
 |
	`BIT_ULL
(1);

477 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NPA_AF_GEN_CFG
, 
cfg
);

479 
cfg
 &~
	`BIT_ULL
(1);

480 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NPA_AF_GEN_CFG
, 
cfg
);

484 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
NPA_AF_NDC_CFG
);

485 
cfg
 &= ~0x03DULL;

486 #ifde‡
CONFIG_NDC_DIS_DYNAMIC_CACHING


488 
cfg
 |= 0x10ULL;

490 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NPA_AF_NDC_CFG
, 
cfg
);

493 i‡(!
	`is_rvu_Ÿx2
(
rvu
)) {

494 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
NPA_AF_BATCH_CTL
);

495 
cfg
 &= ~0x7EULL;

496 
cfg
 |
	`BIT_ULL
(6) | BIT_ULL(2) | BIT_ULL(1);

497 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NPA_AF_BATCH_CTL
, 
cfg
);

503 
îr
 = 
	`rvu_aq_Æloc
(
rvu
, &
block
->
aq
,

504 
	`Q_COUNT
(
AQ_SIZE
), (
≈a_aq_ö°_s
),

505 
	`ALIGN
((
≈a_aq_ªs_s
), 128) + 256);

506 i‡(
îr
)

507  
îr
;

509 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
NPA_AF_AQ_CFG
, 
AQ_SIZE
);

510 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
,

511 
NPA_AF_AQ_BASE
, (
u64
)
block
->
aq
->
ö°
->
iova
);

513 
	}
}

515 
	$rvu_≈a_öô
(
rvu
 *rvu)

517 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

518 
blkaddr
;

520 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

521 i‡(
blkaddr
 < 0)

525  
	`≈a_aq_öô
(
rvu
, &
hw
->
block
[
blkaddr
]);

526 
	}
}

528 
	$rvu_≈a_‰ìmem
(
rvu
 *rvu)

530 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

531 
rvu_block
 *
block
;

532 
blkaddr
;

534 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 0);

535 i‡(
blkaddr
 < 0)

538 
block
 = &
hw
->block[
blkaddr
];

539 
	`rvu_aq_‰ì
(
rvu
, 
block
->
aq
);

540 
	}
}

542 
	$rvu_≈a_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
≈Æf
)

544 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

545 
hw˘x_dißbÀ_ªq
 
˘x_ªq
;

548 
˘x_ªq
.
hdr
.
pcifunc
 =Öcifunc;

549 
˘x_ªq
.
˘y≥
 = 
NPA_AQ_CTYPE_POOL
;

550 
	`≈a_lf_hw˘x_dißbÀ
(
rvu
, &
˘x_ªq
);

553 
˘x_ªq
.
˘y≥
 = 
NPA_AQ_CTYPE_AURA
;

554 
	`≈a_lf_hw˘x_dißbÀ
(
rvu
, &
˘x_ªq
);

556 
	`≈a_˘x_‰ì
(
rvu
, 
pfvf
);

557 
	}
}

	@rvu_npc.c

8 
	~<löux/bôfõld.h
>

9 
	~<löux/moduÀ.h
>

10 
	~<löux/pci.h
>

11 
	~<löux/fúmw¨e.h
>

12 
	~<löux/°ddef.h
>

14 
	~"rvu_°ru˘.h
"

15 
	~"rvu_ªg.h
"

16 
	~"rvu.h
"

17 
	~"≈c.h
"

18 
	~"cgx.h
"

19 
	~"≈c_¥ofûe.h
"

20 
	~"rvu_≈c_hash.h
"

22 
	#RSVD_MCAM_ENTRIES_PER_PF
 3

	)

23 
	#RSVD_MCAM_ENTRIES_PER_NIXLF
 1

	)

25 
	#NPC_HW_TSTAMP_OFFSET
 8ULL

	)

26 
	#NPC_KEX_PF_FUNC_MASK
 0xFFFFULL

	)

28 
	#ALIGN_8B_CEIL
(
__a
Ë(((__aË+ 7Ë& (-8))

	)

30 c⁄° 
	gdef_pÊ_«me
[] = "default";

32 
≈c_mˇm_‰ì_Æl_íåõs
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

33 
blkaddr
, 
u16
 
pcifunc
);

34 
≈c_mˇm_‰ì_Æl_cou¡îs
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

35 
u16
 
pcifunc
);

37 
boﬁ
 
	$is_≈c_ötf_tx
(
u8
 
ötf
)

39  !!(
ötf
 & 0x1);

40 
	}
}

42 
boﬁ
 
	$is_≈c_ötf_rx
(
u8
 
ötf
)

44  !(
ötf
 & 0x1);

45 
	}
}

47 
boﬁ
 
	$is_≈c_öãrÁ˚_vÆid
(
rvu
 *rvu, 
u8
 
ötf
)

49 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

51  
ötf
 < 
hw
->
≈c_ötfs
;

52 
	}
}

54 
	$≈c_mˇm_vîify_pf_func
(
rvu
 *rvu,

55 
mˇm_íåy
 *
íåy_d©a
, 
u8
 
ötf
,

56 
u16
 
pcifunc
)

58 
u16
 
pf_func
, 
pf_func_mask
;

60 i‡(
	`is_≈c_ötf_rx
(
ötf
))

63 
pf_func_mask
 = (
íåy_d©a
->
kw_mask
[0] >> 32) &

64 
NPC_KEX_PF_FUNC_MASK
;

65 
pf_func
 = (
íåy_d©a
->
kw
[0] >> 32Ë& 
NPC_KEX_PF_FUNC_MASK
;

67 
pf_func
 = 
	`be16_to_˝u
((
__f‹˚
 
__be16
)pf_func);

68 i‡(
pf_func_mask
 !
NPC_KEX_PF_FUNC_MASK
 ||

69 ((
pf_func
 & ~
RVU_PFVF_FUNC_MASK
) !=

70 (
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
)))

71  -
EINVAL
;

74 
	}
}

76 
	$rvu_≈c_£t_pköd
(
rvu
 *rvu, 
pköd
, 
rvu_pfvf
 *
pfvf
)

78 
blkaddr
;

79 
u64
 
vÆ
 = 0;

81 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

82 i‡(
blkaddr
 < 0)

86 
vÆ
 = 
pköd
 | 1ULL << 62;

87 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_PKINDX_CPI_DEFX
(
pköd
, 0), 
vÆ
);

88 
	}
}

90 
	$rvu_≈c_gë_pköd
(
rvu
 *rvu, 
u16
 
pf
)

92 
≈c_pköd
 *
pköd
 = &
rvu
->
hw
->pkind;

93 
u32
 
m≠
;

94 
i
;

96 
i
 = 0; i < 
pköd
->
r§c
.
max
; i++) {

97 
m≠
 = 
pköd
->
pfch™_m≠
[
i
];

98 i‡(((
m≠
 >> 16Ë& 0x3FË=
pf
)

99  
i
;

102 
	}
}

104 
	#NPC_AF_ACTION0_PTR_ADVANCE
 
	`GENMASK_ULL
(27, 20)

	)

106 
	$≈c_c⁄fig_ts_kpua˘i⁄
(
rvu
 *rvu, 
pf
, 
u16
 
pcifunc
, 
boﬁ
 
íabÀ
)

108 
pköd
, 
blkaddr
;

109 
u64
 
vÆ
;

111 
pköd
 = 
	`rvu_≈c_gë_pköd
(
rvu
, 
pf
);

112 i‡(
pköd
 < 0) {

113 
	`dev_îr
(
rvu
->
dev
, "%s:ÖködÇŸ m≠≥d\n", 
__func__
);

114  -
EINVAL
;

117 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 
pcifunc
);

118 i‡(
blkaddr
 < 0) {

119 
	`dev_îr
(
rvu
->
dev
, "%s: NPC blockÇŸ im∂emíãd\n", 
__func__
);

120  -
EINVAL
;

123 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_PKINDX_ACTION0
(
pköd
));

124 
vÆ
 &~
NPC_AF_ACTION0_PTR_ADVANCE
;

126 i‡(
íabÀ
)

127 
vÆ
 |
	`FIELD_PREP
(
NPC_AF_ACTION0_PTR_ADVANCE
,

128 
NPC_HW_TSTAMP_OFFSET
);

129 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_PKINDX_ACTION0
(
pköd
), 
vÆ
);

132 
	}
}

134 
	$≈c_gë_uˇ°_mˇm_ödex
(
≈c_mˇm
 *
mˇm
, 
u16
 
pcifunc
,

135 
nixlf
)

137 
rvu_hwöfo
 *
hw
 = 
	`c⁄èöî_of
(
mˇm
, rvu_hwinfo, mcam);

138 
rvu
 *rvu = 
hw
->rvu;

139 
blkaddr
 = 0, 
max
 = 0;

140 
rvu_block
 *
block
;

141 
rvu_pfvf
 *
pfvf
;

143 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

147 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

148 
blkaddr
) {

149 i‡(
pfvf
->
nix_blkaddr
 =
blkaddr
)

151 
block
 = &
rvu
->
hw
->block[
blkaddr
];

152 
max
 +
block
->
lf
.max;

153 
blkaddr
 = 
	`rvu_gë_√xt_nix_blkaddr
(
rvu
, blkaddr);

156  
mˇm
->
nixlf_off£t
 + (
max
 + 
nixlf
Ë* 
RSVD_MCAM_ENTRIES_PER_NIXLF
;

157 
	}
}

159 
	$≈c_gë_nixlf_mˇm_ödex
(
≈c_mˇm
 *
mˇm
,

160 
u16
 
pcifunc
, 
nixlf
, 
ty≥
)

162 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

163 
ödex
;

166 i‡(
pf
 && !(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)) {

168 
pf
--;

169 
ödex
 = 
mˇm
->
pf_off£t
 + (
pf
 * 
RSVD_MCAM_ENTRIES_PER_PF
);

173 i‡(
ty≥
 =
NIXLF_BCAST_ENTRY
)

174  
ödex
;

175 i‡(
ty≥
 =
NIXLF_ALLMULTI_ENTRY
)

176  
ödex
 + 1;

177 i‡(
ty≥
 =
NIXLF_PROMISC_ENTRY
)

178  
ödex
 + 2;

181  
	`≈c_gë_uˇ°_mˇm_ödex
(
mˇm
, 
pcifunc
, 
nixlf
);

182 
	}
}

184 
	$≈c_gë_b™k
(
≈c_mˇm
 *
mˇm
, 
ödex
)

186 
b™k
 = 
ödex
 / 
mˇm
->
b™ksize
;

189 i‡(
mˇm
->
keysize
 =
NPC_MCAM_KEY_X2
)

190  
b™k
 ? 2 : 0;

192  
b™k
;

193 
	}
}

195 
boﬁ
 
	$is_mˇm_íåy_íabÀd
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

196 
blkaddr
, 
ödex
)

198 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ödex
);

199 
u64
 
cfg
;

201 
ödex
 &(
mˇm
->
b™ksize
 - 1);

202 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_MCAMEX_BANKX_CFG
(
ödex
, 
b™k
));

203  (
cfg
 & 1);

204 
	}
}

206 
	$≈c_íabÀ_mˇm_íåy
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

207 
blkaddr
, 
ödex
, 
boﬁ
 
íabÀ
)

209 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ödex
);

210 
a˘b™k
 = 
b™k
;

212 
ödex
 &(
mˇm
->
b™ksize
 - 1);

213 ; 
b™k
 < (
a˘b™k
 + 
mˇm
->
b™ks_≥r_íåy
); bank++) {

214 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

215 
	`NPC_AF_MCAMEX_BANKX_CFG
(
ödex
, 
b™k
),

216 
íabÀ
 ? 1 : 0);

218 
	}
}

220 
	$≈c_˛ór_mˇm_íåy
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

221 
blkaddr
, 
ödex
)

223 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ödex
);

224 
a˘b™k
 = 
b™k
;

226 
ödex
 &(
mˇm
->
b™ksize
 - 1);

227 ; 
b™k
 < (
a˘b™k
 + 
mˇm
->
b™ks_≥r_íåy
); bank++) {

228 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

229 
	`NPC_AF_MCAMEX_BANKX_CAMX_INTF
(
ödex
, 
b™k
, 1), 0);

230 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

231 
	`NPC_AF_MCAMEX_BANKX_CAMX_INTF
(
ödex
, 
b™k
, 0), 0);

233 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

234 
	`NPC_AF_MCAMEX_BANKX_CAMX_W0
(
ödex
, 
b™k
, 1), 0);

235 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

236 
	`NPC_AF_MCAMEX_BANKX_CAMX_W0
(
ödex
, 
b™k
, 0), 0);

238 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

239 
	`NPC_AF_MCAMEX_BANKX_CAMX_W1
(
ödex
, 
b™k
, 1), 0);

240 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

241 
	`NPC_AF_MCAMEX_BANKX_CAMX_W1
(
ödex
, 
b™k
, 0), 0);

243 
	}
}

245 
	$≈c_gë_keyw‹d
(
mˇm_íåy
 *
íåy
, 
idx
,

246 
u64
 *
ˇm0
, u64 *
ˇm1
)

248 
u64
 
kw_mask
 = 0x00;

250 
	#CAM_MASK
(
n
Ë(
	`BIT_ULL
“Ë- 1)

	)

257 
idx
) {

260 *
ˇm1
 = 
íåy
->
kw
[0];

261 
kw_mask
 = 
íåy
->kw_mask[0];

265 *
ˇm1
 = 
íåy
->
kw
[1] & 
	`CAM_MASK
(48);

266 
kw_mask
 = 
íåy
->kw_mask[1] & 
	`CAM_MASK
(48);

272 *
ˇm1
 = (
íåy
->
kw
[1] >> 48Ë& 
	`CAM_MASK
(16);

273 *
ˇm1
 |((
íåy
->
kw
[2] & 
	`CAM_MASK
(48)) << 16);

274 
kw_mask
 = (
íåy
->kw_mask[1] >> 48Ë& 
	`CAM_MASK
(16);

275 
kw_mask
 |((
íåy
->kw_mask[2] & 
	`CAM_MASK
(48)) << 16);

281 *
ˇm1
 = (
íåy
->
kw
[2] >> 48Ë& 
	`CAM_MASK
(16);

282 *
ˇm1
 |((
íåy
->
kw
[3] & 
	`CAM_MASK
(32)) << 16);

283 
kw_mask
 = (
íåy
->kw_mask[2] >> 48Ë& 
	`CAM_MASK
(16);

284 
kw_mask
 |((
íåy
->kw_mask[3] & 
	`CAM_MASK
(32)) << 16);

290 *
ˇm1
 = (
íåy
->
kw
[3] >> 32Ë& 
	`CAM_MASK
(32);

291 *
ˇm1
 |((
íåy
->
kw
[4] & 
	`CAM_MASK
(32)) << 32);

292 
kw_mask
 = (
íåy
->kw_mask[3] >> 32Ë& 
	`CAM_MASK
(32);

293 
kw_mask
 |((
íåy
->kw_mask[4] & 
	`CAM_MASK
(32)) << 32);

299 *
ˇm1
 = (
íåy
->
kw
[4] >> 32Ë& 
	`CAM_MASK
(32);

300 *
ˇm1
 |((
íåy
->
kw
[5] & 
	`CAM_MASK
(16)) << 32);

301 
kw_mask
 = (
íåy
->kw_mask[4] >> 32Ë& 
	`CAM_MASK
(32);

302 
kw_mask
 |((
íåy
->kw_mask[5] & 
	`CAM_MASK
(16)) << 32);

308 *
ˇm1
 = (
íåy
->
kw
[5] >> 16Ë& 
	`CAM_MASK
(48);

309 *
ˇm1
 |((
íåy
->
kw
[6] & 
	`CAM_MASK
(16)) << 48);

310 
kw_mask
 = (
íåy
->kw_mask[5] >> 16Ë& 
	`CAM_MASK
(48);

311 
kw_mask
 |((
íåy
->kw_mask[6] & 
	`CAM_MASK
(16)) << 48);

315 *
ˇm1
 = (
íåy
->
kw
[6] >> 16Ë& 
	`CAM_MASK
(48);

316 
kw_mask
 = (
íåy
->kw_mask[6] >> 16Ë& 
	`CAM_MASK
(48);

320 *
ˇm1
 &
kw_mask
;

321 *
ˇm0
 = ~*
ˇm1
 & 
kw_mask
;

322 
	}
}

324 
	$≈c_fûl_íåyw‹d
(
mˇm_íåy
 *
íåy
, 
idx
,

325 
u64
 
ˇm0
, u64 
ˇm1
)

330 
idx
) {

332 
íåy
->
kw
[0] = 
ˇm1
;

333 
íåy
->
kw_mask
[0] = 
ˇm1
 ^ 
ˇm0
;

336 
íåy
->
kw
[1] = 
ˇm1
;

337 
íåy
->
kw_mask
[1] = 
ˇm1
 ^ 
ˇm0
;

340 
íåy
->
kw
[1] |(
ˇm1
 & 
	`CAM_MASK
(16)) << 48;

341 
íåy
->
kw
[2] = (
ˇm1
 >> 16Ë& 
	`CAM_MASK
(48);

342 
íåy
->
kw_mask
[1] |((
ˇm1
 ^ 
ˇm0
Ë& 
	`CAM_MASK
(16)) << 48;

343 
íåy
->
kw_mask
[2] = ((
ˇm1
 ^ 
ˇm0
Ë>> 16Ë& 
	`CAM_MASK
(48);

346 
íåy
->
kw
[2] |(
ˇm1
 & 
	`CAM_MASK
(16)) << 48;

347 
íåy
->
kw
[3] = (
ˇm1
 >> 16Ë& 
	`CAM_MASK
(32);

348 
íåy
->
kw_mask
[2] |((
ˇm1
 ^ 
ˇm0
Ë& 
	`CAM_MASK
(16)) << 48;

349 
íåy
->
kw_mask
[3] = ((
ˇm1
 ^ 
ˇm0
Ë>> 16Ë& 
	`CAM_MASK
(32);

352 
íåy
->
kw
[3] |(
ˇm1
 & 
	`CAM_MASK
(32)) << 32;

353 
íåy
->
kw
[4] = (
ˇm1
 >> 32Ë& 
	`CAM_MASK
(32);

354 
íåy
->
kw_mask
[3] |((
ˇm1
 ^ 
ˇm0
Ë& 
	`CAM_MASK
(32)) << 32;

355 
íåy
->
kw_mask
[4] = ((
ˇm1
 ^ 
ˇm0
Ë>> 32Ë& 
	`CAM_MASK
(32);

358 
íåy
->
kw
[4] |(
ˇm1
 & 
	`CAM_MASK
(32)) << 32;

359 
íåy
->
kw
[5] = (
ˇm1
 >> 32Ë& 
	`CAM_MASK
(16);

360 
íåy
->
kw_mask
[4] |((
ˇm1
 ^ 
ˇm0
Ë& 
	`CAM_MASK
(32)) << 32;

361 
íåy
->
kw_mask
[5] = ((
ˇm1
 ^ 
ˇm0
Ë>> 32Ë& 
	`CAM_MASK
(16);

364 
íåy
->
kw
[5] |(
ˇm1
 & 
	`CAM_MASK
(48)) << 16;

365 
íåy
->
kw
[6] = (
ˇm1
 >> 48Ë& 
	`CAM_MASK
(16);

366 
íåy
->
kw_mask
[5] |((
ˇm1
 ^ 
ˇm0
Ë& 
	`CAM_MASK
(48)) << 16;

367 
íåy
->
kw_mask
[6] = ((
ˇm1
 ^ 
ˇm0
Ë>> 48Ë& 
	`CAM_MASK
(16);

370 
íåy
->
kw
[6] |(
ˇm1
 & 
	`CAM_MASK
(48)) << 16;

371 
íåy
->
kw_mask
[6] |((
ˇm1
 ^ 
ˇm0
Ë& 
	`CAM_MASK
(48)) << 16;

374 
	}
}

376 
u64
 
	$≈c_gë_deÁu…_íåy_a˘i⁄
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

377 
blkaddr
, 
u16
 
pf_func
)

379 
b™k
, 
nixlf
, 
ödex
;

382 
	`nix_gë_nixlf
(
rvu
, 
pf_func
, &
nixlf
, 
NULL
);

383 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pf_func
, 
nixlf
,

384 
NIXLF_UCAST_ENTRY
);

385 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ödex
);

386 
ödex
 &(
mˇm
->
b™ksize
 - 1);

388  
	`rvu_ªad64
(
rvu
, 
blkaddr
,

389 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
ödex
, 
b™k
));

390 
	}
}

392 
	$≈c_fixup_vf_ruÀ
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

393 
blkaddr
, 
ödex
, 
mˇm_íåy
 *
íåy
,

394 
boﬁ
 *
íabÀ
)

396 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
;

397 
u16
 
ow√r
, 
èrgë_func
;

398 
rvu_pfvf
 *
pfvf
;

399 
u64
 
rx_a˘i⁄
;

401 
ow√r
 = 
mˇm
->
íåy2pfvf_m≠
[
ödex
];

402 
èrgë_func
 = (
íåy
->
a˘i⁄
 >> 4) & 0xffff;

404 i‡(
	`is_pffunc_af
(
ow√r
Ë|| 
	`is_afvf
(
èrgë_func
) ||

405 (
ow√r
 & 
RVU_PFVF_FUNC_MASK
) ||

406 !(
èrgë_func
 & 
RVU_PFVF_FUNC_MASK
))

410 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
èrgë_func
);

411 
mˇm
->
íåy2èrgë_pffunc
[
ödex
] = 
èrgë_func
;

414 i‡(!(
	`is_nixlf_©èched
(
rvu
, 
èrgë_func
) &&

415 
	`ã°_bô
(
NIXLF_INITIALIZED
, &
pfvf
->
Êags
)))

416 *
íabÀ
 = 
Ál£
;

419 
	`li°_f‹_óch_íåy
(
ruÀ
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

420 i‡(
ruÀ
->
íåy
 =
ödex
)

425 
rx_a˘i⁄
 = 
	`≈c_gë_deÁu…_íåy_a˘i⁄
(
rvu
, 
mˇm
, 
blkaddr
,

426 
èrgë_func
);

427 i‡(
rx_a˘i⁄
)

428 
íåy
->
a˘i⁄
 = 
rx_a˘i⁄
;

429 
	}
}

431 
	$≈c_c⁄fig_mˇm_íåy
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

432 
blkaddr
, 
ödex
, 
u8
 
ötf
,

433 
mˇm_íåy
 *
íåy
, 
boﬁ
 
íabÀ
)

435 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ödex
);

436 
kw
 = 0, 
a˘b™k
, 
a˘ödex
;

437 
u8
 
tx_ötf_mask
 = ~
ötf
 & 0x3;

438 
u8
 
tx_ötf
 = 
ötf
;

439 
u64
 
ˇm0
, 
ˇm1
;

441 
a˘b™k
 = 
b™k
;

442 
a˘ödex
 = 
ödex
;

443 
ödex
 &(
mˇm
->
b™ksize
 - 1);

446 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
a˘ödex
, 
Ál£
);

449 
	`≈c_˛ór_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
a˘ödex
);

457 ; 
b™k
 < (
a˘b™k
 + 
mˇm
->
b™ks_≥r_íåy
); b™k++, 
kw
 = kw + 2) {

459 i‡(
	`is_≈c_ötf_tx
(
ötf
)) {

463 
tx_ötf_mask
 = 0x1;

464 
tx_ötf
 = 
ötf
 & 
tx_ötf_mask
;

465 
tx_ötf_mask
 = ~
tx_ötf
 &Åx_intf_mask;

468 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

469 
	`NPC_AF_MCAMEX_BANKX_CAMX_INTF
(
ödex
, 
b™k
, 1),

470 
tx_ötf
);

471 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

472 
	`NPC_AF_MCAMEX_BANKX_CAMX_INTF
(
ödex
, 
b™k
, 0),

473 
tx_ötf_mask
);

476 
	`≈c_gë_keyw‹d
(
íåy
, 
kw
, &
ˇm0
, &
ˇm1
);

477 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

478 
	`NPC_AF_MCAMEX_BANKX_CAMX_W0
(
ödex
, 
b™k
, 1), 
ˇm1
);

479 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

480 
	`NPC_AF_MCAMEX_BANKX_CAMX_W0
(
ödex
, 
b™k
, 0), 
ˇm0
);

482 
	`≈c_gë_keyw‹d
(
íåy
, 
kw
 + 1, &
ˇm0
, &
ˇm1
);

483 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

484 
	`NPC_AF_MCAMEX_BANKX_CAMX_W1
(
ödex
, 
b™k
, 1), 
ˇm1
);

485 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

486 
	`NPC_AF_MCAMEX_BANKX_CAMX_W1
(
ödex
, 
b™k
, 0), 
ˇm0
);

490 i‡(
	`is_≈c_ötf_rx
(
ötf
Ë&& 
a˘ödex
 < 
mˇm
->
bm≠_íåõs
)

491 
	`≈c_fixup_vf_ruÀ
(
rvu
, 
mˇm
, 
blkaddr
, 
a˘ödex
, 
íåy
, &
íabÀ
);

494 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

495 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
ödex
, 
a˘b™k
), 
íåy
->
a˘i⁄
);

498 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_MCAMEX_BANKX_TAG_ACT
(
ödex
, 
a˘b™k
),

499 
íåy
->
vèg_a˘i⁄
);

502 i‡(
íabÀ
)

503 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
a˘ödex
, 
åue
);

504 
	}
}

506 
	$≈c_ªad_mˇm_íåy
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

507 
blkaddr
, 
u16
 
§c
,

508 
mˇm_íåy
 *
íåy
, 
u8
 *
ötf
, u8 *
ía
)

510 
sb™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
§c
);

511 
b™k
, 
kw
 = 0;

512 
u64
 
ˇm0
, 
ˇm1
;

514 
§c
 &(
mˇm
->
b™ksize
 - 1);

515 
b™k
 = 
sb™k
;

517 ; 
b™k
 < (
sb™k
 + 
mˇm
->
b™ks_≥r_íåy
); b™k++, 
kw
 = kw + 2) {

518 
ˇm1
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

519 
	`NPC_AF_MCAMEX_BANKX_CAMX_W0
(
§c
, 
b™k
, 1));

520 
ˇm0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

521 
	`NPC_AF_MCAMEX_BANKX_CAMX_W0
(
§c
, 
b™k
, 0));

522 
	`≈c_fûl_íåyw‹d
(
íåy
, 
kw
, 
ˇm0
, 
ˇm1
);

524 
ˇm1
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

525 
	`NPC_AF_MCAMEX_BANKX_CAMX_W1
(
§c
, 
b™k
, 1));

526 
ˇm0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

527 
	`NPC_AF_MCAMEX_BANKX_CAMX_W1
(
§c
, 
b™k
, 0));

528 
	`≈c_fûl_íåyw‹d
(
íåy
, 
kw
 + 1, 
ˇm0
, 
ˇm1
);

531 
íåy
->
a˘i⁄
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

532 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
§c
, 
sb™k
));

533 
íåy
->
vèg_a˘i⁄
 =

534 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

535 
	`NPC_AF_MCAMEX_BANKX_TAG_ACT
(
§c
, 
sb™k
));

536 *
ötf
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

537 
	`NPC_AF_MCAMEX_BANKX_CAMX_INTF
(
§c
, 
sb™k
, 1)) & 3;

538 *
ía
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

539 
	`NPC_AF_MCAMEX_BANKX_CFG
(
§c
, 
sb™k
)) & 1;

540 
	}
}

542 
	$≈c_c›y_mˇm_íåy
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

543 
blkaddr
, 
u16
 
§c
, u16 
de°
)

545 
db™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
de°
);

546 
sb™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
§c
);

547 
u64
 
cfg
, 
§eg
, 
dªg
;

548 
b™k
, 
i
;

550 
§c
 &(
mˇm
->
b™ksize
 - 1);

551 
de°
 &(
mˇm
->
b™ksize
 - 1);

554 
b™k
 = 0; b™k < 
mˇm
->
b™ks_≥r_íåy
; bank++) {

555 
§eg
 = 
	`NPC_AF_MCAMEX_BANKX_CAMX_INTF
(
§c
, 
sb™k
 + 
b™k
, 0);

556 
dªg
 = 
	`NPC_AF_MCAMEX_BANKX_CAMX_INTF
(
de°
, 
db™k
 + 
b™k
, 0);

557 
i
 = 0; i < 6; i++) {

558 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
§eg
 + (
i
 * 8));

559 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
dªg
 + (
i
 * 8), 
cfg
);

564 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

565 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
§c
, 
sb™k
));

566 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

567 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
de°
, 
db™k
), 
cfg
);

570 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

571 
	`NPC_AF_MCAMEX_BANKX_TAG_ACT
(
§c
, 
sb™k
));

572 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

573 
	`NPC_AF_MCAMEX_BANKX_TAG_ACT
(
de°
, 
db™k
), 
cfg
);

576 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

577 
	`NPC_AF_MCAMEX_BANKX_CFG
(
§c
, 
sb™k
));

578 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

579 
	`NPC_AF_MCAMEX_BANKX_CFG
(
de°
, 
db™k
), 
cfg
);

580 
	}
}

582 
u64
 
	$≈c_gë_mˇm_a˘i⁄
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

583 
blkaddr
, 
ödex
)

585 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ödex
);

587 
ödex
 &(
mˇm
->
b™ksize
 - 1);

588  
	`rvu_ªad64
(
rvu
, 
blkaddr
,

589 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
ödex
, 
b™k
));

590 
	}
}

592 
u32
 
	$rvu_gë_˝t_ch™_mask
(
rvu
 *rvu)

599 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

600  
NIX_CHAN_CPT_X2P_MASK
;

603 
	}
}

605 
	$rvu_≈c_ö°Æl_uˇ°_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
,

606 
nixlf
, 
u64
 
ch™
, 
u8
 *
mac_addr
)

608 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

609 
≈c_ö°Æl_Êow_ªq
 
ªq
 = { 0 };

610 
≈c_ö°Æl_Êow_r•
 
r•
 = { 0 };

611 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

612 
nix_rx_a˘i⁄
 
a˘i⁄
;

613 
blkaddr
, 
ödex
;

616 i‡(
	`is_afvf
(
pcifunc
Ë|| 
	`is_sdp_vf
(pcifunc))

619 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

620 i‡(
blkaddr
 < 0)

626 i‡(!
	`≈c_is_„©uª_suµ‹ãd
(
rvu
, 
	`BIT_ULL
(
NPC_DMAC
), 
pfvf
->
nix_rx_ötf
))

629 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

630 
nixlf
, 
NIXLF_UCAST_ENTRY
);

635 i‡(
	`is_mˇm_íåy_íabÀd
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
)) {

636 *(
u64
 *)&
a˘i⁄
 = 
	`≈c_gë_mˇm_a˘i⁄
(
rvu
, 
mˇm
,

637 
blkaddr
, 
ödex
);

639 *(
u64
 *)&
a˘i⁄
 = 0x00;

640 
a˘i⁄
.
›
 = 
NIX_RX_ACTIONOP_UCAST
;

641 
a˘i⁄
.
pf_func
 = 
pcifunc
;

644 
ªq
.
deÁu…_ruÀ
 = 1;

645 
	`ëhî_addr_c›y
(
ªq
.
∑ckë
.
dmac
, 
mac_addr
);

646 
	`ëh_brﬂdˇ°_addr
((
u8
 *)&
ªq
.
mask
.
dmac
);

647 
ªq
.
„©uªs
 = 
	`BIT_ULL
(
NPC_DMAC
);

648 
ªq
.
ch™√l
 = 
ch™
;

649 
ªq
.
ch™_mask
 = 
	`rvu_gë_˝t_ch™_mask
(
rvu
);

650 
ªq
.
ötf
 = 
pfvf
->
nix_rx_ötf
;

651 
ªq
.
›
 = 
a˘i⁄
.op;

652 
ªq
.
hdr
.
pcifunc
 = 0;

653 
ªq
.
vf
 = 
a˘i⁄
.
pf_func
;

654 
ªq
.
ödex
 = 
a˘i⁄
.index;

655 
ªq
.
m©ch_id
 = 
a˘i⁄
.match_id;

656 
ªq
.
Êow_key_Æg
 = 
a˘i⁄
.flow_key_alg;

658 
	`rvu_mbox_h™dÀr_≈c_ö°Æl_Êow
(
rvu
, &
ªq
, &
r•
);

659 
	}
}

661 
	$rvu_≈c_ö°Æl_¥omisc_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
,

662 
nixlf
, 
u64
 
ch™
, 
u8
 
ch™_˙t
)

664 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

665 
≈c_ö°Æl_Êow_ªq
 
ªq
 = { 0 };

666 
≈c_ö°Æl_Êow_r•
 
r•
 = { 0 };

667 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

668 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

669 
blkaddr
, 
uˇ°_idx
, 
ödex
;

670 
nix_rx_a˘i⁄
 
a˘i⁄
;

671 
u64
 
ªœxed_mask
;

673 i‡(!
hw
->
ˇp
.
nix_rx_mu…iˇ°
 && 
	`is_cgx_vf
(
rvu
, 
pcifunc
))

676 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

677 i‡(
blkaddr
 < 0)

680 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

681 
nixlf
, 
NIXLF_PROMISC_ENTRY
);

682 i‡(
	`is_cgx_vf
(
rvu
, 
pcifunc
))

683 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
,

684 
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
,

685 
nixlf
, 
NIXLF_PROMISC_ENTRY
);

690 
uˇ°_idx
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

691 
nixlf
, 
NIXLF_UCAST_ENTRY
);

692 i‡(
	`is_mˇm_íåy_íabÀd
(
rvu
, 
mˇm
, 
blkaddr
, 
uˇ°_idx
))

693 *(
u64
 *)&
a˘i⁄
 = 
	`≈c_gë_mˇm_a˘i⁄
(
rvu
, 
mˇm
,

694 
blkaddr
, 
uˇ°_idx
);

696 i‡(
a˘i⁄
.
›
 !
NIX_RX_ACTIONOP_RSS
) {

697 *(
u64
 *)&
a˘i⁄
 = 0x00;

698 
a˘i⁄
.
›
 = 
NIX_RX_ACTIONOP_UCAST
;

702 i‡(
hw
->
ˇp
.
nix_rx_mu…iˇ°
 && 
pfvf
->
u£_m˚_li°
 &&

703 
	`is_pf_cgxm≠≥d
(
rvu
, 
	`rvu_gë_pf
(
pcifunc
))) {

704 *(
u64
 *)&
a˘i⁄
 = 0x00;

705 
a˘i⁄
.
›
 = 
NIX_RX_ACTIONOP_MCAST
;

706 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
);

707 
a˘i⁄
.
ödex
 = 
pfvf
->
¥omisc_m˚_idx
;

710 
ªq
.
ch™_mask
 = 
	`rvu_gë_˝t_ch™_mask
(
rvu
);

712 i‡(
ch™_˙t
 > 1) {

713 i‡(!
	`is_powî_of_2
(
ch™_˙t
)) {

714 
	`dev_îr
(
rvu
->
dev
,

715 "%s: ch™√»cou¡ m‹êth™ 1, mu° bêpowî o‡2\n", 
__func__
);

718 
ªœxed_mask
 = 
	`GENMASK_ULL
(
BITS_PER_LONG_LONG
 - 1,

719 
	`ûog2
(
ch™_˙t
));

720 
ªq
.
ch™_mask
 &
ªœxed_mask
;

723 
ªq
.
ch™√l
 = 
ch™
;

724 
ªq
.
ötf
 = 
pfvf
->
nix_rx_ötf
;

725 
ªq
.
íåy
 = 
ödex
;

726 
ªq
.
›
 = 
a˘i⁄
.op;

727 
ªq
.
hdr
.
pcifunc
 = 0;

728 
ªq
.
vf
 = 
pcifunc
;

729 
ªq
.
ödex
 = 
a˘i⁄
.index;

730 
ªq
.
m©ch_id
 = 
a˘i⁄
.match_id;

731 
ªq
.
Êow_key_Æg
 = 
a˘i⁄
.flow_key_alg;

733 
	`rvu_mbox_h™dÀr_≈c_ö°Æl_Êow
(
rvu
, &
ªq
, &
r•
);

734 
	}
}

736 
	$rvu_≈c_íabÀ_¥omisc_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
,

737 
nixlf
, 
boﬁ
 
íabÀ
)

739 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

740 
blkaddr
, 
ödex
;

742 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

743 i‡(
blkaddr
 < 0)

747 
pcifunc
 =Öcifun¯& ~
RVU_PFVF_FUNC_MASK
;

749 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

750 
nixlf
, 
NIXLF_PROMISC_ENTRY
);

751 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
, 
íabÀ
);

752 
	}
}

754 
	$rvu_≈c_ö°Æl_bˇ°_m©ch_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
,

755 
nixlf
, 
u64
 
ch™
)

757 
rvu_pfvf
 *
pfvf
;

758 
≈c_ö°Æl_Êow_ªq
 
ªq
 = { 0 };

759 
≈c_ö°Æl_Êow_r•
 
r•
 = { 0 };

760 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

761 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

762 
blkaddr
, 
ödex
;

764 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

765 i‡(
blkaddr
 < 0)

769 i‡(
	`is_afvf
(
pcifunc
))

775 i‡(!
hw
->
ˇp
.
nix_rx_mu…iˇ°
 && 
	`is_vf
(
pcifunc
))

779 
pcifunc
 =Öcifun¯& ~
RVU_PFVF_FUNC_MASK
;

780 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

785 i‡(!
	`≈c_is_„©uª_suµ‹ãd
(
rvu
, 
	`BIT_ULL
(
NPC_DMAC
), 
pfvf
->
nix_rx_ötf
) &&

786 !
	`≈c_is_„©uª_suµ‹ãd
(
rvu
, 
	`BIT_ULL
(
NPC_LXMB
), 
pfvf
->
nix_rx_ötf
))

789 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

790 
nixlf
, 
NIXLF_BCAST_ENTRY
);

792 i‡(!
hw
->
ˇp
.
nix_rx_mu…iˇ°
) {

797 
ªq
.
›
 = 
NIX_RX_ACTIONOP_UCAST
;

799 
ªq
.
›
 = 
NIX_RX_ACTIONOP_MCAST
;

800 
ªq
.
ödex
 = 
pfvf
->
bˇ°_m˚_idx
;

803 
	`ëh_brﬂdˇ°_addr
((
u8
 *)&
ªq
.
∑ckë
.
dmac
);

804 
	`ëh_brﬂdˇ°_addr
((
u8
 *)&
ªq
.
mask
.
dmac
);

805 
ªq
.
„©uªs
 = 
	`BIT_ULL
(
NPC_DMAC
);

806 
ªq
.
ch™√l
 = 
ch™
;

807 
ªq
.
ch™_mask
 = 0xFFFU;

808 
ªq
.
ötf
 = 
pfvf
->
nix_rx_ötf
;

809 
ªq
.
íåy
 = 
ödex
;

810 
ªq
.
hdr
.
pcifunc
 = 0;

811 
ªq
.
vf
 = 
pcifunc
;

813 
	`rvu_mbox_h™dÀr_≈c_ö°Æl_Êow
(
rvu
, &
ªq
, &
r•
);

814 
	}
}

816 
	$rvu_≈c_íabÀ_bˇ°_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
,

817 
boﬁ
 
íabÀ
)

819 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

820 
blkaddr
, 
ödex
;

822 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

823 i‡(
blkaddr
 < 0)

827 
pcifunc
 =Öcifun¯& ~
RVU_PFVF_FUNC_MASK
;

829 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
, 
nixlf
,

830 
NIXLF_BCAST_ENTRY
);

831 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
, 
íabÀ
);

832 
	}
}

834 
	$rvu_≈c_ö°Æl_Ælmu…i_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
,

835 
u64
 
ch™
)

837 
≈c_ö°Æl_Êow_ªq
 
ªq
 = { 0 };

838 
≈c_ö°Æl_Êow_r•
 
r•
 = { 0 };

839 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

840 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

841 
blkaddr
, 
uˇ°_idx
, 
ödex
;

842 
u8
 
mac_addr
[
ETH_ALEN
] = { 0 };

843 
nix_rx_a˘i⁄
 
a˘i⁄
;

844 
rvu_pfvf
 *
pfvf
;

845 
u16
 
vf_func
;

848 i‡(
	`is_afvf
(
pcifunc
Ë&& 
	`is_sdp_vf
(pcifunc))

851 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

852 i‡(
blkaddr
 < 0)

856 
vf_func
 = 
pcifunc
 & 
RVU_PFVF_FUNC_MASK
;

857 
pcifunc
 =Öcifun¯& ~
RVU_PFVF_FUNC_MASK
;

858 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

863 i‡(!
	`≈c_is_„©uª_suµ‹ãd
(
rvu
, 
	`BIT_ULL
(
NPC_DMAC
), 
pfvf
->
nix_rx_ötf
) &&

864 !
	`≈c_is_„©uª_suµ‹ãd
(
rvu
, 
	`BIT_ULL
(
NPC_LXMB
), 
pfvf
->
nix_rx_ötf
))

867 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

868 
nixlf
, 
NIXLF_ALLMULTI_ENTRY
);

873 
uˇ°_idx
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

874 
nixlf
, 
NIXLF_UCAST_ENTRY
);

875 i‡(
	`is_mˇm_íåy_íabÀd
(
rvu
, 
mˇm
, 
blkaddr
, 
uˇ°_idx
))

876 *(
u64
 *)&
a˘i⁄
 = 
	`≈c_gë_mˇm_a˘i⁄
(
rvu
, 
mˇm
,

877 
blkaddr
, 
uˇ°_idx
);

879 i‡(
a˘i⁄
.
›
 !
NIX_RX_ACTIONOP_RSS
) {

880 *(
u64
 *)&
a˘i⁄
 = 0x00;

881 
a˘i⁄
.
›
 = 
NIX_RX_ACTIONOP_UCAST
;

882 
a˘i⁄
.
pf_func
 = 
pcifunc
;

886 i‡(
hw
->
ˇp
.
nix_rx_mu…iˇ°
 && 
pfvf
->
u£_m˚_li°
) {

887 *(
u64
 *)&
a˘i⁄
 = 0x00;

888 
a˘i⁄
.
›
 = 
NIX_RX_ACTIONOP_MCAST
;

889 
a˘i⁄
.
ödex
 = 
pfvf
->
mˇ°_m˚_idx
;

892 
mac_addr
[0] = 0x01;

893 
	`ëhî_addr_c›y
(
ªq
.
∑ckë
.
dmac
, 
mac_addr
);

894 
	`ëhî_addr_c›y
(
ªq
.
mask
.
dmac
, 
mac_addr
);

895 
ªq
.
„©uªs
 = 
	`BIT_ULL
(
NPC_DMAC
);

897 
ªq
.
ch™_mask
 = 
	`rvu_gë_˝t_ch™_mask
(
rvu
);

898 
ªq
.
ch™√l
 = 
ch™
;

899 
ªq
.
ötf
 = 
pfvf
->
nix_rx_ötf
;

900 
ªq
.
íåy
 = 
ödex
;

901 
ªq
.
›
 = 
a˘i⁄
.op;

902 
ªq
.
hdr
.
pcifunc
 = 0;

903 
ªq
.
vf
 = 
pcifunc
 | 
vf_func
;

904 
ªq
.
ödex
 = 
a˘i⁄
.index;

905 
ªq
.
m©ch_id
 = 
a˘i⁄
.match_id;

906 
ªq
.
Êow_key_Æg
 = 
a˘i⁄
.flow_key_alg;

908 
	`rvu_mbox_h™dÀr_≈c_ö°Æl_Êow
(
rvu
, &
ªq
, &
r•
);

909 
	}
}

911 
	$rvu_≈c_íabÀ_Ælmu…i_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
,

912 
boﬁ
 
íabÀ
)

914 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

915 
blkaddr
, 
ödex
;

917 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

918 i‡(
blkaddr
 < 0)

922 
pcifunc
 =Öcifun¯& ~
RVU_PFVF_FUNC_MASK
;

924 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
, 
nixlf
,

925 
NIXLF_ALLMULTI_ENTRY
);

926 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
, 
íabÀ
);

927 
	}
}

929 
	$≈c_upd©e_vf_Êow_íåy
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

930 
blkaddr
, 
u16
 
pcifunc
, 
u64
 
rx_a˘i⁄
)

932 
a˘ödex
, 
ödex
, 
b™k
, 
íåy
;

933 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
;

934 
boﬁ
 
íabÀ
, 
upd©e
;

936 i‡(!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
))

939 
	`muãx_lock
(&
mˇm
->
lock
);

940 
ödex
 = 0; index < 
mˇm
->
bm≠_íåõs
; index++) {

941 i‡(
mˇm
->
íåy2èrgë_pffunc
[
ödex
] =
pcifunc
) {

942 
upd©e
 = 
åue
;

944 
	`li°_f‹_óch_íåy
(
ruÀ
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

945 i‡(
ruÀ
->
íåy
 =
ödex
)

946 
upd©e
 = 
Ál£
;

948 i‡(!
upd©e
)

950 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ödex
);

951 
a˘ödex
 = 
ödex
;

952 
íåy
 = 
ödex
 & (
mˇm
->
b™ksize
 - 1);

955 
íabÀ
 = 
	`is_mˇm_íåy_íabÀd
(
rvu
, 
mˇm
, 
blkaddr
,

956 
a˘ödex
);

958 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
a˘ödex
,

959 
Ál£
);

961 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

962 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
íåy
, 
b™k
),

963 
rx_a˘i⁄
);

964 i‡(
íabÀ
)

965 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
,

966 
a˘ödex
, 
åue
);

969 
	`muãx_u∆ock
(&
mˇm
->
lock
);

970 
	}
}

972 
	$rvu_≈c_upd©e_Êowkey_Æg_idx
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
,

973 
group
, 
Æg_idx
, 
mˇm_ödex
)

975 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

976 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

977 
nix_rx_a˘i⁄
 
a˘i⁄
;

978 
blkaddr
, 
ödex
, 
b™k
;

979 
rvu_pfvf
 *
pfvf
;

981 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

982 i‡(
blkaddr
 < 0)

986 i‡(
mˇm_ödex
 < 0) {

987 i‡(
group
 !
DEFAULT_RSS_CONTEXT_GROUP
)

989 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

990 
nixlf
, 
NIXLF_UCAST_ENTRY
);

993 
ödex
 = 
mˇm_ödex
;

996 i‡(
ödex
 >
mˇm
->
tŸÆ_íåõs
)

999 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ödex
);

1000 
ödex
 &(
mˇm
->
b™ksize
 - 1);

1002 *(
u64
 *)&
a˘i⁄
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1003 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
ödex
, 
b™k
));

1005 i‡(!*(
u64
 *)&
a˘i⁄
)

1008 
a˘i⁄
.
›
 = 
NIX_RX_ACTIONOP_RSS
;

1009 
a˘i⁄
.
pf_func
 = 
pcifunc
;

1010 
a˘i⁄
.
ödex
 = 
group
;

1011 
a˘i⁄
.
Êow_key_Æg
 = 
Æg_idx
;

1013 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1014 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
ödex
, 
b™k
), *(
u64
 *)&
a˘i⁄
);

1020 i‡(
mˇm_ödex
 < 0)

1021 
	`≈c_upd©e_vf_Êow_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
pcifunc
,

1022 *(
u64
 *)&
a˘i⁄
);

1025 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1026 i‡(
pfvf
->
def_uˇ°_ruÀ
)

1027 
pfvf
->
def_uˇ°_ruÀ
->
rx_a˘i⁄
 = 
a˘i⁄
;

1029 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

1030 
nixlf
, 
NIXLF_PROMISC_ENTRY
);

1035 i‡((!
hw
->
ˇp
.
nix_rx_mu…iˇ°
 || !
pfvf
->
u£_m˚_li°
) &&

1036 
	`is_mˇm_íåy_íabÀd
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
)) {

1037 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ödex
);

1038 
ödex
 &(
mˇm
->
b™ksize
 - 1);

1040 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1041 
	`NPC_AF_MCAMEX_BANKX_ACTION
(
ödex
, 
b™k
),

1042 *(
u64
 *)&
a˘i⁄
);

1044 
	}
}

1046 
	$≈c_íadis_deÁu…_m˚_íåy
(
rvu
 *rvu, 
u16
 
pcifunc
,

1047 
nixlf
, 
ty≥
, 
boﬁ
 
íabÀ
)

1049 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1050 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1051 
nix_m˚_li°
 *
m˚_li°
;

1052 
ödex
, 
blkaddr
, 
m˚_idx
;

1053 
rvu_pfvf
 *
pfvf
;

1055 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1056 i‡(
blkaddr
 < 0)

1059 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
,

1060 
nixlf
, 
ty≥
);

1063 i‡(!
hw
->
ˇp
.
nix_rx_mu…iˇ°
 && !
	`is_vf
(
pcifunc
)) {

1064 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
, 
íabÀ
);

1069 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
);

1070 i‡(
hw
->
ˇp
.
nix_rx_mu…iˇ°
 && 
	`is_vf
(
pcifunc
) &&

1071 
ty≥
 !
NIXLF_BCAST_ENTRY
 && !
pfvf
->
u£_m˚_li°
)

1074 
	`nix_gë_m˚_li°
(
rvu
, 
pcifunc
, 
ty≥
, &
m˚_li°
, &
m˚_idx
);

1076 
	`nix_upd©e_m˚_li°
(
rvu
, 
pcifunc
, 
m˚_li°
,

1077 
m˚_idx
, 
ödex
, 
íabÀ
);

1078 i‡(
íabÀ
)

1079 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
, 
íabÀ
);

1080 
	}
}

1082 
	$≈c_íadis_deÁu…_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
,

1083 
nixlf
, 
boﬁ
 
íabÀ
)

1085 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1086 
ödex
, 
blkaddr
;

1088 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1089 i‡(
blkaddr
 < 0)

1093 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
,

1094 
nixlf
, 
NIXLF_UCAST_ENTRY
);

1095 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
, 
íabÀ
);

1100 i‡((
pcifunc
 & 
RVU_PFVF_FUNC_MASK
Ë&& !
rvu
->
hw
->
ˇp
.
nix_rx_mu…iˇ°
)

1104 
	`≈c_íadis_deÁu…_m˚_íåy
(
rvu
, 
pcifunc
, 
nixlf
,

1105 
NIXLF_BCAST_ENTRY
, 
íabÀ
);

1106 
	}
}

1108 
	$rvu_≈c_dißbÀ_deÁu…_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
)

1110 i‡(
nixlf
 < 0)

1113 
	`≈c_íadis_deÁu…_íåõs
(
rvu
, 
pcifunc
, 
nixlf
, 
Ál£
);

1116 
	`≈c_íadis_deÁu…_m˚_íåy
(
rvu
, 
pcifunc
, 
nixlf
,

1117 
NIXLF_ALLMULTI_ENTRY
, 
Ál£
);

1118 
	`≈c_íadis_deÁu…_m˚_íåy
(
rvu
, 
pcifunc
, 
nixlf
,

1119 
NIXLF_PROMISC_ENTRY
, 
Ál£
);

1120 
	}
}

1122 
boﬁ
 
	$rvu_≈c_íabÀ_mˇm_by_íåy_ödex
(
rvu
 *rvu, 
íåy
, 
ötf
, 
boﬁ
 
íabÀ
)

1124 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1125 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1126 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
, *
tmp
;

1128 
	`muãx_lock
(&
mˇm
->
lock
);

1130 
	`li°_f‹_óch_íåy_ß„
(
ruÀ
, 
tmp
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

1131 i‡(
ruÀ
->
ötf
 != intf)

1134 i‡(
ruÀ
->
íåy
 !=Éntry)

1137 
ruÀ
->
íabÀ
 =Énable;

1138 
	`muãx_u∆ock
(&
mˇm
->
lock
);

1140 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
,

1141 
íåy
, 
íabÀ
);

1143  
åue
;

1146 
	`muãx_u∆ock
(&
mˇm
->
lock
);

1147  
Ál£
;

1148 
	}
}

1150 
	$rvu_≈c_íabÀ_deÁu…_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
)

1152 i‡(
nixlf
 < 0)

1158 
	`≈c_íadis_deÁu…_íåõs
(
rvu
, 
pcifunc
, 
nixlf
, 
åue
);

1159 
	}
}

1161 
	$rvu_≈c_dißbÀ_mˇm_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
)

1163 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1164 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1165 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
, *
tmp
;

1166 
blkaddr
;

1168 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1169 i‡(
blkaddr
 < 0)

1172 
	`muãx_lock
(&
mˇm
->
lock
);

1175 
	`li°_f‹_óch_íåy_ß„
(
ruÀ
, 
tmp
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

1176 i‡(
	`is_≈c_ötf_rx
(
ruÀ
->
ötf
) &&

1177 
ruÀ
->
rx_a˘i⁄
.
pf_func
 =
pcifunc
 &&

1178 
ruÀ
->
rx_a˘i⁄
.
›
 !
NIX_RX_ACTIONOP_MCAST
) {

1179 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
,

1180 
ruÀ
->
íåy
, 
Ál£
);

1181 
ruÀ
->
íabÀ
 = 
Ál£
;

1183 i‡(
ruÀ
->
deÁu…_ruÀ
) {

1184 
pfvf
->
def_uˇ°_ruÀ
 = 
NULL
;

1185 
	`li°_dñ
(&
ruÀ
->
li°
);

1186 
	`k‰ì
(
ruÀ
);

1191 
	`muãx_u∆ock
(&
mˇm
->
lock
);

1193 
	`≈c_mˇm_dißbÀ_Êows
(
rvu
, 
pcifunc
);

1195 
	`rvu_≈c_dißbÀ_deÁu…_íåõs
(
rvu
, 
pcifunc
, 
nixlf
);

1196 
	}
}

1198 
	$rvu_≈c_‰ì_mˇm_íåõs
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nixlf
)

1200 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1201 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
, *
tmp
;

1202 
blkaddr
;

1204 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1205 i‡(
blkaddr
 < 0)

1208 
	`muãx_lock
(&
mˇm
->
lock
);

1211 
	`≈c_mˇm_‰ì_Æl_íåõs
(
rvu
, 
mˇm
, 
blkaddr
, 
pcifunc
);

1214 
	`≈c_mˇm_‰ì_Æl_cou¡îs
(
rvu
, 
mˇm
, 
pcifunc
);

1217 
	`li°_f‹_óch_íåy_ß„
(
ruÀ
, 
tmp
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

1218 i‡(
ruÀ
->
ow√r
 =
pcifunc
 && !ruÀ->
deÁu…_ruÀ
) {

1219 
	`li°_dñ
(&
ruÀ
->
li°
);

1220 
	`k‰ì
(
ruÀ
);

1224 
	`muãx_u∆ock
(&
mˇm
->
lock
);

1226 
	`rvu_≈c_dißbÀ_deÁu…_íåõs
(
rvu
, 
pcifunc
, 
nixlf
);

1227 
	}
}

1229 
	$≈c_¥ogøm_mkex_rx
(
rvu
 *rvu, 
blkaddr
,

1230 
≈c_mˇm_kex
 *
mkex
, 
u8
 
ötf
)

1232 
lid
, 
…
, 
ld
, 
Ê
;

1234 i‡(
	`is_≈c_ötf_tx
(
ötf
))

1237 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_KEX_CFG
(
ötf
),

1238 
mkex
->
keyx_cfg
[
NIX_INTF_RX
]);

1241 
lid
 = 0;Üid < 
NPC_MAX_LID
;Üid++) {

1242 
…
 = 0;Üà< 
NPC_MAX_LT
;Üt++) {

1243 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++)

1244 
	`SET_KEX_LD
(
ötf
, 
lid
, 
…
, 
ld
,

1245 
mkex
->
ötf_lid_…_ld
[
NIX_INTF_RX
]

1246 [
lid
][
…
][
ld
]);

1250 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++) {

1251 
Ê
 = 0; f»< 
NPC_MAX_LFL
; fl++)

1252 
	`SET_KEX_LDFLAGS
(
ötf
, 
ld
, 
Ê
,

1253 
mkex
->
ötf_ld_Êags
[
NIX_INTF_RX
]

1254 [
ld
][
Ê
]);

1256 
	}
}

1258 
	$≈c_¥ogøm_mkex_tx
(
rvu
 *rvu, 
blkaddr
,

1259 
≈c_mˇm_kex
 *
mkex
, 
u8
 
ötf
)

1261 
lid
, 
…
, 
ld
, 
Ê
;

1263 i‡(
	`is_≈c_ötf_rx
(
ötf
))

1266 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_KEX_CFG
(
ötf
),

1267 
mkex
->
keyx_cfg
[
NIX_INTF_TX
]);

1270 
lid
 = 0;Üid < 
NPC_MAX_LID
;Üid++) {

1271 
…
 = 0;Üà< 
NPC_MAX_LT
;Üt++) {

1272 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++)

1273 
	`SET_KEX_LD
(
ötf
, 
lid
, 
…
, 
ld
,

1274 
mkex
->
ötf_lid_…_ld
[
NIX_INTF_TX
]

1275 [
lid
][
…
][
ld
]);

1279 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++) {

1280 
Ê
 = 0; f»< 
NPC_MAX_LFL
; fl++)

1281 
	`SET_KEX_LDFLAGS
(
ötf
, 
ld
, 
Ê
,

1282 
mkex
->
ötf_ld_Êags
[
NIX_INTF_TX
]

1283 [
ld
][
Ê
]);

1285 
	}
}

1287 
	$≈c_¥ogøm_mkex_¥ofûe
(
rvu
 *rvu, 
blkaddr
,

1288 
≈c_mˇm_kex
 *
mkex
)

1290 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1291 
u8
 
ötf
;

1292 
ld
;

1294 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++)

1295 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_KEX_LDATAX_FLAGS_CFG
(
ld
),

1296 
mkex
->
kex_ld_Êags
[
ld
]);

1298 
ötf
 = 0; i¡‡< 
hw
->
≈c_ötfs
; intf++) {

1299 
	`≈c_¥ogøm_mkex_rx
(
rvu
, 
blkaddr
, 
mkex
, 
ötf
);

1300 
	`≈c_¥ogøm_mkex_tx
(
rvu
, 
blkaddr
, 
mkex
, 
ötf
);

1304 
	`≈c_¥ogøm_mkex_hash
(
rvu
, 
blkaddr
);

1305 
	}
}

1307 
	$≈c_fwdb_¥Ê_img_m≠
(
rvu
 *rvu, 
__iomem
 **
¥Ê_img_addr
,

1308 
u64
 *
size
)

1310 
u64
 
¥Ê_addr
, 
¥Ê_sz
;

1312 i‡(!
rvu
->
fwd©a
)

1313  -
EINVAL
;

1315 
¥Ê_addr
 = 
rvu
->
fwd©a
->
mˇm_addr
;

1316 
¥Ê_sz
 = 
rvu
->
fwd©a
->
mˇm_sz
;

1318 i‡(!
¥Ê_addr
 || !
¥Ê_sz
)

1319  -
EINVAL
;

1321 *
¥Ê_img_addr
 = 
	`i‹em≠_wc
(
¥Ê_addr
, 
¥Ê_sz
);

1322 i‡(!(*
¥Ê_img_addr
))

1323  -
ENOMEM
;

1325 *
size
 = 
¥Ê_sz
;

1328 
	}
}

1331 
	#MKEX_END_SIGN
 0xdódbìf

	)

1333 
	$≈c_lﬂd_mkex_¥ofûe
(
rvu
 *rvu, 
blkaddr
,

1334 c⁄° *
mkex_¥ofûe
)

1336 
devi˚
 *
dev
 = &
rvu
->
pdev
->dev;

1337 
__iomem
 *
mkex_¥Ê_addr
 = 
NULL
;

1338 
≈c_mˇm_kex
 *
mˇm_kex
;

1339 
u64
 
¥Ê_sz
;

1340 
ªt
;

1348 i‡(
rvu
->
kpu_fwd©a_sz
 ||

1349 !
	`°∫cmp
(
mkex_¥ofûe
, 
def_pÊ_«me
, 
MKEX_NAME_LEN
))

1350 
¥ogøm_mkex
;

1352 
ªt
 = 
	`≈c_fwdb_¥Ê_img_m≠
(
rvu
, &
mkex_¥Ê_addr
, &
¥Ê_sz
);

1353 i‡(
ªt
 < 0)

1354 
¥ogøm_mkex
;

1356 
mˇm_kex
 = (
≈c_mˇm_kex
 
__f‹˚
 *)
mkex_¥Ê_addr
;

1358 ((
s64
)
¥Ê_sz
 > 0Ë&& (
mˇm_kex
->
mkex_sign
 !
MKEX_END_SIGN
)) {

1360 i‡(
mˇm_kex
->
mkex_sign
 =
MKEX_SIGN
 &&

1361 !
	`°∫cmp
(
mˇm_kex
->
«me
, 
mkex_¥ofûe
, 
MKEX_NAME_LEN
)) {

1363 i‡(
	`is_∑r£_nibbÀ_c⁄fig_vÆid
(
rvu
, 
mˇm_kex
))

1364 
rvu
->
kpu
.
mkex
 = 
mˇm_kex
;

1365 
¥ogøm_mkex
;

1368 
mˇm_kex
++;

1369 
¥Ê_sz
 -(
≈c_mˇm_kex
);

1371 
	`dev_w¨n
(
dev
, "FaûedÅÿlﬂdÑeque°edÖrofûe: %s\n", 
mkex_¥ofûe
);

1373 
¥ogøm_mkex
:

1374 
	`dev_öfo
(
rvu
->
dev
, "Usög %†mkexÖrofûe\n",Ñvu->
kpu
.
mkex
->
«me
);

1376 
	`≈c_¥ogøm_mkex_¥ofûe
(
rvu
, 
blkaddr
,Ñvu->
kpu
.
mkex
);

1377 i‡(
mkex_¥Ê_addr
)

1378 
	`iounm≠
(
mkex_¥Ê_addr
);

1379 
	}
}

1381 
	$≈c_c⁄fig_kpua˘i⁄
(
rvu
 *rvu, 
blkaddr
,

1382 c⁄° 
≈c_kpu_¥ofûe_a˘i⁄
 *
kpua˘i⁄
,

1383 
kpu
, 
íåy
, 
boﬁ
 
pköd
)

1385 
≈c_kpu_a˘i⁄0
 
a˘i⁄0
 = {0};

1386 
≈c_kpu_a˘i⁄1
 
a˘i⁄1
 = {0};

1387 
u64
 
ªg
;

1389 
a˘i⁄1
.
îæev
 = 
kpua˘i⁄
->errlev;

1390 
a˘i⁄1
.
îrcode
 = 
kpua˘i⁄
->errcode;

1391 
a˘i⁄1
.
dp0_off£t
 = 
kpua˘i⁄
->dp0_offset;

1392 
a˘i⁄1
.
dp1_off£t
 = 
kpua˘i⁄
->dp1_offset;

1393 
a˘i⁄1
.
dp2_off£t
 = 
kpua˘i⁄
->dp2_offset;

1395 i‡(
pköd
)

1396 
ªg
 = 
	`NPC_AF_PKINDX_ACTION1
(
íåy
);

1398 
ªg
 = 
	`NPC_AF_KPUX_ENTRYX_ACTION1
(
kpu
, 
íåy
);

1400 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªg
, *(
u64
 *)&
a˘i⁄1
);

1402 
a˘i⁄0
.
byp_cou¡
 = 
kpua˘i⁄
->
by∑ss_cou¡
;

1403 
a˘i⁄0
.
ˇ±uª_ía
 = 
kpua˘i⁄
->
ˇp_ía
;

1404 
a˘i⁄0
.
∑r£_d⁄e
 = 
kpua˘i⁄
->parse_done;

1405 
a˘i⁄0
.
√xt_°©e
 = 
kpua˘i⁄
->next_state;

1406 
a˘i⁄0
.
ˇ±uª_lid
 = 
kpua˘i⁄
->
lid
;

1407 
a˘i⁄0
.
ˇ±uª_…y≥
 = 
kpua˘i⁄
->
…y≥
;

1408 
a˘i⁄0
.
ˇ±uª_Êags
 = 
kpua˘i⁄
->
Êags
;

1409 
a˘i⁄0
.
±r_adv™˚
 = 
kpua˘i⁄
->ptr_advance;

1410 
a˘i⁄0
.
v¨_Àn_off£t
 = 
kpua˘i⁄
->
off£t
;

1411 
a˘i⁄0
.
v¨_Àn_mask
 = 
kpua˘i⁄
->
mask
;

1412 
a˘i⁄0
.
v¨_Àn_right
 = 
kpua˘i⁄
->
right
;

1413 
a˘i⁄0
.
v¨_Àn_shi·
 = 
kpua˘i⁄
->
shi·
;

1415 i‡(
pköd
)

1416 
ªg
 = 
	`NPC_AF_PKINDX_ACTION0
(
íåy
);

1418 
ªg
 = 
	`NPC_AF_KPUX_ENTRYX_ACTION0
(
kpu
, 
íåy
);

1420 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªg
, *(
u64
 *)&
a˘i⁄0
);

1421 
	}
}

1423 
	$≈c_c⁄fig_kpuˇm
(
rvu
 *rvu, 
blkaddr
,

1424 c⁄° 
≈c_kpu_¥ofûe_ˇm
 *
kpuˇm
,

1425 
kpu
, 
íåy
)

1427 
≈c_kpu_ˇm
 
ˇm0
 = {0};

1428 
≈c_kpu_ˇm
 
ˇm1
 = {0};

1430 
ˇm1
.
°©e
 = 
kpuˇm
->°©ê& kpuˇm->
°©e_mask
;

1431 
ˇm1
.
dp0_d©a
 = 
kpuˇm
->
dp0
 & kpuˇm->
dp0_mask
;

1432 
ˇm1
.
dp1_d©a
 = 
kpuˇm
->
dp1
 & kpuˇm->
dp1_mask
;

1433 
ˇm1
.
dp2_d©a
 = 
kpuˇm
->
dp2
 & kpuˇm->
dp2_mask
;

1435 
ˇm0
.
°©e
 = ~
kpuˇm
->°©ê& kpuˇm->
°©e_mask
;

1436 
ˇm0
.
dp0_d©a
 = ~
kpuˇm
->
dp0
 & kpuˇm->
dp0_mask
;

1437 
ˇm0
.
dp1_d©a
 = ~
kpuˇm
->
dp1
 & kpuˇm->
dp1_mask
;

1438 
ˇm0
.
dp2_d©a
 = ~
kpuˇm
->
dp2
 & kpuˇm->
dp2_mask
;

1440 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1441 
	`NPC_AF_KPUX_ENTRYX_CAMX
(
kpu
, 
íåy
, 0), *(
u64
 *)&
ˇm0
);

1442 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1443 
	`NPC_AF_KPUX_ENTRYX_CAMX
(
kpu
, 
íåy
, 1), *(
u64
 *)&
ˇm1
);

1444 
	}
}

1446 
ölöe
 
u64
 
	$íabÀ_mask
(
cou¡
)

1448  (((
cou¡
Ë< 64Ë? ~(
	`BIT_ULL
(count) - 1) : (0x00ULL));

1449 
	}
}

1451 
	$≈c_¥ogøm_kpu_¥ofûe
(
rvu
 *rvu, 
blkaddr
, 
kpu
,

1452 c⁄° 
≈c_kpu_¥ofûe
 *
¥ofûe
)

1454 
íåy
, 
num_íåõs
, 
max_íåõs
;

1455 
u64
 
íåy_mask
;

1457 i‡(
¥ofûe
->
ˇm_íåõs
 !¥ofûe->
a˘i⁄_íåõs
) {

1458 
	`dev_îr
(
rvu
->
dev
,

1460 
kpu
, 
¥ofûe
->
ˇm_íåõs
,Örofûe->
a˘i⁄_íåõs
);

1463 
max_íåõs
 = 
rvu
->
hw
->
≈c_kpu_íåõs
;

1466 
num_íåõs
 = 
	`mö_t
(, 
¥ofûe
->
ˇm_íåõs
, 
max_íåõs
);

1467 
íåy
 = 0;É¡ry < 
num_íåõs
;Éntry++)

1468 
	`≈c_c⁄fig_kpuˇm
(
rvu
, 
blkaddr
,

1469 &
¥ofûe
->
ˇm
[
íåy
], 
kpu
,Éntry);

1472 
num_íåõs
 = 
	`mö_t
(, 
¥ofûe
->
a˘i⁄_íåõs
, 
max_íåõs
);

1473 
íåy
 = 0;É¡ry < 
num_íåõs
;Éntry++)

1474 
	`≈c_c⁄fig_kpua˘i⁄
(
rvu
, 
blkaddr
, &
¥ofûe
->
a˘i⁄
[
íåy
],

1475 
kpu
, 
íåy
, 
Ál£
);

1478 
num_íåõs
 = 
	`mö_t
(, 
¥ofûe
->
a˘i⁄_íåõs
,Örofûe->
ˇm_íåõs
);

1479 
íåy_mask
 = 
	`íabÀ_mask
(
num_íåõs
);

1481 i‡(!
rvu
->
kpu
.
cu°om
)

1482 
íåy_mask
 |
	`GENMASK_ULL
(
KPU_MAX_CST_ENT
 - 1, 0);

1483 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1484 
	`NPC_AF_KPUX_ENTRY_DISX
(
kpu
, 0), 
íåy_mask
);

1485 i‡(
num_íåõs
 > 64) {

1486 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1487 
	`NPC_AF_KPUX_ENTRY_DISX
(
kpu
, 1),

1488 
	`íabÀ_mask
(
num_íåõs
 - 64));

1492 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_KPUX_CFG
(
kpu
), 0x01);

1493 
	}
}

1495 
	$≈c_¥ï¨e_deÁu…_kpu
(
≈c_kpu_¥ofûe_ad≠ãr
 *
¥ofûe
)

1497 
¥ofûe
->
cu°om
 = 0;

1498 
¥ofûe
->
«me
 = 
def_pÊ_«me
;

1499 
¥ofûe
->
vîsi⁄
 = 
NPC_KPU_PROFILE_VER
;

1500 
¥ofûe
->
ikpu
 = 
ikpu_a˘i⁄_íåõs
;

1501 
¥ofûe
->
pköds
 = 
	`ARRAY_SIZE
(
ikpu_a˘i⁄_íåõs
);

1502 
¥ofûe
->
kpu
 = 
≈c_kpu_¥ofûes
;

1503 
¥ofûe
->
kpus
 = 
	`ARRAY_SIZE
(
≈c_kpu_¥ofûes
);

1504 
¥ofûe
->
…_def
 = &
≈c_…_deÁu…s
;

1505 
¥ofûe
->
mkex
 = &
≈c_mkex_deÁu…
;

1506 
¥ofûe
->
mkex_hash
 = &
≈c_mkex_hash_deÁu…
;

1509 
	}
}

1511 
	$≈c_≠∂y_cu°om_kpu
(
rvu
 *rvu,

1512 
≈c_kpu_¥ofûe_ad≠ãr
 *
¥ofûe
)

1514 
size_t
 
hdr_sz
 = (
≈c_kpu_¥ofûe_fwd©a
), 
off£t
 = 0;

1515 
≈c_kpu_¥ofûe_fwd©a
 *
fw
 = 
rvu
->
kpu_fwd©a
;

1516 
≈c_kpu_¥ofûe_a˘i⁄
 *
a˘i⁄
;

1517 
≈c_kpu_¥ofûe_ˇm
 *
ˇm
;

1518 
≈c_kpu_fwd©a
 *
fw_kpu
;

1519 
íåõs
;

1520 
u16
 
kpu
, 
íåy
;

1522 i‡(
rvu
->
kpu_fwd©a_sz
 < 
hdr_sz
) {

1523 
	`dev_w¨n
(
rvu
->
dev
, "Invalid KPUÖrofile size\n");

1524  -
EINVAL
;

1526 i‡(
	`À64_to_˝u
(
fw
->
sig«tuª
Ë!
KPU_SIGN
) {

1527 
	`dev_w¨n
(
rvu
->
dev
, "Invalid KPUÖrofile signature %llx\n",

1528 
fw
->
sig«tuª
);

1529  -
EINVAL
;

1531 
¥ofûe
->
cu°om
 = 1;

1532 
¥ofûe
->
«me
 = 
fw
->name;

1533 
¥ofûe
->
vîsi⁄
 = 
	`À64_to_˝u
(
fw
->version);

1534 
¥ofûe
->
mkex
 = &
fw
->mkex;

1537 i‡(
	`NPC_KPU_VER_MAJ
(
¥ofûe
->
vîsi⁄
) >

1538 
	`NPC_KPU_VER_MAJ
(
NPC_KPU_PROFILE_VER
)) {

1539 
	`dev_w¨n
(
rvu
->
dev
, "Not supported Major version: %d > %d\n",

1540 
	`NPC_KPU_VER_MAJ
(
¥ofûe
->
vîsi⁄
),

1541 
	`NPC_KPU_VER_MAJ
(
NPC_KPU_PROFILE_VER
));

1542  -
EINVAL
;

1545 i‡(
	`NPC_KPU_VER_MIN
(
¥ofûe
->
vîsi⁄
) <

1546 
	`NPC_KPU_VER_MIN
(
NPC_KPU_PROFILE_VER
)) {

1547 
	`dev_w¨n
(
rvu
->
dev
,

1549 
	`NPC_KPU_VER_MAJ
(
¥ofûe
->
vîsi⁄
),

1550 
	`NPC_KPU_VER_MIN
(
¥ofûe
->
vîsi⁄
),

1551 
	`NPC_KPU_VER_PATCH
(
¥ofûe
->
vîsi⁄
),

1552 
	`NPC_KPU_VER_MAJ
(
NPC_KPU_PROFILE_VER
),

1553 
	`NPC_KPU_VER_MIN
(
NPC_KPU_PROFILE_VER
),

1554 
	`NPC_KPU_VER_PATCH
(
NPC_KPU_PROFILE_VER
));

1555  -
EINVAL
;

1558 i‡(
fw
->
kpus
 > 
¥ofûe
->kpus) {

1559 
	`dev_w¨n
(
rvu
->
dev
, "NŸÉnough KPUs: %d > %ld\n", 
fw
->
kpus
,

1560 
¥ofûe
->
kpus
);

1561  -
EINVAL
;

1564 
¥ofûe
->
…_def
 = &
fw
->lt_def;

1566 
kpu
 = 0; kpu < 
fw
->
kpus
; kpu++) {

1567 
fw_kpu
 = (
≈c_kpu_fwd©a
 *)(
fw
->
d©a
 + 
off£t
);

1568 i‡(
fw_kpu
->
íåõs
 > 
KPU_MAX_CST_ENT
)

1569 
	`dev_w¨n
(
rvu
->
dev
,

1571 
kpu
, 
fw_kpu
->
íåõs
, 
KPU_MAX_CST_ENT
);

1572 
íåõs
 = 
	`mö
(
fw_kpu
->íåõs, 
KPU_MAX_CST_ENT
);

1573 
ˇm
 = (
≈c_kpu_¥ofûe_ˇm
 *)
fw_kpu
->
d©a
;

1574 
off£t
 +(*
fw_kpu
Ë+ fw_kpu->
íåõs
 * (*
ˇm
);

1575 
a˘i⁄
 = (
≈c_kpu_¥ofûe_a˘i⁄
 *)(
fw
->
d©a
 + 
off£t
);

1576 
off£t
 +
fw_kpu
->
íåõs
 * (*
a˘i⁄
);

1577 i‡(
rvu
->
kpu_fwd©a_sz
 < 
hdr_sz
 + 
off£t
) {

1578 
	`dev_w¨n
(
rvu
->
dev
,

1580 
kpu
 + 1);

1581  -
EINVAL
;

1584 
íåy
 = 0;É¡ry < 
íåõs
;Éntry++) {

1585 
ˇm
[
íåy
].
dp0
 = 
	`À16_to_˝u
(cam[entry].dp0);

1586 
ˇm
[
íåy
].
dp0_mask
 = 
	`À16_to_˝u
(cam[entry].dp0_mask);

1587 
ˇm
[
íåy
].
dp1
 = 
	`À16_to_˝u
(cam[entry].dp1);

1588 
ˇm
[
íåy
].
dp1_mask
 = 
	`À16_to_˝u
(cam[entry].dp1_mask);

1589 
ˇm
[
íåy
].
dp2
 = 
	`À16_to_˝u
(cam[entry].dp2);

1590 
ˇm
[
íåy
].
dp2_mask
 = 
	`À16_to_˝u
(cam[entry].dp2_mask);

1591 
¥ofûe
->
kpu
[kpu].
ˇm
[
íåy
] = cam[entry];

1592 
¥ofûe
->
kpu
[kpu].
a˘i⁄
[
íåy
] =áction[entry];

1597 
	}
}

1599 
	$≈c_lﬂd_kpu_¥Ê_img
(
rvu
 *rvu, 
__iomem
 *
¥Ê_addr
,

1600 
u64
 
¥Ê_sz
, c⁄° *
kpu_¥ofûe
)

1602 
≈c_kpu_¥ofûe_fwd©a
 *
kpu_d©a
 = 
NULL
;

1603 
rc
 = -
EINVAL
;

1605 
kpu_d©a
 = (
≈c_kpu_¥ofûe_fwd©a
 
__f‹˚
 *)
¥Ê_addr
;

1606 i‡(
	`À64_to_˝u
(
kpu_d©a
->
sig«tuª
Ë=
KPU_SIGN
 &&

1607 !
	`°∫cmp
(
kpu_d©a
->
«me
, 
kpu_¥ofûe
, 
KPU_NAME_LEN
)) {

1608 
	`dev_öfo
(
rvu
->
dev
, "Loading KPUÖrofile from firmware db: %s\n",

1609 
kpu_¥ofûe
);

1610 
rvu
->
kpu_fwd©a
 = 
kpu_d©a
;

1611 
rvu
->
kpu_fwd©a_sz
 = 
¥Ê_sz
;

1612 
rvu
->
kpu_¥Ê_addr
 = 
¥Ê_addr
;

1613 
rc
 = 0;

1616  
rc
;

1617 
	}
}

1619 
	$≈c_fwdb_dëe˘_lﬂd_¥Ê_img
(
rvu
 *rvu, 
uöt64_t
 
¥Ê_sz
,

1620 c⁄° *
kpu_¥ofûe
)

1622 
≈c_cﬂÀs˚d_kpu_¥Ê
 *
img_d©a
 = 
NULL
;

1623 
i
 = 0, 
rc
 = -
EINVAL
;

1624 
__iomem
 *
kpu_¥Ê_addr
;

1625 
u16
 
off£t
;

1627 
img_d©a
 = (
≈c_cﬂÀs˚d_kpu_¥Ê
 
__f‹˚
 *)
rvu
->
kpu_¥Ê_addr
;

1628 i‡(
	`À64_to_˝u
(
img_d©a
->
sig«tuª
Ë=
KPU_SIGN
 &&

1629 !
	`°∫cmp
(
img_d©a
->
«me
, 
kpu_¥ofûe
, 
KPU_NAME_LEN
)) {

1631 
rc
 = 
	`≈c_lﬂd_kpu_¥Ê_img
(
rvu
,Ñvu->
kpu_¥Ê_addr
,

1632 
¥Ê_sz
, 
kpu_¥ofûe
);

1633 
d⁄e
;

1637 
off£t
 = 
	`off£tof
(
≈c_cﬂÀs˚d_kpu_¥Ê
, 
¥Ê_sz
) +

1638 (
img_d©a
->
num_¥Ê
 * (
uöt16_t
));

1640 
i
 < 
img_d©a
->
num_¥Ê
) {

1642 
off£t
 = 
	`ALIGN_8B_CEIL
(offset);

1643 
kpu_¥Ê_addr
 = (
__iomem
 *)((
uöçå_t
)
rvu
->kpu_prfl_addr +

1644 
off£t
);

1645 
rc
 = 
	`≈c_lﬂd_kpu_¥Ê_img
(
rvu
, 
kpu_¥Ê_addr
,

1646 
img_d©a
->
¥Ê_sz
[
i
], 
kpu_¥ofûe
);

1647 i‡(!
rc
)

1650 
off£t
 +
img_d©a
->
¥Ê_sz
[
i
];

1651 
i
++;

1653 
d⁄e
:

1654  
rc
;

1655 
	}
}

1657 
	$≈c_lﬂd_kpu_¥ofûe_fwdb
(
rvu
 *rvu, c⁄° *
kpu_¥ofûe
)

1659 
ªt
 = -
EINVAL
;

1660 
u64
 
¥Ê_sz
;

1663 
ªt
 = 
	`≈c_fwdb_¥Ê_img_m≠
(
rvu
, &rvu->
kpu_¥Ê_addr
, &
¥Ê_sz
);

1664 i‡(
ªt
 < 0)

1665 
d⁄e
;

1668 
ªt
 = 
	`≈c_fwdb_dëe˘_lﬂd_¥Ê_img
(
rvu
, 
¥Ê_sz
, 
kpu_¥ofûe
);

1669 i‡(
ªt
 == 0)

1670 
d⁄e
;

1673 i‡(
rvu
->
kpu_¥Ê_addr
) {

1674 
	`iounm≠
(
rvu
->
kpu_¥Ê_addr
);

1675 
rvu
->
kpu_¥Ê_addr
 = 
NULL
;

1676 
rvu
->
kpu_fwd©a_sz
 = 0;

1677 
rvu
->
kpu_fwd©a
 = 
NULL
;

1680 
d⁄e
:

1681  
ªt
;

1682 
	}
}

1684 
	$≈c_lﬂd_kpu_¥ofûe
(
rvu
 *rvu)

1686 
≈c_kpu_¥ofûe_ad≠ãr
 *
¥ofûe
 = &
rvu
->
kpu
;

1687 c⁄° *
kpu_¥ofûe
 = 
rvu
->
kpu_pÊ_«me
;

1688 c⁄° 
fúmw¨e
 *
fw
 = 
NULL
;

1689 
boﬁ
 
ªåy_fwdb
 = 
Ál£
;

1692 i‡(!
	`°∫cmp
(
kpu_¥ofûe
, 
def_pÊ_«me
, 
KPU_NAME_LEN
))

1693 
ªvît_to_deÁu…
;

1695 
	`≈c_¥ï¨e_deÁu…_kpu
(
¥ofûe
);

1702 i‡(!
	`fúmw¨e_ªque°_now¨n
(&
fw
, 
kpu_¥ofûe
, 
rvu
->
dev
)) {

1703 
	`dev_öfo
(
rvu
->
dev
, "Loading KPUÖrofile from firmware: %s\n",

1704 
kpu_¥ofûe
);

1705 
rvu
->
kpu_fwd©a
 = 
	`kzÆloc
(
fw
->
size
, 
GFP_KERNEL
);

1706 i‡(
rvu
->
kpu_fwd©a
) {

1707 
	`mem˝y
(
rvu
->
kpu_fwd©a
, 
fw
->
d©a
, fw->
size
);

1708 
rvu
->
kpu_fwd©a_sz
 = 
fw
->
size
;

1710 
	`ªÀa£_fúmw¨e
(
fw
);

1711 
ªåy_fwdb
 = 
åue
;

1712 
¥ogøm_kpu
;

1715 
lﬂd_image_fwdb
:

1717 i‡(
	`≈c_lﬂd_kpu_¥ofûe_fwdb
(
rvu
, 
kpu_¥ofûe
))

1718 
ªvît_to_deÁu…
;

1720 
¥ogøm_kpu
:

1722 i‡(!
rvu
->
kpu_fwd©a_sz
 || 
	`≈c_≠∂y_cu°om_kpu
‘vu, 
¥ofûe
)) {

1726 i‡(
rvu
->
kpu_fwd©a
 ||Ñvu->
kpu_fwd©a_sz
) {

1728 i‡(
rvu
->
kpu_¥Ê_addr
) {

1729 
	`iounm≠
(
rvu
->
kpu_¥Ê_addr
);

1730 
rvu
->
kpu_¥Ê_addr
 = 
NULL
;

1732 
	`k‰ì
(
rvu
->
kpu_fwd©a
);

1734 
rvu
->
kpu_fwd©a
 = 
NULL
;

1735 
rvu
->
kpu_fwd©a_sz
 = 0;

1736 i‡(
ªåy_fwdb
) {

1737 
ªåy_fwdb
 = 
Ál£
;

1738 
lﬂd_image_fwdb
;

1742 
	`dev_w¨n
(
rvu
->
dev
,

1744 
kpu_¥ofûe
);

1745 
	`k‰ì
(
rvu
->
kpu_fwd©a
);

1746 
rvu
->
kpu_fwd©a
 = 
NULL
;

1747 
ªvît_to_deÁu…
;

1750 
	`dev_öfo
(
rvu
->
dev
, "Using customÖrofile '%s', version %d.%d.%d\n",

1751 
¥ofûe
->
«me
, 
	`NPC_KPU_VER_MAJ
’rofûe->
vîsi⁄
),

1752 
	`NPC_KPU_VER_MIN
(
¥ofûe
->
vîsi⁄
),

1753 
	`NPC_KPU_VER_PATCH
(
¥ofûe
->
vîsi⁄
));

1757 
ªvît_to_deÁu…
:

1758 
	`≈c_¥ï¨e_deÁu…_kpu
(
¥ofûe
);

1759 
	}
}

1761 
	$≈c_∑r£r_¥ofûe_öô
(
rvu
 *rvu, 
blkaddr
)

1763 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1764 
num_pköds
, 
num_kpus
, 
idx
;

1767 
idx
 = 0; idx < 
hw
->
≈c_kpus
; idx++) {

1768 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1769 
	`NPC_AF_KPUX_ENTRY_DISX
(
idx
, 0), ~0ULL);

1770 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1771 
	`NPC_AF_KPUX_ENTRY_DISX
(
idx
, 1), ~0ULL);

1772 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_KPUX_CFG
(
idx
), 0x00);

1776 
	`≈c_lﬂd_kpu_¥ofûe
(
rvu
);

1782 
num_pköds
 = 
rvu
->
kpu
.
pköds
;

1783 
num_pköds
 = 
	`mö_t
(, 
hw
->
≈c_pköds
,Çum_pkinds);

1785 
idx
 = 0; idx < 
num_pköds
; idx++)

1786 
	`≈c_c⁄fig_kpua˘i⁄
(
rvu
, 
blkaddr
, &rvu->
kpu
.
ikpu
[
idx
], 0, idx, 
åue
);

1789 
num_kpus
 = 
rvu
->
kpu
.
kpus
;

1790 
num_kpus
 = 
	`mö_t
(, 
hw
->
≈c_kpus
,Çum_kpus);

1792 
idx
 = 0; idx < 
num_kpus
; idx++)

1793 
	`≈c_¥ogøm_kpu_¥ofûe
(
rvu
, 
blkaddr
, 
idx
, &rvu->
kpu
.kpu[idx]);

1794 
	}
}

1796 
	$≈c_mˇm_r§cs_öô
(
rvu
 *rvu, 
blkaddr
)

1798 
nixlf_cou¡
 = 
	`rvu_gë_nixlf_cou¡
(
rvu
);

1799 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1800 
rsvd
, 
îr
;

1801 
u16
 
ödex
;

1802 
˙å
;

1803 
u64
 
cfg
;

1806 
cfg
 = (
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1807 
	`NPC_AF_INTFX_KEX_CFG
(0)) >> 32) & 0x07;

1808 
mˇm
->
tŸÆ_íåõs
 = (mˇm->
b™ks
 / 
	`BIT_ULL
(
cfg
)Ë* mˇm->
b™ksize
;

1809 
mˇm
->
keysize
 = 
cfg
;

1812 i‡(
cfg
 =
NPC_MCAM_KEY_X4
)

1813 
mˇm
->
b™ks_≥r_íåy
 = 4;

1814 i‡(
cfg
 =
NPC_MCAM_KEY_X2
)

1815 
mˇm
->
b™ks_≥r_íåy
 = 2;

1817 
mˇm
->
b™ks_≥r_íåy
 = 1;

1826 
rsvd
 = (
nixlf_cou¡
 * 
RSVD_MCAM_ENTRIES_PER_NIXLF
) +

1827 ((
rvu
->
hw
->
tŸÆ_pfs
 - 1Ë* 
RSVD_MCAM_ENTRIES_PER_PF
);

1828 i‡(
mˇm
->
tŸÆ_íåõs
 <
rsvd
) {

1829 
	`dev_w¨n
(
rvu
->
dev
,

1831 
mˇm
->
tŸÆ_íåõs
);

1832  -
ENOMEM
;

1835 
mˇm
->
bm≠_íåõs
 = mˇm->
tŸÆ_íåõs
 - 
rsvd
;

1836 
mˇm
->
nixlf_off£t
 = mˇm->
bm≠_íåõs
;

1837 
mˇm
->
pf_off£t
 = mˇm->
nixlf_off£t
 + 
nixlf_cou¡
;

1840 
mˇm
->
bm≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
	`BITS_TO_LONGS
(mˇm->
bm≠_íåõs
),

1841 (), 
GFP_KERNEL
);

1842 i‡(!
mˇm
->
bm≠
)

1843  -
ENOMEM
;

1845 
mˇm
->
bm≠_ªvî£
 = 
	`devm_kˇŒoc
(
rvu
->
dev
,

1846 
	`BITS_TO_LONGS
(
mˇm
->
bm≠_íåõs
),

1847 (), 
GFP_KERNEL
);

1848 i‡(!
mˇm
->
bm≠_ªvî£
)

1849  -
ENOMEM
;

1851 
mˇm
->
bm≠_f˙t
 = mˇm->
bm≠_íåõs
;

1854 
mˇm
->
íåy2pfvf_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, mˇm->
bm≠_íåõs
,

1855 (
u16
), 
GFP_KERNEL
);

1856 i‡(!
mˇm
->
íåy2pfvf_m≠
)

1857  -
ENOMEM
;

1863 
mˇm
->
Õrio_cou¡
 = mˇm->
bm≠_íåõs
 / 8;

1864 i‡(
mˇm
->
Õrio_cou¡
 > 
BITS_PER_LONG
)

1865 
mˇm
->
Õrio_cou¡
 = 
	`round_down
(mcam->lprio_count,

1866 
BITS_PER_LONG
);

1867 
mˇm
->
Õrio_°¨t
 = mˇm->
bm≠_íåõs
 - mˇm->
Õrio_cou¡
;

1868 
mˇm
->
h¥io_cou¡
 = mˇm->
Õrio_cou¡
;

1869 
mˇm
->
h¥io_íd
 = mˇm->
h¥io_cou¡
;

1874 
îr
 = 
	`rvu_Æloc_bôm≠
(&
mˇm
->
cou¡îs
);

1875 i‡(
îr
)

1876  
îr
;

1878 
mˇm
->
˙å2pfvf_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, mˇm->
cou¡îs
.
max
,

1879 (
u16
), 
GFP_KERNEL
);

1880 i‡(!
mˇm
->
˙å2pfvf_m≠
)

1881 
‰ì_mem
;

1886 
mˇm
->
íåy2˙å_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, mˇm->
bm≠_íåõs
,

1887 (
u16
), 
GFP_KERNEL
);

1888 i‡(!
mˇm
->
íåy2˙å_m≠
)

1889 
‰ì_mem
;

1891 
mˇm
->
˙å_ªf˙t
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, mˇm->
cou¡îs
.
max
,

1892 (
u16
), 
GFP_KERNEL
);

1893 i‡(!
mˇm
->
˙å_ªf˙t
)

1894 
‰ì_mem
;

1897 
mˇm
->
íåy2èrgë_pffunc
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, mˇm->
tŸÆ_íåõs
,

1898 (
u16
), 
GFP_KERNEL
);

1899 i‡(!
mˇm
->
íåy2èrgë_pffunc
)

1900 
‰ì_mem
;

1902 
ödex
 = 0; index < 
mˇm
->
bm≠_íåõs
; index++) {

1903 
mˇm
->
íåy2pfvf_m≠
[
ödex
] = 
NPC_MCAM_INVALID_MAP
;

1904 
mˇm
->
íåy2˙å_m≠
[
ödex
] = 
NPC_MCAM_INVALID_MAP
;

1907 
˙å
 = 0; c¡∏< 
mˇm
->
cou¡îs
.
max
; cntr++)

1908 
mˇm
->
˙å2pfvf_m≠
[
˙å
] = 
NPC_MCAM_INVALID_MAP
;

1910 
	`muãx_öô
(&
mˇm
->
lock
);

1914 
‰ì_mem
:

1915 
	`k‰ì
(
mˇm
->
cou¡îs
.
bm≠
);

1916  -
ENOMEM
;

1917 
	}
}

1919 
	$rvu_≈c_hw_öô
(
rvu
 *rvu, 
blkaddr
)

1921 
≈c_pköd
 *
pköd
 = &
rvu
->
hw
->pkind;

1922 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1923 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1924 
u64
 
≈c_c⁄°
, 
≈c_c⁄°1
;

1925 
u64
 
≈c_c⁄°2
 = 0;

1927 
≈c_c⁄°
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPC_AF_CONST
);

1928 
≈c_c⁄°1
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPC_AF_CONST1
);

1929 i‡(
≈c_c⁄°1
 & 
	`BIT_ULL
(63))

1930 
≈c_c⁄°2
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPC_AF_CONST2
);

1932 
pköd
->
r§c
.
max
 = 
NPC_UNRESERVED_PKIND_COUNT
;

1933 
hw
->
≈c_pköds
 = (
≈c_c⁄°1
 >> 12) & 0xFFULL;

1934 
hw
->
≈c_kpu_íåõs
 = 
≈c_c⁄°1
 & 0xFFFULL;

1935 
hw
->
≈c_kpus
 = (
≈c_c⁄°
 >> 8) & 0x1FULL;

1936 
hw
->
≈c_ötfs
 = 
≈c_c⁄°
 & 0xFULL;

1937 
hw
->
≈c_cou¡îs
 = (
≈c_c⁄°
 >> 48) & 0xFFFFULL;

1939 
mˇm
->
b™ks
 = (
≈c_c⁄°
 >> 44) & 0xFULL;

1940 
mˇm
->
b™ksize
 = (
≈c_c⁄°
 >> 28) & 0xFFFFULL;

1941 
hw
->
≈c_°©_ía
 = 
	`BIT_ULL
(9);

1943 i‡(
≈c_c⁄°2
) {

1944 
hw
->
≈c_ext_£t
 = 
åue
;

1955 i‡(!
hw
->
≈c_cou¡îs
)

1956 
hw
->
≈c_°©_ía
 = 
	`BIT_ULL
(63);

1957 
hw
->
≈c_cou¡îs
 = (
≈c_c⁄°2
 >> 16) & 0xFFFFULL;

1958 
mˇm
->
b™ksize
 = 
≈c_c⁄°2
 & 0xFFFFULL;

1961 
mˇm
->
cou¡îs
.
max
 = 
hw
->
≈c_cou¡îs
;

1962 
	}
}

1964 
	$rvu_≈c_£tup_öãrÁ˚s
(
rvu
 *rvu, 
blkaddr
)

1966 
≈c_mˇm_kex
 *
mkex
 = 
rvu
->
kpu
.mkex;

1967 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1968 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1969 
u64
 
nibbÀ_ía
, 
rx_kex
, 
tx_kex
;

1970 
u8
 
ötf
;

1976 
mˇm
->
cou¡îs
.
max
--;

1977 
mˇm
->
rx_miss_a˘_˙å
 = mˇm->
cou¡îs
.
max
;

1979 
rx_kex
 = 
mkex
->
keyx_cfg
[
NIX_INTF_RX
];

1980 
tx_kex
 = 
mkex
->
keyx_cfg
[
NIX_INTF_TX
];

1981 
nibbÀ_ía
 = 
	`FIELD_GET
(
NPC_PARSE_NIBBLE
, 
rx_kex
);

1983 
nibbÀ_ía
 = 
	`rvu_≈c_gë_tx_nibbÀ_cfg
(
rvu
,Çibble_ena);

1984 i‡(
nibbÀ_ía
) {

1985 
tx_kex
 &~
NPC_PARSE_NIBBLE
;

1986 
tx_kex
 |
	`FIELD_PREP
(
NPC_PARSE_NIBBLE
, 
nibbÀ_ía
);

1987 
mkex
->
keyx_cfg
[
NIX_INTF_TX
] = 
tx_kex
;

1991 
ötf
 = 0; i¡‡< 
hw
->
≈c_ötfs
; intf++) {

1992 i‡(
	`is_≈c_ötf_tx
(
ötf
))

1996 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_KEX_CFG
(
ötf
),

1997 
rx_kex
);

2003 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2004 
	`NPC_AF_INTFX_MISS_ACT
(
ötf
), 
NIX_RX_ACTIONOP_DROP
);

2009 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2010 
	`NPC_AF_INTFX_MISS_STAT_ACT
(
ötf
),

2011 ((
mˇm
->
rx_miss_a˘_˙å
 >> 9) << 12) |

2012 
hw
->
≈c_°©_ía
 | 
mˇm
->
rx_miss_a˘_˙å
);

2016 
ötf
 = 0; i¡‡< 
hw
->
≈c_ötfs
; intf++) {

2017 i‡(
	`is_≈c_ötf_rx
(
ötf
))

2021 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_KEX_CFG
(
ötf
),

2022 
tx_kex
);

2027 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2028 
	`NPC_AF_INTFX_MISS_ACT
(
ötf
),

2029 
NIX_TX_ACTIONOP_UCAST_DEFAULT
);

2031 
	}
}

2033 
	$rvu_≈c_öô
(
rvu
 *rvu)

2035 
≈c_kpu_¥ofûe_ad≠ãr
 *
kpu
 = &
rvu
->kpu;

2036 
≈c_pköd
 *
pköd
 = &
rvu
->
hw
->pkind;

2037 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2038 
blkaddr
, 
íåy
, 
b™k
, 
îr
;

2040 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2041 i‡(
blkaddr
 < 0) {

2042 
	`dev_îr
(
rvu
->
dev
, "%s: NPC blockÇŸ im∂emíãd\n", 
__func__
);

2043  -
ENODEV
;

2046 
	`rvu_≈c_hw_öô
(
rvu
, 
blkaddr
);

2049 
b™k
 = 0; b™k < 
mˇm
->
b™ks
; bank++) {

2050 
íåy
 = 0;É¡ry < 
mˇm
->
b™ksize
;Éntry++)

2051 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2052 
	`NPC_AF_MCAMEX_BANKX_CFG
(
íåy
, 
b™k
), 0);

2055 
îr
 = 
	`rvu_Æloc_bôm≠
(&
pköd
->
r§c
);

2056 i‡(
îr
)

2057  
îr
;

2061 
	`rvu_Æloc_r§c
(&
pköd
->
r§c
);

2064 
pköd
->
pfch™_m≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
,Ököd->
r§c
.
max
,

2065 (
u32
), 
GFP_KERNEL
);

2066 i‡(!
pköd
->
pfch™_m≠
)

2067  -
ENOMEM
;

2070 
	`≈c_∑r£r_¥ofûe_öô
(
rvu
, 
blkaddr
);

2073 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPC_AF_PCK_DEF_OL2
,

2074 (
kpu
->
…_def
->
pck_ﬁ2
.
lid
 << 8Ë| (kpu->…_def->pck_ﬁ2.
…y≥_m©ch
 << 4) |

2075 
kpu
->
…_def
->
pck_ﬁ2
.
…y≥_mask
);

2076 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPC_AF_PCK_DEF_OIP4
,

2077 (
kpu
->
…_def
->
pck_où4
.
lid
 << 8Ë| (kpu->…_def->pck_où4.
…y≥_m©ch
 << 4) |

2078 
kpu
->
…_def
->
pck_où4
.
…y≥_mask
);

2081 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPC_AF_PCK_DEF_IIP4
,

2082 (
kpu
->
…_def
->
pck_iù4
.
lid
 << 8Ë| (kpu->…_def->pck_iù4.
…y≥_m©ch
 << 4) |

2083 
kpu
->
…_def
->
pck_iù4
.
…y≥_mask
);

2092 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
NPC_AF_PCK_CFG
,

2093 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPC_AF_PCK_CFG
) |

2094 ((
u64
)
NPC_EC_OIP4_CSUM
 << 32Ë| (
NPC_EC_IIP4_CSUM
 << 24) |

2095 
	`BIT_ULL
(7) | BIT_ULL(6) | BIT_ULL(2) | BIT_ULL(1));

2097 
	`rvu_≈c_£tup_öãrÁ˚s
(
rvu
, 
blkaddr
);

2099 
	`≈c_c⁄fig_£¸ë_key
(
rvu
, 
blkaddr
);

2101 
	`≈c_lﬂd_mkex_¥ofûe
(
rvu
, 
blkaddr
,Ñvu->
mkex_pÊ_«me
);

2103 
îr
 = 
	`≈c_mˇm_r§cs_öô
(
rvu
, 
blkaddr
);

2104 i‡(
îr
)

2105  
îr
;

2107 
îr
 = 
	`≈c_Êow_°ìrög_öô
(
rvu
, 
blkaddr
);

2108 i‡(
îr
) {

2109 
	`dev_îr
(
rvu
->
dev
,

2111 
	`≈c_lﬂd_mkex_¥ofûe
(
rvu
, 
blkaddr
, 
def_pÊ_«me
);

2115 
	}
}

2117 
	$rvu_≈c_‰ìmem
(
rvu
 *rvu)

2119 
≈c_pköd
 *
pköd
 = &
rvu
->
hw
->pkind;

2120 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2122 
	`k‰ì
(
pköd
->
r§c
.
bm≠
);

2123 
	`k‰ì
(
mˇm
->
cou¡îs
.
bm≠
);

2124 i‡(
rvu
->
kpu_¥Ê_addr
)

2125 
	`iounm≠
(
rvu
->
kpu_¥Ê_addr
);

2127 
	`k‰ì
(
rvu
->
kpu_fwd©a
);

2128 
	`muãx_de°roy
(&
mˇm
->
lock
);

2129 
	}
}

2131 
	$rvu_≈c_gë_mˇm_íåy_Æloc_öfo
(
rvu
 *rvu, 
u16
 
pcifunc
,

2132 
blkaddr
, *
Æloc_˙t
,

2133 *
íabÀ_˙t
)

2135 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2136 
íåy
;

2138 *
Æloc_˙t
 = 0;

2139 *
íabÀ_˙t
 = 0;

2141 
íåy
 = 0;É¡ry < 
mˇm
->
bm≠_íåõs
;Éntry++) {

2142 i‡(
mˇm
->
íåy2pfvf_m≠
[
íåy
] =
pcifunc
) {

2143 (*
Æloc_˙t
)++;

2144 i‡(
	`is_mˇm_íåy_íabÀd
(
rvu
, 
mˇm
, 
blkaddr
, 
íåy
))

2145 (*
íabÀ_˙t
)++;

2148 
	}
}

2150 
	$rvu_≈c_gë_mˇm_cou¡î_Æloc_öfo
(
rvu
 *rvu, 
u16
 
pcifunc
,

2151 
blkaddr
, *
Æloc_˙t
,

2152 *
íabÀ_˙t
)

2154 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2155 
˙å
;

2157 *
Æloc_˙t
 = 0;

2158 *
íabÀ_˙t
 = 0;

2160 
˙å
 = 0; c¡∏< 
mˇm
->
cou¡îs
.
max
; cntr++) {

2161 i‡(
mˇm
->
˙å2pfvf_m≠
[
˙å
] =
pcifunc
) {

2162 (*
Æloc_˙t
)++;

2163 i‡(
mˇm
->
˙å_ªf˙t
[
˙å
])

2164 (*
íabÀ_˙t
)++;

2167 
	}
}

2169 
	$≈c_mˇm_vîify_íåy
(
≈c_mˇm
 *
mˇm
,

2170 
u16
 
pcifunc
, 
íåy
)

2173 i‡(
	`is_pffunc_af
(
pcifunc
))

2178 i‡(
íåy
 >
mˇm
->
bm≠_íåõs
)

2179  
NPC_MCAM_INVALID_REQ
;

2181 i‡(
pcifunc
 !
mˇm
->
íåy2pfvf_m≠
[
íåy
])

2182  
NPC_MCAM_PERM_DENIED
;

2185 
	}
}

2187 
	$≈c_mˇm_vîify_cou¡î
(
≈c_mˇm
 *
mˇm
,

2188 
u16
 
pcifunc
, 
˙å
)

2193 i‡(
˙å
 >
mˇm
->
cou¡îs
.
max
)

2194  
NPC_MCAM_INVALID_REQ
;

2196 i‡(
pcifunc
 !
mˇm
->
˙å2pfvf_m≠
[
˙å
])

2197  
NPC_MCAM_PERM_DENIED
;

2200 
	}
}

2202 
	$≈c_m≠_mˇm_íåy_™d_˙å
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

2203 
blkaddr
, 
u16
 
íåy
, u16 
˙å
)

2205 
u16
 
ödex
 = 
íåy
 & (
mˇm
->
b™ksize
 - 1);

2206 
u32
 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
íåy
);

2207 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

2210 
mˇm
->
íåy2˙å_m≠
[
íåy
] = 
˙å
;

2211 
mˇm
->
˙å_ªf˙t
[
˙å
]++;

2213 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2214 
	`NPC_AF_MCAMEX_BANKX_STAT_ACT
(
ödex
, 
b™k
),

2215 ((
˙å
 >> 9Ë<< 12Ë| 
hw
->
≈c_°©_ía
 | cntr);

2216 
	}
}

2218 
	$≈c_unm≠_mˇm_íåy_™d_˙å
(
rvu
 *rvu,

2219 
≈c_mˇm
 *
mˇm
,

2220 
blkaddr
, 
u16
 
íåy
, u16 
˙å
)

2222 
u16
 
ödex
 = 
íåy
 & (
mˇm
->
b™ksize
 - 1);

2223 
u32
 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
íåy
);

2226 
mˇm
->
íåy2˙å_m≠
[
íåy
] = 
NPC_MCAM_INVALID_MAP
;

2227 
mˇm
->
˙å_ªf˙t
[
˙å
]--;

2229 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

2230 
	`NPC_AF_MCAMEX_BANKX_STAT_ACT
(
ödex
, 
b™k
), 0x00);

2231 
	}
}

2237 
	$≈c_mˇm_£t_bô
(
≈c_mˇm
 *
mˇm
, 
u16
 
ödex
)

2239 
u16
 
íåy
, 
ª¡ry
;

2241 
íåy
 = 
ödex
;

2242 
ª¡ry
 = 
mˇm
->
bm≠_íåõs
 - 
ödex
 - 1;

2244 
	`__£t_bô
(
íåy
, 
mˇm
->
bm≠
);

2245 
	`__£t_bô
(
ª¡ry
, 
mˇm
->
bm≠_ªvî£
);

2246 
mˇm
->
bm≠_f˙t
--;

2247 
	}
}

2253 
	$≈c_mˇm_˛ór_bô
(
≈c_mˇm
 *
mˇm
, 
u16
 
ödex
)

2255 
u16
 
íåy
, 
ª¡ry
;

2257 
íåy
 = 
ödex
;

2258 
ª¡ry
 = 
mˇm
->
bm≠_íåõs
 - 
ödex
 - 1;

2260 
	`__˛ór_bô
(
íåy
, 
mˇm
->
bm≠
);

2261 
	`__˛ór_bô
(
ª¡ry
, 
mˇm
->
bm≠_ªvî£
);

2262 
mˇm
->
bm≠_f˙t
++;

2263 
	}
}

2265 
	$≈c_mˇm_‰ì_Æl_íåõs
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

2266 
blkaddr
, 
u16
 
pcifunc
)

2268 
u16
 
ödex
, 
˙å
;

2271 
ödex
 = 0; index < 
mˇm
->
bm≠_íåõs
; index++) {

2272 i‡(
mˇm
->
íåy2pfvf_m≠
[
ödex
] =
pcifunc
) {

2273 
mˇm
->
íåy2pfvf_m≠
[
ödex
] = 
NPC_MCAM_INVALID_MAP
;

2275 
	`≈c_mˇm_˛ór_bô
(
mˇm
, 
ödex
);

2277 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
, 
Ál£
);

2280 
˙å
 = 
mˇm
->
íåy2˙å_m≠
[
ödex
];

2281 i‡(
˙å
 !
NPC_MCAM_INVALID_MAP
)

2282 
	`≈c_unm≠_mˇm_íåy_™d_˙å
(
rvu
, 
mˇm
,

2283 
blkaddr
, 
ödex
,

2284 
˙å
);

2285 
mˇm
->
íåy2èrgë_pffunc
[
ödex
] = 0x0;

2288 
	}
}

2290 
	$≈c_mˇm_‰ì_Æl_cou¡îs
(
rvu
 *rvu, 
≈c_mˇm
 *
mˇm
,

2291 
u16
 
pcifunc
)

2293 
u16
 
˙å
;

2296 
˙å
 = 0; c¡∏< 
mˇm
->
cou¡îs
.
max
; cntr++) {

2297 i‡(
mˇm
->
˙å2pfvf_m≠
[
˙å
] =
pcifunc
) {

2298 
mˇm
->
˙å2pfvf_m≠
[
˙å
] = 
NPC_MCAM_INVALID_MAP
;

2299 
mˇm
->
˙å_ªf˙t
[
˙å
] = 0;

2300 
	`rvu_‰ì_r§c
(&
mˇm
->
cou¡îs
, 
˙å
);

2308 
	}
}

2313 
u16
 
	$≈c_mˇm_föd_zîo_¨ó
(*
m≠
, 
u16
 
size
, u16 
°¨t
,

2314 
u16
 
ƒ
, u16 *
max_¨ó
)

2316 
u16
 
max_¨ó_°¨t
 = 0;

2317 
u16
 
ödex
, 
√xt
, 
íd
;

2319 *
max_¨ó
 = 0;

2321 
agaö
:

2322 
ödex
 = 
	`föd_√xt_zîo_bô
(
m≠
, 
size
, 
°¨t
);

2323 i‡(
ödex
 >
size
)

2324  
max_¨ó_°¨t
;

2326 
íd
 = ((
ödex
 + 
ƒ
Ë>
size
) ? size : index +Çr;

2327 
√xt
 = 
	`föd_√xt_bô
(
m≠
, 
íd
, 
ödex
);

2328 i‡(*
max_¨ó
 < (
√xt
 - 
ödex
)) {

2329 *
max_¨ó
 = 
√xt
 - 
ödex
;

2330 
max_¨ó_°¨t
 = 
ödex
;

2333 i‡(
√xt
 < 
íd
) {

2334 
°¨t
 = 
√xt
 + 1;

2335 
agaö
;

2338  
max_¨ó_°¨t
;

2339 
	}
}

2344 
u16
 
	$≈c_mˇm_gë_‰ì_cou¡
(*
m≠
, 
u16
 
°¨t
, u16 
íd
)

2346 
u16
 
ödex
, 
√xt
;

2347 
u16
 
f˙t
 = 0;

2349 
agaö
:

2350 i‡(
°¨t
 >
íd
)

2351  
f˙t
;

2353 
ödex
 = 
	`föd_√xt_zîo_bô
(
m≠
, 
íd
, 
°¨t
);

2354 i‡(
ödex
 >
íd
)

2355  
f˙t
;

2357 
√xt
 = 
	`föd_√xt_bô
(
m≠
, 
íd
, 
ödex
);

2358 i‡(
√xt
 <
íd
) {

2359 
f˙t
 +
√xt
 - 
ödex
;

2360 
°¨t
 = 
√xt
 + 1;

2361 
agaö
;

2364 
f˙t
 +
íd
 - 
ödex
;

2365  
f˙t
;

2366 
	}
}

2369 
	$≈c_gë_mˇm_£¨ch_ønge_¥i‹ôy
(
≈c_mˇm
 *
mˇm
,

2370 
≈c_mˇm_Æloc_íåy_ªq
 *
ªq
,

2371 
u16
 *
°¨t
, u16 *
íd
, 
boﬁ
 *
ªvî£
)

2373 
u16
 
f˙t
;

2375 i‡(
ªq
->
¥i‹ôy
 =
NPC_MCAM_HIGHER_PRIO
)

2376 
h¥io
;

2388 *
ªvî£
 = 
Ál£
;

2389 *
°¨t
 = 
ªq
->
ªf_íåy
 + 1;

2390 *
íd
 = 
mˇm
->
bm≠_íåõs
;

2392 i‡(
ªq
->
ªf_íåy
 >
mˇm
->
h¥io_íd
)

2395 
f˙t
 = 
	`≈c_mˇm_gë_‰ì_cou¡
(
mˇm
->
bm≠
,

2396 
mˇm
->
h¥io_íd
, mˇm->
bm≠_íåõs
);

2397 i‡(
f˙t
 > 
ªq
->
cou¡
)

2398 *
°¨t
 = 
mˇm
->
h¥io_íd
;

2400 *
ªvî£
 = 
åue
;

2403 
h¥io
:

2413 *
ªvî£
 = 
åue
;

2414 *
°¨t
 = 0;

2415 *
íd
 = 
ªq
->
ªf_íåy
;

2417 i‡(
ªq
->
ªf_íåy
 <
mˇm
->
Õrio_°¨t
)

2420 
f˙t
 = 
	`≈c_mˇm_gë_‰ì_cou¡
(
mˇm
->
bm≠
,

2421 
mˇm
->
h¥io_íd
, mˇm->
Õrio_°¨t
);

2422 i‡(
f˙t
 < 
ªq
->
cou¡
)

2424 *
°¨t
 = 
mˇm
->
h¥io_íd
;

2425 *
íd
 = 
mˇm
->
Õrio_°¨t
;

2426 
	}
}

2428 
	$≈c_mˇm_Æloc_íåõs
(
≈c_mˇm
 *
mˇm
, 
u16
 
pcifunc
,

2429 
≈c_mˇm_Æloc_íåy_ªq
 *
ªq
,

2430 
≈c_mˇm_Æloc_íåy_r•
 *
r•
)

2432 
u16
 
íåy_li°
[
NPC_MAX_NONCONTIG_ENTRIES
];

2433 
u16
 
f˙t
, 
hp_f˙t
, 
Õ_f˙t
;

2434 
u16
 
°¨t
, 
íd
, 
ödex
;

2435 
íåy
, 
√xt_°¨t
;

2436 
boﬁ
 
ªvî£
 = 
Ál£
;

2437 *
bm≠
;

2438 
u16
 
max_c⁄tig
;

2440 
	`muãx_lock
(&
mˇm
->
lock
);

2443 i‡(!
mˇm
->
bm≠_f˙t
) {

2444 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2445  
NPC_MCAM_ALLOC_FAILED
;

2465 i‡(
ªq
->
¥i‹ôy
) {

2466 
	`≈c_gë_mˇm_£¨ch_ønge_¥i‹ôy
(
mˇm
, 
ªq
,

2467 &
°¨t
, &
íd
, &
ªvî£
);

2468 
Æloc
;

2479 i‡(!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
))

2480 
Õrio_Æloc
;

2486 
Õ_f˙t
 = 
	`≈c_mˇm_gë_‰ì_cou¡
(
mˇm
->
bm≠
,

2487 
mˇm
->
Õrio_°¨t
,

2488 
mˇm
->
bm≠_íåõs
);

2489 
hp_f˙t
 = 
	`≈c_mˇm_gë_‰ì_cou¡
(
mˇm
->
bm≠
, 0, mˇm->
h¥io_íd
);

2490 
f˙t
 = 
mˇm
->
bm≠_f˙t
 - 
Õ_f˙t
 - 
hp_f˙t
;

2493 i‡(
f˙t
 > 
ªq
->
cou¡
) {

2494 
°¨t
 = 
mˇm
->
h¥io_íd
;

2495 
íd
 = 
mˇm
->
Õrio_°¨t
;

2496 } i‡((
f˙t
 + (
hp_f˙t
 / 2Ë+ (
Õ_f˙t
 / 2)Ë> 
ªq
->
cou¡
) {

2500 
°¨t
 = 
mˇm
->
h¥io_íd
 / 2;

2501 
íd
 = 
mˇm
->
bm≠_íåõs
 - (mˇm->
Õrio_cou¡
 / 2);

2502 
ªvî£
 = 
åue
;

2507 
Õrio_Æloc
:

2508 
ªvî£
 = 
åue
;

2509 
°¨t
 = 0;

2510 
íd
 = 
mˇm
->
bm≠_íåõs
;

2513 
Æloc
:

2514 i‡(
ªvî£
) {

2515 
bm≠
 = 
mˇm
->
bm≠_ªvî£
;

2516 
°¨t
 = 
mˇm
->
bm≠_íåõs
 - start;

2517 
íd
 = 
mˇm
->
bm≠_íåõs
 -Énd;

2518 
ödex
 = 
°¨t
;

2519 
°¨t
 = 
íd
;

2520 
íd
 = 
ödex
;

2522 
bm≠
 = 
mˇm
->bmap;

2525 i‡(
ªq
->
c⁄tig
) {

2529 
ödex
 = 
	`≈c_mˇm_föd_zîo_¨ó
(
bm≠
, 
íd
, 
°¨t
,

2530 
ªq
->
cou¡
, &
max_c⁄tig
);

2531 
r•
->
cou¡
 = 
max_c⁄tig
;

2532 i‡(
ªvî£
)

2533 
r•
->
íåy
 = 
mˇm
->
bm≠_íåõs
 - 
ödex
 - 
max_c⁄tig
;

2535 
r•
->
íåy
 = 
ödex
;

2540 
r•
->
cou¡
 = 0;

2541 
√xt_°¨t
 = 
°¨t
;

2542 
íåy
 = 0;É¡ry < 
ªq
->
cou¡
;Éntry++) {

2543 
ödex
 = 
	`föd_√xt_zîo_bô
(
bm≠
, 
íd
, 
√xt_°¨t
);

2544 i‡(
ödex
 >
íd
)

2547 
√xt_°¨t
 = 
°¨t
 + (
ödex
 - start) + 1;

2550 i‡(
ªvî£
)

2551 
ödex
 = 
mˇm
->
bm≠_íåõs
 - index - 1;

2552 
íåy_li°
[
íåy
] = 
ödex
;

2553 
r•
->
cou¡
++;

2560 i‡(!
ªq
->
¥i‹ôy
 && (
r•
->
cou¡
 <Ñeq->count) &&

2561 ((
íd
 - 
°¨t
Ë!
mˇm
->
bm≠_íåõs
)) {

2562 
ªvî£
 = 
åue
;

2563 
°¨t
 = 0;

2564 
íd
 = 
mˇm
->
bm≠_íåõs
;

2565 
Æloc
;

2571 i‡(
ªq
->
¥i‹ôy
 && 
r•
->
cou¡
 <Ñeq->count) {

2572 i‡(
ªq
->
¥i‹ôy
 =
NPC_MCAM_LOWER_PRIO
 &&

2573 (
°¨t
 !(
ªq
->
ªf_íåy
 + 1))) {

2574 
°¨t
 = 
ªq
->
ªf_íåy
 + 1;

2575 
íd
 = 
mˇm
->
bm≠_íåõs
;

2576 
ªvî£
 = 
Ál£
;

2577 
Æloc
;

2578 } i‡((
ªq
->
¥i‹ôy
 =
NPC_MCAM_HIGHER_PRIO
) &&

2579 ((
íd
 - 
°¨t
Ë!
ªq
->
ªf_íåy
)) {

2580 
°¨t
 = 0;

2581 
íd
 = 
ªq
->
ªf_íåy
;

2582 
ªvî£
 = 
åue
;

2583 
Æloc
;

2591 i‡(!
ªq
->
c⁄tig
 && 
r•
->
cou¡
) {

2592 
ödex
 = 0;

2593 
íåy
 = 
r•
->
cou¡
 - 1;Éntry >= 0;Éntry--) {

2594 i‡(
ªvî£
)

2595 
r•
->
íåy_li°
[
ödex
++] =É¡ry_li°[
íåy
];

2597 
r•
->
íåy_li°
[
íåy
] =Éntry_list[entry];

2602 
íåy
 = 0;É¡ry < 
r•
->
cou¡
;Éntry++) {

2603 
ödex
 = 
ªq
->
c⁄tig
 ?

2604 (
r•
->
íåy
 +É¡ryË:Ñ•->
íåy_li°
[entry];

2605 
	`≈c_mˇm_£t_bô
(
mˇm
, 
ödex
);

2606 
mˇm
->
íåy2pfvf_m≠
[
ödex
] = 
pcifunc
;

2607 
mˇm
->
íåy2˙å_m≠
[
ödex
] = 
NPC_MCAM_INVALID_MAP
;

2611 
r•
->
‰ì_cou¡
 = 
mˇm
->
bm≠_f˙t
;

2613 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2615 
	}
}

2618 
	$≈c_mˇm_r§cs_ª£rve
(
rvu
 *rvu, 
blkaddr
, 
íåy_idx
)

2620 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2622 
	`≈c_mˇm_£t_bô
(
mˇm
, 
íåy_idx
);

2623 
	}
}

2625 
	$rvu_mbox_h™dÀr_≈c_mˇm_Æloc_íåy
(
rvu
 *rvu,

2626 
≈c_mˇm_Æloc_íåy_ªq
 *
ªq
,

2627 
≈c_mˇm_Æloc_íåy_r•
 *
r•
)

2629 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2630 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2631 
blkaddr
;

2633 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2634 i‡(
blkaddr
 < 0)

2635  
NPC_MCAM_INVALID_REQ
;

2637 
r•
->
íåy
 = 
NPC_MCAM_ENTRY_INVALID
;

2638 
r•
->
‰ì_cou¡
 = 0;

2641 i‡(
ªq
->
¥i‹ôy
 &&Ñeq->
ªf_íåy
 >
mˇm
->
bm≠_íåõs
) {

2642 
	`dev_îr
(
rvu
->
dev
, "%s:ÑeferenceÉntry %d is out ofÑange\n",

2643 
__func__
, 
ªq
->
ªf_íåy
);

2644  
NPC_MCAM_INVALID_REQ
;

2650 i‡((!
ªq
->
ªf_íåy
 &&Ñeq->
¥i‹ôy
 =
NPC_MCAM_HIGHER_PRIO
) ||

2651 ((
ªq
->
ªf_íåy
 =(
mˇm
->
bm≠_íåõs
 - 1)) &&

2652 
ªq
->
¥i‹ôy
 =
NPC_MCAM_LOWER_PRIO
))

2653  
NPC_MCAM_INVALID_REQ
;

2658 i‡(!
ªq
->
c⁄tig
 &&Ñeq->
cou¡
 > 
NPC_MAX_NONCONTIG_ENTRIES
) {

2659 
	`dev_îr
(
rvu
->
dev
,

2661 
__func__
, 
ªq
->
cou¡
, 
NPC_MAX_NONCONTIG_ENTRIES
);

2662  
NPC_MCAM_INVALID_REQ
;

2666 i‡(!
	`is_pffunc_af
(
pcifunc
Ë&& !
	`is_nixlf_©èched
(
rvu
,Öcifunc))

2667  
NPC_MCAM_ALLOC_DENIED
;

2669  
	`≈c_mˇm_Æloc_íåõs
(
mˇm
, 
pcifunc
, 
ªq
, 
r•
);

2670 
	}
}

2672 
	$rvu_mbox_h™dÀr_≈c_mˇm_‰ì_íåy
(
rvu
 *rvu,

2673 
≈c_mˇm_‰ì_íåy_ªq
 *
ªq
,

2674 
msg_r•
 *
r•
)

2676 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2677 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2678 
blkaddr
, 
rc
 = 0;

2679 
u16
 
˙å
;

2681 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2682 i‡(
blkaddr
 < 0)

2683  
NPC_MCAM_INVALID_REQ
;

2686 i‡(!
	`is_pffunc_af
(
pcifunc
Ë&& !
	`is_nixlf_©èched
(
rvu
,Öcifunc))

2687  
NPC_MCAM_INVALID_REQ
;

2689 
	`muãx_lock
(&
mˇm
->
lock
);

2691 i‡(
ªq
->
Æl
)

2692 
‰ì_Æl
;

2694 
rc
 = 
	`≈c_mˇm_vîify_íåy
(
mˇm
, 
pcifunc
, 
ªq
->
íåy
);

2695 i‡(
rc
)

2696 
exô
;

2698 
mˇm
->
íåy2pfvf_m≠
[
ªq
->
íåy
] = 
NPC_MCAM_INVALID_MAP
;

2699 
mˇm
->
íåy2èrgë_pffunc
[
ªq
->
íåy
] = 0x0;

2700 
	`≈c_mˇm_˛ór_bô
(
mˇm
, 
ªq
->
íåy
);

2701 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ªq
->
íåy
, 
Ál£
);

2704 
˙å
 = 
mˇm
->
íåy2˙å_m≠
[
ªq
->
íåy
];

2705 i‡(
˙å
 !
NPC_MCAM_INVALID_MAP
)

2706 
	`≈c_unm≠_mˇm_íåy_™d_˙å
(
rvu
, 
mˇm
, 
blkaddr
,

2707 
ªq
->
íåy
, 
˙å
);

2709 
exô
;

2711 
‰ì_Æl
:

2713 
	`≈c_mˇm_‰ì_Æl_íåõs
(
rvu
, 
mˇm
, 
blkaddr
, 
pcifunc
);

2714 
exô
:

2715 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2716  
rc
;

2717 
	}
}

2719 
	$rvu_mbox_h™dÀr_≈c_mˇm_ªad_íåy
(
rvu
 *rvu,

2720 
≈c_mˇm_ªad_íåy_ªq
 *
ªq
,

2721 
≈c_mˇm_ªad_íåy_r•
 *
r•
)

2723 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2724 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2725 
blkaddr
, 
rc
;

2727 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2728 i‡(
blkaddr
 < 0)

2729  
NPC_MCAM_INVALID_REQ
;

2731 
	`muãx_lock
(&
mˇm
->
lock
);

2732 
rc
 = 
	`≈c_mˇm_vîify_íåy
(
mˇm
, 
pcifunc
, 
ªq
->
íåy
);

2733 i‡(!
rc
) {

2734 
	`≈c_ªad_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ªq
->
íåy
,

2735 &
r•
->
íåy_d©a
,

2736 &
r•
->
ötf
, &r•->
íabÀ
);

2739 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2740  
rc
;

2741 
	}
}

2743 
	$rvu_mbox_h™dÀr_≈c_mˇm_wrôe_íåy
(
rvu
 *rvu,

2744 
≈c_mˇm_wrôe_íåy_ªq
 *
ªq
,

2745 
msg_r•
 *
r•
)

2747 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

2748 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2749 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2750 
blkaddr
, 
rc
;

2751 
u8
 
nix_ötf
;

2753 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2754 i‡(
blkaddr
 < 0)

2755  
NPC_MCAM_INVALID_REQ
;

2757 
	`muãx_lock
(&
mˇm
->
lock
);

2758 
rc
 = 
	`≈c_mˇm_vîify_íåy
(
mˇm
, 
pcifunc
, 
ªq
->
íåy
);

2759 i‡(
rc
)

2760 
exô
;

2762 i‡(
ªq
->
£t_˙å
 &&

2763 
	`≈c_mˇm_vîify_cou¡î
(
mˇm
, 
pcifunc
, 
ªq
->
˙å
)) {

2764 
rc
 = 
NPC_MCAM_INVALID_REQ
;

2765 
exô
;

2768 i‡(!
	`is_≈c_öãrÁ˚_vÆid
(
rvu
, 
ªq
->
ötf
)) {

2769 
rc
 = 
NPC_MCAM_INVALID_REQ
;

2770 
exô
;

2773 i‡(
	`is_≈c_ötf_tx
(
ªq
->
ötf
))

2774 
nix_ötf
 = 
pfvf
->
nix_tx_ötf
;

2776 
nix_ötf
 = 
pfvf
->
nix_rx_ötf
;

2778 i‡(!
	`is_pffunc_af
(
pcifunc
) &&

2779 
	`≈c_mˇm_vîify_pf_func
(
rvu
, &
ªq
->
íåy_d©a
,Ñeq->
ötf
, 
pcifunc
)) {

2780 
rc
 = 
NPC_MCAM_INVALID_REQ
;

2781 
exô
;

2785 i‡(
	`is_pffunc_af
(
ªq
->
hdr
.
pcifunc
))

2786 
nix_ötf
 = 
ªq
->
ötf
;

2788 
	`≈c_c⁄fig_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ªq
->
íåy
, 
nix_ötf
,

2789 &
ªq
->
íåy_d©a
,Ñeq->
íabÀ_íåy
);

2791 i‡(
ªq
->
£t_˙å
)

2792 
	`≈c_m≠_mˇm_íåy_™d_˙å
(
rvu
, 
mˇm
, 
blkaddr
,

2793 
ªq
->
íåy
,Ñeq->
˙å
);

2795 
rc
 = 0;

2796 
exô
:

2797 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2798  
rc
;

2799 
	}
}

2801 
	$rvu_mbox_h™dÀr_≈c_mˇm_ía_íåy
(
rvu
 *rvu,

2802 
≈c_mˇm_ía_dis_íåy_ªq
 *
ªq
,

2803 
msg_r•
 *
r•
)

2805 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2806 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2807 
blkaddr
, 
rc
;

2809 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2810 i‡(
blkaddr
 < 0)

2811  
NPC_MCAM_INVALID_REQ
;

2813 
	`muãx_lock
(&
mˇm
->
lock
);

2814 
rc
 = 
	`≈c_mˇm_vîify_íåy
(
mˇm
, 
pcifunc
, 
ªq
->
íåy
);

2815 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2816 i‡(
rc
)

2817  
rc
;

2819 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ªq
->
íåy
, 
åue
);

2822 
	}
}

2824 
	$rvu_mbox_h™dÀr_≈c_mˇm_dis_íåy
(
rvu
 *rvu,

2825 
≈c_mˇm_ía_dis_íåy_ªq
 *
ªq
,

2826 
msg_r•
 *
r•
)

2828 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2829 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2830 
blkaddr
, 
rc
;

2832 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2833 i‡(
blkaddr
 < 0)

2834  
NPC_MCAM_INVALID_REQ
;

2836 
	`muãx_lock
(&
mˇm
->
lock
);

2837 
rc
 = 
	`≈c_mˇm_vîify_íåy
(
mˇm
, 
pcifunc
, 
ªq
->
íåy
);

2838 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2839 i‡(
rc
)

2840  
rc
;

2842 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ªq
->
íåy
, 
Ál£
);

2845 
	}
}

2847 
	$rvu_mbox_h™dÀr_≈c_mˇm_shi·_íåy
(
rvu
 *rvu,

2848 
≈c_mˇm_shi·_íåy_ªq
 *
ªq
,

2849 
≈c_mˇm_shi·_íåy_r•
 *
r•
)

2851 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2852 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2853 
u16
 
ﬁd_íåy
, 
√w_íåy
;

2854 
blkaddr
, 
rc
 = 0;

2855 
u16
 
ödex
, 
˙å
;

2857 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2858 i‡(
blkaddr
 < 0)

2859  
NPC_MCAM_INVALID_REQ
;

2861 i‡(
ªq
->
shi·_cou¡
 > 
NPC_MCAM_MAX_SHIFTS
)

2862  
NPC_MCAM_INVALID_REQ
;

2864 
	`muãx_lock
(&
mˇm
->
lock
);

2865 
ödex
 = 0; index < 
ªq
->
shi·_cou¡
; index++) {

2866 
ﬁd_íåy
 = 
ªq
->
cuº_íåy
[
ödex
];

2867 
√w_íåy
 = 
ªq
->√w_íåy[
ödex
];

2872 
rc
 = 
	`≈c_mˇm_vîify_íåy
(
mˇm
, 
pcifunc
, 
ﬁd_íåy
);

2873 i‡(
rc
)

2876 
rc
 = 
	`≈c_mˇm_vîify_íåy
(
mˇm
, 
pcifunc
, 
√w_íåy
);

2877 i‡(
rc
)

2881 i‡(
mˇm
->
íåy2˙å_m≠
[
√w_íåy
] !
NPC_MCAM_INVALID_MAP
) {

2882 
rc
 = 
NPC_MCAM_PERM_DENIED
;

2887 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
√w_íåy
, 
Ál£
);

2890 
	`≈c_c›y_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ﬁd_íåy
, 
√w_íåy
);

2893 
˙å
 = 
mˇm
->
íåy2˙å_m≠
[
ﬁd_íåy
];

2894 i‡(
˙å
 !
NPC_MCAM_INVALID_MAP
) {

2895 
	`≈c_unm≠_mˇm_íåy_™d_˙å
(
rvu
, 
mˇm
, 
blkaddr
,

2896 
ﬁd_íåy
, 
˙å
);

2897 
	`≈c_m≠_mˇm_íåy_™d_˙å
(
rvu
, 
mˇm
, 
blkaddr
,

2898 
√w_íåy
, 
˙å
);

2902 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
√w_íåy
, 
åue
);

2903 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ﬁd_íåy
, 
Ál£
);

2907 i‡(
ödex
 !
ªq
->
shi·_cou¡
) {

2908 
rc
 = 
NPC_MCAM_PERM_DENIED
;

2909 
r•
->
Áûed_íåy_idx
 = 
ödex
;

2912 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2913  
rc
;

2914 
	}
}

2916 
	$rvu_mbox_h™dÀr_≈c_mˇm_Æloc_cou¡î
(
rvu
 *rvu,

2917 
≈c_mˇm_Æloc_cou¡î_ªq
 *
ªq
,

2918 
≈c_mˇm_Æloc_cou¡î_r•
 *
r•
)

2920 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2921 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

2922 
u16
 
max_c⁄tig
, 
˙å
;

2923 
blkaddr
, 
ödex
;

2925 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2926 i‡(
blkaddr
 < 0)

2927  
NPC_MCAM_INVALID_REQ
;

2930 i‡(!
	`is_pffunc_af
(
pcifunc
Ë&& !
	`is_nixlf_©èched
(
rvu
,Öcifunc))

2931  
NPC_MCAM_INVALID_REQ
;

2936 i‡(!
ªq
->
c⁄tig
 &&Ñeq->
cou¡
 > 
NPC_MAX_NONCONTIG_COUNTERS
)

2937  
NPC_MCAM_INVALID_REQ
;

2939 
	`muãx_lock
(&
mˇm
->
lock
);

2942 i‡(!
	`rvu_r§c_‰ì_cou¡
(&
mˇm
->
cou¡îs
)) {

2943 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2944  
NPC_MCAM_ALLOC_FAILED
;

2947 
r•
->
cou¡
 = 0;

2949 i‡(
ªq
->
c⁄tig
) {

2953 
ödex
 = 
	`≈c_mˇm_föd_zîo_¨ó
(
mˇm
->
cou¡îs
.
bm≠
,

2954 
mˇm
->
cou¡îs
.
max
, 0,

2955 
ªq
->
cou¡
, &
max_c⁄tig
);

2956 
r•
->
cou¡
 = 
max_c⁄tig
;

2957 
r•
->
˙å
 = 
ödex
;

2958 
˙å
 = 
ödex
; c¡∏< (ödex + 
max_c⁄tig
); cntr++) {

2959 
	`__£t_bô
(
˙å
, 
mˇm
->
cou¡îs
.
bm≠
);

2960 
mˇm
->
˙å2pfvf_m≠
[
˙å
] = 
pcifunc
;

2966 
˙å
 = 0; c¡∏< 
ªq
->
cou¡
; cntr++) {

2967 
ödex
 = 
	`rvu_Æloc_r§c
(&
mˇm
->
cou¡îs
);

2968 i‡(
ödex
 < 0)

2970 
r•
->
˙å_li°
[
˙å
] = 
ödex
;

2971 
r•
->
cou¡
++;

2972 
mˇm
->
˙å2pfvf_m≠
[
ödex
] = 
pcifunc
;

2976 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2978 
	}
}

2980 
	$rvu_mbox_h™dÀr_≈c_mˇm_‰ì_cou¡î
(
rvu
 *rvu,

2981 
≈c_mˇm_›î_cou¡î_ªq
 *
ªq
, 
msg_r•
 *
r•
)

2983 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

2984 
u16
 
ödex
, 
íåy
 = 0;

2985 
blkaddr
, 
îr
;

2987 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

2988 i‡(
blkaddr
 < 0)

2989  
NPC_MCAM_INVALID_REQ
;

2991 
	`muãx_lock
(&
mˇm
->
lock
);

2992 
îr
 = 
	`≈c_mˇm_vîify_cou¡î
(
mˇm
, 
ªq
->
hdr
.
pcifunc
,Ñeq->
˙å
);

2993 i‡(
îr
) {

2994 
	`muãx_u∆ock
(&
mˇm
->
lock
);

2995  
îr
;

2999 
mˇm
->
˙å2pfvf_m≠
[
ªq
->
˙å
] = 
NPC_MCAM_INVALID_MAP
;

3000 
	`rvu_‰ì_r§c
(&
mˇm
->
cou¡îs
, 
ªq
->
˙å
);

3003 
íåy
 < 
mˇm
->
bm≠_íåõs
) {

3004 i‡(!
mˇm
->
˙å_ªf˙t
[
ªq
->
˙å
])

3007 
ödex
 = 
	`föd_√xt_bô
(
mˇm
->
bm≠
, mˇm->
bm≠_íåõs
, 
íåy
);

3008 i‡(
ödex
 >
mˇm
->
bm≠_íåõs
)

3010 
íåy
 = 
ödex
 + 1;

3011 i‡(
mˇm
->
íåy2˙å_m≠
[
ödex
] !
ªq
->
˙å
)

3014 
	`≈c_unm≠_mˇm_íåy_™d_˙å
(
rvu
, 
mˇm
, 
blkaddr
,

3015 
ödex
, 
ªq
->
˙å
);

3018 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3020 
	}
}

3022 
	$rvu_mbox_h™dÀr_≈c_mˇm_unm≠_cou¡î
(
rvu
 *rvu,

3023 
≈c_mˇm_unm≠_cou¡î_ªq
 *
ªq
, 
msg_r•
 *
r•
)

3025 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

3026 
u16
 
ödex
, 
íåy
 = 0;

3027 
blkaddr
, 
rc
;

3029 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

3030 i‡(
blkaddr
 < 0)

3031  
NPC_MCAM_INVALID_REQ
;

3033 
	`muãx_lock
(&
mˇm
->
lock
);

3034 
rc
 = 
	`≈c_mˇm_vîify_cou¡î
(
mˇm
, 
ªq
->
hdr
.
pcifunc
,Ñeq->
˙å
);

3035 i‡(
rc
)

3036 
exô
;

3039 i‡(!
ªq
->
Æl
) {

3040 
rc
 = 
	`≈c_mˇm_vîify_íåy
(
mˇm
, 
ªq
->
hdr
.
pcifunc
,Ñeq->
íåy
);

3041 i‡(
rc
)

3042 
exô
;

3043 
	`≈c_unm≠_mˇm_íåy_™d_˙å
(
rvu
, 
mˇm
, 
blkaddr
,

3044 
ªq
->
íåy
,Ñeq->
˙å
);

3045 
exô
;

3049 
íåy
 < 
mˇm
->
bm≠_íåõs
) {

3050 i‡(!
mˇm
->
˙å_ªf˙t
[
ªq
->
˙å
])

3053 
ödex
 = 
	`föd_√xt_bô
(
mˇm
->
bm≠
, mˇm->
bm≠_íåõs
, 
íåy
);

3054 i‡(
ödex
 >
mˇm
->
bm≠_íåõs
)

3056 
íåy
 = 
ödex
 + 1;

3058 i‡(
mˇm
->
íåy2˙å_m≠
[
ödex
] !
ªq
->
˙å
)

3061 
	`≈c_unm≠_mˇm_íåy_™d_˙å
(
rvu
, 
mˇm
, 
blkaddr
,

3062 
ödex
, 
ªq
->
˙å
);

3064 
exô
:

3065 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3066  
rc
;

3067 
	}
}

3069 
	$rvu_mbox_h™dÀr_≈c_mˇm_˛ór_cou¡î
(
rvu
 *rvu,

3070 
≈c_mˇm_›î_cou¡î_ªq
 *
ªq
, 
msg_r•
 *
r•
)

3072 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

3073 
blkaddr
, 
îr
;

3075 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

3076 i‡(
blkaddr
 < 0)

3077  
NPC_MCAM_INVALID_REQ
;

3079 
	`muãx_lock
(&
mˇm
->
lock
);

3080 
îr
 = 
	`≈c_mˇm_vîify_cou¡î
(
mˇm
, 
ªq
->
hdr
.
pcifunc
,Ñeq->
˙å
);

3081 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3082 i‡(
îr
)

3083  
îr
;

3085 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_MATCH_STATX
(
ªq
->
˙å
), 0x00);

3088 
	}
}

3090 
	$rvu_mbox_h™dÀr_≈c_mˇm_cou¡î_°©s
(
rvu
 *rvu,

3091 
≈c_mˇm_›î_cou¡î_ªq
 *
ªq
,

3092 
≈c_mˇm_›î_cou¡î_r•
 *
r•
)

3094 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

3095 
blkaddr
, 
îr
;

3097 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

3098 i‡(
blkaddr
 < 0)

3099  
NPC_MCAM_INVALID_REQ
;

3101 
	`muãx_lock
(&
mˇm
->
lock
);

3102 
îr
 = 
	`≈c_mˇm_vîify_cou¡î
(
mˇm
, 
ªq
->
hdr
.
pcifunc
,Ñeq->
˙å
);

3103 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3104 i‡(
îr
)

3105  
îr
;

3107 
r•
->
°©
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_MATCH_STATX
(
ªq
->
˙å
));

3108 
r•
->
°©
 &
	`BIT_ULL
(48) - 1;

3111 
	}
}

3113 
	$rvu_mbox_h™dÀr_≈c_mˇm_Æloc_™d_wrôe_íåy
(
rvu
 *rvu,

3114 
≈c_mˇm_Æloc_™d_wrôe_íåy_ªq
 *
ªq
,

3115 
≈c_mˇm_Æloc_™d_wrôe_íåy_r•
 *
r•
)

3117 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

3118 
≈c_mˇm_Æloc_cou¡î_ªq
 
˙å_ªq
;

3119 
≈c_mˇm_Æloc_cou¡î_r•
 
˙å_r•
;

3120 
≈c_mˇm_Æloc_íåy_ªq
 
íåy_ªq
;

3121 
≈c_mˇm_Æloc_íåy_r•
 
íåy_r•
;

3122 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

3123 
u16
 
íåy
 = 
NPC_MCAM_ENTRY_INVALID
;

3124 
u16
 
˙å
 = 
NPC_MCAM_ENTRY_INVALID
;

3125 
blkaddr
, 
rc
;

3126 
u8
 
nix_ötf
;

3128 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

3129 i‡(
blkaddr
 < 0)

3130  
NPC_MCAM_INVALID_REQ
;

3132 i‡(!
	`is_≈c_öãrÁ˚_vÆid
(
rvu
, 
ªq
->
ötf
))

3133  
NPC_MCAM_INVALID_REQ
;

3135 i‡(
	`≈c_mˇm_vîify_pf_func
(
rvu
, &
ªq
->
íåy_d©a
,Ñeq->
ötf
,

3136 
ªq
->
hdr
.
pcifunc
))

3137  
NPC_MCAM_INVALID_REQ
;

3140 
íåy_ªq
.
hdr
.
pcifunc
 = 
ªq
->hdr.pcifunc;

3141 
íåy_ªq
.
c⁄tig
 = 
åue
;

3142 
íåy_ªq
.
¥i‹ôy
 = 
ªq
->priority;

3143 
íåy_ªq
.
ªf_íåy
 = 
ªq
->ref_entry;

3144 
íåy_ªq
.
cou¡
 = 1;

3146 
rc
 = 
	`rvu_mbox_h™dÀr_≈c_mˇm_Æloc_íåy
(
rvu
,

3147 &
íåy_ªq
, &
íåy_r•
);

3148 i‡(
rc
)

3149  
rc
;

3151 i‡(!
íåy_r•
.
cou¡
)

3152  
NPC_MCAM_ALLOC_FAILED
;

3154 
íåy
 = 
íåy_r•
.entry;

3156 i‡(!
ªq
->
Æloc_˙å
)

3157 
wrôe_íåy
;

3160 
˙å_ªq
.
hdr
.
pcifunc
 = 
ªq
->hdr.pcifunc;

3161 
˙å_ªq
.
c⁄tig
 = 
åue
;

3162 
˙å_ªq
.
cou¡
 = 1;

3164 
rc
 = 
	`rvu_mbox_h™dÀr_≈c_mˇm_Æloc_cou¡î
(
rvu
, &
˙å_ªq
, &
˙å_r•
);

3165 i‡(
rc
) {

3167 
	`muãx_lock
(&
mˇm
->
lock
);

3168 
mˇm
->
íåy2pfvf_m≠
[
íåy
] = 
NPC_MCAM_INVALID_MAP
;

3169 
	`≈c_mˇm_˛ór_bô
(
mˇm
, 
íåy
);

3170 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3171  
rc
;

3174 
˙å
 = 
˙å_r•
.cntr;

3176 
wrôe_íåy
:

3177 
	`muãx_lock
(&
mˇm
->
lock
);

3179 i‡(
	`is_≈c_ötf_tx
(
ªq
->
ötf
))

3180 
nix_ötf
 = 
pfvf
->
nix_tx_ötf
;

3182 
nix_ötf
 = 
pfvf
->
nix_rx_ötf
;

3184 
	`≈c_c⁄fig_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
íåy
, 
nix_ötf
,

3185 &
ªq
->
íåy_d©a
,Ñeq->
íabÀ_íåy
);

3187 i‡(
ªq
->
Æloc_˙å
)

3188 
	`≈c_m≠_mˇm_íåy_™d_˙å
(
rvu
, 
mˇm
, 
blkaddr
, 
íåy
, 
˙å
);

3189 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3191 
r•
->
íåy
 =Éntry;

3192 
r•
->
˙å
 = cntr;

3195 
	}
}

3197 
	#GET_KEX_CFG
(
ötf
) \

3198 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NPC
, 
	`NPC_AF_INTFX_KEX_CFG
(
ötf
))

	)

3200 
	#GET_KEX_FLAGS
(
ld
) \

3201 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NPC
, 
	`NPC_AF_KEX_LDATAX_FLAGS_CFG
(
ld
))

	)

3203 
	#GET_KEX_LD
(
ötf
, 
lid
, 
…
, 
ld
) \

3204 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NPC
, \

3205 
	`NPC_AF_INTFX_LIDX_LTX_LDX_CFG
(
ötf
, 
lid
, 
…
, 
ld
))

	)

3207 
	#GET_KEX_LDFLAGS
(
ötf
, 
ld
, 
Ê
) \

3208 
	`rvu_ªad64
(
rvu
, 
BLKADDR_NPC
, \

3209 
	`NPC_AF_INTFX_LDATAX_FLAGSX_CFG
(
ötf
, 
ld
, 
Ê
))

	)

3211 
	$rvu_mbox_h™dÀr_≈c_gë_kex_cfg
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

3212 
≈c_gë_kex_cfg_r•
 *
r•
)

3214 
lid
, 
…
, 
ld
, 
Ê
;

3216 
r•
->
rx_keyx_cfg
 = 
	`GET_KEX_CFG
(
NIX_INTF_RX
);

3217 
r•
->
tx_keyx_cfg
 = 
	`GET_KEX_CFG
(
NIX_INTF_TX
);

3218 
lid
 = 0;Üid < 
NPC_MAX_LID
;Üid++) {

3219 
…
 = 0;Üà< 
NPC_MAX_LT
;Üt++) {

3220 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++) {

3221 
r•
->
ötf_lid_…_ld
[
NIX_INTF_RX
][
lid
][
…
][
ld
] =

3222 
	`GET_KEX_LD
(
NIX_INTF_RX
, 
lid
, 
…
, 
ld
);

3223 
r•
->
ötf_lid_…_ld
[
NIX_INTF_TX
][
lid
][
…
][
ld
] =

3224 
	`GET_KEX_LD
(
NIX_INTF_TX
, 
lid
, 
…
, 
ld
);

3228 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++)

3229 
r•
->
kex_ld_Êags
[
ld
] = 
	`GET_KEX_FLAGS
(ld);

3231 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++) {

3232 
Ê
 = 0; f»< 
NPC_MAX_LFL
; fl++) {

3233 
r•
->
ötf_ld_Êags
[
NIX_INTF_RX
][
ld
][
Ê
] =

3234 
	`GET_KEX_LDFLAGS
(
NIX_INTF_RX
, 
ld
, 
Ê
);

3235 
r•
->
ötf_ld_Êags
[
NIX_INTF_TX
][
ld
][
Ê
] =

3236 
	`GET_KEX_LDFLAGS
(
NIX_INTF_TX
, 
ld
, 
Ê
);

3239 
	`mem˝y
(
r•
->
mkex_pÊ_«me
, 
rvu
->mkex_pÊ_«me, 
MKEX_NAME_LEN
);

3241 
	}
}

3244 
	$≈c_£t_v¨_Àn_off£t_pköd
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u64
 
pköd
,

3245 
u8
 
v¨_Àn_off
, u8 
v¨_Àn_off_mask
, u8 
shi·_dú
)

3247 
≈c_kpu_a˘i⁄0
 *
a˘0
;

3248 
u8
 
shi·_cou¡
 = 0;

3249 
blkaddr
;

3250 
u64
 
vÆ
;

3252 i‡(!
v¨_Àn_off_mask
)

3253  -
EINVAL
;

3255 i‡(
v¨_Àn_off_mask
 != 0xff) {

3256 i‡(
shi·_dú
)

3257 
shi·_cou¡
 = 
	`__ffs
(
v¨_Àn_off_mask
);

3259 
shi·_cou¡
 = (8 - 
	`__Ês
(
v¨_Àn_off_mask
));

3261 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 
pcifunc
);

3262 i‡(
blkaddr
 < 0) {

3263 
	`dev_îr
(
rvu
->
dev
, "%s: NPC blockÇŸ im∂emíãd\n", 
__func__
);

3264  -
EINVAL
;

3266 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_PKINDX_ACTION0
(
pköd
));

3267 
a˘0
 = (
≈c_kpu_a˘i⁄0
 *)&
vÆ
;

3268 
a˘0
->
v¨_Àn_shi·
 = 
shi·_cou¡
;

3269 
a˘0
->
v¨_Àn_right
 = 
shi·_dú
;

3270 
a˘0
->
v¨_Àn_mask
 = 
v¨_Àn_off_mask
;

3271 
a˘0
->
v¨_Àn_off£t
 = 
v¨_Àn_off
;

3272 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_PKINDX_ACTION0
(
pköd
), 
vÆ
);

3274 
	}
}

3277 
	$rvu_≈c_£t_∑r£_mode
(
rvu
 *rvu, 
u16
 
pcifunc
, 
u64
 
mode
, 
u8
 
dú
,

3278 
u64
 
pköd
, 
u8
 
v¨_Àn_off
, u8 
v¨_Àn_off_mask
,

3279 
u8
 
shi·_dú
)

3282 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

3283 
blkaddr
, 
nixlf
, 
rc
, 
ötf_mode
;

3284 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

3285 
boﬁ
 
íabÀ_higig2
 = 
Ál£
;

3286 
u64
 
rxpköd
, 
txpköd
;

3287 
u8
 
cgx_id
, 
lmac_id
;

3290 
rxpköd
 = 
	`rvu_≈c_gë_pköd
(
rvu
, 
pf
);

3291 
txpköd
 = 
NPC_TX_DEF_PKIND
;

3292 
ötf_mode
 = 
NPC_INTF_MODE_DEF
;

3294 i‡(
mode
 & 
OTX2_PRIV_FLAGS_EDSA
) {

3295 
rxpköd
 = 
NPC_RX_EDSA_PKIND
;

3296 
ötf_mode
 = 
NPC_INTF_MODE_EDSA
;

3297 } i‡(
mode
 & 
OTX2_PRIV_FLAGS_FDSA
) {

3298 
rxpköd
 = 
NPC_RX_EDSA_PKIND
;

3299 
ötf_mode
 = 
NPC_INTF_MODE_FDSA
;

3300 } i‡(
mode
 & 
OTX2_PRIV_FLAGS_HIGIG
) {

3302 i‡(
pfvf
->
hw_rx_t°amp_í
 ||

3303 
	`rvu_nix_is_±p_tx_íabÀd
(
rvu
, 
pcifunc
))

3304  
NPC_AF_ERR_HIGIG_CONFIG_FAIL
;

3306 i‡(!
	`is_mac_„©uª_suµ‹ãd
(
rvu
, 
pf
, 
RVU_LMAC_FEAT_HIGIG2
))

3307  
NPC_AF_ERR_HIGIG_NOT_SUPPORTED
;

3309 
rxpköd
 = 
NPC_RX_HIGIG_PKIND
;

3310 
txpköd
 = 
NPC_TX_HIGIG_PKIND
;

3311 
ötf_mode
 = 
NPC_INTF_MODE_HIGIG
;

3312 
íabÀ_higig2
 = 
åue
;

3313 } i‡(
mode
 & 
OTX2_PRIV_FLAGS_CUSTOM
) {

3314 i‡(
pköd
 =
NPC_RX_CUSTOM_PRE_L2_PKIND
) {

3315 
rc
 = 
	`≈c_£t_v¨_Àn_off£t_pköd
(
rvu
, 
pcifunc
, 
pköd
,

3316 
v¨_Àn_off
,

3317 
v¨_Àn_off_mask
,

3318 
shi·_dú
);

3319 i‡(
rc
)

3320  
rc
;

3322 
rxpköd
 = 
pköd
;

3323 
txpköd
 = 
pköd
;

3326 i‡(
dú
 & 
PKIND_RX
) {

3328 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
pcifunc
))

3330 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

3332 
rc
 = 
	`cgx_£t_pköd
(
	`rvu_cgx_pd©a
(
cgx_id
, 
rvu
),

3333 
lmac_id
, 
rxpköd
);

3334 i‡(
rc
)

3335  
rc
;

3338 i‡(
dú
 & 
PKIND_TX
) {

3340 
rc
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, &
blkaddr
);

3341 i‡(
rc
)

3342  
rc
;

3344 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NIX_AF_LFX_TX_PARSE_CFG
(
nixlf
),

3345 
txpköd
);

3348 i‡(
íabÀ_higig2
 ^ 
	`rvu_cgx_is_higig2_íabÀd
(
rvu
, 
pf
))

3349 
	`rvu_cgx_íadis_higig2
(
rvu
, 
pf
, 
íabÀ_higig2
);

3351 
pfvf
->
ötf_mode
 = intf_mode;

3353 
	}
}

3355 
	$rvu_mbox_h™dÀr_≈c_£t_pköd
(
rvu
 *rvu,

3356 
≈c_£t_pköd
 *
ªq
,

3357 
msg_r•
 *
r•
)

3359  
	`rvu_≈c_£t_∑r£_mode
(
rvu
, 
ªq
->
hdr
.
pcifunc
,Ñeq->
mode
,

3360 
ªq
->
dú
,Ñeq->
pköd
,Ñeq->
v¨_Àn_off
,

3361 
ªq
->
v¨_Àn_off_mask
,Ñeq->
shi·_dú
);

3362 
	}
}

3364 
	$rvu_mbox_h™dÀr_≈c_ªad_ba£_°ìr_ruÀ
(
rvu
 *rvu,

3365 
msg_ªq
 *
ªq
,

3366 
≈c_mˇm_ªad_ba£_ruÀ_r•
 *
r•
)

3368 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

3369 
ödex
, 
blkaddr
, 
nixlf
, 
rc
 = 0;

3370 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

3371 
rvu_pfvf
 *
pfvf
;

3372 
u8
 
ötf
, 
íabÀ
;

3374 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

3375 i‡(
blkaddr
 < 0)

3376  
NPC_MCAM_INVALID_REQ
;

3379 i‡(!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
)) {

3380 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

3381 
r•
->
íåy
.
kw
[0] = 
pfvf
->
rx_ch™_ba£
;

3382 
r•
->
íåy
.
kw_mask
[0] = 0xFFFULL;

3383 
out
;

3387 
	`muãx_lock
(&
mˇm
->
lock
);

3388 
ödex
 = 0; index < 
mˇm
->
bm≠_íåõs
; index++) {

3389 i‡(
mˇm
->
íåy2èrgë_pffunc
[
ödex
] =
pcifunc
)

3390 
ªad_íåy
;

3393 
rc
 = 
	`nix_gë_nixlf
(
rvu
, 
pcifunc
, &
nixlf
, 
NULL
);

3394 i‡(
rc
 < 0) {

3395 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3396 
out
;

3399 
ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
pcifunc
, 
nixlf
,

3400 
NIXLF_UCAST_ENTRY
);

3401 
ªad_íåy
:

3403 
	`≈c_ªad_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
ödex
, &
r•
->
íåy
, &
ötf
,

3404 &
íabÀ
);

3405 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3406 
out
:

3407  
rc
;

3408 
	}
}

3410 
	$rvu_mbox_h™dÀr_≈c_mˇm_íåy_°©s
(
rvu
 *rvu,

3411 
≈c_mˇm_gë_°©s_ªq
 *
ªq
,

3412 
≈c_mˇm_gë_°©s_r•
 *
r•
)

3414 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

3415 
u16
 
ödex
, 
˙å
;

3416 
blkaddr
;

3417 
u64
 
ªgvÆ
;

3418 
u32
 
b™k
;

3420 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

3421 i‡(
blkaddr
 < 0)

3422  
NPC_MCAM_INVALID_REQ
;

3424 
	`muãx_lock
(&
mˇm
->
lock
);

3426 
ödex
 = 
ªq
->
íåy
 & (
mˇm
->
b™ksize
 - 1);

3427 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ªq
->
íåy
);

3430 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_MCAMEX_BANKX_STAT_ACT
(
ödex
, 
b™k
));

3432 i‡(!(
ªgvÆ
 & 
rvu
->
hw
->
≈c_°©_ía
)) {

3433 
r•
->
°©_ía
 = 0;

3434 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3438 
˙å
 = 
ªgvÆ
 & 0x1FF;

3440 
r•
->
°©_ía
 = 1;

3441 
r•
->
°©
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_MATCH_STATX
(
˙å
));

3442 
r•
->
°©
 &
	`BIT_ULL
(48) - 1;

3444 
	`muãx_u∆ock
(&
mˇm
->
lock
);

3447 
	}
}

	@rvu_npc_fs.c

7 
	~<löux/bôfõld.h
>

9 
	~"rvu_°ru˘.h
"

10 
	~"rvu_ªg.h
"

11 
	~"rvu.h
"

12 
	~"≈c.h
"

13 
	~"rvu_≈c_fs.h
"

14 
	~"rvu_≈c_hash.h
"

16 
	#NPC_BYTESM
 
	`GENMASK_ULL
(19, 16)

	)

17 
	#NPC_HDR_OFFSET
 
	`GENMASK_ULL
(15, 8)

	)

18 
	#NPC_KEY_OFFSET
 
	`GENMASK_ULL
(5, 0)

	)

19 
	#NPC_LDATA_EN
 
	`BIT_ULL
(7)

	)

21 c⁄° * c⁄° 
	g≈c_Êow_«mes
[] = {

22 [
NPC_DMAC
] = "dmac",

23 [
NPC_SMAC
] = "smac",

24 [
NPC_ETYPE
] = "etherÅype",

25 [
NPC_VLAN_ETYPE_CTAG
] = "vlanÉtherÅype ctag",

26 [
NPC_VLAN_ETYPE_STAG
] = "vlanÉtherÅype stag",

27 [
NPC_OUTER_VID
] = "outer vlan id",

28 [
NPC_TOS
] = "tos",

29 [
NPC_IPFRAG_IPV4
] = "fragmented IPv4 header ",

30 [
NPC_SIP_IPV4
] = "ipv4 source ip",

31 [
NPC_DIP_IPV4
] = "ipv4 destination ip",

32 [
NPC_IPFRAG_IPV6
] = "fragmented IPv6 header ",

33 [
NPC_SIP_IPV6
] = "ipv6 source ip",

34 [
NPC_DIP_IPV6
] = "ipv6 destination ip",

35 [
NPC_IPPROTO_TCP
] = "ipÖrotoÅcp",

36 [
NPC_IPPROTO_UDP
] = "ipÖroto udp",

37 [
NPC_IPPROTO_SCTP
] = "ipÖroto sctp",

38 [
NPC_IPPROTO_ICMP
] = "ipÖroto icmp",

39 [
NPC_IPPROTO_ICMP6
] = "ipÖroto icmp6",

40 [
NPC_IPPROTO_AH
] = "ipÖroto AH",

41 [
NPC_IPPROTO_ESP
] = "ipÖroto ESP",

42 [
NPC_SPORT_TCP
] = "tcp sourceÖort",

43 [
NPC_DPORT_TCP
] = "tcp destinationÖort",

44 [
NPC_SPORT_UDP
] = "udp sourceÖort",

45 [
NPC_DPORT_UDP
] = "udp destinationÖort",

46 [
NPC_SPORT_SCTP
] = "sctp sourceÖort",

47 [
NPC_DPORT_SCTP
] = "sctp destinationÖort",

48 [
NPC_FDSA_VAL
] = "FDSAÅag value ",

49 [
NPC_LXMB
] = "Mcast/Bcast header ",

50 [
NPC_UNKNOWN
] = "unknown",

53 
boﬁ
 
	$≈c_is_„©uª_suµ‹ãd
(
rvu
 *rvu, 
u64
 
„©uªs
, 
u8
 
ötf
)

55 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

56 
u64
 
mˇm_„©uªs
;

57 
u64
 
unsuµ‹ãd
;

59 
mˇm_„©uªs
 = 
	`is_≈c_ötf_tx
(
ötf
Ë? 
mˇm
->
tx_„©uªs
 : mˇm->
rx_„©uªs
;

60 
unsuµ‹ãd
 = (
mˇm_„©uªs
 ^ 
„©uªs
) & ~mcam_features;

63  !
unsuµ‹ãd
;

64 
	}
}

66 c⁄° *
	$≈c_gë_fõld_«me
(
u8
 
hdr
)

68 i‡(
hdr
 >
	`ARRAY_SIZE
(
≈c_Êow_«mes
))

69  
≈c_Êow_«mes
[
NPC_UNKNOWN
];

71  
≈c_Êow_«mes
[
hdr
];

72 
	}
}

77 
	$≈c_£t_kw_masks
(
≈c_mˇm
 *
mˇm
, 
u8
 
ty≥
,

78 
u8
 
ƒ_bôs
, 
°¨t_kwi
, 
off£t
, u8 
ötf
)

80 
≈c_key_fõld
 *
fõld
 = &
mˇm
->
rx_key_fõlds
[
ty≥
];

81 
u8
 
bôs_ö_kw
;

82 
max_kwi
;

84 i‡(
mˇm
->
b™ks_≥r_íåy
 == 1)

85 
max_kwi
 = 1;

86 i‡(
mˇm
->
b™ks_≥r_íåy
 == 2)

87 
max_kwi
 = 3;

89 
max_kwi
 = 6;

91 i‡(
	`is_≈c_ötf_tx
(
ötf
))

92 
fõld
 = &
mˇm
->
tx_key_fõlds
[
ty≥
];

94 i‡(
off£t
 + 
ƒ_bôs
 <= 64) {

96 i‡(
°¨t_kwi
 > 
max_kwi
)

98 
fõld
->
kw_mask
[
°¨t_kwi
] |
	`GENMASK_ULL
(
ƒ_bôs
 - 1, 0)

99 << 
off£t
;

100 
fõld
->
ƒ_kws
 = 1;

101 } i‡(
off£t
 + 
ƒ_bôs
 > 64 &&

102 
off£t
 + 
ƒ_bôs
 <= 128) {

104 i‡(
°¨t_kwi
 + 1 > 
max_kwi
)

107 
bôs_ö_kw
 = 64 - 
off£t
;

108 
fõld
->
kw_mask
[
°¨t_kwi
] |
	`GENMASK_ULL
(
bôs_ö_kw
 - 1, 0)

109 << 
off£t
;

111 
bôs_ö_kw
 = 
ƒ_bôs
 + 
off£t
 - 64;

112 
fõld
->
kw_mask
[
°¨t_kwi
 + 1] |
	`GENMASK_ULL
(
bôs_ö_kw
 - 1, 0);

113 
fõld
->
ƒ_kws
 = 2;

116 i‡(
°¨t_kwi
 + 2 > 
max_kwi
)

119 
bôs_ö_kw
 = 64 - 
off£t
;

120 
fõld
->
kw_mask
[
°¨t_kwi
] |
	`GENMASK_ULL
(
bôs_ö_kw
 - 1, 0)

121 << 
off£t
;

123 
fõld
->
kw_mask
[
°¨t_kwi
 + 1] = ~0ULL;

125 
bôs_ö_kw
 = 
ƒ_bôs
 + 
off£t
 - 128;

126 
fõld
->
kw_mask
[
°¨t_kwi
 + 2] |
	`GENMASK_ULL
(
bôs_ö_kw
 - 1, 0);

127 
fõld
->
ƒ_kws
 = 3;

129 
	}
}

132 
boﬁ
 
	$≈c_is_fõld_¥e£¡
(
rvu
 *rvu, 
key_fõlds
 
ty≥
, 
u8
 
ötf
)

134 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

135 
≈c_key_fõld
 *
öput
;

137 
öput
 = &
mˇm
->
rx_key_fõlds
[
ty≥
];

138 i‡(
	`is_≈c_ötf_tx
(
ötf
))

139 
öput
 = &
mˇm
->
tx_key_fõlds
[
ty≥
];

141  
öput
->
ƒ_kws
 > 0;

142 
	}
}

144 
boﬁ
 
	$≈c_is_ßme
(
≈c_key_fõld
 *
öput
,

145 
≈c_key_fõld
 *
fõld
)

147  
	`memcmp
(&
öput
->
œyî_md©a
, &
fõld
->layer_mdata,

148 (
≈c_œyî_md©a
)) == 0;

149 
	}
}

151 
	$≈c_£t_œyî_md©a
(
≈c_mˇm
 *
mˇm
, 
key_fõlds
 
ty≥
,

152 
u64
 
cfg
, 
u8
 
lid
, u8 
…
, u8 
ötf
)

154 
≈c_key_fõld
 *
öput
 = &
mˇm
->
rx_key_fõlds
[
ty≥
];

156 i‡(
	`is_≈c_ötf_tx
(
ötf
))

157 
öput
 = &
mˇm
->
tx_key_fõlds
[
ty≥
];

159 
öput
->
œyî_md©a
.
hdr
 = 
	`FIELD_GET
(
NPC_HDR_OFFSET
, 
cfg
);

160 
öput
->
œyî_md©a
.
key
 = 
	`FIELD_GET
(
NPC_KEY_OFFSET
, 
cfg
);

161 
öput
->
œyî_md©a
.
Àn
 = 
	`FIELD_GET
(
NPC_BYTESM
, 
cfg
) + 1;

162 
öput
->
œyî_md©a
.
…y≥
 = 
…
;

163 
öput
->
œyî_md©a
.
lid
 =Üid;

164 
	}
}

166 
boﬁ
 
	$≈c_check_ovîœp_fõlds
(
≈c_key_fõld
 *
öput1
,

167 
≈c_key_fõld
 *
öput2
)

169 
kwi
;

174 i‡(
öput1
->
œyî_md©a
.
lid
 =
öput2
->layer_mdata.lid &&

175 
öput1
->
œyî_md©a
.
…y≥
 !
öput2
->layer_mdata.ltype)

176  
Ál£
;

178 
kwi
 = 0; kwò< 
NPC_MAX_KWS_IN_KEY
; kwi++) {

179 i‡(
öput1
->
kw_mask
[
kwi
] & 
öput2
->kw_mask[kwi])

180  
åue
;

183  
Ál£
;

184 
	}
}

191 
boﬁ
 
	$≈c_check_ovîœp
(
rvu
 *rvu, 
blkaddr
,

192 
key_fõlds
 
ty≥
, 
u8
 
°¨t_lid
, u8 
ötf
)

194 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

195 
≈c_key_fõld
 *
dummy
, *
öput
;

196 
°¨t_kwi
, 
off£t
;

197 
u8
 
ƒ_bôs
, 
lid
, 
…
, 
ld
;

198 
u64
 
cfg
;

200 
dummy
 = &
mˇm
->
rx_key_fõlds
[
NPC_UNKNOWN
];

201 
öput
 = &
mˇm
->
rx_key_fõlds
[
ty≥
];

203 i‡(
	`is_≈c_ötf_tx
(
ötf
)) {

204 
dummy
 = &
mˇm
->
tx_key_fõlds
[
NPC_UNKNOWN
];

205 
öput
 = &
mˇm
->
tx_key_fõlds
[
ty≥
];

208 
lid
 = 
°¨t_lid
;Üid < 
NPC_MAX_LID
;Üid++) {

209 
…
 = 0;Üà< 
NPC_MAX_LT
;Üt++) {

210 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++) {

211 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

212 
NPC_AF_INTFX_LIDX_LTX_LDX_CFG


213 (
ötf
, 
lid
, 
…
, 
ld
));

214 i‡(!
	`FIELD_GET
(
NPC_LDATA_EN
, 
cfg
))

216 
	`mem£t
(
dummy
, 0, (
≈c_key_fõld
));

217 
	`≈c_£t_œyî_md©a
(
mˇm
, 
NPC_UNKNOWN
, 
cfg
,

218 
lid
, 
…
, 
ötf
);

220 i‡(
	`≈c_is_ßme
(
öput
, 
dummy
))

222 
°¨t_kwi
 = 
dummy
->
œyî_md©a
.
key
 / 8;

223 
off£t
 = (
dummy
->
œyî_md©a
.
key
 * 8) % 64;

224 
ƒ_bôs
 = 
dummy
->
œyî_md©a
.
Àn
 * 8;

226 
	`≈c_£t_kw_masks
(
mˇm
, 
NPC_UNKNOWN
, 
ƒ_bôs
,

227 
°¨t_kwi
, 
off£t
, 
ötf
);

231 i‡(
	`≈c_check_ovîœp_fõlds
(
dummy
, 
öput
))

232  
åue
;

237  
Ál£
;

238 
	}
}

240 
boﬁ
 
	$≈c_check_fõld
(
rvu
 *rvu, 
blkaddr
, 
key_fõlds
 
ty≥
,

241 
u8
 
ötf
)

243 i‡(!
	`≈c_is_fõld_¥e£¡
(
rvu
, 
ty≥
, 
ötf
) ||

244 
	`≈c_check_ovîœp
(
rvu
, 
blkaddr
, 
ty≥
, 0, 
ötf
))

245  
Ál£
;

246  
åue
;

247 
	}
}

249 
	$≈c_sˇn_exa˘_ªsu…
(
≈c_mˇm
 *
mˇm
, 
u8
 
bô_numbî
,

250 
u8
 
key_nibbÀ
, u8 
ötf
)

252 
u8
 
off£t
 = (
key_nibbÀ
 * 4) % 64;

253 
u8
 
kwi
 = (
key_nibbÀ
 * 4) / 64;

254 
u8
 
ƒ_bôs
 = 4;

255 
u8
 
ty≥
;

257 
bô_numbî
) {

259 
ty≥
 = 
NPC_EXACT_RESULT
;

265 
	`≈c_£t_kw_masks
(
mˇm
, 
ty≥
, 
ƒ_bôs
, 
kwi
, 
off£t
, 
ötf
);

266 
	}
}

268 
	$≈c_sˇn_∑r£_ªsu…
(
≈c_mˇm
 *
mˇm
, 
u8
 
bô_numbî
,

269 
u8
 
key_nibbÀ
, u8 
ötf
)

271 
u8
 
off£t
 = (
key_nibbÀ
 * 4) % 64;

272 
u8
 
kwi
 = (
key_nibbÀ
 * 4) / 64;

273 
u8
 
ƒ_bôs
 = 4;

274 
u8
 
ty≥
;

276 
bô_numbî
) {

278 
ty≥
 = 
NPC_CHAN
;

281 
ty≥
 = 
NPC_ERRLEV
;

284 
ty≥
 = 
NPC_ERRCODE
;

287 
ty≥
 = 
NPC_LXMB
;

291 
ty≥
 = 
NPC_LA
;

294 
ty≥
 = 
NPC_LB
;

297 
ty≥
 = 
NPC_LC
;

300 
ty≥
 = 
NPC_LD
;

303 
ty≥
 = 
NPC_LE
;

306 
ty≥
 = 
NPC_LF
;

309 
ty≥
 = 
NPC_LG
;

312 
ty≥
 = 
NPC_LH
;

318 
	`≈c_£t_kw_masks
(
mˇm
, 
ty≥
, 
ƒ_bôs
, 
kwi
, 
off£t
, 
ötf
);

319 
	}
}

321 
	$≈c_h™dÀ_mu…i_œyî_fõlds
(
rvu
 *rvu, 
blkaddr
, 
u8
 
ötf
)

323 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

324 
≈c_key_fõld
 *
key_fõlds
;

328 
≈c_key_fõld
 *
ëy≥_ëhî
;

329 
≈c_key_fõld
 *
ëy≥_èg1
;

330 
≈c_key_fõld
 *
ëy≥_èg2
;

334 
≈c_key_fõld
 *
vœn_èg1
;

335 
≈c_key_fõld
 *
vœn_èg2
;

336 
u64
 *
„©uªs
;

337 
u8
 
°¨t_lid
;

338 
i
;

340 
key_fõlds
 = 
mˇm
->
rx_key_fõlds
;

341 
„©uªs
 = &
mˇm
->
rx_„©uªs
;

343 i‡(
	`is_≈c_ötf_tx
(
ötf
)) {

344 
key_fõlds
 = 
mˇm
->
tx_key_fõlds
;

345 
„©uªs
 = &
mˇm
->
tx_„©uªs
;

353 
ëy≥_ëhî
 = &
key_fõlds
[
NPC_ETYPE_ETHER
];

354 
ëy≥_èg1
 = &
key_fõlds
[
NPC_ETYPE_TAG1
];

355 
ëy≥_èg2
 = &
key_fõlds
[
NPC_ETYPE_TAG2
];

356 
vœn_èg1
 = &
key_fõlds
[
NPC_VLAN_TAG1
];

357 
vœn_èg2
 = &
key_fõlds
[
NPC_VLAN_TAG2
];

360 i‡(!
ëy≥_ëhî
->
ƒ_kws
 && !
ëy≥_èg1
->ƒ_kw†&& !
ëy≥_èg2
->nr_kws) {

361 
	`dev_îr
(
rvu
->
dev
, "mkex: Ethertype isÇotÉxtracted.\n");

362 
vœn_tci
;

366 i‡(
ëy≥_ëhî
->
ƒ_kws
 && !
ëy≥_èg1
->ƒ_kw†&& !
ëy≥_èg2
->nr_kws)

367 
key_fõlds
[
NPC_ETYPE
] = *
ëy≥_ëhî
;

368 i‡(!
ëy≥_ëhî
->
ƒ_kws
 && 
ëy≥_èg1
->ƒ_kw†&& !
ëy≥_èg2
->nr_kws)

369 
key_fõlds
[
NPC_ETYPE
] = *
ëy≥_èg1
;

370 i‡(!
ëy≥_ëhî
->
ƒ_kws
 && !
ëy≥_èg1
->ƒ_kw†&& 
ëy≥_èg2
->nr_kws)

371 
key_fõlds
[
NPC_ETYPE
] = *
ëy≥_èg2
;

374 i‡(
ëy≥_ëhî
->
ƒ_kws
 && 
ëy≥_èg1
->nr_kws) {

375 
i
 = 0; i < 
NPC_MAX_KWS_IN_KEY
; i++) {

376 i‡(
ëy≥_ëhî
->
kw_mask
[
i
] !
ëy≥_èg1
->kw_mask[i]) {

377 
	`dev_îr
(
rvu
->
dev
, "mkex: EtypeÖos is different for untaggedándÅaggedÖkts.\n");

378 
vœn_tci
;

381 
key_fõlds
[
NPC_ETYPE
] = *
ëy≥_èg1
;

383 i‡(
ëy≥_ëhî
->
ƒ_kws
 && 
ëy≥_èg2
->nr_kws) {

384 
i
 = 0; i < 
NPC_MAX_KWS_IN_KEY
; i++) {

385 i‡(
ëy≥_ëhî
->
kw_mask
[
i
] !
ëy≥_èg2
->kw_mask[i]) {

386 
	`dev_îr
(
rvu
->
dev
, "mkex: EtypeÖos is different for untaggedánd doubleÅaggedÖkts.\n");

387 
vœn_tci
;

390 
key_fõlds
[
NPC_ETYPE
] = *
ëy≥_èg2
;

392 i‡(
ëy≥_èg1
->
ƒ_kws
 && 
ëy≥_èg2
->nr_kws) {

393 
i
 = 0; i < 
NPC_MAX_KWS_IN_KEY
; i++) {

394 i‡(
ëy≥_èg1
->
kw_mask
[
i
] !
ëy≥_èg2
->kw_mask[i]) {

395 
	`dev_îr
(
rvu
->
dev
, "mkex: EtypeÖos is different forÅaggedánd doubleÅaggedÖkts.\n");

396 
vœn_tci
;

399 
key_fõlds
[
NPC_ETYPE
] = *
ëy≥_èg2
;

403 
°¨t_lid
 = 
key_fõlds
[
NPC_ETYPE
].
œyî_md©a
.
lid
 + 1;

404 i‡(
	`≈c_check_ovîœp
(
rvu
, 
blkaddr
, 
NPC_ETYPE
, 
°¨t_lid
, 
ötf
)) {

405 
	`dev_îr
(
rvu
->
dev
, "mkex: Ethertype is overwritten by higherÜayers.\n");

406 
vœn_tci
;

408 *
„©uªs
 |
	`BIT_ULL
(
NPC_ETYPE
);

409 
vœn_tci
:

411 i‡(!
vœn_èg1
->
ƒ_kws
 && !
vœn_èg2
->nr_kws) {

412 
	`dev_îr
(
rvu
->
dev
, "mkex: Outer vlanÅci isÇotÉxtracted.\n");

413 
d⁄e
;

417 i‡(
vœn_èg1
->
ƒ_kws
 && !
vœn_èg2
->nr_kws)

418 
key_fõlds
[
NPC_OUTER_VID
] = *
vœn_èg1
;

419 i‡(!
vœn_èg1
->
ƒ_kws
 && 
vœn_èg2
->nr_kws)

420 
key_fõlds
[
NPC_OUTER_VID
] = *
vœn_èg2
;

423 i‡(
vœn_èg1
->
ƒ_kws
 && 
vœn_èg2
->nr_kws) {

424 
i
 = 0; i < 
NPC_MAX_KWS_IN_KEY
; i++) {

425 i‡(
vœn_èg1
->
kw_mask
[
i
] !
vœn_èg2
->kw_mask[i]) {

426 
	`dev_îr
(
rvu
->
dev
, "mkex: Out vlanÅciÖos is different forÅaggedánd doubleÅaggedÖkts.\n");

427 
d⁄e
;

430 
key_fõlds
[
NPC_OUTER_VID
] = *
vœn_èg2
;

433 
°¨t_lid
 = 
key_fõlds
[
NPC_OUTER_VID
].
œyî_md©a
.
lid
 + 1;

434 i‡(
	`≈c_check_ovîœp
(
rvu
, 
blkaddr
, 
NPC_OUTER_VID
, 
°¨t_lid
, 
ötf
)) {

435 
	`dev_îr
(
rvu
->
dev
, "mkex: Outer vlanÅci is overwritten by higherÜayers.\n");

436 
d⁄e
;

438 *
„©uªs
 |
	`BIT_ULL
(
NPC_OUTER_VID
);

439 
d⁄e
:

441 
	}
}

443 
	$≈c_sˇn_ld©a
(
rvu
 *rvu, 
blkaddr
, 
u8
 
lid
,

444 
u8
 
…
, 
u64
 
cfg
, u8 
ötf
)

446 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

447 
u8
 
hdr
, 
key
, 
ƒ_byãs
, 
bô_off£t
;

448 
u8
 
œ_…y≥
, 
œ_°¨t
;

450 
°¨t_kwi
, 
off£t
;

452 
ƒ_byãs
 = 
	`FIELD_GET
(
NPC_BYTESM
, 
cfg
) + 1;

453 
hdr
 = 
	`FIELD_GET
(
NPC_HDR_OFFSET
, 
cfg
);

454 
key
 = 
	`FIELD_GET
(
NPC_KEY_OFFSET
, 
cfg
);

459 i‡(
	`is_≈c_ötf_tx
(
ötf
)) {

460 
œ_…y≥
 = 
NPC_LT_LA_IH_NIX_ETHER
;

461 
œ_°¨t
 = 8;

463 
œ_…y≥
 = 
NPC_LT_LA_ETHER
;

464 
œ_°¨t
 = 0;

467 
	#NPC_SCAN_HDR
(
«me
, 
hlid
, 
h…
, 
h°¨t
, 
hÀn
) \

469 
°¨t_kwi
 = 
key
 / 8; \

470 
off£t
 = (
key
 * 8) % 64; \

471 i‡(
lid
 =(
hlid
Ë&& 
…
 =(
h…
)) { \

472 i‡((
h°¨t
Ë>
hdr
 && \

473 ((
h°¨t
Ë+ (
hÀn
)Ë<(
hdr
 + 
ƒ_byãs
)) { \

474 
bô_off£t
 = (
hdr
 + 
ƒ_byãs
 - (
h°¨t
Ë- (
hÀn
)) * 8; \

475 
	`≈c_£t_œyî_md©a
(
mˇm
, (
«me
), 
cfg
, 
lid
, 
…
, 
ötf
); \

476 
off£t
 +
bô_off£t
; \

477 
°¨t_kwi
 +
off£t
 / 64; \

478 
off£t
 %= 64; \

479 
	`≈c_£t_kw_masks
(
mˇm
, (
«me
), (
hÀn
) * 8, \

480 
°¨t_kwi
, 
off£t
, 
ötf
); \

483 } 0)

	)

489 
	`NPC_SCAN_HDR
(
NPC_TOS
, 
NPC_LID_LC
, 
NPC_LT_LC_IP
, 1, 1);

490 
	`NPC_SCAN_HDR
(
NPC_IPFRAG_IPV4
, 
NPC_LID_LC
, 
NPC_LT_LC_IP
, 6, 1);

491 
	`NPC_SCAN_HDR
(
NPC_SIP_IPV4
, 
NPC_LID_LC
, 
NPC_LT_LC_IP
, 12, 4);

492 
	`NPC_SCAN_HDR
(
NPC_DIP_IPV4
, 
NPC_LID_LC
, 
NPC_LT_LC_IP
, 16, 4);

493 
	`NPC_SCAN_HDR
(
NPC_IPFRAG_IPV6
, 
NPC_LID_LC
, 
NPC_LT_LC_IP6_EXT
, 6, 1);

494 
	`NPC_SCAN_HDR
(
NPC_SIP_IPV6
, 
NPC_LID_LC
, 
NPC_LT_LC_IP6
, 8, 16);

495 
	`NPC_SCAN_HDR
(
NPC_DIP_IPV6
, 
NPC_LID_LC
, 
NPC_LT_LC_IP6
, 24, 16);

496 
	`NPC_SCAN_HDR
(
NPC_SPORT_UDP
, 
NPC_LID_LD
, 
NPC_LT_LD_UDP
, 0, 2);

497 
	`NPC_SCAN_HDR
(
NPC_DPORT_UDP
, 
NPC_LID_LD
, 
NPC_LT_LD_UDP
, 2, 2);

498 
	`NPC_SCAN_HDR
(
NPC_SPORT_TCP
, 
NPC_LID_LD
, 
NPC_LT_LD_TCP
, 0, 2);

499 
	`NPC_SCAN_HDR
(
NPC_DPORT_TCP
, 
NPC_LID_LD
, 
NPC_LT_LD_TCP
, 2, 2);

500 
	`NPC_SCAN_HDR
(
NPC_SPORT_SCTP
, 
NPC_LID_LD
, 
NPC_LT_LD_SCTP
, 0, 2);

501 
	`NPC_SCAN_HDR
(
NPC_DPORT_SCTP
, 
NPC_LID_LD
, 
NPC_LT_LD_SCTP
, 2, 2);

502 
	`NPC_SCAN_HDR
(
NPC_ETYPE_ETHER
, 
NPC_LID_LA
, 
NPC_LT_LA_ETHER
, 12, 2);

503 
	`NPC_SCAN_HDR
(
NPC_ETYPE_TAG1
, 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
, 4, 2);

504 
	`NPC_SCAN_HDR
(
NPC_ETYPE_TAG2
, 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
, 8, 2);

505 
	`NPC_SCAN_HDR
(
NPC_VLAN_TAG1
, 
NPC_LID_LB
, 
NPC_LT_LB_CTAG
, 2, 2);

506 
	`NPC_SCAN_HDR
(
NPC_VLAN_TAG2
, 
NPC_LID_LB
, 
NPC_LT_LB_STAG_QINQ
, 2, 2);

507 
	`NPC_SCAN_HDR
(
NPC_FDSA_VAL
, 
NPC_LID_LB
, 
NPC_LT_LB_FDSA
, 1, 1);

508 
	`NPC_SCAN_HDR
(
NPC_DMAC
, 
NPC_LID_LA
, 
œ_…y≥
, 
œ_°¨t
, 6);

510 
	`NPC_SCAN_HDR
(
NPC_SMAC
, 
NPC_LID_LA
, 
œ_…y≥
, 
œ_°¨t
 + 6, 6);

512 
	`NPC_SCAN_HDR
(
NPC_PF_FUNC
, 
NPC_LID_LA
, 
NPC_LT_LA_IH_NIX_ETHER
, 0, 2);

513 
	}
}

515 
	$≈c_£t_„©uªs
(
rvu
 *rvu, 
blkaddr
, 
u8
 
ötf
)

517 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

518 
u64
 *
„©uªs
 = &
mˇm
->
rx_„©uªs
;

519 
u64
 
t˝_udp_s˘p
;

520 
hdr
;

522 i‡(
	`is_≈c_ötf_tx
(
ötf
))

523 
„©uªs
 = &
mˇm
->
tx_„©uªs
;

525 
hdr
 = 
NPC_DMAC
; hd∏< 
NPC_HEADER_FIELDS_MAX
; hdr++) {

526 i‡(
	`≈c_check_fõld
(
rvu
, 
blkaddr
, 
hdr
, 
ötf
))

527 *
„©uªs
 |
	`BIT_ULL
(
hdr
);

530 
t˝_udp_s˘p
 = 
	`BIT_ULL
(
NPC_SPORT_TCP
Ë| BIT_ULL(
NPC_SPORT_UDP
) |

531 
	`BIT_ULL
(
NPC_DPORT_TCP
Ë| BIT_ULL(
NPC_DPORT_UDP
) |

532 
	`BIT_ULL
(
NPC_SPORT_SCTP
Ë| BIT_ULL(
NPC_DPORT_SCTP
);

535 i‡(*
„©uªs
 & 
t˝_udp_s˘p
) {

536 i‡(!
	`≈c_check_fõld
(
rvu
, 
blkaddr
, 
NPC_LD
, 
ötf
))

537 *
„©uªs
 &~
t˝_udp_s˘p
;

539 *
„©uªs
 |
	`BIT_ULL
(
NPC_IPPROTO_TCP
) |

540 
	`BIT_ULL
(
NPC_IPPROTO_UDP
) |

541 
	`BIT_ULL
(
NPC_IPPROTO_SCTP
);

545 i‡(
	`≈c_check_fõld
(
rvu
, 
blkaddr
, 
NPC_LD
, 
ötf
)) {

546 *
„©uªs
 |
	`BIT_ULL
(
NPC_IPPROTO_AH
);

547 *
„©uªs
 |
	`BIT_ULL
(
NPC_IPPROTO_ICMP
);

548 *
„©uªs
 |
	`BIT_ULL
(
NPC_IPPROTO_ICMP6
);

552 i‡(
	`≈c_check_fõld
(
rvu
, 
blkaddr
, 
NPC_LE
, 
ötf
))

553 *
„©uªs
 |
	`BIT_ULL
(
NPC_IPPROTO_ESP
);

556 i‡(*
„©uªs
 & 
	`BIT_ULL
(
NPC_OUTER_VID
) ||

557 *
„©uªs
 & 
	`BIT_ULL
(
NPC_FDSA_VAL
))

558 i‡(!
	`≈c_check_fõld
(
rvu
, 
blkaddr
, 
NPC_LB
, 
ötf
)) {

559 *
„©uªs
 &~
	`BIT_ULL
(
NPC_OUTER_VID
);

560 *
„©uªs
 &~
	`BIT_ULL
(
NPC_FDSA_VAL
);

564 i‡(
	`≈c_check_fõld
(
rvu
, 
blkaddr
, 
NPC_LB
, 
ötf
))

565 *
„©uªs
 |
	`BIT_ULL
(
NPC_VLAN_ETYPE_CTAG
) |

566 
	`BIT_ULL
(
NPC_VLAN_ETYPE_STAG
);

569 i‡(
	`≈c_check_fõld
(
rvu
, 
blkaddr
, 
NPC_LXMB
, 
ötf
))

570 *
„©uªs
 |
	`BIT_ULL
(
NPC_LXMB
);

571 
	}
}

577 
	$≈c_sˇn_kex
(
rvu
 *rvu, 
blkaddr
, 
u8
 
ötf
)

579 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

580 
u8
 
lid
, 
…
, 
ld
, 
bôƒ
;

581 
u64
 
cfg
, 
masked_cfg
;

582 
u8
 
key_nibbÀ
 = 0;

589 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_KEX_CFG
(
ötf
));

590 
masked_cfg
 = 
cfg
 & 
NPC_PARSE_NIBBLE
;

591 
	`f‹_óch_£t_bô
(
bôƒ
, (*)&
masked_cfg
, 31) {

592 
	`≈c_sˇn_∑r£_ªsu…
(
mˇm
, 
bôƒ
, 
key_nibbÀ
, 
ötf
);

593 
key_nibbÀ
++;

600 
masked_cfg
 = 
cfg
 & 
NPC_EXACT_NIBBLE
;

601 
bôƒ
 = 
NPC_EXACT_NIBBLE_START
;

602 
	`f‹_óch_£t_bô_‰om
(
bôƒ
, (*)&
masked_cfg
,

603 
NPC_EXACT_NIBBLE_START
) {

604 
	`≈c_sˇn_exa˘_ªsu…
(
mˇm
, 
bôƒ
, 
key_nibbÀ
, 
ötf
);

605 
key_nibbÀ
++;

609 
lid
 = 0;Üid < 
NPC_MAX_LID
;Üid++) {

610 
…
 = 0;Üà< 
NPC_MAX_LT
;Üt++) {

611 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++) {

612 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

613 
NPC_AF_INTFX_LIDX_LTX_LDX_CFG


614 (
ötf
, 
lid
, 
…
, 
ld
));

615 i‡(!
	`FIELD_GET
(
NPC_LDATA_EN
, 
cfg
))

617 
	`≈c_sˇn_ld©a
(
rvu
, 
blkaddr
, 
lid
, 
…
, 
cfg
,

618 
ötf
);

624 
	}
}

626 
	$≈c_sˇn_vîify_kex
(
rvu
 *rvu, 
blkaddr
)

628 
îr
;

630 
îr
 = 
	`≈c_sˇn_kex
(
rvu
, 
blkaddr
, 
NIX_INTF_RX
);

631 i‡(
îr
)

632  
îr
;

634 
îr
 = 
	`≈c_sˇn_kex
(
rvu
, 
blkaddr
, 
NIX_INTF_TX
);

635 i‡(
îr
)

636  
îr
;

639 i‡(!
	`≈c_is_fõld_¥e£¡
(
rvu
, 
NPC_CHAN
, 
NIX_INTF_RX
)) {

640 
	`dev_îr
(
rvu
->
dev
, "ChannelÇotÖresent in Key\n");

641  -
EINVAL
;

644 i‡(
	`≈c_check_ovîœp
(
rvu
, 
blkaddr
, 
NPC_CHAN
, 0, 
NIX_INTF_RX
)) {

645 
	`dev_îr
(
rvu
->
dev
, "Channel cannot be overwritten\n");

646  -
EINVAL
;

649 
	`≈c_£t_„©uªs
(
rvu
, 
blkaddr
, 
NIX_INTF_TX
);

650 
	`≈c_£t_„©uªs
(
rvu
, 
blkaddr
, 
NIX_INTF_RX
);

651 
	`≈c_h™dÀ_mu…i_œyî_fõlds
(
rvu
, 
blkaddr
, 
NIX_INTF_TX
);

652 
	`≈c_h™dÀ_mu…i_œyî_fõlds
(
rvu
, 
blkaddr
, 
NIX_INTF_RX
);

655 
	}
}

657 
	$≈c_Êow_°ìrög_öô
(
rvu
 *rvu, 
blkaddr
)

659 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

661 
	`INIT_LIST_HEAD
(&
mˇm
->
mˇm_ruÀs
);

663  
	`≈c_sˇn_vîify_kex
(
rvu
, 
blkaddr
);

664 
	}
}

666 
	$≈c_check_unsuµ‹ãd_Êows
(
rvu
 *rvu, 
u64
 
„©uªs
, 
u8
 
ötf
)

668 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

669 
u64
 *
mˇm_„©uªs
 = &
mˇm
->
rx_„©uªs
;

670 
u64
 
unsuµ‹ãd
;

671 
u8
 
bô
;

673 i‡(
	`is_≈c_ötf_tx
(
ötf
))

674 
mˇm_„©uªs
 = &
mˇm
->
tx_„©uªs
;

676 
unsuµ‹ãd
 = (*
mˇm_„©uªs
 ^ 
„©uªs
) & ~(*mcam_features);

677 i‡(
unsuµ‹ãd
) {

678 
	`dev_w¨n
(
rvu
->
dev
, "Unsupported flow(s):\n");

679 
	`f‹_óch_£t_bô
(
bô
, (*)&
unsuµ‹ãd
, 64)

680 
	`dev_w¨n
(
rvu
->
dev
, "%†", 
	`≈c_gë_fõld_«me
(
bô
));

681  -
EOPNOTSUPP
;

685 
	}
}

698 
	$≈c_upd©e_íåy
(
rvu
 *rvu, 
key_fõlds
 
ty≥
,

699 
mˇm_íåy
 *
íåy
, 
u64
 
vÆ_lo
,

700 
u64
 
vÆ_hi
, u64 
mask_lo
, u64 
mask_hi
, 
u8
 
ötf
)

702 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

703 
mˇm_íåy
 
dummy
 = { {0} };

704 
≈c_key_fõld
 *
fõld
;

705 
u64
 
kw1
, 
kw2
, 
kw3
;

706 
u8
 
shi·
;

707 
i
;

709 
fõld
 = &
mˇm
->
rx_key_fõlds
[
ty≥
];

710 i‡(
	`is_≈c_ötf_tx
(
ötf
))

711 
fõld
 = &
mˇm
->
tx_key_fõlds
[
ty≥
];

713 i‡(!
fõld
->
ƒ_kws
)

716 
i
 = 0; i < 
NPC_MAX_KWS_IN_KEY
; i++) {

717 i‡(!
fõld
->
kw_mask
[
i
])

720 
shi·
 = 
	`__ffs64
(
fõld
->
kw_mask
[
i
]);

722 
kw1
 = (
vÆ_lo
 << 
shi·
Ë& 
fõld
->
kw_mask
[
i
];

723 
dummy
.
kw
[
i
] = 
kw1
;

725 
kw1
 = (
mask_lo
 << 
shi·
Ë& 
fõld
->
kw_mask
[
i
];

726 
dummy
.
kw_mask
[
i
] = 
kw1
;

728 i‡(
fõld
->
ƒ_kws
 == 1)

731 i‡(
fõld
->
ƒ_kws
 == 2) {

733 
kw2
 = 
shi·
 ? 
vÆ_lo
 >> (64 - shift) : 0;

734 
kw2
 |(
vÆ_hi
 << 
shi·
);

735 
kw2
 &
fõld
->
kw_mask
[
i
 + 1];

736 
dummy
.
kw
[
i
 + 1] = 
kw2
;

738 
kw2
 = 
shi·
 ? 
mask_lo
 >> (64 - shift) : 0;

739 
kw2
 |(
mask_hi
 << 
shi·
);

740 
kw2
 &
fõld
->
kw_mask
[
i
 + 1];

741 
dummy
.
kw_mask
[
i
 + 1] = 
kw2
;

745 i‡(
fõld
->
ƒ_kws
 == 3) {

747 
kw2
 = 
shi·
 ? 
vÆ_lo
 >> (64 - shift) : 0;

748 
kw2
 |(
vÆ_hi
 << 
shi·
);

749 
kw2
 &
fõld
->
kw_mask
[
i
 + 1];

750 
kw3
 = 
shi·
 ? 
vÆ_hi
 >> (64 - shift) : 0;

751 
kw3
 &
fõld
->
kw_mask
[
i
 + 2];

752 
dummy
.
kw
[
i
 + 1] = 
kw2
;

753 
dummy
.
kw
[
i
 + 2] = 
kw3
;

755 
kw2
 = 
shi·
 ? 
mask_lo
 >> (64 - shift) : 0;

756 
kw2
 |(
mask_hi
 << 
shi·
);

757 
kw2
 &
fõld
->
kw_mask
[
i
 + 1];

758 
kw3
 = 
shi·
 ? 
mask_hi
 >> (64 - shift) : 0;

759 
kw3
 &
fõld
->
kw_mask
[
i
 + 2];

760 
dummy
.
kw_mask
[
i
 + 1] = 
kw2
;

761 
dummy
.
kw_mask
[
i
 + 2] = 
kw3
;

768 
i
 = 0; i < 
NPC_MAX_KWS_IN_KEY
; i++) {

769 i‡(!
fõld
->
kw_mask
[
i
])

771 
íåy
->
kw
[
i
] &~
fõld
->
kw_mask
[i];

772 
íåy
->
kw_mask
[
i
] &~
fõld
->kw_mask[i];

774 
íåy
->
kw
[
i
] |
dummy
.kw[i];

775 
íåy
->
kw_mask
[
i
] |
dummy
.kw_mask[i];

777 
	}
}

779 
	$≈c_upd©e_ùv6_Êow
(
rvu
 *rvu, 
mˇm_íåy
 *
íåy
,

780 
u64
 
„©uªs
, 
Êow_msg
 *
pkt
,

781 
Êow_msg
 *
mask
,

782 
rvu_≈c_mˇm_ruÀ
 *
ouçut
, 
u8
 
ötf
)

784 
u32
 
§c_ù
[
IPV6_WORDS
], 
§c_ù_mask
[IPV6_WORDS];

785 
u32
 
d°_ù
[
IPV6_WORDS
], 
d°_ù_mask
[IPV6_WORDS];

786 
Êow_msg
 *
›kt
 = &
ouçut
->
∑ckë
;

787 
Êow_msg
 *
omask
 = &
ouçut
->
mask
;

788 
u64
 
mask_lo
, 
mask_hi
;

789 
u64
 
vÆ_lo
, 
vÆ_hi
;

796 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_SIP_IPV6
)) {

797 
	`be32_to_˝u_¨øy
(
§c_ù_mask
, 
mask
->
ù6§c
, 
IPV6_WORDS
);

798 
	`be32_to_˝u_¨øy
(
§c_ù
, 
pkt
->
ù6§c
, 
IPV6_WORDS
);

800 
mask_hi
 = (
u64
)
§c_ù_mask
[0] << 32 | src_ip_mask[1];

801 
mask_lo
 = (
u64
)
§c_ù_mask
[2] << 32 | src_ip_mask[3];

802 
vÆ_hi
 = (
u64
)
§c_ù
[0] << 32 | src_ip[1];

803 
vÆ_lo
 = (
u64
)
§c_ù
[2] << 32 | src_ip[3];

805 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_SIP_IPV6
, 
íåy
, 
vÆ_lo
, 
vÆ_hi
,

806 
mask_lo
, 
mask_hi
, 
ötf
);

807 
	`mem˝y
(
›kt
->
ù6§c
, 
pkt
->ip6src, (opkt->ip6src));

808 
	`mem˝y
(
omask
->
ù6§c
, 
mask
->ip6src, (omask->ip6src));

810 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_DIP_IPV6
)) {

811 
	`be32_to_˝u_¨øy
(
d°_ù_mask
, 
mask
->
ù6d°
, 
IPV6_WORDS
);

812 
	`be32_to_˝u_¨øy
(
d°_ù
, 
pkt
->
ù6d°
, 
IPV6_WORDS
);

814 
mask_hi
 = (
u64
)
d°_ù_mask
[0] << 32 | dst_ip_mask[1];

815 
mask_lo
 = (
u64
)
d°_ù_mask
[2] << 32 | dst_ip_mask[3];

816 
vÆ_hi
 = (
u64
)
d°_ù
[0] << 32 | dst_ip[1];

817 
vÆ_lo
 = (
u64
)
d°_ù
[2] << 32 | dst_ip[3];

819 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_DIP_IPV6
, 
íåy
, 
vÆ_lo
, 
vÆ_hi
,

820 
mask_lo
, 
mask_hi
, 
ötf
);

821 
	`mem˝y
(
›kt
->
ù6d°
, 
pkt
->ip6dst, (opkt->ip6dst));

822 
	`mem˝y
(
omask
->
ù6d°
, 
mask
->ip6dst, (omask->ip6dst));

824 
	}
}

826 
	$≈c_upd©e_vœn_„©uªs
(
rvu
 *rvu, 
mˇm_íåy
 *
íåy
,

827 
u64
 
„©uªs
, 
u8
 
ötf
)

829 
boﬁ
 
˘ag
 = !!(
„©uªs
 & 
	`BIT_ULL
(
NPC_VLAN_ETYPE_CTAG
));

830 
boﬁ
 
°ag
 = !!(
„©uªs
 & 
	`BIT_ULL
(
NPC_VLAN_ETYPE_STAG
));

831 
boﬁ
 
vid
 = !!(
„©uªs
 & 
	`BIT_ULL
(
NPC_OUTER_VID
));

834 i‡(
vid
 && !
˘ag
 && !
°ag
) {

835 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LB
, 
íåy
,

836 
NPC_LT_LB_STAG_QINQ
 | 
NPC_LT_LB_CTAG
, 0,

837 
NPC_LT_LB_STAG_QINQ
 & 
NPC_LT_LB_CTAG
, 0, 
ötf
);

840 i‡(
˘ag
)

841 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LB
, 
íåy
, 
NPC_LT_LB_CTAG
, 0,

842 ~0ULL, 0, 
ötf
);

843 i‡(
°ag
)

844 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LB
, 
íåy
, 
NPC_LT_LB_STAG_QINQ
, 0,

845 ~0ULL, 0, 
ötf
);

846 
	}
}

848 
	$≈c_upd©e_Êow
(
rvu
 *rvu, 
mˇm_íåy
 *
íåy
,

849 
u64
 
„©uªs
, 
Êow_msg
 *
pkt
,

850 
Êow_msg
 *
mask
,

851 
rvu_≈c_mˇm_ruÀ
 *
ouçut
, 
u8
 
ötf
,

852 
blkaddr
)

854 
u64
 
dmac_mask
 = 
	`ëhî_addr_to_u64
(
mask
->
dmac
);

855 
u64
 
smac_mask
 = 
	`ëhî_addr_to_u64
(
mask
->
smac
);

856 
u64
 
dmac_vÆ
 = 
	`ëhî_addr_to_u64
(
pkt
->
dmac
);

857 
u64
 
smac_vÆ
 = 
	`ëhî_addr_to_u64
(
pkt
->
smac
);

858 
Êow_msg
 *
›kt
 = &
ouçut
->
∑ckë
;

859 
Êow_msg
 *
omask
 = &
ouçut
->
mask
;

861 i‡(!
„©uªs
)

865 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_IPPROTO_TCP
))

866 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LD
, 
íåy
, 
NPC_LT_LD_TCP
,

867 0, ~0ULL, 0, 
ötf
);

868 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_IPPROTO_UDP
))

869 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LD
, 
íåy
, 
NPC_LT_LD_UDP
,

870 0, ~0ULL, 0, 
ötf
);

871 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_IPPROTO_SCTP
))

872 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LD
, 
íåy
, 
NPC_LT_LD_SCTP
,

873 0, ~0ULL, 0, 
ötf
);

874 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_IPPROTO_ICMP
))

875 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LD
, 
íåy
, 
NPC_LT_LD_ICMP
,

876 0, ~0ULL, 0, 
ötf
);

877 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_IPPROTO_ICMP6
))

878 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LD
, 
íåy
, 
NPC_LT_LD_ICMP6
,

879 0, ~0ULL, 0, 
ötf
);

881 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_FDSA_VAL
))

882 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LB
, 
íåy
, 
NPC_LT_LB_FDSA
,

883 0, ~0ULL, 0, 
ötf
);

886 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_IPPROTO_AH
))

887 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LD
, 
íåy
, 
NPC_LT_LD_AH
,

888 0, ~0ULL, 0, 
ötf
);

890 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_IPPROTO_ESP
))

891 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LE
, 
íåy
, 
NPC_LT_LE_ESP
,

892 0, ~0ULL, 0, 
ötf
);

894 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_LXMB
)) {

895 
ouçut
->
lxmb
 = 
	`is_brﬂdˇ°_ëhî_addr
(
pkt
->
dmac
) ? 2 : 1;

896 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LXMB
, 
íåy
, 
ouçut
->
lxmb
, 0,

897 
ouçut
->
lxmb
, 0, 
ötf
);

899 
	#NPC_WRITE_FLOW
(
fõld
, 
membî
, 
vÆ_lo
, 
vÆ_hi
, 
mask_lo
, 
mask_hi
) \

901 i‡(
„©uªs
 & 
	`BIT_ULL
((
fõld
))) { \

902 
	`≈c_upd©e_íåy
(
rvu
, (
fõld
), 
íåy
, (
vÆ_lo
), (
vÆ_hi
), \

903 (
mask_lo
), (
mask_hi
), 
ötf
); \

904 
	`mem˝y
(&
›kt
->
membî
, &
pkt
->member, (pkt->member)); \

905 
	`mem˝y
(&
omask
->
membî
, &
mask
->member, (mask->member)); \

907 } 0)

	)

909 
	`NPC_WRITE_FLOW
(
NPC_DMAC
, 
dmac
, 
dmac_vÆ
, 0, 
dmac_mask
, 0);

911 
	`NPC_WRITE_FLOW
(
NPC_SMAC
, 
smac
, 
smac_vÆ
, 0, 
smac_mask
, 0);

912 
	`NPC_WRITE_FLOW
(
NPC_ETYPE
, 
ëy≥
, 
	`¡ohs
(
pkt
->etype), 0,

913 
	`¡ohs
(
mask
->
ëy≥
), 0);

914 
	`NPC_WRITE_FLOW
(
NPC_TOS
, 
tos
, 
pkt
->tos, 0, 
mask
->tos, 0);

915 
	`NPC_WRITE_FLOW
(
NPC_IPFRAG_IPV4
, 
ù_Êag
, 
pkt
->ip_flag, 0,

916 
mask
->
ù_Êag
, 0);

917 
	`NPC_WRITE_FLOW
(
NPC_SIP_IPV4
, 
ù4§c
, 
	`¡ohl
(
pkt
->ip4src), 0,

918 
	`¡ohl
(
mask
->
ù4§c
), 0);

919 
	`NPC_WRITE_FLOW
(
NPC_DIP_IPV4
, 
ù4d°
, 
	`¡ohl
(
pkt
->ip4dst), 0,

920 
	`¡ohl
(
mask
->
ù4d°
), 0);

921 
	`NPC_WRITE_FLOW
(
NPC_SPORT_TCP
, 
•‹t
, 
	`¡ohs
(
pkt
->sport), 0,

922 
	`¡ohs
(
mask
->
•‹t
), 0);

923 
	`NPC_WRITE_FLOW
(
NPC_SPORT_UDP
, 
•‹t
, 
	`¡ohs
(
pkt
->sport), 0,

924 
	`¡ohs
(
mask
->
•‹t
), 0);

925 
	`NPC_WRITE_FLOW
(
NPC_DPORT_TCP
, 
dp‹t
, 
	`¡ohs
(
pkt
->dport), 0,

926 
	`¡ohs
(
mask
->
dp‹t
), 0);

927 
	`NPC_WRITE_FLOW
(
NPC_DPORT_UDP
, 
dp‹t
, 
	`¡ohs
(
pkt
->dport), 0,

928 
	`¡ohs
(
mask
->
dp‹t
), 0);

929 
	`NPC_WRITE_FLOW
(
NPC_SPORT_SCTP
, 
•‹t
, 
	`¡ohs
(
pkt
->sport), 0,

930 
	`¡ohs
(
mask
->
•‹t
), 0);

931 
	`NPC_WRITE_FLOW
(
NPC_DPORT_SCTP
, 
dp‹t
, 
	`¡ohs
(
pkt
->dport), 0,

932 
	`¡ohs
(
mask
->
dp‹t
), 0);

934 
	`NPC_WRITE_FLOW
(
NPC_OUTER_VID
, 
vœn_tci
, 
	`¡ohs
(
pkt
->vlan_tci), 0,

935 
	`¡ohs
(
mask
->
vœn_tci
), 0);

936 
	`NPC_WRITE_FLOW
(
NPC_FDSA_VAL
, 
vœn_tci
, 
	`¡ohs
(
pkt
->vlan_tci), 0,

937 
	`¡ohs
(
mask
->
vœn_tci
), 0);

939 
	`NPC_WRITE_FLOW
(
NPC_IPFRAG_IPV6
, 
√xt_hódî
, 
pkt
->next_header, 0,

940 
mask
->
√xt_hódî
, 0);

941 
	`≈c_upd©e_ùv6_Êow
(
rvu
, 
íåy
, 
„©uªs
, 
pkt
, 
mask
, 
ouçut
, 
ötf
);

942 
	`≈c_upd©e_vœn_„©uªs
(
rvu
, 
íåy
, 
„©uªs
, 
ötf
);

944 
	`≈c_upd©e_fõld_hash
(
rvu
, 
ötf
, 
íåy
, 
blkaddr
, 
„©uªs
,

945 
pkt
, 
mask
, 
›kt
, 
omask
);

946 
	}
}

948 
rvu_≈c_mˇm_ruÀ
 *
	$rvu_mˇm_föd_ruÀ
(
≈c_mˇm
 *
mˇm
, 
u16
 
íåy
)

950 
rvu_≈c_mˇm_ruÀ
 *
ôî
;

952 
	`muãx_lock
(&
mˇm
->
lock
);

953 
	`li°_f‹_óch_íåy
(
ôî
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

954 i‡(
ôî
->
íåy
 ==Éntry) {

955 
	`muãx_u∆ock
(&
mˇm
->
lock
);

956  
ôî
;

959 
	`muãx_u∆ock
(&
mˇm
->
lock
);

961  
NULL
;

962 
	}
}

964 
	$rvu_mˇm_add_ruÀ
(
≈c_mˇm
 *
mˇm
,

965 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
)

967 
li°_hód
 *
hód
 = &
mˇm
->
mˇm_ruÀs
;

968 
rvu_≈c_mˇm_ruÀ
 *
ôî
;

970 
	`muãx_lock
(&
mˇm
->
lock
);

971 
	`li°_f‹_óch_íåy
(
ôî
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

972 i‡(
ôî
->
íåy
 > 
ruÀ
->entry)

974 
hód
 = &
ôî
->
li°
;

977 
	`li°_add
(&
ruÀ
->
li°
, 
hód
);

978 
	`muãx_u∆ock
(&
mˇm
->
lock
);

979 
	}
}

981 
	$rvu_mˇm_ªmove_cou¡î_‰om_ruÀ
(
rvu
 *rvu, 
u16
 
pcifunc
,

982 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
)

984 
≈c_mˇm_›î_cou¡î_ªq
 
‰ì_ªq
 = { 0 };

985 
msg_r•
 
‰ì_r•
;

987 i‡(!
ruÀ
->
has_˙å
)

990 
‰ì_ªq
.
hdr
.
pcifunc
 =Öcifunc;

991 
‰ì_ªq
.
˙å
 = 
ruÀ
->cntr;

993 
	`rvu_mbox_h™dÀr_≈c_mˇm_‰ì_cou¡î
(
rvu
, &
‰ì_ªq
, &
‰ì_r•
);

994 
ruÀ
->
has_˙å
 = 
Ál£
;

995 
	}
}

997 
	$rvu_mˇm_add_cou¡î_to_ruÀ
(
rvu
 *rvu, 
u16
 
pcifunc
,

998 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
,

999 
≈c_ö°Æl_Êow_r•
 *
r•
)

1001 
≈c_mˇm_Æloc_cou¡î_ªq
 
˙å_ªq
 = { 0 };

1002 
≈c_mˇm_Æloc_cou¡î_r•
 
˙å_r•
 = { 0 };

1003 
îr
;

1005 
˙å_ªq
.
hdr
.
pcifunc
 =Öcifunc;

1006 
˙å_ªq
.
c⁄tig
 = 
åue
;

1007 
˙å_ªq
.
cou¡
 = 1;

1013 
îr
 = 
	`rvu_mbox_h™dÀr_≈c_mˇm_Æloc_cou¡î
(
rvu
, &
˙å_ªq
,

1014 &
˙å_r•
);

1015 i‡(!
îr
 && 
˙å_r•
.
cou¡
) {

1016 
ruÀ
->
˙å
 = 
˙å_r•
.cntr;

1017 
ruÀ
->
has_˙å
 = 
åue
;

1018 
r•
->
cou¡î
 = 
ruÀ
->
˙å
;

1020 
r•
->
cou¡î
 = 
îr
;

1022 
	}
}

1024 
	$≈c_upd©e_rx_íåy
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
,

1025 
mˇm_íåy
 *
íåy
,

1026 
≈c_ö°Æl_Êow_ªq
 *
ªq
,

1027 
u16
 
èrgë
, 
boﬁ
 
pf_£t_vfs_mac
)

1029 
rvu_swôch
 *
rswôch
 = &
rvu
->rswitch;

1030 
nix_rx_a˘i⁄
 
a˘i⁄
;

1032 i‡(
rswôch
->
mode
 =
DEVLINK_ESWITCH_MODE_SWITCHDEV
 && 
pf_£t_vfs_mac
)

1033 
ªq
->
ch™_mask
 = 0x0;

1035 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_CHAN
, 
íåy
, 
ªq
->
ch™√l
, 0,Ñeq->
ch™_mask
,

1036 0, 
NIX_INTF_RX
);

1038 *(
u64
 *)&
a˘i⁄
 = 0x00;

1039 
a˘i⁄
.
pf_func
 = 
èrgë
;

1040 
a˘i⁄
.
›
 = 
ªq
->op;

1041 
a˘i⁄
.
ödex
 = 
ªq
->index;

1042 
a˘i⁄
.
m©ch_id
 = 
ªq
->match_id;

1043 
a˘i⁄
.
Êow_key_Æg
 = 
ªq
->flow_key_alg;

1045 i‡(
ªq
->
›
 =
NIX_RX_ACTION_DEFAULT
) {

1046 i‡(
pfvf
->
def_uˇ°_ruÀ
) {

1047 
a˘i⁄
 = 
pfvf
->
def_uˇ°_ruÀ
->
rx_a˘i⁄
;

1053 *(
u64
 *)&
a˘i⁄
 = 0;

1054 
a˘i⁄
.
pf_func
 = 
èrgë
;

1055 
a˘i⁄
.
›
 = 
NIX_RX_ACTIONOP_UCAST
;

1059 
íåy
->
a˘i⁄
 = *(
u64
 *)&action;

1064 
íåy
->
vèg_a˘i⁄
 = 
	`FIELD_PREP
(
RX_VTAG0_VALID_BIT
, 
ªq
->
vèg0_vÆid
) |

1065 
	`FIELD_PREP
(
RX_VTAG0_TYPE_MASK
, 
ªq
->
vèg0_ty≥
) |

1066 
	`FIELD_PREP
(
RX_VTAG0_LID_MASK
, 
NPC_LID_LB
) |

1067 
	`FIELD_PREP
(
RX_VTAG0_RELPTR_MASK
, 0) |

1068 
	`FIELD_PREP
(
RX_VTAG1_VALID_BIT
, 
ªq
->
vèg1_vÆid
) |

1069 
	`FIELD_PREP
(
RX_VTAG1_TYPE_MASK
, 
ªq
->
vèg1_ty≥
) |

1070 
	`FIELD_PREP
(
RX_VTAG1_LID_MASK
, 
NPC_LID_LB
) |

1071 
	`FIELD_PREP
(
RX_VTAG1_RELPTR_MASK
, 4);

1072 
	}
}

1074 
	$≈c_upd©e_tx_íåy
(
rvu
 *rvu, 
rvu_pfvf
 *
pfvf
,

1075 
mˇm_íåy
 *
íåy
,

1076 
≈c_ö°Æl_Êow_ªq
 *
ªq
, 
u16
 
èrgë
)

1078 
nix_tx_a˘i⁄
 
a˘i⁄
;

1079 
u64
 
mask
 = ~0ULL;

1084 i‡(
	`is_pffunc_af
(
ªq
->
hdr
.
pcifunc
))

1085 
mask
 = 0;

1087 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_PF_FUNC
, 
íåy
, (
__f‹˚
 
u16
)
	`ht⁄s
(
èrgë
),

1088 0, 
mask
, 0, 
NIX_INTF_TX
);

1090 *(
u64
 *)&
a˘i⁄
 = 0x00;

1091 
a˘i⁄
.
›
 = 
ªq
->op;

1092 
a˘i⁄
.
ödex
 = 
ªq
->index;

1093 
a˘i⁄
.
m©ch_id
 = 
ªq
->match_id;

1095 
íåy
->
a˘i⁄
 = *(
u64
 *)&action;

1100 
íåy
->
vèg_a˘i⁄
 = 
	`FIELD_PREP
(
TX_VTAG0_DEF_MASK
, 
ªq
->
vèg0_def
) |

1101 
	`FIELD_PREP
(
TX_VTAG0_OP_MASK
, 
ªq
->
vèg0_›
) |

1102 
	`FIELD_PREP
(
TX_VTAG0_LID_MASK
, 
NPC_LID_LA
) |

1103 
	`FIELD_PREP
(
TX_VTAG0_RELPTR_MASK
, 20) |

1104 
	`FIELD_PREP
(
TX_VTAG1_DEF_MASK
, 
ªq
->
vèg1_def
) |

1105 
	`FIELD_PREP
(
TX_VTAG1_OP_MASK
, 
ªq
->
vèg1_›
) |

1106 
	`FIELD_PREP
(
TX_VTAG1_LID_MASK
, 
NPC_LID_LA
) |

1107 
	`FIELD_PREP
(
TX_VTAG1_RELPTR_MASK
, 24);

1108 
	}
}

1110 
	$≈c_ö°Æl_Êow
(
rvu
 *rvu, 
blkaddr
, 
u16
 
èrgë
,

1111 
nixlf
, 
rvu_pfvf
 *
pfvf
,

1112 
≈c_ö°Æl_Êow_ªq
 *
ªq
,

1113 
≈c_ö°Æl_Êow_r•
 *
r•
, 
boﬁ
 
íabÀ
,

1114 
boﬁ
 
pf_£t_vfs_mac
)

1116 
rvu_≈c_mˇm_ruÀ
 *
def_uˇ°_ruÀ
 = 
pfvf
->def_ucast_rule;

1117 
u64
 
„©uªs
, 
ö°ÆÀd_„©uªs
, 
missög_„©uªs
 = 0;

1118 
≈c_mˇm_wrôe_íåy_ªq
 
wrôe_ªq
 = { 0 };

1119 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1120 
rvu_≈c_mˇm_ruÀ
 
dummy
 = { 0 };

1121 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
;

1122 
u16
 
ow√r
 = 
ªq
->
hdr
.
pcifunc
;

1123 
msg_r•
 
wrôe_r•
;

1124 
mˇm_íåy
 *
íåy
;

1125 
boﬁ
 
√w
 = 
Ál£
;

1126 
u16
 
íåy_ödex
;

1127 
îr
;

1129 
ö°ÆÀd_„©uªs
 = 
ªq
->
„©uªs
;

1130 
„©uªs
 = 
ªq
->features;

1131 
íåy
 = &
wrôe_ªq
.
íåy_d©a
;

1132 
íåy_ödex
 = 
ªq
->
íåy
;

1134 
	`≈c_upd©e_Êow
(
rvu
, 
íåy
, 
„©uªs
, &
ªq
->
∑ckë
, &ªq->
mask
, &
dummy
,

1135 
ªq
->
ötf
, 
blkaddr
);

1137 i‡(
	`is_≈c_ötf_rx
(
ªq
->
ötf
))

1138 
	`≈c_upd©e_rx_íåy
(
rvu
, 
pfvf
, 
íåy
, 
ªq
, 
èrgë
, 
pf_£t_vfs_mac
);

1140 
	`≈c_upd©e_tx_íåy
(
rvu
, 
pfvf
, 
íåy
, 
ªq
, 
èrgë
);

1143 i‡(
	`is_≈c_ötf_tx
(
ªq
->
ötf
))

1144 
föd_ruÀ
;

1146 i‡(
ªq
->
deÁu…_ruÀ
) {

1147 
íåy_ödex
 = 
	`≈c_gë_nixlf_mˇm_ödex
(
mˇm
, 
èrgë
, 
nixlf
,

1148 
NIXLF_UCAST_ENTRY
);

1149 
íabÀ
 = 
	`is_mˇm_íåy_íabÀd
(
rvu
, 
mˇm
, 
blkaddr
, 
íåy_ödex
);

1153 i‡(
def_uˇ°_ruÀ
 && (
ªq
->
deÁu…_ruÀ
 &&Ñeq->
≠≥nd
)) {

1154 
missög_„©uªs
 = (
def_uˇ°_ruÀ
->
„©uªs
 ^ features) &

1155 
def_uˇ°_ruÀ
->
„©uªs
;

1156 i‡(
missög_„©uªs
)

1157 
	`≈c_upd©e_Êow
(
rvu
, 
íåy
, 
missög_„©uªs
,

1158 &
def_uˇ°_ruÀ
->
∑ckë
,

1159 &
def_uˇ°_ruÀ
->
mask
,

1160 &
dummy
, 
ªq
->
ötf
,

1161 
blkaddr
);

1162 
ö°ÆÀd_„©uªs
 = 
ªq
->
„©uªs
 | 
missög_„©uªs
;

1164 
föd_ruÀ
:

1165 
ruÀ
 = 
	`rvu_mˇm_föd_ruÀ
(
mˇm
, 
íåy_ödex
);

1166 i‡(!
ruÀ
) {

1167 
ruÀ
 = 
	`kzÆloc
((*ruÀ), 
GFP_KERNEL
);

1168 i‡(!
ruÀ
)

1169  -
ENOMEM
;

1170 
√w
 = 
åue
;

1174 i‡(!
ªq
->
deÁu…_ruÀ
 &&Ñeq->
£t_˙å
 && !
ruÀ
->
has_˙å
)

1175 
	`rvu_mˇm_add_cou¡î_to_ruÀ
(
rvu
, 
ow√r
, 
ruÀ
, 
r•
);

1180 i‡(!
ªq
->
£t_˙å
 && 
ruÀ
->
has_˙å
)

1181 
	`rvu_mˇm_ªmove_cou¡î_‰om_ruÀ
(
rvu
, 
ow√r
, 
ruÀ
);

1183 
wrôe_ªq
.
hdr
.
pcifunc
 = 
ow√r
;

1188 i‡(
ªq
->
deÁu…_ruÀ
)

1189 
wrôe_ªq
.
hdr
.
pcifunc
 = 0;

1191 
wrôe_ªq
.
íåy
 = 
íåy_ödex
;

1192 
wrôe_ªq
.
ötf
 = 
ªq
->intf;

1193 
wrôe_ªq
.
íabÀ_íåy
 = (
u8
)
íabÀ
;

1195 i‡(
ªq
->
£t_˙å
 && 
ruÀ
->
has_˙å
) {

1196 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_MATCH_STATX
(
ruÀ
->
˙å
), 0x00);

1197 
wrôe_ªq
.
£t_˙å
 = 1;

1198 
wrôe_ªq
.
˙å
 = 
ruÀ
->cntr;

1202 
	`mem˝y
(&
ruÀ
->
∑ckë
, &
dummy
.packet, (rule->packet));

1203 
	`mem˝y
(&
ruÀ
->
mask
, &
dummy
.mask, (rule->mask));

1204 
ruÀ
->
íåy
 = 
íåy_ödex
;

1205 
	`mem˝y
(&
ruÀ
->
rx_a˘i⁄
, &
íåy
->
a˘i⁄
, (
nix_rx_a˘i⁄
));

1206 i‡(
	`is_≈c_ötf_tx
(
ªq
->
ötf
))

1207 
	`mem˝y
(&
ruÀ
->
tx_a˘i⁄
, &
íåy
->
a˘i⁄
,

1208 (
nix_tx_a˘i⁄
));

1209 
ruÀ
->
vèg_a˘i⁄
 = 
íåy
->vtag_action;

1210 
ruÀ
->
„©uªs
 = 
ö°ÆÀd_„©uªs
;

1211 
ruÀ
->
deÁu…_ruÀ
 = 
ªq
->default_rule;

1212 
ruÀ
->
ow√r
 = owner;

1213 
ruÀ
->
íabÀ
 =Énable;

1214 
ruÀ
->
ch™_mask
 = 
wrôe_ªq
.
íåy_d©a
.
kw_mask
[0] & 
NPC_KEX_CHAN_MASK
;

1215 
ruÀ
->
ch™
 = 
wrôe_ªq
.
íåy_d©a
.
kw
[0] & 
NPC_KEX_CHAN_MASK
;

1216 
ruÀ
->
ch™
 &ruÀ->
ch™_mask
;

1217 
ruÀ
->
lxmb
 = 
dummy
.lxmb;

1218 i‡(
	`is_≈c_ötf_tx
(
ªq
->
ötf
))

1219 
ruÀ
->
ötf
 = 
pfvf
->
nix_tx_ötf
;

1221 
ruÀ
->
ötf
 = 
pfvf
->
nix_rx_ötf
;

1223 i‡(
√w
)

1224 
	`rvu_mˇm_add_ruÀ
(
mˇm
, 
ruÀ
);

1225 i‡(
ªq
->
deÁu…_ruÀ
)

1226 
pfvf
->
def_uˇ°_ruÀ
 = 
ruÀ
;

1229 
îr
 = 
	`rvu_mbox_h™dÀr_≈c_mˇm_wrôe_íåy
(
rvu
, &
wrôe_ªq
,

1230 &
wrôe_r•
);

1231 i‡(
îr
) {

1232 
	`rvu_mˇm_ªmove_cou¡î_‰om_ruÀ
(
rvu
, 
ow√r
, 
ruÀ
);

1233 i‡(
√w
) {

1234 
	`li°_dñ
(&
ruÀ
->
li°
);

1235 
	`k‰ì
(
ruÀ
);

1237  
îr
;

1241 i‡(
pf_£t_vfs_mac
) {

1242 
	`ëhî_addr_c›y
(
pfvf
->
deÁu…_mac
, 
ªq
->
∑ckë
.
dmac
);

1243 
	`ëhî_addr_c›y
(
pfvf
->
mac_addr
, 
ªq
->
∑ckë
.
dmac
);

1244 
	`£t_bô
(
PF_SET_VF_MAC
, &
pfvf
->
Êags
);

1247 i‡(
	`ã°_bô
(
PF_SET_VF_CFG
, &
pfvf
->
Êags
) &&

1248 
ªq
->
vèg0_ty≥
 =
NIX_AF_LFX_RX_VTAG_TYPE7
)

1249 
ruÀ
->
vfvœn_cfg
 = 
åue
;

1251 i‡(
	`is_≈c_ötf_rx
(
ªq
->
ötf
Ë&&Ñeq->
m©ch_id
 &&

1252 (
ªq
->
›
 =
NIX_RX_ACTIONOP_UCAST
 ||Ñeq->› =
NIX_RX_ACTIONOP_RSS
))

1253  
	`rvu_nix_£tup_øãlimô_aggr
(
rvu
, 
ªq
->
hdr
.
pcifunc
,

1254 
ªq
->
ödex
,Ñeq->
m©ch_id
);

1256 
	}
}

1258 
	$rvu_mbox_h™dÀr_≈c_ö°Æl_Êow
(
rvu
 *rvu,

1259 
≈c_ö°Æl_Êow_ªq
 *
ªq
,

1260 
≈c_ö°Æl_Êow_r•
 *
r•
)

1262 
boﬁ
 
‰om_vf
 = !!(
ªq
->
hdr
.
pcifunc
 & 
RVU_PFVF_FUNC_MASK
);

1263 
rvu_swôch
 *
rswôch
 = &
rvu
->rswitch;

1264 
blkaddr
, 
nixlf
, 
îr
;

1265 
rvu_pfvf
 *
pfvf
;

1266 
boﬁ
 
pf_£t_vfs_mac
 = 
Ál£
;

1267 
boﬁ
 
íabÀ
 = 
åue
;

1268 
u16
 
èrgë
;

1270 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1271 i‡(
blkaddr
 < 0) {

1272 
	`dev_îr
(
rvu
->
dev
, "%s: NPC blockÇŸ im∂emíãd\n", 
__func__
);

1273  
NPC_MCAM_INVALID_REQ
;

1276 i‡(!
	`is_≈c_öãrÁ˚_vÆid
(
rvu
, 
ªq
->
ötf
))

1277  
NPC_FLOW_INTF_INVALID
;

1283 i‡(
	`≈c_check_fõld
(
rvu
, 
blkaddr
, 
NPC_DMAC
, 
ªq
->
ötf
))

1284 
¥o˚ss_Êow
;

1286 i‡(
	`is_pffunc_af
(
ªq
->
hdr
.
pcifunc
) &&

1287 
ªq
->
„©uªs
 & 
	`BIT_ULL
(
NPC_DMAC
)) {

1288 i‡(
	`is_uniˇ°_ëhî_addr
(
ªq
->
∑ckë
.
dmac
)) {

1289 
	`dev_w¨n
(
rvu
->
dev
,

1291 
__func__
);

1292  
NPC_FLOW_NOT_SUPPORTED
;

1295 i‡(!
	`≈c_is_fõld_¥e£¡
(
rvu
, 
NPC_LXMB
, 
ªq
->
ötf
)) {

1296 
	`dev_w¨n
(
rvu
->
dev
,

1298 
__func__
);

1299  
NPC_FLOW_NOT_SUPPORTED
;

1303 
ªq
->
„©uªs
 &~
	`BIT_ULL
(
NPC_DMAC
);

1304 
ªq
->
„©uªs
 |
	`BIT_ULL
(
NPC_LXMB
);

1307 
¥o˚ss_Êow
:

1308 i‡(
‰om_vf
 && 
ªq
->
deÁu…_ruÀ
)

1309  
NPC_FLOW_VF_PERM_DENIED
;

1317 i‡(!
ªq
->
hdr
.
pcifunc
)

1318 
èrgë
 = 
ªq
->
vf
;

1320 i‡(!
‰om_vf
 && 
ªq
->
vf
) {

1321 
èrgë
 = (
ªq
->
hdr
.
pcifunc
 & ~
RVU_PFVF_FUNC_MASK
Ë|Ñeq->
vf
;

1322 
pf_£t_vfs_mac
 = 
ªq
->
deÁu…_ruÀ
 &&

1323 (
ªq
->
„©uªs
 & 
	`BIT_ULL
(
NPC_DMAC
));

1327 
èrgë
 = 
ªq
->
hdr
.
pcifunc
;

1330 i‡(!
	`is_pffunc_af
(
ªq
->
hdr
.
pcifunc
))

1331 
ªq
->
ch™_mask
 = 
	`rvu_gë_˝t_ch™_mask
(
rvu
);

1333 
îr
 = 
	`≈c_check_unsuµ‹ãd_Êows
(
rvu
, 
ªq
->
„©uªs
,Ñeq->
ötf
);

1334 i‡(
îr
)

1335  
NPC_FLOW_NOT_SUPPORTED
;

1337 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
èrgë
);

1340 i‡(
ªq
->
hdr
.
pcifunc
 && !
‰om_vf
 &&Ñeq->
vf
)

1341 
	`£t_bô
(
PF_SET_VF_CFG
, &
pfvf
->
Êags
);

1344 i‡((
ªq
->
„©uªs
 & 
	`BIT_ULL
(
NPC_DMAC
)Ë&& 
	`is_≈c_ötf_rx
‘eq->
ötf
) &&

1345 
	`is_zîo_ëhî_addr
(
ªq
->
∑ckë
.
dmac
)) {

1346 
	`ëhî_addr_c›y
(
ªq
->
∑ckë
.
dmac
, 
pfvf
->
mac_addr
);

1347 
	`ëh_brﬂdˇ°_addr
((
u8
 *)&
ªq
->
mask
.
dmac
);

1351 
îr
 = 
	`nix_gë_nixlf
(
rvu
, 
èrgë
, &
nixlf
, 
NULL
);

1352 i‡(
îr
 && 
	`is_≈c_ötf_rx
(
ªq
->
ötf
Ë&& !
pf_£t_vfs_mac
)

1353  
NPC_FLOW_NO_NIXLF
;

1356 i‡(!(
	`is_nixlf_©èched
(
rvu
, 
èrgë
) &&

1357 
	`ã°_bô
(
NIXLF_INITIALIZED
, &
pfvf
->
Êags
)))

1358 
íabÀ
 = 
Ál£
;

1364 i‡(
	`is_≈c_ötf_tx
(
ªq
->
ötf
))

1365 
íabÀ
 = 
åue
;

1368 i‡(
‰om_vf
 && !
íabÀ
)

1369  
NPC_FLOW_VF_NOT_INIT
;

1372 i‡(
pf_£t_vfs_mac
 && !
íabÀ
) {

1373 
	`ëhî_addr_c›y
(
pfvf
->
deÁu…_mac
, 
ªq
->
∑ckë
.
dmac
);

1374 
	`ëhî_addr_c›y
(
pfvf
->
mac_addr
, 
ªq
->
∑ckë
.
dmac
);

1375 
	`£t_bô
(
PF_SET_VF_MAC
, &
pfvf
->
Êags
);

1379 
	`muãx_lock
(&
rswôch
->
swôch_lock
);

1380 
îr
 = 
	`≈c_ö°Æl_Êow
(
rvu
, 
blkaddr
, 
èrgë
, 
nixlf
, 
pfvf
,

1381 
ªq
, 
r•
, 
íabÀ
, 
pf_£t_vfs_mac
);

1382 
	`muãx_u∆ock
(&
rswôch
->
swôch_lock
);

1384  
îr
;

1385 
	}
}

1387 
	$≈c_dñëe_Êow
(
rvu
 *rvu, 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
,

1388 
u16
 
pcifunc
)

1390 
≈c_mˇm_ía_dis_íåy_ªq
 
dis_ªq
 = { 0 };

1391 
msg_r•
 
dis_r•
;

1393 i‡(
ruÀ
->
deÁu…_ruÀ
)

1396 i‡(
ruÀ
->
has_˙å
)

1397 
	`rvu_mˇm_ªmove_cou¡î_‰om_ruÀ
(
rvu
, 
pcifunc
, 
ruÀ
);

1399 
dis_ªq
.
hdr
.
pcifunc
 =Öcifunc;

1400 
dis_ªq
.
íåy
 = 
ruÀ
->entry;

1402 
	`li°_dñ
(&
ruÀ
->
li°
);

1403 
	`k‰ì
(
ruÀ
);

1405  
	`rvu_mbox_h™dÀr_≈c_mˇm_dis_íåy
(
rvu
, &
dis_ªq
, &
dis_r•
);

1406 
	}
}

1408 
	$rvu_mbox_h™dÀr_≈c_dñëe_Êow
(
rvu
 *rvu,

1409 
≈c_dñëe_Êow_ªq
 *
ªq
,

1410 
msg_r•
 *
r•
)

1412 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1413 
rvu_≈c_mˇm_ruÀ
 *
ôî
, *
tmp
;

1414 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1415 
li°_hód
 
dñ_li°
;

1417 
	`INIT_LIST_HEAD
(&
dñ_li°
);

1419 
	`muãx_lock
(&
mˇm
->
lock
);

1420 
	`li°_f‹_óch_íåy_ß„
(
ôî
, 
tmp
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

1421 i‡(
ôî
->
ow√r
 =
pcifunc
) {

1423 i‡(
ªq
->
Æl
) {

1424 
	`li°_move_èû
(&
ôî
->
li°
, &
dñ_li°
);

1426 } i‡(
ªq
->
íd
 && 
ôî
->
íåy
 >ªq->
°¨t
 &&

1427 
ôî
->
íåy
 <
ªq
->
íd
) {

1428 
	`li°_move_èû
(&
ôî
->
li°
, &
dñ_li°
);

1430 } i‡(
ªq
->
íåy
 =
ôî
->entry) {

1431 
	`li°_move_èû
(&
ôî
->
li°
, &
dñ_li°
);

1436 
	`muãx_u∆ock
(&
mˇm
->
lock
);

1438 
	`li°_f‹_óch_íåy_ß„
(
ôî
, 
tmp
, &
dñ_li°
, 
li°
) {

1439 
u16
 
íåy
 = 
ôî
->entry;

1442 
mˇm
->
íåy2èrgë_pffunc
[
íåy
] = 0x0;

1443 i‡(
	`≈c_dñëe_Êow
(
rvu
, 
ôî
, 
pcifunc
))

1444 
	`dev_îr
(
rvu
->
dev
, "rule deletion failed forÉntry:%u",

1445 
íåy
);

1449 
	}
}

1451 
	$≈c_upd©e_dmac_vÆue
(
rvu
 *rvu, 
≈cblkaddr
,

1452 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
,

1453 
rvu_pfvf
 *
pfvf
)

1455 
≈c_mˇm_wrôe_íåy_ªq
 
wrôe_ªq
 = { 0 };

1456 
mˇm_íåy
 *
íåy
 = &
wrôe_ªq
.
íåy_d©a
;

1457 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1458 
msg_r•
 
r•
;

1459 
u8
 
ötf
, 
íabÀ
;

1460 
îr
;

1462 
	`ëhî_addr_c›y
(
ruÀ
->
∑ckë
.
dmac
, 
pfvf
->
mac_addr
);

1464 
	`≈c_ªad_mˇm_íåy
(
rvu
, 
mˇm
, 
≈cblkaddr
, 
ruÀ
->
íåy
,

1465 
íåy
, &
ötf
, &
íabÀ
);

1467 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_DMAC
, 
íåy
,

1468 
	`ëhî_addr_to_u64
(
pfvf
->
mac_addr
), 0,

1469 0xffffffffffffuŒ, 0, 
ötf
);

1471 
wrôe_ªq
.
hdr
.
pcifunc
 = 
ruÀ
->
ow√r
;

1472 
wrôe_ªq
.
íåy
 = 
ruÀ
->entry;

1473 
wrôe_ªq
.
ötf
 = 
pfvf
->
nix_rx_ötf
;

1475 
	`muãx_u∆ock
(&
mˇm
->
lock
);

1476 
îr
 = 
	`rvu_mbox_h™dÀr_≈c_mˇm_wrôe_íåy
(
rvu
, &
wrôe_ªq
, &
r•
);

1477 
	`muãx_lock
(&
mˇm
->
lock
);

1479  
îr
;

1480 
	}
}

1482 
	$≈c_mˇm_íabÀ_Êows
(
rvu
 *rvu, 
u16
 
èrgë
)

1484 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
èrgë
);

1485 
rvu_≈c_mˇm_ruÀ
 *
def_uˇ°_ruÀ
;

1486 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1487 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
;

1488 
blkaddr
, 
b™k
, 
ödex
;

1489 
u64
 
def_a˘i⁄
;

1491 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1492 i‡(
blkaddr
 < 0)

1495 
def_uˇ°_ruÀ
 = 
pfvf
->def_ucast_rule;

1497 
	`muãx_lock
(&
mˇm
->
lock
);

1498 
	`li°_f‹_óch_íåy
(
ruÀ
, &
mˇm
->
mˇm_ruÀs
, 
li°
) {

1499 i‡(
	`is_≈c_ötf_rx
(
ruÀ
->
ötf
) &&

1500 
ruÀ
->
rx_a˘i⁄
.
pf_func
 =
èrgë
 && !ruÀ->
íabÀ
) {

1501 i‡(
ruÀ
->
deÁu…_ruÀ
) {

1502 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
,

1503 
ruÀ
->
íåy
, 
åue
);

1504 
ruÀ
->
íabÀ
 = 
åue
;

1508 i‡(
ruÀ
->
vfvœn_cfg
)

1509 
	`≈c_upd©e_dmac_vÆue
(
rvu
, 
blkaddr
, 
ruÀ
, 
pfvf
);

1511 i‡(
ruÀ
->
rx_a˘i⁄
.
›
 =
NIX_RX_ACTION_DEFAULT
) {

1512 i‡(!
def_uˇ°_ruÀ
)

1515 
ruÀ
->
rx_a˘i⁄
 = 
def_uˇ°_ruÀ
->rx_action;

1516 
def_a˘i⁄
 = *(
u64
 *)&
def_uˇ°_ruÀ
->
rx_a˘i⁄
;

1517 
b™k
 = 
	`≈c_gë_b™k
(
mˇm
, 
ruÀ
->
íåy
);

1518 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1519 
NPC_AF_MCAMEX_BANKX_ACTION


1520 (
ruÀ
->
íåy
, 
b™k
), 
def_a˘i⁄
);

1523 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
,

1524 
ruÀ
->
íåy
, 
åue
);

1525 
ruÀ
->
íabÀ
 = 
åue
;

1530 
ödex
 = 0; index < 
mˇm
->
bm≠_íåõs
; index++) {

1531 i‡(
mˇm
->
íåy2èrgë_pffunc
[
ödex
] =
èrgë
)

1532 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
,

1533 
ödex
, 
åue
);

1535 
	`muãx_u∆ock
(&
mˇm
->
lock
);

1536 
	}
}

1538 
	$≈c_mˇm_dißbÀ_Êows
(
rvu
 *rvu, 
u16
 
èrgë
)

1540 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1541 
blkaddr
, 
ödex
;

1543 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1544 i‡(
blkaddr
 < 0)

1547 
	`muãx_lock
(&
mˇm
->
lock
);

1549 
ödex
 = 0; index < 
mˇm
->
bm≠_íåõs
; index++) {

1550 i‡(
mˇm
->
íåy2èrgë_pffunc
[
ödex
] =
èrgë
)

1551 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
,

1552 
ödex
, 
Ál£
);

1554 
	`muãx_u∆ock
(&
mˇm
->
lock
);

1555 
	}
}

1560 
	$≈c_ö°Æl_mˇm_dr›_ruÀ
(
rvu
 *rvu, 
mˇm_idx
, 
u16
 *
cou¡î_idx
,

1561 
u64
 
ch™_vÆ
, u64 
ch™_mask
, u64 
exa˘_vÆ
, u64 
exa˘_mask
,

1562 
u64
 
bˇ°_mˇ°_vÆ
, u64 
bˇ°_mˇ°_mask
)

1564 
≈c_mˇm_Æloc_cou¡î_ªq
 
˙å_ªq
 = { 0 };

1565 
≈c_mˇm_Æloc_cou¡î_r•
 
˙å_r•
 = { 0 };

1566 
≈c_mˇm_wrôe_íåy_ªq
 
ªq
 = { 0 };

1567 
≈c_mˇm
 *
mˇm
 = &
rvu
->
hw
->mcam;

1568 
rvu_≈c_mˇm_ruÀ
 *
ruÀ
;

1569 
msg_r•
 
r•
;

1570 
boﬁ
 
íabÀd
;

1571 
blkaddr
;

1572 
îr
;

1574 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1575 i‡(
blkaddr
 < 0) {

1576 
	`dev_îr
(
rvu
->
dev
, "%s: NPC blockÇŸ im∂emíãd\n", 
__func__
);

1577  -
ENODEV
;

1581 i‡(!
	`rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
)) {

1582 
	`dev_öfo
(
rvu
->
dev
, "%s: Nÿsuµ‹àf‹Éxa˘ m©ch fótuª\n", 
__func__
);

1583  -
EINVAL
;

1587 
íabÀd
 = 
	`is_mˇm_íåy_íabÀd
(
rvu
, 
mˇm
, 
blkaddr
, 
mˇm_idx
);

1588 i‡(
íabÀd
) {

1589 
	`dev_îr
(
rvu
->
dev
, "%s: failedÅoádd single drop onÇon hitÑuleát %dÅh index\n",

1590 
__func__
, 
mˇm_idx
);

1591  -
EINVAL
;

1595 
ruÀ
 = 
	`kzÆloc
((*ruÀ), 
GFP_KERNEL
);

1596 i‡(!
ruÀ
)

1597  -
ENOMEM
;

1602 
ruÀ
->
íabÀ
 = 
Ál£
;

1603 
ruÀ
->
ch™
 = 
ch™_vÆ
;

1604 
ruÀ
->
ch™_mask
 = chan_mask;

1605 
ruÀ
->
íåy
 = 
mˇm_idx
;

1606 
	`rvu_mˇm_add_ruÀ
(
mˇm
, 
ruÀ
);

1609 
	`≈c_mˇm_r§cs_ª£rve
(
rvu
, 
blkaddr
, 
mˇm_idx
);

1612 
˙å_ªq
.
hdr
.
pcifunc
 = 0;

1613 
˙å_ªq
.
c⁄tig
 = 
åue
;

1614 
˙å_ªq
.
cou¡
 = 1;

1615 
îr
 = 
	`rvu_mbox_h™dÀr_≈c_mˇm_Æloc_cou¡î
(
rvu
, &
˙å_ªq
, &
˙å_r•
);

1616 i‡(
îr
) {

1617 
	`dev_îr
(
rvu
->
dev
, "%s: ErrÅoállocate cntr for dropÑule (err=%d)\n",

1618 
__func__
, 
îr
);

1619  -
EFAULT
;

1621 *
cou¡î_idx
 = 
˙å_r•
.
˙å
;

1624 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_EXACT_RESULT
, &
ªq
.
íåy_d©a
, 
exa˘_vÆ
, 0,

1625 
exa˘_mask
, 0, 
NIX_INTF_RX
);

1626 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_CHAN
, &
ªq
.
íåy_d©a
, 
ch™_vÆ
, 0,

1627 
ch™_mask
, 0, 
NIX_INTF_RX
);

1628 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_LXMB
, &
ªq
.
íåy_d©a
, 
bˇ°_mˇ°_vÆ
, 0,

1629 
bˇ°_mˇ°_mask
, 0, 
NIX_INTF_RX
);

1631 
ªq
.
ötf
 = 
NIX_INTF_RX
;

1632 
ªq
.
£t_˙å
 = 
åue
;

1633 
ªq
.
˙å
 = 
˙å_r•
.cntr;

1634 
ªq
.
íåy
 = 
mˇm_idx
;

1636 
îr
 = 
	`rvu_mbox_h™dÀr_≈c_mˇm_wrôe_íåy
(
rvu
, &
ªq
, &
r•
);

1637 i‡(
îr
) {

1638 
	`dev_îr
(
rvu
->
dev
, "%s: Installation of single drop onÇon hitÑuleát %d failed\n",

1639 
__func__
, 
mˇm_idx
);

1640  
îr
;

1643 
	`dev_îr
(
rvu
->
dev
, "%s: Installed single drop onÇon hitÑuleát %d, cntr=%d\n",

1644 
__func__
, 
mˇm_idx
, 
ªq
.
˙å
);

1647 
	`≈c_íabÀ_mˇm_íåy
(
rvu
, 
mˇm
, 
blkaddr
, 
mˇm_idx
, 
Ál£
);

1650 
	}
}

1652 
	$rvu_mbox_h™dÀr_≈c_gë_fõld_°©us
(
rvu
 *rvu,

1653 
≈c_gë_fõld_°©us_ªq
 *
ªq
,

1654 
≈c_gë_fõld_°©us_r•
 *
r•
)

1656 
blkaddr
;

1658 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1659 i‡(
blkaddr
 < 0)

1660  
NPC_MCAM_INVALID_REQ
;

1662 i‡(!
	`is_≈c_öãrÁ˚_vÆid
(
rvu
, 
ªq
->
ötf
))

1663  
NPC_FLOW_INTF_INVALID
;

1665 i‡(
	`≈c_check_fõld
(
rvu
, 
blkaddr
, 
ªq
->
fõld
,Ñeq->
ötf
))

1666 
r•
->
íabÀ
 = 1;

1669 
	}
}

	@rvu_npc_fs.h

8 #i‚de‡
__RVU_NPC_FS_H


9 
	#__RVU_NPC_FS_H


	)

11 
	#IPV6_WORDS
 4

	)

13 
≈c_upd©e_íåy
(
rvu
 *rvu, 
key_fõlds
 
ty≥
,

14 
mˇm_íåy
 *
íåy
, 
u64
 
vÆ_lo
,

15 
u64
 
vÆ_hi
, u64 
mask_lo
, u64 
mask_hi
, 
u8
 
ötf
);

	@rvu_npc_hash.c

8 
	~<löux/bôfõld.h
>

9 
	~<löux/moduÀ.h
>

10 
	~<löux/pci.h
>

11 
	~<löux/fúmw¨e.h
>

12 
	~<löux/°ddef.h
>

13 
	~<löux/debugfs.h
>

15 
	~"rvu_°ru˘.h
"

16 
	~"rvu_ªg.h
"

17 
	~"rvu.h
"

18 
	~"≈c.h
"

19 
	~"cgx.h
"

20 
	~"rvu_≈c_hash.h
"

21 
	~"rvu_≈c_fs.h
"

22 
	~"rvu_≈c_hash.h
"

24 
u64
 
	$rvu_≈c_wide_exåa˘
(c⁄° 
u64
 
öput
[], 
size_t
 
°¨t_bô
,

25 
size_t
 
width_bôs
)

27 c⁄° 
u64
 
mask
 = ~(u64)((~(
__uöt128_t
)0Ë<< 
width_bôs
);

28 c⁄° 
size_t
 
msb
 = 
°¨t_bô
 + 
width_bôs
 - 1;

29 c⁄° 
size_t
 
lw‹d
 = 
°¨t_bô
 >> 6;

30 c⁄° 
size_t
 
uw‹d
 = 
msb
 >> 6;

31 
size_t
 
lbôs
;

32 
u64
 
hi
, 
lo
;

34 i‡(
lw‹d
 =
uw‹d
)

35  (
öput
[
lw‹d
] >> (
°¨t_bô
 & 63)Ë& 
mask
;

37 
lbôs
 = 64 - (
°¨t_bô
 & 63);

38 
hi
 = 
öput
[
uw‹d
];

39 
lo
 = (
öput
[
lw‹d
] >> (
°¨t_bô
 & 63));

40  ((
hi
 << 
lbôs
Ë| 
lo
Ë& 
mask
;

41 
	}
}

43 
	$rvu_≈c_lshi·_key
(
u64
 *
key
, 
size_t
 
key_bô_Àn
)

45 
u64
 
¥ev_‹ig_w‹d
 = 0;

46 
u64
 
cur_‹ig_w‹d
 = 0;

47 
size_t
 
exåa
 = 
key_bô_Àn
 % 64;

48 
size_t
 
max_idx
 = 
key_bô_Àn
 / 64;

49 
size_t
 
i
;

51 i‡(
exåa
)

52 
max_idx
++;

54 
i
 = 0; i < 
max_idx
; i++) {

55 
cur_‹ig_w‹d
 = 
key
[
i
];

56 
key
[
i
] = key[i] << 1;

57 
key
[
i
] |((
¥ev_‹ig_w‹d
 >> 63) & 0x1);

58 
¥ev_‹ig_w‹d
 = 
cur_‹ig_w‹d
;

60 
	}
}

62 
u32
 
	$rvu_≈c_t€∂ôz_hash
(c⁄° 
u64
 *
d©a
, u64 *
key
, 
size_t
 
d©a_bô_Àn
,

63 
size_t
 
key_bô_Àn
)

65 
u32
 
hash_out
 = 0;

66 
u64
 
ãmp_d©a
 = 0;

67 
i
;

69 
i
 = 
d©a_bô_Àn
 - 1; i >= 0; i--) {

70 
ãmp_d©a
 = (
d©a
[
i
 / 64]);

71 
ãmp_d©a
 =Åemp_d©®>> (
i
 % 64);

72 
ãmp_d©a
 &= 0x1;

73 i‡(
ãmp_d©a
)

74 
hash_out
 ^(
u32
)(
	`rvu_≈c_wide_exåa˘
(
key
, 
key_bô_Àn
 - 32, 32));

76 
	`rvu_≈c_lshi·_key
(
key
, 
key_bô_Àn
);

79  
hash_out
;

80 
	}
}

82 
u32
 
	$≈c_fõld_hash_ˇlc
(
u64
 *
ld©a
, 
≈c_mˇm_kex_hash
 *
mkex_hash
,

83 
u64
 *
£¸ë_key
, 
u8
 
ötf
, u8 
hash_idx
)

85 
u64
 
hash_key
[3];

86 
u64
 
d©a_∑dded
[2];

87 
u32
 
fõld_hash
;

89 
hash_key
[0] = 
£¸ë_key
[1] << 31;

90 
hash_key
[0] |
£¸ë_key
[2];

91 
hash_key
[1] = 
£¸ë_key
[1] >> 33;

92 
hash_key
[1] |
£¸ë_key
[0] << 31;

93 
hash_key
[2] = 
£¸ë_key
[0] >> 33;

95 
d©a_∑dded
[0] = 
mkex_hash
->
hash_mask
[
ötf
][
hash_idx
][0] & 
ld©a
[0];

96 
d©a_∑dded
[1] = 
mkex_hash
->
hash_mask
[
ötf
][
hash_idx
][1] & 
ld©a
[1];

97 
fõld_hash
 = 
	`rvu_≈c_t€∂ôz_hash
(
d©a_∑dded
, 
hash_key
, 128, 159);

99 
fõld_hash
 &
mkex_hash
->
hash_˘æ
[
ötf
][
hash_idx
] >> 32;

100 
fõld_hash
 |
mkex_hash
->
hash_˘æ
[
ötf
][
hash_idx
];

101  
fõld_hash
;

102 
	}
}

104 
u64
 
	$≈c_upd©e_u£_hash
(
…
, 
ld
)

106 
u64
 
cfg
 = 0;

108 
…
) {

109 
NPC_LT_LC_IP6
:

113 
cfg
 = 
	`KEX_LD_CFG_USE_HASH
(0x1, 0x03,

114 
ld
 ? 0x8 : 0x18,

119  
cfg
;

120 
	}
}

122 
	$≈c_¥ogøm_mkex_hash_rx
(
rvu
 *rvu, 
blkaddr
,

123 
u8
 
ötf
)

125 
≈c_mˇm_kex_hash
 *
mkex_hash
 = 
rvu
->
kpu
.mkex_hash;

126 
lid
, 
…
, 
ld
, 
hash_˙t
 = 0;

128 i‡(
	`is_≈c_ötf_tx
(
ötf
))

132 
lid
 = 0;Üid < 
NPC_MAX_LID
;Üid++) {

133 
…
 = 0;Üà< 
NPC_MAX_LT
;Üt++) {

134 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++) {

135 i‡(
mkex_hash
->
lid_…_ld_hash_í
[
ötf
][
lid
][
…
][
ld
]) {

136 
u64
 
cfg
 = 
	`≈c_upd©e_u£_hash
(
…
, 
ld
);

138 
hash_˙t
++;

139 i‡(
hash_˙t
 =
NPC_MAX_HASH
)

143 
	`SET_KEX_LD
(
ötf
, 
lid
, 
…
, 
ld
, 
cfg
);

145 
	`SET_KEX_LD_HASH
(
ötf
, 
ld
,

146 
mkex_hash
->
hash
[
ötf
][
ld
]);

147 
	`SET_KEX_LD_HASH_MASK
(
ötf
, 
ld
, 0,

148 
mkex_hash
->
hash_mask
[
ötf
][
ld
][0]);

149 
	`SET_KEX_LD_HASH_MASK
(
ötf
, 
ld
, 1,

150 
mkex_hash
->
hash_mask
[
ötf
][
ld
][1]);

151 
	`SET_KEX_LD_HASH_CTRL
(
ötf
, 
ld
,

152 
mkex_hash
->
hash_˘æ
[
ötf
][
ld
]);

157 
	}
}

159 
	$≈c_¥ogøm_mkex_hash_tx
(
rvu
 *rvu, 
blkaddr
,

160 
u8
 
ötf
)

162 
≈c_mˇm_kex_hash
 *
mkex_hash
 = 
rvu
->
kpu
.mkex_hash;

163 
lid
, 
…
, 
ld
, 
hash_˙t
 = 0;

165 i‡(
	`is_≈c_ötf_rx
(
ötf
))

169 
lid
 = 0;Üid < 
NPC_MAX_LID
;Üid++) {

170 
…
 = 0;Üà< 
NPC_MAX_LT
;Üt++) {

171 
ld
 = 0;Üd < 
NPC_MAX_LD
;Üd++)

172 i‡(
mkex_hash
->
lid_…_ld_hash_í
[
ötf
][
lid
][
…
][
ld
]) {

173 
u64
 
cfg
 = 
	`≈c_upd©e_u£_hash
(
…
, 
ld
);

175 
hash_˙t
++;

176 i‡(
hash_˙t
 =
NPC_MAX_HASH
)

180 
	`SET_KEX_LD
(
ötf
, 
lid
, 
…
, 
ld
, 
cfg
);

182 
	`SET_KEX_LD_HASH
(
ötf
, 
ld
,

183 
mkex_hash
->
hash
[
ötf
][
ld
]);

184 
	`SET_KEX_LD_HASH_MASK
(
ötf
, 
ld
, 0,

185 
mkex_hash
->
hash_mask
[
ötf
][
ld
][0]);

186 
	`SET_KEX_LD_HASH_MASK
(
ötf
, 
ld
, 1,

187 
mkex_hash
->
hash_mask
[
ötf
][
ld
][1]);

188 
	`SET_KEX_LD_HASH_CTRL
(
ötf
, 
ld
,

189 
mkex_hash
->
hash_˘æ
[
ötf
][
ld
]);

190 
hash_˙t
++;

191 i‡(
hash_˙t
 =
NPC_MAX_HASH
)

196 
	}
}

198 
	$≈c_c⁄fig_£¸ë_key
(
rvu
 *rvu, 
blkaddr
)

200 
hw_ˇp
 *
hwˇp
 = &
rvu
->
hw
->
ˇp
;

201 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

202 
u8
 
ötf
;

204 i‡(!
hwˇp
->
≈c_hash_exåa˘
) {

205 
	`dev_öfo
(
rvu
->
dev
, "HW doesÇot support secret key configuration\n");

209 
ötf
 = 0; i¡‡< 
hw
->
≈c_ötfs
; intf++) {

210 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_SECRET_KEY0
(
ötf
),

211 
RVU_NPC_HASH_SECRET_KEY0
);

212 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_SECRET_KEY1
(
ötf
),

213 
RVU_NPC_HASH_SECRET_KEY1
);

214 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_SECRET_KEY2
(
ötf
),

215 
RVU_NPC_HASH_SECRET_KEY2
);

217 
	}
}

219 
	$≈c_¥ogøm_mkex_hash
(
rvu
 *rvu, 
blkaddr
)

221 
hw_ˇp
 *
hwˇp
 = &
rvu
->
hw
->
ˇp
;

222 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

223 
u8
 
ötf
;

225 i‡(!
hwˇp
->
≈c_hash_exåa˘
) {

226 
	`dev_dbg
(
rvu
->
dev
, "Field hashÉxtract feature isÇot supported\n");

230 
ötf
 = 0; i¡‡< 
hw
->
≈c_ötfs
; intf++) {

231 
	`≈c_¥ogøm_mkex_hash_rx
(
rvu
, 
blkaddr
, 
ötf
);

232 
	`≈c_¥ogøm_mkex_hash_tx
(
rvu
, 
blkaddr
, 
ötf
);

234 
	}
}

236 
	$≈c_upd©e_fõld_hash
(
rvu
 *rvu, 
u8
 
ötf
,

237 
mˇm_íåy
 *
íåy
,

238 
blkaddr
,

239 
u64
 
„©uªs
,

240 
Êow_msg
 *
pkt
,

241 
Êow_msg
 *
mask
,

242 
Êow_msg
 *
›kt
,

243 
Êow_msg
 *
omask
)

245 
≈c_mˇm_kex_hash
 *
mkex_hash
 = 
rvu
->
kpu
.mkex_hash;

246 
≈c_gë_£¸ë_key_ªq
 
ªq
;

247 
≈c_gë_£¸ë_key_r•
 
r•
;

248 
u64
 
ld©a
[2], 
cfg
;

249 
u32
 
fõld_hash
;

250 
u8
 
hash_idx
;

252 i‡(!
rvu
->
hw
->
ˇp
.
≈c_hash_exåa˘
) {

253 
	`dev_dbg
(
rvu
->
dev
, "%s: Fõld hashÉxåa˘ fótuª i†nŸ suµ‹ãd\n", 
__func__
);

257 
ªq
.
ötf
 = intf;

258 
	`rvu_mbox_h™dÀr_≈c_gë_£¸ë_key
(
rvu
, &
ªq
, &
r•
);

260 
hash_idx
 = 0; hash_idx < 
NPC_MAX_HASH
; hash_idx++) {

261 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_HASHX_CFG
(
ötf
, 
hash_idx
));

262 i‡((
cfg
 & 
	`BIT_ULL
(11)) && (cfg & BIT_ULL(12))) {

263 
u8
 
lid
 = (
cfg
 & 
	`GENMASK_ULL
(10, 8)) >> 8;

264 
u8
 
…y≥
 = (
cfg
 & 
	`GENMASK_ULL
(7, 4)) >> 4;

265 
u8
 
…y≥_mask
 = 
cfg
 & 
	`GENMASK_ULL
(3, 0);

267 i‡(
mkex_hash
->
lid_…_ld_hash_í
[
ötf
][
lid
][
…y≥
][
hash_idx
]) {

268 
…y≥
 & 
…y≥_mask
) {

273 
NPC_LT_LC_IP6
:

274 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_SIP_IPV6
)) {

275 
u32
 
§c_ù
[
IPV6_WORDS
];

277 
	`be32_to_˝u_¨øy
(
§c_ù
, 
pkt
->
ù6§c
, 
IPV6_WORDS
);

278 
ld©a
[0] = (
u64
)
§c_ù
[0] << 32 | src_ip[1];

279 
ld©a
[1] = (
u64
)
§c_ù
[2] << 32 | src_ip[3];

280 
fõld_hash
 = 
	`≈c_fõld_hash_ˇlc
(
ld©a
,

281 
mkex_hash
,

282 
r•
.
£¸ë_key
,

283 
ötf
,

284 
hash_idx
);

285 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_SIP_IPV6
, 
íåy
,

286 
fõld_hash
, 0, 32, 0, 
ötf
);

287 
	`mem˝y
(&
›kt
->
ù6§c
, &
pkt
->ip6src,

288 (
pkt
->
ù6§c
));

289 
	`mem˝y
(&
omask
->
ù6§c
, &
mask
->ip6src,

290 (
mask
->
ù6§c
));

294 i‡(
„©uªs
 & 
	`BIT_ULL
(
NPC_DIP_IPV6
)) {

295 
u32
 
d°_ù
[
IPV6_WORDS
];

297 
	`be32_to_˝u_¨øy
(
d°_ù
, 
pkt
->
ù6d°
, 
IPV6_WORDS
);

298 
ld©a
[0] = (
u64
)
d°_ù
[0] << 32 | dst_ip[1];

299 
ld©a
[1] = (
u64
)
d°_ù
[2] << 32 | dst_ip[3];

300 
fõld_hash
 = 
	`≈c_fõld_hash_ˇlc
(
ld©a
,

301 
mkex_hash
,

302 
r•
.
£¸ë_key
,

303 
ötf
,

304 
hash_idx
);

305 
	`≈c_upd©e_íåy
(
rvu
, 
NPC_DIP_IPV6
, 
íåy
,

306 
fõld_hash
, 0, 32, 0, 
ötf
);

307 
	`mem˝y
(&
›kt
->
ù6d°
, &
pkt
->ip6dst,

308 (
pkt
->
ù6d°
));

309 
	`mem˝y
(&
omask
->
ù6d°
, &
mask
->ip6dst,

310 (
mask
->
ù6d°
));

317 
	}
}

319 
	$rvu_mbox_h™dÀr_≈c_gë_£¸ë_key
(
rvu
 *rvu,

320 
≈c_gë_£¸ë_key_ªq
 *
ªq
,

321 
≈c_gë_£¸ë_key_r•
 *
r•
)

323 
u64
 *
£¸ë_key
 = 
r•
->secret_key;

324 
u8
 
ötf
 = 
ªq
->intf;

325 
blkaddr
;

327 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

328 i‡(
blkaddr
 < 0) {

329 
	`dev_îr
(
rvu
->
dev
, "%s: NPC blockÇŸ im∂emíãd\n", 
__func__
);

330  -
EINVAL
;

333 
£¸ë_key
[0] = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_SECRET_KEY0
(
ötf
));

334 
£¸ë_key
[1] = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_SECRET_KEY1
(
ötf
));

335 
£¸ë_key
[2] = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_SECRET_KEY2
(
ötf
));

338 
	}
}

345 
u64
 
	$rvu_≈c_exa˘_mac2u64
(
u8
 *
mac_addr
)

347 
u64
 
mac
 = 0;

348 
ödex
;

350 
ödex
 = 
ETH_ALEN
 - 1; index >= 0; index--)

351 
mac
 |((
u64
)*
mac_addr
++Ë<< (8 * 
ödex
);

353  
mac
;

354 
	}
}

364 
u64
 
	$rvu_exa˘_¥ï¨e_md©a
(
u8
 *
mac
, 
u16
 
ch™
, u16 
˘y≥
, 
u64
 
mask
)

366 
u64
 
ld©a
 = 
	`rvu_≈c_exa˘_mac2u64
(
mac
);

371 
ld©a
 |((
u64
)
ch™
 << 48);

372 
ld©a
 |((
u64
)
˘y≥
 << 60);

373 
ld©a
 &
mask
;

374 
ld©a
 =Üdata << 2;

376  
ld©a
;

377 
	}
}

389 
u32
 
	$rvu_exa˘_ˇlcuœã_hash
(
rvu
 *rvu, 
u16
 
ch™
, u16 
˘y≥
, 
u8
 *
mac
,

390 
u64
 
mask
, 
u32
 
èbÀ_dïth
)

392 
≈c_exa˘_èbÀ
 *
èbÀ
 = 
rvu
->
hw
->table;

393 
u64
 
hash_key
[2];

394 
u64
 
key_ö
[2];

395 
u64
 
ld©a
;

396 
u32
 
hash
;

398 
key_ö
[0] = 
RVU_NPC_HASH_SECRET_KEY0
;

399 
key_ö
[1] = 
RVU_NPC_HASH_SECRET_KEY2
;

401 
hash_key
[0] = 
key_ö
[0] << 31;

402 
hash_key
[0] |
key_ö
[1];

403 
hash_key
[1] = 
key_ö
[0] >> 33;

405 
ld©a
 = 
	`rvu_exa˘_¥ï¨e_md©a
(
mac
, 
ch™
, 
˘y≥
, 
mask
);

407 
	`dev_dbg
(
rvu
->
dev
, "%s:Üd©a=0x%Œx hash_key0=0x%Œx hash_key2=0x%Œx\n", 
__func__
,

408 
ld©a
, 
hash_key
[1], hash_key[0]);

409 
hash
 = 
	`rvu_≈c_t€∂ôz_hash
(&
ld©a
, (
u64
 *)
hash_key
, 64, 95);

411 
hash
 &
èbÀ
->
mem_èbÀ
.
hash_mask
;

412 
hash
 +
èbÀ
->
mem_èbÀ
.
hash_off£t
;

413 
	`dev_dbg
(
rvu
->
dev
, "%s: hash=%x\n", 
__func__
, 
hash
);

415  
hash
;

416 
	}
}

428 
	$rvu_≈c_exa˘_Æloc_mem_èbÀ_íåy
(
rvu
 *rvu, 
u8
 *
way
,

429 
u32
 *
ödex
, 
hash
)

431 
≈c_exa˘_èbÀ
 *
èbÀ
;

432 
dïth
, 
i
;

434 
èbÀ
 = 
rvu
->
hw
->table;

435 
dïth
 = 
èbÀ
->
mem_èbÀ
.depth;

438 
	`muãx_lock
(&
èbÀ
->
lock
);

439 
i
 = 0; i < 
èbÀ
->
mem_èbÀ
.
ways
; i++) {

440 i‡(
	`ã°_bô
(
hash
 + 
i
 * 
dïth
, 
èbÀ
->
mem_èbÀ
.
bm≠
))

443 
	`£t_bô
(
hash
 + 
i
 * 
dïth
, 
èbÀ
->
mem_èbÀ
.
bm≠
);

444 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

446 
	`dev_dbg
(
rvu
->
dev
, "%s: memÅableÉntryálloc success (way=%d index=%d)\n",

447 
__func__
, 
i
, 
hash
);

449 *
way
 = 
i
;

450 *
ödex
 = 
hash
;

453 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

455 
	`dev_dbg
(
rvu
->
dev
, "%s: Nÿ•a˚ i¿4 wayÉxa˘ way, weight=%u\n", 
__func__
,

456 
	`bôm≠_weight
(
èbÀ
->
mem_èbÀ
.
bm≠
,ÅabÀ->mem_èbÀ.
dïth
));

457  -
ENOSPC
;

458 
	}
}

465 
	$rvu_≈c_exa˘_‰ì_id
(
rvu
 *rvu, 
u32
 
£q_id
)

467 
≈c_exa˘_èbÀ
 *
èbÀ
;

469 
èbÀ
 = 
rvu
->
hw
->table;

470 
	`muãx_lock
(&
èbÀ
->
lock
);

471 
	`˛ór_bô
(
£q_id
, 
èbÀ
->
id_bm≠
);

472 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

473 
	`dev_dbg
(
rvu
->
dev
, "%s: fªed id %d\n", 
__func__
, 
£q_id
);

474 
	}
}

482 
boﬁ
 
	$rvu_≈c_exa˘_Æloc_id
(
rvu
 *rvu, 
u32
 *
£q_id
)

484 
≈c_exa˘_èbÀ
 *
èbÀ
;

485 
u32
 
idx
;

487 
èbÀ
 = 
rvu
->
hw
->table;

489 
	`muãx_lock
(&
èbÀ
->
lock
);

490 
idx
 = 
	`föd_fú°_zîo_bô
(
èbÀ
->
id_bm≠
,ÅabÀ->
tŸ_ids
);

491 i‡(
idx
 =
èbÀ
->
tŸ_ids
) {

492 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

493 
	`dev_îr
(
rvu
->
dev
, "%s: No space in id bitmap (%d)\n",

494 
__func__
, 
	`bôm≠_weight
(
èbÀ
->
id_bm≠
,ÅabÀ->
tŸ_ids
));

496  
Ál£
;

500 
	`£t_bô
(
idx
, 
èbÀ
->
id_bm≠
);

501 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

503 *
£q_id
 = 
idx
;

504 
	`dev_dbg
(
rvu
->
dev
, "%s: AŒoˇãd id (%d)\n", 
__func__
, *
£q_id
);

506  
åue
;

507 
	}
}

515 
	$rvu_≈c_exa˘_Æloc_ˇm_èbÀ_íåy
(
rvu
 *rvu, *
ödex
)

517 
≈c_exa˘_èbÀ
 *
èbÀ
;

518 
u32
 
idx
;

520 
èbÀ
 = 
rvu
->
hw
->table;

522 
	`muãx_lock
(&
èbÀ
->
lock
);

523 
idx
 = 
	`föd_fú°_zîo_bô
(
èbÀ
->
ˇm_èbÀ
.
bm≠
,ÅabÀ->ˇm_èbÀ.
dïth
);

524 i‡(
idx
 =
èbÀ
->
ˇm_èbÀ
.
dïth
) {

525 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

526 
	`dev_öfo
(
rvu
->
dev
, "%s: Nÿ•a˚ i¿exa˘ camÅabÀ, weight=%u\n", 
__func__
,

527 
	`bôm≠_weight
(
èbÀ
->
ˇm_èbÀ
.
bm≠
,ÅabÀ->ˇm_èbÀ.
dïth
));

528  -
ENOSPC
;

532 
	`£t_bô
(
idx
, 
èbÀ
->
ˇm_èbÀ
.
bm≠
);

533 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

535 *
ödex
 = 
idx
;

536 
	`dev_dbg
(
rvu
->
dev
, "%s: camÅableÉntryálloc success (index=%d)\n",

537 
__func__
, 
idx
);

539 
	}
}

550 
u64
 
	$rvu_exa˘_¥ï¨e_èbÀ_íåy
(
rvu
 *rvu, 
boﬁ
 
íabÀ
,

551 
u8
 
˘y≥
, 
u16
 
ch™
, u8 *
mac_addr
)

554 
u64
 
ld©a
 = 
	`rvu_≈c_exa˘_mac2u64
(
mac_addr
);

557 
u64
 
md©a
 = 
	`FIELD_PREP
(
	`GENMASK_ULL
(63, 63), 
íabÀ
 ? 1 : 0);

560 
md©a
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(61, 60), 
˘y≥
);

563 
md©a
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(59, 48), 
ch™
);

566 
md©a
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(47, 0), 
ld©a
);

568  
md©a
;

569 
	}
}

575 
	$rvu_exa˘_c⁄fig_£¸ë_key
(
rvu
 *rvu)

577 
blkaddr
;

579 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

580 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_EXACT_SECRET0
(
NIX_INTF_RX
),

581 
RVU_NPC_HASH_SECRET_KEY0
);

583 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_EXACT_SECRET1
(
NIX_INTF_RX
),

584 
RVU_NPC_HASH_SECRET_KEY1
);

586 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_EXACT_SECRET2
(
NIX_INTF_RX
),

587 
RVU_NPC_HASH_SECRET_KEY2
);

588 
	}
}

594 
	$rvu_exa˘_c⁄fig_£¨ch_key
(
rvu
 *rvu)

596 
blkaddr
;

597 
u64
 
ªg_vÆ
;

599 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

602 
ªg_vÆ
 = 
	`FIELD_PREP
(
	`GENMASK_ULL
(39, 32), 0);

605 
ªg_vÆ
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(18, 16), 
ETH_ALEN
 - 1);

608 
ªg_vÆ
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(11, 11), 1);

609 
ªg_vÆ
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(10, 8), 
NPC_LID_LA
);

614 
ªg_vÆ
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(12, 12), 0);

617 
ªg_vÆ
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(7, 4), 0);

620 
ªg_vÆ
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(3, 0), 0);

622 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_EXACT_CFG
(
NIX_INTF_RX
), 
ªg_vÆ
);

623 
	}
}

632 
	$rvu_exa˘_c⁄fig_ªsu…_˘æ
(
rvu
 *rvu, 
uöt32_t
 
dïth
)

634 
blkaddr
;

635 
u64
 
ªg
 = 0;

637 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

640 
rvu
->
hw
->
èbÀ
->
mem_èbÀ
.
hash_mask
 = (
dïth
 - 1);

641 
ªg
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(42, 32), (
dïth
 - 1));

644 
rvu
->
hw
->
èbÀ
->
mem_èbÀ
.
hash_off£t
 = 0;

645 
ªg
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(10, 0), 0);

648 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_EXACT_RESULT_CTL
(
NIX_INTF_RX
), 
ªg
);

650 
	}
}

656 
	$rvu_exa˘_c⁄fig_èbÀ_mask
(
rvu
 *rvu)

658 
blkaddr
;

659 
u64
 
mask
 = 0;

661 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

664 
mask
 |
	`FIELD_PREP
(
	`GENMASK_ULL
(61, 60), 0);

667 
mask
 |
	`GENMASK_ULL
(59, 48);

670 
mask
 |
	`GENMASK_ULL
(47, 0);

673 
rvu
->
hw
->
èbÀ
->
mem_èbÀ
.
mask
 = mask;

676 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_EXACT_MASK
(
NIX_INTF_RX
), 
mask
);

677 
	}
}

684 
u32
 
	$rvu_≈c_exa˘_gë_max_íåõs
(
rvu
 *rvu)

686 
≈c_exa˘_èbÀ
 *
èbÀ
;

688 
èbÀ
 = 
rvu
->
hw
->table;

689  
èbÀ
->
tŸ_ids
;

690 
	}
}

697 
boﬁ
 
	$rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
 *rvu)

699  
rvu
->
hw
->
ˇp
.
≈c_exa˘_m©ch_íabÀd
;

700 
	}
}

710 
≈c_exa˘_èbÀ_íåy
 *

711 
	$__rvu_≈c_exa˘_föd_íåy_by_£q_id
(
rvu
 *rvu, 
u32
 
£q_id
)

713 
≈c_exa˘_èbÀ
 *
èbÀ
 = 
rvu
->
hw
->table;

714 
≈c_exa˘_èbÀ_íåy
 *
íåy
 = 
NULL
;

715 
li°_hód
 *
lhód
;

717 
lhód
 = &
èbÀ
->
lhód_gbl
;

720 
	`li°_f‹_óch_íåy
(
íåy
, 
lhód
, 
gli°
) {

721 i‡(
íåy
->
£q_id
 != seq_id)

724  
íåy
;

727  
NULL
;

728 
	}
}

747 
	$rvu_≈c_exa˘_add_to_li°
(
rvu
 *rvu, 
≈c_exa˘_›c_ty≥
 
›c_ty≥
, 
u8
 
ways
,

748 
u32
 
ödex
, 
u8
 
cgx_id
, u8 
lmac_id
, u8 *
mac_addr
, 
u16
 
ch™
,

749 
u8
 
˘y≥
, 
u32
 *
£q_id
, 
boﬁ
 
cmd
, u32 
mˇm_idx
, 
u16
 
pcifunc
)

751 
≈c_exa˘_èbÀ_íåy
 *
íåy
, *
tmp
, *
ôî
;

752 
≈c_exa˘_èbÀ
 *
èbÀ
 = 
rvu
->
hw
->table;

753 
li°_hód
 *
lhód
, *
µªv
;

755 
	`WARN_ON
(
ways
 >
NPC_EXACT_TBL_MAX_WAYS
);

757 i‡(!
	`rvu_≈c_exa˘_Æloc_id
(
rvu
, 
£q_id
)) {

758 
	`dev_îr
(
rvu
->
dev
, "%s: Gíî©ê£q id faûed\n", 
__func__
);

759  -
EFAULT
;

762 
íåy
 = 
	`kmÆloc
((*íåy), 
GFP_KERNEL
);

763 i‡(!
íåy
) {

764 
	`rvu_≈c_exa˘_‰ì_id
(
rvu
, *
£q_id
);

765 
	`dev_îr
(
rvu
->
dev
, "%s: Mem‹yáŒoˇti⁄ faûed\n", 
__func__
);

766  -
ENOMEM
;

769 
	`muãx_lock
(&
èbÀ
->
lock
);

770 
›c_ty≥
) {

771 
NPC_EXACT_OPC_CAM
:

772 
lhód
 = &
èbÀ
->
lhód_ˇm_tbl_íåy
;

773 
èbÀ
->
ˇm_tbl_íåy_˙t
++;

776 
NPC_EXACT_OPC_MEM
:

777 
lhód
 = &
èbÀ
->
lhód_mem_tbl_íåy
[
ways
];

778 
èbÀ
->
mem_tbl_íåy_˙t
++;

782 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

783 
	`k‰ì
(
íåy
);

784 
	`rvu_≈c_exa˘_‰ì_id
(
rvu
, *
£q_id
);

786 
	`dev_îr
(
rvu
->
dev
, "%s: Unknow¿›¯ty≥%d\n", 
__func__
, 
›c_ty≥
);

787  -
EINVAL
;

791 
	`INIT_LIST_HEAD
(&
íåy
->
gli°
);

792 
	`li°_add_èû
(&
íåy
->
gli°
, &
èbÀ
->
lhód_gbl
);

793 
	`INIT_LIST_HEAD
(&
íåy
->
li°
);

794 
íåy
->
ödex
 = index;

795 
íåy
->
ways
 = ways;

796 
íåy
->
›c_ty≥
 = opc_type;

798 
íåy
->
pcifunc
 =Öcifunc;

800 
	`ëhî_addr_c›y
(
íåy
->
mac
, 
mac_addr
);

801 
íåy
->
ch™
 = chan;

802 
íåy
->
˘y≥
 = ctype;

803 
íåy
->
cgx_id
 = cgx_id;

804 
íåy
->
lmac_id
 =Ümac_id;

806 
íåy
->
£q_id
 = *seq_id;

808 
íåy
->
mˇm_idx
 = mcam_idx;

809 
íåy
->
cmd
 = cmd;

811 
µªv
 = 
lhód
;

814 
	`li°_f‹_óch_íåy_ß„
(
ôî
, 
tmp
, 
lhód
, 
li°
) {

815 i‡(
ödex
 < 
ôî
->index)

818 
µªv
 = &
ôî
->
li°
;

822 
	`li°_add
(&
íåy
->
li°
, 
µªv
);

823 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

825 
	}
}

835 
	$rvu_≈c_exa˘_mem_èbÀ_wrôe
(
rvu
 *rvu, 
blkaddr
, 
u8
 
ways
,

836 
u32
 
ödex
, 
u64
 
md©a
)

838 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_EXACT_MEM_ENTRY
(
ways
, 
ödex
), 
md©a
);

839 
	}
}

848 
	$rvu_≈c_exa˘_ˇm_èbÀ_wrôe
(
rvu
 *rvu, 
blkaddr
,

849 
u32
 
ödex
, 
u64
 
md©a
)

851 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`NPC_AF_EXACT_CAM_ENTRY
(
ödex
), 
md©a
);

852 
	}
}

862 
	$rvu_≈c_exa˘_dóŒoc_èbÀ_íåy
(
rvu
 *rvu, 
≈c_exa˘_›c_ty≥
 
›c_ty≥
,

863 
u8
 
ways
, 
u32
 
ödex
)

865 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

866 
≈c_exa˘_èbÀ
 *
èbÀ
;

867 
u8
 
nuŒ_dmac
[6] = { 0 };

868 
dïth
;

871 
u64
 
nuŒ_md©a
 = 
	`rvu_exa˘_¥ï¨e_èbÀ_íåy
(
rvu
, 
Ál£
, 0, 0, 
nuŒ_dmac
);

873 
èbÀ
 = 
rvu
->
hw
->table;

874 
dïth
 = 
èbÀ
->
mem_èbÀ
.depth;

876 
	`muãx_lock
(&
èbÀ
->
lock
);

878 
›c_ty≥
) {

879 
NPC_EXACT_OPC_CAM
:

882 i‡(!
	`ã°_bô
(
ödex
, 
èbÀ
->
ˇm_èbÀ
.
bm≠
)) {

883 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

884 
	`dev_îr
(
rvu
->
dev
, "%s: TryingÅo freeán unusedÉntry ways=%d index=%d\n",

885 
__func__
, 
ways
, 
ödex
);

886  -
EINVAL
;

889 
	`rvu_≈c_exa˘_ˇm_èbÀ_wrôe
(
rvu
, 
blkaddr
, 
ödex
, 
nuŒ_md©a
);

890 
	`˛ór_bô
(
ödex
, 
èbÀ
->
ˇm_èbÀ
.
bm≠
);

893 
NPC_EXACT_OPC_MEM
:

896 i‡(!
	`ã°_bô
(
ödex
 + 
ways
 * 
dïth
, 
èbÀ
->
mem_èbÀ
.
bm≠
)) {

897 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

898 
	`dev_îr
(
rvu
->
dev
, "%s: TryingÅo freeán unusedÉntry index=%d\n",

899 
__func__
, 
ödex
);

900  -
EINVAL
;

903 
	`rvu_≈c_exa˘_mem_èbÀ_wrôe
(
rvu
, 
blkaddr
, 
ways
, 
ödex
, 
nuŒ_md©a
);

904 
	`˛ór_bô
(
ödex
 + 
ways
 * 
dïth
, 
èbÀ
->
mem_èbÀ
.
bm≠
);

908 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

909 
	`dev_îr
(
rvu
->
dev
, "%s: invÆid op¯ty≥ %d", 
__func__
, 
›c_ty≥
);

910  -
ENOSPC
;

913 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

915 
	`dev_dbg
(
rvu
->
dev
, "%s: Successfully deletedÉntry (index=%d, ways=%d opc_type=%d\n",

916 
__func__
, 
ödex
, 
ways
, 
›c_ty≥
);

919 
	}
}

936 
	$rvu_≈c_exa˘_Æloc_èbÀ_íåy
(
rvu
 *rvu, *
mac
, 
u16
 
ch™
, 
u8
 
˘y≥
,

937 
u32
 *
ödex
, 
u8
 *
ways
, 
≈c_exa˘_›c_ty≥
 *
›c_ty≥
)

939 
≈c_exa˘_èbÀ
 *
èbÀ
;

940 
hash
;

941 
îr
;

943 
èbÀ
 = 
rvu
->
hw
->table;

946 
hash
 = 
	`rvu_exa˘_ˇlcuœã_hash
(
rvu
, 
ch™
, 
˘y≥
, 
mac
, 
èbÀ
->
mem_èbÀ
.
mask
,

947 
èbÀ
->
mem_èbÀ
.
dïth
);

948 
îr
 = 
	`rvu_≈c_exa˘_Æloc_mem_èbÀ_íåy
(
rvu
, 
ways
, 
ödex
, 
hash
);

949 i‡(!
îr
) {

950 *
›c_ty≥
 = 
NPC_EXACT_OPC_MEM
;

951 
	`dev_dbg
(
rvu
->
dev
, "%s: inserted in 4 ways hashÅable ways=%d, index=%d\n",

952 
__func__
, *
ways
, *
ödex
);

956 
	`dev_dbg
(
rvu
->
dev
, "%s: faûedÅÿö£π i¿4 way†hashÅabÀ\n", 
__func__
);

959 *
ways
 = 0;

960 
îr
 = 
	`rvu_≈c_exa˘_Æloc_ˇm_èbÀ_íåy
(
rvu
, 
ödex
);

961 i‡(!
îr
) {

962 *
›c_ty≥
 = 
NPC_EXACT_OPC_CAM
;

963 
	`dev_dbg
(
rvu
->
dev
, "%s: inserted in fullyássociative hashÅable index=%u\n",

964 
__func__
, *
ödex
);

968 
	`dev_îr
(
rvu
->
dev
, "%s: faûedÅÿö£π i¿fuŒyássocütivêhashÅabÀ\n", 
__func__
);

969  -
ENOSPC
;

970 
	}
}

981 
boﬁ
 
	$rvu_≈c_exa˘_ßve_dr›_ruÀ_ch™_™d_mask
(
rvu
 *rvu, 
dr›_mˇm_idx
,

982 
u64
 
ch™_vÆ
, u64 
ch™_mask
, 
u16
 
pcifunc
)

984 
≈c_exa˘_èbÀ
 *
èbÀ
;

985 
i
;

987 
èbÀ
 = 
rvu
->
hw
->table;

989 
i
 = 0; i < 
NPC_MCAM_DROP_RULE_MAX
; i++) {

990 i‡(!
èbÀ
->
dr›_ruÀ_m≠
[
i
].
vÆid
)

993 i‡(
èbÀ
->
dr›_ruÀ_m≠
[
i
].
ch™_vÆ
 !(
u16
)chan_val)

996 i‡(
èbÀ
->
dr›_ruÀ_m≠
[
i
].
ch™_mask
 !(
u16
)chan_mask)

999  
Ál£
;

1002 i‡(
i
 =
NPC_MCAM_DROP_RULE_MAX
)

1003  
Ál£
;

1005 
èbÀ
->
dr›_ruÀ_m≠
[
i
].
dr›_ruÀ_idx
 = 
dr›_mˇm_idx
;

1006 
èbÀ
->
dr›_ruÀ_m≠
[
i
].
ch™_vÆ
 = (
u16
)chan_val;

1007 
èbÀ
->
dr›_ruÀ_m≠
[
i
].
ch™_mask
 = (
u16
)chan_mask;

1008 
èbÀ
->
dr›_ruÀ_m≠
[
i
].
pcifunc
 =Öcifunc;

1009 
èbÀ
->
dr›_ruÀ_m≠
[
i
].
vÆid
 = 
åue
;

1010  
åue
;

1011 
	}
}

1023 
boﬁ
 
	$rvu_≈c_exa˘_ˇlc_dr›_ruÀ_ch™_™d_mask
(
rvu
 *rvu, 
u8
 
ötf_ty≥
,

1024 
u8
 
cgx_id
, u8 
lmac_id
,

1025 
u64
 *
vÆ
, u64 *
mask
)

1027 
u16
 
ch™_vÆ
, 
ch™_mask
;

1030 i‡(
ötf_ty≥
 !
NIX_INTF_TYPE_CGX
)

1031  
Ál£
;

1033 
ch™_vÆ
 = 
	`rvu_nix_ch™_cgx
(
rvu
, 
cgx_id
, 
lmac_id
, 0);

1034 
ch™_mask
 = 0xfff;

1036 i‡(
vÆ
)

1037 *
vÆ
 = 
ch™_vÆ
;

1039 i‡(
mask
)

1040 *
mask
 = 
ch™_mask
;

1042  
åue
;

1043 
	}
}

1054 
u16
 
	$rvu_≈c_exa˘_dr›_ruÀ_to_pcifunc
(
rvu
 *rvu, 
u32
 
dr›_ruÀ_idx
)

1056 
≈c_exa˘_èbÀ
 *
èbÀ
;

1057 
i
;

1059 
èbÀ
 = 
rvu
->
hw
->table;

1061 
i
 = 0; i < 
NPC_MCAM_DROP_RULE_MAX
; i++) {

1062 i‡(!
èbÀ
->
dr›_ruÀ_m≠
[
i
].
vÆid
)

1065 i‡(
èbÀ
->
dr›_ruÀ_m≠
[
i
].
dr›_ruÀ_idx
 != drop_rule_idx)

1068  
èbÀ
->
dr›_ruÀ_m≠
[
i
].
pcifunc
;

1071 
	`dev_îr
(
rvu
->
dev
, "%s: drop mcamÑule index (%d) >= NPC_MCAM_DROP_RULE_MAX\n",

1072 
__func__
, 
dr›_ruÀ_idx
);

1074 
	}
}

1088 
boﬁ
 
	$rvu_≈c_exa˘_gë_dr›_ruÀ_öfo
(
rvu
 *rvu, 
u8
 
ötf_ty≥
, u8 
cgx_id
,

1089 
u8
 
lmac_id
, 
u32
 *
dr›_mˇm_idx
, 
u64
 *
vÆ
,

1090 
u64
 *
mask
, 
u16
 *
pcifunc
)

1092 
≈c_exa˘_èbÀ
 *
èbÀ
;

1093 
u64
 
ch™_vÆ
, 
ch™_mask
;

1094 
boﬁ
 
rc
;

1095 
i
;

1097 
èbÀ
 = 
rvu
->
hw
->table;

1099 i‡(
ötf_ty≥
 !
NIX_INTF_TYPE_CGX
) {

1100 
	`dev_îr
(
rvu
->
dev
, "%s: Nÿdr›ÑuÀ f‹ LBK/SDP mode\n", 
__func__
);

1101  
Ál£
;

1104 
rc
 = 
	`rvu_≈c_exa˘_ˇlc_dr›_ruÀ_ch™_™d_mask
(
rvu
, 
ötf_ty≥
, 
cgx_id
,

1105 
lmac_id
, &
ch™_vÆ
, &
ch™_mask
);

1106 i‡(!
rc
)

1107  
Ál£
;

1109 
i
 = 0; i < 
NPC_MCAM_DROP_RULE_MAX
; i++) {

1110 i‡(!
èbÀ
->
dr›_ruÀ_m≠
[
i
].
vÆid
)

1113 i‡(
èbÀ
->
dr›_ruÀ_m≠
[
i
].
ch™_vÆ
 !(
u16
)chan_val)

1116 i‡(
vÆ
)

1117 *
vÆ
 = 
èbÀ
->
dr›_ruÀ_m≠
[
i
].
ch™_vÆ
;

1118 i‡(
mask
)

1119 *
mask
 = 
èbÀ
->
dr›_ruÀ_m≠
[
i
].
ch™_mask
;

1120 i‡(
pcifunc
)

1121 *
pcifunc
 = 
èbÀ
->
dr›_ruÀ_m≠
[
i
].pcifunc;

1123 *
dr›_mˇm_idx
 = 
i
;

1124  
åue
;

1127 i‡(
i
 =
NPC_MCAM_DROP_RULE_MAX
) {

1128 
	`dev_îr
(
rvu
->
dev
, "%s: drop mcamÑule index (%d) >= NPC_MCAM_DROP_RULE_MAX\n",

1129 
__func__
, *
dr›_mˇm_idx
);

1130  
Ál£
;

1133 
	`dev_îr
(
rvu
->
dev
, "%s: CouldÇotÑetrieve for cgx=%d,Ümac=%d\n",

1134 
__func__
, 
cgx_id
, 
lmac_id
);

1135  
Ál£
;

1136 
	}
}

1150 
u16
 
	$__rvu_≈c_exa˘_cmd_ruÀs_˙t_upd©e
(
rvu
 *rvu, 
dr›_mˇm_idx
,

1151 
vÆ
, 
boﬁ
 *
íabÀ_‹_dißbÀ_ˇm
)

1153 
≈c_exa˘_èbÀ
 *
èbÀ
;

1154 
u16
 *
˙t
, 
ﬁd_˙t
;

1155 
boﬁ
 
¥omisc
;

1157 
èbÀ
 = 
rvu
->
hw
->table;

1158 
¥omisc
 = 
èbÀ
->
¥omisc_mode
[
dr›_mˇm_idx
];

1160 
˙t
 = &
èbÀ
->
˙t_cmd_ruÀs
[
dr›_mˇm_idx
];

1161 
ﬁd_˙t
 = *
˙t
;

1163 *
˙t
 +
vÆ
;

1165 i‡(!
íabÀ_‹_dißbÀ_ˇm
)

1166 
d⁄e
;

1168 *
íabÀ_‹_dißbÀ_ˇm
 = 
Ál£
;

1170 i‡(
¥omisc
)

1171 
d⁄e
;

1174 i‡(!*
˙t
 && 
vÆ
 < 0) {

1175 *
íabÀ_‹_dißbÀ_ˇm
 = 
åue
;

1176 
d⁄e
;

1180 i‡(!
ﬁd_˙t
 && 
vÆ
 > 0) {

1181 *
íabÀ_‹_dißbÀ_ˇm
 = 
åue
;

1182 
d⁄e
;

1185 
d⁄e
:

1186  *
˙t
;

1187 
	}
}

1198 
	$rvu_≈c_exa˘_dñ_èbÀ_íåy_by_id
(
rvu
 *rvu, 
u32
 
£q_id
)

1200 
≈c_exa˘_èbÀ_íåy
 *
íåy
 = 
NULL
;

1201 
≈c_exa˘_èbÀ
 *
èbÀ
;

1202 
boﬁ
 
dißbÀ_ˇm
 = 
Ál£
;

1203 
u32
 
dr›_mˇm_idx
 = -1;

1204 *
˙t
;

1205 
boﬁ
 
rc
;

1207 
èbÀ
 = 
rvu
->
hw
->table;

1209 
	`muãx_lock
(&
èbÀ
->
lock
);

1212 
íåy
 = 
	`__rvu_≈c_exa˘_föd_íåy_by_£q_id
(
rvu
, 
£q_id
);

1213 i‡(!
íåy
) {

1214 
	`dev_dbg
(
rvu
->
dev
, "%s: faûedÅÿfödÉ¡ry f‹ id=%d\n", 
__func__
, 
£q_id
);

1215 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1216  -
ENODATA
;

1219 
˙t
 = (
íåy
->
›c_ty≥
 =
NPC_EXACT_OPC_CAM
Ë? &
èbÀ
->
ˇm_tbl_íåy_˙t
 :

1220 &
èbÀ
->
mem_tbl_íåy_˙t
;

1223 
	`li°_dñ_öô
(&
íåy
->
li°
);

1224 
	`li°_dñ_öô
(&
íåy
->
gli°
);

1226 (*
˙t
)--;

1228 
rc
 = 
	`rvu_≈c_exa˘_gë_dr›_ruÀ_öfo
(
rvu
, 
NIX_INTF_TYPE_CGX
, 
íåy
->
cgx_id
,

1229 
íåy
->
lmac_id
, &
dr›_mˇm_idx
, 
NULL
, NULL, NULL);

1230 i‡(!
rc
) {

1231 
	`dev_dbg
(
rvu
->
dev
, "%s: failedÅoÑetrieve drop info for id=0x%x\n",

1232 
__func__
, 
£q_id
);

1233 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1234  -
ENODATA
;

1237 i‡(
íåy
->
cmd
)

1238 
	`__rvu_≈c_exa˘_cmd_ruÀs_˙t_upd©e
(
rvu
, 
dr›_mˇm_idx
, -1, &
dißbÀ_ˇm
);

1241 i‡(
dißbÀ_ˇm
) {

1242 
	`rvu_≈c_íabÀ_mˇm_by_íåy_ödex
(
rvu
, 
dr›_mˇm_idx
, 
NIX_INTF_RX
, 
Ál£
);

1243 
	`dev_dbg
(
rvu
->
dev
, "%s: Disabling mcam idx %d\n",

1244 
__func__
, 
dr›_mˇm_idx
);

1247 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1249 
	`rvu_≈c_exa˘_dóŒoc_èbÀ_íåy
(
rvu
, 
íåy
->
›c_ty≥
,É¡ry->
ways
,É¡ry->
ödex
);

1251 
	`rvu_≈c_exa˘_‰ì_id
(
rvu
, 
£q_id
);

1253 
	`dev_dbg
(
rvu
->
dev
, "%s: deleteÉntry success for id=0x%x, mca=%pM\n",

1254 
__func__
, 
£q_id
, 
íåy
->
mac
);

1255 
	`k‰ì
(
íåy
);

1258 
	}
}

1277 
	$rvu_≈c_exa˘_add_èbÀ_íåy
(
rvu
 *rvu, 
u8
 
cgx_id
, u8 
lmac_id
, u8 *
mac
,

1278 
u16
 
ch™
, 
u8
 
˘y≥
, 
u32
 *
£q_id
, 
boﬁ
 
cmd
,

1279 
u32
 
mˇm_idx
, 
u16
 
pcifunc
)

1281 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1282 
≈c_exa˘_›c_ty≥
 
›c_ty≥
;

1283 
boﬁ
 
íabÀ_ˇm
 = 
Ál£
;

1284 
u32
 
dr›_mˇm_idx
;

1285 
u32
 
ödex
;

1286 
u64
 
md©a
;

1287 
boﬁ
 
rc
;

1288 
îr
;

1289 
u8
 
ways
;

1291 
˘y≥
 = 0;

1293 
îr
 = 
	`rvu_≈c_exa˘_Æloc_èbÀ_íåy
(
rvu
, 
mac
, 
ch™
, 
˘y≥
, &
ödex
, &
ways
, &
›c_ty≥
);

1294 i‡(
îr
) {

1295 
	`dev_îr
(
rvu
->
dev
, "%s: CouldÇŸáŒo¯öÉxa˘ m©chÅabÀ\n", 
__func__
);

1296  
îr
;

1300 
md©a
 = 
	`rvu_exa˘_¥ï¨e_èbÀ_íåy
(
rvu
, 
åue
, 
˘y≥
, 
ch™
, 
mac
);

1302 i‡(
›c_ty≥
 =
NPC_EXACT_OPC_CAM
)

1303 
	`rvu_≈c_exa˘_ˇm_èbÀ_wrôe
(
rvu
, 
blkaddr
, 
ödex
, 
md©a
);

1305 
	`rvu_≈c_exa˘_mem_èbÀ_wrôe
(
rvu
, 
blkaddr
, 
ways
, 
ödex
, 
md©a
);

1308 
îr
 = 
	`rvu_≈c_exa˘_add_to_li°
(
rvu
, 
›c_ty≥
, 
ways
, 
ödex
, 
cgx_id
, 
lmac_id
,

1309 
mac
, 
ch™
, 
˘y≥
, 
£q_id
, 
cmd
, 
mˇm_idx
, 
pcifunc
);

1310 i‡(
îr
) {

1311 
	`rvu_≈c_exa˘_dóŒoc_èbÀ_íåy
(
rvu
, 
›c_ty≥
, 
ways
, 
ödex
);

1312 
	`dev_îr
(
rvu
->
dev
, "%s: couldÇŸáddÅÿexa˘ m©chÅabÀ\n", 
__func__
);

1313  
îr
;

1316 
rc
 = 
	`rvu_≈c_exa˘_gë_dr›_ruÀ_öfo
(
rvu
, 
NIX_INTF_TYPE_CGX
, 
cgx_id
, 
lmac_id
,

1317 &
dr›_mˇm_idx
, 
NULL
, NULL, NULL);

1318 i‡(!
rc
) {

1319 
	`rvu_≈c_exa˘_dóŒoc_èbÀ_íåy
(
rvu
, 
›c_ty≥
, 
ways
, 
ödex
);

1320 
	`dev_dbg
(
rvu
->
dev
, "%s: failedÅo get dropÑule info cgx=%dÜmac=%d\n",

1321 
__func__
, 
cgx_id
, 
lmac_id
);

1322  -
EINVAL
;

1325 i‡(
cmd
)

1326 
	`__rvu_≈c_exa˘_cmd_ruÀs_˙t_upd©e
(
rvu
, 
dr›_mˇm_idx
, 1, &
íabÀ_ˇm
);

1329 i‡(
íabÀ_ˇm
) {

1330 
	`rvu_≈c_íabÀ_mˇm_by_íåy_ödex
(
rvu
, 
dr›_mˇm_idx
, 
NIX_INTF_RX
, 
åue
);

1331 
	`dev_dbg
(
rvu
->
dev
, "%s: Enabling mcam idx %d\n",

1332 
__func__
, 
dr›_mˇm_idx
);

1335 
	`dev_dbg
(
rvu
->
dev
,

1337 
__func__
, 
ödex
, 
mac
, 
ways
, 
›c_ty≥
);

1340 
	}
}

1355 
	$rvu_≈c_exa˘_upd©e_èbÀ_íåy
(
rvu
 *rvu, 
u8
 
cgx_id
, u8 
lmac_id
,

1356 
u8
 *
ﬁd_mac
, u8 *
√w_mac
, 
u32
 *
£q_id
)

1358 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1359 
≈c_exa˘_èbÀ_íåy
 *
íåy
;

1360 
≈c_exa˘_èbÀ
 *
èbÀ
;

1361 
u32
 
hash_ödex
;

1362 
u64
 
md©a
;

1364 
èbÀ
 = 
rvu
->
hw
->table;

1366 
	`muãx_lock
(&
èbÀ
->
lock
);

1369 
íåy
 = 
	`__rvu_≈c_exa˘_föd_íåy_by_£q_id
(
rvu
, *
£q_id
);

1370 i‡(!
íåy
) {

1371 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1372 
	`dev_dbg
(
rvu
->
dev
,

1374 
__func__
, 
cgx_id
, 
lmac_id
, 
ﬁd_mac
);

1375  -
ENODATA
;

1381 i‡(
íåy
->
›c_ty≥
 =
NPC_EXACT_OPC_MEM
) {

1382 
hash_ödex
 = 
	`rvu_exa˘_ˇlcuœã_hash
(
rvu
, 
íåy
->
ch™
,É¡ry->
˘y≥
,

1383 
√w_mac
, 
èbÀ
->
mem_èbÀ
.
mask
,

1384 
èbÀ
->
mem_èbÀ
.
dïth
);

1385 i‡(
hash_ödex
 !
íåy
->
ödex
) {

1386 
	`dev_dbg
(
rvu
->
dev
,

1388 
__func__
, 
hash_ödex
, 
íåy
->
ödex
);

1389 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1390  -
EINVAL
;

1394 
md©a
 = 
	`rvu_exa˘_¥ï¨e_èbÀ_íåy
(
rvu
, 
åue
, 
íåy
->
˘y≥
,É¡ry->
ch™
, 
√w_mac
);

1396 i‡(
íåy
->
›c_ty≥
 =
NPC_EXACT_OPC_MEM
)

1397 
	`rvu_≈c_exa˘_mem_èbÀ_wrôe
(
rvu
, 
blkaddr
, 
íåy
->
ways
,É¡ry->
ödex
, 
md©a
);

1399 
	`rvu_≈c_exa˘_ˇm_èbÀ_wrôe
(
rvu
, 
blkaddr
, 
íåy
->
ödex
, 
md©a
);

1402 
	`ëhî_addr_c›y
(
íåy
->
mac
, 
√w_mac
);

1403 *
£q_id
 = 
íåy
->seq_id;

1405 
	`dev_dbg
(
rvu
->
dev
,

1407 
__func__
, 
íåy
->
ödex
,É¡ry->
mac
,É¡ry->
ways
,É¡ry->
›c_ty≥
);

1409 
	`dev_dbg
(
rvu
->
dev
, "%s: Successfully updatedÉntry (old mac=%pMÇew_mac=%pM\n",

1410 
__func__
, 
ﬁd_mac
, 
√w_mac
);

1412 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1414 
	}
}

1426 
	$rvu_≈c_exa˘_¥omisc_dißbÀ
(
rvu
 *rvu, 
u16
 
pcifunc
)

1428 
≈c_exa˘_èbÀ
 *
èbÀ
;

1429 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

1430 
u8
 
cgx_id
, 
lmac_id
;

1431 
u32
 
dr›_mˇm_idx
;

1432 
boﬁ
 *
¥omisc
;

1433 
boﬁ
 
rc
;

1434 
u32
 
˙t
;

1436 
èbÀ
 = 
rvu
->
hw
->table;

1438 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1439 
rc
 = 
	`rvu_≈c_exa˘_gë_dr›_ruÀ_öfo
(
rvu
, 
NIX_INTF_TYPE_CGX
, 
cgx_id
, 
lmac_id
,

1440 &
dr›_mˇm_idx
, 
NULL
, NULL, NULL);

1441 i‡(!
rc
) {

1442 
	`dev_dbg
(
rvu
->
dev
, "%s: failedÅo get dropÑule info cgx=%dÜmac=%d\n",

1443 
__func__
, 
cgx_id
, 
lmac_id
);

1444  -
EINVAL
;

1447 
	`muãx_lock
(&
èbÀ
->
lock
);

1448 
¥omisc
 = &
èbÀ
->
¥omisc_mode
[
dr›_mˇm_idx
];

1450 i‡(!*
¥omisc
) {

1451 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1452 
	`dev_dbg
(
rvu
->
dev
, "%s: Err AlreadyÖromisc mode disabled (cgx=%dÜmac=%d)\n",

1453 
__func__
, 
cgx_id
, 
lmac_id
);

1454  
LMAC_AF_ERR_INVALID_PARAM
;

1456 *
¥omisc
 = 
Ál£
;

1457 
˙t
 = 
	`__rvu_≈c_exa˘_cmd_ruÀs_˙t_upd©e
(
rvu
, 
dr›_mˇm_idx
, 0, 
NULL
);

1458 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1461 i‡(!
˙t
)

1462 
	`rvu_≈c_íabÀ_mˇm_by_íåy_ödex
(
rvu
, 
dr›_mˇm_idx
, 
NIX_INTF_RX
, 
Ál£
);

1464 
	`rvu_≈c_íabÀ_mˇm_by_íåy_ödex
(
rvu
, 
dr›_mˇm_idx
, 
NIX_INTF_RX
, !*
¥omisc
);

1466 
	`dev_dbg
(
rvu
->
dev
, "%s: disabledÖromisc mode (cgx=%dÜmac=%d, cnt=%d)\n",

1467 
__func__
, 
cgx_id
, 
lmac_id
, 
˙t
);

1469 
	}
}

1477 
	$rvu_≈c_exa˘_¥omisc_íabÀ
(
rvu
 *rvu, 
u16
 
pcifunc
)

1479 
≈c_exa˘_èbÀ
 *
èbÀ
;

1480 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

1481 
u8
 
cgx_id
, 
lmac_id
;

1482 
u32
 
dr›_mˇm_idx
;

1483 
boﬁ
 *
¥omisc
;

1484 
boﬁ
 
rc
;

1485 
u32
 
˙t
;

1487 
èbÀ
 = 
rvu
->
hw
->table;

1489 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1490 
rc
 = 
	`rvu_≈c_exa˘_gë_dr›_ruÀ_öfo
(
rvu
, 
NIX_INTF_TYPE_CGX
, 
cgx_id
, 
lmac_id
,

1491 &
dr›_mˇm_idx
, 
NULL
, NULL, NULL);

1492 i‡(!
rc
) {

1493 
	`dev_dbg
(
rvu
->
dev
, "%s: failedÅo get dropÑule info cgx=%dÜmac=%d\n",

1494 
__func__
, 
cgx_id
, 
lmac_id
);

1495  -
EINVAL
;

1498 
	`muãx_lock
(&
èbÀ
->
lock
);

1499 
¥omisc
 = &
èbÀ
->
¥omisc_mode
[
dr›_mˇm_idx
];

1501 i‡(*
¥omisc
) {

1502 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1503 
	`dev_dbg
(
rvu
->
dev
, "%s: Already inÖromisc mode (cgx=%dÜmac=%d)\n",

1504 
__func__
, 
cgx_id
, 
lmac_id
);

1505  
LMAC_AF_ERR_INVALID_PARAM
;

1507 *
¥omisc
 = 
åue
;

1508 
˙t
 = 
	`__rvu_≈c_exa˘_cmd_ruÀs_˙t_upd©e
(
rvu
, 
dr›_mˇm_idx
, 0, 
NULL
);

1509 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1512 i‡(!
˙t
)

1513 
	`rvu_≈c_íabÀ_mˇm_by_íåy_ödex
(
rvu
, 
dr›_mˇm_idx
, 
NIX_INTF_RX
, 
Ál£
);

1515 
	`rvu_≈c_íabÀ_mˇm_by_íåy_ödex
(
rvu
, 
dr›_mˇm_idx
, 
NIX_INTF_RX
, !*
¥omisc
);

1517 
	`dev_dbg
(
rvu
->
dev
, "%s: EnabledÖromisc mode (cgx=%dÜmac=%d cnt=%d)\n",

1518 
__func__
, 
cgx_id
, 
lmac_id
, 
˙t
);

1520 
	}
}

1529 
	$rvu_≈c_exa˘_mac_addr_ª£t
(
rvu
 *rvu, 
cgx_mac_addr_ª£t_ªq
 *
ªq
,

1530 
msg_r•
 *
r•
)

1532 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1533 
u32
 
£q_id
 = 
ªq
->
ödex
;

1534 
rvu_pfvf
 *
pfvf
;

1535 
u8
 
cgx_id
, 
lmac_id
;

1536 
rc
;

1538 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1540 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

1542 
rc
 = 
	`rvu_≈c_exa˘_dñ_èbÀ_íåy_by_id
(
rvu
, 
£q_id
);

1543 i‡(
rc
) {

1545 
	`dev_îr
(
rvu
->
dev
, "%†MAC (%pMËdñ PF=%d faûed\n", 
__func__
, 
pfvf
->
mac_addr
, 
pf
);

1549 
	`dev_dbg
(
rvu
->
dev
, "%s MAC (%pM) del PF=%d success (seq_id=%u)\n",

1550 
__func__
, 
pfvf
->
mac_addr
, 
pf
, 
£q_id
);

1552 
	}
}

1561 
	$rvu_≈c_exa˘_mac_addr_upd©e
(
rvu
 *rvu,

1562 
cgx_mac_addr_upd©e_ªq
 *
ªq
,

1563 
cgx_mac_addr_upd©e_r•
 *
r•
)

1565 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1566 
≈c_exa˘_èbÀ_íåy
 *
íåy
;

1567 
≈c_exa˘_èbÀ
 *
èbÀ
;

1568 
rvu_pfvf
 *
pfvf
;

1569 
u32
 
£q_id
, 
mˇm_idx
;

1570 
u8
 
ﬁd_mac
[
ETH_ALEN
];

1571 
u8
 
cgx_id
, 
lmac_id
;

1572 
rc
;

1574 i‡(!
	`is_cgx_c⁄fig_≥rmôãd
(
rvu
, 
ªq
->
hdr
.
pcifunc
))

1575  
LMAC_AF_ERR_PERM_DENIED
;

1577 
	`dev_dbg
(
rvu
->
dev
, "%s: UpdateÑequest for seq_id=%d, mac=%pM\n",

1578 
__func__
, 
ªq
->
ödex
,Ñeq->
mac_addr
);

1580 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1582 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

1584 
èbÀ
 = 
rvu
->
hw
->table;

1586 
	`muãx_lock
(&
èbÀ
->
lock
);

1589 
íåy
 = 
	`__rvu_≈c_exa˘_föd_íåy_by_£q_id
(
rvu
, 
ªq
->
ödex
);

1590 i‡(!
íåy
) {

1591 
	`dev_îr
(
rvu
->
dev
, "%s: faûedÅÿfödÉ¡ry f‹ id=0x%x\n", 
__func__
, 
ªq
->
ödex
);

1592 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1593  
LMAC_AF_ERR_EXACT_MATCH_TBL_LOOK_UP_FAILED
;

1595 
	`ëhî_addr_c›y
(
ﬁd_mac
, 
íåy
->
mac
);

1596 
£q_id
 = 
íåy
->seq_id;

1597 
mˇm_idx
 = 
íåy
->mcam_idx;

1598 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1600 
rc
 = 
	`rvu_≈c_exa˘_upd©e_èbÀ_íåy
(
rvu
, 
cgx_id
, 
lmac_id
, 
ﬁd_mac
,

1601 
ªq
->
mac_addr
, &
£q_id
);

1602 i‡(!
rc
) {

1603 
r•
->
ödex
 = 
£q_id
;

1604 
	`dev_dbg
(
rvu
->
dev
, "%s mac:%pM (pfvf:%pM default:%pM) updateÅo PF=%d success\n",

1605 
__func__
, 
ªq
->
mac_addr
, 
pfvf
->mac_addr,Öfvf->
deÁu…_mac
, 
pf
);

1606 
	`ëhî_addr_c›y
(
pfvf
->
mac_addr
, 
ªq
->mac_addr);

1611 
rc
 = 
	`rvu_≈c_exa˘_dñ_èbÀ_íåy_by_id
(
rvu
, 
ªq
->
ödex
);

1612 i‡(
rc
) {

1614 
	`dev_dbg
(
rvu
->
dev
, "%†MAC (%pMËdñ PF=%d faûed\n", 
__func__
,

1615 
pfvf
->
mac_addr
, 
pf
);

1618 
rc
 = 
	`rvu_≈c_exa˘_add_èbÀ_íåy
(
rvu
, 
cgx_id
, 
lmac_id
, 
ªq
->
mac_addr
,

1619 
pfvf
->
rx_ch™_ba£
, 0, &
£q_id
, 
åue
,

1620 
mˇm_idx
, 
ªq
->
hdr
.
pcifunc
);

1621 i‡(
rc
) {

1622 
	`dev_îr
(
rvu
->
dev
, "%†MAC (%pMËadd PF=%d faûed\n", 
__func__
,

1623 
ªq
->
mac_addr
, 
pf
);

1624  
LMAC_AF_ERR_EXACT_MATCH_TBL_ADD_FAILED
;

1627 
r•
->
ödex
 = 
£q_id
;

1628 
	`dev_dbg
(
rvu
->
dev
,

1630 
__func__
, 
ªq
->
mac_addr
, 
pfvf
->mac_addr,Öfvf->
deÁu…_mac
, 
pf
, 
£q_id
);

1632 
	`ëhî_addr_c›y
(
pfvf
->
mac_addr
, 
ªq
->mac_addr);

1634 
	}
}

1643 
	$rvu_≈c_exa˘_mac_addr_add
(
rvu
 *rvu,

1644 
cgx_mac_addr_add_ªq
 *
ªq
,

1645 
cgx_mac_addr_add_r•
 *
r•
)

1647 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1648 
rvu_pfvf
 *
pfvf
;

1649 
u8
 
cgx_id
, 
lmac_id
;

1650 
rc
 = 0;

1651 
u32
 
£q_id
;

1653 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1654 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

1656 
rc
 = 
	`rvu_≈c_exa˘_add_èbÀ_íåy
(
rvu
, 
cgx_id
, 
lmac_id
, 
ªq
->
mac_addr
,

1657 
pfvf
->
rx_ch™_ba£
, 0, &
£q_id
,

1658 
åue
, -1, 
ªq
->
hdr
.
pcifunc
);

1660 i‡(!
rc
) {

1661 
r•
->
ödex
 = 
£q_id
;

1662 
	`dev_dbg
(
rvu
->
dev
, "%s MAC (%pM)áddÅo PF=%d success (seq_id=%u)\n",

1663 
__func__
, 
ªq
->
mac_addr
, 
pf
, 
£q_id
);

1667 
	`dev_îr
(
rvu
->
dev
, "%†MAC (%pMËaddÅÿPF=%d faûed\n", 
__func__
,

1668 
ªq
->
mac_addr
, 
pf
);

1669  
LMAC_AF_ERR_EXACT_MATCH_TBL_ADD_FAILED
;

1670 
	}
}

1679 
	$rvu_≈c_exa˘_mac_addr_dñ
(
rvu
 *rvu,

1680 
cgx_mac_addr_dñ_ªq
 *
ªq
,

1681 
msg_r•
 *
r•
)

1683 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1684 
rc
;

1686 
rc
 = 
	`rvu_≈c_exa˘_dñ_èbÀ_íåy_by_id
(
rvu
, 
ªq
->
ödex
);

1687 i‡(!
rc
) {

1688 
	`dev_dbg
(
rvu
->
dev
, "%s delÅo PF=%d success (seq_id=%u)\n",

1689 
__func__
, 
pf
, 
ªq
->
ödex
);

1693 
	`dev_îr
(
rvu
->
dev
, "%s delÅo PF=%d failed (seq_id=%u)\n",

1694 
__func__
, 
pf
, 
ªq
->
ödex
);

1695  
LMAC_AF_ERR_EXACT_MATCH_TBL_DEL_FAILED
;

1696 
	}
}

1705 
	$rvu_≈c_exa˘_mac_addr_£t
(
rvu
 *rvu, 
cgx_mac_addr_£t_‹_gë
 *
ªq
,

1706 
cgx_mac_addr_£t_‹_gë
 *
r•
)

1708 
pf
 = 
	`rvu_gë_pf
(
ªq
->
hdr
.
pcifunc
);

1709 
u32
 
£q_id
 = 
ªq
->
ödex
;

1710 
rvu_pfvf
 *
pfvf
;

1711 
u8
 
cgx_id
, 
lmac_id
;

1712 
u32
 
mˇm_idx
 = -1;

1713 
rc
, 
nixlf
;

1715 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
pf
], &
cgx_id
, &
lmac_id
);

1717 
pfvf
 = &
rvu
->
pf
[pf];

1722 
rc
 = 
	`rvu_≈c_exa˘_upd©e_èbÀ_íåy
(
rvu
, 
cgx_id
, 
lmac_id
, 
pfvf
->
mac_addr
,

1723 
ªq
->
mac_addr
, &
£q_id
);

1724 i‡(!
rc
) {

1725 
r•
->
ödex
 = 
£q_id
;

1726 
	`ëhî_addr_c›y
(
pfvf
->
mac_addr
, 
ªq
->mac_addr);

1727 
	`ëhî_addr_c›y
(
r•
->
mac_addr
, 
ªq
->mac_addr);

1728 
	`dev_dbg
(
rvu
->
dev
, "%s MAC (%pM) updateÅo PF=%d success\n",

1729 
__func__
, 
ªq
->
mac_addr
, 
pf
);

1734 
rc
 = 
	`rvu_≈c_exa˘_dñ_èbÀ_íåy_by_id
(
rvu
, 
ªq
->
ödex
);

1735 i‡(
rc
) {

1736 
	`dev_dbg
(
rvu
->
dev
, "%s MAC (%pM) del PF=%d failed\n",

1737 
__func__
, 
pfvf
->
mac_addr
, 
pf
);

1741 
rc
 = 
	`nix_gë_nixlf
(
rvu
, 
ªq
->
hdr
.
pcifunc
, &
nixlf
, 
NULL
);

1742 i‡(!
rc
) {

1743 
mˇm_idx
 = 
	`≈c_gë_nixlf_mˇm_ödex
(&
rvu
->
hw
->
mˇm
, 
ªq
->
hdr
.
pcifunc
,

1744 
nixlf
, 
NIXLF_UCAST_ENTRY
);

1747 
rc
 = 
	`rvu_≈c_exa˘_add_èbÀ_íåy
(
rvu
, 
cgx_id
, 
lmac_id
, 
ªq
->
mac_addr
,

1748 
pfvf
->
rx_ch™_ba£
, 0, &
£q_id
,

1749 
åue
, 
mˇm_idx
, 
ªq
->
hdr
.
pcifunc
);

1750 i‡(
rc
) {

1751 
	`dev_îr
(
rvu
->
dev
, "%s MAC (%pM)ádd PF=%d failed\n",

1752 
__func__
, 
ªq
->
mac_addr
, 
pf
);

1753  
LMAC_AF_ERR_EXACT_MATCH_TBL_ADD_FAILED
;

1756 
r•
->
ödex
 = 
£q_id
;

1757 
	`ëhî_addr_c›y
(
r•
->
mac_addr
, 
ªq
->mac_addr);

1758 
	`ëhî_addr_c›y
(
pfvf
->
mac_addr
, 
ªq
->mac_addr);

1759 
	`dev_dbg
(
rvu
->
dev
,

1761 
__func__
, 
ªq
->
mac_addr
, 
pf
, 
£q_id
);

1763 
	}
}

1770 
boﬁ
 
	$rvu_≈c_exa˘_ˇn_dißbÀ_„©uª
(
rvu
 *rvu)

1772 
≈c_exa˘_èbÀ
 *
èbÀ
 = 
rvu
->
hw
->table;

1773 
boﬁ
 
em±y
;

1775 i‡(!
rvu
->
hw
->
ˇp
.
≈c_exa˘_m©ch_íabÀd
)

1776  
Ál£
;

1778 
	`muãx_lock
(&
èbÀ
->
lock
);

1779 
em±y
 = 
	`li°_em±y
(&
èbÀ
->
lhód_gbl
);

1780 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1782  
em±y
;

1783 
	}
}

1789 
	$rvu_≈c_exa˘_dißbÀ_„©uª
(
rvu
 *rvu)

1791 
rvu
->
hw
->
ˇp
.
≈c_exa˘_m©ch_íabÀd
 = 
Ál£
;

1792 
	}
}

1799 
	$rvu_≈c_exa˘_ª£t
(
rvu
 *rvu, 
u16
 
pcifunc
)

1801 
≈c_exa˘_èbÀ
 *
èbÀ
 = 
rvu
->
hw
->table;

1802 
≈c_exa˘_èbÀ_íåy
 *
tmp
, *
ôî
;

1803 
u32
 
£q_id
;

1805 
	`muãx_lock
(&
èbÀ
->
lock
);

1806 
	`li°_f‹_óch_íåy_ß„
(
ôî
, 
tmp
, &
èbÀ
->
lhód_gbl
, 
gli°
) {

1807 i‡(
pcifunc
 !
ôî
->pcifunc)

1810 
£q_id
 = 
ôî
->seq_id;

1811 
	`dev_dbg
(
rvu
->
dev
, "%s:Ñe£âögÖcifun=%d seq_id=%u\n", 
__func__
,

1812 
pcifunc
, 
£q_id
);

1814 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1815 
	`rvu_≈c_exa˘_dñ_èbÀ_íåy_by_id
(
rvu
, 
£q_id
);

1816 
	`muãx_lock
(&
èbÀ
->
lock
);

1818 
	`muãx_u∆ock
(&
èbÀ
->
lock
);

1819 
	}
}

1829 
	$rvu_≈c_exa˘_öô
(
rvu
 *rvu)

1831 
u64
 
bˇ°_mˇ°_vÆ
, 
bˇ°_mˇ°_mask
;

1832 
≈c_exa˘_èbÀ
 *
èbÀ
;

1833 
u64
 
exa˘_vÆ
, 
exa˘_mask
;

1834 
u64
 
ch™_vÆ
, 
ch™_mask
;

1835 
u8
 
cgx_id
, 
lmac_id
;

1836 
u32
 *
dr›_mˇm_idx
;

1837 
u16
 
max_lmac_˙t
;

1838 
u64
 
≈c_c⁄°3
;

1839 
èbÀ_size
;

1840 
blkaddr
;

1841 
u16
 
pcifunc
;

1842 
îr
, 
i
;

1843 
u64
 
cfg
;

1844 
boﬁ
 
rc
;

1849 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPC
, 0);

1850 i‡(
blkaddr
 < 0) {

1851 
	`dev_îr
(
rvu
->
dev
, "%s: NPC blockÇŸ im∂emíãd\n", 
__func__
);

1852  -
EINVAL
;

1856 
≈c_c⁄°3
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NPC_AF_CONST3
);

1857 i‡(!(
≈c_c⁄°3
 & 
	`BIT_ULL
(62))) {

1858 
	`dev_öfo
(
rvu
->
dev
, "%s: No support forÉxact match support\n",

1859 
__func__
);

1864 
cfg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`NPC_AF_INTFX_KEX_CFG
(
NIX_INTF_RX
));

1865 i‡(!(
cfg
 & 
NPC_EXACT_NIBBLE_HIT
)) {

1866 
	`dev_öfo
(
rvu
->
dev
, "%s: NPCÉxact matchÇibbleÇotÉnabled in KEXÖrofile\n",

1867 
__func__
);

1872 
rvu
->
hw
->
ˇp
.
≈c_exa˘_m©ch_íabÀd
 = 
åue
;

1874 
èbÀ
 = 
	`kmÆloc
((*èbÀ), 
GFP_KERNEL
);

1875 i‡(!
èbÀ
)

1876  -
ENOMEM
;

1878 
	`dev_dbg
(
rvu
->
dev
, "%s: Mem‹yáŒoˇti⁄ f‹ÅabÀ suc˚ss\n", 
__func__
);

1879 
	`mem£t
(
èbÀ
, 0, (*table));

1880 
rvu
->
hw
->
èbÀ
 =Åable;

1883 
èbÀ
->
mem_èbÀ
.
dïth
 = 
	`FIELD_GET
(
	`GENMASK_ULL
(31, 24), 
≈c_c⁄°3
);

1884 
èbÀ
->
mem_èbÀ
.
ways
 = 
	`FIELD_GET
(
	`GENMASK_ULL
(19, 16), 
≈c_c⁄°3
);

1885 
èbÀ
->
ˇm_èbÀ
.
dïth
 = 
	`FIELD_GET
(
	`GENMASK_ULL
(15, 0), 
≈c_c⁄°3
);

1887 
	`dev_dbg
(
rvu
->
dev
, "%s: NPCÉxact match 4way_2kÅable(ways=%d, depth=%d)\n",

1888 
__func__
, 
èbÀ
->
mem_èbÀ
.
ways
,ÅabÀ->
ˇm_èbÀ
.
dïth
);

1893 i‡((
èbÀ
->
mem_èbÀ
.
dïth
 & (table->mem_table.depth - 1)) != 0) {

1894 
	`dev_îr
(
rvu
->
dev
,

1896 
__func__
, 
èbÀ
->
mem_èbÀ
.
dïth
);

1897  -
EINVAL
;

1900 
èbÀ_size
 = 
èbÀ
->
mem_èbÀ
.
dïth
 *ÅabÀ->mem_èbÀ.
ways
;

1903 
èbÀ
->
mem_èbÀ
.
bm≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
	`BITS_TO_LONGS
(
èbÀ_size
),

1904 (), 
GFP_KERNEL
);

1905 i‡(!
èbÀ
->
mem_èbÀ
.
bm≠
)

1906  -
ENOMEM
;

1908 
	`dev_dbg
(
rvu
->
dev
, "%s: AŒoˇãd bôm≠ f‹ 4way 2KÉ¡ryÅabÀ\n", 
__func__
);

1911 
èbÀ
->
ˇm_èbÀ
.
bm≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 1, (), 
GFP_KERNEL
);

1913 i‡(!
èbÀ
->
ˇm_èbÀ
.
bm≠
)

1914  -
ENOMEM
;

1916 
	`dev_dbg
(
rvu
->
dev
, "%s: AŒoˇãd bôm≠ f‹ 32É¡ry cam\n", 
__func__
);

1918 
èbÀ
->
tŸ_ids
 = (èbÀ->
mem_èbÀ
.
dïth
 *ÅabÀ->mem_èbÀ.
ways
Ë+ÅabÀ->
ˇm_èbÀ
.depth;

1919 
èbÀ
->
id_bm≠
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
	`BITS_TO_LONGS
—abÀ->
tŸ_ids
),

1920 
èbÀ
->
tŸ_ids
, 
GFP_KERNEL
);

1922 i‡(!
èbÀ
->
id_bm≠
)

1923  -
ENOMEM
;

1925 
	`dev_dbg
(
rvu
->
dev
, "%s: Allocated bitmap for id map (total=%d)\n",

1926 
__func__
, 
èbÀ
->
tŸ_ids
);

1932 
i
 = 0; i < 
NPC_EXACT_TBL_MAX_WAYS
; i++)

1933 
	`INIT_LIST_HEAD
(&
èbÀ
->
lhód_mem_tbl_íåy
[
i
]);

1935 
	`INIT_LIST_HEAD
(&
èbÀ
->
lhód_ˇm_tbl_íåy
);

1936 
	`INIT_LIST_HEAD
(&
èbÀ
->
lhód_gbl
);

1938 
	`muãx_öô
(&
èbÀ
->
lock
);

1940 
	`rvu_exa˘_c⁄fig_£¸ë_key
(
rvu
);

1941 
	`rvu_exa˘_c⁄fig_£¨ch_key
(
rvu
);

1943 
	`rvu_exa˘_c⁄fig_èbÀ_mask
(
rvu
);

1944 
	`rvu_exa˘_c⁄fig_ªsu…_˘æ
(
rvu
, 
èbÀ
->
mem_èbÀ
.
dïth
);

1949 
exa˘_vÆ
 = !
NPC_EXACT_RESULT_HIT
;

1950 
exa˘_mask
 = 
NPC_EXACT_RESULT_HIT
;

1955 
bˇ°_mˇ°_vÆ
 = 0b0000;

1956 
bˇ°_mˇ°_mask
 = 0b0011;

1959 
dr›_mˇm_idx
 = &
èbÀ
->
num_dr›_ruÀs
;

1964 
	#MAX_LMAC_PER_CGX
 4

	)

1965 
max_lmac_˙t
 = 
rvu
->
cgx_˙t_max
 * 
MAX_LMAC_PER_CGX
 + 
PF_CGXMAP_BASE
;

1966 
i
 = 
PF_CGXMAP_BASE
; i < 
max_lmac_˙t
; i++) {

1967 i‡(
rvu
->
pf2cgxlmac_m≠
[
i
] == 0xFF)

1970 
	`rvu_gë_cgx_lmac_id
(
rvu
->
pf2cgxlmac_m≠
[
i
], &
cgx_id
, &
lmac_id
);

1972 
rc
 = 
	`rvu_≈c_exa˘_ˇlc_dr›_ruÀ_ch™_™d_mask
(
rvu
, 
NIX_INTF_TYPE_CGX
, 
cgx_id
,

1973 
lmac_id
, &
ch™_vÆ
, &
ch™_mask
);

1974 i‡(!
rc
) {

1975 
	`dev_îr
(
rvu
->
dev
,

1977 
__func__
, 
ch™_vÆ
, 
ch™_mask
, *
dr›_mˇm_idx
);

1978  -
EINVAL
;

1982 
pcifunc
 = 
	`RVU_PFFUNC
(
i
, 0);

1984 
	`dev_dbg
(
rvu
->
dev
,

1986 
__func__
, 
cgx_id
, 
lmac_id
, 
ch™_vÆ
, 
ch™_mask
);

1988 
rc
 = 
	`rvu_≈c_exa˘_ßve_dr›_ruÀ_ch™_™d_mask
(
rvu
, 
èbÀ
->
num_dr›_ruÀs
,

1989 
ch™_vÆ
, 
ch™_mask
, 
pcifunc
);

1990 i‡(!
rc
) {

1991 
	`dev_îr
(
rvu
->
dev
,

1993 
__func__
, 
cgx_id
, 
lmac_id
, 
ch™_vÆ
);

1994  -
EINVAL
;

1997 
îr
 = 
	`≈c_ö°Æl_mˇm_dr›_ruÀ
(
rvu
, *
dr›_mˇm_idx
,

1998 &
èbÀ
->
cou¡î_idx
[*
dr›_mˇm_idx
],

1999 
ch™_vÆ
, 
ch™_mask
,

2000 
exa˘_vÆ
, 
exa˘_mask
,

2001 
bˇ°_mˇ°_vÆ
, 
bˇ°_mˇ°_mask
);

2002 i‡(
îr
) {

2003 
	`dev_îr
(
rvu
->
dev
,

2005 
cgx_id
, 
lmac_id
);

2006  
îr
;

2009 (*
dr›_mˇm_idx
)++;

2012 
	`dev_öfo
(
rvu
->
dev
, "initializedÉxact matchÅable successfully\n");

2014 
	}
}

	@rvu_npc_hash.h

8 #i‚de‡
__RVU_NPC_HASH_H


9 
	#__RVU_NPC_HASH_H


	)

11 
	#RVU_NPC_HASH_SECRET_KEY0
 0xa9d5af4c9fbc76b1

	)

12 
	#RVU_NPC_HASH_SECRET_KEY1
 0xa9d5af4c9fbc87b4

	)

13 
	#RVU_NPC_HASH_SECRET_KEY2
 0x5954c9e7

	)

15 
	#NPC_MAX_HASH
 2

	)

16 
	#NPC_MAX_HASH_MASK
 2

	)

18 
	#KEX_LD_CFG_USE_HASH
(
u£_hash
, 
byãsm1
, 
hdr_ofs
, 
ía
, 
Êags_ía
, 
key_ofs
) \

19 ((
u£_hash
Ë<< 20 | ((
byãsm1
Ë<< 16Ë| ((
hdr_ofs
) << 8) | \

20 ((
ía
Ë<< 7Ë| ((
Êags_ía
Ë<< 6Ë| ((
key_ofs
Ë& 0x3F))

	)

21 
	#KEX_LD_CFG_HASH
(
hdr_ofs
, 
byãsm1
, 
…_í
, 
lid_í
, 
lid
, 
…y≥_m©ch
, 
…y≥_mask
) \

22 (((
hdr_ofs
Ë<< 32Ë| ((
byãsm1
) << 16) | \

23 ((
…_í
Ë<< 12Ë| ((
lid_í
Ë<< 11Ë| ((
lid
) << 8) | \

24 ((
…y≥_m©ch
Ë<< 4Ë| ((
…y≥_mask
Ë& 0xF))

	)

26 
	#SET_KEX_LD_HASH
(
ötf
, 
ld
, 
cfg
) \

27 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, \

28 
	`NPC_AF_INTFX_HASHX_CFG
(
ötf
, 
ld
), 
cfg
)

	)

30 
	#SET_KEX_LD_HASH_MASK
(
ötf
, 
ld
, 
mask_idx
, 
cfg
) \

31 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, \

32 
	`NPC_AF_INTFX_HASHX_MASKX
(
ötf
, 
ld
, 
mask_idx
), 
cfg
)

	)

34 
	#SET_KEX_LD_HASH_CTRL
(
ötf
, 
ld
, 
cfg
) \

35 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, \

36 
	`NPC_AF_INTFX_HASHX_RESULT_CTRL
(
ötf
, 
ld
), 
cfg
)

	)

38 
	s≈c_mˇm_kex_hash
 {

40 
boﬁ
 
	mlid_…_ld_hash_í
[
NPC_MAX_INTF
][
NPC_MAX_LID
][
NPC_MAX_LT
][
NPC_MAX_LD
];

42 
u64
 
	mhash
[
NPC_MAX_INTF
][
NPC_MAX_HASH
];

44 
u64
 
	mhash_mask
[
NPC_MAX_INTF
][
NPC_MAX_HASH
][
NPC_MAX_HASH_MASK
];

46 
u64
 
	mhash_˘æ
[
NPC_MAX_INTF
][
NPC_MAX_HASH
];

47 } 
	g__∑cked
;

49 
≈c_upd©e_fõld_hash
(
rvu
 *rvu, 
u8
 
ötf
,

50 
mˇm_íåy
 *
íåy
,

51 
blkaddr
,

52 
u64
 
„©uªs
,

53 
Êow_msg
 *
pkt
,

54 
Êow_msg
 *
mask
,

55 
Êow_msg
 *
›kt
,

56 
Êow_msg
 *
omask
);

57 
≈c_c⁄fig_£¸ë_key
(
rvu
 *rvu, 
blkaddr
);

58 
≈c_¥ogøm_mkex_hash
(
rvu
 *rvu, 
blkaddr
);

59 
u32
 
≈c_fõld_hash_ˇlc
(
u64
 *
ld©a
, 
≈c_mˇm_kex_hash
 *
mkex_hash
,

60 
u64
 *
£¸ë_key
, 
u8
 
ötf
, u8 
hash_idx
);

62 
≈c_mˇm_kex_hash
 
≈c_mkex_hash_deÁu…
 
	g__maybe_unu£d
 = {

63 .
lid_…_ld_hash_í
 = {

64 [
NIX_INTF_RX
] = {

65 [
NPC_LID_LC
] = {

66 [
NPC_LT_LC_IP6
] = {

67 
åue
,

68 
åue
,

73 [
NIX_INTF_TX
] = {

74 [
NPC_LID_LC
] = {

75 [
NPC_LT_LC_IP6
] = {

76 
åue
,

77 
åue
,

83 .
	ghash
 = {

84 [
NIX_INTF_RX
] = {

85 
KEX_LD_CFG_HASH
(0x8ULL, 0xf, 0x1, 0x1, 
NPC_LID_LC
, 
NPC_LT_LC_IP6
, 0xf),

86 
KEX_LD_CFG_HASH
(0x18ULL, 0xf, 0x1, 0x1, 
NPC_LID_LC
, 
NPC_LT_LC_IP6
, 0xf),

89 [
NIX_INTF_TX
] = {

90 
KEX_LD_CFG_HASH
(0x8ULL, 0xf, 0x1, 0x1, 
NPC_LID_LC
, 
NPC_LT_LC_IP6
, 0xf),

91 
KEX_LD_CFG_HASH
(0x18ULL, 0xf, 0x1, 0x1, 
NPC_LID_LC
, 
NPC_LT_LC_IP6
, 0xf),

95 .
	ghash_mask
 = {

96 [
NIX_INTF_RX
] = {

98 
GENMASK_ULL
(63, 0),

99 
GENMASK_ULL
(63, 0),

102 
GENMASK_ULL
(63, 0),

103 
GENMASK_ULL
(63, 0),

107 [
NIX_INTF_TX
] = {

109 
GENMASK_ULL
(63, 0),

110 
GENMASK_ULL
(63, 0),

113 
GENMASK_ULL
(63, 0),

114 
GENMASK_ULL
(63, 0),

119 .
	ghash_˘æ
 = {

120 [
NIX_INTF_RX
] = {

121 [0] = 
GENMASK_ULL
(63, 32),

122 [1] = 
GENMASK_ULL
(63, 32),

125 [
NIX_INTF_TX
] = {

126 [0] = 
GENMASK_ULL
(63, 32),

127 [1] = 
GENMASK_ULL
(63, 32),

133 
	#NPC_MCAM_DROP_RULE_MAX
 30

	)

134 
	#NPC_MCAM_SDP_DROP_RULE_IDX
 0

	)

136 
	#RVU_PFFUNC
(
pf
, 
func
) \

137 ((((
pf
Ë& 
RVU_PFVF_PF_MASK
Ë<< 
RVU_PFVF_PF_SHIFT
) | \

138 (((
func
Ë& 
RVU_PFVF_FUNC_MASK
Ë<< 
RVU_PFVF_FUNC_SHIFT
))

	)

140 
	e≈c_exa˘_›c_ty≥
 {

141 
	mNPC_EXACT_OPC_MEM
,

142 
	mNPC_EXACT_OPC_CAM
,

145 
	s≈c_exa˘_èbÀ_íåy
 {

146 
li°_hód
 
	mli°
;

147 
li°_hód
 
	mgli°
;

148 
u32
 
	m£q_id
;

149 
u32
 
	mödex
;

150 
u32
 
	mmˇm_idx
;

152 
≈c_exa˘_›c_ty≥
 
	m›c_ty≥
;

153 
u16
 
	mch™
;

154 
u16
 
	mpcifunc
;

155 
u8
 
	mways
;

156 
u8
 
	mmac
[
ETH_ALEN
];

157 
u8
 
	m˘y≥
;

158 
u8
 
	mcgx_id
;

159 
u8
 
	mlmac_id
;

160 
boﬁ
 
	mcmd
;

163 
	s≈c_exa˘_èbÀ
 {

164 
muãx
 
	mlock
;

165 *
	mid_bm≠
;

166 
	mnum_dr›_ruÀs
;

167 
u32
 
	mtŸ_ids
;

168 
u16
 
	m˙t_cmd_ruÀs
[
NPC_MCAM_DROP_RULE_MAX
];

169 
u16
 
	mcou¡î_idx
[
NPC_MCAM_DROP_RULE_MAX
];

170 
boﬁ
 
	m¥omisc_mode
[
NPC_MCAM_DROP_RULE_MAX
];

172 
	mways
;

173 
	mdïth
;

174 *
	mbm≠
;

175 
u64
 
	mmask
;

176 
u16
 
	mhash_mask
;

177 
u16
 
	mhash_off£t
;

178 } 
	mmem_èbÀ
;

181 
	mdïth
;

182 *
	mbm≠
;

183 } 
	mˇm_èbÀ
;

186 
boﬁ
 
	mvÆid
;

187 
u16
 
	mch™_vÆ
;

188 
u16
 
	mch™_mask
;

189 
u16
 
	mpcifunc
;

190 
u8
 
	mdr›_ruÀ_idx
;

191 } 
	mdr›_ruÀ_m≠
[
NPC_MCAM_DROP_RULE_MAX
];

193 
	#NPC_EXACT_TBL_MAX_WAYS
 4

	)

195 
li°_hód
 
	mlhód_mem_tbl_íåy
[
NPC_EXACT_TBL_MAX_WAYS
];

196 
	mmem_tbl_íåy_˙t
;

198 
li°_hód
 
	mlhód_ˇm_tbl_íåy
;

199 
	mˇm_tbl_íåy_˙t
;

201 
li°_hód
 
	mlhód_gbl
;

204 
boﬁ
 
rvu_≈c_exa˘_has_m©ch_èbÀ
(
rvu
 *rvu);

205 
u32
 
rvu_≈c_exa˘_gë_max_íåõs
(
rvu
 *rvu);

206 
rvu_≈c_exa˘_öô
(
rvu
 *rvu);

207 
rvu_≈c_exa˘_mac_addr_ª£t
(
rvu
 *rvu, 
cgx_mac_addr_ª£t_ªq
 *
ªq
,

208 
msg_r•
 *
r•
);

210 
rvu_≈c_exa˘_mac_addr_upd©e
(
rvu
 *rvu,

211 
cgx_mac_addr_upd©e_ªq
 *
ªq
,

212 
cgx_mac_addr_upd©e_r•
 *
r•
);

214 
rvu_≈c_exa˘_mac_addr_add
(
rvu
 *rvu,

215 
cgx_mac_addr_add_ªq
 *
ªq
,

216 
cgx_mac_addr_add_r•
 *
r•
);

218 
rvu_≈c_exa˘_mac_addr_dñ
(
rvu
 *rvu,

219 
cgx_mac_addr_dñ_ªq
 *
ªq
,

220 
msg_r•
 *
r•
);

222 
rvu_≈c_exa˘_mac_addr_£t
(
rvu
 *rvu, 
cgx_mac_addr_£t_‹_gë
 *
ªq
,

223 
cgx_mac_addr_£t_‹_gë
 *
r•
);

225 
rvu_≈c_exa˘_ª£t
(
rvu
 *rvu, 
u16
 
pcifunc
);

227 
boﬁ
 
rvu_≈c_exa˘_ˇn_dißbÀ_„©uª
(
rvu
 *rvu);

228 
rvu_≈c_exa˘_dißbÀ_„©uª
(
rvu
 *rvu);

229 
rvu_≈c_exa˘_ª£t
(
rvu
 *rvu, 
u16
 
pcifunc
);

230 
u16
 
rvu_≈c_exa˘_dr›_ruÀ_to_pcifunc
(
rvu
 *rvu, 
u32
 
dr›_ruÀ_idx
);

231 
rvu_≈c_exa˘_¥omisc_dißbÀ
(
rvu
 *rvu, 
u16
 
pcifunc
);

232 
rvu_≈c_exa˘_¥omisc_íabÀ
(
rvu
 *rvu, 
u16
 
pcifunc
);

	@rvu_ree.c

8 
	~"rvu.h
"

9 
	~"rvu_ªg.h
"

12 
	#MAX_REE_BLKS
 2

	)

15 
	#REE_GRAPH_CNT
 (16 * 1024 * 1024)

	)

20 
	#REE_PREFIX_PTR_LEN
 1024

	)

21 
	#REE_PREFIX_CNT
 (128 * 1024)

	)

24 
	#REE_RULE_DB_ALLOC_SIZE
 (4 * 1024 * 1024)

	)

25 
	#REE_RULE_DB_ALLOC_SHIFT
 22

	)

26 
	#REE_RULE_DB_BLOCK_CNT
 64

	)

29 
	#REE_RULE_DBI_SIZE
 (16 * 6)

	)

32 
	#REE_AQ_SIZE
 128

	)

34 c⁄° *
	gªe_úq_«me
[
MAX_REE_BLKS
][
REE_AF_INT_VEC_CNT
] = {

39 
	eªe_cmp_›s
 {

40 
	mREE_CMP_EQ
,

41 
	mREE_CMP_GEQ
,

42 
	mREE_CMP_LEQ
,

43 
	mREE_CMP_KEY_FIELDS_MAX
,

46 
	eªe_rof_ty≥s
 {

47 
	mREE_ROF_TYPE_0
 = 0,

48 
	mREE_ROF_TYPE_1
 = 1,

49 
	mREE_ROF_TYPE_2
 = 2,

50 
	mREE_ROF_TYPE_3
 = 3,

51 
	mREE_ROF_TYPE_4
 = 4,

52 
	mREE_ROF_TYPE_5
 = 5,

53 
	mREE_ROF_TYPE_6
 = 6,

54 
	mREE_ROF_TYPE_7
 = 7,

57 
	sªe_ruÀ_db_íåy
 {

58 #i‡
deföed
(
__BIG_ENDIAN_BITFIELD
)

59 
u64
 
	maddr
 : 32;

60 
u64
 
	m∑d
 : 24;

61 
u64
 
	mty≥
 : 8;

63 
u64
 
	mty≥
 : 8;

64 
u64
 
	m∑d
 : 24;

65 
u64
 
	maddr
 : 32;

67 
u64
 
	mvÆue
;

70 
	$ªe_ªex_íabÀ
(
rvu
 *rvu, 
rvu_block
 *
block
)

72 
u64
 
ªg
;

75 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_CTRL
);

76 
ªg
 |
REE_AF_REEXM_CTRL_GO
;

77 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_CTRL
, 
ªg
);

78 
	}
}

80 
	$ªe_ªex_f‹˚_˛ock
(
rvu
 *rvu, 
rvu_block
 *
block
,

81 
boﬁ
 
f‹˚_⁄
)

83 
u64
 
ªg
;

86 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
REE_AF_CMD_CTL
);

87 i‡(
f‹˚_⁄
)

88 
ªg
 =Ñeg | 
REE_AF_FORCE_CCLK
 | 
REE_AF_FORCE_CSCLK
;

90 
ªg
 =Ñeg & ~(
REE_AF_FORCE_CCLK
 | 
REE_AF_FORCE_CSCLK
);

91 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_CMD_CTL
, 
ªg
);

92 
	}
}

94 
	$ªe_gø˚ful_dißbÀ_c⁄åﬁ
(
rvu
 *rvu,

95 
rvu_block
 *
block
, 
boﬁ
 
≠∂y
)

97 
u64
 
vÆ
, 
mask
;

98 
îr
;

104 
mask
 = 
	`GENMASK
(35, 0);

107 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
REE_AF_GRACEFUL_DIS_STATUS
Ë& 
mask
;

108 i‡(
≠∂y
 & 
vÆ
)

109  
REE_AF_ERR_Q_IS_GRACEFUL_DIS
;

110 i‡(!
≠∂y
 & !
vÆ
)

111  
REE_AF_ERR_Q_NOT_GRACEFUL_DIS
;

114 i‡(
≠∂y
)

115 
vÆ
 = 
	`GENMASK
(35, 0);

117 
vÆ
 = 0;

119 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_GRACEFUL_DIS_CTL
, 
vÆ
);

123 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
block
->
addr
, 
REE_AF_GRACEFUL_DIS_STATUS
, 
mask
,

124 !
≠∂y
);

125 i‡(
îr
) {

126 
	`dev_îr
(
rvu
->
dev
, "REE graceful disable control failed");

127  
îr
;

130 
	}
}

132 
	$ªe_ªex_¥ogømmög
(
rvu
 *rvu, 
rvu_block
 *
block
,

133 
u8
 
ö¸emíèl
)

135 
îr
;

137 i‡(!
ö¸emíèl
) {

139 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_CTRL
,

140 
REE_AF_REEXM_CTRL_INIT
);

141 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_CTRL
, 0x0);

144 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_STATUS
,

145 
REE_AF_REEXM_STATUS_INIT_DONE
, 
Ál£
);

146 i‡(
îr
) {

147 
	`dev_îr
(
rvu
->
dev
, "REEÖollÑeexm status failed");

148  
îr
;

152 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXR_CTRL
,

153 (
REE_AF_REEXR_CTRL_INIT
 |

154 
REE_AF_REEXR_CTRL_MODE_IM_L1_L2
));

157 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXR_CTRL
,

158 
REE_AF_REEXR_CTRL_MODE_IM_L1_L2
);

161 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
block
->
addr
, 
REE_AF_REEXR_STATUS
,

162 (
REE_AF_REEXR_STATUS_IM_INIT_DONE
 |

163 
REE_AF_REEXR_STATUS_L1_CACHE_INIT_DONE
 |

164 
REE_AF_REEXR_STATUS_L2_CACHE_INIT_DONE
),

165 
Ál£
);

166 i‡(
îr
) {

167 
	`dev_îr
(
rvu
->
dev
, "REE for cache done failed");

168  
îr
;

172 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXR_CTRL
,

173 (
REE_AF_REEXR_CTRL_INIT
 |

174 
REE_AF_REEXR_CTRL_MODE_L1_L2
));

177 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXR_CTRL
,

178 
REE_AF_REEXR_CTRL_MODE_L1_L2
);

181 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
block
->
addr
, 
REE_AF_REEXR_STATUS
,

182 (
REE_AF_REEXR_STATUS_L1_CACHE_INIT_DONE
 |

183 
REE_AF_REEXR_STATUS_L2_CACHE_INIT_DONE
),

184 
Ál£
);

185 i‡(
îr
) {

186 
	`dev_îr
(
rvu
->
dev
, "REE cache & init done failed");

187  
îr
;

192 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXR_CTRL
, 
REE_AF_REEXR_CTRL_GO
);

194 
	}
}

196 
	$ªe_aÁq_d⁄e_ack
(
rvu
 *rvu, 
rvu_block
 *
block
,

197 
boﬁ
 
pﬁl
)

199 
u64
 
vÆ
;

200 
îr
;

207 i‡(
pﬁl
) {

208 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
block
->
addr
, 
REE_AF_AQ_DONE
,

209 0x1, 
Ál£
);

210 i‡(
îr
) {

211 
	`dev_îr
(
rvu
->
dev
, "REE AFAQ done failed");

212  
îr
;

215 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
REE_AF_AQ_DONE
);

216 i‡(
vÆ
)

217 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_AQ_DONE_ACK
, 
vÆ
);

219 
	}
}

221 
	$ªe_aq_ö°_íq
(
rvu
 *rvu, 
rvu_block
 *
block
,

222 
ªe_r§c
 *
ªe
, 
dma_addr_t
 
hód
, 
u32
 
size
,

223 
d⁄eöt
)

225 
admö_queue
 *
aq
 = 
block
->aq;

226 
ªe_af_aq_ö°_s
 
ö°
;

229 
	`mem£t
(&
ö°
, 0, (
ªe_af_aq_ö°_s
));

230 
ö°
.
Àngth
 = 
size
;

231 
ö°
.
rof_±r_addr
 = (
u64
)
hód
;

232 
ö°
.
d⁄eöt
 = doneint;

234 
	`mem˝y
(
aq
->
ö°
->
ba£
 + (
ªe
->
aq_hód
 *áq->ö°->
íåy_sz
),

235 &
ö°
, 
aq
->ö°->
íåy_sz
);

237 
	`wmb
();

239 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_AQ_DOORBELL
, 1);

243 
ªe
->
aq_hód
++;

244 i‡(
ªe
->
aq_hód
 >
aq
->
ö°
->
qsize
)

245 
ªe
->
aq_hód
 = 0;

246 
	}
}

248 
	$ªe_ªex_mem‹y_Æloc
(
rvu
 *rvu, 
rvu_block
 *
block
,

249 
ªe_r§c
 *
ªe
, 
db_Àn
,

250 
is_ö¸emíèl
)

252 
Æloc_Àn
, 
îr
, 
i
;

259 i‡(!
ªe
->
gøph_˘x
) {

260 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
ªe
->
gøph_˘x
, 
REE_GRAPH_CNT
,

261 (
u64
));

262 i‡(
îr
)

263  
îr
;

265 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_EM_BASE
,

266 (
u64
)
ªe
->
gøph_˘x
->
iova
);

272 i‡(!
is_ö¸emíèl
)

273 
	`mem£t
(
ªe
->
gøph_˘x
->
ba£
, 0, 
REE_GRAPH_CNT
 * (
u64
));

280 i‡(!
ªe
->
¥efix_˘x
) {

281 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
ªe
->
¥efix_˘x
, 
REE_PREFIX_CNT
,

282 (
ªe_rof_s
));

283 i‡(
îr
) {

284 
	`qmem_‰ì
(
rvu
->
dev
, 
ªe
->
gøph_˘x
);

285 
ªe
->
gøph_˘x
 = 
NULL
;

286  
îr
;

293 i‡(!
ªe
->
ruÀdbi
) {

294 
ªe
->
ruÀdbi
 = 
	`kmÆloc_¨øy
(
REE_RULE_DBI_SIZE
, (*),

295 
GFP_KERNEL
);

296 i‡(!
ªe
->
ruÀdbi
) {

297 
	`qmem_‰ì
(
rvu
->
dev
, 
ªe
->
gøph_˘x
);

298 
ªe
->
gøph_˘x
 = 
NULL
;

299 
	`qmem_‰ì
(
rvu
->
dev
, 
ªe
->
¥efix_˘x
);

300 
ªe
->
¥efix_˘x
 = 
NULL
;

301  
REE_AF_ERR_RULE_DBI_ALLOC_FAILED
;

310 i‡(!
ªe
->
ruÀdb
) {

311 
ªe
->
ruÀdb
 = 
	`kmÆloc_¨øy
(
REE_RULE_DB_BLOCK_CNT
,

312 (*), 
GFP_KERNEL
);

313 i‡(!
ªe
->
ruÀdb
) {

314 
	`qmem_‰ì
(
rvu
->
dev
, 
ªe
->
gøph_˘x
);

315 
ªe
->
gøph_˘x
 = 
NULL
;

316 
	`qmem_‰ì
(
rvu
->
dev
, 
ªe
->
¥efix_˘x
);

317 
ªe
->
¥efix_˘x
 = 
NULL
;

318 
	`k‰ì
(
ªe
->
ruÀdbi
);

319 
ªe
->
ruÀdbi
 = 
NULL
;

320  
REE_AF_ERR_RULE_DB_ALLOC_FAILED
;

322 
ªe
->
ruÀdb_blocks
 = 0;

324 
Æloc_Àn
 = 
ªe
->
ruÀdb_blocks
 * 
REE_RULE_DB_ALLOC_SIZE
;

325 
Æloc_Àn
 < 
db_Àn
) {

326 i‡(
ªe
->
ruÀdb_blocks
 >
REE_RULE_DB_BLOCK_CNT
) {

333  
REE_AF_ERR_RULE_DB_TOO_BIG
;

335 
ªe
->
ruÀdb
[ªe->
ruÀdb_blocks
] =

336 
	`kmÆloc
(
REE_RULE_DB_ALLOC_SIZE
, 
GFP_KERNEL
);

337 i‡(!
ªe
->
ruÀdb
[ªe->
ruÀdb_blocks
]) {

338 
i
 = 0; i < 
ªe
->
ruÀdb_blocks
; i++)

339 
	`k‰ì
(
ªe
->
ruÀdb
[
i
]);

340 
	`qmem_‰ì
(
rvu
->
dev
, 
ªe
->
gøph_˘x
);

341 
ªe
->
gøph_˘x
 = 
NULL
;

342 
	`qmem_‰ì
(
rvu
->
dev
, 
ªe
->
¥efix_˘x
);

343 
ªe
->
¥efix_˘x
 = 
NULL
;

344 
	`k‰ì
(
ªe
->
ruÀdbi
);

345 
ªe
->
ruÀdbi
 = 
NULL
;

346 
	`k‰ì
(
ªe
->
ruÀdb
);

347 
ªe
->
ruÀdb
 = 
NULL
;

348  
REE_AF_ERR_RULE_DB_BLOCK_ALLOC_FAILED
;

350 
ªe
->
ruÀdb_blocks
 += 1;

351 
Æloc_Àn
 +
REE_RULE_DB_ALLOC_SIZE
;

355 
	}
}

358 
	$ªe_ªex_cksum_com∑ª
(
rvu
 *rvu, 
blkaddr
,

359 
ªe_ruÀ_db_íåy
 **
ruÀ_db
,

360 *
ruÀ_db_Àn
, 
ªe_cmp_›s
 
cmp
)

362 
u64
 
off£t
;

363 
u64
 
ªg
;

379 
off£t
 = 
REE_AF_REEX_CSR_BLOCK_BASE_ADDR
 +

380 ((((*
ruÀ_db
)->
addr
 & 
REE_AF_REEX_CSR_BLOCK_ID_MASK
) >>

381 
REE_AF_REEX_CSR_BLOCK_ID_SHIFT
) *

382 
REE_AF_REEX_CSR_BLOCK_ID
) +

383 (((*
ruÀ_db
)->
addr
 & 
REE_AF_REEX_CSR_INDEX_MASK
) *

384 
REE_AF_REEX_CSR_INDEX
);

385 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
off£t
);

386 
cmp
) {

387 
REE_CMP_EQ
:

388 i‡(
ªg
 !(*
ruÀ_db
)->
vÆue
) {

389 
	`dev_îr
(
rvu
->
dev
, "REEáddr %llx data %llxÇeq %llx",

390 
off£t
, 
ªg
, (*
ruÀ_db
)->
vÆue
);

391  
REE_AF_ERR_RULE_DB_EQ_BAD_VALUE
;

394 
REE_CMP_GEQ
:

395 i‡(
ªg
 < (*
ruÀ_db
)->
vÆue
) {

396 
	`dev_îr
(
rvu
->
dev
, "REEáddr %llx data %llxÇgeq %llx",

397 
off£t
, 
ªg
, (*
ruÀ_db
)->
vÆue
);

398  
REE_AF_ERR_RULE_DB_GEQ_BAD_VALUE
;

401 
REE_CMP_LEQ
:

402 i‡(
ªg
 > (*
ruÀ_db
)->
vÆue
) {

403 
	`dev_îr
(
rvu
->
dev
, "REEáddr %llx data %llxÇleq %llx",

404 
off£t
, 
ªg
, (*
ruÀ_db
)->
vÆue
);

405  
REE_AF_ERR_RULE_DB_LEQ_BAD_VALUE
;

409 
	`dev_îr
(
rvu
->
dev
, "REEáddr %llx data %llx default %llx",

410 
off£t
, 
ªg
, (*
ruÀ_db
)->
vÆue
);

411  
REE_AF_ERR_RULE_UNKNOWN_VALUE
;

414 (*
ruÀ_db
)++;

415 *
ruÀ_db_Àn
 -(
ªe_ruÀ_db_íåy
);

417 
	}
}

420 
	$ªe_ªex_¥efix_wrôe
(**
¥efix_±r
,

421 
ªe_ruÀ_db_íåy
 **
ruÀ_db
,

422 *
ruÀ_db_Àn
, 
u32
 *
cou¡
,

423 
u32
 *
db_block_Àn
)

425 
ªe_rof_s
 
rof_íåy
;

427 (*
ruÀ_db
)->
ty≥
 =
REE_ROF_TYPE_6
) {

428 
rof_íåy
.
typ
 = (*
ruÀ_db
)->
ty≥
;

429 
rof_íåy
.
addr
 = (*
ruÀ_db
)->addr;

430 
rof_íåy
.
d©a
 = (*
ruÀ_db
)->
vÆue
;

431 
	`mem˝y
((*
¥efix_±r
), (*)(&
rof_íåy
),

432 (
ªe_rof_s
));

434 (*
¥efix_±r
Ë+(
ªe_rof_s
);

436 (*
ruÀ_db
)++;

438 (*
ruÀ_db_Àn
Ë-(
ªe_ruÀ_db_íåy
);

440 (*
cou¡
)++;

442 (*
db_block_Àn
)--;

443 i‡(*
db_block_Àn
 == 0)

446 
	}
}

449 
	$ªe_ªex_gøph_wrôe
(
ªe_r§c
 *
ªe
,

450 
ªe_ruÀ_db_íåy
 **
ruÀ_db
, *
ruÀ_db_Àn
,

451 
u32
 *
db_block_Àn
)

453 
u32
 
off£t
;

455 (*
ruÀ_db
)->
ty≥
 =
REE_ROF_TYPE_7
) {

456 
off£t
 = ((*
ruÀ_db
)->
addr
 & 0xFFFFFF) << 3;

457 i‡(
off£t
 > 
REE_GRAPH_CNT
 * 8)

458  
REE_AF_ERR_GRAPH_ADDRESS_TOO_BIG
;

459 
	`mem˝y
(
ªe
->
gøph_˘x
->
ba£
 + 
off£t
,

460 &(*
ruÀ_db
)->
vÆue
, ((*rule_db)->value));

461 (*
ruÀ_db
)++;

462 *
ruÀ_db_Àn
 -(
ªe_ruÀ_db_íåy
);

464 (*
db_block_Àn
)--;

465 i‡(*
db_block_Àn
 == 0)

469 
	}
}

472 
	$ªe_rof_d©a_vÆid©i⁄
(
rvu
 *rvu, 
blkaddr
,

473 
ªe_r§c
 *
ªe
, *
db_block
,

474 
ªe_ruÀ_db_íåy
 **
ruÀ_db_±r
,

475 *
ruÀ_db_Àn
, 
u32
 *
db_block_Àn
)

477 
îr
;

480 *
ruÀ_db_Àn
 > 0) {

481 (*
ruÀ_db_±r
)->
ty≥
) {

482 
REE_ROF_TYPE_1
:

483 
îr
 = 
	`ªe_ªex_cksum_com∑ª
(
rvu
, 
blkaddr
, 
ruÀ_db_±r
,

484 
ruÀ_db_Àn
, 
REE_CMP_EQ
);

485 i‡(
îr
 < 0)

486  
îr
;

488 
REE_ROF_TYPE_2
:

489 
îr
 = 
	`ªe_ªex_cksum_com∑ª
(
rvu
, 
blkaddr
, 
ruÀ_db_±r
,

490 
ruÀ_db_Àn
, 
REE_CMP_GEQ
);

491 i‡(
îr
 < 0)

492  
îr
;

494 
REE_ROF_TYPE_3
:

495 
îr
 = 
	`ªe_ªex_cksum_com∑ª
(
rvu
, 
blkaddr
, 
ruÀ_db_±r
,

496 
ruÀ_db_Àn
, 
REE_CMP_LEQ
);

497 i‡(
îr
 < 0)

498  
îr
;

500 
REE_ROF_TYPE_4
:

502 (*
ruÀ_db_±r
)++;

503 (*
ruÀ_db_Àn
Ë-(
ªe_rof_s
);

505 
REE_ROF_TYPE_5
:

506 
îr
 = 
	`ªe_ªex_cksum_com∑ª
(
rvu
, 
blkaddr
, 
ruÀ_db_±r
,

507 
ruÀ_db_Àn
, 
REE_CMP_EQ
);

508 i‡(
îr
 < 0)

509  
îr
;

511 
REE_ROF_TYPE_6
:

512 
REE_ROF_TYPE_7
:

516 (*
ruÀ_db_±r
)++;

517 *
ruÀ_db_Àn
 -(
ªe_rof_s
);

518  
REE_AF_ERR_BAD_RULE_TYPE
;

520 (*
db_block_Àn
)--;

524 i‡(*
db_block_Àn
 == 0) {

525 (*
db_block
)++;

526 *
ruÀ_db_±r
 = 
ªe
->
ruÀdb
[(*
db_block
)];

527 *
db_block_Àn
 = (
REE_RULE_DB_ALLOC_SIZE
 >> 4);

531 
	}
}

534 
	$ªe_rof_d©a_íq
(
rvu
 *rvu, 
rvu_block
 *
block
,

535 
ªe_r§c
 *
ªe
,

536 
ªe_ruÀ_db_íåy
 **
ruÀ_db_±r
,

537 *
ruÀ_db_Àn
, *
db_block
, 
u32
 *
db_block_Àn
)

539 *
¥efix_±r
 = 
ªe
->
¥efix_˘x
->
ba£
;

540 
u32
 
size
, 
num_of_íåõs
 = 0;

541 
dma_addr_t
 
hód
;

542 
îr
;

545 *
ruÀ_db_Àn
 > 0) {

546 (*
ruÀ_db_±r
)->
ty≥
) {

547 
REE_ROF_TYPE_1
:

548 
REE_ROF_TYPE_2
:

549 
REE_ROF_TYPE_3
:

550 
REE_ROF_TYPE_4
:

551 
REE_ROF_TYPE_5
:

553 
REE_ROF_TYPE_6
:

554 
	`ªe_ªex_¥efix_wrôe
(&
¥efix_±r
, 
ruÀ_db_±r
,

555 
ruÀ_db_Àn
, &
num_of_íåõs
,

556 
db_block_Àn
);

558 
REE_ROF_TYPE_7
:

559 
îr
 = 
	`ªe_ªex_gøph_wrôe
(
ªe
, 
ruÀ_db_±r
,

560 
ruÀ_db_Àn
, 
db_block_Àn
);

561 i‡(
îr
)

562  
îr
;

566  
REE_AF_ERR_BAD_RULE_TYPE
;

571 i‡(*
db_block_Àn
 == 0) {

572 (*
db_block
)++;

573 *
ruÀ_db_±r
 = 
ªe
->
ruÀdb
[(*
db_block
)];

574 *
db_block_Àn
 = (
REE_RULE_DB_ALLOC_SIZE
 >> 4);

579 i‡(((*
ruÀ_db_±r
)->
ty≥
 !
REE_ROF_TYPE_6
) &&

580 ((*
ruÀ_db_±r
)->
ty≥
 !
REE_ROF_TYPE_7
))

587 
hód
 = 
ªe
->
¥efix_˘x
->
iova
;

588 
num_of_íåõs
 > 0) {

589 i‡(
num_of_íåõs
 > 
REE_PREFIX_PTR_LEN
) {

590 
size
 = 
REE_PREFIX_PTR_LEN
 * (
ªe_rof_s
);

591 
	`ªe_aq_ö°_íq
(
rvu
, 
block
, 
ªe
, 
hód
, 
size
, 
Ál£
);

592 
hód
 +
REE_PREFIX_PTR_LEN
 * (
ªe_rof_s
);

593 
num_of_íåõs
 -
REE_PREFIX_PTR_LEN
;

596 
size
 = 
num_of_íåõs
 * (
ªe_rof_s
);

597 
	`ªe_aq_ö°_íq
(
rvu
, 
block
, 
ªe
, 
hód
, 
size
, 
åue
);

598 
num_of_íåõs
 = 0;

602  
	`ªe_aÁq_d⁄e_ack
(
rvu
, 
block
, 
åue
);

603 
	}
}

606 
	$ªe_ruÀ_db_¥og
(
rvu
 *rvu, 
rvu_block
 *
block
,

607 
ªe_r§c
 *
ªe
, 
öc
)

610 
u32
 
db_block_Àn
 = (
REE_RULE_DB_ALLOC_SIZE
 >> 4);

611 
ªe_ruÀ_db_íåy
 *
ruÀ_db_±r
;

612 
ruÀ_db_Àn
, 
ªt
 = 0, 
db_block
 = 0;

613 
u64
 
ªg
;

616 
ªt
 = 
	`ªe_gø˚ful_dißbÀ_c⁄åﬁ
(
rvu
, 
block
, 
åue
);

617 i‡(
ªt
)

618  
ªt
;

624 
	`ªe_ªex_f‹˚_˛ock
(
rvu
, 
block
, 
åue
);

631 
ªt
 = 
	`ªe_aÁq_d⁄e_ack
(
rvu
, 
block
, 
Ál£
);

632 i‡(
ªt
)

633 
îr
;

636 
ªt
 = 
	`ªe_ªex_¥ogømmög
(
rvu
, 
block
, 
öc
);

637 i‡(
ªt
)

638 
îr
;

641 
ruÀ_db_Àn
 = 
ªe
->
ruÀdb_Àn
;

642 
ruÀ_db_±r
 = (
ªe_ruÀ_db_íåy
 *)
ªe
->
ruÀdb
[
db_block
];

643 
ªt
 = 
	`ªe_rof_d©a_vÆid©i⁄
(
rvu
, 
block
->
addr
, 
ªe
, &
db_block
,

644 &
ruÀ_db_±r
, &
ruÀ_db_Àn
,

645 &
db_block_Àn
);

646 i‡(
ªt
)

647 
îr
;

650 
ªt
 = 
	`ªe_rof_d©a_íq
(
rvu
, 
block
, 
ªe
, &
ruÀ_db_±r
, &
ruÀ_db_Àn
,

651 &
db_block
, &
db_block_Àn
);

652 i‡(
ªt
)

653 
îr
;

655 
ªt
 = 
	`ªe_rof_d©a_vÆid©i⁄
(
rvu
, 
block
->
addr
, 
ªe
, &
db_block
,

656 &
ruÀ_db_±r
, &
ruÀ_db_Àn
,

657 &
db_block_Àn
);

658 i‡(
ªt
)

659 
îr
;

662 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXR_CTRL
);

663 
ªg
 =Ñeg & ~(
REE_AF_REEXR_CTRL_GO
);

664 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXR_CTRL
, 
ªg
);

666 
	`ªe_ªex_íabÀ
(
rvu
, 
block
);

668 
îr
:

670 
	`ªe_ªex_f‹˚_˛ock
(
rvu
, 
block
, 
Ál£
);

673 
	`ªe_gø˚ful_dißbÀ_c⁄åﬁ
(
rvu
, 
block
, 
Ál£
);

675  
ªt
;

676 
	}
}

678 
	$rvu_mbox_h™dÀr_ªe_ruÀ_db_¥og
(
rvu
 *rvu,

679 
ªe_ruÀ_db_¥og_ªq_msg
 *
ªq
,

680 
msg_r•
 *
r•
)

682 
blkaddr
, 
db_block
 = 0, 
blkid
 = 0, 
îr
;

683 
rvu_block
 *
block
;

684 
ªe_r§c
 *
ªe
;

686 
blkaddr
 = 
ªq
->blkaddr;

687 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

688  
REE_AF_ERR_BLOCK_NOT_IMPLEMENTED
;

689 i‡(
blkaddr
 =
BLKADDR_REE1
)

690 
blkid
 = 1;

692 
block
 = &
rvu
->
hw
->block[
blkaddr
];

693 
ªe
 = &
rvu
->
hw
->ªe[
blkid
];

696 i‡(!
ªq
->
off£t
) {

697 i‡(
ªq
->
tŸÆ_Àn
 >

698 
REE_RULE_DB_ALLOC_SIZE
 * 
REE_RULE_DB_BLOCK_CNT
)

699  
REE_AF_ERR_RULE_DB_TOO_BIG
;

702 
îr
 = 
	`ªe_ªex_mem‹y_Æloc
(
rvu
, 
block
, 
ªe
, 
ªq
->
tŸÆ_Àn
,

703 
ªq
->
is_ö¸emíèl
);

704 i‡(
îr
)

705  
îr
;

709 
ªe
->
ruÀdb_Àn
 = 0;

710 i‡(!
ªq
->
is_ö¸emíèl
)

711 
ªe
->
ruÀdbi_Àn
 = 0;

717 i‡(
ªe
->
ruÀdb_Àn
 + 
ªq
->
Àn
 >

718 
ªe
->
ruÀdb_blocks
 * 
REE_RULE_DB_ALLOC_SIZE
)

719  
REE_AF_ERR_RULE_DB_WRONG_LENGTH
;

720 i‡(
ªe
->
ruÀdb_Àn
 !
ªq
->
off£t
)

721  
REE_AF_ERR_RULE_DB_WRONG_OFFSET
;

723 i‡(
ªq
->
Àn
 < 
REE_RULE_DB_REQ_BLOCK_SIZE
 && !ªq->
is_œ°
)

724  
REE_AF_ERR_RULE_DB_SHOULD_FILL_REQUEST
;

728 
db_block
 = 
ªe
->
ruÀdb_Àn
 >> 
REE_RULE_DB_ALLOC_SHIFT
;

729 i‡(
db_block
 >
ªe
->
ruÀdb_blocks
)

730  
REE_AF_ERR_RULE_DB_BLOCK_TOO_BIG
;

731 
	`mem˝y
((*)((
u64
)
ªe
->
ruÀdb
[
db_block
] +Ñì->
ruÀdb_Àn
 -

732 
db_block
 * 
REE_RULE_DB_ALLOC_SIZE
), 
ªq
->
ruÀ_db
,Ñeq->
Àn
);

733 
ªe
->
ruÀdb_Àn
 +
ªq
->
Àn
;

737 i‡(!
ªq
->
is_œ°
)

740 i‡(
ªq
->
tŸÆ_Àn
 !
ªe
->
ruÀdb_Àn
)

741  
REE_AF_ERR_RULE_DB_PARTIAL
;

743 i‡(!
ªq
->
is_ö¸emíèl
 ||Ñeq->
is_dbi
) {

744 
îr
 = 
	`ªe_ruÀ_db_¥og
(
rvu
, 
block
, 
ªe
, 
ªq
->
is_ö¸emíèl
);

745 i‡(
îr
)

746  
îr
;

749 i‡(
ªq
->
is_dbi
) {

750 
	`mem˝y
(
ªe
->
ruÀdbi
,

751 
ªe
->
ruÀdb
[
db_block
] +

752 
ªq
->
tŸÆ_Àn
 - 
REE_RULE_DBI_SIZE
,

753 
REE_RULE_DBI_SIZE
);

754 
ªe
->
ruÀdbi_Àn
 = 
REE_RULE_DBI_SIZE
;

758 
	}
}

761 
	$rvu_mbox_h™dÀr_ªe_ruÀ_db_gë
(
rvu
 *rvu,

762 
ªe_ruÀ_db_gë_ªq_msg
 *
ªq
,

763 
ªe_ruÀ_db_gë_r•_msg
 *
r•
)

765 
blkaddr
, 
Àn
, 
blkid
 = 0, 
db_block
;

766 
ªe_r§c
 *
ªe
;

768 
blkaddr
 = 
ªq
->blkaddr;

769 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

770  
REE_AF_ERR_BLOCK_NOT_IMPLEMENTED
;

771 i‡(
blkaddr
 =
BLKADDR_REE1
)

772 
blkid
 = 1;

773 
ªe
 = &
rvu
->
hw
->ªe[
blkid
];

776 i‡((
ªq
->
is_dbi
 && 
ªe
->
ruÀdbi_Àn
 == 0) ||

777 (!
ªq
->
is_dbi
 && 
ªe
->
ruÀdb_Àn
 == 0)) {

778 
r•
->
Àn
 = 0;

785 i‡(
ªq
->
is_dbi
) {

786 i‡(
ªe
->
ruÀdbi_Àn
 < 
ªq
->
off£t
)

787  
REE_AF_ERR_RULE_DB_INC_OFFSET_TOO_BIG
;

788 
Àn
 = 
ªe
->
ruÀdbi_Àn
 - 
ªq
->
off£t
;

790 i‡(
ªe
->
ruÀdb_Àn
 < 
ªq
->
off£t
)

791  
REE_AF_ERR_RULE_DB_OFFSET_TOO_BIG
;

792 
Àn
 = 
ªe
->
ruÀdb_Àn
 - 
ªq
->
off£t
;

796 i‡(
Àn
 < 
REE_RULE_DB_RSP_BLOCK_SIZE
) {

797 
r•
->
is_œ°
 = 
åue
;

798 
r•
->
Àn
 =Üen;

800 
r•
->
is_œ°
 = 
Ál£
;

801 
r•
->
Àn
 = 
REE_RULE_DB_RSP_BLOCK_SIZE
;

805 i‡(
ªq
->
is_dbi
) {

806 
	`mem˝y
(
r•
->
ruÀ_db
, 
ªe
->
ruÀdbi
 + 
ªq
->
off£t
,Ñ•->
Àn
);

808 
db_block
 = 
ªq
->
off£t
 >> 22;

809 
	`mem˝y
(
r•
->
ruÀ_db
, 
ªe
->
ruÀdb
[
db_block
] + 
ªq
->
off£t
,

810 
r•
->
Àn
);

814 
	}
}

817 
	$rvu_mbox_h™dÀr_ªe_ruÀ_db_Àn_gë
(
rvu
 *rvu, 
ªe_ªq_msg
 *
ªq
,

818 
ªe_ruÀ_db_Àn_r•_msg
 *
r•
)

820 
blkaddr
, 
blkid
 = 0;

822 
blkaddr
 = 
ªq
->blkaddr;

823 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

824  
REE_AF_ERR_BLOCK_NOT_IMPLEMENTED
;

825 i‡(
blkaddr
 =
BLKADDR_REE1
)

826 
blkid
 = 1;

827 
r•
->
Àn
 = 
rvu
->
hw
->
ªe
[
blkid
].
ruÀdb_Àn
;

828 
r•
->
öc_Àn
 = 
rvu
->
hw
->
ªe
[
blkid
].
ruÀdbi_Àn
;

830 
	}
}

832 
	$rvu_mbox_h™dÀr_ªe_c⁄fig_lf
(
rvu
 *rvu,

833 
ªe_lf_ªq_msg
 *
ªq
,

834 
msg_r•
 *
r•
)

836 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

837 
lf
, 
blkaddr
, 
num_lfs
;

838 
rvu_block
 *
block
;

839 
u64
 
vÆ
;

841 
blkaddr
 = 
ªq
->blkaddr;

842 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

843  
REE_AF_ERR_BLOCK_NOT_IMPLEMENTED
;

844 
block
 = &
rvu
->
hw
->block[
blkaddr
];

849 
lf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 
ªq
->lf);

850 i‡(
lf
 < 0)

851  
REE_AF_ERR_LF_INVALID
;

853 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
),

854 
blkaddr
);

855 i‡(
lf
 >
num_lfs
)

856  
REE_AF_ERR_LF_NO_MORE_RESOURCES
;

861 i‡(
ªq
->
¥i
 > 1)

862  
REE_AF_ERR_LF_WRONG_PRIORITY
;

863 i‡(
ªq
->
size
 > 
REE_AF_QUE_SBUF_CTL_MAX_SIZE
)

864  
REE_AF_ERR_LF_SIZE_TOO_BIG
;

865 
vÆ
 = 
ªq
->
size
;

866 
vÆ
 = vÆ << 
REE_AF_QUE_SBUF_CTL_SIZE_SHIFT
;

867 
vÆ
 +
ªq
->
¥i
;

868 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`REE_AF_QUE_SBUF_CTL
(
lf
), 
vÆ
);

871 
	}
}

873 
	$rvu_mbox_h™dÀr_ªe_rd_wr_ªgi°î
(
rvu
 *rvu,

874 
ªe_rd_wr_ªg_msg
 *
ªq
,

875 
ªe_rd_wr_ªg_msg
 *
r•
)

877 
blkaddr
;

879 
blkaddr
 = 
ªq
->blkaddr;

880 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

881  
REE_AF_ERR_BLOCK_NOT_IMPLEMENTED
;

882 
r•
->
ªg_off£t
 = 
ªq
->reg_offset;

883 
r•
->
ªt_vÆ
 = 
ªq
->ret_val;

884 
r•
->
is_wrôe
 = 
ªq
->is_write;

886 
ªq
->
ªg_off£t
) {

887 
REE_AF_REEXM_MAX_MATCH
:

892  
REE_AF_ERR_ACCESS_DENIED
;

895 i‡(
ªq
->
is_wrôe
)

896 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªq
->
ªg_off£t
,Ñeq->
vÆ
);

898 
r•
->
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
ªq
->
ªg_off£t
);

901 
	}
}

903 
	$ªe_aq_ö°_Æloc
(
rvu
 *rvu, 
admö_queue
 **
ad_queue
,

904 
qsize
, 
ö°_size
, 
ªs_size
)

906 
admö_queue
 *
aq
;

907 
îr
;

909 *
ad_queue
 = 
	`devm_kzÆloc
(
rvu
->
dev
, (*
aq
), 
GFP_KERNEL
);

910 i‡(!*
ad_queue
)

911  -
ENOMEM
;

912 
aq
 = *
ad_queue
;

915 
îr
 = 
	`qmem_Æloc
(
rvu
->
dev
, &
aq
->
ö°
, 
qsize
, 
ö°_size
);

916 i‡(
îr
) {

917 
	`devm_k‰ì
(
rvu
->
dev
, 
aq
);

918  
îr
;

922 
aq
->
ªs
 = 
NULL
;

925 
	}
}

927 
úqªtu∫_t
 
	$rvu_ªe_af_øs_öå_h™dÀr
(
úq
, *
±r
)

929 
rvu_block
 *
block
 = 
±r
;

930 
rvu
 *rvu = 
block
->rvu;

931 
blkaddr
 = 
block
->
addr
;

932 
u64
 
öå
;

934 i‡(
blkaddr
 < 0)

935  
IRQ_NONE
;

937 
öå
 = 
	`rvu_ªad64
(
block
->
rvu
, 
blkaddr
, 
REE_AF_RAS
);

938 i‡(
öå
 & 
REE_AF_RAS_DAT_PSN
)

939 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "REE: PoisonÑeceived oná NCB dataÑesponse\n");

940 i‡(
öå
 & 
REE_AF_RAS_LD_CMD_PSN
)

941 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "REE: PoisonÑeceived oná NCB instructionÑesponse\n");

942 i‡(
öå
 & 
REE_AF_RAS_LD_REEX_PSN
)

943 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "REE: PoisonÑeceived oná REEXÑesponse\n");

946 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_RAS
, 
öå
);

947  
IRQ_HANDLED
;

948 
	}
}

950 
úqªtu∫_t
 
	$rvu_ªe_af_rvu_öå_h™dÀr
(
úq
, *
±r
)

952 
rvu_block
 *
block
 = 
±r
;

953 
rvu
 *rvu = 
block
->rvu;

954 
blkaddr
 = 
block
->
addr
;

955 
u64
 
öå
;

957 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_REE
, 0);

958 i‡(
blkaddr
 < 0)

959  
IRQ_NONE
;

961 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
REE_AF_RVU_INT
);

962 i‡(
öå
 & 
REE_AF_RVU_INT_UNMAPPED_SLOT
)

963 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "REE: Unmapped slotÉrror\n");

966 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_RVU_INT
, 
öå
);

967  
IRQ_HANDLED
;

968 
	}
}

970 
úqªtu∫_t
 
	$rvu_ªe_af_aq_öå_h™dÀr
(
úq
, *
±r
)

972 
rvu_block
 *
block
 = 
±r
;

973 
rvu
 *rvu = 
block
->rvu;

974 
blkaddr
 = 
block
->
addr
;

975 
u64
 
öå
;

977 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_REE
, 0);

978 i‡(
blkaddr
 < 0)

979  
IRQ_NONE
;

981 
öå
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
REE_AF_AQ_INT
);

983 i‡(
öå
 & 
REE_AF_AQ_INT_DOVF
)

984 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "REE: DOORBELL overflow\n");

985 i‡(
öå
 & 
REE_AF_AQ_INT_IRDE
)

986 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "REE: Instruction NCBÑeadÑesponseÉrror\n");

987 i‡(
öå
 & 
REE_AF_AQ_INT_PRDE
)

988 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "REE: Payload NCBÑeadÑesponseÉrror\n");

989 i‡(
öå
 & 
REE_AF_AQ_INT_PLLE
)

990 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "REE: PayloadÜengthÉrror\n");

993 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_AQ_INT
, 
öå
);

994  
IRQ_HANDLED
;

995 
	}
}

997 
	$rvu_ªe_uƒegi°î_öãºu±s_block
(
rvu
 *rvu, 
blkaddr
)

999 
i
, 
offs
;

1000 
rvu_block
 *
block
;

1001 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1003 i‡(!
	`is_block_im∂emíãd
(
hw
, 
blkaddr
))

1005 
block
 = &
hw
->block[
blkaddr
];

1007 
offs
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
REE_PRIV_AF_INT_CFG
) & 0x7FF;

1008 i‡(!
offs
) {

1009 
	`dev_w¨n
(
rvu
->
dev
,

1015 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_RAS_ENA_W1C
, 0x1);

1016 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_RVU_INT_ENA_W1C
, 0x1);

1017 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_AQ_DONE_INT_ENA_W1C
, 0x1);

1018 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_AQ_INT_ENA_W1C
, 0x1);

1020 
i
 = 0; i < 
REE_AF_INT_VEC_CNT
; i++)

1021 i‡(
rvu
->
úq_Æloˇãd
[
offs
 + 
i
]) {

1022 
	`‰ì_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
offs
 + 
i
), 
block
);

1023 
rvu
->
úq_Æloˇãd
[
offs
 + 
i
] = 
Ál£
;

1025 
	}
}

1027 
	$rvu_ªe_uƒegi°î_öãºu±s
(
rvu
 *rvu)

1029 
	`rvu_ªe_uƒegi°î_öãºu±s_block
(
rvu
, 
BLKADDR_REE0
);

1030 
	`rvu_ªe_uƒegi°î_öãºu±s_block
(
rvu
, 
BLKADDR_REE1
);

1031 
	}
}

1033 
	$rvu_ªe_af_ªque°_úq
(
rvu_block
 *
block
,

1034 
off£t
, 
úq_h™dÀr_t
 
h™dÀr
,

1035 c⁄° *
«me
)

1037 
ªt
 = 0;

1038 
rvu
 *rvu = 
block
->rvu;

1040 
	`WARN_ON
(
rvu
->
úq_Æloˇãd
[
off£t
]);

1041 
rvu
->
úq_Æloˇãd
[
off£t
] = 
Ál£
;

1042 
	`•rötf
(&
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], "%s", 
«me
);

1043 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
off£t
), 
h™dÀr
, 0,

1044 &
rvu
->
úq_«me
[
off£t
 * 
NAME_SIZE
], 
block
);

1045 i‡(
ªt
)

1046 
	`dev_w¨n
(
block
->
rvu
->
dev
, "FaûedÅÿªgi°î %†úq\n", 
«me
);

1048 
rvu
->
úq_Æloˇãd
[
off£t
] = 
åue
;

1050  
rvu
->
úq_Æloˇãd
[
off£t
];

1051 
	}
}

1053 
	$rvu_ªe_ªgi°î_öãºu±s_block
(
rvu
 *rvu, 
blkaddr
,

1054 
blkid
)

1056 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1057 
rvu_block
 *
block
;

1058 
offs
, 
ªt
 = 0;

1060 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

1063 
block
 = &
hw
->block[
blkaddr
];

1066 
offs
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
REE_PRIV_AF_INT_CFG
) & 0x7FF;

1067 i‡(!
offs
) {

1068 
	`dev_w¨n
(
rvu
->
dev
,

1074 
ªt
 = 
	`rvu_ªe_af_ªque°_úq
(
block
, 
offs
 + 
REE_AF_INT_VEC_RAS
,

1075 
rvu_ªe_af_øs_öå_h™dÀr
,

1076 
ªe_úq_«me
[
blkid
][
REE_AF_INT_VEC_RAS
]);

1077 i‡(!
ªt
)

1078 
îr
;

1079 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_RAS_ENA_W1S
, ~0ULL);

1082 
ªt
 = 
	`rvu_ªe_af_ªque°_úq
(
block
, 
offs
 + 
REE_AF_INT_VEC_RVU
,

1083 
rvu_ªe_af_rvu_öå_h™dÀr
,

1084 
ªe_úq_«me
[
blkid
][
REE_AF_INT_VEC_RVU
]);

1085 i‡(!
ªt
)

1086 
îr
;

1087 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_RVU_INT_ENA_W1S
, ~0ULL);

1095 
ªt
 = 
	`rvu_ªe_af_ªque°_úq
(
block
, 
offs
 + 
REE_AF_INT_VEC_AQ
,

1096 
rvu_ªe_af_aq_öå_h™dÀr
,

1097 
ªe_úq_«me
[
blkid
][
REE_AF_INT_VEC_AQ
]);

1098 i‡(!
ªt
)

1099 
îr
;

1100 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
REE_AF_AQ_INT_ENA_W1S
, ~0ULL);

1103 
îr
:

1104 
	`rvu_ªe_uƒegi°î_öãºu±s
(
rvu
);

1105  
ªt
;

1106 
	}
}

1108 
	$rvu_ªe_ªgi°î_öãºu±s
(
rvu
 *rvu)

1110 
ªt
;

1112 
ªt
 = 
	`rvu_ªe_ªgi°î_öãºu±s_block
(
rvu
, 
BLKADDR_REE0
, 0);

1113 i‡(
ªt
)

1114  
ªt
;

1116  
	`rvu_ªe_ªgi°î_öãºu±s_block
(
rvu
, 
BLKADDR_REE1
, 1);

1117 
	}
}

1119 
	$rvu_ªe_öô_block
(
rvu
 *rvu, 
blkaddr
)

1121 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1122 
rvu_block
 *
block
;

1123 
ªt
 = 0, 
blkid
 = 0;

1124 
ªe_r§c
 *
ªe
;

1125 
u64
 
vÆ
;

1127 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

1130 
block
 = &
hw
->block[
blkaddr
];

1131 i‡(
blkaddr
 =
BLKADDR_REE1
)

1132 
blkid
 = 1;

1133 
ªe
 = &
rvu
->
hw
->ªe[
blkid
];

1136 
ªt
 = 
	`ªe_aq_ö°_Æloc
(
rvu
, &
block
->
aq
,

1137 
REE_AQ_SIZE
,

1138 (
ªe_af_aq_ö°_s
),

1140 i‡(
ªt
)

1141  
ªt
;

1144 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_AQ_SBUF_ADDR
,

1145 (
u64
)
block
->
aq
->
ö°
->
iova
);

1150 
ªe
->
aq_hód
 = 0;

1155 
vÆ
 = 
REE_AQ_SIZE
 >> 3;

1156 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_AQ_SBUF_CTL
,

1157 (
vÆ
 << 
REE_AF_AQ_SBUF_CTL_SIZE_SHIFT
));

1160 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_AQ_ENA
, 0x1);

1165 
	`ªe_ªex_f‹˚_˛ock
(
rvu
, 
block
, 
åue
);

1168 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_MAX_MATCH
,

1169 
REE_AF_REEXM_MAX_MATCH_MAX
);

1170 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_MAX_PRE_CNT
,

1171 
REE_AF_REEXM_MAX_PRE_CNT_COUNT
);

1172 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_MAX_PTHREAD_CNT
,

1173 
REE_AF_REEXM_MAX_PTHREAD_COUNT
);

1174 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_MAX_LATENCY_CNT
,

1175 
REE_AF_REEXM_MAX_LATENCY_COUNT
);

1178 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_CTRL
, 0x1);

1179 
	`rvu_wrôe64
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_CTRL
, 0x0);

1182 
ªt
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
block
->
addr
, 
REE_AF_REEXM_STATUS
,

1183 
	`BIT_ULL
(0), 
Ál£
);

1184 i‡(
ªt
) {

1185 
	`dev_îr
(
rvu
->
dev
, "REEÑeexmÖoll for init done failed");

1186 
îr
;

1189 
îr
:

1191 
	`ªe_ªex_f‹˚_˛ock
(
rvu
, 
block
, 
Ál£
);

1193  
ªt
;

1194 
	}
}

1196 
	$rvu_ªe_öô
(
rvu
 *rvu)

1198 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1199 
îr
;

1201 
hw
->
ªe
 = 
	`devm_kˇŒoc
(
rvu
->
dev
, 
MAX_REE_BLKS
, (
ªe_r§c
),

1202 
GFP_KERNEL
);

1203 i‡(!
hw
->
ªe
)

1204  -
ENOMEM
;

1206 
îr
 = 
	`rvu_ªe_öô_block
(
rvu
, 
BLKADDR_REE0
);

1207 i‡(
îr
)

1208  
îr
;

1209  
	`rvu_ªe_öô_block
(
rvu
, 
BLKADDR_REE1
);

1210 
	}
}

1212 
	$rvu_ªe_‰ìmem_block
(
rvu
 *rvu, 
blkaddr
, 
blkid
)

1214 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1215 
rvu_block
 *
block
;

1216 
ªe_r§c
 *
ªe
;

1217 
i
 = 0;

1219 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
blkaddr
))

1222 
block
 = &
hw
->block[
blkaddr
];

1223 
ªe
 = &
hw
->ªe[
blkid
];

1225 
	`rvu_aq_‰ì
(
rvu
, 
block
->
aq
);

1226 i‡(
ªe
->
gøph_˘x
)

1227 
	`qmem_‰ì
(
rvu
->
dev
, 
ªe
->
gøph_˘x
);

1228 i‡(
ªe
->
¥efix_˘x
)

1229 
	`qmem_‰ì
(
rvu
->
dev
, 
ªe
->
¥efix_˘x
);

1230 i‡(
ªe
->
ruÀdb
) {

1231 
i
 = 0; i < 
ªe
->
ruÀdb_blocks
; i++)

1232 
	`k‰ì
(
ªe
->
ruÀdb
[
i
]);

1233 
	`k‰ì
(
ªe
->
ruÀdb
);

1235 
	`k‰ì
(
ªe
->
ruÀdbi
);

1236 
	}
}

1238 
	$rvu_ªe_‰ìmem
(
rvu
 *rvu)

1240 
	`rvu_ªe_‰ìmem_block
(
rvu
, 
BLKADDR_REE0
, 0);

1241 
	`rvu_ªe_‰ìmem_block
(
rvu
, 
BLKADDR_REE1
, 1);

1242 
	}
}

	@rvu_reg.c

8 
	~<löux/moduÀ.h
>

9 
	~<löux/pci.h
>

11 
	~"rvu_°ru˘.h
"

12 
	~"comm⁄.h
"

13 
	~"mbox.h
"

14 
	~"rvu.h
"

16 
	sªg_ønge
 {

17 
u64
 
	m°¨t
;

18 
u64
 
	míd
;

21 
	shw_ªg_m≠
 {

22 
u8
 
	mªgblk
;

23 
u8
 
	mnum_ønges
;

24 
u64
 
	mmask
;

25 
	#MAX_REG_RANGES
 8

	)

26 
ªg_ønge
 
	mønge
[
MAX_REG_RANGES
];

29 
hw_ªg_m≠
 
	gtxsch_ªg_m≠
[
NIX_TXSCH_LVL_CNT
] = {

30 {
NIX_TXSCH_LVL_SMQ
, 2, 0xFFFF, {{0x0700, 0x0708}, {0x1400, 0x14C8} } },

31 {
NIX_TXSCH_LVL_TL4
, 3, 0xFFFF, {{0x0B00, 0x0B08}, {0x0B10, 0x0B18},

33 {
NIX_TXSCH_LVL_TL3
, 4, 0xFFFF, {{0x1000, 0x10E0}, {0x1600, 0x1608},

35 {
NIX_TXSCH_LVL_TL2
, 2, 0xFFFF, {{0x0E00, 0x0EE0}, {0x1700, 0x17B0} } },

36 {
NIX_TXSCH_LVL_TL1
, 1, 0xFFFF, {{0x0C00, 0x0D98} } },

39 
boﬁ
 
	$rvu_check_vÆid_ªg
(
ªgm≠
, 
ªgblk
, 
u64
 
ªg
)

41 
idx
;

42 
hw_ªg_m≠
 *
m≠
;

45 i‡(
ªg
 & 0x07)

46  
Ál£
;

48 i‡(
ªgm≠
 =
TXSCHQ_HWREGMAP
) {

49 i‡(
ªgblk
 >
NIX_TXSCH_LVL_CNT
)

50  
Ál£
;

51 
m≠
 = &
txsch_ªg_m≠
[
ªgblk
];

53  
Ál£
;

57 i‡(
m≠
->
ªgblk
 !=Ñegblk)

58  
Ál£
;

60 
ªg
 &
m≠
->
mask
;

62 
idx
 = 0; idx < 
m≠
->
num_ønges
; idx++) {

63 i‡(
ªg
 >
m≠
->
ønge
[
idx
].
°¨t
 &&

64 
ªg
 < 
m≠
->
ønge
[
idx
].
íd
)

65  
åue
;

67  
Ál£
;

68 
	}
}

	@rvu_reg.h

8 #i‚de‡
RVU_REG_H


9 
	#RVU_REG_H


	)

12 
	#RVU_AF_MSIXTR_BASE
 (0x10)

	)

13 
	#RVU_AF_ECO
 (0x20)

	)

14 
	#RVU_AF_BLK_RST
 (0x30)

	)

15 
	#RVU_AF_PF_BAR4_ADDR
 (0x40)

	)

16 
	#RVU_AF_RAS
 (0x100)

	)

17 
	#RVU_AF_RAS_W1S
 (0x108)

	)

18 
	#RVU_AF_RAS_ENA_W1S
 (0x110)

	)

19 
	#RVU_AF_RAS_ENA_W1C
 (0x118)

	)

20 
	#RVU_AF_GEN_INT
 (0x120)

	)

21 
	#RVU_AF_GEN_INT_W1S
 (0x128)

	)

22 
	#RVU_AF_GEN_INT_ENA_W1S
 (0x130)

	)

23 
	#RVU_AF_GEN_INT_ENA_W1C
 (0x138)

	)

24 
	#RVU_AF_AFPF_MBOX0
 (0x02000)

	)

25 
	#RVU_AF_AFPF_MBOX1
 (0x02008)

	)

26 
	#RVU_AF_AFPFX_MBOXX
(
a
, 
b
Ë(0x2000 | (aË<< 4 | (bË<< 3)

	)

27 
	#RVU_AF_PFME_STATUS
 (0x2800)

	)

28 
	#RVU_AF_PFTRPEND
 (0x2810)

	)

29 
	#RVU_AF_PFTRPEND_W1S
 (0x2820)

	)

30 
	#RVU_AF_PF_RST
 (0x2840)

	)

31 
	#RVU_AF_HWVF_RST
 (0x2850)

	)

32 
	#RVU_AF_PFAF_MBOX_INT
 (0x2880)

	)

33 
	#RVU_AF_PFAF_MBOX_INT_W1S
 (0x2888)

	)

34 
	#RVU_AF_PFAF_MBOX_INT_ENA_W1S
 (0x2890)

	)

35 
	#RVU_AF_PFAF_MBOX_INT_ENA_W1C
 (0x2898)

	)

36 
	#RVU_AF_PFFLR_INT
 (0x28a0)

	)

37 
	#RVU_AF_PFFLR_INT_W1S
 (0x28a8)

	)

38 
	#RVU_AF_PFFLR_INT_ENA_W1S
 (0x28b0)

	)

39 
	#RVU_AF_PFFLR_INT_ENA_W1C
 (0x28b8)

	)

40 
	#RVU_AF_PFME_INT
 (0x28c0)

	)

41 
	#RVU_AF_PFME_INT_W1S
 (0x28c8)

	)

42 
	#RVU_AF_PFME_INT_ENA_W1S
 (0x28d0)

	)

43 
	#RVU_AF_PFME_INT_ENA_W1C
 (0x28d8)

	)

44 
	#RVU_AF_PFX_BAR4_ADDR
(
a
Ë(0x5000 | (aË<< 4)

	)

45 
	#RVU_AF_PFX_BAR4_CFG
 (0x5200 | (
a
Ë<< 4)

	)

46 
	#RVU_AF_PFX_VF_BAR4_ADDR
 (0x5400 | (
a
Ë<< 4)

	)

47 
	#RVU_AF_PFX_VF_BAR4_CFG
 (0x5600 | (
a
Ë<< 4)

	)

48 
	#RVU_AF_PFX_LMTLINE_ADDR
 (0x5800 | (
a
Ë<< 4)

	)

49 
	#RVU_AF_SMMU_ADDR_REQ
 (0x6000)

	)

50 
	#RVU_AF_SMMU_TXN_REQ
 (0x6008)

	)

51 
	#RVU_AF_SMMU_ADDR_RSP_STS
 (0x6010)

	)

52 
	#RVU_AF_SMMU_ADDR_TLN
 (0x6018)

	)

53 
	#RVU_AF_SMMU_TLN_FLIT0
 (0x6020)

	)

55 
	#RVU_AF_BAR2_ALIASX
(
a
, 
b
Ë(0x9100000uŒ | (aË<< 12 | (b))

	)

58 
	#RVU_PRIV_CONST
 (0x8000000)

	)

59 
	#RVU_PRIV_GEN_CFG
 (0x8000010)

	)

60 
	#RVU_PRIV_CLK_CFG
 (0x8000020)

	)

61 
	#RVU_PRIV_ACTIVE_PC
 (0x8000030)

	)

62 
	#RVU_PRIV_PFX_CFG
(
a
Ë(0x8000100 | (aË<< 16)

	)

63 
	#RVU_PRIV_PFX_MSIX_CFG
(
a
Ë(0x8000110 | (aË<< 16)

	)

64 
	#RVU_PRIV_PFX_ID_CFG
(
a
Ë(0x8000120 | (aË<< 16)

	)

65 
	#RVU_PRIV_PFX_INT_CFG
(
a
Ë(0x8000200 | (aË<< 16)

	)

66 
	#RVU_PRIV_PFX_NIXX_CFG
(
a
Ë(0x8000300 | (aË<< 3)

	)

67 
	#RVU_PRIV_PFX_NPA_CFG
 (0x8000310)

	)

68 
	#RVU_PRIV_PFX_SSO_CFG
 (0x8000320)

	)

69 
	#RVU_PRIV_PFX_SSOW_CFG
 (0x8000330)

	)

70 
	#RVU_PRIV_PFX_TIM_CFG
 (0x8000340)

	)

71 
	#RVU_PRIV_PFX_CPTX_CFG
(
a
Ë(0x8000350 | (aË<< 3)

	)

72 
	#RVU_PRIV_BLOCK_TYPEX_REV
(
a
Ë(0x8000400 | (aË<< 3)

	)

73 
	#RVU_PRIV_HWVFX_INT_CFG
(
a
Ë(0x8001280 | (aË<< 16)

	)

74 
	#RVU_PRIV_HWVFX_NIXX_CFG
(
a
Ë(0x8001300 | (aË<< 3)

	)

75 
	#RVU_PRIV_HWVFX_NPA_CFG
 (0x8001310)

	)

76 
	#RVU_PRIV_HWVFX_SSO_CFG
 (0x8001320)

	)

77 
	#RVU_PRIV_HWVFX_SSOW_CFG
 (0x8001330)

	)

78 
	#RVU_PRIV_HWVFX_TIM_CFG
 (0x8001340)

	)

79 
	#RVU_PRIV_HWVFX_CPTX_CFG
(
a
Ë(0x8001350 | (aË<< 3)

	)

80 
	#RVU_PRIV_PFX_REEX_CFG
(
a
Ë(0x8000360 | (aË<< 3)

	)

81 
	#RVU_PRIV_HWVFX_REEX_CFG
(
a
Ë(0x8001360 | (aË<< 3)

	)

84 
	#RVU_PF_VFX_PFVF_MBOX0
 (0x00000)

	)

85 
	#RVU_PF_VFX_PFVF_MBOX1
 (0x00008)

	)

86 
	#RVU_PF_VFX_PFVF_MBOXX
(
a
, 
b
Ë(0x0 | (aË<< 12 | (bË<< 3)

	)

87 
	#RVU_PF_VF_BAR4_ADDR
 (0x10)

	)

88 
	#RVU_PF_BLOCK_ADDRX_DISC
(
a
Ë(0x200 | (aË<< 3)

	)

89 
	#RVU_PF_VFME_STATUSX
(
a
Ë(0x800 | (aË<< 3)

	)

90 
	#RVU_PF_VFTRPENDX
(
a
Ë(0x820 | (aË<< 3)

	)

91 
	#RVU_PF_VFTRPEND_W1SX
(
a
Ë(0x840 | (aË<< 3)

	)

92 
	#RVU_PF_VFPF_MBOX_INTX
(
a
Ë(0x880 | (aË<< 3)

	)

93 
	#RVU_PF_VFPF_MBOX_INT_W1SX
(
a
Ë(0x8A0 | (aË<< 3)

	)

94 
	#RVU_PF_VFPF_MBOX_INT_ENA_W1SX
(
a
Ë(0x8C0 | (aË<< 3)

	)

95 
	#RVU_PF_VFPF_MBOX_INT_ENA_W1CX
(
a
Ë(0x8E0 | (aË<< 3)

	)

96 
	#RVU_PF_VFFLR_INTX
(
a
Ë(0x900 | (aË<< 3)

	)

97 
	#RVU_PF_VFFLR_INT_W1SX
(
a
Ë(0x920 | (aË<< 3)

	)

98 
	#RVU_PF_VFFLR_INT_ENA_W1SX
(
a
Ë(0x940 | (aË<< 3)

	)

99 
	#RVU_PF_VFFLR_INT_ENA_W1CX
(
a
Ë(0x960 | (aË<< 3)

	)

100 
	#RVU_PF_VFME_INTX
(
a
Ë(0x980 | (aË<< 3)

	)

101 
	#RVU_PF_VFME_INT_W1SX
(
a
Ë(0x9A0 | (aË<< 3)

	)

102 
	#RVU_PF_VFME_INT_ENA_W1SX
(
a
Ë(0x9C0 | (aË<< 3)

	)

103 
	#RVU_PF_VFME_INT_ENA_W1CX
(
a
Ë(0x9E0 | (aË<< 3)

	)

104 
	#RVU_PF_PFAF_MBOX0
 (0xC00)

	)

105 
	#RVU_PF_PFAF_MBOX1
 (0xC08)

	)

106 
	#RVU_PF_PFAF_MBOXX
(
a
Ë(0xC00 | (aË<< 3)

	)

107 
	#RVU_PF_INT
 (0xc20)

	)

108 
	#RVU_PF_INT_W1S
 (0xc28)

	)

109 
	#RVU_PF_INT_ENA_W1S
 (0xc30)

	)

110 
	#RVU_PF_INT_ENA_W1C
 (0xc38)

	)

111 
	#RVU_PF_MSIX_VECX_ADDR
(
a
Ë(0x000 | (aË<< 4)

	)

112 
	#RVU_PF_MSIX_VECX_CTL
(
a
Ë(0x008 | (aË<< 4)

	)

113 
	#RVU_PF_MSIX_PBAX
(
a
Ë(0xF0000 | (aË<< 3)

	)

114 
	#RVU_PF_VF_MBOX_ADDR
 (0xC40)

	)

115 
	#RVU_PF_LMTLINE_ADDR
 (0xC48)

	)

118 
	#RVU_VF_VFPF_MBOX0
 (0x00000)

	)

119 
	#RVU_VF_VFPF_MBOX1
 (0x00008)

	)

122 
	#NPA_AF_BLK_RST
 (0x0000)

	)

123 
	#NPA_AF_CONST
 (0x0010)

	)

124 
	#NPA_AF_CONST1
 (0x0018)

	)

125 
	#NPA_AF_LF_RST
 (0x0020)

	)

126 
	#NPA_AF_GEN_CFG
 (0x0030)

	)

127 
	#NPA_AF_NDC_CFG
 (0x0040)

	)

128 
	#NPA_AF_NDC_SYNC
 (0x0050)

	)

129 
	#NPA_AF_INP_CTL
 (0x00D0)

	)

130 
	#NPA_AF_ACTIVE_CYCLES_PC
 (0x00F0)

	)

131 
	#NPA_AF_AVG_DELAY
 (0x0100)

	)

132 
	#NPA_AF_GEN_INT
 (0x0140)

	)

133 
	#NPA_AF_GEN_INT_W1S
 (0x0148)

	)

134 
	#NPA_AF_GEN_INT_ENA_W1S
 (0x0150)

	)

135 
	#NPA_AF_GEN_INT_ENA_W1C
 (0x0158)

	)

136 
	#NPA_AF_RVU_INT
 (0x0160)

	)

137 
	#NPA_AF_RVU_INT_W1S
 (0x0168)

	)

138 
	#NPA_AF_RVU_INT_ENA_W1S
 (0x0170)

	)

139 
	#NPA_AF_RVU_INT_ENA_W1C
 (0x0178)

	)

140 
	#NPA_AF_ERR_INT
 (0x0180)

	)

141 
	#NPA_AF_ERR_INT_W1S
 (0x0188)

	)

142 
	#NPA_AF_ERR_INT_ENA_W1S
 (0x0190)

	)

143 
	#NPA_AF_ERR_INT_ENA_W1C
 (0x0198)

	)

144 
	#NPA_AF_RAS
 (0x01A0)

	)

145 
	#NPA_AF_RAS_W1S
 (0x01A8)

	)

146 
	#NPA_AF_RAS_ENA_W1S
 (0x01B0)

	)

147 
	#NPA_AF_RAS_ENA_W1C
 (0x01B8)

	)

148 
	#NPA_AF_BP_TEST
 (0x0200)

	)

149 
	#NPA_AF_ECO
 (0x0300)

	)

150 
	#NPA_AF_AQ_CFG
 (0x0600)

	)

151 
	#NPA_AF_AQ_BASE
 (0x0610)

	)

152 
	#NPA_AF_AQ_STATUS
 (0x0620)

	)

153 
	#NPA_AF_AQ_DOOR
 (0x0630)

	)

154 
	#NPA_AF_AQ_DONE_WAIT
 (0x0640)

	)

155 
	#NPA_AF_AQ_DONE
 (0x0650)

	)

156 
	#NPA_AF_AQ_DONE_ACK
 (0x0660)

	)

157 
	#NPA_AF_AQ_DONE_INT
 (0x0680)

	)

158 
	#NPA_AF_AQ_DONE_INT_W1S
 (0x0688)

	)

159 
	#NPA_AF_AQ_DONE_ENA_W1S
 (0x0690)

	)

160 
	#NPA_AF_AQ_DONE_ENA_W1C
 (0x0698)

	)

161 
	#NPA_AF_BATCH_CTL
 (0x06a0)

	)

162 
	#NPA_AF_LFX_AURAS_CFG
(
a
Ë(0x4000 | (aË<< 18)

	)

163 
	#NPA_AF_LFX_LOC_AURAS_BASE
(
a
Ë(0x4010 | (aË<< 18)

	)

164 
	#NPA_AF_LFX_QINTS_CFG
(
a
Ë(0x4100 | (aË<< 18)

	)

165 
	#NPA_AF_LFX_QINTS_BASE
(
a
Ë(0x4110 | (aË<< 18)

	)

166 
	#NPA_PRIV_AF_INT_CFG
 (0x10000)

	)

167 
	#NPA_PRIV_LFX_CFG
 (0x10010)

	)

168 
	#NPA_PRIV_LFX_INT_CFG
 (0x10020)

	)

169 
	#NPA_AF_RVU_LF_CFG_DEBUG
 (0x10030)

	)

171 
	#NPA_AF_BAR2_SEL
 (0x9000000uŒ)

	)

172 
	#NPA_AF_BAR2_ALIASX
(
a
, 
b
Ë
	`RVU_AF_BAR2_ALIASX
◊, b)

	)

175 
	#NIX_AF_CFG
 (0x0000)

	)

176 
	#NIX_AF_STATUS
 (0x0010)

	)

177 
	#NIX_AF_NDC_CFG
 (0x0018)

	)

178 
	#NIX_AF_CONST
 (0x0020)

	)

179 
	#NIX_AF_CONST1
 (0x0028)

	)

180 
	#NIX_AF_CONST2
 (0x0030)

	)

181 
	#NIX_AF_CONST3
 (0x0038)

	)

182 
	#NIX_AF_SQ_CONST
 (0x0040)

	)

183 
	#NIX_AF_CQ_CONST
 (0x0048)

	)

184 
	#NIX_AF_RQ_CONST
 (0x0050)

	)

185 
	#NIX_AF_PL_CONST
 (0x0058)

	)

186 
	#NIX_AF_PSE_CONST
 (0x0060)

	)

187 
	#NIX_AF_TL1_CONST
 (0x0070)

	)

188 
	#NIX_AF_TL2_CONST
 (0x0078)

	)

189 
	#NIX_AF_TL3_CONST
 (0x0080)

	)

190 
	#NIX_AF_TL4_CONST
 (0x0088)

	)

191 
	#NIX_AF_MDQ_CONST
 (0x0090)

	)

192 
	#NIX_AF_MC_MIRROR_CONST
 (0x0098)

	)

193 
	#NIX_AF_LSO_CFG
 (0x00A8)

	)

194 
	#NIX_AF_BLK_RST
 (0x00B0)

	)

195 
	#NIX_AF_TX_TSTMP_CFG
 (0x00C0)

	)

196 
	#NIX_AF_PL_TS
 (0x00C8)

	)

197 
	#NIX_AF_RX_CFG
 (0x00D0)

	)

198 
	#NIX_AF_AVG_DELAY
 (0x00E0)

	)

199 
	#NIX_AF_CINT_DELAY
 (0x00F0)

	)

200 
	#NIX_AF_VWQE_TIMER
 (0x00F8)

	)

201 
	#NIX_AF_RX_MCAST_BASE
 (0x0100)

	)

202 
	#NIX_AF_RX_MCAST_CFG
 (0x0110)

	)

203 
	#NIX_AF_RX_MCAST_BUF_BASE
 (0x0120)

	)

204 
	#NIX_AF_RX_MCAST_BUF_CFG
 (0x0130)

	)

205 
	#NIX_AF_RX_MIRROR_BUF_BASE
 (0x0140)

	)

206 
	#NIX_AF_RX_MIRROR_BUF_CFG
 (0x0148)

	)

207 
	#NIX_AF_LF_RST
 (0x0150)

	)

208 
	#NIX_AF_GEN_INT
 (0x0160)

	)

209 
	#NIX_AF_GEN_INT_W1S
 (0x0168)

	)

210 
	#NIX_AF_GEN_INT_ENA_W1S
 (0x0170)

	)

211 
	#NIX_AF_GEN_INT_ENA_W1C
 (0x0178)

	)

212 
	#NIX_AF_ERR_INT
 (0x0180)

	)

213 
	#NIX_AF_ERR_INT_W1S
 (0x0188)

	)

214 
	#NIX_AF_ERR_INT_ENA_W1S
 (0x0190)

	)

215 
	#NIX_AF_ERR_INT_ENA_W1C
 (0x0198)

	)

216 
	#NIX_AF_RAS
 (0x01A0)

	)

217 
	#NIX_AF_RAS_W1S
 (0x01A8)

	)

218 
	#NIX_AF_RAS_ENA_W1S
 (0x01B0)

	)

219 
	#NIX_AF_RAS_ENA_W1C
 (0x01B8)

	)

220 
	#NIX_AF_RVU_INT
 (0x01C0)

	)

221 
	#NIX_AF_RVU_INT_W1S
 (0x01C8)

	)

222 
	#NIX_AF_RVU_INT_ENA_W1S
 (0x01D0)

	)

223 
	#NIX_AF_RVU_INT_ENA_W1C
 (0x01D8)

	)

224 
	#NIX_AF_TCP_TIMER
 (0x01E0)

	)

225 
	#NIX_AF_RX_DEF_ET
(
a
Ë(0x01F0uŒ | (
uöt64_t
)◊Ë<< 3)

	)

226 
	#NIX_AF_RX_DEF_OL2
 (0x0200)

	)

227 
	#NIX_AF_RX_DEF_OIP4
 (0x0210)

	)

228 
	#NIX_AF_RX_DEF_IIP4
 (0x0220)

	)

229 
	#NIX_AF_RX_DEF_VLAN0_PCP_DEI
 (0x0228)

	)

230 
	#NIX_AF_RX_DEF_OIP6
 (0x0230)

	)

231 
	#NIX_AF_RX_DEF_VLAN1_PCP_DEI
 (0x0238)

	)

232 
	#NIX_AF_RX_DEF_IIP6
 (0x0240)

	)

233 
	#NIX_AF_RX_DEF_OTCP
 (0x0250)

	)

234 
	#NIX_AF_RX_DEF_ITCP
 (0x0260)

	)

235 
	#NIX_AF_RX_DEF_OUDP
 (0x0270)

	)

236 
	#NIX_AF_RX_DEF_IUDP
 (0x0280)

	)

237 
	#NIX_AF_RX_DEF_OSCTP
 (0x0290)

	)

238 
	#NIX_AF_RX_DEF_CST_APAD0
 (0x0298)

	)

239 
	#NIX_AF_RX_DEF_ISCTP
 (0x02A0)

	)

240 
	#NIX_AF_RX_DEF_CST_APAD1
 (0x02A8)

	)

241 
	#NIX_AF_RX_DEF_IPSECX
(
a
Ë(0x02B0uŒ | (
uöt64_t
)◊Ë<< 3)

	)

242 
	#NIX_AF_RX_DEF_IIP4_DSCP
 (0x02E0)

	)

243 
	#NIX_AF_RX_DEF_OIP4_DSCP
 (0x02E8)

	)

244 
	#NIX_AF_RX_DEF_IIP6_DSCP
 (0x02F0)

	)

245 
	#NIX_AF_RX_DEF_OIP6_DSCP
 (0x02F8)

	)

246 
	#NIX_AF_RX_IPSEC_GEN_CFG
 (0x0300)

	)

247 
	#NIX_AF_RX_CPTX_INST_QSEL
(
a
Ë(0x0320uŒ | (
uöt64_t
)◊Ë<< 3)

	)

248 
	#NIX_AF_RX_CPTX_CREDIT
(
a
Ë(0x0360uŒ | (
uöt64_t
)◊Ë<< 3)

	)

249 
	#NIX_AF_NDC_RX_SYNC
 (0x03E0)

	)

250 
	#NIX_AF_NDC_TX_SYNC
 (0x03F0)

	)

251 
	#NIX_AF_AQ_CFG
 (0x0400)

	)

252 
	#NIX_AF_AQ_BASE
 (0x0410)

	)

253 
	#NIX_AF_AQ_STATUS
 (0x0420)

	)

254 
	#NIX_AF_AQ_DOOR
 (0x0430)

	)

255 
	#NIX_AF_AQ_DONE_WAIT
 (0x0440)

	)

256 
	#NIX_AF_AQ_DONE
 (0x0450)

	)

257 
	#NIX_AF_AQ_DONE_ACK
 (0x0460)

	)

258 
	#NIX_AF_AQ_DONE_TIMER
 (0x0470)

	)

259 
	#NIX_AF_AQ_DONE_INT
 (0x0480)

	)

260 
	#NIX_AF_AQ_DONE_INT_W1S
 (0x0488)

	)

261 
	#NIX_AF_AQ_DONE_ENA_W1S
 (0x0490)

	)

262 
	#NIX_AF_AQ_DONE_ENA_W1C
 (0x0498)

	)

263 
	#NIX_AF_RX_LINKX_SLX_SPKT_CNT
 (0x0500)

	)

264 
	#NIX_AF_RX_LINKX_SLX_SXQE_CNT
 (0x0510)

	)

265 
	#NIX_AF_RX_MCAST_JOBSX_SW_CNT
 (0x0520)

	)

266 
	#NIX_AF_RX_MIRROR_JOBSX_SW_CNT
 (0x0530)

	)

267 
	#NIX_AF_RX_LINKX_CFG
(
a
Ë(0x0540 | (aË<< 16)

	)

268 
	#NIX_AF_RX_SW_SYNC
 (0x0550)

	)

269 
	#NIX_AF_RX_SW_SYNC_DONE
 (0x0560)

	)

270 
	#NIX_AF_RQM_ECO
 (0x05A0)

	)

271 
	#NIX_AF_SEB_ECO
 (0x0600)

	)

272 
	#NIX_AF_SEB_TEST_BP
 (0x0610)

	)

273 
	#NIX_AF_NORM_TX_FIFO_STATUS
 (0x0620)

	)

274 
	#NIX_AF_SDP_TX_FIFO_STATUS
 (0x0640)

	)

275 
	#NIX_AF_TX_NPC_CAPTURE_CONFIG
 (0x0660)

	)

276 
	#NIX_AF_TX_NPC_CAPTURE_INFO
 (0x0670)

	)

277 
	#NIX_AF_SEB_CFG
 (0x05F0)

	)

278 
	#NIX_PTP_1STEP_EN
 
	`BIT_ULL
(2)

	)

280 
	#NIX_AF_DEBUG_NPC_RESP_DATAX
(
a
Ë(0x680 | (aË<< 3)

	)

281 
	#NIX_AF_SMQX_CFG
(
a
Ë(0x700 | (aË<< 16)

	)

282 
	#NIX_AF_SMQX_STATUS
(
a
Ë(0x730 | (aË<< 16)

	)

283 
	#NIX_AF_SQM_DBG_CTL_STATUS
 (0x750)

	)

284 
	#NIX_AF_DWRR_SDP_MTU
 (0x790Ë

	)

285 
	#NIX_AF_DWRR_RPM_MTU
 (0x7A0)

	)

286 
	#NIX_AF_DWRR_MTUX
(
a
Ë(0x790 | (aË<< 16Ë

	)

287 
	#NIX_AF_PSE_CHANNEL_LEVEL
 (0x800)

	)

288 
	#NIX_AF_PSE_SHAPER_CFG
 (0x810)

	)

289 
	#NIX_AF_MARK_FORMATX_CTL
(
a
Ë(0x900 | (aË<< 18)

	)

290 
	#NIX_AF_TX_LINKX_NORM_CREDIT
(
a
Ë(0xA00 | (aË<< 16)

	)

291 
	#NIX_AF_TX_LINKX_SW_XOFF
(
a
Ë(0xA20 | (aË<< 16)

	)

292 
	#NIX_AF_TX_LINKX_HW_XOFF
(
a
Ë(0xA30 | (aË<< 16)

	)

293 
	#NIX_AF_SDP_LINK_CREDIT
 (0xa40)

	)

294 
	#NIX_AF_SDP_SW_XOFFX
(
a
Ë(0xA60 | (aË<< 3)

	)

295 
	#NIX_AF_SDP_HW_XOFFX
(
a
Ë(0xAC0 | (aË<< 3)

	)

296 
	#NIX_AF_TL4X_BP_STATUS
(
a
Ë(0xB00 | (aË<< 16)

	)

297 
	#NIX_AF_TL4X_SDP_LINK_CFG
(
a
Ë(0xB10 | (aË<< 16)

	)

298 
	#NIX_AF_TL1X_SCHEDULE
(
a
Ë(0xC00 | (aË<< 16)

	)

299 
	#NIX_AF_TL1X_SHAPE
(
a
Ë(0xC10 | (aË<< 16)

	)

300 
	#NIX_AF_TL1X_CIR
(
a
Ë(0xC20 | (aË<< 16)

	)

301 
	#NIX_AF_TL1X_SHAPE_STATE
(
a
Ë(0xC50 | (aË<< 16)

	)

302 
	#NIX_AF_TL1X_SW_XOFF
(
a
Ë(0xC70 | (aË<< 16)

	)

303 
	#NIX_AF_TL1X_TOPOLOGY
(
a
Ë(0xC80 | (aË<< 16)

	)

304 
	#NIX_AF_TL1X_GREEN
(
a
Ë(0xC90 | (aË<< 16)

	)

305 
	#NIX_AF_TL1X_YELLOW
(
a
Ë(0xCA0 | (aË<< 16)

	)

306 
	#NIX_AF_TL1X_RED
(
a
Ë(0xCB0 | (aË<< 16)

	)

307 
	#NIX_AF_TL1X_MD_DEBUG0
(
a
Ë(0xCC0 | (aË<< 16)

	)

308 
	#NIX_AF_TL1X_MD_DEBUG1
(
a
Ë(0xCC8 | (aË<< 16)

	)

309 
	#NIX_AF_TL1X_MD_DEBUG2
(
a
Ë(0xCD0 | (aË<< 16)

	)

310 
	#NIX_AF_TL1X_MD_DEBUG3
(
a
Ë(0xCD8 | (aË<< 16)

	)

311 
	#NIX_AF_TL1A_DEBUG
 (0x˚0)

	)

312 
	#NIX_AF_TL1B_DEBUG
 (0xcf0)

	)

313 
	#NIX_AF_TL1_DEBUG_GREEN
 (0xd00)

	)

314 
	#NIX_AF_TL1_DEBUG_NODE
 (0xd10)

	)

315 
	#NIX_AF_TL1X_DROPPED_PACKETS
(
a
Ë(0xD20 | (aË<< 16)

	)

316 
	#NIX_AF_TL1X_DROPPED_BYTES
(
a
Ë(0xD30 | (aË<< 16)

	)

317 
	#NIX_AF_TL1X_RED_PACKETS
(
a
Ë(0xD40 | (aË<< 16)

	)

318 
	#NIX_AF_TL1X_RED_BYTES
(
a
Ë(0xD50 | (aË<< 16)

	)

319 
	#NIX_AF_TL1X_YELLOW_PACKETS
(
a
Ë(0xD60 | (aË<< 16)

	)

320 
	#NIX_AF_TL1X_YELLOW_BYTES
(
a
Ë(0xD70 | (aË<< 16)

	)

321 
	#NIX_AF_TL1X_GREEN_PACKETS
(
a
Ë(0xD80 | (aË<< 16)

	)

322 
	#NIX_AF_TL1X_GREEN_BYTES
(
a
Ë(0xD90 | (aË<< 16)

	)

323 
	#NIX_AF_TL2X_SCHEDULE
(
a
Ë(0xE00 | (aË<< 16)

	)

324 
	#NIX_AF_TL2X_SHAPE
(
a
Ë(0xE10 | (aË<< 16)

	)

325 
	#NIX_AF_TL2X_CIR
(
a
Ë(0xE20 | (aË<< 16)

	)

326 
	#NIX_AF_TL2X_PIR
(
a
Ë(0xE30 | (aË<< 16)

	)

327 
	#NIX_AF_TL2X_SCHED_STATE
(
a
Ë(0xE40 | (aË<< 16)

	)

328 
	#NIX_AF_TL2X_SHAPE_STATE
(
a
Ë(0xE50 | (aË<< 16)

	)

329 
	#NIX_AF_TL2X_POINTERS
(
a
Ë(0xE60 | (aË<< 16)

	)

330 
	#NIX_AF_TL2X_SW_XOFF
(
a
Ë(0xE70 | (aË<< 16)

	)

331 
	#NIX_AF_TL2X_TOPOLOGY
(
a
Ë(0xE80 | (aË<< 16)

	)

332 
	#NIX_AF_TL2X_PARENT
(
a
Ë(0xE88 | (aË<< 16)

	)

333 
	#NIX_AF_TL2X_GREEN
(
a
Ë(0xE90 | (aË<< 16)

	)

334 
	#NIX_AF_TL2X_YELLOW
(
a
Ë(0xEA0 | (aË<< 16)

	)

335 
	#NIX_AF_TL2X_RED
(
a
Ë(0xEB0 | (aË<< 16)

	)

336 
	#NIX_AF_TL2X_MD_DEBUG0
(
a
Ë(0xEC0 | (aË<< 16)

	)

337 
	#NIX_AF_TL2X_MD_DEBUG1
(
a
Ë(0xEC8 | (aË<< 16)

	)

338 
	#NIX_AF_TL2X_MD_DEBUG2
(
a
Ë(0xED0 | (aË<< 16)

	)

339 
	#NIX_AF_TL2X_MD_DEBUG3
(
a
Ë(0xED8 | (aË<< 16)

	)

340 
	#NIX_AF_TL2A_DEBUG
 (0xì0)

	)

341 
	#NIX_AF_TL2B_DEBUG
 (0xef0)

	)

342 
	#NIX_AF_TL3X_SCHEDULE
(
a
Ë(0x1000 | (aË<< 16)

	)

343 
	#NIX_AF_TL3X_SHAPE
(
a
Ë(0x1010 | (aË<< 16)

	)

344 
	#NIX_AF_TL3X_CIR
(
a
Ë(0x1020 | (aË<< 16)

	)

345 
	#NIX_AF_TL3X_PIR
(
a
Ë(0x1030 | (aË<< 16)

	)

346 
	#NIX_AF_TL3X_SCHED_STATE
(
a
Ë(0x1040 | (aË<< 16)

	)

347 
	#NIX_AF_TL3X_SHAPE_STATE
(
a
Ë(0x1050 | (aË<< 16)

	)

348 
	#NIX_AF_TL3X_POINTERS
(
a
Ë(0x1060 | (aË<< 16)

	)

349 
	#NIX_AF_TL3X_SW_XOFF
(
a
Ë(0x1070 | (aË<< 16)

	)

350 
	#NIX_AF_TL3X_TOPOLOGY
(
a
Ë(0x1080 | (aË<< 16)

	)

351 
	#NIX_AF_TL3X_PARENT
(
a
Ë(0x1088 | (aË<< 16)

	)

352 
	#NIX_AF_TL3X_GREEN
(
a
Ë(0x1090 | (aË<< 16)

	)

353 
	#NIX_AF_TL3X_YELLOW
(
a
Ë(0x10A0 | (aË<< 16)

	)

354 
	#NIX_AF_TL3X_RED
(
a
Ë(0x10B0 | (aË<< 16)

	)

355 
	#NIX_AF_TL3X_MD_DEBUG0
(
a
Ë(0x10C0 | (aË<< 16)

	)

356 
	#NIX_AF_TL3X_MD_DEBUG1
(
a
Ë(0x10C8 | (aË<< 16)

	)

357 
	#NIX_AF_TL3X_MD_DEBUG2
(
a
Ë(0x10D0 | (aË<< 16)

	)

358 
	#NIX_AF_TL3X_MD_DEBUG3
(
a
Ë(0x10D8 | (aË<< 16)

	)

359 
	#NIX_AF_TL3A_DEBUG
 (0x10e0)

	)

360 
	#NIX_AF_TL3B_DEBUG
 (0x10f0)

	)

361 
	#NIX_AF_TL4X_SCHEDULE
(
a
Ë(0x1200 | (aË<< 16)

	)

362 
	#NIX_AF_TL4X_SHAPE
(
a
Ë(0x1210 | (aË<< 16)

	)

363 
	#NIX_AF_TL4X_CIR
(
a
Ë(0x1220 | (aË<< 16)

	)

364 
	#NIX_AF_TL4X_PIR
(
a
Ë(0x1230 | (aË<< 16)

	)

365 
	#NIX_AF_TL4X_SCHED_STATE
(
a
Ë(0x1240 | (aË<< 16)

	)

366 
	#NIX_AF_TL4X_SHAPE_STATE
(
a
Ë(0x1250 | (aË<< 16)

	)

367 
	#NIX_AF_TL4X_POINTERS
(
a
Ë(0x1260 | (aË<< 16)

	)

368 
	#NIX_AF_TL4X_SW_XOFF
(
a
Ë(0x1270 | (aË<< 16)

	)

369 
	#NIX_AF_TL4X_TOPOLOGY
(
a
Ë(0x1280 | (aË<< 16)

	)

370 
	#NIX_AF_TL4X_PARENT
(
a
Ë(0x1288 | (aË<< 16)

	)

371 
	#NIX_AF_TL4X_GREEN
(
a
Ë(0x1290 | (aË<< 16)

	)

372 
	#NIX_AF_TL4X_YELLOW
(
a
Ë(0x12A0 | (aË<< 16)

	)

373 
	#NIX_AF_TL4X_RED
(
a
Ë(0x12B0 | (aË<< 16)

	)

374 
	#NIX_AF_TL4X_MD_DEBUG0
(
a
Ë(0x12C0 | (aË<< 16)

	)

375 
	#NIX_AF_TL4X_MD_DEBUG1
(
a
Ë(0x12C8 | (aË<< 16)

	)

376 
	#NIX_AF_TL4X_MD_DEBUG2
(
a
Ë(0x12D0 | (aË<< 16)

	)

377 
	#NIX_AF_TL4X_MD_DEBUG3
(
a
Ë(0x12D8 | (aË<< 16)

	)

378 
	#NIX_AF_TL4A_DEBUG
 (0x12e0)

	)

379 
	#NIX_AF_TL4B_DEBUG
 (0x12f0)

	)

380 
	#NIX_AF_MDQX_SCHEDULE
(
a
Ë(0x1400 | (aË<< 16)

	)

381 
	#NIX_AF_MDQX_SHAPE
(
a
Ë(0x1410 | (aË<< 16)

	)

382 
	#NIX_AF_MDQX_CIR
(
a
Ë(0x1420 | (aË<< 16)

	)

383 
	#NIX_AF_MDQX_PIR
(
a
Ë(0x1430 | (aË<< 16)

	)

384 
	#NIX_AF_MDQX_SCHED_STATE
(
a
Ë(0x1440 | (aË<< 16)

	)

385 
	#NIX_AF_MDQX_SHAPE_STATE
(
a
Ë(0x1450 | (aË<< 16)

	)

386 
	#NIX_AF_MDQX_POINTERS
(
a
Ë(0x1460 | (aË<< 16)

	)

387 
	#NIX_AF_MDQX_SW_XOFF
(
a
Ë(0x1470 | (aË<< 16)

	)

388 
	#NIX_AF_MDQX_PARENT
(
a
Ë(0x1480 | (aË<< 16)

	)

389 
	#NIX_AF_MDQX_MD_DEBUG
(
a
Ë(0x14C0 | (aË<< 16)

	)

390 
	#NIX_AF_MDQX_PTR_FIFO
(
a
Ë(0x14D0 | (aË<< 16)

	)

391 
	#NIX_AF_MDQA_DEBUG
 (0x14e0)

	)

392 
	#NIX_AF_MDQB_DEBUG
 (0x14f0)

	)

393 
	#NIX_AF_TL3_TL2X_CFG
(
a
Ë(0x1600 | (aË<< 18)

	)

394 
	#NIX_AF_TL3_TL2X_BP_STATUS
(
a
Ë(0x1610 | (aË<< 16)

	)

395 
	#NIX_AF_TL3_TL2X_LINKX_CFG
(
a
, 
b
Ë(0x1700 | (aË<< 16 | (bË<< 3)

	)

396 
	#NIX_AF_RX_FLOW_KEY_ALGX_FIELDX
(
a
, 
b
Ë(0x1800 | (aË<< 18 | (bË<< 3)

	)

397 
	#NIX_AF_TX_MCASTX
(
a
Ë(0x1900 | (aË<< 15)

	)

398 
	#NIX_AF_TX_VTAG_DEFX_CTL
(
a
Ë(0x1A00 | (aË<< 16)

	)

399 
	#NIX_AF_TX_VTAG_DEFX_DATA
(
a
Ë(0x1A10 | (aË<< 16)

	)

400 
	#NIX_AF_RX_BPIDX_STATUS
(
a
Ë(0x1A20 | (aË<< 17)

	)

401 
	#NIX_AF_RX_CHANX_CFG
(
a
Ë(0x1A30 | (aË<< 15)

	)

402 
	#NIX_AF_CINT_TIMERX
(
a
Ë(0x1A40 | (aË<< 18)

	)

403 
	#NIX_AF_LSO_FORMATX_FIELDX
(
a
, 
b
Ë(0x1B00 | (aË<< 16 | (bË<< 3)

	)

404 
	#NIX_AF_SPI_TO_SA_KEYX_WAYX
(
a
, 
b
Ë(0x1C00 | (aË<< 16 | (bË<< 3)

	)

405 
	#NIX_AF_SPI_TO_SA_VALUEX_WAYX
(
a
, 
b
Ë(0x1C40 | (aË<< 16 | (bË<< 3)

	)

406 
	#NIX_AF_SPI_TO_SA_HASH_KEY
 (0x1C90)

	)

407 
	#NIX_AF_SPI_TO_SA_HASH_VALUE
 (0x1CA0)

	)

408 
	#NIX_AF_LFX_CFG
(
a
Ë(0x4000 | (aË<< 17)

	)

409 
	#NIX_AF_LFX_SQS_CFG
(
a
Ë(0x4020 | (aË<< 17)

	)

410 
	#NIX_AF_LFX_TX_CFG2
(
a
Ë(0x4028 | (aË<< 17)

	)

411 
	#NIX_AF_LFX_SQS_BASE
(
a
Ë(0x4030 | (aË<< 17)

	)

412 
	#NIX_AF_LFX_RQS_CFG
(
a
Ë(0x4040 | (aË<< 17)

	)

413 
	#NIX_AF_LFX_RQS_BASE
(
a
Ë(0x4050 | (aË<< 17)

	)

414 
	#NIX_AF_LFX_CQS_CFG
(
a
Ë(0x4060 | (aË<< 17)

	)

415 
	#NIX_AF_LFX_CQS_BASE
(
a
Ë(0x4070 | (aË<< 17)

	)

416 
	#NIX_AF_LFX_TX_CFG
(
a
Ë(0x4080 | (aË<< 17)

	)

417 
	#NIX_AF_LFX_TX_PARSE_CFG
(
a
Ë(0x4090 | (aË<< 17)

	)

418 
	#NIX_AF_LFX_RX_CFG
(
a
Ë(0x40A0 | (aË<< 17)

	)

419 
	#NIX_AF_LFX_RSS_CFG
(
a
Ë(0x40C0 | (aË<< 17)

	)

420 
	#NIX_AF_LFX_RSS_BASE
(
a
Ë(0x40D0 | (aË<< 17)

	)

421 
	#NIX_AF_LFX_QINTS_CFG
(
a
Ë(0x4100 | (aË<< 17)

	)

422 
	#NIX_AF_LFX_QINTS_BASE
(
a
Ë(0x4110 | (aË<< 17)

	)

423 
	#NIX_AF_LFX_CINTS_CFG
(
a
Ë(0x4120 | (aË<< 17)

	)

424 
	#NIX_AF_LFX_CINTS_BASE
(
a
Ë(0x4130 | (aË<< 17)

	)

425 
	#NIX_AF_LFX_RX_IPSEC_CFG0
(
a
Ë(0x4140 | (aË<< 17)

	)

426 
	#NIX_AF_LFX_RX_IPSEC_CFG1
(
a
Ë(0x4148 | (aË<< 17)

	)

427 
	#NIX_AF_LFX_RX_IPSEC_DYNO_CFG
(
a
Ë(0x4150 | (aË<< 17)

	)

428 
	#NIX_AF_LFX_RX_IPSEC_DYNO_BASE
(
a
)(0x4158 | (aË<< 17)

	)

429 
	#NIX_AF_LFX_RX_IPSEC_SA_BASE
(
a
Ë(0x4170 | (aË<< 17)

	)

430 
	#NIX_AF_LFX_TX_STATUS
(
a
Ë(0x4180 | (aË<< 17)

	)

431 
	#NIX_AF_LFX_RX_VTAG_TYPEX
(
a
, 
b
Ë(0x4200 | (aË<< 17 | (bË<< 3)

	)

432 
	#NIX_AF_LFX_LOCKX
(
a
, 
b
Ë(0x4300 | (aË<< 17 | (bË<< 3)

	)

433 
	#NIX_AF_LFX_TX_STATX
(
a
, 
b
Ë(0x4400 | (aË<< 17 | (bË<< 3)

	)

434 
	#NIX_AF_LFX_RX_STATX
(
a
, 
b
Ë(0x4500 | (aË<< 17 | (bË<< 3)

	)

435 
	#NIX_AF_LFX_RSS_GRPX
(
a
, 
b
Ë(0x4600 | (aË<< 17 | (bË<< 3)

	)

436 
	#NIX_AF_RX_NPC_MC_RCV
 (0x4700)

	)

437 
	#NIX_AF_RX_NPC_MC_DROP
 (0x4710)

	)

438 
	#NIX_AF_RX_NPC_MIRROR_RCV
 (0x4720)

	)

439 
	#NIX_AF_RX_NPC_MIRROR_DROP
 (0x4730)

	)

440 
	#NIX_AF_RX_ACTIVE_CYCLES_PCX
(
a
Ë(0x4800 | (aË<< 16)

	)

441 
	#NIX_AF_RQM_BP_TEST
 (0x4880)

	)

442 
	#NIX_AF_CQM_BP_TEST
 (0x48c0)

	)

443 
	#NIX_AF_LINKX_CFG
(
a
Ë(0x4010 | (aË<< 17)

	)

444 
	#NIX_AF_MDQX_IN_MD_COUNT
(
a
Ë(0x14e0 | (aË<< 16)

	)

445 
	#NIX_AF_RX_RQX_MASKX
(
a
, 
b
Ë(0x4A40 | (aË<< 16 | (bË<< 3)

	)

446 
	#NIX_AF_RX_RQX_SETX
(
a
, 
b
Ë(0x4A80 | (aË<< 16 | (bË<< 3)

	)

448 
	#NIX_PRIV_AF_INT_CFG
 (0x8000000)

	)

449 
	#NIX_PRIV_LFX_CFG
 (0x8000010)

	)

450 
	#NIX_PRIV_LFX_INT_CFG
 (0x8000020)

	)

451 
	#NIX_AF_RVU_LF_CFG_DEBUG
 (0x8000030)

	)

453 
	#NIX_AF_LF_CFG_SHIFT
 17

	)

454 
	#NIX_AF_LF_SSO_PF_FUNC_SHIFT
 16

	)

455 
	#NIX_RQ_MSK_PROFILES
 4

	)

457 
	#NIX_AF_LINKX_BASE_MASK
 
	`GENMASK_ULL
(11, 0)

	)

458 
	#NIX_AF_LINKX_RANGE_MASK
 
	`GENMASK_ULL
(19, 16)

	)

461 
	#SSO_AF_CONST
 (0x1000)

	)

462 
	#SSO_AF_CONST1
 (0x1008)

	)

463 
	#SSO_AF_WQ_INT_PC
 (0x1020)

	)

464 
	#SSO_AF_NOS_CNT
 (0x1050)

	)

465 
	#SSO_AF_AW_WE
 (0x1080)

	)

466 
	#SSO_AF_WS_CFG
 (0x1088)

	)

467 
	#SSO_AF_LF_HWGRP_RST
 (0x10e0)

	)

468 
	#SSO_AF_AW_CFG
 (0x10f0)

	)

469 
	#SSO_AF_BLK_RST
 (0x10f8)

	)

470 
	#SSO_AF_ACTIVE_CYCLES0
 (0x1100)

	)

471 
	#SSO_AF_ACTIVE_CYCLES1
 (0x1108)

	)

472 
	#SSO_AF_ACTIVE_CYCLES2
 (0x1110)

	)

473 
	#SSO_AF_ERR0
 (0x1220)

	)

474 
	#SSO_AF_ERR0_W1S
 (0x1228)

	)

475 
	#SSO_AF_ERR0_ENA_W1C
 (0x1230)

	)

476 
	#SSO_AF_ERR0_ENA_W1S
 (0x1238)

	)

477 
	#SSO_AF_ERR2
 (0x1260)

	)

478 
	#SSO_AF_ERR2_W1S
 (0x1268)

	)

479 
	#SSO_AF_ERR2_ENA_W1C
 (0x1270)

	)

480 
	#SSO_AF_ERR2_ENA_W1S
 (0x1278)

	)

481 
	#SSO_AF_UNMAP_INFO
 (0x12f0)

	)

482 
	#SSO_AF_UNMAP_INFO2
 (0x1300)

	)

483 
	#SSO_AF_UNMAP_INFO3
 (0x1310)

	)

484 
	#SSO_AF_BP_TEST
(
a
Ë(0x1380 | (aË<< 4)

	)

485 
	#SSO_AF_RAS
 (0x1420)

	)

486 
	#SSO_AF_RAS_W1S
 (0x1430)

	)

487 
	#SSO_AF_RAS_ENA_W1C
 (0x1460)

	)

488 
	#SSO_AF_RAS_ENA_W1S
 (0x1470)

	)

489 
	#SSO_PRIV_AF_INT_CFG
 (0x3000)

	)

490 
	#SSO_AF_AW_ADD
 (0x2080)

	)

491 
	#SSO_AF_AW_READ_ARB
 (0x2090)

	)

492 
	#SSO_AF_XAQ_REQ_PC
 (0x20B0)

	)

493 
	#SSO_AF_XAQ_LATENCY_PC
 (0x20B8)

	)

494 
	#SSO_AF_TAQ_CNT
 (0x20c0)

	)

495 
	#SSO_AF_TAQ_ADD
 (0x20e0)

	)

496 
	#SSO_AF_POISONX
(
a
Ë(0x2100 | (aË<< 3)

	)

497 
	#SSO_AF_POISONX_W1S
(
a
Ë(0x2200 | (aË<< 3)

	)

498 
	#SSO_AF_RVU_LF_CFG_DEBUG
 (0x3800)

	)

499 
	#SSO_PRIV_LFX_HWGRP_CFG
 (0x10000)

	)

500 
	#SSO_PRIV_LFX_HWGRP_INT_CFG
 (0x20000)

	)

501 
	#SSO_AF_XAQX_GMCTL
(
a
Ë(0xe0000 | (aË<< 3)

	)

502 
	#SSO_AF_XAQX_HEAD_PTR
(
a
Ë(0x80000 | (aË<< 3)

	)

503 
	#SSO_AF_XAQX_TAIL_PTR
(
a
Ë(0x90000 | (aË<< 3)

	)

504 
	#SSO_AF_XAQX_HEAD_NEXT
(
a
Ë(0xa0000 | (aË<< 3)

	)

505 
	#SSO_AF_XAQX_TAIL_NEXT
(
a
Ë(0xb0000 | (aË<< 3)

	)

506 
	#SSO_AF_TOAQX_STATUS
(
a
Ë(0xd0000 | (aË<< 3)

	)

507 
	#SSO_AF_TIAQX_STATUS
(
a
Ë(0xc0000 | (aË<< 3)

	)

508 
	#SSO_AF_HWGRPX_IAQ_THR
(
a
Ë(0x200000 | (aË<< 12)

	)

509 
	#SSO_AF_HWGRPX_TAQ_THR
(
a
Ë(0x200010 | (aË<< 12)

	)

510 
	#SSO_AF_HWGRPX_PRI
(
a
Ë(0x200020 | (aË<< 12)

	)

511 
	#SSO_AF_HWGRPX_WS_PC
(
a
Ë(0x200050 | (aË<< 12)

	)

512 
	#SSO_AF_HWGRPX_EXT_PC
(
a
Ë(0x200060 | (aË<< 12)

	)

513 
	#SSO_AF_HWGRPX_WA_PC
(
a
Ë(0x200070 | (aË<< 12)

	)

514 
	#SSO_AF_HWGRPX_TS_PC
(
a
Ë(0x200080 | (aË<< 12)

	)

515 
	#SSO_AF_HWGRPX_DS_PC
(
a
Ë(0x200090 | (aË<< 12)

	)

516 
	#SSO_AF_HWGRPX_DQ_PC
(
a
Ë(0x2000A0 | (aË<< 12)

	)

517 
	#SSO_AF_HWGRPX_LS_PC
(
a
Ë(0x2000C0 | (aË<< 12)

	)

518 
	#SSO_AF_HWGRPX_STASH
(
a
Ë(0x2000D0 | (aË<< 12)

	)

519 
	#SSO_AF_BAD_STASH_DIGESTX
(
a
Ë(0x2000E0 | (aË<< 12)

	)

520 
	#SSO_AF_HWGRPX_PAGE_CNT
(
a
Ë(0x200100 | (aË<< 12)

	)

521 
	#SSO_AF_IU_ACCNTX_CFG
(
a
Ë(0x50000 | (aË<< 3)

	)

522 
	#SSO_AF_IU_ACCNTX_RST
(
a
Ë(0x60000 | (aË<< 3)

	)

523 
	#SSO_AF_HWGRPX_AW_STATUS
(
a
Ë(0x200110 | (aË<< 12)

	)

524 
	#SSO_AF_HWGRPX_AW_CFG
(
a
Ë(0x200120 | (aË<< 12)

	)

525 
	#SSO_AF_HWGRPX_AW_TAGSPACE
(
a
Ë(0x200130 | (aË<< 12)

	)

526 
	#SSO_AF_HWGRPX_XAQ_AURA
(
a
Ë(0x200140 | (aË<< 12)

	)

527 
	#SSO_AF_HWGRPX_XAQ_LIMIT
(
a
Ë(0x200220 | (aË<< 12)

	)

528 
	#SSO_AF_HWGRPX_IU_ACCNT
(
a
Ë(0x200230 | (aË<< 12)

	)

530 
	#SSO_AF_WS_NE_DIGESTX
(
a
Ë(0x902800 | (aË<< 3)

	)

531 
	#SSO_AF_WS_NI_DIGESTX
(
a
Ë(0x903000 | (aË<< 3)

	)

532 
	#SSO_AF_WS_NT_DIGESTX
(
a
Ë(0x903200 | (aË<< 3)

	)

533 
	#SSO_AF_WS_GUNMAP_DIGESTX
(
a
Ë(0x902200 | (aË<< 3)

	)

535 
	#SSO_AF_HWSX_ARB
(
a
Ë(0x400100 | (aË<< 12)

	)

536 
	#SSO_AF_HWSX_INV
(
a
Ë(0x400180 | (aË<< 12)

	)

537 
	#SSO_AF_HWSX_GMCTL
(
a
Ë(0x400200 | (aË<< 12)

	)

538 
	#SSO_AF_HWSX_LSW_CFG
(
a
Ë(0x400300 | (aË<< 12)

	)

539 
	#SSO_AF_HWSX_SX_GRPMSKX
(
a
, 
b
, 
c
) \

540 (0x400400 | (
a
Ë<< 12 | (
b
Ë<< 5 | (
c
Ë<< 3)

	)

541 
	#SSO_AF_TAQX_LINK
(
a
Ë(0xc00000 | (aË<< 3)

	)

542 
	#SSO_AF_TAQX_WAEY_TAG
(
a
, 
b
Ë(0xe00000 | (aË<< 8 | (bË<< 4)

	)

543 
	#SSO_AF_TAQX_WAEY_WQP
(
a
, 
b
Ë(0xe00008 | (aË<< 8 | (bË<< 4)

	)

544 
	#SSO_AF_IPL_FREEX
(
a
Ë(0x800000 | (aË<< 3)

	)

545 
	#SSO_AF_IPL_IAQX
(
a
Ë(0x840000 | (aË<< 3)

	)

546 
	#SSO_AF_IPL_DESCHEDX
(
a
Ë(0x860000 | (aË<< 3)

	)

547 
	#SSO_AF_IPL_CONFX
(
a
Ë(0x880000 | (aË<< 3)

	)

548 
	#SSO_AF_IENTX_TAG
(
a
Ë(0Xa00000 | (aË<< 3)

	)

549 
	#SSO_AF_IENTX_GRP
(
a
Ë(0xa20000 | (aË<< 3)

	)

550 
	#SSO_AF_IENTX_PENDTAG
(
a
Ë(0xa40000 | (aË<< 3)

	)

551 
	#SSO_AF_IENTX_LINKS
(
a
Ë(0xa60000 | (aË<< 3)

	)

552 
	#SSO_AF_IENTX_QLINKS
(
a
Ë(0xa80000 | (aË<< 3)

	)

553 
	#SSO_AF_IENTX_WQP
(
a
Ë(0xØ0000 | (aË<< 3)

	)

554 
	#SSO_AF_XAQDIS_DIGESTX
(
a
Ë(0x901000 | (aË<< 3)

	)

555 
	#SSO_AF_FLR_AQ_DIGESTX
(
a
Ë(0x901200 | (aË<< 3)

	)

556 
	#SSO_AF_QCTLDIS_DIGESTX
(
a
Ë(0x900E00 | (aË<< 3)

	)

557 
	#SSO_AF_WQP0_DIGESTX
(
a
Ë(0x900A00 | (aË<< 3)

	)

558 
	#SSO_AF_NPA_DIGESTX
(
a
Ë(0x900000 | (aË<< 3)

	)

559 
	#SSO_AF_BFP_DIGESTX
(
a
Ë(0x900200 | (aË<< 3)

	)

560 
	#SSO_AF_BFPN_DIGESTX
(
a
Ë(0x900400 | (aË<< 3)

	)

561 
	#SSO_AF_GRPDIS_DIGESTX
(
a
Ë(0x900600 | (aË<< 3)

	)

563 
	#SSO_AF_CONST1_NO_NSCHED
 
	`BIT_ULL
(34)

	)

564 
	#SSO_AF_CONST1_LSW_PRESENT
 
	`BIT_ULL
(36)

	)

565 
	#SSO_AF_CONST1_PRF_PRESENT
 
	`BIT_ULL
(37)

	)

566 
	#SSO_AF_CONST1_STASH_PRESENT
 
	`BIT_ULL
(38)

	)

567 
	#SSO_AF_IAQ_FREE_CNT_MASK
 0x3FFFuŒ

	)

568 
	#SSO_AF_IAQ_RSVD_FREE_MASK
 0x3FFFuŒ

	)

569 
	#SSO_AF_IAQ_RSVD_FREE_SHIFT
 16

	)

570 
	#SSO_AF_IAQ_FREE_CNT_MAX
 
SSO_AF_IAQ_FREE_CNT_MASK


	)

571 
	#SSO_AF_AW_ADD_RSVD_FREE_MASK
 0x3FFFuŒ

	)

572 
	#SSO_AF_AW_ADD_RSVD_FREE_SHIFT
 16

	)

573 
	#SSO_HWGRP_IAQ_MAX_THR_MASK
 0x3FFFuŒ

	)

574 
	#SSO_HWGRP_IAQ_RSVD_THR_MASK
 0x3FFFuŒ

	)

575 
	#SSO_HWGRP_IAQ_MAX_THR_SHIFT
 32

	)

576 
	#SSO_HWGRP_IAQ_RSVD_THR
 0x2

	)

577 
	#SSO_HWGRP_IAQ_GRP_CNT_SHIFT
 48

	)

578 
	#SSO_HWGRP_IAQ_GRP_CNT_MASK
 0x3FFFuŒ

	)

579 
	#SSO_AF_HWGRPX_IUEX_NOSCHED
(
a
, 
b
)\

580 ((((
b
 >> 48Ë& 0x3FFË=
a
Ë&& (b & 
	`BIT_ULL
(60)))

	)

581 
	#SSO_AF_HWGRP_PAGE_CNT_MASK
 (
	`BIT_ULL
(32Ë- 1)

	)

582 
	#SSO_AF_HWGRP_PAGE_CNT_MASK
 (
	`BIT_ULL
(32Ë- 1)

	)

583 
	#SSO_HWGRP_IAQ_MAX_THR_STRM_PERF
 0xD0

	)

584 
	#SSO_AF_HWGRP_IU_ACCNT_MAX_THR
 0x7FFFuŒ

	)

585 
	#SSO_AF_BP_TEST_CFG3_MASK
 
	`GENMASK_ULL
(23, 22)

	)

587 
	#SSO_AF_TAQ_FREE_CNT_MASK
 0x7FFuŒ

	)

588 
	#SSO_AF_TAQ_RSVD_FREE_MASK
 0x7FFuŒ

	)

589 
	#SSO_AF_TAQ_RSVD_FREE_SHIFT
 16

	)

590 
	#SSO_AF_TAQ_FREE_CNT_MAX
 
SSO_AF_TAQ_FREE_CNT_MASK


	)

591 
	#SSO_AF_TAQ_ADD_RSVD_FREE_MASK
 0x1FFFuŒ

	)

592 
	#SSO_AF_TAQ_ADD_RSVD_FREE_SHIFT
 16

	)

593 
	#SSO_HWGRP_TAQ_MAX_THR_MASK
 0x7FFuŒ

	)

594 
	#SSO_HWGRP_TAQ_RSVD_THR_MASK
 0x7FFuŒ

	)

595 
	#SSO_HWGRP_TAQ_MAX_THR_SHIFT
 32

	)

596 
	#SSO_HWGRP_TAQ_RSVD_THR
 0x3

	)

597 
	#SSO_AF_ERR0_MASK
 0xFFEuŒ

	)

598 
	#SSO_AF_ERR2_MASK
 0xF001F000uŒ

	)

599 
	#SSO_HWGRP_TAQ_MAX_THR_STRM_PERF
 0x10

	)

601 
	#SSO_HWGRP_PRI_MASK
 0x7uŒ

	)

602 
	#SSO_HWGRP_PRI_AFF_MASK
 0xFuŒ

	)

603 
	#SSO_HWGRP_PRI_AFF_SHIFT
 8

	)

604 
	#SSO_HWGRP_PRI_WGT_MASK
 0x3FuŒ

	)

605 
	#SSO_HWGRP_PRI_WGT_SHIFT
 16

	)

606 
	#SSO_HWGRP_PRI_WGT_LEFT_MASK
 0x3FuŒ

	)

607 
	#SSO_HWGRP_PRI_WGT_LEFT_SHIFT
 24

	)

609 
	#SSO_HWGRP_AW_CFG_RWEN
 
	`BIT_ULL
(0)

	)

610 
	#SSO_HWGRP_AW_CFG_LDWB
 
	`BIT_ULL
(1)

	)

611 
	#SSO_HWGRP_AW_CFG_LDT
 
	`BIT_ULL
(2)

	)

612 
	#SSO_HWGRP_AW_CFG_STT
 
	`BIT_ULL
(3)

	)

613 
	#SSO_HWGRP_AW_CFG_XAQ_BYP_DIS
 
	`BIT_ULL
(4)

	)

614 
	#SSO_HWGRP_AW_CFG_XAQ_ALLOC_DIS
 
	`BIT_ULL
(6)

	)

616 
	#SSO_HWGRP_AW_STS_TPTR_VLD
 
	`BIT_ULL
(8)

	)

617 
	#SSO_HWGRP_AW_STS_NPA_FETCH
 
	`BIT_ULL
(9)

	)

618 
	#SSO_HWGRP_AW_STS_TPTR_NEXT_VLD
 
	`BIT_ULL
(10)

	)

619 
	#SSO_HWGRP_AW_STS_XAQ_BUFSC_MASK
 0x7uŒ

	)

620 
	#SSO_HWGRP_AW_STS_INIT_STS
 0x18uŒ

	)

622 
	#SSO_LF_GGRP_OP_ADD_WORK1
 (0x8uŒ)

	)

623 
	#SSO_LF_GGRP_QCTL
 (0x20uŒ)

	)

624 
	#SSO_LF_GGRP_INT
 (0x100uŒ)

	)

625 
	#SSO_LF_GGRP_INT_ENA_W1S
 (0x110uŒ)

	)

626 
	#SSO_LF_GGRP_INT_ENA_W1C
 (0x118uŒ)

	)

627 
	#SSO_LF_GGRP_INT_THR
 (0x140uŒ)

	)

628 
	#SSO_LF_GGRP_INT_CNT
 (0x180uŒ)

	)

629 
	#SSO_LF_GGRP_XAQ_CNT
 (0x1b0uŒ)

	)

630 
	#SSO_LF_GGRP_AQ_CNT
 (0x1c0uŒ)

	)

631 
	#SSO_LF_GGRP_AQ_THR
 (0x1e0uŒ)

	)

632 
	#SSO_LF_GGRP_MISC_CNT
 (0x200uŒ)

	)

634 
	#SSO_LF_GGRP_INT_MASK
 (0X7)

	)

635 
	#SSO_LF_GGRP_AQ_THR_MASK
 (
	`BIT_ULL
(33Ë- 1)

	)

636 
	#SSO_LF_GGRP_XAQ_CNT_MASK
 (
	`BIT_ULL
(33Ë- 1)

	)

637 
	#SSO_LF_GGRP_INT_CNT_MASK
 (0x3FFF3FFF0000uŒ)

	)

640 
	#SSOW_AF_RVU_LF_HWS_CFG_DEBUG
 (0x0010)

	)

641 
	#SSOW_AF_LF_HWS_RST
 (0x0030)

	)

642 
	#SSOW_PRIV_LFX_HWS_CFG
 (0x1000)

	)

643 
	#SSOW_PRIV_LFX_HWS_INT_CFG
 (0x2000)

	)

645 
	#SSOW_LF_GWS_PENDSTATE
 (0x50uŒ)

	)

646 
	#SSOW_LF_GWS_NW_TIM
 (0x70uŒ)

	)

647 
	#SSOW_LF_GWS_INT
 (0x100uŒ)

	)

648 
	#SSOW_LF_GWS_INT_ENA_W1C
 (0x118uŒ)

	)

649 
	#SSOW_LF_GWS_TAG
 (0x200uŒ)

	)

650 
	#SSOW_LF_GWS_WQP
 (0x210uŒ)

	)

651 
	#SSOW_LF_GWS_PRF_TAG
 (0x400uŒ)

	)

652 
	#SSOW_LF_GWS_OP_GET_WORK
 (0x600uŒ)

	)

653 
	#SSOW_LF_GWS_OP_SWTAG_FLUSH
 (0x800uŒ)

	)

654 
	#SSOW_LF_GWS_OP_DESCHED
 (0x880uŒ)

	)

655 
	#SSOW_LF_GWS_OP_CLR_NSCHED0
 (0xA00uŒ)

	)

656 
	#SSOW_LF_GWS_OP_GWC_INVAL
 (0xe00uŒ)

	)

658 
	#SSO_TT_EMPTY
 (0x3)

	)

659 
	#SSOW_LF_GWS_INT_MASK
 (0x7FF)

	)

660 
	#SSOW_LF_GWS_MAX_NW_TIM
 (
	`BIT_ULL
(10Ë- 1)

	)

661 
	#SSOW_LF_GWS_OP_GET_WORK_WAIT
 
	`BIT_ULL
(16)

	)

662 
	#SSOW_LF_GWS_OP_GET_WORK_GROUPED
 
	`BIT_ULL
(18)

	)

663 
	#SSOW_LF_GWS_TAG_PEND_DESCHED
 
	`BIT_ULL
(58)

	)

664 
	#SSOW_LF_GWS_TAG_PEND_SWITCH
 
	`BIT_ULL
(62)

	)

665 
	#SSOW_LF_GWS_TAG_PEND_GET_WORK
 
	`BIT_ULL
(63)

	)

667 
	#SSOW_AF_BAR2_SEL
 (0x9000000uŒ)

	)

668 
	#SSOW_AF_BAR2_ALIASX
(
a
, 
b
Ë
	`RVU_AF_BAR2_ALIASX
◊, b)

	)

670 
	#SSO_AF_BAR2_SEL
 (0x9000000uŒ)

	)

671 
	#SSO_AF_BAR2_ALIASX
(
a
, 
b
Ë
	`RVU_AF_BAR2_ALIASX
◊, b)

	)

674 
	#TIM_AF_CONST
 (0x90)

	)

675 
	#TIM_PRIV_LFX_CFG
 (0x20000)

	)

676 
	#TIM_PRIV_LFX_INT_CFG
 (0x24000)

	)

677 
	#TIM_AF_RVU_LF_CFG_DEBUG
 (0x30000)

	)

678 
	#TIM_AF_BLK_RST
 (0x10)

	)

679 
	#TIM_AF_LF_RST
 (0x20)

	)

680 
	#TIM_AF_FR_RN_GPIOS
 (0x040)

	)

681 
	#TIM_AF_FR_RN_GTI
 (0x050)

	)

682 
	#TIM_AF_FR_RN_PTP
 (0x060)

	)

683 
	#TIM_AF_FR_RN_TENNS
 (0x070)

	)

684 
	#TIM_AF_FR_RN_SYNCE
 (0x140)

	)

685 
	#TIM_AF_FR_RN_BTS
 (0x150)

	)

686 
	#TIM_AF_RINGX_GMCTL
(
a
Ë(0x2000 | (aË<< 3)

	)

687 
	#TIM_AF_RINGX_CTL0
(
a
Ë(0x4000 | (aË<< 3)

	)

688 
	#TIM_AF_RINGX_CTL1
(
a
Ë(0x6000 | (aË<< 3)

	)

689 
	#TIM_AF_RINGX_CTL2
(
a
Ë(0x8000 | (aË<< 3)

	)

690 
	#TIM_AF_FLAGS_REG
 (0x80)

	)

691 
	#TIM_AF_FLAGS_REG_ENA_TIM
 
	`BIT_ULL
(0)

	)

692 
	#TIM_AF_RINGX_CTL1_ENA
 
	`BIT_ULL
(47)

	)

693 
	#TIM_AF_RINGX_CTL1_RCF_BUSY
 
	`BIT_ULL
(50)

	)

694 
	#TIM_AF_ADJUST_TENNS
 (0x160)

	)

695 
	#TIM_AF_ADJUST_GPIOS
 (0x170)

	)

696 
	#TIM_AF_ADJUST_GTI
 (0x180)

	)

697 
	#TIM_AF_ADJUST_PTP
 (0x190)

	)

698 
	#TIM_AF_ADJUST_BTS
 (0x1B0)

	)

699 
	#TIM_AF_ADJUST_TIMERS
 (0x1C0)

	)

700 
	#TIM_AF_ADJUST_TIMERS_MASK
 
	`BIT_ULL
(0)

	)

701 
	#TIM_AF_CAPTURE_TENNS
 (0x1D0)

	)

702 
	#TIM_AF_CAPTURE_GPIOS
 (0x1E0)

	)

703 
	#TIM_AF_CAPTURE_GTI
 (0x1F0)

	)

704 
	#TIM_AF_CAPTURE_PTP
 (0x200)

	)

705 
	#TIM_AF_CAPTURE_BTS
 (0x220)

	)

706 
	#TIM_AF_CAPTURE_EXT_GTI
 (0x240)

	)

707 
	#TIM_AF_CAPTURE_TIMERS
 (0x250)

	)

708 
	#TIM_AF_CAPTURE_TIMERS_MASK
 
	`GENMASK_ULL
(1, 0)

	)

709 
	#TIM_AF_RING_GMCTL_SHIFT
 3

	)

710 
	#TIM_AF_RING_SSO_PF_FUNC_SHIFT
 0

	)

711 
	#TIM_AF_FLAGS_REG_GPIO_EDGE_MASK
 
	`GENMASK_ULL
(6, 5)

	)

714 
	#CPT_AF_CONSTANTS0
 (0x0uŒ)

	)

715 
	#CPT_AF_CONSTANTS1
 (0x1000uŒ)

	)

716 
	#CPT_AF_DIAG
 (0x3000uŒ)

	)

717 
	#CPT_AF_ECO
 (0x4000uŒ)

	)

718 
	#CPT_AF_FLTX_INT
(
a
Ë(0xa000uŒ | (
u64
)◊Ë<< 3)

	)

719 
	#CPT_AF_FLTX_INT_W1S
(
a
Ë(0xb000uŒ | (
u64
)◊Ë<< 3)

	)

720 
	#CPT_AF_FLTX_INT_ENA_W1C
(
a
Ë(0xc000uŒ | (
u64
)◊Ë<< 3)

	)

721 
	#CPT_AF_FLTX_INT_ENA_W1S
(
a
Ë(0xd000uŒ | (
u64
)◊Ë<< 3)

	)

722 
	#CPT_AF_PSNX_EXE
(
a
Ë(0xe000uŒ | (
u64
)◊Ë<< 3)

	)

723 
	#CPT_AF_PSNX_EXE_W1S
(
a
Ë(0xf000uŒ | (
u64
)◊Ë<< 3)

	)

724 
	#CPT_AF_PSNX_LF
(
a
Ë(0x10000uŒ | (
u64
)◊Ë<< 3)

	)

725 
	#CPT_AF_PSNX_LF_W1S
(
a
Ë(0x11000uŒ | (
u64
)◊Ë<< 3)

	)

726 
	#CPT_AF_EXEX_CTL2
(
a
Ë(0x12000uŒ | (
u64
)◊Ë<< 3)

	)

727 
	#CPT_AF_EXEX_STS
(
a
Ë(0x13000uŒ | (
u64
)◊Ë<< 3)

	)

728 
	#CPT_AF_EXE_ERR_INFO
 (0x14000uŒ)

	)

729 
	#CPT_AF_EXEX_ACTIVE
(
a
Ë(0x16000uŒ | (
u64
)◊Ë<< 3)

	)

730 
	#CPT_AF_INST_REQ_PC
 (0x17000uŒ)

	)

731 
	#CPT_AF_INST_LATENCY_PC
 (0x18000uŒ)

	)

732 
	#CPT_AF_RD_REQ_PC
 (0x19000uŒ)

	)

733 
	#CPT_AF_RD_LATENCY_PC
 (0x1a000uŒ)

	)

734 
	#CPT_AF_RD_UC_PC
 (0x1b000uŒ)

	)

735 
	#CPT_AF_ACTIVE_CYCLES_PC
 (0x1c000uŒ)

	)

736 
	#CPT_AF_EXE_DBG_CTL
 (0x1d000uŒ)

	)

737 
	#CPT_AF_EXE_DBG_DATA
 (0x1e000uŒ)

	)

738 
	#CPT_AF_EXE_REQ_TIMER
 (0x1f000uŒ)

	)

739 
	#CPT_AF_EXEX_CTL
(
a
Ë(0x20000uŒ | (
u64
)◊Ë<< 3)

	)

740 
	#CPT_AF_EXE_PERF_CTL
 (0x21000uŒ)

	)

741 
	#CPT_AF_EXE_DBG_CNTX
(
a
Ë(0x22000uŒ | (
u64
)◊Ë<< 3)

	)

742 
	#CPT_AF_EXE_PERF_EVENT_CNT
 (0x23000uŒ)

	)

743 
	#CPT_AF_EXE_EPCI_INBX_CNT
(
a
Ë(0x24000uŒ | (
u64
)◊Ë<< 3)

	)

744 
	#CPT_AF_EXE_EPCI_OUTBX_CNT
(
a
Ë(0x25000uŒ | (
u64
)◊Ë<< 3)

	)

745 
	#CPT_AF_EXEX_UCODE_BASE
(
a
Ë(0x26000uŒ | (
u64
)◊Ë<< 3)

	)

746 
	#CPT_AF_LFX_CTL
(
a
Ë(0x27000uŒ | (
u64
)◊Ë<< 3)

	)

747 
	#CPT_AF_LFX_CTL2
(
a
Ë(0x29000uŒ | (
u64
)◊Ë<< 3)

	)

748 
	#CPT_AF_CPTCLK_CNT
 (0x2a000uŒ)

	)

749 
	#CPT_AF_PF_FUNC
 (0x2b000uŒ)

	)

750 
	#CPT_AF_LFX_PTR_CTL
(
a
Ë(0x2c000uŒ | (
u64
)◊Ë<< 3)

	)

751 
	#CPT_AF_GRPX_THR
(
a
Ë(0x2d000uŒ | (
u64
)◊Ë<< 3)

	)

752 
	#CPT_AF_CTL
 (0x2e000uŒ)

	)

753 
	#CPT_AF_XEX_THR
(
a
Ë(0x2f000uŒ | (
u64
)◊Ë<< 3)

	)

754 
	#CPT_PRIV_LFX_CFG
 (0x41000uŒ)

	)

755 
	#CPT_PRIV_AF_INT_CFG
 (0x42000uŒ)

	)

756 
	#CPT_PRIV_LFX_INT_CFG
 (0x43000uŒ)

	)

757 
	#CPT_AF_LF_RST
 (0x44000uŒ)

	)

758 
	#CPT_AF_RVU_LF_CFG_DEBUG
 (0x45000uŒ)

	)

759 
	#CPT_AF_BLK_RST
 (0x46000uŒ)

	)

760 
	#CPT_AF_RVU_INT
 (0x47000uŒ)

	)

761 
	#CPT_AF_RVU_INT_W1S
 (0x47008uŒ)

	)

762 
	#CPT_AF_RVU_INT_ENA_W1S
 (0x47010uŒ)

	)

763 
	#CPT_AF_RVU_INT_ENA_W1C
 (0x47018uŒ)

	)

764 
	#CPT_AF_RAS_INT
 (0x47020uŒ)

	)

765 
	#CPT_AF_RAS_INT_W1S
 (0x47028uŒ)

	)

766 
	#CPT_AF_RAS_INT_ENA_W1S
 (0x47030uŒ)

	)

767 
	#CPT_AF_RAS_INT_ENA_W1C
 (0x47038uŒ)

	)

768 
	#CPT_AF_CTX_FLUSH_TIMER
 (0x48000uŒ)

	)

769 
	#CPT_AF_CTX_ERR
 (0x48008uŒ)

	)

770 
	#CPT_AF_CTX_ENC_ID
 (0x48010uŒ)

	)

771 
	#CPT_AF_CTX_MIS_PC
 (0x49400uŒ)

	)

772 
	#CPT_AF_CTX_HIT_PC
 (0x49408uŒ)

	)

773 
	#CPT_AF_CTX_AOP_PC
 (0x49410uŒ)

	)

774 
	#CPT_AF_CTX_AOP_LATENCY_PC
 (0x49418uŒ)

	)

775 
	#CPT_AF_CTX_IFETCH_PC
 (0x49420uŒ)

	)

776 
	#CPT_AF_CTX_IFETCH_LATENCY_PC
 (0x49428uŒ)

	)

777 
	#CPT_AF_CTX_FFETCH_PC
 (0x49430uŒ)

	)

778 
	#CPT_AF_CTX_FFETCH_LATENCY_PC
 (0x49438uŒ)

	)

779 
	#CPT_AF_CTX_WBACK_PC
 (0x49440uŒ)

	)

780 
	#CPT_AF_CTX_WBACK_LATENCY_PC
 (0x49448uŒ)

	)

781 
	#CPT_AF_CTX_PSH_PC
 (0x49450uŒ)

	)

782 
	#CPT_AF_CTX_PSH_LATENCY_PC
 (0x49458uŒ)

	)

783 
	#CPT_AF_CTX_CAM_DATA
(
a
Ë(0x49800uŒ | (
u64
)◊Ë<< 3)

	)

784 
	#CPT_AF_RXC_TIME
 (0x50010uŒ)

	)

785 
	#CPT_AF_RXC_TIME_CFG
 (0x50018uŒ)

	)

786 
	#CPT_AF_RXC_DFRG
 (0x50020uŒ)

	)

787 
	#CPT_AF_RXC_ACTIVE_STS
 (0x50028uŒ)

	)

788 
	#CPT_AF_RXC_ZOMBIE_STS
 (0x50030uŒ)

	)

789 
	#CPT_AF_X2PX_LINK_CFG
(
a
Ë(0x51000uŒ | (
u64
)◊Ë<< 3)

	)

791 
	#CPT_AF_BAR2_SEL
 0x9000000

	)

792 
	#CPT_AF_BAR2_ALIASX
(
a
, 
b
Ë
	`RVU_AF_BAR2_ALIASX
◊, b)

	)

794 
	#CPT_AF_LF_CTL2_SHIFT
 3

	)

795 
	#CPT_AF_LF_SSO_PF_FUNC_SHIFT
 32

	)

797 
	#CPT_LF_CTL
 0x10

	)

798 
	#CPT_LF_INPROG
 0x40

	)

799 
	#CPT_LF_Q_SIZE
 0x100

	)

800 
	#CPT_LF_Q_INST_PTR
 0x110

	)

801 
	#CPT_LF_Q_GRP_PTR
 0x120

	)

802 
	#CPT_LF_CTX_FLUSH
 0x510

	)

805 
	#NPC_AF_CFG
 (0x00000)

	)

806 
	#NPC_AF_ACTIVE_PC
 (0x00010)

	)

807 
	#NPC_AF_CONST
 (0x00020)

	)

808 
	#NPC_AF_CONST1
 (0x00030)

	)

809 
	#NPC_AF_BLK_RST
 (0x00040)

	)

810 
	#NPC_AF_MCAM_SCRUB_CTL
 (0x000a0)

	)

811 
	#NPC_AF_KCAM_SCRUB_CTL
 (0x000b0)

	)

812 
	#NPC_AF_CONST2
 (0x00100)

	)

813 
	#NPC_AF_CONST3
 (0x00110)

	)

814 
	#NPC_AF_KPUX_CFG
(
a
Ë(0x00500 | (aË<< 3)

	)

815 
	#NPC_AF_PCK_CFG
 (0x00600)

	)

816 
	#NPC_AF_PCK_DEF_OL2
 (0x00610)

	)

817 
	#NPC_AF_PCK_DEF_OIP4
 (0x00620)

	)

818 
	#NPC_AF_PCK_DEF_OIP6
 (0x00630)

	)

819 
	#NPC_AF_PCK_DEF_IIP4
 (0x00640)

	)

820 
	#NPC_AF_INTFX_HASHX_RESULT_CTRL
(
a
, 
b
Ë(0x006c0 | (aË<< 4 | (bË<< 3)

	)

821 
	#NPC_AF_INTFX_HASHX_MASKX
(
a
, 
b
, 
c
Ë(0x00700 | (aË<< 5 | (bË<< 4 | (cË<< 3)

	)

822 
	#NPC_AF_KEX_LDATAX_FLAGS_CFG
(
a
Ë(0x00800 | (aË<< 3)

	)

823 
	#NPC_AF_INTFX_HASHX_CFG
(
a
, 
b
Ë(0x00b00 | (aË<< 6 | (bË<< 4)

	)

824 
	#NPC_AF_INTFX_SECRET_KEY0
(
a
Ë(0x00e00 | (aË<< 3)

	)

825 
	#NPC_AF_INTFX_SECRET_KEY1
(
a
Ë(0x00e20 | (aË<< 3)

	)

826 
	#NPC_AF_INTFX_SECRET_KEY2
(
a
Ë(0x00e40 | (aË<< 3)

	)

827 
	#NPC_AF_INTFX_KEX_CFG
(
a
Ë(0x01010 | (aË<< 8)

	)

828 
	#NPC_AF_PKINDX_ACTION0
(
a
Ë(0x80000uŒ | (aË<< 6)

	)

829 
	#NPC_AF_PKINDX_ACTION1
(
a
Ë(0x80008uŒ | (aË<< 6)

	)

830 
	#NPC_AF_PKINDX_CPI_DEFX
(
a
, 
b
Ë(0x80020uŒ | (aË<< 6 | (bË<< 3)

	)

831 
	#NPC_AF_KPUX_ENTRYX_CAMX
(
a
, 
b
, 
c
) \

832 (0x100000 | (
a
Ë<< 14 | (
b
Ë<< 6 | (
c
Ë<< 3)

	)

833 
	#NPC_AF_KPUX_ENTRYX_ACTION0
(
a
, 
b
) \

834 (0x100020 | (
a
Ë<< 14 | (
b
Ë<< 6)

	)

835 
	#NPC_AF_KPUX_ENTRYX_ACTION1
(
a
, 
b
) \

836 (0x100028 | (
a
Ë<< 14 | (
b
Ë<< 6)

	)

837 
	#NPC_AF_KPUX_ENTRY_DISX
(
a
, 
b
Ë(0x180000 | (aË<< 6 | (bË<< 3)

	)

838 
	#NPC_AF_CPIX_CFG
(
a
Ë(0x200000 | (aË<< 3)

	)

839 
	#NPC_AF_INTFX_LIDX_LTX_LDX_CFG
(
a
, 
b
, 
c
, 
d
) \

840 (0x900000 | (
a
Ë<< 16 | (
b
Ë<< 12 | (
c
Ë<< 5 | (
d
Ë<< 3)

	)

841 
	#NPC_AF_INTFX_LDATAX_FLAGSX_CFG
(
a
, 
b
, 
c
) \

842 (0x980000 | (
a
Ë<< 16 | (
b
Ë<< 12 | (
c
Ë<< 3)

	)

843 
	#NPC_AF_INTFX_MISS_STAT_ACT
(
a
Ë(0x1880040 + (aË* 0x8)

	)

844 
	#NPC_AF_INTFX_MISS_ACT
(
a
Ë(0x1a00000 | (aË<< 4)

	)

845 
	#NPC_AF_INTFX_MISS_TAG_ACT
(
a
Ë(0x1b00008 | (aË<< 4)

	)

846 
	#NPC_AF_MCAM_BANKX_HITX
(
a
, 
b
Ë(0x1c80000 | (aË<< 8 | (bË<< 4)

	)

847 
	#NPC_AF_LKUP_CTL
 (0x2000000)

	)

848 
	#NPC_AF_LKUP_DATAX
(
a
Ë(0x2000200 | (aË<< 4)

	)

849 
	#NPC_AF_LKUP_RESULTX
(
a
Ë(0x2000400 | (aË<< 4)

	)

850 
	#NPC_AF_INTFX_STAT
(
a
Ë(0x2000800 | (aË<< 4)

	)

851 
	#NPC_AF_DBG_CTL
 (0x3000000)

	)

852 
	#NPC_AF_DBG_STATUS
 (0x3000010)

	)

853 
	#NPC_AF_KPUX_DBG
(
a
Ë(0x3000020 | (aË<< 8)

	)

854 
	#NPC_AF_IKPU_ERR_CTL
 (0x3000080)

	)

855 
	#NPC_AF_KPUX_ERR_CTL
(
a
Ë(0x30000a0 | (aË<< 8)

	)

856 
	#NPC_AF_MCAM_DBG
 (0x3001000)

	)

857 
	#NPC_AF_DBG_DATAX
(
a
Ë(0x3001400 | (aË<< 4)

	)

858 
	#NPC_AF_DBG_RESULTX
(
a
Ë(0x3001800 | (aË<< 4)

	)

860 
	#NPC_AF_EXACT_MEM_ENTRY
(
a
, 
b
Ë(0x300000 | (aË<< 15 | (bË<< 3)

	)

861 
	#NPC_AF_EXACT_CAM_ENTRY
(
a
Ë(0xC00 | (aË<< 3)

	)

862 
	#NPC_AF_INTFX_EXACT_MASK
(
a
Ë(0x660 | (aË<< 3)

	)

863 
	#NPC_AF_INTFX_EXACT_RESULT_CTL
(
a
)(0x680 | (aË<< 3)

	)

864 
	#NPC_AF_INTFX_EXACT_CFG
(
a
Ë(0xA00 | (aË<< 3)

	)

865 
	#NPC_AF_INTFX_EXACT_SECRET0
(
a
Ë(0xE00 | (aË<< 3)

	)

866 
	#NPC_AF_INTFX_EXACT_SECRET1
(
a
Ë(0xE20 | (aË<< 3)

	)

867 
	#NPC_AF_INTFX_EXACT_SECRET2
(
a
Ë(0xE40 | (aË<< 3)

	)

869 
	#NPC_AF_MCAMEX_BANKX_CAMX_INTF
(
a
, 
b
, 
c
) ({ \

870 
u64
 
off£t
; \

872 
off£t
 = (0x1000000uŒ | (
a
Ë<< 10 | (
b
Ë<< 6 | (
c
) << 3); \

873 i‡(
rvu
->
hw
->
≈c_ext_£t
) \

874 
off£t
 = (0x8000000uŒ | (
a
Ë<< 8 | (
b
Ë<< 22 | (
c
) << 3); \

875 
off£t
; })

	)

877 
	#NPC_AF_MCAMEX_BANKX_CAMX_W0
(
a
, 
b
, 
c
) ({ \

878 
u64
 
off£t
; \

880 
off£t
 = (0x1000010uŒ | (
a
Ë<< 10 | (
b
Ë<< 6 | (
c
) << 3); \

881 i‡(
rvu
->
hw
->
≈c_ext_£t
) \

882 
off£t
 = (0x8000010uŒ | (
a
Ë<< 8 | (
b
Ë<< 22 | (
c
) << 3); \

883 
off£t
; })

	)

885 
	#NPC_AF_MCAMEX_BANKX_CAMX_W1
(
a
, 
b
, 
c
) ({ \

886 
u64
 
off£t
; \

888 
off£t
 = (0x1000020uŒ | (
a
Ë<< 10 | (
b
Ë<< 6 | (
c
) << 3); \

889 i‡(
rvu
->
hw
->
≈c_ext_£t
) \

890 
off£t
 = (0x8000020uŒ | (
a
Ë<< 8 | (
b
Ë<< 22 | (
c
) << 3); \

891 
off£t
; })

	)

893 
	#NPC_AF_MCAMEX_BANKX_CFG
(
a
, 
b
) ({ \

894 
u64
 
off£t
; \

896 
off£t
 = (0x1800000uŒ | (
a
Ë<< 8 | (
b
) << 4); \

897 i‡(
rvu
->
hw
->
≈c_ext_£t
) \

898 
off£t
 = (0x8000038uŒ | (
a
Ë<< 8 | (
b
) << 22); \

899 
off£t
; })

	)

901 
	#NPC_AF_MCAMEX_BANKX_ACTION
(
a
, 
b
) ({ \

902 
u64
 
off£t
; \

904 
off£t
 = (0x1900000uŒ | (
a
Ë<< 8 | (
b
) << 4); \

905 i‡(
rvu
->
hw
->
≈c_ext_£t
) \

906 
off£t
 = (0x8000040uŒ | (
a
Ë<< 8 | (
b
) << 22); \

907 
off£t
; }) \

908 

	)

909 
	#NPC_AF_MCAMEX_BANKX_TAG_ACT
(
a
, 
b
) ({ \

910 
u64
 
off£t
; \

912 
off£t
 = (0x1900008uŒ | (
a
Ë<< 8 | (
b
) << 4); \

913 i‡(
rvu
->
hw
->
≈c_ext_£t
) \

914 
off£t
 = (0x8000048uŒ | (
a
Ë<< 8 | (
b
) << 22); \

915 
off£t
; }) \

916 

	)

917 
	#NPC_AF_MCAMEX_BANKX_STAT_ACT
(
a
, 
b
) ({ \

918 
u64
 
off£t
; \

920 
off£t
 = (0x1880000uŒ | (
a
Ë<< 8 | (
b
) << 4); \

921 i‡(
rvu
->
hw
->
≈c_ext_£t
) \

922 
off£t
 = (0x8000050uŒ | (
a
Ë<< 8 | (
b
) << 22); \

923 
off£t
; }) \

924 

	)

925 
	#NPC_AF_MATCH_STATX
(
a
) ({ \

926 
u64
 
off£t
; \

928 
off£t
 = (0x1880008uŒ | (
a
) << 8); \

929 i‡(
rvu
->
hw
->
≈c_ext_£t
) \

930 
off£t
 = (0x8000078uŒ | (
a
) << 8); \

931 
off£t
; }) \

932 

	)

934 
	#NDC_AF_CONST
 (0x00000)

	)

935 
	#NDC_AF_CLK_EN
 (0x00020)

	)

936 
	#NDC_AF_CTL
 (0x00030)

	)

937 
	#NDC_AF_BANK_CTL
 (0x00040)

	)

938 
	#NDC_AF_BANK_CTL_DONE
 (0x00048)

	)

939 
	#NDC_AF_INTR
 (0x00058)

	)

940 
	#NDC_AF_INTR_W1S
 (0x00060)

	)

941 
	#NDC_AF_INTR_ENA_W1S
 (0x00068)

	)

942 
	#NDC_AF_INTR_ENA_W1C
 (0x00070)

	)

943 
	#NDC_AF_ACTIVE_PC
 (0x00078)

	)

944 
	#NDC_AF_CAMS_RD_INTERVAL
 (0x00080)

	)

945 
	#NDC_AF_BP_TEST_ENABLE
 (0x001F8)

	)

946 
	#NDC_AF_BP_TEST
(
a
Ë(0x00200 | (aË<< 3)

	)

947 
	#NDC_AF_BLK_RST
 (0x002F0)

	)

948 
	#NDC_PRIV_AF_INT_CFG
 (0x002F8)

	)

949 
	#NDC_AF_HASHX
(
a
Ë(0x00300 | (aË<< 3)

	)

950 
	#NDC_AF_PORTX_RTX_RWX_REQ_PC
(
a
, 
b
, 
c
) \

951 (0x00C00 | (
a
Ë<< 5 | (
b
Ë<< 4 | (
c
Ë<< 3)

	)

952 
	#NDC_AF_PORTX_RTX_RWX_OSTDN_PC
(
a
, 
b
, 
c
) \

953 (0x00D00 | (
a
Ë<< 5 | (
b
Ë<< 4 | (
c
Ë<< 3)

	)

954 
	#NDC_AF_PORTX_RTX_RWX_LAT_PC
(
a
, 
b
, 
c
) \

955 (0x00E00 | (
a
Ë<< 5 | (
b
Ë<< 4 | (
c
Ë<< 3)

	)

956 
	#NDC_AF_PORTX_RTX_CANT_ALLOC_PC
(
a
, 
b
) \

957 (0x00F00 | (
a
Ë<< 5 | (
b
Ë<< 4)

	)

958 
	#NDC_AF_BANKX_HIT_PC
(
a
Ë(0x01000 | (aË<< 3)

	)

959 
	#NDC_AF_BANKX_MISS_PC
(
a
Ë(0x01100 | (aË<< 3)

	)

960 
	#NDC_AF_BANKX_LINEX_METADATA
(
a
, 
b
) \

961 (0x10000 | (
a
Ë<< 3 | (
b
Ë<< 3)

	)

964 
	#REE_AF_CMD_CTL
 (0x00uŒ)

	)

965 
	#REE_AF_CONSTANTS
 (0x0A0uŒ)

	)

966 
	#REE_AF_AQ_SBUF_CTL
 (0x100uŒ)

	)

967 
	#REE_AF_AQ_SBUF_ADDR
 (0x110uŒ)

	)

968 
	#REE_AF_AQ_DONE
 (0x128uŒ)

	)

969 
	#REE_AF_AQ_DONE_ACK
 (0x130uŒ)

	)

970 
	#REE_AF_AQ_DONE_INT
 (0x150uŒ)

	)

971 
	#REE_AF_AQ_DONE_INT_ENA_W1S
 (0x168uŒ)

	)

972 
	#REE_AF_AQ_DONE_INT_ENA_W1C
 (0x170uŒ)

	)

973 
	#REE_AF_AQ_ENA
 (0x180uŒ)

	)

974 
	#REE_AF_AQ_DOORBELL
 (0x200uŒ)

	)

975 
	#REE_AF_PF_FUNC
 (0x210uŒ)

	)

976 
	#REE_AF_EM_BASE
 (0x300uŒ)

	)

977 
	#REE_AF_RAS
 (0x980uŒ)

	)

978 
	#REE_AF_RAS_ENA_W1C
 (0x990uŒ)

	)

979 
	#REE_AF_RAS_ENA_W1S
 (0x998uŒ)

	)

980 
	#REE_AF_QUE_SBUF_CTL
(
a
Ë(0x1200uŒ | (aË<< 3)

	)

981 
	#REE_PRIV_AF_INT_CFG
 (0x4000uŒ)

	)

982 
	#REE_AF_REEXM_STATUS
 (0x8050uŒ)

	)

983 
	#REE_AF_REEXM_CTRL
 (0x80C0uŒ)

	)

984 
	#REE_AF_REEXM_MAX_MATCH
 (0x80C8uŒ)

	)

985 
	#REE_AF_REEXM_MAX_PRE_CNT
 (0x80D0uŒ)

	)

986 
	#REE_AF_REEXM_MAX_PTHREAD_CNT
 (0x80D8uŒ)

	)

987 
	#REE_AF_REEXM_MAX_LATENCY_CNT
 (0x80E0uŒ)

	)

988 
	#REE_AF_REEXR_STATUS
 (0x8250uŒ)

	)

989 
	#REE_AF_REEXR_CTRL
 (0x82C0uŒ)

	)

990 
	#REE_PRIV_LFX_CFG
 (0x41000uŒ)

	)

991 
	#REE_PRIV_LFX_INT_CFG
 (0x42000uŒ)

	)

992 
	#REE_AF_LF_RST
 (0x43000uŒ)

	)

993 
	#REE_AF_RVU_LF_CFG_DEBUG
 (0x44000uŒ)

	)

994 
	#REE_AF_BLK_RST
 (0x45000uŒ)

	)

995 
	#REE_AF_RVU_INT
 (0x46000uŒ)

	)

996 
	#REE_AF_RVU_INT_ENA_W1S
 (0x46010uŒ)

	)

997 
	#REE_AF_RVU_INT_ENA_W1C
 (0x46018uŒ)

	)

998 
	#REE_AF_AQ_INT
 (0x46020uŒ)

	)

999 
	#REE_AF_AQ_INT_ENA_W1S
 (0x46030uŒ)

	)

1000 
	#REE_AF_AQ_INT_ENA_W1C
 (0x46038uŒ)

	)

1001 
	#REE_AF_GRACEFUL_DIS_CTL
 (0x46100uŒ)

	)

1002 
	#REE_AF_GRACEFUL_DIS_STATUS
 (0x46110uŒ)

	)

1004 
	#REE_AF_FORCE_CSCLK
 
	`BIT_ULL
(1)

	)

1005 
	#REE_AF_FORCE_CCLK
 
	`BIT_ULL
(2)

	)

1006 
	#REE_AF_RAS_DAT_PSN
 
	`BIT_ULL
(0)

	)

1007 
	#REE_AF_RAS_LD_CMD_PSN
 
	`BIT_ULL
(1)

	)

1008 
	#REE_AF_RAS_LD_REEX_PSN
 
	`BIT_ULL
(2)

	)

1009 
	#REE_AF_RVU_INT_UNMAPPED_SLOT
 
	`BIT_ULL
(0)

	)

1010 
	#REE_AF_AQ_INT_DOVF
 
	`BIT_ULL
(0)

	)

1011 
	#REE_AF_AQ_INT_IRDE
 
	`BIT_ULL
(1)

	)

1012 
	#REE_AF_AQ_INT_PRDE
 
	`BIT_ULL
(2)

	)

1013 
	#REE_AF_AQ_INT_PLLE
 
	`BIT_ULL
(3)

	)

1014 
	#REE_AF_REEXM_CTRL_INIT
 
	`BIT_ULL
(0)

	)

1015 
	#REE_AF_REEXM_CTRL_GO
 
	`BIT_ULL
(3)

	)

1016 
	#REE_AF_REEXM_STATUS_INIT_DONE
 
	`BIT_ULL
(0)

	)

1017 
	#REE_AF_REEXR_CTRL_INIT
 
	`BIT_ULL
(0)

	)

1018 
	#REE_AF_REEXR_CTRL_GO
 
	`BIT_ULL
(1)

	)

1019 
	#REE_AF_REEXR_CTRL_MODE_IM_L1_L2
 
	`BIT_ULL
(4)

	)

1020 
	#REE_AF_REEXR_CTRL_MODE_L1_L2
 
	`BIT_ULL
(5)

	)

1022 
	#REE_AF_AQ_SBUF_CTL_SIZE_SHIFT
 32

	)

1023 
	#REE_AF_REEXM_MAX_MATCH_MAX
 0xFEuŒ

	)

1024 
	#REE_AF_REEXM_MAX_PRE_CNT_COUNT
 0x3F0uŒ

	)

1025 
	#REE_AF_REEXM_MAX_PTHREAD_COUNT
 0xFFFFuŒ

	)

1026 
	#REE_AF_REEXM_MAX_LATENCY_COUNT
 0xFFFFuŒ

	)

1027 
	#REE_AF_QUE_SBUF_CTL_SIZE_SHIFT
 32

	)

1028 
	#REE_AF_REEX_CSR_BLOCK_BASE_ADDR
 (0x8000uŒ)

	)

1029 
	#REE_AF_REEX_CSR_BLOCK_ID
 (0x200uŒ)

	)

1030 
	#REE_AF_REEX_CSR_BLOCK_ID_MASK
 
	`GENMASK_ULL
(18, 16)

	)

1031 
	#REE_AF_REEX_CSR_BLOCK_ID_SHIFT
 16

	)

1032 
	#REE_AF_REEX_CSR_INDEX
 8

	)

1033 
	#REE_AF_REEX_CSR_INDEX_MASK
 
	`GENMASK_ULL
(4, 0)

	)

1034 
	#REE_AF_QUE_SBUF_CTL_MAX_SIZE
 
	`GENMASK_ULL
((50 - 32), 0)

	)

1035 
	#REE_AF_REEXR_STATUS_IM_INIT_DONE
 
	`BIT_ULL
(4)

	)

1036 
	#REE_AF_REEXR_STATUS_L1_CACHE_INIT_DONE
 
	`BIT_ULL
(5)

	)

1037 
	#REE_AF_REEXR_STATUS_L2_CACHE_INIT_DONE
 
	`BIT_ULL
(6)

	)

1040 
	#LBK_CONST
 (0x10uŒ)

	)

1041 
	#LBK_LINK_CFG_P2X
 (0x400uŒ)

	)

1042 
	#LBK_LINK_CFG_X2P
 (0x408uŒ)

	)

1043 
	#LBK_CONST_CHANS
 
	`GENMASK_ULL
(47, 32)

	)

1044 
	#LBK_CONST_DST
 
	`GENMASK_ULL
(31, 28)

	)

1045 
	#LBK_CONST_SRC
 
	`GENMASK_ULL
(27, 24)

	)

1046 
	#LBK_CONST_BUF_SIZE
 
	`GENMASK_ULL
(23, 0)

	)

1047 
	#LBK_LINK_CFG_RANGE_MASK
 
	`GENMASK_ULL
(19, 16)

	)

1048 
	#LBK_LINK_CFG_ID_MASK
 
	`GENMASK_ULL
(11, 6)

	)

1049 
	#LBK_LINK_CFG_BASE_MASK
 
	`GENMASK_ULL
(5, 0)

	)

1052 
	#APR_AF_LMT_CFG
 (0x000uŒ)

	)

1053 
	#APR_AF_LMT_MAP_BASE
 (0x008uŒ)

	)

1054 
	#APR_AF_LMT_CTL
 (0x010uŒ)

	)

1056 
	#APR_LMT_MAP_ENT_DIS_SCH_CMP_SHIFT
 23

	)

1057 
	#APR_LMT_MAP_ENT_SCH_ENA_SHIFT
 22

	)

1058 
	#APR_LMT_MAP_ENT_DIS_LINE_PREF_SHIFT
 21

	)

	@rvu_sdp.c

8 
	~<löux/pci.h
>

9 
	~"rvu.h
"

12 
	#PCI_DEVID_OTX2_SDP_PF
 0xA0F6

	)

15 
	#MAX_SDP
 2

	)

18 
	gsdp_pf_num
[
MAX_SDP
] = {-1, -1};

20 
boﬁ
 
	$is_sdp_pfvf
(
u16
 
pcifunc
)

22 
u16
 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

23 
u32
 
found
 = 0, 
i
 = 0;

25 
i
 < 
MAX_SDP
) {

26 i‡(
pf
 =
sdp_pf_num
[
i
])

27 
found
 = 1;

28 
i
++;

31 i‡(!
found
)

32  
Ál£
;

34  
åue
;

35 
	}
}

37 
boﬁ
 
	$is_sdp_pf
(
u16
 
pcifunc
)

39  (
	`is_sdp_pfvf
(
pcifunc
) &&

40 !(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
));

41 
	}
}

43 
boﬁ
 
	$is_sdp_vf
(
u16
 
pcifunc
)

45  (
	`is_sdp_pfvf
(
pcifunc
) &&

46 !!(
pcifunc
 & 
RVU_PFVF_FUNC_MASK
));

47 
	}
}

49 
	$rvu_sdp_öô
(
rvu
 *rvu)

51 
pci_dev
 *
pdev
 = 
NULL
;

52 
rvu_pfvf
 *
pfvf
;

53 
u32
 
i
 = 0;

55 (
i
 < 
MAX_SDP
Ë&& (
pdev
 = 
	`pci_gë_devi˚
(
PCI_VENDOR_ID_CAVIUM
,

56 
PCI_DEVID_OTX2_SDP_PF
,

57 
pdev
)Ë!
NULL
) {

59 
sdp_pf_num
[
i
] = 
pdev
->
bus
->
numbî
 - 1;

60 
pfvf
 = &
rvu
->
pf
[
sdp_pf_num
[
i
]];

62 
pfvf
->
sdp_öfo
 = 
	`devm_kzÆloc
(
rvu
->
dev
,

63 (
sdp_node_öfo
),

64 
GFP_KERNEL
);

65 i‡(!
pfvf
->
sdp_öfo
)

66  -
ENOMEM
;

68 
	`dev_öfo
(
rvu
->
dev
, "SDP PFÇumbî:%d\n", 
sdp_pf_num
[
i
]);

70 
	`put_devi˚
(&
pdev
->
dev
);

71 
i
++;

75 
	}
}

78 
	$rvu_mbox_h™dÀr_£t_sdp_ch™_öfo
(
rvu
 *rvu,

79 
sdp_ch™_öfo_msg
 *
ªq
,

80 
msg_r•
 *
r•
)

82 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
ªq
->
hdr
.
pcifunc
);

84 
	`mem˝y
(
pfvf
->
sdp_öfo
, &
ªq
->
öfo
, (
sdp_node_öfo
));

85 
	`dev_öfo
(
rvu
->
dev
, "AF: SDP%d max_rvu_vfs %dÇum_pf_rings %dÖf_srn %d\n",

86 
ªq
->
öfo
.
node_id
,Ñeq->öfo.
max_rvu_vfs
,Ñeq->öfo.
num_pf_rögs
,

87 
ªq
->
öfo
.
pf_§n
);

89 
	}
}

92 
	$rvu_mbox_h™dÀr_gë_sdp_ch™_öfo
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

93 
sdp_gë_ch™_öfo_msg
 *
r•
)

95 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

96 
blkaddr
;

98 i‡(!
hw
->
ˇp
.
¥ogømmabÀ_ch™s
) {

99 
r•
->
ch™_ba£
 = 
NIX_CHAN_SDP_CH_START
;

100 
r•
->
num_ch™
 = 
NIX_CHAN_SDP_NUM_CHANS
;

102 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 0);

103 
r•
->
ch™_ba£
 = 
hw
->
sdp_ch™_ba£
;

104 
r•
->
num_ch™
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
NIX_AF_CONST1
) & 0xFFFUL;

108 
	}
}

	@rvu_sso.c

8 
	~<asm/b¨rõr.h
>

9 
	~<löux/öãºu±.h
>

10 
	~<löux/úq.h
>

11 
	~<löux/ty≥s.h
>

12 
	~<löux/jiffõs.h
>

14 
	~"rvu_°ru˘.h
"

16 
	~"rvu_ªg.h
"

17 
	~"rvu.h
"

19 
	#NPA_LF_AURA_OP_FREE0
 0x20

	)

20 
	#NPA_LF_AURA_OP_CNT
 0x30

	)

21 
	#SSO_FLUSH_RETRY_MAX
 0xff

	)

23 #i‡
deföed
(
CONFIG_ARM64
)

24 
	#rvu_sso_°‹e_∑ú
(
vÆ0
, 
vÆ1
, 
addr
) ({ \

25 
__asm__
 volatile("stp %x[x0], %x[x1], [%x[p1]]" \

28 [
x0
]"r"(
vÆ0
), [
x1
]"r"(
vÆ1
), [
p1
]"r"(
addr
)); \

29 })

	)

31 
	#rvu_sso_ldadd
(
ªsu…
, 
ö¸
, 
±r
) ({ \

32 
__asm__
 volatile(".cpu generic+lse\n" \

34 : [
r
] "Ù" (
ªsu…
), "+m" (*
±r
) \

35 : [
i
] "r" (
ö¸
), [
b
] "r" (
±r
) \

37 })

	)

39 
	#rvu_sso_°‹e_∑ú
(
vÆ0
, 
vÆ1
, 
addr
) \

41 
u64
 *
addr1
 = (*)
addr
; \

42 *
addr1
 = 
vÆ0
; \

43 *(
u64
 *)(((
u8
 *)
addr1
Ë+ 8Ë
vÆ1
; \

44 } 0)

	)

46 
	#rvu_sso_ldadd
(
ªsu…
, 
ö¸
, 
±r
) \

48 } 0)

	)

51 
	#SSO_AF_INT_DIGEST_PRNT
(
ªg
) \

52 
i
 = 0; i < 
block
->
lf
.
max
 / 64; i++) { \

53 
ªg0
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
ªg
##
	`X
(
i
)); \

54 
	`dev_îr_øãlimôed
(
rvu
->
dev
, #ªg "(%dË: 0x%Œx", 
i
, \

55 
ªg0
); \

56 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
ªg
##
	`X
(
i
), 
ªg0
); \

57 }

	)

59 
	$rvu_sso_hwgΩ_c⁄fig_thªsh
(
rvu
 *rvu, 
blkaddr
, 
lf
,

60 
sso_aq_thr
 *
aq_thr
)

62 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

63 
u64
 
add
, 
gΩ_thr
, 
gΩ_rsvd
;

64 
u64
 
ªg
;

67 i‡(!
aq_thr
)

68 
aq_thr
 = &
hw
->
sso
.aq_thr;

71 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_IAQ_THR
(
lf
));

72 
gΩ_rsvd
 = 
ªg
 & 
SSO_HWGRP_IAQ_RSVD_THR_MASK
;

73 
add
 = 
aq_thr
->
üq_rsvd
 - 
gΩ_rsvd
;

75 
gΩ_thr
 = 
aq_thr
->
üq_rsvd
 & 
SSO_HWGRP_IAQ_RSVD_THR_MASK
;

76 
gΩ_thr
 |((
aq_thr
->
üq_max
 & 
SSO_HWGRP_IAQ_MAX_THR_MASK
)

77 << 
SSO_HWGRP_IAQ_MAX_THR_SHIFT
);

79 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_IAQ_THR
(
lf
), 
gΩ_thr
);

81 i‡(
add
)

82 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_AW_ADD
,

83 (
add
 & 
SSO_AF_AW_ADD_RSVD_FREE_MASK
) <<

84 
SSO_AF_AW_ADD_RSVD_FREE_SHIFT
);

87 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TAQ_THR
(
lf
));

88 
gΩ_rsvd
 = 
ªg
 & 
SSO_HWGRP_TAQ_RSVD_THR_MASK
;

89 
add
 = 
aq_thr
->
èq_rsvd
 - 
gΩ_rsvd
;

91 
gΩ_thr
 = 
aq_thr
->
èq_rsvd
 & 
SSO_HWGRP_TAQ_RSVD_THR_MASK
;

92 
gΩ_thr
 |((
aq_thr
->
èq_max
 & 
SSO_HWGRP_TAQ_MAX_THR_MASK
)

93 << 
SSO_HWGRP_TAQ_MAX_THR_SHIFT
);

95 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TAQ_THR
(
lf
), 
gΩ_thr
);

97 i‡(
add
)

98 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_TAQ_ADD
,

99 (
add
 & 
SSO_AF_TAQ_RSVD_FREE_MASK
) <<

100 
SSO_AF_TAQ_ADD_RSVD_FREE_SHIFT
);

101 
	}
}

103 
	$rvu_sso_íabÀ_aw_§c
(
rvu
 *rvu, 
lf_˙t
, 
sub_blkaddr
,

104 
u64
 
addr
, *
lf_¨r
, 
u16
 
pcifunc
, 
u8
 
shi·
,

105 
u8
 
addr_off
)

107 
u64
 
ªg
;

108 
lf
;

110 
lf
 = 0;Ü‡< 
lf_˙t
;Üf++) {

111 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
sub_blkaddr
, 
addr
 |

112 
lf_¨r
[
lf
] << 
addr_off
);

114 
ªg
 |((
u64
)
pcifunc
 << 
shi·
);

115 
	`rvu_wrôe64
(
rvu
, 
sub_blkaddr
, 
addr
 |

116 
lf_¨r
[
lf
] << 
addr_off
, 
ªg
);

118 
	}
}

120 
	$rvu_sso_dißbÀ_aw_§c
(
rvu
 *rvu, **
lf_¨r
,

121 
sub_blkaddr
, 
u8
 
shi·
, u8 
addr_off
,

122 
u16
 
pcifunc
, 
u64
 
addr
)

124 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

125 
rvu_block
 *
block
;

126 
lf_˙t
 = 0, 
lf
;

127 
u64
 
ªg
;

129 i‡(
sub_blkaddr
 >= 0) {

130 
block
 = &
hw
->block[
sub_blkaddr
];

131 *
lf_¨r
 = 
	`kmÆloc
(
block
->
lf
.
max
 * (), 
GFP_KERNEL
);

132 i‡(!*
lf_¨r
)

135 
lf
 = 0;Ü‡< 
block
->lf.
max
;Üf++) {

136 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
sub_blkaddr
,

137 
addr
 | 
lf
 << 
addr_off
);

138 i‡(((
ªg
 >> 
shi·
Ë& 0xFFFFulË!
pcifunc
)

141 
ªg
 &~(0xFFFFu»<< 
shi·
);

142 
	`rvu_wrôe64
(
rvu
, 
sub_blkaddr
, 
addr
 | 
lf
 << 
addr_off
,

143 
ªg
);

144 (*
lf_¨r
)[
lf_˙t
] = 
lf
;

145 
lf_˙t
++;

149  
lf_˙t
;

150 
	}
}

152 
	$rvu_sso_ggΩ_èq_Êush
(
rvu
 *rvu, 
u16
 
pcifunc
, 
lf
,

153 
¶Ÿ
, 
ssow_lf
, 
u64
 
blkaddr
,

154 
u64
 
ssow_blkaddr
)

156 
nix_lf_˙t
, 
˝t_lf_˙t
, 
tim_lf_˙t
;

157 *
nix_lf
, *
˝t_lf
, *
tim_lf
;

158 
u64
 
ªg
, 
vÆ
;

161 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_QCTL
),

165 
nix_lf
 = 
NULL
;

166 
nix_lf_˙t
 = 
	`rvu_sso_dißbÀ_aw_§c
(
rvu
, &
nix_lf
,

167 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
,

168 
pcifunc
),

169 
NIX_AF_LF_SSO_PF_FUNC_SHIFT
,

170 
NIX_AF_LF_CFG_SHIFT
, 
pcifunc
,

171 
	`NIX_AF_LFX_CFG
(0));

173 
˝t_lf
 = 
NULL
;

174 
˝t_lf_˙t
 = 
	`rvu_sso_dißbÀ_aw_§c
(
rvu
, &
˝t_lf
,

175 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_CPT
,

177 
CPT_AF_LF_SSO_PF_FUNC_SHIFT
,

178 
CPT_AF_LF_CTL2_SHIFT
, 
pcifunc
,

179 
	`CPT_AF_LFX_CTL2
(0));

181 
tim_lf
 = 
NULL
;

182 
tim_lf_˙t
 = 
	`rvu_sso_dißbÀ_aw_§c
(
rvu
, &
tim_lf
,

183 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
,

185 
TIM_AF_RING_SSO_PF_FUNC_SHIFT
,

186 
TIM_AF_RING_GMCTL_SHIFT
, 
pcifunc
,

187 
	`TIM_AF_RINGX_GMCTL
(0));

192 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_QCTL
),

196 
	`mb
();

197 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

198 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_GWC_INVAL
), 0x0);

201 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
ssow_blkaddr
,

202 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_TAG
));

203 } 
ªg
 & 
	`BIT_ULL
(63));

205 i‡(
ªg
 & 
	`BIT_ULL
(62))

206 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

207 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_DESCHED
),

209 i‡(((
ªg
 >> 32Ë& 
SSO_TT_EMPTY
) != SSO_TT_EMPTY)

210 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

211 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_SWTAG_FLUSH
),

214 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

215 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_GWC_INVAL
), 0x0);

217 
vÆ
 = 
¶Ÿ
;

218 
vÆ
 |
	`BIT_ULL
(18);

219 
vÆ
 |
	`BIT_ULL
(16);

221 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TAQ_THR
(
lf
));

222 (
ªg
 >> 48) & 0x7FF) {

223 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

224 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_OP_ADD_WORK1
),

226 
gë_w‹k
:

227 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

228 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_GET_WORK
),

229 
vÆ
);

231 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
ssow_blkaddr
,

232 
	`SSOW_AF_BAR2_ALIASX
(0,

233 
SSOW_LF_GWS_TAG
));

234 } 
ªg
 & 
	`BIT_ULL
(63));

236 i‡(!
	`rvu_ªad64
(
rvu
, 
ssow_blkaddr
,

237 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_WQP
)))

238 
gë_w‹k
;

240 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TAQ_THR
(
lf
));

243 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
ssow_blkaddr
,

244 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_TAG
));

245 i‡(((
ªg
 >> 32Ë& 
SSO_TT_EMPTY
) != SSO_TT_EMPTY)

246 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

247 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_SWTAG_FLUSH
),

251 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_QCTL
),

255 
	`rvu_sso_íabÀ_aw_§c
(
rvu
, 
nix_lf_˙t
, 
	`rvu_gë_blkaddr
‘vu, 
BLKTYPE_NIX
,

256 
pcifunc
),

257 
	`NIX_AF_LFX_CFG
(0), 
nix_lf
, 
pcifunc
,

258 
NIX_AF_LF_SSO_PF_FUNC_SHIFT
,

259 
NIX_AF_LF_CFG_SHIFT
);

260 
	`rvu_sso_íabÀ_aw_§c
(
rvu
, 
˝t_lf_˙t
, 
	`rvu_gë_blkaddr
‘vu, 
BLKTYPE_CPT
,

262 
	`CPT_AF_LFX_CTL2
(0), 
˝t_lf
, 
pcifunc
,

263 
CPT_AF_LF_SSO_PF_FUNC_SHIFT
,

264 
CPT_AF_LF_CTL2_SHIFT
);

265 
	`rvu_sso_íabÀ_aw_§c
(
rvu
, 
tim_lf_˙t
, 
	`rvu_gë_blkaddr
‘vu, 
BLKTYPE_TIM
,

267 
	`TIM_AF_RINGX_GMCTL
(0), 
tim_lf
, 
pcifunc
,

268 
TIM_AF_RING_SSO_PF_FUNC_SHIFT
,

269 
TIM_AF_RING_GMCTL_SHIFT
);

271 
	`k‰ì
(
nix_lf
);

272 
	`k‰ì
(
˝t_lf
);

273 
	`k‰ì
(
tim_lf
);

274 
	}
}

276 
	$rvu_sso_˛ón_nscheduÀd
(
rvu
 *rvu, 
lf
)

278 
sso_r§c
 *
sso
 = &
rvu
->
hw
->sso;

279 
blkaddr
, 
ssow_blkaddr
, 
iue
;

280 
u64
 
wqp
, 
ªg
, 
›_˛r_nsched
;

282 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

283 
ssow_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 0);

284 
›_˛r_nsched
 = (
ssow_blkaddr
 << 28) |

285 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_CLR_NSCHED0
);

286 
iue
 = 0; iuê< 
sso
->
sso_iue
; iue++) {

287 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_GRP
(
iue
));

288 i‡(
	`SSO_AF_HWGRPX_IUEX_NOSCHED
(
lf
, 
ªg
)) {

289 
wqp
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IENTX_WQP
(
iue
));

290 
	`rvu_sso_°‹e_∑ú
(
wqp
, 
iue
,

291 
rvu
->
a‰eg_ba£
 + 
›_˛r_nsched
);

294 
	}
}

296 
	$rvu_ssow_˛ón_¥e„tch
(
rvu
 *rvu, 
u16
 
pcifunc
, 
¶Ÿ
)

298 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

299 
ssow_blkaddr
, 
blkaddr
, 
îr
;

300 
u64
 
vÆ
, 
ªg
;

301 
u16
 
ssow_lf
;

303 
ssow_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 0);

304 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

306 
ssow_lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
ssow_blkaddr
], 
pcifunc
, 
¶Ÿ
);

309 
	`mb
();

310 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssow_lf
), 0x1);

311 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssow_lf
), 0x2, 
åue
);

313 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
ssow_blkaddr
,

314 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSOW_LF_GWS_PRF_TAG
),

315 
SSOW_LF_GWS_TAG_PEND_GET_WORK
, 
åue
);

316 i‡(
îr
)

317 
	`dev_w¨n
(
rvu
->
dev
,

320 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
ssow_blkaddr
,

321 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSOW_LF_GWS_PRF_TAG
));

322 i‡(((
ªg
 >> 32Ë& 
SSO_TT_EMPTY
) != SSO_TT_EMPTY) {

323 
vÆ
 = 0x0;

324 
vÆ
 |
SSOW_LF_GWS_OP_GET_WORK_WAIT
;

325 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

326 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSOW_LF_GWS_OP_GET_WORK
),

327 
vÆ
);

328 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
ssow_blkaddr
,

329 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
,

330 
SSOW_LF_GWS_TAG
),

331 
SSOW_LF_GWS_TAG_PEND_GET_WORK
, 
åue
);

332 i‡(
îr
)

333 
	`dev_w¨n
(
rvu
->
dev
,

336 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

337 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
,

338 
SSOW_LF_GWS_OP_SWTAG_FLUSH
),

341 
	}
}

343 
	$rvu_sso_lf_døö_queues
(
rvu
 *rvu, 
u16
 
pcifunc
, 
lf
, 
¶Ÿ
)

345 
boﬁ
 
has_¥e„tch
, 
has_nsched
, 
has_lsw
;

346 
ssow_lf
, 
blkaddr
, 
ssow_blkaddr
;

347 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

348 
u64
 
aq_˙t
, 
ds_˙t
, 
cq_ds_˙t
;

349 
u64
 
ªg
, 
vÆ
, 
ªåy
;

351 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

352 i‡(
blkaddr
 < 0)

353  -
ENODEV
;

356 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_CONST1
);

357 
has_lsw
 = !!(
ªg
 & 
SSO_AF_CONST1_LSW_PRESENT
);

358 
has_nsched
 = !!!(
ªg
 & 
SSO_AF_CONST1_NO_NSCHED
);

359 
has_¥e„tch
 = !!(
ªg
 & 
SSO_AF_CONST1_PRF_PRESENT
);

361 
ssow_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 0);

362 i‡(
ssow_blkaddr
 < 0)

363  -
ENODEV
;

365 
ssow_lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
ssow_blkaddr
], 
pcifunc
, 0);

366 i‡(
ssow_lf
 < 0)

367  -
ENODEV
;

369 
	`muãx_lock
(&
rvu
->
Æüs_lock
);

371 
ªg
 = 
	`BIT_ULL
(16Ë| 
pcifunc
;

372 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_BAR2_SEL
, 
ªg
);

373 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
ssow_blkaddr
, 
SSOW_AF_BAR2_SEL
, 
ªg
);

376 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

377 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_INT_ENA_W1C
),

378 
SSOW_LF_GWS_INT_MASK
);

379 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

380 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_INT
),

381 
SSOW_LF_GWS_INT_MASK
);

383 i‡(
has_lsw
)

384 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_LSW_CFG
(
ssow_lf
), 0x0);

387 
	`mb
();

388 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssow_lf
), 0x1);

389 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssow_lf
), 0x2, 
åue
);

392 
	`rvu_pﬁl_ªg
(
rvu
, 
ssow_blkaddr
, 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_TAG
),

393 
SSOW_LF_GWS_TAG_PEND_GET_WORK
, 
åue
);

395 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
ssow_blkaddr
,

396 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_TAG
));

397 i‡(
ªg
 & 
SSOW_LF_GWS_TAG_PEND_SWITCH
)

398 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

399 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_DESCHED
), 0);

400 i‡(((
ªg
 >> 32Ë& 
SSO_TT_EMPTY
) != SSO_TT_EMPTY)

401 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

402 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_SWTAG_FLUSH
),

405 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssow_lf
), 0x1);

406 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssow_lf
), 0x2, 
åue
);

407 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

408 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_NW_TIM
),

409 
SSOW_LF_GWS_MAX_NW_TIM
);

411 i‡(
has_¥e„tch
)

412 
	`rvu_ssow_˛ón_¥e„tch
(
rvu
, 
pcifunc
, 0);

415 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_QCTL
),

420 i‡(
has_nsched
)

421 
	`rvu_sso_˛ón_nscheduÀd
(
rvu
, 
lf
);

425 
aq_˙t
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

426 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_AQ_CNT
));

427 
ds_˙t
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

428 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_MISC_CNT
));

429 
cq_ds_˙t
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

430 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_INT_CNT
));

431 
cq_ds_˙t
 &
SSO_LF_GGRP_INT_CNT_MASK
;

433 
vÆ
 = 
¶Ÿ
;

434 
vÆ
 |
SSOW_LF_GWS_OP_GET_WORK_GROUPED
;

435 
vÆ
 |
SSOW_LF_GWS_OP_GET_WORK_WAIT
;

437 
ªåy
 = 
SSO_FLUSH_RETRY_MAX
;

438 
aq_˙t
 || 
cq_ds_˙t
 || 
ds_˙t
) {

439 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

440 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_OP_GET_WORK
),

441 
vÆ
);

443 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
ssow_blkaddr
,

444 
	`SSOW_AF_BAR2_ALIASX
(0,

445 
SSOW_LF_GWS_TAG
));

446 } 
ªg
 & 
SSOW_LF_GWS_TAG_PEND_GET_WORK
);

447 i‡(((
ªg
 >> 32Ë& 
SSO_TT_EMPTY
) != SSO_TT_EMPTY)

448 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

449 
	`SSOW_AF_BAR2_ALIASX
(0,

450 
SSOW_LF_GWS_OP_SWTAG_FLUSH
),

452 i‡(
ªåy
-- == 0)

454 
aq_˙t
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

455 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_AQ_CNT
)

457 
ds_˙t
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

458 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
,

459 
SSO_LF_GGRP_MISC_CNT
));

460 
cq_ds_˙t
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

461 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
,

462 
SSO_LF_GGRP_INT_CNT
));

464 
cq_ds_˙t
 &
SSO_LF_GGRP_INT_CNT_MASK
;

467 i‡(
aq_˙t
 || 
cq_ds_˙t
 || 
ds_˙t
) {

468 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_BAR2_SEL
, 0);

469 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
ssow_blkaddr
, 
SSOW_AF_BAR2_SEL
, 0);

471 
	`muãx_u∆ock
(&
rvu
->
Æüs_lock
);

472  -
EAGAIN
;

479 i‡(
	`is_rvu_96xx_B0
(
rvu
))

480 
	`rvu_sso_ggΩ_èq_Êush
(
rvu
, 
pcifunc
, 
lf
, 
¶Ÿ
, 
ssow_lf
, 
blkaddr
,

481 
ssow_blkaddr
);

483 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

484 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_NW_TIM
), 0x0);

487 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

488 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_XAQ_CNT
))

489 & 
SSO_LF_GGRP_XAQ_CNT_MASK
;

490 i‡(
ªg
 != 0)

491 
	`dev_w¨n
(
rvu
->
dev
,

492 "SSO_LF[%d]_GGRP_XAQ_CNT i†%ŒdÉx≥˘ed 0", 
lf
, 
ªg
);

494 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_PAGE_CNT
(
lf
))

495 & 
SSO_AF_HWGRP_PAGE_CNT_MASK
;

496 i‡(
ªg
 != 0)

497 
	`dev_w¨n
(
rvu
->
dev
,

498 "SSO_AF_HWGRP[%d]_PAGE_CNT i†%ŒdÉx≥˘ed 0", 
lf
,

499 
ªg
);

501 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_IAQ_THR
(
lf
))

502 >> 
SSO_HWGRP_IAQ_GRP_CNT_SHIFT
;

503 
ªg
 &
SSO_HWGRP_IAQ_GRP_CNT_MASK
;

504 i‡(
ªg
 != 0)

505 
	`dev_w¨n
(
rvu
->
dev
,

506 "SSO_AF_HWGRP[%d]_IAQ_THR i†%ŒdÉx≥˘ed 0", 
lf
,

507 
ªg
);

508 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssow_lf
), 0x1);

509 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssow_lf
), 0x2, 
åue
);

511 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_BAR2_SEL
, 0);

512 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
ssow_blkaddr
, 
SSOW_AF_BAR2_SEL
, 0);

514 
	`muãx_u∆ock
(&
rvu
->
Æüs_lock
);

517 
	}
}

519 
boﬁ
 
	$˙10k_xaq_auø_ac˚ss_îøè
(
rvu
 *rvu)

521 i‡(
	`is_˙10ka_a0
(
rvu
Ë|| 
	`is_˙10ka_a1
‘vuË|| 
	`is_˙10kb_a0
(rvu) ||

522 
	`is_˙10kb_a1
(
rvu
Ë|| 
	`is_˙f10kb_a0
(rvu))

523  
åue
;

524  
Ál£
;

525 
	}
}

527 
	$rvu_sso_xaq_auø_wrôe
(
rvu
 *rvu, 
lf
, 
u64
 
vÆ
)

529 
blkaddr
;

530 
u64
 
ªg
;

532 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

533 i‡(
blkaddr
 < 0)

536 i‡(
	`˙10k_xaq_auø_ac˚ss_îøè
(
rvu
)) {

537 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_BP_TEST
(0));

539 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_BP_TEST
(0),

540 (
ªg
 | 
	`BIT_ULL
(62)Ë& ~
SSO_AF_BP_TEST_CFG3_MASK
);

541 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_BP_TEST
(0));

542 
	`dsb
(
sy
);

543 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_XAQ_AURA
(
lf
), 
vÆ
);

544 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_BP_TEST
(0),

545 
ªg
 & ~
	`BIT_ULL
(62));

547 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_XAQ_AURA
(
lf
), 
vÆ
);

549 
	}
}

551 
	$rvu_sso_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
lf
, 
¶Ÿ
)

553 
boﬁ
 
has_lsw
, 
has_°ash
;

554 
u64
 
ªg
, 
add
;

555 
blkaddr
;

557 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

558 i‡(
blkaddr
 < 0)

559  
SSO_AF_ERR_LF_INVALID
;

562 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_CONST1
);

563 
has_lsw
 = !!(
ªg
 & 
SSO_AF_CONST1_LSW_PRESENT
);

564 
has_°ash
 = !!(
ªg
 & 
SSO_AF_CONST1_STASH_PRESENT
);

566 
	`muãx_lock
(&
rvu
->
Æüs_lock
);

568 
ªg
 = 
	`BIT_ULL
(16Ë| 
pcifunc
;

569 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_BAR2_SEL
, 
ªg
);

571 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

572 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_INT_THR
), 0x0);

573 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

574 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_AQ_THR
),

575 
SSO_LF_GGRP_AQ_THR_MASK
);

577 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

578 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_INT
),

579 
SSO_LF_GGRP_INT_MASK
);

580 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

581 
	`SSO_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSO_LF_GGRP_INT_ENA_W1C
),

582 
SSO_LF_GGRP_INT_MASK
);

584 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_BAR2_SEL
, 0x0);

585 
	`muãx_u∆ock
(&
rvu
->
Æüs_lock
);

587 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_UNMAP_INFO
);

588 i‡((
ªg
 & 0xFFFË=
pcifunc
)

589 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR0
, 
SSO_AF_ERR0_MASK
);

591 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_UNMAP_INFO2
);

592 i‡((
ªg
 & 0xFFFË=
pcifunc
)

593 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR2
, 
SSO_AF_ERR2_MASK
);

595 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_UNMAP_INFO3
);

596 i‡((
ªg
 & 0xFFFË=
pcifunc
)

597 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR2
, 
SSO_AF_ERR2_MASK
);

599 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_POISONX
(
lf
 / 64),Üf % 64);

600 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IU_ACCNTX_RST
(
lf
), 0x1);

602 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR0
, ~0ULL);

604 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR0_ENA_W1S
, ~0ULL);

607 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
), 0x0);

608 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_CFG
(
lf
),

609 
SSO_HWGRP_AW_CFG_LDWB
 | 
SSO_HWGRP_AW_CFG_LDT
 |

610 
SSO_HWGRP_AW_CFG_STT
);

611 
	`rvu_sso_xaq_auø_wrôe
(
rvu
, 
lf
, 0);

612 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_GMCTL
(
lf
), 0x0);

613 
ªg
 = (
SSO_HWGRP_PRI_AFF_MASK
 << 
SSO_HWGRP_PRI_AFF_SHIFT
) |

614 (
SSO_HWGRP_PRI_WGT_MASK
 << 
SSO_HWGRP_PRI_WGT_SHIFT
) |

615 (0x1 << 
SSO_HWGRP_PRI_WGT_SHIFT
);

616 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_PRI
(
lf
), 
ªg
);

617 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_WS_PC
(
lf
), 0x0);

618 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_EXT_PC
(
lf
), 0x0);

619 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_WA_PC
(
lf
), 0x0);

620 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TS_PC
(
lf
), 0x0);

621 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_DS_PC
(
lf
), 0x0);

622 i‡(
has_lsw
)

623 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_LS_PC
(
lf
), 0x0);

624 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_XAQ_LIMIT
(
lf
), 0x0);

625 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_IU_ACCNT
(
lf
), 0x0);

626 i‡(
has_°ash
)

627 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_STASH
(
lf
), 0x0);

632 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_IAQ_THR
(
lf
)) &

633 
SSO_HWGRP_IAQ_RSVD_THR_MASK
;

634 
add
 = 
SSO_HWGRP_IAQ_RSVD_THR
 - 
ªg
;

635 
ªg
 = (
SSO_HWGRP_IAQ_MAX_THR_MASK
 << 
SSO_HWGRP_IAQ_MAX_THR_SHIFT
) |

636 
SSO_HWGRP_IAQ_RSVD_THR
;

637 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_IAQ_THR
(
lf
), 
ªg
);

639 i‡(
add
)

640 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_AW_ADD
,

641 (
add
 & 
SSO_AF_AW_ADD_RSVD_FREE_MASK
) <<

642 
SSO_AF_AW_ADD_RSVD_FREE_SHIFT
);

644 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TAQ_THR
(
lf
)) &

645 
SSO_HWGRP_TAQ_RSVD_THR_MASK
;

646 
add
 = 
SSO_HWGRP_TAQ_RSVD_THR
 - 
ªg
;

647 
ªg
 = (
SSO_HWGRP_TAQ_MAX_THR_MASK
 << 
SSO_HWGRP_TAQ_MAX_THR_SHIFT
) |

648 
SSO_HWGRP_TAQ_RSVD_THR
;

649 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TAQ_THR
(
lf
), 
ªg
);

650 i‡(
add
)

651 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_TAQ_ADD
,

652 (
add
 & 
SSO_AF_TAQ_RSVD_FREE_MASK
) <<

653 
SSO_AF_TAQ_ADD_RSVD_FREE_SHIFT
);

655 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_HEAD_PTR
(
lf
), 0x0);

656 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_TAIL_PTR
(
lf
), 0x0);

657 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_HEAD_NEXT
(
lf
), 0x0);

658 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_TAIL_NEXT
(
lf
), 0x0);

661 
	}
}

663 
	$rvu_ssow_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
lf
, 
¶Ÿ
)

665 
sso_r§c
 *
sso
 = &
rvu
->
hw
->sso;

666 
boﬁ
 
has_¥e„tch
, 
has_lsw
;

667 
blkaddr
, 
ssow_blkaddr
;

668 
u64
 
ªg
, 
gΩmsk
;

670 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

671 i‡(
blkaddr
 < 0)

672  
SSOW_AF_ERR_LF_INVALID
;

674 
ssow_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 0);

675 i‡(
ssow_blkaddr
 < 0)

676  
SSOW_AF_ERR_LF_INVALID
;

679 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_CONST1
);

680 
has_lsw
 = !!(
ªg
 & 
SSO_AF_CONST1_LSW_PRESENT
);

681 
has_¥e„tch
 = !!(
ªg
 & 
SSO_AF_CONST1_PRF_PRESENT
);

683 
	`muãx_lock
(&
rvu
->
Æüs_lock
);

685 
ªg
 = 
	`BIT_ULL
(16Ë| 
pcifunc
;

686 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
ssow_blkaddr
, 
SSOW_AF_BAR2_SEL
, 
ªg
);

689 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

690 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_INT_ENA_W1C
),

691 
SSOW_LF_GWS_INT_MASK
);

692 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

693 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_INT
),

694 
SSOW_LF_GWS_INT_MASK
);

696 i‡(
has_lsw
)

697 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_LSW_CFG
(
lf
), 0x0);

700 
	`mb
();

701 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
lf
), 0x1);

702 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
lf
), 0x2, 
åue
);

705 
	`rvu_pﬁl_ªg
(
rvu
, 
ssow_blkaddr
,

706 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSOW_LF_GWS_PENDSTATE
),

707 
SSOW_LF_GWS_TAG_PEND_GET_WORK
 |

708 
SSOW_LF_GWS_TAG_PEND_DESCHED
, 
åue
);

710 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
ssow_blkaddr
,

711 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSOW_LF_GWS_TAG
));

713 i‡(
ªg
 & 
SSOW_LF_GWS_TAG_PEND_SWITCH
)

714 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

715 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSOW_LF_GWS_OP_DESCHED
),

718 i‡(((
ªg
 >> 32Ë& 
SSO_TT_EMPTY
) != SSO_TT_EMPTY)

719 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

720 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
,

721 
SSOW_LF_GWS_OP_SWTAG_FLUSH
),

725 
	`rvu_pﬁl_ªg
(
rvu
, 
ssow_blkaddr
,

726 
	`SSOW_AF_BAR2_ALIASX
(
¶Ÿ
, 
SSOW_LF_GWS_PENDSTATE
),

727 
SSOW_LF_GWS_TAG_PEND_DESCHED
, 
åue
);

729 i‡(
has_¥e„tch
)

730 
	`rvu_ssow_˛ón_¥e„tch
(
rvu
, 
pcifunc
, 
¶Ÿ
);

732 
	`rvu_wrôe64
(
rvu
, 
ssow_blkaddr
,

733 
	`SSOW_AF_BAR2_ALIASX
(0, 
SSOW_LF_GWS_NW_TIM
), 0x0);

736 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
lf
), 0x1);

737 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
lf
), 0x2, 
åue
);

738 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_ARB
(
lf
), 0x0);

739 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_GMCTL
(
lf
), 0x0);

742 
gΩmsk
 = 0; gΩmsk < (
sso
->
sso_hwgΩs
 / 64); grpmsk++) {

743 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

744 
	`SSO_AF_HWSX_SX_GRPMSKX
(
lf
, 0, 
gΩmsk
),

746 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

747 
	`SSO_AF_HWSX_SX_GRPMSKX
(
lf
, 1, 
gΩmsk
),

751 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
ssow_blkaddr
, 
SSOW_AF_BAR2_SEL
, 0x0);

752 
	`muãx_u∆ock
(&
rvu
->
Æüs_lock
);

755 
	}
}

757 
	$rvu_sso_pﬁl_auø_˙t
(
rvu
 *rvu, 
≈a_blkaddr
, 
auø
)

759 
timeout
 = 
jiffõs
 + 
	`u£cs_to_jiffõs
(20000);

760 
boﬁ
 
twi˚
 = 
Ál£
;

761 
u64
 
__iomem
 *
addr
;

762 
u64
 
ªs
, 
wd©a
;

764 
wd©a
 = (
u64
)
auø
 << 44;

765 
addr
 = 
rvu
->
a‰eg_ba£
 + ((
≈a_blkaddr
 << 28) |

766 
	`NPA_AF_BAR2_ALIASX
(0, 
NPA_LF_AURA_OP_CNT
));

767 
agaö
:

768 
	`rvu_sso_ldadd
(
ªs
, 
wd©a
, 
addr
);

769 i‡(
ªs
 & 
	`BIT_ULL
(42))

771 i‡(!(
ªs
 & 0xFFFFFFFFF))

773 i‡(
	`time_bef‹e
(
jiffõs
, 
timeout
)) {

774 
	`u¶ìp_ønge
(1, 5);

775 
agaö
;

782 i‡(!
twi˚
) {

783 
twi˚
 = 
åue
;

784 
agaö
;

786  -
EBUSY
;

787 
	}
}

789 
	$rvu_sso_deöô_xaq_auø
(
rvu
 *rvu, 
blkaddr
, 
≈a_blkaddr
,

790 
auø
, 
lf
)

792 *
‰ì_addr
;

793 
u64
 
ªg
;

795 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_CONST1
);

796 
‰ì_addr
 = 
rvu
->
a‰eg_ba£
 + ((
≈a_blkaddr
 << 28) |

797 
	`NPA_AF_BAR2_ALIASX
(0, 
NPA_LF_AURA_OP_FREE0
));

798 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_CFG
(
lf
));

799 
ªg
 &~
SSO_HWGRP_AW_CFG_RWEN
;

800 
ªg
 |
SSO_HWGRP_AW_CFG_XAQ_ALLOC_DIS
;

801 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_CFG
(
lf
), 
ªg
);

803 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
),

804 
SSO_HWGRP_AW_STS_XAQ_BUFSC_MASK
, 
åue
);

805 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
),

806 
SSO_HWGRP_AW_STS_NPA_FETCH
, 
åue
);

808 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
));

809 i‡(
ªg
 & 
SSO_HWGRP_AW_STS_TPTR_NEXT_VLD
) {

810 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_TAIL_NEXT
(
lf
));

811 
ªg
 &= ~0x7F;

812 i‡(
≈a_blkaddr
 && 
ªg
)

813 
	`rvu_sso_°‹e_∑ú
(
ªg
, (
u64
)
auø
, 
‰ì_addr
);

815 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
),

816 
SSO_HWGRP_AW_STS_TPTR_NEXT_VLD
);

818 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_TAIL_NEXT
(
lf
), 0x0);

820 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
));

821 i‡(
ªg
 & 
SSO_HWGRP_AW_STS_TPTR_VLD
) {

822 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_TAIL_PTR
(
lf
));

823 
ªg
 &= ~0x7F;

824 i‡(
≈a_blkaddr
 && 
ªg
)

825 
	`rvu_sso_°‹e_∑ú
(
ªg
, (
u64
)
auø
, 
‰ì_addr
);

827 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
),

828 
SSO_HWGRP_AW_STS_TPTR_VLD
);

830 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_TAIL_PTR
(
lf
), 0x0);

832 
	}
}

834 
	$rvu_sso_˛ónup_xaq_auø
(
rvu
 *rvu, 
u16
 
pcifunc
, 
nb_hwgΩs
)

836 
hwgΩ
, 
lf
, 
blkaddr
, 
≈a_blkaddr
, 
≈a_pcifunc
, 
auø
, 
îr
;

837 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

838 
u64
 
ªg
;

840 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

841 i‡(
blkaddr
 < 0)

842  
SSO_AF_ERR_LF_INVALID
;

844 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 0);

845 i‡(
lf
 < 0)

846  
SSO_AF_ERR_LF_INVALID
;

848 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_GMCTL
(
lf
));

849 
≈a_pcifunc
 = 
ªg
 & 0xFFFF;

850 
≈a_blkaddr
 = 0;

852 i‡(
≈a_pcifunc
) {

853 
≈a_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NPA
, 
≈a_pcifunc
);

854 i‡(
blkaddr
 < 0)

855  
SSO_AF_INVAL_NPA_PF_FUNC
;

857 
	`muãx_lock
(&
rvu
->
Æüs_lock
);

858 
ªg
 = 
	`BIT_ULL
(16Ë| 
≈a_pcifunc
;

859 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
≈a_blkaddr
, 
NPA_AF_BAR2_SEL
, 
ªg
);

860 
auø
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_XAQ_AURA
(
lf
));

863 
hwgΩ
 = 0; hwgΩ < 
nb_hwgΩs
; hwgrp++) {

864 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
hwgΩ
);

865 i‡(
lf
 < 0) {

866 
îr
 = 
SSO_AF_ERR_LF_INVALID
;

867 
Áû
;

870 
	`rvu_sso_deöô_xaq_auø
(
rvu
, 
blkaddr
, 
≈a_blkaddr
, 
auø
, 
lf
);

872 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_CFG
(
lf
),

873 
SSO_HWGRP_AW_CFG_LDWB
 | 
SSO_HWGRP_AW_CFG_LDT
 |

874 
SSO_HWGRP_AW_CFG_STT
);

877 i‡(
≈a_pcifunc
) {

878 
îr
 = 
	`rvu_sso_pﬁl_auø_˙t
(
rvu
, 
≈a_blkaddr
, 
auø
);

879 i‡(
îr
)

880 
	`dev_îr
(
rvu
->
dev
, "[%d]FailedÅo free XAQsÅoáura[%d]\n",

881 
__LINE__
, 
auø
);

884 
hwgΩ
 = 0; hwgΩ < 
nb_hwgΩs
; hwgrp++) {

885 
	`rvu_sso_xaq_auø_wrôe
(
rvu
, 
lf
, 0);

886 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_GMCTL
(
lf
), 0);

888 
îr
 = 0;

889 
Áû
:

890 i‡(
≈a_pcifunc
) {

891 
	`rvu_b¨2_£l_wrôe64
(
rvu
, 
≈a_blkaddr
, 
NPA_AF_BAR2_SEL
, 0x0);

892 
	`muãx_u∆ock
(&
rvu
->
Æüs_lock
);

895  
îr
;

896 
	}
}

898 
	$rvu_mbox_h™dÀr_sso_hw_ªÀa£_xaq_auø
(
rvu
 *rvu,

899 
sso_ªÀa£_xaq
 *
ªq
,

900 
msg_r•
 *
r•
)

902 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

904  
	`rvu_sso_˛ónup_xaq_auø
(
rvu
, 
pcifunc
, 
ªq
->
hwgΩs
);

905 
	}
}

907 
	$rvu_mbox_h™dÀr_sso_hw_£tc⁄fig
(
rvu
 *rvu,

908 
sso_hw_£tc⁄fig
 *
ªq
,

909 
msg_r•
 *
r•
)

911 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

912 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

913 
hwgΩ
, 
lf
, 
îr
, 
blkaddr
;

914 
u32
 
≈a_auø_id
;

915 
u64
 
ªg
;

917 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

918 i‡(
blkaddr
 < 0)

919  
SSO_AF_ERR_LF_INVALID
;

921 
≈a_auø_id
 = 
ªq
->npa_aura_id;

924 i‡(
ªq
->
≈a_pf_func
) {

926 i‡(
ªq
->
≈a_pf_func
 =
RVU_DEFAULT_PF_FUNC
)

927 
ªq
->
≈a_pf_func
 = 
pcifunc
;

928 i‡(!
	`is_pffunc_m≠_vÆid
(
rvu
, 
ªq
->
≈a_pf_func
, 
BLKTYPE_NPA
))

929  
SSO_AF_INVAL_NPA_PF_FUNC
;

932 
îr
 = 
	`rvu_sso_˛ónup_xaq_auø
(
rvu
, 
pcifunc
, 
ªq
->
hwgΩs
);

933 i‡(
îr
 < 0)

934  
îr
;

937 
hwgΩ
 = 0; hwgΩ < 
ªq
->
hwgΩs
; hwgrp++) {

938 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
hwgΩ
);

939 i‡(
lf
 < 0)

940  
SSO_AF_ERR_LF_INVALID
;

942 
	`rvu_sso_xaq_auø_wrôe
(
rvu
, 
lf
, 
≈a_auø_id
);

943 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_XAQX_GMCTL
(
lf
),

944 
ªq
->
≈a_pf_func
);

947 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_CFG
(
lf
), 0xF);

950 
îr
 = 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
,

951 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
),

952 
SSO_HWGRP_AW_STS_INIT_STS
, 
Ál£
);

954 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
));

955 i‡(
îr
 || (
ªg
 & 
	`BIT_ULL
(4)) || !(reg & BIT_ULL(8))) {

956 
	`dev_w¨n
(
rvu
->
dev
, "SSO_HWGRP(%d) XAQ NPAÖointer initialization failed",

957 
lf
);

958  -
ENOMEM
;

963 
	}
}

965 
	$rvu_mbox_h™dÀr_sso_gΩ_£t_¥i‹ôy
(
rvu
 *rvu,

966 
sso_gΩ_¥i‹ôy
 *
ªq
,

967 
msg_r•
 *
r•
)

969 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

970 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

971 
lf
, 
blkaddr
;

972 
u64
 
ªgvÆ
;

974 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

975 i‡(
blkaddr
 < 0)

976  
SSO_AF_ERR_LF_INVALID
;

978 
ªgvÆ
 = (((
u64
)(
ªq
->
weight
 & 
SSO_HWGRP_PRI_WGT_MASK
)

979 << 
SSO_HWGRP_PRI_WGT_SHIFT
) |

980 ((
u64
)(
ªq
->
afföôy
 & 
SSO_HWGRP_PRI_AFF_MASK
)

981 << 
SSO_HWGRP_PRI_AFF_SHIFT
) |

982 (
ªq
->
¥i‹ôy
 & 
SSO_HWGRP_PRI_MASK
));

984 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
gΩ
);

985 i‡(
lf
 < 0)

986  
SSO_AF_ERR_LF_INVALID
;

988 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_PRI
(
lf
), 
ªgvÆ
);

991 
	}
}

993 
	$rvu_mbox_h™dÀr_sso_gΩ_gë_¥i‹ôy
(
rvu
 *rvu,

994 
sso_öfo_ªq
 *
ªq
,

995 
sso_gΩ_¥i‹ôy
 *
r•
)

997 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

998 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

999 
lf
, 
blkaddr
;

1000 
u64
 
ªgvÆ
;

1002 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1003 i‡(
blkaddr
 < 0)

1004  
SSO_AF_ERR_LF_INVALID
;

1006 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
gΩ
);

1007 i‡(
lf
 < 0)

1008  
SSO_AF_ERR_LF_INVALID
;

1010 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_PRI
(
lf
));

1012 
r•
->
weight
 = (
ªgvÆ
 >> 
SSO_HWGRP_PRI_WGT_SHIFT
)

1013 & 
SSO_HWGRP_PRI_WGT_MASK
;

1014 
r•
->
afföôy
 = (
ªgvÆ
 >> 
SSO_HWGRP_PRI_AFF_SHIFT
)

1015 & 
SSO_HWGRP_PRI_AFF_MASK
;

1016 
r•
->
¥i‹ôy
 = 
ªgvÆ
 & 
SSO_HWGRP_PRI_MASK
;

1019 
	}
}

1021 
	$rvu_mbox_h™dÀr_sso_gΩ_qos_c⁄fig
(
rvu
 *rvu,

1022 
sso_gΩ_qos_cfg
 *
ªq
,

1023 
msg_r•
 *
r•
)

1025 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1026 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1027 
sso_aq_thr
 
aq_thr
;

1028 
u64
 
ªgvÆ
, 
gΩ_rsvd
;

1029 
lf
, 
blkaddr
;

1031 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1032 i‡(
blkaddr
 < 0)

1033  
SSO_AF_ERR_LF_INVALID
;

1035 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
gΩ
);

1036 i‡(
lf
 < 0)

1037  
SSO_AF_ERR_LF_INVALID
;

1040 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_WA_PC
(
lf
));

1041 i‡(
ªgvÆ
)

1042  
SSO_AF_ERR_GRP_EBUSY
;

1045 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TAQ_THR
(
lf
));

1046 
gΩ_rsvd
 = 
ªgvÆ
 & 
SSO_HWGRP_TAQ_RSVD_THR_MASK
;

1047 i‡(
ªq
->
èq_thr
 < 
gΩ_rsvd
) {

1048 
ªq
->
èq_thr
 = 
	`max_t
(
u16
,Ñeq->èq_thr, 
SSO_HWGRP_TAQ_RSVD_THR
);

1049 
gΩ_rsvd
 = 
ªq
->
èq_thr
;

1051 
aq_thr
.
èq_max
 = 
ªq
->
èq_thr
;

1052 
aq_thr
.
èq_rsvd
 = 
gΩ_rsvd
;

1055 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_IAQ_THR
(
lf
));

1056 
gΩ_rsvd
 = 
ªgvÆ
 & 
SSO_HWGRP_IAQ_RSVD_THR_MASK
;

1057 i‡(
ªq
->
üq_thr
 < 
gΩ_rsvd
 + 4) {

1058 
ªq
->
üq_thr
 =

1059 
	`max_t
(
u16
, 
ªq
->
üq_thr
, 
SSO_HWGRP_IAQ_RSVD_THR
 + 4);

1060 
gΩ_rsvd
 = 
ªq
->
üq_thr
 - 4;

1062 
aq_thr
.
üq_max
 = 
ªq
->
üq_thr
;

1063 
aq_thr
.
üq_rsvd
 = 
gΩ_rsvd
;

1066 
	`rvu_sso_hwgΩ_c⁄fig_thªsh
(
rvu
, 
blkaddr
, 
lf
, &
aq_thr
);

1069 
	}
}

1071 
	$rvu_mbox_h™dÀr_sso_gΩ_°ash_c⁄fig
(
rvu
 *rvu,

1072 
sso_gΩ_°ash_cfg
 *
ªq
,

1073 
msg_r•
 *
r•
)

1075 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1076 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1077 
lf
, 
blkaddr
;

1078 
u64
 
ªg
;

1080 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1081 i‡(
blkaddr
 < 0)

1082  
SSO_AF_ERR_LF_INVALID
;

1084 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_CONST1
);

1086 i‡(!(
ªg
 & 
SSO_AF_CONST1_STASH_PRESENT
))

1087  
SSO_AF_ERR_INVALID_CFG
;

1089 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
gΩ
);

1090 i‡(
lf
 < 0)

1091  
SSO_AF_ERR_LF_INVALID
;

1093 
ªg
 = 
ªq
->
ía
;

1094 
ªg
 |(
u64
)
ªq
->
off£t
 << 8;

1095 
ªg
 |(
u64
)
ªq
->
num_löesm1
 << 4;

1097 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_STASH
(
lf
), 
ªg
);

1100 
	}
}

1102 
	$rvu_mbox_h™dÀr_sso_gΩ_gë_°©s
(
rvu
 *rvu,

1103 
sso_öfo_ªq
 *
ªq
,

1104 
sso_gΩ_°©s
 *
r•
)

1106 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1107 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1108 
lf
, 
blkaddr
;

1110 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1111 i‡(
blkaddr
 < 0)

1112  
SSO_AF_ERR_LF_INVALID
;

1114 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
gΩ
);

1115 i‡(
lf
 < 0)

1116  
SSO_AF_ERR_LF_INVALID
;

1118 
r•
->
ws_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_WS_PC
(
lf
));

1119 
r•
->
ext_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_EXT_PC
(
lf
));

1120 
r•
->
wa_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_WA_PC
(
lf
));

1121 
r•
->
ts_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_TS_PC
(
lf
));

1122 
r•
->
ds_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_DS_PC
(
lf
));

1123 
r•
->
dq_pc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_DQ_PC
(
lf
));

1124 
r•
->
aw_°©us
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_STATUS
(
lf
));

1125 
r•
->
∑ge_˙t
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_PAGE_CNT
(
lf
));

1128 
	}
}

1130 
	$rvu_mbox_h™dÀr_sso_hws_gë_°©s
(
rvu
 *rvu,

1131 
sso_öfo_ªq
 *
ªq
,

1132 
sso_hws_°©s
 *
r•
)

1134 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1135 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1136 
lf
, 
blkaddr
, 
ssow_blkaddr
;

1138 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1139 i‡(
blkaddr
 < 0)

1140  
SSO_AF_ERR_LF_INVALID
;

1142 
ssow_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 
pcifunc
);

1143 i‡(
ssow_blkaddr
 < 0)

1144  
SSO_AF_ERR_LF_INVALID
;

1146 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
ssow_blkaddr
], 
pcifunc
, 
ªq
->
hws
);

1147 i‡(
lf
 < 0)

1148  
SSO_AF_ERR_LF_INVALID
;

1150 
r•
->
¨bôøti⁄
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_ARB
(
lf
));

1153 
	}
}

1155 
	$rvu_mbox_h™dÀr_sso_lf_Æloc
(
rvu
 *rvu, 
sso_lf_Æloc_ªq
 *
ªq
,

1156 
sso_lf_Æloc_r•
 *
r•
)

1158 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1159 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1160 
ssﬁf
, 
uniq_idít
, 
rc
 = 0;

1161 
rvu_pfvf
 *
pfvf
;

1162 
hwgΩ
, 
blkaddr
;

1164 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1165 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1166 i‡(
pfvf
->
sso
 <0 || 
blkaddr
 < 0)

1167  
SSO_AF_ERR_LF_INVALID
;

1169 i‡(!
pfvf
->
sso_uniq_idít
) {

1170 
uniq_idít
 = 
	`rvu_Æloc_r§c
(&
hw
->
sso
.
pfvf_idít
);

1171 i‡(
uniq_idít
 < 0) {

1172 
rc
 = 
SSO_AF_ERR_AF_LF_ALLOC
;

1173 
exô
;

1175 
pfvf
->
sso_uniq_idít
 = 
uniq_idít
;

1177 
uniq_idít
 = 
pfvf
->
sso_uniq_idít
;

1181 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_IU_ACCNTX_CFG
(
uniq_idít
),

1182 
SSO_AF_HWGRP_IU_ACCNT_MAX_THR
 << 16);

1184 
hwgΩ
 = 0; hwgΩ < 
ªq
->
hwgΩs
; hwgrp++) {

1185 
ssﬁf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
hwgΩ
);

1186 i‡(
ssﬁf
 < 0)

1187  
SSO_AF_ERR_LF_INVALID
;

1192 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_IU_ACCNT
(
ssﬁf
),

1193 0x10000 | 
uniq_idít
);

1196 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWGRPX_AW_TAGSPACE
(
ssﬁf
),

1197 
uniq_idít
);

1200 
exô
:

1201 
r•
->
xaq_buf_size
 = 
hw
->
sso
.
sso_xaq_buf_size
;

1202 
r•
->
xaq_wq_íåõs
 = 
hw
->
sso
.
sso_xaq_num_w‹ks
;

1203 
r•
->
ö_unô_íåõs
 = 
hw
->
sso
.
sso_iue
;

1204 
r•
->
hwgΩs
 = 
hw
->
sso
.
sso_hwgΩs
;

1205  
rc
;

1206 
	}
}

1208 
	$rvu_mbox_h™dÀr_sso_lf_‰ì
(
rvu
 *rvu, 
sso_lf_‰ì_ªq
 *
ªq
,

1209 
msg_r•
 *
r•
)

1211 
hwgΩ
, 
lf
, 
îr
, 
blkaddr
, 
ªåy
;

1212 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1213 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1214 
døö_tmo
;

1215 
rvu_pfvf
 *
pfvf
;

1217 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1218 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1219 i‡(
blkaddr
 < 0)

1220  
SSO_AF_ERR_LF_INVALID
;

1222 
ªåy
 = 0;

1223 
døö_tmo
 = 
jiffõs
 + 
	`m£cs_to_jiffõs
(
SSO_FLUSH_TMO_MAX
);

1224 
hwgΩ
 = 0; hwgΩ < 
ªq
->
hwgΩs
 || 
ªåy
; hwgrp++) {

1225 i‡(
hwgΩ
 =
ªq
->
hwgΩs
) {

1226 i‡(
	`time_a·î
(
jiffõs
, 
døö_tmo
)) {

1227 
	`dev_îr
(
rvu
->
dev
, "FailedÅo drain SSO queues\n");

1231 
hwgΩ
 = 0;

1232 
ªåy
 = 0;

1234 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
hwgΩ
);

1235 i‡(
lf
 < 0)

1237 i‡(
	`rvu_sso_lf_døö_queues
(
rvu
, 
pcifunc
, 
lf
, 
hwgΩ
Ë=-
EAGAIN
)

1238 
ªåy
 = 1;

1240 
	`rvu_sso_˛ónup_xaq_auø
(
rvu
, 
pcifunc
, 
ªq
->
hwgΩs
);

1243 
hwgΩ
 = 0; hwgΩ < 
ªq
->
hwgΩs
; hwgrp++) {

1244 
lf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
hwgΩ
);

1245 i‡(
lf
 < 0)

1246  
SSO_AF_ERR_LF_INVALID
;

1248 
îr
 = 
	`rvu_sso_lf_ã¨down
(
rvu
, 
pcifunc
, 
lf
, 
hwgΩ
);

1249 i‡(
îr
)

1250  
îr
;

1253 
îr
 = 
	`rvu_lf_ª£t
(
rvu
, &
hw
->
block
[
blkaddr
], 
lf
);

1254 i‡(
îr
)

1255 
	`dev_îr
(
rvu
->
dev
, "SSO%d fªe: faûedÅÿª£t\n", 
lf
);

1257 
	`rvu_sso_hwgΩ_c⁄fig_thªsh
(
rvu
, 
blkaddr
, 
lf
, 
NULL
);

1260 i‡(
pfvf
->
sso_uniq_idít
) {

1261 
	`rvu_‰ì_r§c
(&
hw
->
sso
.
pfvf_idít
, 
pfvf
->
sso_uniq_idít
);

1262 
pfvf
->
sso_uniq_idít
 = 0;

1266 
	}
}

1268 
	#SSO_INVAL_SELECTIVE_VER
 0x1000

	)

1269 
	$rvu_mbox_h™dÀr_sso_ws_ˇche_öv
(
rvu
 *rvu,

1270 
ssow_lf_öv_ªq
 *
ªq
,

1271 
msg_r•
 *
r•
)

1273 
num_lfs
, 
ssowlf
, 
hws
, 
blkaddr
;

1274 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1275 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1276 
rvu_block
 *
block
;

1278 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 
pcifunc
);

1279 i‡(
blkaddr
 < 0)

1280  
SSOW_AF_ERR_LF_INVALID
;

1282 
block
 = &
hw
->block[
blkaddr
];

1284 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
),

1285 
block
->
addr
);

1286 i‡(!
num_lfs
)

1287  
SSOW_AF_ERR_LF_INVALID
;

1289 i‡(
ªq
->
hdr
.
vî
 =
SSO_INVAL_SELECTIVE_VER
) {

1290 i‡(
ªq
->
nb_hws
 > 
num_lfs
)

1291  
SSOW_AF_ERR_LF_INVALID
;

1292 
num_lfs
 = 
ªq
->
nb_hws
;

1296 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1297 i‡(
blkaddr
 < 0)

1298  
SSO_AF_ERR_LF_INVALID
;

1300 
hws
 = 0; hw†< 
num_lfs
; hws++) {

1301 
ssowlf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 
ªq
->
hdr
.
vî
 ==

1302 
SSO_INVAL_SELECTIVE_VER
 ?

1303 
ªq
->
hws
[hws] : hws);

1304 i‡(
ssowlf
 < 0)

1305  
SSOW_AF_ERR_LF_INVALID
;

1308 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssowlf
), 1);

1309 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_INV
(
ssowlf
), 0x2, 
åue
);

1313 
	}
}

1315 
	$rvu_mbox_h™dÀr_ssow_chng_mshù
(
rvu
 *rvu,

1316 
ssow_chng_mshù
 *
ªq
,

1317 
msg_r•
 *
r•
)

1319 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1320 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1321 
ssﬁf
, 
ssowlf
, 
hwgΩ
;

1322 
u8
 
pos
, 
bô
;

1323 
blkaddr
;

1324 
u64
 
ªg
;

1326 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 
pcifunc
);

1327 i‡(
blkaddr
 < 0)

1328  
SSOW_AF_ERR_LF_INVALID
;

1330 
ssowlf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
hws
);

1331 i‡(
ssowlf
 < 0)

1332  
SSO_AF_ERR_PARAM
;

1334 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1335 i‡(
blkaddr
 < 0)

1336  
SSO_AF_ERR_LF_INVALID
;

1338 
hwgΩ
 = 0; hwgΩ < 
ªq
->
nb_hwgΩs
; hwgrp++) {

1339 
ssﬁf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
,

1340 
ªq
->
hwgΩs
[
hwgΩ
]);

1341 i‡(
ssﬁf
 < 0)

1342  
SSO_AF_ERR_PARAM
;

1344 i‡(
ªq
->
£t
 > 1)

1345  
SSO_AF_ERR_PARAM
;

1346 
pos
 = 
ssﬁf
 / 64;

1347 
bô
 = 
ssﬁf
 % 64;

1349 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_SX_GRPMSKX
(
ssowlf
,

1350 
ªq
->
£t
,

1351 
pos
));

1352 i‡(
ªq
->
íabÀ
)

1353 
ªg
 |
	`BIT_ULL
(
bô
);

1355 
ªg
 &~
	`BIT_ULL
(
bô
);

1357 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_SX_GRPMSKX
(
ssowlf
,

1358 
ªq
->
£t
,

1359 
pos
), 
ªg
);

1363 
	}
}

1365 
	$rvu_mbox_h™dÀr_ssow_lf_Æloc
(
rvu
 *rvu,

1366 
ssow_lf_Æloc_ªq
 *
ªq
,

1367 
msg_r•
 *
r•
)

1369 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1370 
rvu_pfvf
 *
pfvf
;

1372 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

1373 i‡(
pfvf
->
ssow
 <= 0)

1374  
SSOW_AF_ERR_LF_INVALID
;

1377 
	}
}

1379 
	$rvu_mbox_h™dÀr_ssow_lf_‰ì
(
rvu
 *rvu,

1380 
ssow_lf_‰ì_ªq
 *
ªq
,

1381 
msg_r•
 *
r•
)

1383 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1384 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1385 
ssowlf
, 
hws
, 
îr
, 
blkaddr
;

1387 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 
pcifunc
);

1388 i‡(
blkaddr
 < 0)

1389  
SSOW_AF_ERR_LF_INVALID
;

1391 
hws
 = 0; hw†< 
ªq
->hws; hws++) {

1392 
ssowlf
 = 
	`rvu_gë_lf
(
rvu
, &
hw
->
block
[
blkaddr
], 
pcifunc
, 
hws
);

1393 i‡(
ssowlf
 < 0)

1394  
SSOW_AF_ERR_LF_INVALID
;

1396 
îr
 = 
	`rvu_ssow_lf_ã¨down
(
rvu
, 
pcifunc
, 
ssowlf
, 
hws
);

1397 i‡(
îr
)

1398  
îr
;

1401 
îr
 = 
	`rvu_lf_ª£t
(
rvu
, &
hw
->
block
[
blkaddr
], 
ssowlf
);

1402 i‡(
îr
)

1403 
	`dev_îr
(
rvu
->
dev
, "SSOW%d free: failedÅoÑeset\n",

1404 
ssowlf
);

1408 
	}
}

1410 
	$rvu_mbox_h™dÀr_ssow_c⁄fig_lsw
(
rvu
 *rvu,

1411 
ssow_c⁄fig_lsw
 *
ªq
,

1412 
msg_r•
 *
r•
)

1414 
num_lfs
, 
ssowlf
, 
hws
, 
blkaddr
;

1415 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

1416 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

1417 
rvu_block
 *
block
;

1418 
boﬁ
 
has_lsw
;

1419 
u64
 
vÆ
;

1421 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 
pcifunc
);

1422 i‡(
blkaddr
 < 0)

1423  
SSOW_AF_ERR_LF_INVALID
;

1425 
block
 = &
hw
->block[
blkaddr
];

1427 
num_lfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
),

1428 
block
->
addr
);

1429 i‡(!
num_lfs
)

1430  
SSOW_AF_ERR_LF_INVALID
;

1433 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 
pcifunc
);

1434 i‡(
blkaddr
 < 0)

1435  
SSO_AF_ERR_LF_INVALID
;

1437 
vÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_CONST1
);

1438 
has_lsw
 = !!(
vÆ
 & 
SSO_AF_CONST1_LSW_PRESENT
);

1440 i‡(!
has_lsw
 || 
ªq
->
lsw_mode
 > 
SSOW_LSW_GW_IMM
 ||

1441 
ªq
->
wqe_ªÀa£
 > 
SSOW_WQE_REL_IMM
)

1442  
SSOW_AF_ERR_INVALID_CFG
;

1444 
hws
 = 0; hw†< 
num_lfs
; hws++) {

1445 
ssowlf
 = 
	`rvu_gë_lf
(
rvu
, 
block
, 
pcifunc
, 
hws
);

1446 i‡(
ssowlf
 < 0)

1447  
SSOW_AF_ERR_LF_INVALID
;

1448 
vÆ
 = 
ªq
->
wqe_ªÀa£
 << 2;

1449 
vÆ
 |
ªq
->
lsw_mode
;

1450 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`SSO_AF_HWSX_LSW_CFG
(
ssowlf
), 
vÆ
);

1454 
	}
}

1456 
	$rvu_sso_do_ªgi°î_öãºu±
(
rvu
 *rvu, 
úq_offs
,

1457 
úq_h™dÀr_t
 
h™dÀr
,

1458 c⁄° *
«me
)

1460 
ªt
 = 0;

1462 
ªt
 = 
	`ªque°_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
úq_offs
), 
h™dÀr
, 0,

1463 
«me
, 
rvu
);

1464 i‡(
ªt
) {

1465 
	`dev_îr
(
rvu
->
dev
, "SSOAF: %†úqÑegi°øti⁄ faûed", 
«me
);

1466 
îr
;

1469 
	`WARN_ON
(
rvu
->
úq_Æloˇãd
[
úq_offs
]);

1470 
rvu
->
úq_Æloˇãd
[
úq_offs
] = 
åue
;

1471 
îr
:

1472  
ªt
;

1473 
	}
}

1475 
úqªtu∫_t
 
	$rvu_sso_af_îr0_öå_h™dÀr
(
úq
, *
±r
)

1477 
rvu
 *rvu = (rvu *)
±r
;

1478 
rvu_block
 *
block
;

1479 
i
, 
blkaddr
;

1480 
u64
 
ªg
, 
ªg0
;

1482 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

1483 i‡(
blkaddr
 < 0)

1484  
IRQ_NONE
;

1486 
block
 = &
rvu
->
hw
->block[
blkaddr
];

1487 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR0
);

1488 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Re˚ived SSO_AF_ERR0 irq : 0x%Œx", 
ªg
);

1490 i‡(
ªg
 & 
	`BIT_ULL
(16)) {

1491 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Fault whenÖerformingá stashÑequest");

1492 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_BAD_STASH_DIGEST
)

1495 i‡(
ªg
 & 
	`BIT_ULL
(15)) {

1496 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Received Bad-fill-packet NCBÉrror");

1497 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_POISON
)

1500 i‡(
ªg
 & 
	`BIT_ULL
(14)) {

1501 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "An FLR was initiated, but SSO_LF_GGRP_AQ_CNT[AQ_CNT] != 0");

1502 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_FLR_AQ_DIGEST
)

1505 i‡(
ªg
 & 
	`BIT_ULL
(13)) {

1506 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Add work dropped dueÅo XAQÖointersÇot yet initialized.");

1507 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_XAQDIS_DIGEST
)

1510 i‡(
ªg
 & (0xF << 9)) {

1511 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "PF_FUNC mappingÉrror.");

1512 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "SSO_AF_UNMAP_INFO : 0x%llx",

1513 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_UNMAP_INFO
));

1516 i‡(
ªg
 & 
	`BIT_ULL
(8)) {

1517 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Add work dropped dueÅo QTL being disabled, 0x0");

1518 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_QCTLDIS_DIGEST
)

1521 i‡(
ªg
 & 
	`BIT_ULL
(7)) {

1522 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Add work dropped dueÅo WQP being 0x0");

1523 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_WQP0_DIGEST
)

1526 i‡(
ªg
 & 
	`BIT_ULL
(6))

1527 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Add work dropped dueÅo 64 bit write");

1529 i‡(
ªg
 & 
	`BIT_ULL
(5))

1530 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Set whenÑeceivedádd work withÅagÅype is specifiedás EMPTY");

1532 i‡(
ªg
 & 
	`BIT_ULL
(4)) {

1533 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Add workÅo disabled hardware group. An ADDWQ wasÑeceivedánd droppedÅoá hardware group with SSO_AF_HWGRP(0..255)_IAQ_THR[RSVD_THR] = 0.");

1534 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_GRPDIS_DIGEST
)

1537 i‡(
ªg
 & 
	`BIT_ULL
(3)) {

1538 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Bad-fill-packet NCBÉrror");

1539 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_BFPN_DIGEST
)

1542 i‡(
ªg
 & 
	`BIT_ULL
(2)) {

1543 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Bad-fill-packetÉrror.");

1544 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_BFP_DIGEST
)

1547 i‡(
ªg
 & 
	`BIT_ULL
(1)) {

1548 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "The NPAÑeturnedánÉrror indication");

1549 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_NPA_DIGEST
)

1552 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR0
, 
ªg
);

1553  
IRQ_HANDLED
;

1554 
	}
}

1556 
úqªtu∫_t
 
	$rvu_sso_af_îr2_öå_h™dÀr
(
úq
, *
±r
)

1558 
rvu
 *rvu = (rvu *)
±r
;

1559 
blkaddr
, 
ssow_blkaddr
;

1560 
rvu_block
 *
block
;

1561 
u64
 
ªg
, 
ªg0
;

1562 
i
;

1564 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

1565 i‡(
blkaddr
 < 0)

1566  
IRQ_NONE
;

1568 
ssow_blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSOW
, 0);

1569 i‡(
ssow_blkaddr
 < 0)

1570  
IRQ_NONE
;

1572 
block
 = &
rvu
->
hw
->block[
ssow_blkaddr
];

1573 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR2
);

1574 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "ª˚ived SSO_AF_ERR2 irq : 0x%Œx", 
ªg
);

1575 i‡(
ªg
 & 
	`BIT_ULL
(0))

1576 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Attemptedáccess beforeÑeset was complete");

1578 i‡(
ªg
 & 
	`BIT_ULL
(1)) {

1579 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "SSOW_AF_LF_HWS_RST wasáttempted forá workslotÅhat wasÇotÉmpty.");

1580 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_WS_NE_DIGEST
)

1583 i‡(
ªg
 & 
	`BIT_ULL
(2)) {

1584 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "SSOW_AF_LF_HWS_RST wasáttempted forá workslotÅhat wasÇot idle.");

1585 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_WS_NI_DIGEST
)

1588 i‡(
ªg
 & 
	`BIT_ULL
(3)) {

1589 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "SSOW_AF_LF_HWS_RST wasáttempted forá workslotÅhat was still mappedÅoán AP.");

1590 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_WS_NT_DIGEST
)

1593 i‡(
ªg
 & 
	`BIT_ULL
(28)) {

1594 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Workslot operation foundÇo HWGRP PF_FUNC mapping for supplied guest group.");

1595 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "SSO_AF_UNMAP_INFO2 : 0x%llx",

1596 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_UNMAP_INFO2
));

1597 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_WS_GUNMAP_DIGEST
)

1600 i‡(
ªg
 & 
	`BIT_ULL
(29)) {

1601 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Workslot operation found HWGRP PF_FUNC map had double-hitÉrror for supplied guest group");

1602 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "SSO_AF_UNMAP_INFO2 : 0x%llx",

1603 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1604 
SSO_AF_UNMAP_INFO2
));

1605 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_WS_GUNMAP_DIGEST
)

1608 i‡(
ªg
 & 
	`BIT_ULL
(30)) {

1609 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Workslotáccess foundÇo HWS PF_FUNC mapping.");

1610 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "SSO_AF_UNMAP_INFO3 : 0x%llx",

1611 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1612 
SSO_AF_UNMAP_INFO3
));

1615 i‡(
ªg
 & 
	`BIT_ULL
(31)) {

1616 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "Workslotáccess found HWS PF_FUNC map had double-hitÉrror.");

1617 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "SSO_AF_UNMAP_INFO3 : 0x%llx",

1618 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

1619 
SSO_AF_UNMAP_INFO3
));

1622 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR2
, 
ªg
);

1624  
IRQ_HANDLED
;

1625 
	}
}

1627 
úqªtu∫_t
 
	$rvu_sso_af_øs_öå_h™dÀr
(
úq
, *
±r
)

1629 
rvu
 *rvu = (rvu *)
±r
;

1630 
rvu_block
 *
block
;

1631 
i
, 
blkaddr
;

1632 
u64
 
ªg
, 
ªg0
;

1634 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

1635 i‡(
blkaddr
 < 0)

1636  
IRQ_NONE
;

1638 
block
 = &
rvu
->
hw
->block[
blkaddr
];

1640 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_RAS
);

1641 
	`dev_îr_øãlimôed
(
rvu
->
dev
, "ª˚ived SSO_AF_RAS irq : 0x%Œx", 
ªg
);

1642 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_RAS
, 
ªg
);

1643 
	`SSO_AF_INT_DIGEST_PRNT
(
SSO_AF_POISON
)

1645  
IRQ_HANDLED
;

1646 
	}
}

1648 
	$rvu_sso_uƒegi°î_öãºu±s
(
rvu
 *rvu)

1650 
i
, 
blkaddr
, 
offs
;

1652 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

1653 i‡(
blkaddr
 < 0)

1656 
offs
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_PRIV_AF_INT_CFG
) & 0x7FF;

1657 i‡(!
offs
)

1660 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_RAS_ENA_W1C
, ~0ULL);

1661 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR2_ENA_W1C
, ~0ULL);

1662 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR0_ENA_W1C
, ~0ULL);

1664 
i
 = 0; i < 
SSO_AF_INT_VEC_CNT
; i++)

1665 i‡(
rvu
->
úq_Æloˇãd
[
offs
 + 
i
]) {

1666 
	`‰ì_úq
(
	`pci_úq_ve˘‹
(
rvu
->
pdev
, 
offs
 + 
i
),Ñvu);

1667 
rvu
->
úq_Æloˇãd
[
offs
 + 
i
] = 
Ál£
;

1669 
	}
}

1671 
	$rvu_sso_ªgi°î_öãºu±s
(
rvu
 *rvu)

1673 
blkaddr
, 
offs
, 
ªt
 = 0;

1675 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_SSO
))

1678 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

1679 i‡(
blkaddr
 < 0)

1680  
blkaddr
;

1682 
offs
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_PRIV_AF_INT_CFG
) & 0x7FF;

1683 i‡(!
offs
) {

1684 
	`dev_w¨n
(
rvu
->
dev
,

1689 
ªt
 = 
	`rvu_sso_do_ªgi°î_öãºu±
(
rvu
, 
offs
 + 
SSO_AF_INT_VEC_ERR0
,

1690 
rvu_sso_af_îr0_öå_h™dÀr
,

1692 i‡(
ªt
)

1693 
îr
;

1694 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR0_ENA_W1S
, ~0ULL);

1696 
ªt
 = 
	`rvu_sso_do_ªgi°î_öãºu±
(
rvu
, 
offs
 + 
SSO_AF_INT_VEC_ERR2
,

1697 
rvu_sso_af_îr2_öå_h™dÀr
,

1699 i‡(
ªt
)

1700 
îr
;

1701 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_ERR2_ENA_W1S
, ~0ULL);

1703 
ªt
 = 
	`rvu_sso_do_ªgi°î_öãºu±
(
rvu
, 
offs
 + 
SSO_AF_INT_VEC_RAS
,

1704 
rvu_sso_af_øs_öå_h™dÀr
,

1706 i‡(
ªt
)

1707 
îr
;

1708 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_RAS_ENA_W1S
, ~0ULL);

1711 
îr
:

1712 
	`rvu_sso_uƒegi°î_öãºu±s
(
rvu
);

1713  
ªt
;

1714 
	}
}

1716 
	$rvu_sso_öô
(
rvu
 *rvu)

1718 
u64
 
üq_‰ì_˙t
, 
üq_rsvd
, 
üq_max
, 
üq_rsvd_˙t
 = 0;

1719 
u64
 
èq_‰ì_˙t
, 
èq_rsvd
, 
èq_max
, 
èq_rsvd_˙t
 = 0;

1720 
sso_r§c
 *
sso
 = &
rvu
->
hw
->sso;

1721 
blkaddr
, 
hwgΩ
, 
gΩmsk
, 
hws
, 
îr
;

1722 
u64
 
ªg
;

1724 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_SSO
, 0);

1725 i‡(
blkaddr
 < 0)

1728 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

1729 
	`rvu_sso_block_˙10k_öô
(
rvu
, 
blkaddr
);

1731 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_CONST
);

1733 
sso
->
sso_hws
 = (
ªg
 >> 56) & 0xFF;

1735 
sso
->
sso_hwgΩs
 = (
ªg
 & 0xFFFF);

1737 
sso
->
sso_iue
 = (
ªg
 >> 16) & 0xFFFF;

1739 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_CONST1
);

1741 
sso
->
sso_xaq_num_w‹ks
 = (
ªg
 >> 16) & 0xFFFF;

1743 
sso
->
sso_xaq_buf_size
 = (
ªg
 & 0xFFFF);

1746 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_AW_WE
);

1747 
üq_‰ì_˙t
 = 
ªg
 & 
SSO_AF_IAQ_FREE_CNT_MASK
;

1750 
üq_rsvd
 = 
üq_‰ì_˙t
 / 
sso
->
sso_hwgΩs
 / 2;

1753 i‡(
üq_rsvd
 < 
SSO_HWGRP_IAQ_RSVD_THR
)

1754 
üq_rsvd
 = 
SSO_HWGRP_IAQ_RSVD_THR
;

1756 
üq_max
 = 
üq_rsvd
 + 
SSO_HWGRP_IAQ_MAX_THR_STRM_PERF
;

1758 i‡(
üq_max
 >(
SSO_AF_IAQ_FREE_CNT_MAX
 + 1))

1759 
üq_max
 = 
SSO_AF_IAQ_FREE_CNT_MAX
;

1762 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_TAQ_CNT
);

1763 
èq_‰ì_˙t
 = 
ªg
 & 
SSO_AF_TAQ_FREE_CNT_MASK
;

1766 
èq_rsvd
 = 
èq_‰ì_˙t
 / 
sso
->
sso_hwgΩs
 / 2;

1769 i‡(
èq_rsvd
 < 
SSO_HWGRP_TAQ_RSVD_THR
)

1770 
èq_rsvd
 = 
SSO_HWGRP_TAQ_RSVD_THR
;

1772 
èq_max
 = 
èq_rsvd
 + 
SSO_HWGRP_TAQ_MAX_THR_STRM_PERF
;

1774 i‡(
èq_max
 >(
SSO_AF_TAQ_FREE_CNT_MAX
 + 1))

1775 
èq_max
 = 
SSO_AF_TAQ_FREE_CNT_MAX
;

1778 
sso
->
aq_thr
.
üq_rsvd
 = iaq_rsvd;

1779 
sso
->
aq_thr
.
üq_max
 = iaq_max;

1780 
sso
->
aq_thr
.
èq_rsvd
 =Åaq_rsvd;

1781 
sso
->
aq_thr
.
èq_max
 =Åaq_max;

1783 
hwgΩ
 = 0; hwgΩ < 
sso
->
sso_hwgΩs
; hwgrp++) {

1784 
	`rvu_sso_hwgΩ_c⁄fig_thªsh
(
rvu
, 
blkaddr
, 
hwgΩ
, 
NULL
);

1785 
üq_rsvd_˙t
 +
üq_rsvd
;

1786 
èq_rsvd_˙t
 +
èq_rsvd
;

1792 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_AW_WE
);

1793 
ªg
 = (ªg >> 
SSO_AF_IAQ_RSVD_FREE_SHIFT
Ë& 
SSO_AF_IAQ_RSVD_FREE_MASK
;

1794 i‡(
ªg
 < 
üq_rsvd_˙t
) {

1795 
	`dev_w¨n
(
rvu
->
dev
, "WARN: Wrong IAQÑesource calculations %llx vs %llx\n",

1796 
ªg
, 
üq_rsvd_˙t
);

1797 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_AW_WE
,

1798 (
üq_rsvd_˙t
 & 
SSO_AF_IAQ_RSVD_FREE_MASK
) <<

1799 
SSO_AF_IAQ_RSVD_FREE_SHIFT
);

1802 
ªg
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
SSO_AF_TAQ_CNT
);

1803 
ªg
 = (ªg >> 
SSO_AF_TAQ_RSVD_FREE_SHIFT
Ë& 
SSO_AF_TAQ_RSVD_FREE_MASK
;

1804 i‡(
ªg
 < 
èq_rsvd_˙t
) {

1805 
	`dev_w¨n
(
rvu
->
dev
, "WARN: Wrong TAQÑesource calculations %llx vs %llx\n",

1806 
ªg
, 
èq_rsvd_˙t
);

1807 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_TAQ_CNT
,

1808 (
èq_rsvd_˙t
 & 
SSO_AF_TAQ_RSVD_FREE_MASK
) <<

1809 
SSO_AF_TAQ_RSVD_FREE_SHIFT
);

1816 
gΩmsk
 = 0; gΩmsk < (
sso
->
sso_hwgΩs
 / 64); grpmsk++) {

1817 
hws
 = 0; hw†< 
sso
->
sso_hws
; hws++) {

1818 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1819 
	`SSO_AF_HWSX_SX_GRPMSKX
(
hws
, 0, 
gΩmsk
),

1821 
	`rvu_wrôe64
(
rvu
, 
blkaddr
,

1822 
	`SSO_AF_HWSX_SX_GRPMSKX
(
hws
, 1, 
gΩmsk
),

1830 
sso
->
pfvf_idít
.
max
 = sso->
sso_hws
 + 1;

1831 
îr
 = 
	`rvu_Æloc_bôm≠
(&
sso
->
pfvf_idít
);

1832 i‡(
îr
)

1833  
îr
;

1836 
	`rvu_Æloc_r§c
(&
sso
->
pfvf_idít
);

1839 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
SSO_AF_WQ_INT_PC
, 0x28UL << 8);

1842 
	}
}

1844 
	$rvu_sso_‰ìmem
(
rvu
 *rvu)

1846 
sso_r§c
 *
sso
 = &
rvu
->
hw
->sso;

1848 
	`k‰ì
(
sso
->
pfvf_idít
.
bm≠
);

1849 
	}
}

	@rvu_struct.h

8 #i‚de‡
RVU_STRUCT_H


9 
	#RVU_STRUCT_H


	)

12 
	#RVU_BLK_RVUM_REVID
 0x01

	)

14 
	#RVU_MULTI_BLK_VER
 0x7ULL

	)

17 
	ervu_block_addr_e
 {

18 
	mBLKADDR_RVUM
 = 0x0ULL,

19 
	mBLKADDR_LMT
 = 0x1ULL,

20 
	mBLKADDR_MSIX
 = 0x2ULL,

21 
	mBLKADDR_NPA
 = 0x3ULL,

22 
	mBLKADDR_NIX0
 = 0x4ULL,

23 
	mBLKADDR_NIX1
 = 0x5ULL,

24 
	mBLKADDR_NPC
 = 0x6ULL,

25 
	mBLKADDR_SSO
 = 0x7ULL,

26 
	mBLKADDR_SSOW
 = 0x8ULL,

27 
	mBLKADDR_TIM
 = 0x9ULL,

28 
	mBLKADDR_CPT0
 = 0xaULL,

29 
	mBLKADDR_CPT1
 = 0xbULL,

30 
	mBLKADDR_NDC_NIX0_RX
 = 0xcULL,

31 
	mBLKADDR_NDC_NIX0_TX
 = 0xdULL,

32 
	mBLKADDR_NDC_NPA0
 = 0xeULL,

33 
	mBLKADDR_NDC_NIX1_RX
 = 0x10ULL,

34 
	mBLKADDR_NDC_NIX1_TX
 = 0x11ULL,

35 
	mBLKADDR_REE0
 = 0x14ULL,

36 
	mBLKADDR_REE1
 = 0x15ULL,

37 
	mBLKADDR_APR
 = 0x16ULL,

38 
	mBLK_COUNT
 = 0x17ULL,

42 
	ervu_block_ty≥_e
 {

43 
	mBLKTYPE_RVUM
 = 0x0,

44 
	mBLKTYPE_MSIX
 = 0x1,

45 
	mBLKTYPE_LMT
 = 0x2,

46 
	mBLKTYPE_NIX
 = 0x3,

47 
	mBLKTYPE_NPA
 = 0x4,

48 
	mBLKTYPE_NPC
 = 0x5,

49 
	mBLKTYPE_SSO
 = 0x6,

50 
	mBLKTYPE_SSOW
 = 0x7,

51 
	mBLKTYPE_TIM
 = 0x8,

52 
	mBLKTYPE_CPT
 = 0x9,

53 
	mBLKTYPE_NDC
 = 0xa,

54 
	mBLKTYPE_REE
 = 0xe,

55 
	mBLKTYPE_MAX
 = 0xe,

59 
	ervu_af_öt_vec_e
 {

60 
	mRVU_AF_INT_VEC_POISON
 = 0x0,

61 
	mRVU_AF_INT_VEC_PFFLR
 = 0x1,

62 
	mRVU_AF_INT_VEC_PFME
 = 0x2,

63 
	mRVU_AF_INT_VEC_GEN
 = 0x3,

64 
	mRVU_AF_INT_VEC_MBOX
 = 0x4,

65 
	mRVU_AF_INT_VEC_CNT
 = 0x5,

69 
	esso_af_öt_vec_e
 {

70 
	mSSO_AF_INT_VEC_ERR0
 = 0x0,

71 
	mSSO_AF_INT_VEC_ERR2
 = 0x1,

72 
	mSSO_AF_INT_VEC_RAS
 = 0x2,

73 
	mSSO_AF_INT_VEC_CNT
 = 0x3,

77 
	e˝t_af_öt_vec_e
 {

78 
	mCPT_AF_INT_VEC_FLT0
 = 0x0,

79 
	mCPT_AF_INT_VEC_FLT1
 = 0x1,

80 
	mCPT_AF_INT_VEC_RVU
 = 0x2,

81 
	mCPT_AF_INT_VEC_RAS
 = 0x3,

82 
	mCPT_AF_INT_VEC_CNT
 = 0x4,

85 
	e˝t_10k_af_öt_vec_e
 {

86 
	mCPT_10K_AF_INT_VEC_FLT0
 = 0x0,

87 
	mCPT_10K_AF_INT_VEC_FLT1
 = 0x1,

88 
	mCPT_10K_AF_INT_VEC_FLT2
 = 0x2,

89 
	mCPT_10K_AF_INT_VEC_RVU
 = 0x3,

90 
	mCPT_10K_AF_INT_VEC_RAS
 = 0x4,

91 
	mCPT_10K_AF_INT_VEC_CNT
 = 0x5,

94 
	eªe_af_öt_vec_e
 {

95 
	mREE_AF_INT_VEC_RAS
 = 0x0,

96 
	mREE_AF_INT_VEC_RVU
 = 0x1,

97 
	mREE_AF_INT_VEC_QUE_DONE
 = 0x2,

98 
	mREE_AF_INT_VEC_AQ
 = 0x3,

99 
	mREE_AF_INT_VEC_CNT
 = 0x4,

103 
	e≈a_af_öt_vec_e
 {

104 
	mNPA_AF_INT_VEC_RVU
 = 0x0,

105 
	mNPA_AF_INT_VEC_GEN
 = 0x1,

106 
	mNPA_AF_INT_VEC_AQ_DONE
 = 0x2,

107 
	mNPA_AF_INT_VEC_AF_ERR
 = 0x3,

108 
	mNPA_AF_INT_VEC_POISON
 = 0x4,

109 
	mNPA_AF_INT_VEC_CNT
 = 0x5,

113 
	enix_af_öt_vec_e
 {

114 
	mNIX_AF_INT_VEC_RVU
 = 0x0,

115 
	mNIX_AF_INT_VEC_GEN
 = 0x1,

116 
	mNIX_AF_INT_VEC_AQ_DONE
 = 0x2,

117 
	mNIX_AF_INT_VEC_AF_ERR
 = 0x3,

118 
	mNIX_AF_INT_VEC_POISON
 = 0x4,

119 
	mNIX_AF_INT_VEC_CNT
 = 0x5,

125 
	ervu_pf_öt_vec_e
 {

126 
	mRVU_PF_INT_VEC_VFFLR0
 = 0x0,

127 
	mRVU_PF_INT_VEC_VFFLR1
 = 0x1,

128 
	mRVU_PF_INT_VEC_VFME0
 = 0x2,

129 
	mRVU_PF_INT_VEC_VFME1
 = 0x3,

130 
	mRVU_PF_INT_VEC_VFPF_MBOX0
 = 0x4,

131 
	mRVU_PF_INT_VEC_VFPF_MBOX1
 = 0x5,

132 
	mRVU_PF_INT_VEC_AFPF_MBOX
 = 0x6,

133 
	mRVU_PF_INT_VEC_CNT
 = 0x7,

137 
	e≈a_aq_comp
 {

138 
	mNPA_AQ_COMP_NOTDONE
 = 0x0,

139 
	mNPA_AQ_COMP_GOOD
 = 0x1,

140 
	mNPA_AQ_COMP_SWERR
 = 0x2,

141 
	mNPA_AQ_COMP_CTX_POISON
 = 0x3,

142 
	mNPA_AQ_COMP_CTX_FAULT
 = 0x4,

143 
	mNPA_AQ_COMP_LOCKERR
 = 0x5,

147 
	e≈a_aq_˘y≥
 {

148 
	mNPA_AQ_CTYPE_AURA
 = 0x0,

149 
	mNPA_AQ_CTYPE_POOL
 = 0x1,

153 
	e≈a_aq_ö°›
 {

154 
	mNPA_AQ_INSTOP_NOP
 = 0x0,

155 
	mNPA_AQ_INSTOP_INIT
 = 0x1,

156 
	mNPA_AQ_INSTOP_WRITE
 = 0x2,

157 
	mNPA_AQ_INSTOP_READ
 = 0x3,

158 
	mNPA_AQ_INSTOP_LOCK
 = 0x4,

159 
	mNPA_AQ_INSTOP_UNLOCK
 = 0x5,

163 
	e≈a_öpq
 {

164 
	mNPA_INPQ_NIX0_RX
 = 0x0,

165 
	mNPA_INPQ_NIX0_TX
 = 0x1,

166 
	mNPA_INPQ_NIX1_RX
 = 0x2,

167 
	mNPA_INPQ_NIX1_TX
 = 0x3,

168 
	mNPA_INPQ_SSO
 = 0x4,

169 
	mNPA_INPQ_TIM
 = 0x5,

170 
	mNPA_INPQ_DPI
 = 0x6,

171 
	mNPA_INPQ_AURA_OP
 = 0xe,

172 
	mNPA_INPQ_INTERNAL_RSV
 = 0xf,

176 
	s≈a_aq_ö°_s
 {

177 
u64
 
	m›
 : 4;

178 
u64
 
	m˘y≥
 : 4;

179 
u64
 
	mlf
 : 9;

180 
u64
 
	mª£rved_17_23
 : 7;

181 
u64
 
	mcödex
 : 20;

182 
u64
 
	mª£rved_44_62
 : 19;

183 
u64
 
	md⁄eöt
 : 1;

184 
u64
 
	mªs_addr
;

188 
	s≈a_aq_ªs_s
 {

189 
u64
 
	m›
 : 4;

190 
u64
 
	m˘y≥
 : 4;

191 
u64
 
	mcompcode
 : 8;

192 
u64
 
	md⁄eöt
 : 1;

193 
u64
 
	mª£rved_17_63
 : 47;

194 
u64
 
	mª£rved_64_127
;

197 
	s≈a_auø_s
 {

198 
u64
 
	mpoﬁ_addr
;

199 
u64
 
	mía
 : 1;

200 
u64
 
	mª£rved_65
 : 2;

201 
u64
 
	mpoﬁ_ˇchög
 : 1;

202 
u64
 
	mpoﬁ_way_mask
 : 16;

203 
u64
 
	mavg_c⁄
 : 9;

204 
u64
 
	mª£rved_93
 : 1;

205 
u64
 
	mpoﬁ_dr›_ía
 : 1;

206 
u64
 
	mauø_dr›_ía
 : 1;

207 
u64
 
	mbp_ía
 : 2;

208 
u64
 
	mª£rved_98_103
 : 6;

209 
u64
 
	mauø_dr›
 : 8;

210 
u64
 
	mshi·
 : 6;

211 
u64
 
	mª£rved_118_119
 : 2;

212 
u64
 
	mavg_Àvñ
 : 8;

213 
u64
 
	mcou¡
 : 36;

214 
u64
 
	mª£rved_164_167
 : 4;

215 
u64
 
	mnix0_bpid
 : 9;

216 
u64
 
	mª£rved_177_179
 : 3;

217 
u64
 
	mnix1_bpid
 : 9;

218 
u64
 
	mª£rved_189_191
 : 3;

219 
u64
 
	mlimô
 : 36;

220 
u64
 
	mª£rved_228_231
 : 4;

221 
u64
 
	mbp
 : 8;

222 
u64
 
	mª£rved_241_243
 : 3;

223 
u64
 
	mfc_be
 : 1;

224 
u64
 
	mfc_ía
 : 1;

225 
u64
 
	mfc_up_¸ossög
 : 1;

226 
u64
 
	mfc_°y≥
 : 2;

227 
u64
 
	mfc_hy°_bôs
 : 4;

228 
u64
 
	mª£rved_252_255
 : 4;

229 
u64
 
	mfc_addr
;

230 
u64
 
	mpoﬁ_dr›
 : 8;

231 
u64
 
	mupd©e_time
 : 16;

232 
u64
 
	mîr_öt
 : 8;

233 
u64
 
	mîr_öt_ía
 : 8;

234 
u64
 
	mthªsh_öt
 : 1;

235 
u64
 
	mthªsh_öt_ía
 : 1;

236 
u64
 
	mthªsh_up
 : 1;

237 
u64
 
	mª£rved_363
 : 1;

238 
u64
 
	mthªsh_qöt_idx
 : 7;

239 
u64
 
	mª£rved_371
 : 1;

240 
u64
 
	mîr_qöt_idx
 : 7;

241 
u64
 
	mª£rved_379_383
 : 5;

242 
u64
 
	mthªsh
 : 36;

243 
u64
 
	mrsvd_423_420
 : 4;

244 
u64
 
	mfc_msh_d°
 : 11;

245 
u64
 
	mª£rved_435_447
 : 13;

246 
u64
 
	mª£rved_448_511
;

249 
	s≈a_poﬁ_s
 {

250 
u64
 
	m°ack_ba£
;

251 
u64
 
	mía
 : 1;

252 
u64
 
	m«t_Æign
 : 1;

253 
u64
 
	mª£rved_66_67
 : 2;

254 
u64
 
	m°ack_ˇchög
 : 1;

255 
u64
 
	mª£rved_70_71
 : 3;

256 
u64
 
	m°ack_way_mask
 : 16;

257 
u64
 
	mbuf_off£t
 : 12;

258 
u64
 
	mª£rved_100_103
 : 4;

259 
u64
 
	mbuf_size
 : 11;

260 
u64
 
	mª£rved_115_127
 : 13;

261 
u64
 
	m°ack_max_∑ges
 : 32;

262 
u64
 
	m°ack_∑ges
 : 32;

263 
u64
 
	m›_pc
 : 48;

264 
u64
 
	mª£rved_240_255
 : 16;

265 
u64
 
	m°ack_off£t
 : 4;

266 
u64
 
	mª£rved_260_263
 : 4;

267 
u64
 
	mshi·
 : 6;

268 
u64
 
	mª£rved_270_271
 : 2;

269 
u64
 
	mavg_Àvñ
 : 8;

270 
u64
 
	mavg_c⁄
 : 9;

271 
u64
 
	mfc_ía
 : 1;

272 
u64
 
	mfc_°y≥
 : 2;

273 
u64
 
	mfc_hy°_bôs
 : 4;

274 
u64
 
	mfc_up_¸ossög
 : 1;

275 
u64
 
	mfc_be
 : 1;

276 
u64
 
	mª£rved_298_299
 : 2;

277 
u64
 
	mupd©e_time
 : 16;

278 
u64
 
	mª£rved_316_319
 : 4;

279 
u64
 
	mfc_addr
;

280 
u64
 
	m±r_°¨t
;

281 
u64
 
	m±r_íd
;

282 
u64
 
	mª£rved_512_535
 : 24;

283 
u64
 
	mîr_öt
 : 8;

284 
u64
 
	mîr_öt_ía
 : 8;

285 
u64
 
	mthªsh_öt
 : 1;

286 
u64
 
	mthªsh_öt_ía
 : 1;

287 
u64
 
	mthªsh_up
 : 1;

288 
u64
 
	mª£rved_555
 : 1;

289 
u64
 
	mthªsh_qöt_idx
 : 7;

290 
u64
 
	mª£rved_563
 : 1;

291 
u64
 
	mîr_qöt_idx
 : 7;

292 
u64
 
	mª£rved_571_575
 : 5;

293 
u64
 
	mthªsh
 : 36;

294 
u64
 
	mrsvd_615_612
 : 4;

295 
u64
 
	mfc_msh_d°
 : 11;

296 
u64
 
	mª£rved_627_639
 : 13;

297 
u64
 
	mª£rved_640_703
;

298 
u64
 
	mª£rved_704_767
;

299 
u64
 
	mª£rved_768_831
;

300 
u64
 
	mª£rved_832_895
;

301 
u64
 
	mª£rved_896_959
;

302 
u64
 
	mª£rved_960_1023
;

306 
	enix_aq_comp
 {

307 
	mNIX_AQ_COMP_NOTDONE
 = 0x0,

308 
	mNIX_AQ_COMP_GOOD
 = 0x1,

309 
	mNIX_AQ_COMP_SWERR
 = 0x2,

310 
	mNIX_AQ_COMP_CTX_POISON
 = 0x3,

311 
	mNIX_AQ_COMP_CTX_FAULT
 = 0x4,

312 
	mNIX_AQ_COMP_LOCKERR
 = 0x5,

313 
	mNIX_AQ_COMP_SQB_ALLOC_FAIL
 = 0x6,

317 
	enix_aq_˘y≥
 {

318 
	mNIX_AQ_CTYPE_RQ
 = 0x0,

319 
	mNIX_AQ_CTYPE_SQ
 = 0x1,

320 
	mNIX_AQ_CTYPE_CQ
 = 0x2,

321 
	mNIX_AQ_CTYPE_MCE
 = 0x3,

322 
	mNIX_AQ_CTYPE_RSS
 = 0x4,

323 
	mNIX_AQ_CTYPE_DYNO
 = 0x5,

324 
	mNIX_AQ_CTYPE_BANDPROF
 = 0x6,

328 
	enix_aq_ö°›
 {

329 
	mNIX_AQ_INSTOP_NOP
 = 0x0,

330 
	mNIX_AQ_INSTOP_INIT
 = 0x1,

331 
	mNIX_AQ_INSTOP_WRITE
 = 0x2,

332 
	mNIX_AQ_INSTOP_READ
 = 0x3,

333 
	mNIX_AQ_INSTOP_LOCK
 = 0x4,

334 
	mNIX_AQ_INSTOP_UNLOCK
 = 0x5,

338 
	snix_aq_ö°_s
 {

339 
u64
 
	m›
 : 4;

340 
u64
 
	m˘y≥
 : 4;

341 
u64
 
	mlf
 : 9;

342 
u64
 
	mª£rved_17_23
 : 7;

343 
u64
 
	mcödex
 : 20;

344 
u64
 
	mª£rved_44_62
 : 19;

345 
u64
 
	md⁄eöt
 : 1;

346 
u64
 
	mªs_addr
;

350 
	snix_aq_ªs_s
 {

351 
u64
 
	m›
 : 4;

352 
u64
 
	m˘y≥
 : 4;

353 
u64
 
	mcompcode
 : 8;

354 
u64
 
	md⁄eöt
 : 1;

355 
u64
 
	mª£rved_17_63
 : 47;

356 
u64
 
	mª£rved_64_127
;

360 
	snix_cq_˘x_s
 {

361 
u64
 
	mba£
;

362 
u64
 
	mrsvd_64_67
 : 4;

363 
u64
 
	mbp_ía
 : 1;

364 
u64
 
	mrsvd_69_71
 : 3;

365 
u64
 
	mbpid
 : 9;

366 
u64
 
	mrsvd_81_83
 : 3;

367 
u64
 
	mqöt_idx
 : 7;

368 
u64
 
	mcq_îr
 : 1;

369 
u64
 
	mcöt_idx
 : 7;

370 
u64
 
	mavg_c⁄
 : 9;

371 
u64
 
	mwΩå
 : 20;

372 
u64
 
	mèû
 : 20;

373 
u64
 
	mhód
 : 20;

374 
u64
 
	mavg_Àvñ
 : 8;

375 
u64
 
	mupd©e_time
 : 16;

376 
u64
 
	mbp
 : 8;

377 
u64
 
	mdr›
 : 8;

378 
u64
 
	mdr›_ía
 : 1;

379 
u64
 
	mía
 : 1;

380 
u64
 
	mrsvd_210_211
 : 2;

381 
u64
 
	msub°ªam
 : 20;

382 
u64
 
	mˇchög
 : 1;

383 
u64
 
	mrsvd_233_235
 : 3;

384 
u64
 
	mqsize
 : 4;

385 
u64
 
	mcq_îr_öt
 : 8;

386 
u64
 
	mcq_îr_öt_ía
 : 8;

390 
	snix_˙10k_rq_˘x_s
 {

391 
u64
 
	mía
 : 1;

392 
u64
 
	msso_ía
 : 1;

393 
u64
 
	mù£ch_ía
 : 1;

394 
u64
 
	mía_wqwd
 : 1;

395 
u64
 
	mcq
 : 20;

396 
u64
 
	mrsvd_34_24
 : 11;

397 
u64
 
	mp‹t_ﬁ4_dis
 : 1;

398 
u64
 
	mp‹t_û4_dis
 : 1;

399 
u64
 
	mÀ√º_dis
 : 1;

400 
u64
 
	mcsum_û4_dis
 : 1;

401 
u64
 
	mcsum_ﬁ4_dis
 : 1;

402 
u64
 
	mÀn_û4_dis
 : 1;

403 
u64
 
	mÀn_û3_dis
 : 1;

404 
u64
 
	mÀn_ﬁ4_dis
 : 1;

405 
u64
 
	mÀn_ﬁ3_dis
 : 1;

406 
u64
 
	mwqe_auø
 : 20;

407 
u64
 
	m•b_auø
 : 20;

408 
u64
 
	mÕb_auø
 : 20;

409 
u64
 
	msso_gΩ
 : 10;

410 
u64
 
	msso_â
 : 2;

411 
u64
 
	mpb_ˇchög
 : 2;

412 
u64
 
	mwqe_ˇchög
 : 1;

413 
u64
 
	mxqe_dr›_ía
 : 1;

414 
u64
 
	m•b_dr›_ía
 : 1;

415 
u64
 
	mÕb_dr›_ía
 : 1;

416 
u64
 
	mpb_°ashög
 : 1;

417 
u64
 
	mù£cd_dr›_ía
 : 1;

418 
u64
 
	mchi_ía
 : 1;

419 
u64
 
	mrsvd_127_125
 : 3;

420 
u64
 
	mb™d_¥of_id
 : 10;

421 
u64
 
	mrsvd_138
 : 1;

422 
u64
 
	mpﬁi˚r_ía
 : 1;

423 
u64
 
	m•b_sizem1
 : 6;

424 
u64
 
	mwqe_skù
 : 2;

425 
u64
 
	mrsvd_150_148
 : 3;

426 
u64
 
	m•b_ía
 : 1;

427 
u64
 
	mÕb_sizem1
 : 12;

428 
u64
 
	mfú°_skù
 : 7;

429 
u64
 
	mrsvd_171
 : 1;

430 
u64
 
	mœãr_skù
 : 6;

431 
u64
 
	mxqe_imm_size
 : 6;

432 
u64
 
	mrsvd_189_184
 : 6;

433 
u64
 
	mxqe_imm_c›y
 : 1;

434 
u64
 
	mxqe_hdr_•lô
 : 1;

435 
u64
 
	mxqe_dr›
 : 8;

436 
u64
 
	mxqe_∑ss
 : 8;

437 
u64
 
	mwqe_poﬁ_dr›
 : 8;

438 
u64
 
	mwqe_poﬁ_∑ss
 : 8;

439 
u64
 
	m•b_auø_dr›
 : 8;

440 
u64
 
	m•b_auø_∑ss
 : 8;

441 
u64
 
	m•b_poﬁ_dr›
 : 8;

442 
u64
 
	m•b_poﬁ_∑ss
 : 8;

443 
u64
 
	mÕb_auø_dr›
 : 8;

444 
u64
 
	mÕb_auø_∑ss
 : 8;

445 
u64
 
	mÕb_poﬁ_dr›
 : 8;

446 
u64
 
	mÕb_poﬁ_∑ss
 : 8;

447 
u64
 
	mrsvd_291_288
 : 4;

448 
u64
 
	mrq_öt
 : 8;

449 
u64
 
	mrq_öt_ía
 : 8;

450 
u64
 
	mqöt_idx
 : 7;

451 
u64
 
	mrsvd_319_315
 : 5;

452 
u64
 
	m…ag
 : 24;

453 
u64
 
	mgood_uèg
 : 8;

454 
u64
 
	mbad_uèg
 : 8;

455 
u64
 
	mÊow_ègw
 : 6;

456 
u64
 
	mù£c_vwqe
 : 1;

457 
u64
 
	mvwqe_ía
 : 1;

458 
u64
 
	mvwqe_waô
 : 8;

459 
u64
 
	mmax_vsize_exp
 : 4;

460 
u64
 
	mvwqe_skù
 : 2;

461 
u64
 
	mrsvd_383_382
 : 2;

462 
u64
 
	mo˘s
 : 48;

463 
u64
 
	mrsvd_447_432
 : 16;

464 
u64
 
	mpkts
 : 48;

465 
u64
 
	mrsvd_511_496
 : 16;

466 
u64
 
	mdr›_o˘s
 : 48;

467 
u64
 
	mrsvd_575_560
 : 16;

468 
u64
 
	mdr›_pkts
 : 48;

469 
u64
 
	mrsvd_639_624
 : 16;

470 
u64
 
	mª_pkts
 : 48;

471 
u64
 
	mrsvd_703_688
 : 16;

472 
u64
 
	mrsvd_767_704
;

473 
u64
 
	mrsvd_831_768
;

474 
u64
 
	mrsvd_895_832
;

475 
u64
 
	mrsvd_959_896
;

476 
u64
 
	mrsvd_1023_960
;

480 
	snix_˙10k_sq_˘x_s
 {

481 
u64
 
	mía
 : 1;

482 
u64
 
	mqöt_idx
 : 6;

483 
u64
 
	msub°ªam
 : 20;

484 
u64
 
	msdp_mˇ°
 : 1;

485 
u64
 
	mcq
 : 20;

486 
u64
 
	msqe_way_mask
 : 16;

487 
u64
 
	msmq
 : 10;

488 
u64
 
	mcq_ía
 : 1;

489 
u64
 
	mxoff
 : 1;

490 
u64
 
	msso_ía
 : 1;

491 
u64
 
	msmq_º_weight
 : 14;

492 
u64
 
	mdeÁu…_ch™
 : 12;

493 
u64
 
	msqb_cou¡
 : 16;

494 
u64
 
	mrsvd_120_119
 : 2;

495 
u64
 
	msmq_º_cou¡_lb
 : 7;

496 
u64
 
	msmq_º_cou¡_ub
 : 25;

497 
u64
 
	msqb_auø
 : 20;

498 
u64
 
	msq_öt
 : 8;

499 
u64
 
	msq_öt_ía
 : 8;

500 
u64
 
	msqe_°y≥
 : 2;

501 
u64
 
	mrsvd_191
 : 1;

502 
u64
 
	mmax_sqe_size
 : 2;

503 
u64
 
	mcq_limô
 : 8;

504 
u64
 
	mlmt_dis
 : 1;

505 
u64
 
	mmnq_dis
 : 1;

506 
u64
 
	msmq_√xt_sq
 : 20;

507 
u64
 
	msmq_lso_£gnum
 : 8;

508 
u64
 
	mèû_off£t
 : 6;

509 
u64
 
	msmíq_off£t
 : 6;

510 
u64
 
	mhód_off£t
 : 6;

511 
u64
 
	msmíq_√xt_sqb_vld
 : 1;

512 
u64
 
	msmq_≥nd
 : 1;

513 
u64
 
	msmq_√xt_sq_vld
 : 1;

514 
u64
 
	mrsvd_255_253
 : 3;

515 
u64
 
	m√xt_sqb
 : 64;

516 
u64
 
	mèû_sqb
 : 64;

517 
u64
 
	msmíq_sqb
 : 64;

518 
u64
 
	msmíq_√xt_sqb
 : 64;

519 
u64
 
	mhód_sqb
 : 64;

520 
u64
 
	mrsvd_583_576
 : 8;

521 
u64
 
	mvfi_lso_tŸÆ
 : 18;

522 
u64
 
	mvfi_lso_sizem1
 : 3;

523 
u64
 
	mvfi_lso_sb
 : 8;

524 
u64
 
	mvfi_lso_mps
 : 14;

525 
u64
 
	mvfi_lso_vœn0_ös_ía
 : 1;

526 
u64
 
	mvfi_lso_vœn1_ös_ía
 : 1;

527 
u64
 
	mvfi_lso_vld
 : 1;

528 
u64
 
	mrsvd_639_630
 : 10;

529 
u64
 
	mscm_lso_ªm
 : 18;

530 
u64
 
	mrsvd_703_658
 : 46;

531 
u64
 
	mo˘s
 : 48;

532 
u64
 
	mrsvd_767_752
 : 16;

533 
u64
 
	mpkts
 : 48;

534 
u64
 
	mrsvd_831_816
 : 16;

535 
u64
 
	mrsvd_895_832
 : 64;

536 
u64
 
	mdr›≥d_o˘s
 : 48;

537 
u64
 
	mrsvd_959_944
 : 16;

538 
u64
 
	mdr›≥d_pkts
 : 48;

539 
u64
 
	mrsvd_1023_1008
 : 16;

543 
	snix_rq_˘x_s
 {

544 
u64
 
	mía
 : 1;

545 
u64
 
	msso_ía
 : 1;

546 
u64
 
	mù£ch_ía
 : 1;

547 
u64
 
	mía_wqwd
 : 1;

548 
u64
 
	mcq
 : 20;

549 
u64
 
	msub°ªam
 : 20;

550 
u64
 
	mwqe_auø
 : 20;

551 
u64
 
	m•b_auø
 : 20;

552 
u64
 
	mÕb_auø
 : 20;

553 
u64
 
	msso_gΩ
 : 10;

554 
u64
 
	msso_â
 : 2;

555 
u64
 
	mpb_ˇchög
 : 2;

556 
u64
 
	mwqe_ˇchög
 : 1;

557 
u64
 
	mxqe_dr›_ía
 : 1;

558 
u64
 
	m•b_dr›_ía
 : 1;

559 
u64
 
	mÕb_dr›_ía
 : 1;

560 
u64
 
	mrsvd_127_122
 : 6;

561 
u64
 
	mrsvd_139_128
 : 12;

562 
u64
 
	m•b_sizem1
 : 6;

563 
u64
 
	mwqe_skù
 : 2;

564 
u64
 
	mrsvd_150_148
 : 3;

565 
u64
 
	m•b_ía
 : 1;

566 
u64
 
	mÕb_sizem1
 : 12;

567 
u64
 
	mfú°_skù
 : 7;

568 
u64
 
	mrsvd_171
 : 1;

569 
u64
 
	mœãr_skù
 : 6;

570 
u64
 
	mxqe_imm_size
 : 6;

571 
u64
 
	mrsvd_189_184
 : 6;

572 
u64
 
	mxqe_imm_c›y
 : 1;

573 
u64
 
	mxqe_hdr_•lô
 : 1;

574 
u64
 
	mxqe_dr›
 : 8;

575 
u64
 
	mxqe_∑ss
 : 8;

576 
u64
 
	mwqe_poﬁ_dr›
 : 8;

577 
u64
 
	mwqe_poﬁ_∑ss
 : 8;

578 
u64
 
	m•b_auø_dr›
 : 8;

579 
u64
 
	m•b_auø_∑ss
 : 8;

580 
u64
 
	m•b_poﬁ_dr›
 : 8;

581 
u64
 
	m•b_poﬁ_∑ss
 : 8;

582 
u64
 
	mÕb_auø_dr›
 : 8;

583 
u64
 
	mÕb_auø_∑ss
 : 8;

584 
u64
 
	mÕb_poﬁ_dr›
 : 8;

585 
u64
 
	mÕb_poﬁ_∑ss
 : 8;

586 
u64
 
	mrsvd_291_288
 : 4;

587 
u64
 
	mrq_öt
 : 8;

588 
u64
 
	mrq_öt_ía
 : 8;

589 
u64
 
	mqöt_idx
 : 7;

590 
u64
 
	mrsvd_319_315
 : 5;

591 
u64
 
	m…ag
 : 24;

592 
u64
 
	mgood_uèg
 : 8;

593 
u64
 
	mbad_uèg
 : 8;

594 
u64
 
	mÊow_ègw
 : 6;

595 
u64
 
	mrsvd_383_366
 : 18;

596 
u64
 
	mo˘s
 : 48;

597 
u64
 
	mrsvd_447_432
 : 16;

598 
u64
 
	mpkts
 : 48;

599 
u64
 
	mrsvd_511_496
 : 16;

600 
u64
 
	mdr›_o˘s
 : 48;

601 
u64
 
	mrsvd_575_560
 : 16;

602 
u64
 
	mdr›_pkts
 : 48;

603 
u64
 
	mrsvd_639_624
 : 16;

604 
u64
 
	mª_pkts
 : 48;

605 
u64
 
	mrsvd_703_688
 : 16;

606 
u64
 
	mrsvd_767_704
;

607 
u64
 
	mrsvd_831_768
;

608 
u64
 
	mrsvd_895_832
;

609 
u64
 
	mrsvd_959_896
;

610 
u64
 
	mrsvd_1023_960
;

614 
	enix_maxsqesz
 {

615 
	mNIX_MAXSQESZ_W16
 = 0x0,

616 
	mNIX_MAXSQESZ_W8
 = 0x1,

620 
	enix_°y≥
 {

621 
	mNIX_STYPE_STF
 = 0x0,

622 
	mNIX_STYPE_STT
 = 0x1,

623 
	mNIX_STYPE_STP
 = 0x2,

627 
	snix_sq_˘x_s
 {

628 
u64
 
	mía
 : 1;

629 
u64
 
	mqöt_idx
 : 6;

630 
u64
 
	msub°ªam
 : 20;

631 
u64
 
	msdp_mˇ°
 : 1;

632 
u64
 
	mcq
 : 20;

633 
u64
 
	msqe_way_mask
 : 16;

634 
u64
 
	msmq
 : 9;

635 
u64
 
	mcq_ía
 : 1;

636 
u64
 
	mxoff
 : 1;

637 
u64
 
	msso_ía
 : 1;

638 
u64
 
	msmq_º_qu™tum
 : 24;

639 
u64
 
	mdeÁu…_ch™
 : 12;

640 
u64
 
	msqb_cou¡
 : 16;

641 
u64
 
	msmq_º_cou¡
 : 25;

642 
u64
 
	msqb_auø
 : 20;

643 
u64
 
	msq_öt
 : 8;

644 
u64
 
	msq_öt_ía
 : 8;

645 
u64
 
	msqe_°y≥
 : 2;

646 
u64
 
	mrsvd_191
 : 1;

647 
u64
 
	mmax_sqe_size
 : 2;

648 
u64
 
	mcq_limô
 : 8;

649 
u64
 
	mlmt_dis
 : 1;

650 
u64
 
	mmnq_dis
 : 1;

651 
u64
 
	msmq_√xt_sq
 : 20;

652 
u64
 
	msmq_lso_£gnum
 : 8;

653 
u64
 
	mèû_off£t
 : 6;

654 
u64
 
	msmíq_off£t
 : 6;

655 
u64
 
	mhód_off£t
 : 6;

656 
u64
 
	msmíq_√xt_sqb_vld
 : 1;

657 
u64
 
	msmq_≥nd
 : 1;

658 
u64
 
	msmq_√xt_sq_vld
 : 1;

659 
u64
 
	mrsvd_255_253
 : 3;

660 
u64
 
	m√xt_sqb
 : 64;

661 
u64
 
	mèû_sqb
 : 64;

662 
u64
 
	msmíq_sqb
 : 64;

663 
u64
 
	msmíq_√xt_sqb
 : 64;

664 
u64
 
	mhód_sqb
 : 64;

665 
u64
 
	mrsvd_583_576
 : 8;

666 
u64
 
	mvfi_lso_tŸÆ
 : 18;

667 
u64
 
	mvfi_lso_sizem1
 : 3;

668 
u64
 
	mvfi_lso_sb
 : 8;

669 
u64
 
	mvfi_lso_mps
 : 14;

670 
u64
 
	mvfi_lso_vœn0_ös_ía
 : 1;

671 
u64
 
	mvfi_lso_vœn1_ös_ía
 : 1;

672 
u64
 
	mvfi_lso_vld
 : 1;

673 
u64
 
	mrsvd_639_630
 : 10;

674 
u64
 
	mscm_lso_ªm
 : 18;

675 
u64
 
	mrsvd_703_658
 : 46;

676 
u64
 
	mo˘s
 : 48;

677 
u64
 
	mrsvd_767_752
 : 16;

678 
u64
 
	mpkts
 : 48;

679 
u64
 
	mrsvd_831_816
 : 16;

680 
u64
 
	mrsvd_895_832
 : 64;

681 
u64
 
	mdr›≥d_o˘s
 : 48;

682 
u64
 
	mrsvd_959_944
 : 16;

683 
u64
 
	mdr›≥d_pkts
 : 48;

684 
u64
 
	mrsvd_1023_1008
 : 16;

688 
	snix_rs£_s
 {

689 
uöt32_t
 
	mrq
 : 20;

690 
uöt32_t
 
	mª£rved_20_31
 : 12;

695 
	snix_rx_m˚_s
 {

696 
uöt64_t
 
	m›
 : 2;

697 
uöt64_t
 
	mrsvd_2
 : 1;

698 
uöt64_t
 
	meﬁ
 : 1;

699 
uöt64_t
 
	mödex
 : 20;

700 
uöt64_t
 
	mrsvd_31_24
 : 8;

701 
uöt64_t
 
	mpf_func
 : 16;

702 
uöt64_t
 
	m√xt
 : 16;

705 
	enix_b™d_¥of_œyîs
 {

706 
	mBAND_PROF_LEAF_LAYER
 = 0,

707 
	mBAND_PROF_INVAL_LAYER
 = 1,

708 
	mBAND_PROF_MID_LAYER
 = 2,

709 
	mBAND_PROF_TOP_LAYER
 = 3,

710 
	mBAND_PROF_NUM_LAYERS
 = 4,

713 
	eNIX_RX_BAND_PROF_ACTIONRESULT_E
 {

714 
	mNIX_RX_BAND_PROF_ACTIONRESULT_PASS
 = 0x0,

715 
	mNIX_RX_BAND_PROF_ACTIONRESULT_DROP
 = 0x1,

716 
	mNIX_RX_BAND_PROF_ACTIONRESULT_RED
 = 0x2,

719 
	enix_b™d_¥of_pc_mode
 {

720 
	mNIX_RX_PC_MODE_VLAN
 = 0,

721 
	mNIX_RX_PC_MODE_DSCP
 = 1,

722 
	mNIX_RX_PC_MODE_GEN
 = 2,

723 
	mNIX_RX_PC_MODE_RSVD
 = 3,

727 
	snix_b™d¥of_s
 {

728 
uöt64_t
 
	mpc_mode
 : 2;

729 
uöt64_t
 
	micﬁ‹
 : 2;

730 
uöt64_t
 
	mäl_ía
 : 1;

731 
uöt64_t
 
	mª£rved_5_7
 : 3;

732 
uöt64_t
 
	m≥ú_exp⁄ít
 : 5;

733 
uöt64_t
 
	mª£rved_13_15
 : 3;

734 
uöt64_t
 
	m≥bs_exp⁄ít
 : 5;

735 
uöt64_t
 
	mª£rved_21_23
 : 3;

736 
uöt64_t
 
	mcú_exp⁄ít
 : 5;

737 
uöt64_t
 
	mª£rved_29_31
 : 3;

738 
uöt64_t
 
	mcbs_exp⁄ít
 : 5;

739 
uöt64_t
 
	mª£rved_37_39
 : 3;

740 
uöt64_t
 
	m≥ú_m™tisß
 : 8;

741 
uöt64_t
 
	m≥bs_m™tisß
 : 8;

742 
uöt64_t
 
	mcú_m™tisß
 : 8;

743 
uöt64_t
 
	mcbs_m™tisß
 : 8;

744 
uöt64_t
 
	mlmode
 : 1;

745 
uöt64_t
 
	ml_£Œe˘
 : 3;

746 
uöt64_t
 
	mrdiv
 : 4;

747 
uöt64_t
 
	madju°_exp⁄ít
 : 5;

748 
uöt64_t
 
	mª£rved_85_86
 : 2;

749 
uöt64_t
 
	madju°_m™tisß
 : 9;

750 
uöt64_t
 
	mgc_a˘i⁄
 : 2;

751 
uöt64_t
 
	myc_a˘i⁄
 : 2;

752 
uöt64_t
 
	mrc_a˘i⁄
 : 2;

753 
uöt64_t
 
	mmëî_Ægo
 : 2;

754 
uöt64_t
 
	mb™d_¥of_id
 : 7;

755 
uöt64_t
 
	mª£rved_111_118
 : 8;

756 
uöt64_t
 
	mhl_í
 : 1;

757 
uöt64_t
 
	mª£rved_120_127
 : 8;

758 
uöt64_t
 
	mts
 : 48;

759 
uöt64_t
 
	mª£rved_176_191
 : 16;

760 
uöt64_t
 
	m≥_accum
 : 32;

761 
uöt64_t
 
	mc_accum
 : 32;

762 
uöt64_t
 
	mgªí_pkt_∑ss
 : 48;

763 
uöt64_t
 
	mª£rved_304_319
 : 16;

764 
uöt64_t
 
	myñlow_pkt_∑ss
 : 48;

765 
uöt64_t
 
	mª£rved_368_383
 : 16;

766 
uöt64_t
 
	mªd_pkt_∑ss
 : 48;

767 
uöt64_t
 
	mª£rved_432_447
 : 16;

768 
uöt64_t
 
	mgªí_o˘s_∑ss
 : 48;

769 
uöt64_t
 
	mª£rved_496_511
 : 16;

770 
uöt64_t
 
	myñlow_o˘s_∑ss
 : 48;

771 
uöt64_t
 
	mª£rved_560_575
 : 16;

772 
uöt64_t
 
	mªd_o˘s_∑ss
 : 48;

773 
uöt64_t
 
	mª£rved_624_639
 : 16;

774 
uöt64_t
 
	mgªí_pkt_dr›
 : 48;

775 
uöt64_t
 
	mª£rved_688_703
 : 16;

776 
uöt64_t
 
	myñlow_pkt_dr›
 : 48;

777 
uöt64_t
 
	mª£rved_752_767
 : 16;

778 
uöt64_t
 
	mªd_pkt_dr›
 : 48;

779 
uöt64_t
 
	mª£rved_816_831
 : 16;

780 
uöt64_t
 
	mgªí_o˘s_dr›
 : 48;

781 
uöt64_t
 
	mª£rved_880_895
 : 16;

782 
uöt64_t
 
	myñlow_o˘s_dr›
 : 48;

783 
uöt64_t
 
	mª£rved_944_959
 : 16;

784 
uöt64_t
 
	mªd_o˘s_dr›
 : 48;

785 
uöt64_t
 
	mª£rved_1008_1023
 : 16;

788 
	enix_lsﬂlg
 {

789 
	mNIX_LSOALG_NOP
,

790 
	mNIX_LSOALG_ADD_SEGNUM
,

791 
	mNIX_LSOALG_ADD_PAYLEN
,

792 
	mNIX_LSOALG_ADD_OFFSET
,

793 
	mNIX_LSOALG_TCP_FLAGS
,

796 
	enix_txœyî
 {

797 
	mNIX_TXLAYER_OL3
,

798 
	mNIX_TXLAYER_OL4
,

799 
	mNIX_TXLAYER_IL3
,

800 
	mNIX_TXLAYER_IL4
,

803 
	snix_lso_f‹m©
 {

804 
u64
 
	moff£t
 : 8;

805 
u64
 
	mœyî
 : 2;

806 
u64
 
	mrsvd_10_11
 : 2;

807 
u64
 
	msizem1
 : 2;

808 
u64
 
	mrsvd_14_15
 : 2;

809 
u64
 
	mÆg
 : 3;

810 
u64
 
	mrsvd_19_63
 : 45;

813 
	snix_rx_Êowkey_Æg
 {

814 
u64
 
	mkey_off£t
 :6;

815 
u64
 
	m _mask
 :1;

816 
u64
 
	m‚_mask
 :1;

817 
u64
 
	mhdr_off£t
 :8;

818 
u64
 
	mbyãsm1
 :5;

819 
u64
 
	mlid
 :3;

820 
u64
 
	mª£rved_24_24
 :1;

821 
u64
 
	mía
 :1;

822 
u64
 
	m£l_ch™
 :1;

823 
u64
 
	m…y≥_mask
 :4;

824 
u64
 
	m…y≥_m©ch
 :4;

825 
u64
 
	mª£rved_35_63
 :29;

829 
	enix_vèg_size
 {

830 
	mVTAGSIZE_T4
 = 0x0,

831 
	mVTAGSIZE_T8
 = 0x1,

834 
	enix_tx_vèg_›
 {

835 
	mNOP
 = 0x0,

836 
	mVTAG_INSERT
 = 0x1,

837 
	mVTAG_REPLACE
 = 0x2,

841 
	#VTAG_STRIP
 
	`BIT_ULL
(4)

	)

842 
	#VTAG_CAPTURE
 
	`BIT_ULL
(5)

	)

845 
	sªe_af_aq_ö°_s
 {

846 
u64
 
	mrof_±r_addr
;

847 
u64
 
	mª£rved_64_64
 : 1;

848 
u64
 
	mnc
 : 1;

849 
u64
 
	mª£rved_66_66
 : 1;

850 
u64
 
	md⁄eöt
 : 1;

851 
u64
 
	mª£rved_68_95
 : 28;

852 
u64
 
	mÀngth
 : 15;

853 
u64
 
	mª£rved_111_127
 : 17;

857 
	sªe_rof_s
 {

858 
u64
 
	maddr
 : 24;

859 
u64
 
	mª£rved_24_31
 : 8;

860 
u64
 
	mtyp
 : 8;

861 
u64
 
	mª£rved_40_63
 : 24;

862 
u64
 
	md©a
;

	@rvu_switch.c

8 
	~<löux/bôfõld.h
>

9 
	~"rvu.h
"

11 
	$rvu_swôch_íabÀ_lbk_lök
(
rvu
 *rvu, 
u16
 
pcifunc
, 
boﬁ
 
íabÀ
)

13 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

14 
nix_hw
 *nix_hw;

16 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
pfvf
->
nix_blkaddr
);

18 
	`rvu_nix_tx_é2_cfg
(
rvu
, 
pfvf
->
nix_blkaddr
, 
pcifunc
,

19 &
nix_hw
->
txsch
[
NIX_TXSCH_LVL_TL2
], 
íabÀ
);

20 
	}
}

22 
	$rvu_swôch_ö°Æl_rx_ruÀ
(
rvu
 *rvu, 
u16
 
pcifunc
,

23 
u16
 
ch™_mask
)

25 
≈c_ö°Æl_Êow_ªq
 
ªq
 = { 0 };

26 
≈c_ö°Æl_Êow_r•
 
r•
 = { 0 };

27 
rvu_pfvf
 *
pfvf
;

29 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

34 i‡(!
	`ã°_bô
(
NIXLF_INITIALIZED
, &
pfvf
->
Êags
))

37 
	`ëhî_addr_c›y
(
ªq
.
∑ckë
.
dmac
, 
pfvf
->
mac_addr
);

38 
	`ëh_brﬂdˇ°_addr
((
u8
 *)&
ªq
.
mask
.
dmac
);

39 
ªq
.
hdr
.
pcifunc
 = 0;

40 
ªq
.
vf
 = 
pcifunc
;

41 
ªq
.
„©uªs
 = 
	`BIT_ULL
(
NPC_DMAC
);

42 
ªq
.
ch™√l
 = 
pfvf
->
rx_ch™_ba£
;

43 
ªq
.
ch™_mask
 = chan_mask;

44 
ªq
.
ötf
 = 
pfvf
->
nix_rx_ötf
;

45 
ªq
.
›
 = 
NIX_RX_ACTION_DEFAULT
;

46 
ªq
.
deÁu…_ruÀ
 = 1;

48  
	`rvu_mbox_h™dÀr_≈c_ö°Æl_Êow
(
rvu
, &
ªq
, &
r•
);

49 
	}
}

51 
	$rvu_swôch_ö°Æl_tx_ruÀ
(
rvu
 *rvu, 
u16
 
pcifunc
, u16 
íåy
)

53 
≈c_ö°Æl_Êow_ªq
 
ªq
 = { 0 };

54 
≈c_ö°Æl_Êow_r•
 
r•
 = { 0 };

55 
rvu_pfvf
 *
pfvf
;

56 
u8
 
lbkid
;

58 
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

63 i‡(!
	`ã°_bô
(
NIXLF_INITIALIZED
, &
pfvf
->
Êags
))

66 
	`rvu_swôch_íabÀ_lbk_lök
(
rvu
, 
pcifunc
, 
åue
);

68 
lbkid
 = 
pfvf
->
nix_blkaddr
 =
BLKADDR_NIX0
 ? 0 : 1;

69 
	`ëhî_addr_c›y
(
ªq
.
∑ckë
.
dmac
, 
pfvf
->
mac_addr
);

70 
	`ëh_brﬂdˇ°_addr
((
u8
 *)&
ªq
.
mask
.
dmac
);

71 
ªq
.
hdr
.
pcifunc
 = 0;

72 
ªq
.
vf
 = 
pcifunc
;

73 
ªq
.
íåy
 =Éntry;

74 
ªq
.
„©uªs
 = 
	`BIT_ULL
(
NPC_DMAC
);

75 
ªq
.
ötf
 = 
pfvf
->
nix_tx_ötf
;

76 
ªq
.
›
 = 
NIX_TX_ACTIONOP_UCAST_CHAN
;

77 
ªq
.
ödex
 = (
lbkid
 << 8Ë| 
RVU_SWITCH_LBK_CHAN
;

78 
ªq
.
£t_˙å
 = 1;

80  
	`rvu_mbox_h™dÀr_≈c_ö°Æl_Êow
(
rvu
, &
ªq
, &
r•
);

81 
	}
}

83 
	$rvu_swôch_ö°Æl_ruÀs
(
rvu
 *rvu)

85 
rvu_swôch
 *
rswôch
 = &
rvu
->rswitch;

86 
u16
 
°¨t
 = 
rswôch
->
°¨t_íåy
;

87 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

88 
pf
, 
vf
, 
numvfs
, 
hwvf
;

89 
u16
 
pcifunc
, 
íåy
 = 0;

90 
îr
;

92 
pf
 = 1;Ö‡< 
hw
->
tŸÆ_pfs
;Öf++) {

93 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

96 
pcifunc
 = 
pf
 << 10;

103 
	`rvu_gë_nix_blkaddr
(
rvu
, 
pcifunc
);

111 
îr
 = 
	`rvu_swôch_ö°Æl_rx_ruÀ
(
rvu
, 
pcifunc
, 0x0);

112 i‡(
îr
) {

113 
	`dev_îr
(
rvu
->
dev
, "RXÑule for PF%d failed(%d)\n",

114 
pf
, 
îr
);

115  
îr
;

118 
îr
 = 
	`rvu_swôch_ö°Æl_tx_ruÀ
(
rvu
, 
pcifunc
, 
°¨t
 + 
íåy
);

119 i‡(
îr
) {

120 
	`dev_îr
(
rvu
->
dev
, "TXÑule for PF%d failed(%d)\n",

121 
pf
, 
îr
);

122  
îr
;

125 
rswôch
->
íåy2pcifunc
[
íåy
++] = 
pcifunc
;

127 
	`rvu_gë_pf_numvfs
(
rvu
, 
pf
, &
numvfs
, &
hwvf
);

128 
vf
 = 0; v‡< 
numvfs
; vf++, 
hwvf
++) {

129 
pcifunc
 = 
pf
 << 10 | ((
vf
 + 1) & 0x3FF);

130 
	`rvu_gë_nix_blkaddr
(
rvu
, 
pcifunc
);

132 
îr
 = 
	`rvu_swôch_ö°Æl_rx_ruÀ
(
rvu
, 
pcifunc
, 0x0);

133 i‡(
îr
) {

134 
	`dev_îr
(
rvu
->
dev
,

136 
pf
, 
vf
, 
îr
);

137  
îr
;

140 
îr
 = 
	`rvu_swôch_ö°Æl_tx_ruÀ
(
rvu
, 
pcifunc
,

141 
°¨t
 + 
íåy
);

142 i‡(
îr
) {

143 
	`dev_îr
(
rvu
->
dev
,

145 
pf
, 
vf
, 
îr
);

146  
îr
;

149 
rswôch
->
íåy2pcifunc
[
íåy
++] = 
pcifunc
;

154 
	}
}

156 
	$rvu_swôch_íabÀ
(
rvu
 *rvu)

158 
≈c_mˇm_Æloc_íåy_ªq
 
Æloc_ªq
 = { 0 };

159 
≈c_mˇm_Æloc_íåy_r•
 
Æloc_r•
 = { 0 };

160 
≈c_dñëe_Êow_ªq
 
unö°Æl_ªq
 = { 0 };

161 
≈c_mˇm_‰ì_íåy_ªq
 
‰ì_ªq
 = { 0 };

162 
rvu_swôch
 *
rswôch
 = &
rvu
->rswitch;

163 
msg_r•
 
r•
;

164 
ªt
;

166 
Æloc_ªq
.
c⁄tig
 = 
åue
;

167 
Æloc_ªq
.
cou¡
 = 
rvu
->
cgx_m≠≥d_pfs
 +Ñvu->
cgx_m≠≥d_vfs
;

168 
ªt
 = 
	`rvu_mbox_h™dÀr_≈c_mˇm_Æloc_íåy
(
rvu
, &
Æloc_ªq
,

169 &
Æloc_r•
);

170 i‡(
ªt
) {

171 
	`dev_îr
(
rvu
->
dev
,

173 
exô
;

176 i‡(
Æloc_r•
.
cou¡
 !
Æloc_ªq
.count) {

177 
	`dev_îr
(
rvu
->
dev
,

179 
Æloc_ªq
.
cou¡
, 
Æloc_r•
.count);

180 
‰ì_íåõs
;

183 
rswôch
->
íåy2pcifunc
 = 
	`kˇŒoc
(
Æloc_ªq
.
cou¡
, (
u16
),

184 
GFP_KERNEL
);

185 i‡(!
rswôch
->
íåy2pcifunc
)

186 
‰ì_íåõs
;

188 
rswôch
->
u£d_íåõs
 = 
Æloc_r•
.
cou¡
;

189 
rswôch
->
°¨t_íåy
 = 
Æloc_r•
.
íåy
;

191 
ªt
 = 
	`rvu_swôch_ö°Æl_ruÀs
(
rvu
);

192 i‡(
ªt
)

193 
unö°Æl_ruÀs
;

197 
unö°Æl_ruÀs
:

198 
unö°Æl_ªq
.
°¨t
 = 
rswôch
->
°¨t_íåy
;

199 
unö°Æl_ªq
.
íd
 = 
rswôch
->
°¨t_íåy
 +Ñswôch->
u£d_íåõs
 - 1;

200 
	`rvu_mbox_h™dÀr_≈c_dñëe_Êow
(
rvu
, &
unö°Æl_ªq
, &
r•
);

201 
	`k‰ì
(
rswôch
->
íåy2pcifunc
);

202 
‰ì_íåõs
:

203 
‰ì_ªq
.
Æl
 = 1;

204 
	`rvu_mbox_h™dÀr_≈c_mˇm_‰ì_íåy
(
rvu
, &
‰ì_ªq
, &
r•
);

205 
exô
:

207 
	}
}

209 
	$rvu_swôch_dißbÀ
(
rvu
 *rvu)

211 
≈c_dñëe_Êow_ªq
 
unö°Æl_ªq
 = { 0 };

212 
≈c_mˇm_‰ì_íåy_ªq
 
‰ì_ªq
 = { 0 };

213 
rvu_swôch
 *
rswôch
 = &
rvu
->rswitch;

214 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

215 
pf
, 
vf
, 
numvfs
, 
hwvf
;

216 
msg_r•
 
r•
;

217 
u16
 
pcifunc
;

218 
îr
;

220 i‡(!
rswôch
->
u£d_íåõs
)

223 
pf
 = 1;Ö‡< 
hw
->
tŸÆ_pfs
;Öf++) {

224 i‡(!
	`is_pf_cgxm≠≥d
(
rvu
, 
pf
))

227 
pcifunc
 = 
pf
 << 10;

228 
îr
 = 
	`rvu_swôch_ö°Æl_rx_ruÀ
(
rvu
, 
pcifunc
, 0xFFF);

229 i‡(
îr
)

230 
	`dev_îr
(
rvu
->
dev
,

232 
pf
, 
îr
);

235 
	`rvu_swôch_íabÀ_lbk_lök
(
rvu
, 
pcifunc
, 
Ál£
);

237 
	`rvu_gë_pf_numvfs
(
rvu
, 
pf
, &
numvfs
, &
hwvf
);

238 
vf
 = 0; v‡< 
numvfs
; vf++, 
hwvf
++) {

239 
pcifunc
 = 
pf
 << 10 | ((
vf
 + 1) & 0x3FF);

240 
îr
 = 
	`rvu_swôch_ö°Æl_rx_ruÀ
(
rvu
, 
pcifunc
, 0xFFF);

241 i‡(
îr
)

242 
	`dev_îr
(
rvu
->
dev
,

244 
pf
, 
vf
, 
îr
);

246 
	`rvu_swôch_íabÀ_lbk_lök
(
rvu
, 
pcifunc
, 
Ál£
);

250 
unö°Æl_ªq
.
°¨t
 = 
rswôch
->
°¨t_íåy
;

251 
unö°Æl_ªq
.
íd
 = 
rswôch
->
°¨t_íåy
 +Ñswôch->
u£d_íåõs
 - 1;

252 
‰ì_ªq
.
Æl
 = 1;

253 
	`rvu_mbox_h™dÀr_≈c_dñëe_Êow
(
rvu
, &
unö°Æl_ªq
, &
r•
);

254 
	`rvu_mbox_h™dÀr_≈c_mˇm_‰ì_íåy
(
rvu
, &
‰ì_ªq
, &
r•
);

255 
rswôch
->
u£d_íåõs
 = 0;

256 
	`k‰ì
(
rswôch
->
íåy2pcifunc
);

257 
	}
}

259 
	$rvu_swôch_upd©e_ruÀs
(
rvu
 *rvu, 
u16
 
pcifunc
)

261 
rvu_swôch
 *
rswôch
 = &
rvu
->rswitch;

262 
u32
 
max
 = 
rswôch
->
u£d_íåõs
;

263 
u16
 
íåy
;

265 i‡(!
rswôch
->
u£d_íåõs
)

268 
íåy
 = 0;É¡ry < 
max
;Éntry++) {

269 i‡(
rswôch
->
íåy2pcifunc
[
íåy
] =
pcifunc
)

273 i‡(
íåy
 >
max
)

276 
	`rvu_swôch_ö°Æl_tx_ruÀ
(
rvu
, 
pcifunc
, 
rswôch
->
°¨t_íåy
 + 
íåy
);

277 
	`rvu_swôch_ö°Æl_rx_ruÀ
(
rvu
, 
pcifunc
, 0x0);

278 
	}
}

	@rvu_tim.c

8 
	~<löux/öãºu±.h
>

9 
	~<löux/úq.h
>

10 
	~<löux/ty≥s.h
>

11 
	~<löux/bôfõld.h
>

13 
	~"rvu_°ru˘.h
"

14 
	~"rvu_ªg.h
"

15 
	~"rvu.h
"

17 
	#TIM_CHUNKSIZE_MULTIPLE
 (16)

	)

18 
	#TIM_CHUNKSIZE_MIN
 (
TIM_CHUNKSIZE_MULTIPLE
 * 0x2)

	)

19 
	#TIM_CHUNKSIZE_MAX
 (
TIM_CHUNKSIZE_MULTIPLE
 * 0x1FFF)

	)

21 
ölöe
 
u64
 
	$gë_ã¬s_˛k
()

23 
u64
 
tsc
 = 0;

25 #i‡
	`deföed
(
CONFIG_ARM64
)

26 
asm
 vﬁ©ûe("mr†%0, c¡‰q_ñ0" : "Ù" (
tsc
));

28  
tsc
;

29 
	}
}

31 
ölöe
 
	$tim_block_˙10k_öô
(
rvu
 *rvu)

33 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

34 
lf
, 
blkaddr
;

36 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
, 0);

37 i‡(
blkaddr
 < 0)

38  
blkaddr
;

39 
hw
->
tim
.
rög_ötvls
 = 
	`kmÆloc_¨øy
(hw->
block
[
blkaddr
].
lf
.
max
,

40 (
tim_rög_öãrvÆ
),

41 
GFP_KERNEL
);

42 i‡(!
hw
->
tim
.
rög_ötvls
)

43  -
ENOMEM
;

45 
lf
 = 0;Ü‡< 
hw
->
block
[
blkaddr
].lf.
max
;Üf++)

46 
hw
->
tim
.
rög_ötvls
[
lf
] = 
TIM_INTERVAL_INVAL
;

47 
hw
->
tim
.
rögs_≥r_ötvl
[
TIM_INTERVAL_1US
] = 0;

48 
hw
->
tim
.
rögs_≥r_ötvl
[
TIM_INTERVAL_10US
] = 0;

49 
hw
->
tim
.
rögs_≥r_ötvl
[
TIM_INTERVAL_1MS
] = 0;

52 
	}
}

54 
ölöe
 
	$tim_˙10k_˛ór_ötvl
(
rvu
 *rvu, 
lf
)

56 
tim_r§c
 *
tim
 = &
rvu
->
hw
->tim;

58 i‡(
tim
->
rög_ötvls
[
lf
] !
TIM_INTERVAL_INVAL
) {

59 
tim
->
rögs_≥r_ötvl
[tim->
rög_ötvls
[
lf
]]--;

60 
tim
->
rög_ötvls
[
lf
] = 
TIM_INTERVAL_INVAL
;

62 
	}
}

64 
ölöe
 
	$tim_˙10k_ªc‹d_ötvl
(
rvu
 *rvu, 
lf
,

65 
u64
 
öãrvÆns
)

67 
tim_r§c
 *
tim
 = &
rvu
->
hw
->tim;

68 
tim_rög_öãrvÆ
 
ötvl
;

70 
	`tim_˙10k_˛ór_ötvl
(
rvu
, 
lf
);

72 i‡(
öãrvÆns
 < (
u64
)1E4)

73 
ötvl
 = 
TIM_INTERVAL_1US
;

74 i‡(
öãrvÆns
 < (
u64
)1E6)

75 
ötvl
 = 
TIM_INTERVAL_10US
;

77 
ötvl
 = 
TIM_INTERVAL_1MS
;

79 
tim
->
rög_ötvls
[
lf
] = 
ötvl
;

80 
tim
->
rögs_≥r_ötvl
[tim->
rög_ötvls
[
lf
]]++;

81 
	}
}

83 
ölöe
 
	$tim_gë_mö_ötvl
(
rvu
 *rvu, 
u8
 
˛ocksour˚
,

84 
u64
 
˛ock‰eq
, u64 *
ötvl_ns
,

85 
u64
 *
ötvl_cyc
)

87 
tim_r§c
 *
tim
 = &
rvu
->
hw
->tim;

88 
ötvl
;

90 i‡(
	`is_rvu_Ÿx2
(
rvu
)) {

91 
˛ocksour˚
) {

92 
TIM_CLK_SRCS_TENNS
:

93 
ötvl
 = 200;

95 
TIM_CLK_SRCS_GPIO
:

96 
ötvl
 = 256;

98 
TIM_CLK_SRCS_GTI
:

99 
TIM_CLK_SRCS_PTP
:

100 
ötvl
 = 300;

103  
TIM_AF_INVALID_CLOCK_SOURCE
;

106 *
ötvl_cyc
 = (
u64
)
ötvl
;

108 i‡(
tim
->
rögs_≥r_ötvl
[
TIM_INTERVAL_1US
] < 8)

109 
ötvl
 = (
u64
)1E3;

110 i‡(
tim
->
rögs_≥r_ötvl
[
TIM_INTERVAL_10US
] < 8)

111 
ötvl
 = (
u64
)1E4;

113 
ötvl
 = (
u64
)1E6;

115 *
ötvl_cyc
 = (
u64
)
	`DIV_ROUND_UP
(
˛ock‰eq
 * (
ötvl
), (u64)1E9);

118 *
ötvl_ns
 = (
u64
)
	`DIV_ROUND_UP
((*
ötvl_cyc
Ë* (u64)1E9, 
˛ock‰eq
);

121 
	}
}

123 
	$rvu_tim_dißbÀ_lf
(
rvu
 *rvu, 
lf
, 
blkaddr
)

125 
u64
 
ªgvÆ
;

127 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

128 
	`tim_˙10k_˛ór_ötvl
(
rvu
, 
lf
);

130 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
));

131 i‡((
ªgvÆ
 & 
TIM_AF_RINGX_CTL1_ENA
) == 0)

132  
TIM_AF_RING_ALREADY_DISABLED
;

135 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
));

136 
ªgvÆ
 &~
TIM_AF_RINGX_CTL1_ENA
;

137 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
), 
ªgvÆ
);

143 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
),

144 
TIM_AF_RINGX_CTL1_RCF_BUSY
, 
åue
);

147 
	}
}

149 
	$rvu_mbox_h™dÀr_tim_gë_mö_ötvl
(
rvu
 *rvu,

150 
tim_ötvl_ªq
 *
ªq
,

151 
tim_ötvl_r•
 *
r•
)

153 i‡(!
ªq
->
˛ock‰eq
)

154  
TIM_AF_INVALID_CLOCK_SOURCE
;

156  
	`tim_gë_mö_ötvl
(
rvu
, 
ªq
->
˛ocksour˚
,Ñeq->
˛ock‰eq
,

157 &
r•
->
ötvl_ns
, &r•->
ötvl_cyc
);

158 
	}
}

160 
	$rvu_mbox_h™dÀr_tim_lf_Æloc
(
rvu
 *rvu,

161 
tim_lf_Æloc_ªq
 *
ªq
,

162 
tim_lf_Æloc_r•
 *
r•
)

164 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

165 
lf
, 
blkaddr
;

166 
u64
 
ªgvÆ
;

168 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
, 
pcifunc
);

169 i‡(
blkaddr
 < 0)

170  
TIM_AF_LF_INVALID
;

172 
lf
 = 
	`rvu_gë_lf
(
rvu
, &rvu->
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
rög
);

173 i‡(
lf
 < 0)

174  
TIM_AF_LF_INVALID
;

177 i‡(
ªq
->
≈a_pf_func
) {

179 i‡(
ªq
->
≈a_pf_func
 =
RVU_DEFAULT_PF_FUNC
)

180 
ªq
->
≈a_pf_func
 = 
pcifunc
;

181 i‡(!
	`is_pffunc_m≠_vÆid
(
rvu
, 
ªq
->
≈a_pf_func
, 
BLKTYPE_NPA
))

182  
TIM_AF_INVAL_NPA_PF_FUNC
;

186 i‡(
ªq
->
sso_pf_func
) {

188 i‡(
ªq
->
sso_pf_func
 =
RVU_DEFAULT_PF_FUNC
)

189 
ªq
->
sso_pf_func
 = 
pcifunc
;

190 i‡(!
	`is_pffunc_m≠_vÆid
(
rvu
, 
ªq
->
sso_pf_func
, 
BLKTYPE_SSO
))

191  
TIM_AF_INVAL_SSO_PF_FUNC
;

194 
ªgvÆ
 = (((
u64
)
ªq
->
≈a_pf_func
) << 16) |

195 ((
u64
)
ªq
->
sso_pf_func
);

196 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_GMCTL
(
lf
), 
ªgvÆ
);

198 
r•
->
ã¬s_˛k
 = 
	`gë_ã¬s_˛k
();

201 
	}
}

203 
	$rvu_mbox_h™dÀr_tim_lf_‰ì
(
rvu
 *rvu,

204 
tim_rög_ªq
 *
ªq
,

205 
msg_r•
 *
r•
)

207 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

208 
lf
, 
blkaddr
;

210 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
, 
pcifunc
);

211 i‡(
blkaddr
 < 0)

212  
TIM_AF_LF_INVALID
;

214 
lf
 = 
	`rvu_gë_lf
(
rvu
, &rvu->
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
rög
);

215 i‡(
lf
 < 0)

216  
TIM_AF_LF_INVALID
;

218 
	`rvu_tim_lf_ã¨down
(
rvu
, 
pcifunc
, 
lf
, 
ªq
->
rög
);

221 
	}
}

223 
	$rvu_mbox_h™dÀr_tim_c⁄fig_rög
(
rvu
 *rvu,

224 
tim_c⁄fig_ªq
 *
ªq
,

225 
msg_r•
 *
r•
)

227 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

228 
u64
 
ötvl_cyc
, 
ötvl_ns
;

229 
lf
, 
blkaddr
;

230 
u64
 
ªgvÆ
;

231 
rc
;

233 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
, 
pcifunc
);

234 i‡(
blkaddr
 < 0)

235  
TIM_AF_LF_INVALID
;

237 
lf
 = 
	`rvu_gë_lf
(
rvu
, &rvu->
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
rög
);

238 i‡(
lf
 < 0)

239  
TIM_AF_LF_INVALID
;

243 i‡(
ªq
->
bigídün
 & ~1)

244  
TIM_AF_INVALID_BIG_ENDIAN_VALUE
;

247 i‡(
ªq
->
íabÀ≥riodic
 & ~1)

248  
TIM_AF_INVALID_ENABLE_PERIODIC
;

251 i‡(
ªq
->
íabÀd⁄t‰ìbuf„r
 & ~1)

252  
TIM_AF_INVALID_ENABLE_DONTFREE
;

258 i‡(
ªq
->
íabÀ≥riodic
 && !ªq->
íabÀd⁄t‰ìbuf„r
)

259  
TIM_AF_ENA_DONTFRE_NSET_PERIODIC
;

263 i‡(
ªq
->
buckësize
 < 2 ||Ñeq->bucketsize > 1<<20)

264  
TIM_AF_INVALID_BSIZE
;

266 i‡(
ªq
->
chunksize
 % 
TIM_CHUNKSIZE_MULTIPLE
)

267  
TIM_AF_CSIZE_NOT_ALIGNED
;

269 i‡(
ªq
->
chunksize
 < 
TIM_CHUNKSIZE_MIN
)

270  
TIM_AF_CSIZE_TOO_SMALL
;

272 i‡(
ªq
->
chunksize
 > 
TIM_CHUNKSIZE_MAX
)

273  
TIM_AF_CSIZE_TOO_BIG
;

275 
rc
 = 
	`tim_gë_mö_ötvl
(
rvu
, 
ªq
->
˛ocksour˚
,Ñeq->
˛ock‰eq
,

276 &
ötvl_ns
, &
ötvl_cyc
);

277 i‡(
rc
)

278  
rc
;

280 i‡(
ªq
->
öãrvÆ
 < 
ötvl_cyc
 ||Ñeq->
öãrvÆns
 < 
ötvl_ns
)

281  
TIM_AF_INTERVAL_TOO_SMALL
;

284 i‡(
ªq
->
˛ocksour˚
 =
TIM_CLK_SRCS_GPIO
 &&

285 
ªq
->
gpi€dge
 < 
TIM_GPIO_INVALID
) {

286 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
TIM_AF_FLAGS_REG
);

287 i‡(
	`FIELD_GET
(
TIM_AF_FLAGS_REG_GPIO_EDGE_MASK
, 
ªgvÆ
) ==

288 
TIM_GPIO_NO_EDGE
 && 
ªq
->
gpi€dge
 == TIM_GPIO_NO_EDGE)

289  
TIM_AF_GPIO_CLK_SRC_NOT_ENABLED
;

290 i‡(
ªq
->
gpi€dge
 !
TIM_GPIO_NO_EDGE
 &&Ñeq->gpioedge !=

291 
	`FIELD_GET
(
TIM_AF_FLAGS_REG_GPIO_EDGE_MASK
, 
ªgvÆ
)) {

292 
	`dev_öfo
(
rvu
->
dev
,

294 ()
ªq
->
gpi€dge
,

295 
	`FIELD_GET
(
TIM_AF_FLAGS_REG_GPIO_EDGE_MASK
,

296 
ªgvÆ
));

297 
ªgvÆ
 &~
TIM_AF_FLAGS_REG_GPIO_EDGE_MASK
;

298 
ªgvÆ
 |
	`FIELD_PREP
(
TIM_AF_FLAGS_REG_GPIO_EDGE_MASK
,

299 
ªq
->
gpi€dge
);

300 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
TIM_AF_FLAGS_REG
, 
ªgvÆ
);

304 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

305 
	`tim_˙10k_ªc‹d_ötvl
(
rvu
, 
lf
, 
ªq
->
öãrvÆns
);

309 
ªgvÆ
 = 
ªq
->
öãrvÆ
;

310 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL0
(
lf
), 
ªgvÆ
);

313 
ªgvÆ
 = (((
u64
)
ªq
->
bigídün
) << 53) |

315 (((
u64
)
ªq
->
íabÀ≥riodic
) << 45) |

316 (((
u64
)(
ªq
->
íabÀ≥riodic
 ^ 1)) << 44) |

317 (((
u64
)
ªq
->
íabÀd⁄t‰ìbuf„r
) << 43) |

318 (
u64
)(
ªq
->
buckësize
 - 1);

319 i‡(
	`is_rvu_Ÿx2
(
rvu
))

320 
ªgvÆ
 |(((
u64
)
ªq
->
˛ocksour˚
) << 51);

322 
ªgvÆ
 |(((
u64
)
ªq
->
˛ocksour˚
) << 40);

324 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
), 
ªgvÆ
);

327 
ªgvÆ
 = ((
u64
)
ªq
->
chunksize
 / 
TIM_CHUNKSIZE_MULTIPLE
) << 40;

328 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL2
(
lf
), 
ªgvÆ
);

331 
	}
}

333 
ölöe
 
	$tim_gë_‰ì_ru¬ög_cou¡î_off£t
(
u64
 *
˛k_§c
)

335 *
˛k_§c
) {

336 
TIM_CLK_SRCS_TENNS
:

337 *
˛k_§c
 = 
TIM_AF_FR_RN_TENNS
;

339 
TIM_CLK_SRCS_GPIO
:

340 *
˛k_§c
 = 
TIM_AF_FR_RN_GPIOS
;

342 
TIM_CLK_SRCS_GTI
:

343 *
˛k_§c
 = 
TIM_AF_FR_RN_GTI
;

345 
TIM_CLK_SRCS_PTP
:

346 *
˛k_§c
 = 
TIM_AF_FR_RN_PTP
;

348 
TIM_CLK_SRCS_SYNCE
:

349 *
˛k_§c
 = 
TIM_AF_FR_RN_SYNCE
;

351 
TIM_CLK_SRCS_BTS
:

352 *
˛k_§c
 = 
TIM_AF_FR_RN_BTS
;

355  
TIM_AF_INVALID_CLOCK_SOURCE
;

359 
	}
}

361 
	$rvu_mbox_h™dÀr_tim_íabÀ_rög
(
rvu
 *rvu,

362 
tim_rög_ªq
 *
ªq
,

363 
tim_íabÀ_r•
 *
r•
)

365 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

366 
u64
 
°¨t_cyc
, 
íd_cyc
, 
low
;

367 
u64
 
ªgvÆ
, 
˛k_§c
;

368 
u32
 
expúy
, 
ötvl
;

369 
ªåõs
, 
ªt
;

370 
lf
, 
blkaddr
;

372 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
, 
pcifunc
);

373 i‡(
blkaddr
 < 0)

374  
TIM_AF_LF_INVALID
;

376 
lf
 = 
	`rvu_gë_lf
(
rvu
, &rvu->
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
rög
);

377 i‡(
lf
 < 0)

378  
TIM_AF_LF_INVALID
;

381 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
));

382 i‡(
ªgvÆ
 & 
TIM_AF_RINGX_CTL1_ENA
)

383  
TIM_AF_RING_STILL_RUNNING
;

386 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
));

388 i‡(
	`is_rvu_Ÿx2
(
rvu
))

389 
˛k_§c
 = (
ªgvÆ
 >> 51) & 0x3;

391 
˛k_§c
 = (
ªgvÆ
 >> 40) & 0x7;

393 
ªt
 = 
	`tim_gë_‰ì_ru¬ög_cou¡î_off£t
(&
˛k_§c
);

394 i‡(
ªt
)

395  
ªt
;

397 
ªåõs
 = 10;

399 
ªgvÆ
 |
TIM_AF_RINGX_CTL1_ENA
;

400 
ªgvÆ
 &~
	`GENMASK_ULL
(39, 20);

402 
	`mb
();

403 
°¨t_cyc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
˛k_§c
);

404 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
), 
ªgvÆ
);

405 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL0
(
lf
));

406 
íd_cyc
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
˛k_§c
);

408 
	`mb
();

409 
low
 = 
íd_cyc
 & 
	`GENMASK_ULL
(31, 0);

410 
°¨t_cyc
 >>= 32;

411 
íd_cyc
 >>= 32;

412 i‡(
°¨t_cyc
 - 
íd_cyc
) {

413 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
));

414 
ªgvÆ
 &~
TIM_AF_RINGX_CTL1_ENA
;

415 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
), 
ªgvÆ
);

416 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL0
(
lf
));

417 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL0
(
lf
),

418 
ªgvÆ
 & 
	`GENMASK_ULL
(31, 0));

419 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_CTL1
(
lf
));

421 } (
°¨t_cyc
 - 
íd_cyc
Ë&& 
ªåõs
--);

423 i‡(!
ªåõs
 && (
°¨t_cyc
 - 
íd_cyc
))

424  
TIM_AF_LF_START_SYNC_FAIL
;

426 
expúy
 = 
ªgvÆ
 >> 32;

427 
ötvl
 = 
ªgvÆ
 & 
	`GENMASK_ULL
(31, 0);

428 
r•
->
time°¨ãd
 = (
°¨t_cyc
 << 32Ë| 
expúy
;

429 i‡(
low
 > 
expúy
)

430 
r•
->
time°¨ãd
 +
	`BIT_ULL
(32);

431 
r•
->
time°¨ãd
 -
ötvl
;

432 
r•
->
cuºítbuckë
 = 0;

435 
	}
}

437 
	$rvu_mbox_h™dÀr_tim_dißbÀ_rög
(
rvu
 *rvu,

438 
tim_rög_ªq
 *
ªq
,

439 
msg_r•
 *
r•
)

441 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

442 
lf
, 
blkaddr
;

444 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
, 
pcifunc
);

445 i‡(
blkaddr
 < 0)

446  
TIM_AF_LF_INVALID
;

448 
lf
 = 
	`rvu_gë_lf
(
rvu
, &rvu->
hw
->
block
[
blkaddr
], 
pcifunc
, 
ªq
->
rög
);

449 i‡(
lf
 < 0)

450  
TIM_AF_LF_INVALID
;

452  
	`rvu_tim_dißbÀ_lf
(
rvu
, 
lf
, 
blkaddr
);

453 
	}
}

455 
	$rvu_tim_lf_ã¨down
(
rvu
 *rvu, 
u16
 
pcifunc
, 
lf
, 
¶Ÿ
)

457 
blkaddr
;

459 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
, 
pcifunc
);

460 i‡(
blkaddr
 < 0)

461  
TIM_AF_LF_INVALID
;

464 
	`rvu_tim_dißbÀ_lf
(
rvu
, 
lf
, 
blkaddr
);

466 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
	`TIM_AF_RINGX_GMCTL
(
lf
), 0);

469 
	}
}

471 
	#FOR_EACH_TIM_LF
(
lf
) \

472 
lf
 = 0;Ü‡< 
hw
->
block
[
BLKTYPE_TIM
].lf.
max
;Üf++)

	)

474 
	$rvu_tim_öô
(
rvu
 *rvu)

476 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

477 
lf
, 
blkaddr
, 
rc
 = 0;

478 
u8
 
gpio_edge
;

479 
u64
 
ªgvÆ
;

481 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_TIM
, 0);

482 i‡(
blkaddr
 < 0)

485 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

486 
rc
 = 
	`tim_block_˙10k_öô
(
rvu
);

488 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
TIM_AF_FLAGS_REG
);

491 i‡(
ªgvÆ
 & 
TIM_AF_FLAGS_REG_ENA_TIM
) {

493 
	`FOR_EACH_TIM_LF
(
lf
) {

494 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
,

495 
	`TIM_AF_RINGX_CTL1
(
lf
));

496 i‡(!(
ªgvÆ
 & 
TIM_AF_RINGX_CTL1_ENA
))

499 
	`rvu_tim_dißbÀ_lf
(
rvu
, 
lf
, 
blkaddr
);

503 
ªgvÆ
 = 
	`rvu_ªad64
(
rvu
, 
blkaddr
, 
TIM_AF_FLAGS_REG
);

504 
ªgvÆ
 &~
TIM_AF_FLAGS_REG_ENA_TIM
;

505 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
TIM_AF_FLAGS_REG
, 
ªgvÆ
);

509 
	`FOR_EACH_TIM_LF
(
lf
) {

510 
	`rvu_lf_ª£t
(
rvu
, &
hw
->
block
[
BLKTYPE_TIM
], 
lf
);

514 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
TIM_AF_BLK_RST
, 0x1);

515 
	`rvu_pﬁl_ªg
(
rvu
, 
blkaddr
, 
TIM_AF_BLK_RST
, 
	`BIT_ULL
(63), 
åue
);

517 
gpio_edge
 = 
TIM_GPIO_NO_EDGE
;

520 
ªgvÆ
 = 
	`FIELD_PREP
(
TIM_AF_FLAGS_REG_GPIO_EDGE_MASK
, 
gpio_edge
) |

521 
	`BIT_ULL
(2) |

522 
	`BIT_ULL
(0);

523 
	`rvu_wrôe64
(
rvu
, 
blkaddr
, 
TIM_AF_FLAGS_REG
, 
ªgvÆ
);

525 if(
	`is_rvu_Ÿx2
(
rvu
))

526 
	`rvu_tim_hw_fixes
(
rvu
, 
blkaddr
);

528  
rc
;

529 
	}
}

	@rvu_trace.c

8 
	#CREATE_TRACE_POINTS


	)

9 
	~"rvu_åa˚.h
"

11 
EXPORT_TRACEPOINT_SYMBOL
(
Ÿx2_msg_Æloc
);

12 
EXPORT_TRACEPOINT_SYMBOL
(
Ÿx2_msg_öãºu±
);

13 
EXPORT_TRACEPOINT_SYMBOL
(
Ÿx2_msg_¥o˚ss
);

	@rvu_trace.h

8 #unde‡
TRACE_SYSTEM


9 
	#TRACE_SYSTEM
 
rvu


	)

11 #i‡!
deföed
(
__RVU_TRACE_H
Ë|| deföed(
TRACE_HEADER_MULTI_READ
)

12 
	#__RVU_TRACE_H


	)

14 
	~<löux/ty≥s.h
>

15 
	~<löux/åa˚poöt.h
>

16 
	~<löux/pci.h
>

18 
	~"mbox.h
"

20 
TRACE_EVENT
(
Ÿx2_msg_Æloc
,

21 
TP_PROTO
(c⁄° 
pci_dev
 *
pdev
, 
u16
 
id
, 
u64
 
size
),

22 
TP_ARGS
(
pdev
, 
id
, 
size
),

23 
TP_STRUCT__íåy
(
__°rög
(
dev
, 
	$pci_«me
(
pdev
))

24 
	$__fõld
(
u16
, 
id
)

25 
	`__fõld
(
u64
, 
size
)

27 
	`TP_Á°_assign
(
	`__assign_°r
(
dev
, 
	$pci_«me
(
pdev
))

28 
__íåy
->
id
 = id;

29 
__íåy
->
size
 = size;

31 
	`TP_¥ötk
("[%s] msg:(%sËsize:%Œd\n", 
	`__gë_°r
(
dev
),

32 
	`Ÿx2_mbox_id2«me
(
__íåy
->
id
), __íåy->
size
)

35 
	`TRACE_EVENT
(
Ÿx2_msg_£nd
,

36 
	`TP_PROTO
(c⁄° 
pci_dev
 *
pdev
, 
u16
 
num_msgs
, 
u64
 
msg_size
),

37 
	`TP_ARGS
(
pdev
, 
num_msgs
, 
msg_size
),

38 
	`TP_STRUCT__íåy
(
	`__°rög
(
dev
, 
	$pci_«me
(
pdev
))

39 
	$__fõld
(
u16
, 
num_msgs
)

40 
	`__fõld
(
u64
, 
msg_size
)

42 
	`TP_Á°_assign
(
	`__assign_°r
(
dev
, 
	$pci_«me
(
pdev
))

43 
__íåy
->
num_msgs
 =Çum_msgs;

44 
__íåy
->
msg_size
 = msg_size;

46 
	`TP_¥ötk
("[%s] síà%d msg(sËo‡size:%Œd\n", 
	`__gë_°r
(
dev
),

47 
__íåy
->
num_msgs
, __íåy->
msg_size
)

50 
	`TRACE_EVENT
(
Ÿx2_msg_check
,

51 
	`TP_PROTO
(c⁄° 
pci_dev
 *
pdev
, 
u16
 
ªqid
, u16 
r•id
, 
rc
),

52 
	`TP_ARGS
(
pdev
, 
ªqid
, 
r•id
, 
rc
),

53 
	`TP_STRUCT__íåy
(
	`__°rög
(
dev
, 
	$pci_«me
(
pdev
))

54 
	$__fõld
(
u16
, 
ªqid
)

55 
	$__fõld
(
u16
, 
r•id
)

56 
	`__fõld
(, 
rc
)

58 
	`TP_Á°_assign
(
	`__assign_°r
(
dev
, 
	$pci_«me
(
pdev
))

59 
__íåy
->
ªqid
 =Ñeqid;

60 
__íåy
->
r•id
 =Ñspid;

61 
__íåy
->
rc
 =Ñc;

63 
	`TP_¥ötk
("[%s]Ñeq->id:0x%xÑsp->id:0x%xÑesp_code:%d\n",

64 
	`__gë_°r
(
dev
), 
__íåy
->
ªqid
,

65 
__íåy
->
r•id
, __íåy->
rc
)

68 
	`TRACE_EVENT
(
Ÿx2_msg_öãºu±
,

69 
	`TP_PROTO
(c⁄° 
pci_dev
 *
pdev
, c⁄° *
msg
, 
u64
 
öå
),

70 
	`TP_ARGS
(
pdev
, 
msg
, 
öå
),

71 
	`TP_STRUCT__íåy
(
	`__°rög
(
dev
, 
	$pci_«me
(
pdev
))

72 
	$__°rög
(
°r
, 
msg
)

73 
	`__fõld
(
u64
, 
öå
)

75 
	`TP_Á°_assign
(
	`__assign_°r
(
dev
, 
	$pci_«me
(
pdev
))

76 
	$__assign_°r
(
°r
, 
msg
)

77 
__íåy
->
öå
 = intr;

79 
	`TP_¥ötk
("[%s] mbox i¡îru± %†(0x%Œx)\n", 
	`__gë_°r
(
dev
),

80 
	`__gë_°r
(
°r
), 
__íåy
->
öå
)

83 
	`TRACE_EVENT
(
Ÿx2_msg_¥o˚ss
,

84 
	`TP_PROTO
(c⁄° 
pci_dev
 *
pdev
, 
u16
 
id
, 
îr
),

85 
	`TP_ARGS
(
pdev
, 
id
, 
îr
),

86 
	`TP_STRUCT__íåy
(
	`__°rög
(
dev
, 
	$pci_«me
(
pdev
))

87 
	$__fõld
(
u16
, 
id
)

88 
	`__fõld
(, 
îr
)

90 
	`TP_Á°_assign
(
	`__assign_°r
(
dev
, 
	$pci_«me
(
pdev
))

91 
__íåy
->
id
 = id;

92 
__íåy
->
îr
 =Érr;

94 
	`TP_¥ötk
("[%s] msg:(%sËîr‹:%d\n", 
	`__gë_°r
(
dev
),

95 
	`Ÿx2_mbox_id2«me
(
__íåy
->
id
), __íåy->
îr
)

98 
	`TRACE_EVENT
(
Ÿx2_msg_waô_r•
,

99 
	`TP_PROTO
(c⁄° 
pci_dev
 *
pdev
),

100 
	`TP_ARGS
(
pdev
),

101 
	`TP_STRUCT__íåy
(
	`__°rög
(
dev
, 
	`pci_«me
(
pdev
))

103 
	`TP_Á°_assign
(
	`__assign_°r
(
dev
, 
	`pci_«me
(
pdev
))

105 
	`TP_¥ötk
("[%s]Åimed out while waiting forÑesponse\n",

106 
	`__gë_°r
(
dev
))

111 #unde‡
TRACE_INCLUDE_PATH


112 
	#TRACE_INCLUDE_PATH
 .

	)

114 #unde‡
TRACE_INCLUDE_FILE


115 
	#TRACE_INCLUDE_FILE
 
rvu_åa˚


	)

117 
	~<åa˚/deföe_åa˚.h
>

	@rvu_validation.c

8 
	~<löux/ty≥s.h
>

9 
	~<löux/pci.h
>

10 
	~"rvu.h
"

12 
	#PCI_DEVID_OCTEONTX2_RVU_PF
 0xA063

	)

13 
	#PCI_DEVID_OCTEONTX2_SSO_RVU_PF
 0xA0F9

	)

14 
	#PCI_DEVID_OCTEONTX2_NPA_RVU_PF
 0xA0FB

	)

15 
	#PCI_DEVID_OCTEONTX2_CPT_RVU_PF
 0xA0FD

	)

16 
	#PCI_DEVID_OCTEONTX2_SDP_RVU_PF
 0xA0F6

	)

17 
	#PCI_DEVID_OCTEONTX2_CPT10_RVU_PF
 0xA0F2

	)

19 
u64
 
	$quŸas_gë_sum
(
rvu_quŸas
 *
quŸas
)

21 
u64
 
lf_sum
 = 0;

22 
i
;

24 
i
 = 0; i < 
quŸas
->
˙t
; i++)

25 
lf_sum
 +
quŸas
->
a
[
i
].
vÆ
;

27  
lf_sum
;

28 
	}
}

30 
ssize_t
 
	$quŸa_show
(
kobje˘
 *
kobj
, 
kobj_©åibuã
 *
©å
,

31 *
buf
)

33 
rvu_quŸa
 *
quŸa
;

34 
vÆ
;

36 
quŸa
 = 
	`c⁄èöî_of
(
©å
, 
rvu_quŸa
, 
sysfs
);

38 i‡(
quŸa
->
ba£
->
lock
)

39 
	`muãx_lock
(
quŸa
->
ba£
->
lock
);

40 
vÆ
 = 
quŸa
->val;

41 i‡(
quŸa
->
ba£
->
lock
)

42 
	`muãx_u∆ock
(
quŸa
->
ba£
->
lock
);

44  
	`¢¥ötf
(
buf
, 
PAGE_SIZE
, "%d\n", 
vÆ
);

45 
	}
}

47 
ssize_t
 
	$quŸa_°‹e
(
kobje˘
 *
kobj
, 
kobj_©åibuã
 *
©å
,

48 c⁄° *
buf
, 
size_t
 
cou¡
)

50 
ﬁd_vÆ
, 
√w_vÆ
, 
ªs
 = 0;

51 
rvu_quŸa
 *
quŸa
;

52 
rvu_quŸas
 *
ba£
;

53 
devi˚
 *
dev
;

54 
u64
 
lf_sum
;

56 
quŸa
 = 
	`c⁄èöî_of
(
©å
, 
rvu_quŸa
, 
sysfs
);

57 
dev
 = 
quŸa
->dev;

58 
ba£
 = 
quŸa
->base;

60 i‡(
	`k°πoöt
(
buf
, 0, &
√w_vÆ
)) {

61 
	`dev_îr
(
dev
, "InvÆid %†quŸa: %s\n", 
©å
->©å.
«me
, 
buf
);

62  -
EIO
;

64 i‡(
√w_vÆ
 < 0) {

65 
	`dev_îr
(
dev
, "InvÆid %†quŸa: %d < 0\n", 
©å
->©å.
«me
,

66 
√w_vÆ
);

67  -
EIO
;

70 i‡(
√w_vÆ
 > 
ba£
->
max
) {

71 
	`dev_îr
(
dev
, "InvÆid %†quŸa: %d > %d\n", 
©å
->©å.
«me
,

72 
√w_vÆ
, 
ba£
->
max
);

73  -
EIO
;

76 i‡(
ba£
->
lock
)

77 
	`muãx_lock
(
ba£
->
lock
);

78 
ﬁd_vÆ
 = 
quŸa
->
vÆ
;

80 i‡(
ba£
->
›s
.
¥e_°‹e
)

81 
ªs
 = 
ba£
->
›s
.
	`¥e_°‹e
(
quŸa
->
›s_¨g
, quŸa, 
√w_vÆ
);

83 i‡(
ªs
 != 0) {

84 
ªs
 = -
EIO
;

85 
u∆ock
;

88 
lf_sum
 = 
	`quŸas_gë_sum
(
quŸa
->
ba£
);

90 i‡(
lf_sum
 + 
√w_vÆ
 - 
quŸa
->
vÆ
 > 
ba£
->
max_sum
) {

91 
	`dev_îr
(
dev
,

93 
©å
->©å.
«me
, 
lf_sum
, 
ba£
->
max_sum
);

94 
ªs
 = -
EIO
;

95 
u∆ock
;

97 
quŸa
->
vÆ
 = 
√w_vÆ
;

99 i‡(
ba£
->
›s
.
po°_°‹e
)

100 
ba£
->
›s
.
	`po°_°‹e
(
quŸa
->
›s_¨g
, quŸa, 
ﬁd_vÆ
);

102 
ªs
 = 
cou¡
;

104 
u∆ock
:

105 i‡(
ba£
->
lock
)

106 
	`muãx_u∆ock
(
ba£
->
lock
);

107  
ªs
;

108 
	}
}

110 
	$quŸa_sysfs_de°roy
(
rvu_quŸa
 *
quŸa
)

112 i‡(
quŸa
 =
NULL
)

113  -
EINVAL
;

114 i‡(
quŸa
->
sysfs
.
©å
.
mode
 != 0) {

115 
	`sysfs_ªmove_fûe
(
quŸa
->
∑ª¡
, &quŸa->
sysfs
.
©å
);

116 
quŸa
->
sysfs
.
©å
.
mode
 = 0;

119 
	}
}

121 
rvu_quŸas
 *
	$quŸas_Æloc
(
u32
 
˙t
, u32 
max
, 
u64
 
max_sum
,

122 
öô_vÆ
, 
muãx
 *
lock
,

123 
rvu_quŸa_›s
 *
›s
)

125 
rvu_quŸas
 *
quŸas
;

126 
u64
 
i
;

128 i‡(
˙t
 == 0)

129  
NULL
;

131 
quŸas
 = 
	`kzÆloc
((
rvu_quŸas
) +

132 
˙t
 * (
rvu_quŸa
), 
GFP_KERNEL
);

133 i‡(
quŸas
 =
NULL
)

134  
NULL
;

136 
i
 = 0; i < 
˙t
; i++) {

137 
quŸas
->
a
[
i
].
ba£
 = quotas;

138 
quŸas
->
a
[
i
].
vÆ
 = 
öô_vÆ
;

141 
quŸas
->
˙t
 = cnt;

142 
quŸas
->
max
 = max;

143 
quŸas
->
max_sum
 = max_sum;

144 i‡(
›s
) {

145 
quŸas
->
›s
.
¥e_°‹e
 = ops->pre_store;

146 
quŸas
->
›s
.
po°_°‹e
 = ops->post_store;

148 
quŸas
->
lock
 =Üock;

150  
quŸas
;

151 
	}
}

153 
	$quŸas_‰ì
(
rvu_quŸas
 *
quŸas
)

155 
u64
 
i
;

157 i‡(
quŸas
 =
NULL
)

159 
	`WARN_ON
(
quŸas
->
˙t
 == 0);

161 
i
 = 0; i < 
quŸas
->
˙t
; i++)

162 
	`quŸa_sysfs_de°roy
(&
quŸas
->
a
[
i
]);

164 
	`k‰ì
(
quŸas
);

165 
	}
}

167 
	$quŸa_sysfs_¸óã
(c⁄° *
«me
, 
kobje˘
 *
∑ª¡
,

168 
devi˚
 *
log_dev
, 
rvu_quŸa
 *
quŸa
,

169 *
›s_¨g
)

171 
îr
;

173 i‡(
«me
 =
NULL
 || 
quŸa
 =NULL || 
log_dev
 == NULL)

174  -
EINVAL
;

176 
quŸa
->
sysfs
.
show
 = 
quŸa_show
;

177 
quŸa
->
sysfs
.
°‹e
 = 
quŸa_°‹e
;

178 
quŸa
->
sysfs
.
©å
.
«me
 =Çame;

179 
quŸa
->
sysfs
.
©å
.
mode
 = 0644;

180 
quŸa
->
∑ª¡
 =Öarent;

181 
quŸa
->
dev
 = 
log_dev
;

182 
quŸa
->
›s_¨g
 = ops_arg;

184 
	`sysfs_©å_öô
(&
quŸa
->
sysfs
.
©å
);

185 
îr
 = 
	`sysfs_¸óã_fûe
(
quŸa
->
∑ª¡
, &quŸa->
sysfs
.
©å
);

186 i‡(
îr
) {

187 
	`dev_îr
(
quŸa
->
dev
,

189 
«me
, 
	`kobje˘_«me
(
quŸa
->
∑ª¡
));

190  -
EFAULT
;

194 
	}
}

196 
	$rvu_blk_cou¡_r§c
(
rvu_block
 *
block
, 
u16
 
pcifunc
, 
u8
 
rshi·
)

198 
cou¡
 = 0, 
lf
;

200 
lf
 = 0;Ü‡< 
block
->lf.
max
;Üf++)

201 i‡((
block
->
‚_m≠
[
lf
] >> 
rshi·
Ë=(
pcifunc
 >>Ñshift) &&

202 
block
->
‚_m≠
[
lf
] != 0)

203 
cou¡
++;

205  
cou¡
;

206 
	}
}

208 
	$rvu_txsch_cou¡_r§c
(
rvu
 *rvu, 
lvl
, 
u16
 
pcifunc
,

209 
u8
 
rshi·
, 
nix_hw
 *nix_hw)

211 
nix_txsch
 *
txsch
 = &
nix_hw
->txsch[
lvl
];

212 
cou¡
 = 0, 
schq
;

214 i‡(
lvl
 =
NIX_TXSCH_LVL_TL1
)

217 
schq
 = 0; schq < 
txsch
->schq.
max
; schq++) {

218 i‡(
	`TXSCH_MAP_FLAGS
(
txsch
->
pfvf_m≠
[
schq
]Ë& 
NIX_TXSCHQ_FREE
)

220 i‡((
	`TXSCH_MAP_FUNC
(
txsch
->
pfvf_m≠
[
schq
]Ë>> 
rshi·
) ==

221 (
pcifunc
 >> 
rshi·
))

222 
cou¡
++;

225  
cou¡
;

226 
	}
}

228 
	$‰ì_r§c_˙t
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

229 
‰ì_r§cs_r•
 *
r•
)

231 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

232 
rvu_block
 *
block
;

233 
nix_txsch
 *
txsch
;

234 
nix_hw
 *nix_hw;

236 
	`muãx_lock
(&
rvu
->
r§c_lock
);

238 
block
 = &
hw
->block[
BLKADDR_NPA
];

239 
r•
->
≈a
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

241 
block
 = &
hw
->block[
BLKADDR_NIX0
];

242 
r•
->
nix
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

244 
block
 = &
hw
->block[
BLKADDR_NIX1
];

245 
r•
->
nix1
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

247 
block
 = &
hw
->block[
BLKADDR_SSO
];

248 
r•
->
sso
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

250 
block
 = &
hw
->block[
BLKADDR_SSOW
];

251 
r•
->
ssow
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

253 
block
 = &
hw
->block[
BLKADDR_TIM
];

254 
r•
->
tim
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

256 
block
 = &
hw
->block[
BLKADDR_CPT0
];

257 
r•
->
˝t
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

259 
block
 = &
hw
->block[
BLKADDR_CPT1
];

260 
r•
->
˝t1
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

262 
block
 = &
hw
->block[
BLKADDR_REE0
];

263 
r•
->
ªe0
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

265 
block
 = &
hw
->block[
BLKADDR_REE1
];

266 
r•
->
ªe1
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

268 i‡(
rvu
->
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
) {

269 
r•
->
schq
[
NIX_TXSCH_LVL_SMQ
] = 1;

270 
r•
->
schq
[
NIX_TXSCH_LVL_TL4
] = 1;

271 
r•
->
schq
[
NIX_TXSCH_LVL_TL3
] = 1;

272 
r•
->
schq
[
NIX_TXSCH_LVL_TL2
] = 1;

274 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_NIX1
))

275 
out
;

276 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_SMQ
] = 1;

277 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL4
] = 1;

278 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL3
] = 1;

279 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL2
] = 1;

281 
nix_hw
 = 
	`gë_nix_hw
(
hw
, 
BLKADDR_NIX0
);

282 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_SMQ
];

283 
r•
->
schq
[
NIX_TXSCH_LVL_SMQ
] =

284 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

286 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL4
];

287 
r•
->
schq
[
NIX_TXSCH_LVL_TL4
] =

288 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

290 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL3
];

291 
r•
->
schq
[
NIX_TXSCH_LVL_TL3
] =

292 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

294 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL2
];

295 
r•
->
schq
[
NIX_TXSCH_LVL_TL2
] =

296 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

298 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_NIX1
))

299 
out
;

301 
nix_hw
 = 
	`gë_nix_hw
(
hw
, 
BLKADDR_NIX1
);

302 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_SMQ
];

303 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_SMQ
] =

304 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

306 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL4
];

307 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL4
] =

308 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

310 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL3
];

311 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL3
] =

312 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

314 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL2
];

315 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL2
] =

316 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

319 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL1
] = 1;

320 
out
:

321 
r•
->
schq
[
NIX_TXSCH_LVL_TL1
] = 1;

322 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

325 
	}
}

327 
	$rvu_mbox_h™dÀr_‰ì_r§c_˙t
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

328 
‰ì_r§cs_r•
 *
r•
)

330 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

331 
u16
 
pcifunc
 = 
ªq
->
hdr
.pcifunc;

332 
rvu_block
 *
block
;

333 
nix_txsch
 *
txsch
;

334 
nix_hw
 *nix_hw;

335 
pf
, 
cuæfs
;

337 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

338  
	`‰ì_r§c_˙t
(
rvu
, 
ªq
, 
r•
);

340 
	`muãx_lock
(&
rvu
->
r§c_lock
);

341 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

343 
block
 = &
hw
->block[
BLKADDR_NPA
];

344 
cuæfs
 = 
	`rvu_blk_cou¡_r§c
(
block
, 
pcifunc
, 
RVU_PFVF_PF_SHIFT
);

345 
r•
->
≈a
 = 
rvu
->
pf_limôs
.≈a->
a
[
pf
].
vÆ
 - 
cuæfs
;

347 
block
 = &
hw
->block[
BLKADDR_NIX0
];

348 
cuæfs
 = 
	`rvu_blk_cou¡_r§c
(
block
, 
pcifunc
, 
RVU_PFVF_PF_SHIFT
);

349 
r•
->
nix
 = 
rvu
->
pf_limôs
.nix->
a
[
pf
].
vÆ
 - 
cuæfs
;

351 
block
 = &
hw
->block[
BLKADDR_NIX1
];

352 
r•
->
nix1
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

354 
block
 = &
hw
->block[
BLKADDR_SSO
];

355 
cuæfs
 = 
	`rvu_blk_cou¡_r§c
(
block
, 
pcifunc
, 
RVU_PFVF_PF_SHIFT
);

356 
r•
->
sso
 = 
rvu
->
pf_limôs
.sso->
a
[
pf
].
vÆ
 - 
cuæfs
;

358 
block
 = &
hw
->block[
BLKADDR_SSOW
];

359 
cuæfs
 = 
	`rvu_blk_cou¡_r§c
(
block
, 
pcifunc
, 
RVU_PFVF_PF_SHIFT
);

360 
r•
->
ssow
 = 
rvu
->
pf_limôs
.ssow->
a
[
pf
].
vÆ
 - 
cuæfs
;

362 
block
 = &
hw
->block[
BLKADDR_TIM
];

363 
cuæfs
 = 
	`rvu_blk_cou¡_r§c
(
block
, 
pcifunc
, 
RVU_PFVF_PF_SHIFT
);

364 
r•
->
tim
 = 
rvu
->
pf_limôs
.tim->
a
[
pf
].
vÆ
 - 
cuæfs
;

366 
block
 = &
hw
->block[
BLKADDR_CPT0
];

367 
r•
->
˝t
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

369 
block
 = &
hw
->block[
BLKADDR_CPT1
];

370 
r•
->
˝t1
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

372 
block
 = &
hw
->block[
BLKADDR_REE0
];

373 
r•
->
ªe0
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

375 
block
 = &
hw
->block[
BLKADDR_REE1
];

376 
r•
->
ªe1
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

378 i‡(
rvu
->
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
) {

379 
r•
->
schq
[
NIX_TXSCH_LVL_SMQ
] = 1;

380 
r•
->
schq
[
NIX_TXSCH_LVL_TL4
] = 1;

381 
r•
->
schq
[
NIX_TXSCH_LVL_TL3
] = 1;

382 
r•
->
schq
[
NIX_TXSCH_LVL_TL2
] = 1;

384 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_NIX1
))

385 
out
;

386 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_SMQ
] = 1;

387 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL4
] = 1;

388 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL3
] = 1;

389 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL2
] = 1;

391 
nix_hw
 = 
	`gë_nix_hw
(
hw
, 
BLKADDR_NIX0
);

392 i‡(!
nix_hw
)

393 
îr
;

395 
cuæfs
 = 
	`rvu_txsch_cou¡_r§c
(
rvu
, 
NIX_TXSCH_LVL_SMQ
, 
pcifunc
,

396 
RVU_PFVF_PF_SHIFT
, 
nix_hw
);

397 
r•
->
schq
[
NIX_TXSCH_LVL_SMQ
] =

398 
rvu
->
pf_limôs
.
smq
->
a
[
pf
].
vÆ
 - 
cuæfs
;

400 
cuæfs
 = 
	`rvu_txsch_cou¡_r§c
(
rvu
, 
NIX_TXSCH_LVL_TL4
, 
pcifunc
,

401 
RVU_PFVF_PF_SHIFT
, 
nix_hw
);

402 
r•
->
schq
[
NIX_TXSCH_LVL_TL4
] =

403 
rvu
->
pf_limôs
.
é4
->
a
[
pf
].
vÆ
 - 
cuæfs
;

405 
cuæfs
 = 
	`rvu_txsch_cou¡_r§c
(
rvu
, 
NIX_TXSCH_LVL_TL3
, 
pcifunc
,

406 
RVU_PFVF_PF_SHIFT
, 
nix_hw
);

407 
r•
->
schq
[
NIX_TXSCH_LVL_TL3
] =

408 
rvu
->
pf_limôs
.
é3
->
a
[
pf
].
vÆ
 - 
cuæfs
;

410 
cuæfs
 = 
	`rvu_txsch_cou¡_r§c
(
rvu
, 
NIX_TXSCH_LVL_TL2
, 
pcifunc
,

411 
RVU_PFVF_PF_SHIFT
, 
nix_hw
);

412 
r•
->
schq
[
NIX_TXSCH_LVL_TL2
] =

413 
rvu
->
pf_limôs
.
é2
->
a
[
pf
].
vÆ
 - 
cuæfs
;

415 i‡(!
	`is_block_im∂emíãd
(
rvu
->
hw
, 
BLKADDR_NIX1
))

416 
out
;

417 
nix_hw
 = 
	`gë_nix_hw
(
hw
, 
BLKADDR_NIX1
);

418 i‡(!
nix_hw
)

419 
îr
;

421 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_SMQ
];

422 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_SMQ
] =

423 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

425 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL4
];

426 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL4
] =

427 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

429 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL3
];

430 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL3
] =

431 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

433 
txsch
 = &
nix_hw
->txsch[
NIX_TXSCH_LVL_TL2
];

434 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL2
] =

435 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
);

438 
r•
->
schq_nix1
[
NIX_TXSCH_LVL_TL1
] = 1;

439 
out
:

440 
r•
->
schq
[
NIX_TXSCH_LVL_TL1
] = 1;

441 
îr
:

442 
	`muãx_u∆ock
(&
rvu
->
r§c_lock
);

445 
	}
}

447 
	$rvu_check_txsch_pﬁicy
(
rvu
 *rvu, 
nix_txsch_Æloc_ªq
 *
ªq
,

448 
u16
 
pcifunc
)

450 
lvl
, 
ªq_schq
, 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

451 
limô
, 
Ámûylfs
, 
dñè
;

452 
nix_txsch
 *
txsch
;

453 
nix_hw
 *nix_hw;

454 
blkaddr
;

456 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

459 
blkaddr
 = 
	`rvu_gë_blkaddr
(
rvu
, 
BLKTYPE_NIX
, 
pcifunc
);

460 i‡(
blkaddr
 < 0)

461  
blkaddr
;

463 
nix_hw
 = 
	`gë_nix_hw
(
rvu
->
hw
, 
blkaddr
);

465 i‡(!
nix_hw
)

466  -
ENODEV
;

468 
lvl
 = 0;Üv»< 
NIX_TXSCH_LVL_CNT
;Üvl++) {

469 
txsch
 = &
nix_hw
->txsch[
lvl
];

470 
ªq_schq
 = 
ªq
->
schq_c⁄tig
[
lvl
] +Ñeq->
schq
[lvl];

472 
lvl
) {

473 
NIX_TXSCH_LVL_SMQ
:

474 
limô
 = 
rvu
->
pf_limôs
.
smq
->
a
[
pf
].
vÆ
;

476 
NIX_TXSCH_LVL_TL4
:

477 
limô
 = 
rvu
->
pf_limôs
.
é4
->
a
[
pf
].
vÆ
;

479 
NIX_TXSCH_LVL_TL3
:

480 
limô
 = 
rvu
->
pf_limôs
.
é3
->
a
[
pf
].
vÆ
;

482 
NIX_TXSCH_LVL_TL2
:

483 
limô
 = 
rvu
->
pf_limôs
.
é2
->
a
[
pf
].
vÆ
;

485 
NIX_TXSCH_LVL_TL1
:

486 i‡(
ªq_schq
 > 2)

487  -
ENOSPC
;

491 
Ámûylfs
 = 
	`rvu_txsch_cou¡_r§c
(
rvu
, 
lvl
, 
pcifunc
,

492 
RVU_PFVF_PF_SHIFT
, 
nix_hw
);

493 
dñè
 = 
ªq_schq
 - 
	`rvu_txsch_cou¡_r§c
(
rvu
, 
lvl
, 
pcifunc
,

494 0, 
nix_hw
);

496 i‡((
dñè
 > 0) &&

497 ((
limô
 < 
Ámûylfs
 + 
dñè
) ||

498 (
dñè
 > 
	`rvu_r§c_‰ì_cou¡
(&
txsch
->
schq
))))

499  -
ENOSPC
;

503 
	}
}

505 
	$rvu_check_r§c_pﬁicy
(
rvu
 *rvu, 
r§c_©èch
 *
ªq
,

506 
u16
 
pcifunc
)

508 
rvu_pfvf
 *
pfvf
 = 
	`rvu_gë_pfvf
(
rvu
, 
pcifunc
);

509 
‰ì_lfs
, 
m≠≥dlfs
, 
Ámûylfs
, 
limô
, 
dñè
;

510 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

511 
pf
 = 
	`rvu_gë_pf
(
pcifunc
);

512 
rvu_block
 *
block
;

514 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

518 i‡(
ªq
->
nixlf
) {

519 
block
 = &
hw
->block[
BLKADDR_NIX0
];

520 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

521 
limô
 = 
rvu
->
pf_limôs
.
nix
->
a
[
pf
].
vÆ
;

522 
Ámûylfs
 = 
	`rvu_blk_cou¡_r§c
(
block
, 
pcifunc
,

523 
RVU_PFVF_PF_SHIFT
);

524 i‡(!
‰ì_lfs
 || (
limô
 =
Ámûylfs
))

525 
Áû
;

528 i‡(
ªq
->
sso
) {

529 
block
 = &
hw
->block[
BLKADDR_SSO
];

530 
m≠≥dlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

531 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

532 
limô
 = 
rvu
->
pf_limôs
.
sso
->
a
[
pf
].
vÆ
;

533 
Ámûylfs
 = 
	`rvu_blk_cou¡_r§c
(
block
, 
pcifunc
,

534 
RVU_PFVF_PF_SHIFT
);

536 
dñè
 = 
ªq
->
sso
 - 
m≠≥dlfs
;

537 i‡((
dñè
 > 0) &&

538 ((
limô
 < 
Ámûylfs
 + 
dñè
) ||

539 (
dñè
 > 
‰ì_lfs
)))

540 
Áû
;

543 i‡(
ªq
->
ssow
) {

544 
block
 = &
hw
->block[
BLKADDR_SSOW
];

545 
m≠≥dlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

546 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

547 
limô
 = 
rvu
->
pf_limôs
.
ssow
->
a
[
pf
].
vÆ
;

548 
Ámûylfs
 = 
	`rvu_blk_cou¡_r§c
(
block
, 
pcifunc
,

549 
RVU_PFVF_PF_SHIFT
);

551 
dñè
 = 
ªq
->
ssow
 - 
m≠≥dlfs
;

552 i‡((
dñè
 > 0) &&

553 ((
limô
 < 
Ámûylfs
 + 
dñè
) ||

554 (
dñè
 > 
‰ì_lfs
)))

555 
Áû
;

558 i‡(
ªq
->
timlfs
) {

559 
block
 = &
hw
->block[
BLKADDR_TIM
];

560 
m≠≥dlfs
 = 
	`rvu_gë_r§c_m≠cou¡
(
pfvf
, 
block
->
addr
);

561 
‰ì_lfs
 = 
	`rvu_r§c_‰ì_cou¡
(&
block
->
lf
);

562 
limô
 = 
rvu
->
pf_limôs
.
tim
->
a
[
pf
].
vÆ
;

563 
Ámûylfs
 = 
	`rvu_blk_cou¡_r§c
(
block
, 
pcifunc
,

564 
RVU_PFVF_PF_SHIFT
);

566 
dñè
 = 
ªq
->
timlfs
 - 
m≠≥dlfs
;

567 i‡((
dñè
 > 0) &&

568 ((
limô
 < 
Ámûylfs
 + 
dñè
) ||

569 (
dñè
 > 
‰ì_lfs
)))

570 
Áû
;

575 
Áû
:

576 
	`dev_öfo
(
rvu
->
dev
, "Reque° f‹ %†Áûed\n", 
block
->
«me
);

577  -
ENOSPC
;

578 
	}
}

580 
	$check_m≠≥d_r§cs
(*
¨g
, 
rvu_quŸa
 *
quŸa
, 
√w_vÆ
)

582 
rvu_pfvf
 *
pf
 = 
¨g
;

583 
addr
;

585 
addr
 = 0;ádd∏< 
BLK_COUNT
;áddr++) {

586 i‡(
	`rvu_gë_r§c_m≠cou¡
(
pf
, 
addr
) > 0)

590 
	}
}

592 
rvu_quŸa_›s
 
	gpf_limô_›s
 = {

593 .
¥e_°‹e
 = 
check_m≠≥d_r§cs
,

596 
	$rvu_£t_deÁu…_limôs
(
rvu
 *rvu)

598 
i
, 
nvfs
, 
˝t_rvus
, 
≈a_rvus
, 
sso_rvus
, 
nix_rvus
, 
nsso
, 
nssow
, 
¡im
;

599 
tŸÆ_˝t_lfs
, 
n˝çf_˝éfs
 = 0, 
nss›f_˝éfs
 = 0;

600 
¬∑
, 
¬ix
, 
nsmq
 = 0, 
¡l4
 = 0, 
¡l3
 = 0, 
¡l2
 = 0;

601 
devid
;

604 
sso_rvus
 = 0;

605 
nix_rvus
 = 0;

606 
˝t_rvus
 = 0;

607 
≈a_rvus
 = 0;

608 
i
 = 0; i < 
rvu
->
hw
->
tŸÆ_pfs
; i++) {

609 i‡(
rvu
->
pf
[
i
].
pdev
 =
NULL
)

611 
devid
 = 
rvu
->
pf
[
i
].
pdev
->
devi˚
;

612 i‡(
devid
 =
PCI_DEVID_OCTEONTX2_SSO_RVU_PF
)

613 
sso_rvus
++;

614 i‡(
devid
 =
PCI_DEVID_OCTEONTX2_RVU_PF
 ||

615 
devid
 =
PCI_DEVID_OCTEONTX2_RVU_AF
 ||

616 
devid
 =
PCI_DEVID_OCTEONTX2_SDP_RVU_PF
)

617 
nix_rvus
++;

618 i‡(
devid
 =
PCI_DEVID_OCTEONTX2_CPT_RVU_PF
)

619 
˝t_rvus
++;

620 i‡(
devid
 =
PCI_DEVID_OCTEONTX2_NPA_RVU_PF
)

621 
≈a_rvus
++;

624 
nsso
 = 
rvu
->
pf_limôs
.
sso
->
max_sum
 / 
sso_rvus
;

625 
nssow
 = 
rvu
->
pf_limôs
.
ssow
->
max_sum
 / 
sso_rvus
;

626 
¡im
 = 
rvu
->
pf_limôs
.
tim
->
max_sum
 / 
sso_rvus
;

627 
tŸÆ_˝t_lfs
 = 
rvu
->
pf_limôs
.
˝t
->
max_sum
;

629 i‡(
tŸÆ_˝t_lfs
) {

631 
n˝çf_˝éfs
 = 
	`num_⁄löe_˝us
() + 1;

632 
nss›f_˝éfs
 = (
tŸÆ_˝t_lfs
 - 
n˝çf_˝éfs
Ë/ 
sso_rvus
;

635 
¬∑
 = 
rvu
->
pf_limôs
.
≈a
->
max_sum
;

636 
¬ix
 = 
rvu
->
pf_limôs
.
nix
->
max_sum
;

637 i‡(!
rvu
->
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
) {

638 
nsmq
 = 
rvu
->
pf_limôs
.
smq
->
max_sum
 / 
nix_rvus
;

639 
¡l4
 = 
rvu
->
pf_limôs
.
é4
->
max_sum
 / 
nix_rvus
;

640 
¡l3
 = 
rvu
->
pf_limôs
.
é3
->
max_sum
 / 
nix_rvus
;

641 
¡l2
 = 
rvu
->
pf_limôs
.
é2
->
max_sum
 / 
nix_rvus
;

645 
i
 = 0; i < 
rvu
->
hw
->
tŸÆ_pfs
; i++) {

646 i‡(
rvu
->
pf
[
i
].
pdev
 =
NULL
)

648 
nvfs
 = 
	`pci_§iov_gë_tŸÆvfs
(
rvu
->
pf
[
i
].
pdev
);

649 
rvu
->
pf
[
i
].
pdev
->
devi˚
) {

650 
PCI_DEVID_OCTEONTX2_RVU_AF
:

651 
¬ix
 -
nvfs
;

652 
¬∑
 -
nvfs
;

653 
rvu
->
pf_limôs
.
nix
->
a
[
i
].
vÆ
 = 
¬ix
 > 0 ? 
nvfs
 : 0;

654 
rvu
->
pf_limôs
.
≈a
->
a
[
i
].
vÆ
 = 
¬∑
 > 0 ? 
nvfs
 : 0;

655 i‡(
rvu
->
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
)

657 
rvu
->
pf_limôs
.
smq
->
a
[
i
].
vÆ
 = 
nsmq
;

658 
rvu
->
pf_limôs
.
é4
->
a
[
i
].
vÆ
 = 
¡l4
;

659 
rvu
->
pf_limôs
.
é3
->
a
[
i
].
vÆ
 = 
¡l3
;

660 
rvu
->
pf_limôs
.
é2
->
a
[
i
].
vÆ
 = 
¡l2
;

662 
PCI_DEVID_OCTEONTX2_RVU_PF
:

663 
¬ix
 -1 + 
nvfs
;

664 
¬∑
 -1 + 
nvfs
;

665 
rvu
->
pf_limôs
.
nix
->
a
[
i
].
vÆ
 = 
¬ix
 > 0 ? 1 + 
nvfs
 : 0;

666 
rvu
->
pf_limôs
.
≈a
->
a
[
i
].
vÆ
 = 
¬∑
 > 0 ? 1 + 
nvfs
 : 0;

667 i‡(
rvu
->
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
)

669 
rvu
->
pf_limôs
.
smq
->
a
[
i
].
vÆ
 = 
nsmq
;

670 
rvu
->
pf_limôs
.
é4
->
a
[
i
].
vÆ
 = 
¡l4
;

671 
rvu
->
pf_limôs
.
é3
->
a
[
i
].
vÆ
 = 
¡l3
;

672 
rvu
->
pf_limôs
.
é2
->
a
[
i
].
vÆ
 = 
¡l2
;

674 
PCI_DEVID_OCTEONTX2_SSO_RVU_PF
:

675 
¬∑
 -1 + 
nvfs
;

676 
rvu
->
pf_limôs
.
≈a
->
a
[
i
].
vÆ
 = 
¬∑
 > 0 ? 1 + 
nvfs
 : 0;

677 
rvu
->
pf_limôs
.
sso
->
a
[
i
].
vÆ
 = 
nsso
;

678 
rvu
->
pf_limôs
.
ssow
->
a
[
i
].
vÆ
 = 
nssow
;

679 
rvu
->
pf_limôs
.
tim
->
a
[
i
].
vÆ
 = 
¡im
;

680 
rvu
->
pf_limôs
.
˝t
->
a
[
i
].
vÆ
 = 
nss›f_˝éfs
;

682 
PCI_DEVID_OCTEONTX2_NPA_RVU_PF
:

683 
¬∑
 -1 + 
nvfs
;

684 
rvu
->
pf_limôs
.
≈a
->
a
[
i
].
vÆ
 = 
¬∑
 > 0 ? 1 + 
nvfs
 : 0;

686 
PCI_DEVID_OCTEONTX2_CPT_RVU_PF
:

687 
PCI_DEVID_OCTEONTX2_CPT10_RVU_PF
:

688 
¬∑
 -= 1;

689 
rvu
->
pf_limôs
.
≈a
->
a
[
i
].
vÆ
 = 
¬∑
 > 0 ? 1 : 0;

690 
rvu
->
pf_limôs
.
˝t
->
a
[
i
].
vÆ
 = 
n˝çf_˝éfs
;

692 
PCI_DEVID_OCTEONTX2_SDP_RVU_PF
:

693 
¬ix
 -1 + 
nvfs
;

694 
rvu
->
pf_limôs
.
nix
->
a
[
i
].
vÆ
 = 
¬ix
 > 0 ? 1 + 
nvfs
 : 0;

695 i‡(
rvu
->
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
)

697 
rvu
->
pf_limôs
.
smq
->
a
[
i
].
vÆ
 = 
nsmq
;

698 
rvu
->
pf_limôs
.
é4
->
a
[
i
].
vÆ
 = 
¡l4
;

699 
rvu
->
pf_limôs
.
é3
->
a
[
i
].
vÆ
 = 
¡l3
;

700 
rvu
->
pf_limôs
.
é2
->
a
[
i
].
vÆ
 = 
¡l2
;

704 
	}
}

706 
	$rvu_¸óã_limôs_sysfs
(
rvu
 *rvu)

708 
pci_dev
 *
pdev
;

709 
rvu_pfvf
 *
pf
;

710 
i
, 
îr
 = 0;

712 
i
 = 0; i < 
rvu
->
hw
->
tŸÆ_pfs
; i++) {

713 
pf
 = &
rvu
->pf[
i
];

714 i‡(!
pf
->
pdev
)

716 
pdev
 = 
pf
->pdev;

718 
pf
->
limôs_kobj
 = 
	`kobje˘_¸óã_™d_add
("limits",

719 &
pdev
->
dev
.
kobj
);

721 i‡(
	`quŸa_sysfs_¸óã
("sso", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

722 &
rvu
->
pf_limôs
.
sso
->
a
[
i
], 
pf
)) {

723 
	`dev_îr
(
rvu
->
dev
,

725 
	`pci_«me
(
pdev
));

726 
îr
 = -
EFAULT
;

730 i‡(
	`quŸa_sysfs_¸óã
("ssow", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

731 &
rvu
->
pf_limôs
.
ssow
->
a
[
i
], 
pf
)) {

732 
	`dev_îr
(
rvu
->
dev
,

734 
	`pci_«me
(
pdev
));

735 
îr
 = -
EFAULT
;

739 i‡(
	`quŸa_sysfs_¸óã
("tim", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

740 &
rvu
->
pf_limôs
.
tim
->
a
[
i
], 
pf
)) {

741 
	`dev_îr
(
rvu
->
dev
,

743 
	`pci_«me
(
pdev
));

744 
îr
 = -
EFAULT
;

748 i‡(
	`quŸa_sysfs_¸óã
("˝t", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

749 &
rvu
->
pf_limôs
.
˝t
->
a
[
i
], 
pf
)) {

750 
	`dev_îr
(
rvu
->
dev
,

752 
	`pci_«me
(
pdev
));

753 
îr
 = -
EFAULT
;

757 i‡(
	`quŸa_sysfs_¸óã
("≈a", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

758 &
rvu
->
pf_limôs
.
≈a
->
a
[
i
], 
pf
)) {

759 
	`dev_îr
(
rvu
->
dev
,

761 
	`pci_«me
(
pdev
));

762 
îr
 = -
EFAULT
;

766 i‡(
	`quŸa_sysfs_¸óã
("nix", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

767 &
rvu
->
pf_limôs
.
nix
->
a
[
i
], 
pf
)) {

768 
	`dev_îr
(
rvu
->
dev
,

770 
	`pci_«me
(
pdev
));

771 
îr
 = -
EFAULT
;

776 i‡(
rvu
->
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
)

779 i‡(
	`quŸa_sysfs_¸óã
("smq", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

780 &
rvu
->
pf_limôs
.
smq
->
a
[
i
], 
pf
)) {

781 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate quota for smq on %s\n",

782 
	`pci_«me
(
pf
->
pdev
));

783 
îr
 = -
EFAULT
;

787 i‡(
	`quŸa_sysfs_¸óã
("é4", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

788 &
rvu
->
pf_limôs
.
é4
->
a
[
i
], 
pf
)) {

789 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate quota forÅl4 on %s\n",

790 
	`pci_«me
(
pf
->
pdev
));

791 
îr
 = -
EFAULT
;

795 i‡(
	`quŸa_sysfs_¸óã
("é3", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

796 &
rvu
->
pf_limôs
.
é3
->
a
[
i
], 
pf
)) {

797 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate quota forÅl3 on %s\n",

798 
	`pci_«me
(
pf
->
pdev
));

799 
îr
 = -
EFAULT
;

803 i‡(
	`quŸa_sysfs_¸óã
("é2", 
pf
->
limôs_kobj
, 
rvu
->
dev
,

804 &
rvu
->
pf_limôs
.
é2
->
a
[
i
], 
pf
)) {

805 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate quota forÅl2 on %s\n",

806 
	`pci_«me
(
pf
->
pdev
));

807 
îr
 = -
EFAULT
;

812  
îr
;

813 
	}
}

815 
	$rvu_pﬁicy_de°roy
(
rvu
 *rvu)

817 
rvu_pfvf
 *
pf
 = 
NULL
;

818 
i
;

820 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

823 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
sso
);

824 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
ssow
);

825 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
≈a
);

826 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
˝t
);

827 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
tim
);

828 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
nix
);

830 
rvu
->
pf_limôs
.
sso
 = 
NULL
;

831 
rvu
->
pf_limôs
.
ssow
 = 
NULL
;

832 
rvu
->
pf_limôs
.
≈a
 = 
NULL
;

833 
rvu
->
pf_limôs
.
˝t
 = 
NULL
;

834 
rvu
->
pf_limôs
.
tim
 = 
NULL
;

835 
rvu
->
pf_limôs
.
nix
 = 
NULL
;

837 i‡(
rvu
->
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
) {

838 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
smq
);

839 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
é4
);

840 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
é3
);

841 
	`quŸas_‰ì
(
rvu
->
pf_limôs
.
é2
);

843 
rvu
->
pf_limôs
.
smq
 = 
NULL
;

844 
rvu
->
pf_limôs
.
é4
 = 
NULL
;

845 
rvu
->
pf_limôs
.
é3
 = 
NULL
;

846 
rvu
->
pf_limôs
.
é2
 = 
NULL
;

849 
i
 = 0; i < 
rvu
->
hw
->
tŸÆ_pfs
; i++) {

850 
pf
 = &
rvu
->pf[
i
];

851 
	`kobje˘_dñ
(
pf
->
limôs_kobj
);

853 
	}
}

855 
	$rvu_pﬁicy_öô
(
rvu
 *rvu)

857 
nix_hw
 *nix_hw = 
	`gë_nix_hw
(
rvu
->
hw
, 
BLKADDR_NIX0
);

858 
pci_dev
 *
pdev
 = 
rvu
->pdev;

859 
rvu_hwöfo
 *
hw
 = 
rvu
->hw;

860 
îr
 = -
EINVAL
, 
i
 = 0;

861 
u32
 
max
 = 0;

863 i‡(!
	`is_rvu_Ÿx2
(
rvu
))

866 i‡(!
nix_hw
)

867 
îr‹
;

869 
max
 = 
hw
->
block
[
BLKADDR_SSO
].
lf
.max;

870 
rvu
->
pf_limôs
.
sso
 = 
	`quŸas_Æloc
‘vu->
hw
->
tŸÆ_pfs
, 
max
, max,

871 0, &
rvu
->
r§c_lock
, &
pf_limô_›s
);

872 i‡(!
rvu
->
pf_limôs
.
sso
) {

873 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate ssoÜimits\n");

874 
îr
 = -
EFAULT
;

875 
îr‹
;

878 
max
 = 
hw
->
block
[
BLKADDR_SSOW
].
lf
.max;

879 
rvu
->
pf_limôs
.
ssow
 = 
	`quŸas_Æloc
‘vu->
hw
->
tŸÆ_pfs
, 
max
, max,

880 0, &
rvu
->
r§c_lock
, &
pf_limô_›s
);

881 i‡(!
rvu
->
pf_limôs
.
ssow
) {

882 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate ssowÜimits\n");

883 
îr
 = -
EFAULT
;

884 
îr‹
;

887 
max
 = 
hw
->
block
[
BLKADDR_TIM
].
lf
.max;

888 
rvu
->
pf_limôs
.
tim
 = 
	`quŸas_Æloc
‘vu->
hw
->
tŸÆ_pfs
, 
max
, max,

889 0, &
rvu
->
r§c_lock
, &
pf_limô_›s
);

890 i‡(!
rvu
->
pf_limôs
.
tim
) {

891 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocateÅimÜimits\n");

892 
îr
 = -
EFAULT
;

893 
îr‹
;

896 
max
 = 
hw
->
block
[
BLKADDR_CPT0
].
lf
.max;

897 
rvu
->
pf_limôs
.
˝t
 = 
	`quŸas_Æloc
‘vu->
hw
->
tŸÆ_pfs
, 
max
, max,

898 0, &
rvu
->
r§c_lock
, &
pf_limô_›s
);

899 i‡(!
rvu
->
pf_limôs
.
˝t
) {

900 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate cptÜimits\n");

901 
îr
 = -
EFAULT
;

902 
îr‹
;

908 
max
 = 
hw
->
block
[
BLKADDR_NPA
].
lf
.max;

909 
rvu
->
pf_limôs
.
≈a
 = 
	`quŸas_Æloc
‘vu->
hw
->
tŸÆ_pfs
, 
max
, max,

910 0, &
rvu
->
r§c_lock
, &
pf_limô_›s
);

911 i‡(!
rvu
->
pf_limôs
.
≈a
) {

912 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocateÇpaÜimits\n");

913 
îr
 = -
EFAULT
;

914 
îr‹
;

917 
max
 = 
hw
->
block
[
BLKADDR_NIX0
].
lf
.max + hw->block[
BLKADDR_NIX1
].lf.max;

918 
rvu
->
pf_limôs
.
nix
 = 
	`quŸas_Æloc
‘vu->
hw
->
tŸÆ_pfs
, 
max
, max,

919 0, &
rvu
->
r§c_lock
, &
pf_limô_›s
);

920 i‡(!
rvu
->
pf_limôs
.
nix
) {

921 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocateÇixÜimits\n");

922 
îr
 = -
EFAULT
;

923 
îr‹
;

926 i‡(
rvu
->
hw
->
ˇp
.
nix_fixed_txschq_m≠pög
)

927 
skù_txschq_limôs
;

929 
max
 = 
nix_hw
->
txsch
[
NIX_TXSCH_LVL_SMQ
].
schq
.max;

930 
rvu
->
pf_limôs
.
smq
 = 
	`quŸas_Æloc
(
hw
->
tŸÆ_pfs
, 
max
, max, 0,

931 &
rvu
->
r§c_lock
, &
pf_limô_›s
);

932 i‡(!
rvu
->
pf_limôs
.
smq
) {

933 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate SQMÅxschqÜimits\n");

934 
îr
 = -
EFAULT
;

935 
îr‹
;

938 
max
 = 
nix_hw
->
txsch
[
NIX_TXSCH_LVL_TL4
].
schq
.max;

939 
rvu
->
pf_limôs
.
é4
 = 
	`quŸas_Æloc
(
hw
->
tŸÆ_pfs
, 
max
, max, 0,

940 &
rvu
->
r§c_lock
, &
pf_limô_›s
);

941 i‡(!
rvu
->
pf_limôs
.
é4
) {

942 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate TL4ÅxschqÜimits\n");

943 
îr
 = -
EFAULT
;

944 
îr‹
;

947 
max
 = 
nix_hw
->
txsch
[
NIX_TXSCH_LVL_TL3
].
schq
.max;

948 
rvu
->
pf_limôs
.
é3
 = 
	`quŸas_Æloc
(
hw
->
tŸÆ_pfs
, 
max
, max, 0,

949 &
rvu
->
r§c_lock
, &
pf_limô_›s
);

950 i‡(!
rvu
->
pf_limôs
.
é3
) {

951 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate TL3ÅxschqÜimits\n");

952 
îr
 = -
EFAULT
;

953 
îr‹
;

956 
max
 = 
nix_hw
->
txsch
[
NIX_TXSCH_LVL_TL2
].
schq
.max;

957 
rvu
->
pf_limôs
.
é2
 = 
	`quŸas_Æloc
(
hw
->
tŸÆ_pfs
, 
max
, max, 0,

958 &
rvu
->
r§c_lock
, &
pf_limô_›s
);

959 i‡(!
rvu
->
pf_limôs
.
é2
) {

960 
	`dev_îr
(
rvu
->
dev
, "FailedÅoállocate TL2ÅxschqÜimits\n");

961 
îr
 = -
EFAULT
;

962 
îr‹
;

965 
skù_txschq_limôs
:

966 
i
 = 0; i < 
hw
->
tŸÆ_pfs
; i++)

967 
rvu
->
pf
[
i
].
pdev
 =

968 
	`pci_gë_domaö_bus_™d_¶Ÿ
(
	`pci_domaö_ƒ
(
pdev
->
bus
),

969 
i
 + 1, 0);

971 
	`rvu_£t_deÁu…_limôs
(
rvu
);

973 
îr
 = 
	`rvu_¸óã_limôs_sysfs
(
rvu
);

974 i‡(
îr
) {

975 
	`dev_îr
(
rvu
->
dev
, "FailedÅo createÜimits sysfs\n");

976 
îr‹
;

981 
îr‹
:

982 
	`rvu_pﬁicy_de°roy
(
rvu
);

983  
îr
;

984 
	}
}

	@rvu_validation.h

8 #i‚de‡
RVU_VALIDATION_H


9 
	#RVU_VALIDATION_H


	)

11 
	grvu
;

12 
	grvu_quŸas
;

14 
	srvu_quŸa
 {

15 
kobj_©åibuã
 
	msysfs
;

17 
devi˚
 *
	mdev
;

19 
kobje˘
 *
	m∑ª¡
;

21 
rvu_quŸas
 *
	mba£
;

23 *
	m›s_¨g
;

25 
	mvÆ
;

28 
	srvu_quŸa_›s
 {

33 (*
	m¥e_°‹e
)(*
	m¨g
, 
rvu_quŸa
 *
	mquŸa
, 
	m√w_vÆ
);

35 (*
	mpo°_°‹e
)(*
	m¨g
, 
rvu_quŸa
 *
	mquŸa
, 
	mﬁd_vÆ
);

38 
	srvu_quŸas
 {

39 
rvu_quŸa_›s
 
	m›s
;

40 
muãx
 *
	mlock
;

41 
u32
 
	m˙t
;

42 
u32
 
	mmax
;

43 
u64
 
	mmax_sum
;

44 
rvu_quŸa
 
	ma
[0];

47 
	srvu_limôs
 {

48 
rvu_quŸas
 *
	msso
;

49 
rvu_quŸas
 *
	mssow
;

50 
rvu_quŸas
 *
	mtim
;

51 
rvu_quŸas
 *
	m˝t
;

52 
rvu_quŸas
 *
	m≈a
;

53 
rvu_quŸas
 *
	mnix
;

54 
rvu_quŸas
 *
	msmq
;

55 
rvu_quŸas
 *
	mé4
;

56 
rvu_quŸas
 *
	mé3
;

57 
rvu_quŸas
 *
	mé2
;

60 
rvu_pﬁicy_öô
(
rvu
 *rvu);

61 
rvu_pﬁicy_de°roy
(
rvu
 *rvu);

62 
rvu_check_r§c_pﬁicy
(
rvu
 *rvu,

63 
r§c_©èch
 *
ªq
, 
u16
 
pcifunc
);

64 
rvu_check_txsch_pﬁicy
(
rvu
 *rvu, 
nix_txsch_Æloc_ªq
 *
ªq
,

65 
u16
 
pcifunc
);

67 
rvu_mbox_h™dÀr_‰ì_r§c_˙t
(
rvu
 *rvu, 
msg_ªq
 *
ªq
,

68 
‰ì_r§cs_r•
 *
r•
);

	@/usr/include/linux/ethtool.h

14 #i‚de‡
_LINUX_ETHTOOL_H


15 
	#_LINUX_ETHTOOL_H


	)

17 
	~<löux/c⁄°.h
>

18 
	~<löux/ty≥s.h
>

19 
	~<löux/if_ëhî.h
>

21 
	~<limôs.h
>

94 
	sëhtoﬁ_cmd
 {

95 
__u32
 
	mcmd
;

96 
__u32
 
	msuµ‹ãd
;

97 
__u32
 
	madvîtisög
;

98 
__u16
 
	m•ìd
;

99 
__u8
 
	mdu∂ex
;

100 
__u8
 
	mp‹t
;

101 
__u8
 
	mphy_addªss
;

102 
__u8
 
	må™s˚ivî
;

103 
__u8
 
	maut⁄eg
;

104 
__u8
 
	mmdio_suµ‹t
;

105 
__u32
 
	mmaxtxpkt
;

106 
__u32
 
	mmaxrxpkt
;

107 
__u16
 
	m•ìd_hi
;

108 
__u8
 
	mëh_ç_mdix
;

109 
__u8
 
	mëh_ç_mdix_˘æ
;

110 
__u32
 
	mÕ_advîtisög
;

111 
__u32
 
	mª£rved
[2];

114 
__ölöe__
 
	$ëhtoﬁ_cmd_•ìd_£t
(
ëhtoﬁ_cmd
 *
ï
,

115 
__u32
 
•ìd
)

117 
ï
->
•ìd
 = (
__u16
)(speed & 0xFFFF);

118 
ï
->
•ìd_hi
 = (
__u16
)(
•ìd
 >> 16);

119 
	}
}

121 
__ölöe__
 
__u32
 
	$ëhtoﬁ_cmd_•ìd
(c⁄° 
ëhtoﬁ_cmd
 *
ï
)

123  (
ï
->
•ìd_hi
 << 16Ë|Ép->
•ìd
;

124 
	}
}

131 
	#ETH_MDIO_SUPPORTS_C22
 1

	)

138 
	#ETH_MDIO_SUPPORTS_C45
 2

	)

140 
	#ETHTOOL_FWVERS_LEN
 32

	)

141 
	#ETHTOOL_BUSINFO_LEN
 32

	)

142 
	#ETHTOOL_EROMVERS_LEN
 32

	)

175 
	sëhtoﬁ_drvöfo
 {

176 
__u32
 
	mcmd
;

177 
	mdrivî
[32];

178 
	mvîsi⁄
[32];

179 
	mfw_vîsi⁄
[
ETHTOOL_FWVERS_LEN
];

180 
	mbus_öfo
[
ETHTOOL_BUSINFO_LEN
];

181 
	mîom_vîsi⁄
[
ETHTOOL_EROMVERS_LEN
];

182 
	mª£rved2
[12];

183 
__u32
 
	mn_¥iv_Êags
;

184 
__u32
 
	mn_°©s
;

185 
__u32
 
	mã°öfo_Àn
;

186 
__u32
 
	mìdump_Àn
;

187 
__u32
 
	mªgdump_Àn
;

190 
	#SOPASS_MAX
 6

	)

201 
	sëhtoﬁ_wﬁöfo
 {

202 
__u32
 
	mcmd
;

203 
__u32
 
	msuµ‹ãd
;

204 
__u32
 
	mwﬁ›ts
;

205 
__u8
 
	ms›ass
[
SOPASS_MAX
];

209 
	sëhtoﬁ_vÆue
 {

210 
__u32
 
	mcmd
;

211 
__u32
 
	md©a
;

214 
	#PFC_STORM_PREVENTION_AUTO
 0xffff

	)

215 
	#PFC_STORM_PREVENTION_DISABLE
 0

	)

217 
	etu«bÀ_id
 {

218 
	mETHTOOL_ID_UNSPEC
,

219 
	mETHTOOL_RX_COPYBREAK
,

220 
	mETHTOOL_TX_COPYBREAK
,

221 
	mETHTOOL_PFC_PREVENTION_TOUT
,

226 
	m__ETHTOOL_TUNABLE_COUNT
,

229 
	etu«bÀ_ty≥_id
 {

230 
	mETHTOOL_TUNABLE_UNSPEC
,

231 
	mETHTOOL_TUNABLE_U8
,

232 
	mETHTOOL_TUNABLE_U16
,

233 
	mETHTOOL_TUNABLE_U32
,

234 
	mETHTOOL_TUNABLE_U64
,

235 
	mETHTOOL_TUNABLE_STRING
,

236 
	mETHTOOL_TUNABLE_S8
,

237 
	mETHTOOL_TUNABLE_S16
,

238 
	mETHTOOL_TUNABLE_S32
,

239 
	mETHTOOL_TUNABLE_S64
,

242 
	sëhtoﬁ_tu«bÀ
 {

243 
__u32
 
	mcmd
;

244 
__u32
 
	mid
;

245 
__u32
 
	mty≥_id
;

246 
__u32
 
	mÀn
;

247 *
	md©a
[0];

250 
	#DOWNSHIFT_DEV_DEFAULT_COUNT
 0xff

	)

251 
	#DOWNSHIFT_DEV_DISABLE
 0

	)

257 
	#ETHTOOL_PHY_FAST_LINK_DOWN_ON
 0

	)

258 
	#ETHTOOL_PHY_FAST_LINK_DOWN_OFF
 0xff

	)

277 
	#ETHTOOL_PHY_EDPD_DFLT_TX_MSECS
 0xffff

	)

278 
	#ETHTOOL_PHY_EDPD_NO_TX
 0xff„

	)

279 
	#ETHTOOL_PHY_EDPD_DISABLE
 0

	)

281 
	ephy_tu«bÀ_id
 {

282 
	mETHTOOL_PHY_ID_UNSPEC
,

283 
	mETHTOOL_PHY_DOWNSHIFT
,

284 
	mETHTOOL_PHY_FAST_LINK_DOWN
,

285 
	mETHTOOL_PHY_EDPD
,

290 
	m__ETHTOOL_PHY_TUNABLE_COUNT
,

308 
	sëhtoﬁ_ªgs
 {

309 
__u32
 
	mcmd
;

310 
__u32
 
	mvîsi⁄
;

311 
__u32
 
	mÀn
;

312 
__u8
 
	md©a
[0];

333 
	sëhtoﬁ_ì¥om
 {

334 
__u32
 
	mcmd
;

335 
__u32
 
	mmagic
;

336 
__u32
 
	moff£t
;

337 
__u32
 
	mÀn
;

338 
__u8
 
	md©a
[0];

358 
	sëhtoﬁ_ìe
 {

359 
__u32
 
	mcmd
;

360 
__u32
 
	msuµ‹ãd
;

361 
__u32
 
	madvîti£d
;

362 
__u32
 
	mÕ_advîti£d
;

363 
__u32
 
	mìe_a˘ive
;

364 
__u32
 
	mìe_íabÀd
;

365 
__u32
 
	mtx_Õi_íabÀd
;

366 
__u32
 
	mtx_Õi_timî
;

367 
__u32
 
	mª£rved
[2];

380 
	sëhtoﬁ_modöfo
 {

381 
__u32
 
	mcmd
;

382 
__u32
 
	mty≥
;

383 
__u32
 
	mì¥om_Àn
;

384 
__u32
 
	mª£rved
[8];

460 
	sëhtoﬁ_cﬂÀs˚
 {

461 
__u32
 
	mcmd
;

462 
__u32
 
	mrx_cﬂÀs˚_u£cs
;

463 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames
;

464 
__u32
 
	mrx_cﬂÀs˚_u£cs_úq
;

465 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_úq
;

466 
__u32
 
	mtx_cﬂÀs˚_u£cs
;

467 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames
;

468 
__u32
 
	mtx_cﬂÀs˚_u£cs_úq
;

469 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_úq
;

470 
__u32
 
	m°©s_block_cﬂÀs˚_u£cs
;

471 
__u32
 
	mu£_ad≠tive_rx_cﬂÀs˚
;

472 
__u32
 
	mu£_ad≠tive_tx_cﬂÀs˚
;

473 
__u32
 
	mpkt_øã_low
;

474 
__u32
 
	mrx_cﬂÀs˚_u£cs_low
;

475 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_low
;

476 
__u32
 
	mtx_cﬂÀs˚_u£cs_low
;

477 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_low
;

478 
__u32
 
	mpkt_øã_high
;

479 
__u32
 
	mrx_cﬂÀs˚_u£cs_high
;

480 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_high
;

481 
__u32
 
	mtx_cﬂÀs˚_u£cs_high
;

482 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_high
;

483 
__u32
 
	møã_ßm∂e_öãrvÆ
;

511 
	sëhtoﬁ_rög∑øm
 {

512 
__u32
 
	mcmd
;

513 
__u32
 
	mrx_max_≥ndög
;

514 
__u32
 
	mrx_möi_max_≥ndög
;

515 
__u32
 
	mrx_jumbo_max_≥ndög
;

516 
__u32
 
	mtx_max_≥ndög
;

517 
__u32
 
	mrx_≥ndög
;

518 
__u32
 
	mrx_möi_≥ndög
;

519 
__u32
 
	mrx_jumbo_≥ndög
;

520 
__u32
 
	mtx_≥ndög
;

539 
	sëhtoﬁ_ch™√ls
 {

540 
__u32
 
	mcmd
;

541 
__u32
 
	mmax_rx
;

542 
__u32
 
	mmax_tx
;

543 
__u32
 
	mmax_Ÿhî
;

544 
__u32
 
	mmax_comböed
;

545 
__u32
 
	mrx_cou¡
;

546 
__u32
 
	mtx_cou¡
;

547 
__u32
 
	mŸhî_cou¡
;

548 
__u32
 
	mcomböed_cou¡
;

573 
	sëhtoﬁ_∑u£∑øm
 {

574 
__u32
 
	mcmd
;

575 
__u32
 
	maut⁄eg
;

576 
__u32
 
	mrx_∑u£
;

577 
__u32
 
	mtx_∑u£
;

580 
	#ETH_GSTRING_LEN
 32

	)

595 
	eëhtoﬁ_°rög£t
 {

596 
	mETH_SS_TEST
 = 0,

597 
	mETH_SS_STATS
,

598 
	mETH_SS_PRIV_FLAGS
,

599 
	mETH_SS_NTUPLE_FILTERS
,

600 
	mETH_SS_FEATURES
,

601 
	mETH_SS_RSS_HASH_FUNCS
,

602 
	mETH_SS_TUNABLES
,

603 
	mETH_SS_PHY_STATS
,

604 
	mETH_SS_PHY_TUNABLES
,

619 
	sëhtoﬁ_g°rögs
 {

620 
__u32
 
	mcmd
;

621 
__u32
 
	m°rög_£t
;

622 
__u32
 
	mÀn
;

623 
__u8
 
	md©a
[0];

643 
	sëhtoﬁ_s£t_öfo
 {

644 
__u32
 
	mcmd
;

645 
__u32
 
	mª£rved
;

646 
__u64
 
	ms£t_mask
;

647 
__u32
 
	md©a
[0];

660 
	eëhtoﬁ_ã°_Êags
 {

661 
	mETH_TEST_FL_OFFLINE
 = (1 << 0),

662 
	mETH_TEST_FL_FAILED
 = (1 << 1),

663 
	mETH_TEST_FL_EXTERNAL_LB
 = (1 << 2),

664 
	mETH_TEST_FL_EXTERNAL_LB_DONE
 = (1 << 3),

681 
	sëhtoﬁ_ã°
 {

682 
__u32
 
	mcmd
;

683 
__u32
 
	mÊags
;

684 
__u32
 
	mª£rved
;

685 
__u32
 
	mÀn
;

686 
__u64
 
	md©a
[0];

700 
	sëhtoﬁ_°©s
 {

701 
__u32
 
	mcmd
;

702 
__u32
 
	mn_°©s
;

703 
__u64
 
	md©a
[0];

717 
	sëhtoﬁ_≥rm_addr
 {

718 
__u32
 
	mcmd
;

719 
__u32
 
	msize
;

720 
__u8
 
	md©a
[0];

732 
	eëhtoﬁ_Êags
 {

733 
	mETH_FLAG_TXVLAN
 = (1 << 7),

734 
	mETH_FLAG_RXVLAN
 = (1 << 8),

735 
	mETH_FLAG_LRO
 = (1 << 15),

736 
	mETH_FLAG_NTUPLE
 = (1 << 27),

737 
	mETH_FLAG_RXHASH
 = (1 << 28),

756 
	sëhtoﬁ_t˝ù4_•ec
 {

757 
__be32
 
	mù4§c
;

758 
__be32
 
	mù4d°
;

759 
__be16
 
	mp§c
;

760 
__be16
 
	mpd°
;

761 
__u8
 
	mtos
;

773 
	sëhtoﬁ_ah_e•ù4_•ec
 {

774 
__be32
 
	mù4§c
;

775 
__be32
 
	mù4d°
;

776 
__be32
 
	m•i
;

777 
__u8
 
	mtos
;

780 
	#ETH_RX_NFC_IP4
 1

	)

791 
	sëhtoﬁ_u§ù4_•ec
 {

792 
__be32
 
	mù4§c
;

793 
__be32
 
	mù4d°
;

794 
__be32
 
	ml4_4_byãs
;

795 
__u8
 
	mtos
;

796 
__u8
 
	mù_vî
;

797 
__u8
 
	m¥Ÿo
;

810 
	sëhtoﬁ_t˝ù6_•ec
 {

811 
__be32
 
	mù6§c
[4];

812 
__be32
 
	mù6d°
[4];

813 
__be16
 
	mp§c
;

814 
__be16
 
	mpd°
;

815 
__u8
 
	mt˛ass
;

827 
	sëhtoﬁ_ah_e•ù6_•ec
 {

828 
__be32
 
	mù6§c
[4];

829 
__be32
 
	mù6d°
[4];

830 
__be32
 
	m•i
;

831 
__u8
 
	mt˛ass
;

842 
	sëhtoﬁ_u§ù6_•ec
 {

843 
__be32
 
	mù6§c
[4];

844 
__be32
 
	mù6d°
[4];

845 
__be32
 
	ml4_4_byãs
;

846 
__u8
 
	mt˛ass
;

847 
__u8
 
	ml4_¥Ÿo
;

850 
	uëhtoﬁ_Êow_uni⁄
 {

851 
ëhtoﬁ_t˝ù4_•ec
 
	mt˝_ù4_•ec
;

852 
ëhtoﬁ_t˝ù4_•ec
 
	mudp_ù4_•ec
;

853 
ëhtoﬁ_t˝ù4_•ec
 
	ms˘p_ù4_•ec
;

854 
ëhtoﬁ_ah_e•ù4_•ec
 
	mah_ù4_•ec
;

855 
ëhtoﬁ_ah_e•ù4_•ec
 
	me•_ù4_•ec
;

856 
ëhtoﬁ_u§ù4_•ec
 
	mu§_ù4_•ec
;

857 
ëhtoﬁ_t˝ù6_•ec
 
	mt˝_ù6_•ec
;

858 
ëhtoﬁ_t˝ù6_•ec
 
	mudp_ù6_•ec
;

859 
ëhtoﬁ_t˝ù6_•ec
 
	ms˘p_ù6_•ec
;

860 
ëhtoﬁ_ah_e•ù6_•ec
 
	mah_ù6_•ec
;

861 
ëhtoﬁ_ah_e•ù6_•ec
 
	me•_ù6_•ec
;

862 
ëhtoﬁ_u§ù6_•ec
 
	mu§_ù6_•ec
;

863 
ëhhdr
 
	mëhî_•ec
;

864 
__u8
 
	mhd©a
[52];

878 
	sëhtoﬁ_Êow_ext
 {

879 
__u8
 
	m∑ddög
[2];

880 
	mh_de°
[
ETH_ALEN
];

881 
__be16
 
	mvœn_ëy≥
;

882 
__be16
 
	mvœn_tci
;

883 
__be32
 
	md©a
[2];

903 
	sëhtoﬁ_rx_Êow_•ec
 {

904 
__u32
 
	mÊow_ty≥
;

905 
ëhtoﬁ_Êow_uni⁄
 
	mh_u
;

906 
ëhtoﬁ_Êow_ext
 
	mh_ext
;

907 
ëhtoﬁ_Êow_uni⁄
 
	mm_u
;

908 
ëhtoﬁ_Êow_ext
 
	mm_ext
;

909 
__u64
 
	mrög_cookõ
;

910 
__u32
 
	mloˇti⁄
;

924 
	#ETHTOOL_RX_FLOW_SPEC_RING
 0x00000000FFFFFFFFLL

	)

925 
	#ETHTOOL_RX_FLOW_SPEC_RING_VF
 0x000000FF00000000LL

	)

926 
	#ETHTOOL_RX_FLOW_SPEC_RING_VF_OFF
 32

	)

927 
__ölöe__
 
__u64
 
	$ëhtoﬁ_gë_Êow_•ec_rög
(
__u64
 
rög_cookõ
)

929  
ETHTOOL_RX_FLOW_SPEC_RING
 & 
rög_cookõ
;

930 
	}
}

932 
__ölöe__
 
__u64
 
	$ëhtoﬁ_gë_Êow_•ec_rög_vf
(
__u64
 
rög_cookõ
)

934  (
ETHTOOL_RX_FLOW_SPEC_RING_VF
 & 
rög_cookõ
) >>

935 
ETHTOOL_RX_FLOW_SPEC_RING_VF_OFF
;

936 
	}
}

999 
	sëhtoﬁ_rxnfc
 {

1000 
__u32
 
	mcmd
;

1001 
__u32
 
	mÊow_ty≥
;

1002 
__u64
 
	md©a
;

1003 
ëhtoﬁ_rx_Êow_•ec
 
	mfs
;

1005 
__u32
 
	mruÀ_˙t
;

1006 
__u32
 
	mrss_c⁄ãxt
;

1008 
__u32
 
	mruÀ_locs
[0];

1025 
	sëhtoﬁ_rxfh_ödú
 {

1026 
__u32
 
	mcmd
;

1027 
__u32
 
	msize
;

1028 
__u32
 
	mrög_ödex
[0];

1060 
	sëhtoﬁ_rxfh
 {

1061 
__u32
 
	mcmd
;

1062 
__u32
 
	mrss_c⁄ãxt
;

1063 
__u32
 
	mödú_size
;

1064 
__u32
 
	mkey_size
;

1065 
__u8
 
	mhfunc
;

1066 
__u8
 
	mrsvd8
[3];

1067 
__u32
 
	mrsvd32
;

1068 
__u32
 
	mrss_c⁄fig
[0];

1070 
	#ETH_RXFH_CONTEXT_ALLOC
 0xffffffff

	)

1071 
	#ETH_RXFH_INDIR_NO_CHANGE
 0xffffffff

	)

1089 
	sëhtoﬁ_rx_¡u∂e_Êow_•ec
 {

1090 
__u32
 
	mÊow_ty≥
;

1092 
ëhtoﬁ_t˝ù4_•ec
 
	mt˝_ù4_•ec
;

1093 
ëhtoﬁ_t˝ù4_•ec
 
	mudp_ù4_•ec
;

1094 
ëhtoﬁ_t˝ù4_•ec
 
	ms˘p_ù4_•ec
;

1095 
ëhtoﬁ_ah_e•ù4_•ec
 
	mah_ù4_•ec
;

1096 
ëhtoﬁ_ah_e•ù4_•ec
 
	me•_ù4_•ec
;

1097 
ëhtoﬁ_u§ù4_•ec
 
	mu§_ù4_•ec
;

1098 
ëhhdr
 
	mëhî_•ec
;

1099 
__u8
 
	mhd©a
[72];

1100 } 
	mh_u
, 
	mm_u
;

1102 
__u16
 
	mvœn_èg
;

1103 
__u16
 
	mvœn_èg_mask
;

1104 
__u64
 
	md©a
;

1105 
__u64
 
	md©a_mask
;

1107 
__s32
 
	ma˘i⁄
;

1108 
	#ETHTOOL_RXNTUPLE_ACTION_DROP
 (-1Ë

	)

1109 
	#ETHTOOL_RXNTUPLE_ACTION_CLEAR
 (-2Ë

	)

1117 
	sëhtoﬁ_rx_¡u∂e
 {

1118 
__u32
 
	mcmd
;

1119 
ëhtoﬁ_rx_¡u∂e_Êow_•ec
 
	mfs
;

1122 
	#ETHTOOL_FLASH_MAX_FILENAME
 128

	)

1123 
	eëhtoﬁ_Êash_›_ty≥
 {

1124 
	mETHTOOL_FLASH_ALL_REGIONS
 = 0,

1128 
	sëhtoﬁ_Êash
 {

1129 
__u32
 
	mcmd
;

1130 
__u32
 
	mªgi⁄
;

1131 
	md©a
[
ETHTOOL_FLASH_MAX_FILENAME
];

1148 
	sëhtoﬁ_dump
 {

1149 
__u32
 
	mcmd
;

1150 
__u32
 
	mvîsi⁄
;

1151 
__u32
 
	mÊag
;

1152 
__u32
 
	mÀn
;

1153 
__u8
 
	md©a
[0];

1156 
	#ETH_FW_DUMP_DISABLE
 0

	)

1167 
	sëhtoﬁ_gë_„©uªs_block
 {

1168 
__u32
 
	mavaûabÀ
;

1169 
__u32
 
	mªque°ed
;

1170 
__u32
 
	ma˘ive
;

1171 
__u32
 
	m√vî_ch™ged
;

1182 
	sëhtoﬁ_g„©uªs
 {

1183 
__u32
 
	mcmd
;

1184 
__u32
 
	msize
;

1185 
ëhtoﬁ_gë_„©uªs_block
 
	m„©uªs
[0];

1193 
	sëhtoﬁ_£t_„©uªs_block
 {

1194 
__u32
 
	mvÆid
;

1195 
__u32
 
	mªque°ed
;

1204 
	sëhtoﬁ_s„©uªs
 {

1205 
__u32
 
	mcmd
;

1206 
__u32
 
	msize
;

1207 
ëhtoﬁ_£t_„©uªs_block
 
	m„©uªs
[0];

1228 
	sëhtoﬁ_ts_öfo
 {

1229 
__u32
 
	mcmd
;

1230 
__u32
 
	mso_time°ampög
;

1231 
__s32
 
	mphc_ödex
;

1232 
__u32
 
	mtx_ty≥s
;

1233 
__u32
 
	mtx_ª£rved
[3];

1234 
__u32
 
	mrx_fûãrs
;

1235 
__u32
 
	mrx_ª£rved
[3];

1263 
	eëhtoﬁ_s„©uªs_ªtvÆ_bôs
 {

1264 
	mETHTOOL_F_UNSUPPORTED__BIT
,

1265 
	mETHTOOL_F_WISH__BIT
,

1266 
	mETHTOOL_F_COMPAT__BIT
,

1269 
	#ETHTOOL_F_UNSUPPORTED
 (1 << 
ETHTOOL_F_UNSUPPORTED__BIT
)

	)

1270 
	#ETHTOOL_F_WISH
 (1 << 
ETHTOOL_F_WISH__BIT
)

	)

1271 
	#ETHTOOL_F_COMPAT
 (1 << 
ETHTOOL_F_COMPAT__BIT
)

	)

1273 
	#MAX_NUM_QUEUE
 4096

	)

1282 
	sëhtoﬁ_≥r_queue_›
 {

1283 
__u32
 
	mcmd
;

1284 
__u32
 
	msub_comm™d
;

1285 
__u32
 
	mqueue_mask
[
__KERNEL_DIV_ROUND_UP
(
MAX_NUM_QUEUE
, 32)];

1286 
	md©a
[];

1300 
	sëhtoﬁ_„˝¨am
 {

1301 
__u32
 
	mcmd
;

1303 
__u32
 
	ma˘ive_„c
;

1304 
__u32
 
	m„c
;

1305 
__u32
 
	mª£rved
;

1316 
	eëhtoﬁ_„c_c⁄fig_bôs
 {

1317 
	mETHTOOL_FEC_NONE_BIT
,

1318 
	mETHTOOL_FEC_AUTO_BIT
,

1319 
	mETHTOOL_FEC_OFF_BIT
,

1320 
	mETHTOOL_FEC_RS_BIT
,

1321 
	mETHTOOL_FEC_BASER_BIT
,

1324 
	#ETHTOOL_FEC_NONE
 (1 << 
ETHTOOL_FEC_NONE_BIT
)

	)

1325 
	#ETHTOOL_FEC_AUTO
 (1 << 
ETHTOOL_FEC_AUTO_BIT
)

	)

1326 
	#ETHTOOL_FEC_OFF
 (1 << 
ETHTOOL_FEC_OFF_BIT
)

	)

1327 
	#ETHTOOL_FEC_RS
 (1 << 
ETHTOOL_FEC_RS_BIT
)

	)

1328 
	#ETHTOOL_FEC_BASER
 (1 << 
ETHTOOL_FEC_BASER_BIT
)

	)

1331 
	#ETHTOOL_GSET
 0x00000001

	)

1334 
	#ETHTOOL_SSET
 0x00000002

	)

1337 
	#ETHTOOL_GDRVINFO
 0x00000003

	)

1338 
	#ETHTOOL_GREGS
 0x00000004

	)

1339 
	#ETHTOOL_GWOL
 0x00000005

	)

1340 
	#ETHTOOL_SWOL
 0x00000006

	)

1341 
	#ETHTOOL_GMSGLVL
 0x00000007

	)

1342 
	#ETHTOOL_SMSGLVL
 0x00000008

	)

1343 
	#ETHTOOL_NWAY_RST
 0x00000009

	)

1346 
	#ETHTOOL_GLINK
 0x0000000a

	)

1347 
	#ETHTOOL_GEEPROM
 0x0000000b

	)

1348 
	#ETHTOOL_SEEPROM
 0x0000000¯

	)

1349 
	#ETHTOOL_GCOALESCE
 0x0000000ê

	)

1350 
	#ETHTOOL_SCOALESCE
 0x0000000‡

	)

1351 
	#ETHTOOL_GRINGPARAM
 0x00000010

	)

1352 
	#ETHTOOL_SRINGPARAM
 0x00000011

	)

1353 
	#ETHTOOL_GPAUSEPARAM
 0x00000012

	)

1354 
	#ETHTOOL_SPAUSEPARAM
 0x00000013

	)

1355 
	#ETHTOOL_GRXCSUM
 0x00000014

	)

1356 
	#ETHTOOL_SRXCSUM
 0x00000015

	)

1357 
	#ETHTOOL_GTXCSUM
 0x00000016

	)

1358 
	#ETHTOOL_STXCSUM
 0x00000017

	)

1359 
	#ETHTOOL_GSG
 0x00000018

	)

1361 
	#ETHTOOL_SSG
 0x00000019

	)

1363 
	#ETHTOOL_TEST
 0x0000001®

	)

1364 
	#ETHTOOL_GSTRINGS
 0x0000001b

	)

1365 
	#ETHTOOL_PHYS_ID
 0x0000001¯

	)

1366 
	#ETHTOOL_GSTATS
 0x0000001d

	)

1367 
	#ETHTOOL_GTSO
 0x0000001ê

	)

1368 
	#ETHTOOL_STSO
 0x0000001‡

	)

1369 
	#ETHTOOL_GPERMADDR
 0x00000020

	)

1370 
	#ETHTOOL_GUFO
 0x00000021

	)

1371 
	#ETHTOOL_SUFO
 0x00000022

	)

1372 
	#ETHTOOL_GGSO
 0x00000023

	)

1373 
	#ETHTOOL_SGSO
 0x00000024

	)

1374 
	#ETHTOOL_GFLAGS
 0x00000025

	)

1375 
	#ETHTOOL_SFLAGS
 0x00000026

	)

1376 
	#ETHTOOL_GPFLAGS
 0x00000027

	)

1377 
	#ETHTOOL_SPFLAGS
 0x00000028

	)

1379 
	#ETHTOOL_GRXFH
 0x00000029

	)

1380 
	#ETHTOOL_SRXFH
 0x0000002®

	)

1381 
	#ETHTOOL_GGRO
 0x0000002b

	)

1382 
	#ETHTOOL_SGRO
 0x0000002¯

	)

1383 
	#ETHTOOL_GRXRINGS
 0x0000002d

	)

1384 
	#ETHTOOL_GRXCLSRLCNT
 0x0000002ê

	)

1385 
	#ETHTOOL_GRXCLSRULE
 0x0000002‡

	)

1386 
	#ETHTOOL_GRXCLSRLALL
 0x00000030

	)

1387 
	#ETHTOOL_SRXCLSRLDEL
 0x00000031

	)

1388 
	#ETHTOOL_SRXCLSRLINS
 0x00000032

	)

1389 
	#ETHTOOL_FLASHDEV
 0x00000033

	)

1390 
	#ETHTOOL_RESET
 0x00000034

	)

1391 
	#ETHTOOL_SRXNTUPLE
 0x00000035

	)

1392 
	#ETHTOOL_GRXNTUPLE
 0x00000036

	)

1393 
	#ETHTOOL_GSSET_INFO
 0x00000037

	)

1394 
	#ETHTOOL_GRXFHINDIR
 0x00000038

	)

1395 
	#ETHTOOL_SRXFHINDIR
 0x00000039

	)

1397 
	#ETHTOOL_GFEATURES
 0x0000003®

	)

1398 
	#ETHTOOL_SFEATURES
 0x0000003b

	)

1399 
	#ETHTOOL_GCHANNELS
 0x0000003¯

	)

1400 
	#ETHTOOL_SCHANNELS
 0x0000003d

	)

1401 
	#ETHTOOL_SET_DUMP
 0x0000003ê

	)

1402 
	#ETHTOOL_GET_DUMP_FLAG
 0x0000003‡

	)

1403 
	#ETHTOOL_GET_DUMP_DATA
 0x00000040

	)

1404 
	#ETHTOOL_GET_TS_INFO
 0x00000041

	)

1405 
	#ETHTOOL_GMODULEINFO
 0x00000042

	)

1406 
	#ETHTOOL_GMODULEEEPROM
 0x00000043

	)

1407 
	#ETHTOOL_GEEE
 0x00000044

	)

1408 
	#ETHTOOL_SEEE
 0x00000045

	)

1410 
	#ETHTOOL_GRSSH
 0x00000046

	)

1411 
	#ETHTOOL_SRSSH
 0x00000047

	)

1412 
	#ETHTOOL_GTUNABLE
 0x00000048

	)

1413 
	#ETHTOOL_STUNABLE
 0x00000049

	)

1414 
	#ETHTOOL_GPHYSTATS
 0x0000004®

	)

1416 
	#ETHTOOL_PERQUEUE
 0x0000004b

	)

1418 
	#ETHTOOL_GLINKSETTINGS
 0x0000004¯

	)

1419 
	#ETHTOOL_SLINKSETTINGS
 0x0000004d

	)

1420 
	#ETHTOOL_PHY_GTUNABLE
 0x0000004ê

	)

1421 
	#ETHTOOL_PHY_STUNABLE
 0x0000004‡

	)

1422 
	#ETHTOOL_GFECPARAM
 0x00000050

	)

1423 
	#ETHTOOL_SFECPARAM
 0x00000051

	)

1426 
	#SPARC_ETH_GSET
 
ETHTOOL_GSET


	)

1427 
	#SPARC_ETH_SSET
 
ETHTOOL_SSET


	)

1430 
	eëhtoﬁ_lök_mode_bô_ödi˚s
 {

1431 
	mETHTOOL_LINK_MODE_10ba£T_HÆf_BIT
 = 0,

1432 
	mETHTOOL_LINK_MODE_10ba£T_FuŒ_BIT
 = 1,

1433 
	mETHTOOL_LINK_MODE_100ba£T_HÆf_BIT
 = 2,

1434 
	mETHTOOL_LINK_MODE_100ba£T_FuŒ_BIT
 = 3,

1435 
	mETHTOOL_LINK_MODE_1000ba£T_HÆf_BIT
 = 4,

1436 
	mETHTOOL_LINK_MODE_1000ba£T_FuŒ_BIT
 = 5,

1437 
	mETHTOOL_LINK_MODE_Aut⁄eg_BIT
 = 6,

1438 
	mETHTOOL_LINK_MODE_TP_BIT
 = 7,

1439 
	mETHTOOL_LINK_MODE_AUI_BIT
 = 8,

1440 
	mETHTOOL_LINK_MODE_MII_BIT
 = 9,

1441 
	mETHTOOL_LINK_MODE_FIBRE_BIT
 = 10,

1442 
	mETHTOOL_LINK_MODE_BNC_BIT
 = 11,

1443 
	mETHTOOL_LINK_MODE_10000ba£T_FuŒ_BIT
 = 12,

1444 
	mETHTOOL_LINK_MODE_Pau£_BIT
 = 13,

1445 
	mETHTOOL_LINK_MODE_Asym_Pau£_BIT
 = 14,

1446 
	mETHTOOL_LINK_MODE_2500ba£X_FuŒ_BIT
 = 15,

1447 
	mETHTOOL_LINK_MODE_Back∂™e_BIT
 = 16,

1448 
	mETHTOOL_LINK_MODE_1000ba£KX_FuŒ_BIT
 = 17,

1449 
	mETHTOOL_LINK_MODE_10000ba£KX4_FuŒ_BIT
 = 18,

1450 
	mETHTOOL_LINK_MODE_10000ba£KR_FuŒ_BIT
 = 19,

1451 
	mETHTOOL_LINK_MODE_10000ba£R_FEC_BIT
 = 20,

1452 
	mETHTOOL_LINK_MODE_20000ba£MLD2_FuŒ_BIT
 = 21,

1453 
	mETHTOOL_LINK_MODE_20000ba£KR2_FuŒ_BIT
 = 22,

1454 
	mETHTOOL_LINK_MODE_40000ba£KR4_FuŒ_BIT
 = 23,

1455 
	mETHTOOL_LINK_MODE_40000ba£CR4_FuŒ_BIT
 = 24,

1456 
	mETHTOOL_LINK_MODE_40000ba£SR4_FuŒ_BIT
 = 25,

1457 
	mETHTOOL_LINK_MODE_40000ba£LR4_FuŒ_BIT
 = 26,

1458 
	mETHTOOL_LINK_MODE_56000ba£KR4_FuŒ_BIT
 = 27,

1459 
	mETHTOOL_LINK_MODE_56000ba£CR4_FuŒ_BIT
 = 28,

1460 
	mETHTOOL_LINK_MODE_56000ba£SR4_FuŒ_BIT
 = 29,

1461 
	mETHTOOL_LINK_MODE_56000ba£LR4_FuŒ_BIT
 = 30,

1462 
	mETHTOOL_LINK_MODE_25000ba£CR_FuŒ_BIT
 = 31,

1470 
	mETHTOOL_LINK_MODE_25000ba£KR_FuŒ_BIT
 = 32,

1471 
	mETHTOOL_LINK_MODE_25000ba£SR_FuŒ_BIT
 = 33,

1472 
	mETHTOOL_LINK_MODE_50000ba£CR2_FuŒ_BIT
 = 34,

1473 
	mETHTOOL_LINK_MODE_50000ba£KR2_FuŒ_BIT
 = 35,

1474 
	mETHTOOL_LINK_MODE_100000ba£KR4_FuŒ_BIT
 = 36,

1475 
	mETHTOOL_LINK_MODE_100000ba£SR4_FuŒ_BIT
 = 37,

1476 
	mETHTOOL_LINK_MODE_100000ba£CR4_FuŒ_BIT
 = 38,

1477 
	mETHTOOL_LINK_MODE_100000ba£LR4_ER4_FuŒ_BIT
 = 39,

1478 
	mETHTOOL_LINK_MODE_50000ba£SR2_FuŒ_BIT
 = 40,

1479 
	mETHTOOL_LINK_MODE_1000ba£X_FuŒ_BIT
 = 41,

1480 
	mETHTOOL_LINK_MODE_10000ba£CR_FuŒ_BIT
 = 42,

1481 
	mETHTOOL_LINK_MODE_10000ba£SR_FuŒ_BIT
 = 43,

1482 
	mETHTOOL_LINK_MODE_10000ba£LR_FuŒ_BIT
 = 44,

1483 
	mETHTOOL_LINK_MODE_10000ba£LRM_FuŒ_BIT
 = 45,

1484 
	mETHTOOL_LINK_MODE_10000ba£ER_FuŒ_BIT
 = 46,

1485 
	mETHTOOL_LINK_MODE_2500ba£T_FuŒ_BIT
 = 47,

1486 
	mETHTOOL_LINK_MODE_5000ba£T_FuŒ_BIT
 = 48,

1488 
	mETHTOOL_LINK_MODE_FEC_NONE_BIT
 = 49,

1489 
	mETHTOOL_LINK_MODE_FEC_RS_BIT
 = 50,

1490 
	mETHTOOL_LINK_MODE_FEC_BASER_BIT
 = 51,

1491 
	mETHTOOL_LINK_MODE_50000ba£KR_FuŒ_BIT
 = 52,

1492 
	mETHTOOL_LINK_MODE_50000ba£SR_FuŒ_BIT
 = 53,

1493 
	mETHTOOL_LINK_MODE_50000ba£CR_FuŒ_BIT
 = 54,

1494 
	mETHTOOL_LINK_MODE_50000ba£LR_ER_FR_FuŒ_BIT
 = 55,

1495 
	mETHTOOL_LINK_MODE_50000ba£DR_FuŒ_BIT
 = 56,

1496 
	mETHTOOL_LINK_MODE_100000ba£KR2_FuŒ_BIT
 = 57,

1497 
	mETHTOOL_LINK_MODE_100000ba£SR2_FuŒ_BIT
 = 58,

1498 
	mETHTOOL_LINK_MODE_100000ba£CR2_FuŒ_BIT
 = 59,

1499 
	mETHTOOL_LINK_MODE_100000ba£LR2_ER2_FR2_FuŒ_BIT
 = 60,

1500 
	mETHTOOL_LINK_MODE_100000ba£DR2_FuŒ_BIT
 = 61,

1501 
	mETHTOOL_LINK_MODE_200000ba£KR4_FuŒ_BIT
 = 62,

1502 
	mETHTOOL_LINK_MODE_200000ba£SR4_FuŒ_BIT
 = 63,

1503 
	mETHTOOL_LINK_MODE_200000ba£LR4_ER4_FR4_FuŒ_BIT
 = 64,

1504 
	mETHTOOL_LINK_MODE_200000ba£DR4_FuŒ_BIT
 = 65,

1505 
	mETHTOOL_LINK_MODE_200000ba£CR4_FuŒ_BIT
 = 66,

1506 
	mETHTOOL_LINK_MODE_100ba£T1_FuŒ_BIT
 = 67,

1507 
	mETHTOOL_LINK_MODE_1000ba£T1_FuŒ_BIT
 = 68,

1510 
	m__ETHTOOL_LINK_MODE_MASK_NBITS


1513 
	#__ETHTOOL_LINK_MODE_LEGACY_MASK
(
ba£_«me
) \

1514 (1UL << (
ETHTOOL_LINK_MODE_
 ## 
ba£_«me
 ## 
_BIT
))

	)

1520 
	#SUPPORTED_10ba£T_HÆf
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10ba
£T_HÆf
)

	)

1521 
	#SUPPORTED_10ba£T_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10ba
£T_FuŒ
)

	)

1522 
	#SUPPORTED_100ba£T_HÆf
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(100ba
£T_HÆf
)

	)

1523 
	#SUPPORTED_100ba£T_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(100ba
£T_FuŒ
)

	)

1524 
	#SUPPORTED_1000ba£T_HÆf
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£T_HÆf
)

	)

1525 
	#SUPPORTED_1000ba£T_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£T_FuŒ
)

	)

1526 
	#SUPPORTED_Aut⁄eg
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Aut⁄eg
)

	)

1527 
	#SUPPORTED_TP
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
TP
)

	)

1528 
	#SUPPORTED_AUI
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
AUI
)

	)

1529 
	#SUPPORTED_MII
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
MII
)

	)

1530 
	#SUPPORTED_FIBRE
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
FIBRE
)

	)

1531 
	#SUPPORTED_BNC
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
BNC
)

	)

1532 
	#SUPPORTED_10000ba£T_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£T_FuŒ
)

	)

1533 
	#SUPPORTED_Pau£
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Pau£
)

	)

1534 
	#SUPPORTED_Asym_Pau£
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Asym_Pau£
)

	)

1535 
	#SUPPORTED_2500ba£X_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(2500ba
£X_FuŒ
)

	)

1536 
	#SUPPORTED_Back∂™e
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Back∂™e
)

	)

1537 
	#SUPPORTED_1000ba£KX_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£KX_FuŒ
)

	)

1538 
	#SUPPORTED_10000ba£KX4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£KX4_FuŒ
)

	)

1539 
	#SUPPORTED_10000ba£KR_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£KR_FuŒ
)

	)

1540 
	#SUPPORTED_10000ba£R_FEC
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£R_FEC
)

	)

1541 
	#SUPPORTED_20000ba£MLD2_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(20000ba
£MLD2_FuŒ
)

	)

1542 
	#SUPPORTED_20000ba£KR2_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(20000ba
£KR2_FuŒ
)

	)

1543 
	#SUPPORTED_40000ba£KR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£KR4_FuŒ
)

	)

1544 
	#SUPPORTED_40000ba£CR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£CR4_FuŒ
)

	)

1545 
	#SUPPORTED_40000ba£SR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£SR4_FuŒ
)

	)

1546 
	#SUPPORTED_40000ba£LR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£LR4_FuŒ
)

	)

1547 
	#SUPPORTED_56000ba£KR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£KR4_FuŒ
)

	)

1548 
	#SUPPORTED_56000ba£CR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£CR4_FuŒ
)

	)

1549 
	#SUPPORTED_56000ba£SR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£SR4_FuŒ
)

	)

1550 
	#SUPPORTED_56000ba£LR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£LR4_FuŒ
)

	)

1560 
	#ADVERTISED_10ba£T_HÆf
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10ba
£T_HÆf
)

	)

1561 
	#ADVERTISED_10ba£T_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10ba
£T_FuŒ
)

	)

1562 
	#ADVERTISED_100ba£T_HÆf
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(100ba
£T_HÆf
)

	)

1563 
	#ADVERTISED_100ba£T_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(100ba
£T_FuŒ
)

	)

1564 
	#ADVERTISED_1000ba£T_HÆf
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£T_HÆf
)

	)

1565 
	#ADVERTISED_1000ba£T_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£T_FuŒ
)

	)

1566 
	#ADVERTISED_Aut⁄eg
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Aut⁄eg
)

	)

1567 
	#ADVERTISED_TP
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
TP
)

	)

1568 
	#ADVERTISED_AUI
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
AUI
)

	)

1569 
	#ADVERTISED_MII
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
MII
)

	)

1570 
	#ADVERTISED_FIBRE
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
FIBRE
)

	)

1571 
	#ADVERTISED_BNC
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
BNC
)

	)

1572 
	#ADVERTISED_10000ba£T_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£T_FuŒ
)

	)

1573 
	#ADVERTISED_Pau£
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Pau£
)

	)

1574 
	#ADVERTISED_Asym_Pau£
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Asym_Pau£
)

	)

1575 
	#ADVERTISED_2500ba£X_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(2500ba
£X_FuŒ
)

	)

1576 
	#ADVERTISED_Back∂™e
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Back∂™e
)

	)

1577 
	#ADVERTISED_1000ba£KX_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£KX_FuŒ
)

	)

1578 
	#ADVERTISED_10000ba£KX4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£KX4_FuŒ
)

	)

1579 
	#ADVERTISED_10000ba£KR_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£KR_FuŒ
)

	)

1580 
	#ADVERTISED_10000ba£R_FEC
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£R_FEC
)

	)

1581 
	#ADVERTISED_20000ba£MLD2_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(20000ba
£MLD2_FuŒ
)

	)

1582 
	#ADVERTISED_20000ba£KR2_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(20000ba
£KR2_FuŒ
)

	)

1583 
	#ADVERTISED_40000ba£KR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£KR4_FuŒ
)

	)

1584 
	#ADVERTISED_40000ba£CR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£CR4_FuŒ
)

	)

1585 
	#ADVERTISED_40000ba£SR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£SR4_FuŒ
)

	)

1586 
	#ADVERTISED_40000ba£LR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£LR4_FuŒ
)

	)

1587 
	#ADVERTISED_56000ba£KR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£KR4_FuŒ
)

	)

1588 
	#ADVERTISED_56000ba£CR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£CR4_FuŒ
)

	)

1589 
	#ADVERTISED_56000ba£SR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£SR4_FuŒ
)

	)

1590 
	#ADVERTISED_56000ba£LR4_FuŒ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£LR4_FuŒ
)

	)

1605 
	#SPEED_10
 10

	)

1606 
	#SPEED_100
 100

	)

1607 
	#SPEED_1000
 1000

	)

1608 
	#SPEED_2500
 2500

	)

1609 
	#SPEED_5000
 5000

	)

1610 
	#SPEED_10000
 10000

	)

1611 
	#SPEED_14000
 14000

	)

1612 
	#SPEED_20000
 20000

	)

1613 
	#SPEED_25000
 25000

	)

1614 
	#SPEED_40000
 40000

	)

1615 
	#SPEED_50000
 50000

	)

1616 
	#SPEED_56000
 56000

	)

1617 
	#SPEED_100000
 100000

	)

1618 
	#SPEED_200000
 200000

	)

1620 
	#SPEED_UNKNOWN
 -1

	)

1622 
__ölöe__
 
	$ëhtoﬁ_vÆid©e_•ìd
(
__u32
 
•ìd
)

1624  
•ìd
 <
INT_MAX
 || s≥ed =(
__u32
)
SPEED_UNKNOWN
;

1625 
	}
}

1628 
	#DUPLEX_HALF
 0x00

	)

1629 
	#DUPLEX_FULL
 0x01

	)

1630 
	#DUPLEX_UNKNOWN
 0xff

	)

1632 
__ölöe__
 
	$ëhtoﬁ_vÆid©e_du∂ex
(
__u8
 
du∂ex
)

1634 
du∂ex
) {

1635 
DUPLEX_HALF
:

1636 
DUPLEX_FULL
:

1637 
DUPLEX_UNKNOWN
:

1642 
	}
}

1645 
	#PORT_TP
 0x00

	)

1646 
	#PORT_AUI
 0x01

	)

1647 
	#PORT_MII
 0x02

	)

1648 
	#PORT_FIBRE
 0x03

	)

1649 
	#PORT_BNC
 0x04

	)

1650 
	#PORT_DA
 0x05

	)

1651 
	#PORT_NONE
 0xef

	)

1652 
	#PORT_OTHER
 0xff

	)

1655 
	#XCVR_INTERNAL
 0x00

	)

1656 
	#XCVR_EXTERNAL
 0x01

	)

1657 
	#XCVR_DUMMY1
 0x02

	)

1658 
	#XCVR_DUMMY2
 0x03

	)

1659 
	#XCVR_DUMMY3
 0x04

	)

1662 
	#AUTONEG_DISABLE
 0x00

	)

1663 
	#AUTONEG_ENABLE
 0x01

	)

1668 
	#ETH_TP_MDI_INVALID
 0x00

	)

1669 
	#ETH_TP_MDI
 0x01

	)

1670 
	#ETH_TP_MDI_X
 0x02

	)

1671 
	#ETH_TP_MDI_AUTO
 0x03

	)

1674 
	#WAKE_PHY
 (1 << 0)

	)

1675 
	#WAKE_UCAST
 (1 << 1)

	)

1676 
	#WAKE_MCAST
 (1 << 2)

	)

1677 
	#WAKE_BCAST
 (1 << 3)

	)

1678 
	#WAKE_ARP
 (1 << 4)

	)

1679 
	#WAKE_MAGIC
 (1 << 5)

	)

1680 
	#WAKE_MAGICSECURE
 (1 << 6Ë

	)

1681 
	#WAKE_FILTER
 (1 << 7)

	)

1684 
	#TCP_V4_FLOW
 0x01

	)

1685 
	#UDP_V4_FLOW
 0x02

	)

1686 
	#SCTP_V4_FLOW
 0x03

	)

1687 
	#AH_ESP_V4_FLOW
 0x04

	)

1688 
	#TCP_V6_FLOW
 0x05

	)

1689 
	#UDP_V6_FLOW
 0x06

	)

1690 
	#SCTP_V6_FLOW
 0x07

	)

1691 
	#AH_ESP_V6_FLOW
 0x08

	)

1692 
	#AH_V4_FLOW
 0x09

	)

1693 
	#ESP_V4_FLOW
 0x0®

	)

1694 
	#AH_V6_FLOW
 0x0b

	)

1695 
	#ESP_V6_FLOW
 0x0¯

	)

1696 
	#IPV4_USER_FLOW
 0x0d

	)

1697 
	#IP_USER_FLOW
 
IPV4_USER_FLOW


	)

1698 
	#IPV6_USER_FLOW
 0x0ê

	)

1699 
	#IPV4_FLOW
 0x10

	)

1700 
	#IPV6_FLOW
 0x11

	)

1701 
	#ETHER_FLOW
 0x12

	)

1703 
	#FLOW_EXT
 0x80000000

	)

1704 
	#FLOW_MAC_EXT
 0x40000000

	)

1706 
	#FLOW_RSS
 0x20000000

	)

1709 
	#RXH_L2DA
 (1 << 1)

	)

1710 
	#RXH_VLAN
 (1 << 2)

	)

1711 
	#RXH_L3_PROTO
 (1 << 3)

	)

1712 
	#RXH_IP_SRC
 (1 << 4)

	)

1713 
	#RXH_IP_DST
 (1 << 5)

	)

1714 
	#RXH_L4_B_0_1
 (1 << 6Ë

	)

1715 
	#RXH_L4_B_2_3
 (1 << 7Ë

	)

1716 
	#RXH_DISCARD
 (1 << 31)

	)

1718 
	#RX_CLS_FLOW_DISC
 0xffffffffffffffffULL

	)

1719 
	#RX_CLS_FLOW_WAKE
 0xffffffffffffff„ULL

	)

1722 
	#RX_CLS_LOC_SPECIAL
 0x80000000

	)

1723 
	#RX_CLS_LOC_ANY
 0xffffffff

	)

1724 
	#RX_CLS_LOC_FIRST
 0xffffff„

	)

1725 
	#RX_CLS_LOC_LAST
 0xfffffffd

	)

1728 
	#ETH_MODULE_SFF_8079
 0x1

	)

1729 
	#ETH_MODULE_SFF_8079_LEN
 256

	)

1730 
	#ETH_MODULE_SFF_8472
 0x2

	)

1731 
	#ETH_MODULE_SFF_8472_LEN
 512

	)

1732 
	#ETH_MODULE_SFF_8636
 0x3

	)

1733 
	#ETH_MODULE_SFF_8636_LEN
 256

	)

1734 
	#ETH_MODULE_SFF_8436
 0x4

	)

1735 
	#ETH_MODULE_SFF_8436_LEN
 256

	)

1737 
	#ETH_MODULE_SFF_8636_MAX_LEN
 640

	)

1738 
	#ETH_MODULE_SFF_8436_MAX_LEN
 640

	)

1747 
	eëhtoﬁ_ª£t_Êags
 {

1753 
	mETH_RESET_MGMT
 = 1 << 0,

1754 
	mETH_RESET_IRQ
 = 1 << 1,

1755 
	mETH_RESET_DMA
 = 1 << 2,

1756 
	mETH_RESET_FILTER
 = 1 << 3,

1757 
	mETH_RESET_OFFLOAD
 = 1 << 4,

1758 
	mETH_RESET_MAC
 = 1 << 5,

1759 
	mETH_RESET_PHY
 = 1 << 6,

1760 
	mETH_RESET_RAM
 = 1 << 7,

1762 
	mETH_RESET_AP
 = 1 << 8,

1764 
	mETH_RESET_DEDICATED
 = 0x0000ffff,

1766 
	mETH_RESET_ALL
 = 0xffffffff,

1769 
	#ETH_RESET_SHARED_SHIFT
 16

	)

1868 
	sëhtoﬁ_lök_£âögs
 {

1869 
__u32
 
	mcmd
;

1870 
__u32
 
	m•ìd
;

1871 
__u8
 
	mdu∂ex
;

1872 
__u8
 
	mp‹t
;

1873 
__u8
 
	mphy_addªss
;

1874 
__u8
 
	maut⁄eg
;

1875 
__u8
 
	mmdio_suµ‹t
;

1876 
__u8
 
	mëh_ç_mdix
;

1877 
__u8
 
	mëh_ç_mdix_˘æ
;

1878 
__s8
 
	mlök_mode_masks_nw‹ds
;

1879 
__u8
 
	må™s˚ivî
;

1880 
__u8
 
	mª£rved1
[3];

1881 
__u32
 
	mª£rved
[7];

1882 
__u32
 
	mlök_mode_masks
[0];

	@/usr/include/linux/fs.h

2 #i‚de‡
_LINUX_FS_H


3 
	#_LINUX_FS_H


	)

13 
	~<löux/limôs.h
>

14 
	~<löux/io˘l.h
>

15 
	~<löux/ty≥s.h
>

16 
	~<löux/fs¸y±.h
>

19 
	~<löux/mou¡.h
>

32 #unde‡
NR_OPEN


33 
	#INR_OPEN_CUR
 1024

	)

34 
	#INR_OPEN_MAX
 4096

	)

36 
	#BLOCK_SIZE_BITS
 10

	)

37 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

39 
	#SEEK_SET
 0

	)

40 
	#SEEK_CUR
 1

	)

41 
	#SEEK_END
 2

	)

42 
	#SEEK_DATA
 3

	)

43 
	#SEEK_HOLE
 4

	)

44 
	#SEEK_MAX
 
SEEK_HOLE


	)

46 
	#RENAME_NOREPLACE
 (1 << 0Ë

	)

47 
	#RENAME_EXCHANGE
 (1 << 1Ë

	)

48 
	#RENAME_WHITEOUT
 (1 << 2Ë

	)

50 
	sfûe_˛⁄e_ønge
 {

51 
__s64
 
	m§c_fd
;

52 
__u64
 
	m§c_off£t
;

53 
__u64
 
	m§c_Àngth
;

54 
__u64
 
	mde°_off£t
;

57 
	sf°rim_ønge
 {

58 
__u64
 
	m°¨t
;

59 
__u64
 
	mÀn
;

60 
__u64
 
	mmöÀn
;

64 
	#FILE_DEDUPE_RANGE_SAME
 0

	)

65 
	#FILE_DEDUPE_RANGE_DIFFERS
 1

	)

68 
	sfûe_dedu≥_ønge_öfo
 {

69 
__s64
 
	mde°_fd
;

70 
__u64
 
	mde°_off£t
;

71 
__u64
 
	mbyãs_dedu≥d
;

78 
__s32
 
	m°©us
;

79 
__u32
 
	mª£rved
;

83 
	sfûe_dedu≥_ønge
 {

84 
__u64
 
	m§c_off£t
;

85 
__u64
 
	m§c_Àngth
;

86 
__u16
 
	mde°_cou¡
;

87 
__u16
 
	mª£rved1
;

88 
__u32
 
	mª£rved2
;

89 
fûe_dedu≥_ønge_öfo
 
	möfo
[0];

93 
	sfûes_°©_°ru˘
 {

94 
	mƒ_fûes
;

95 
	mƒ_‰ì_fûes
;

96 
	mmax_fûes
;

99 
	söodes_°©_t
 {

100 
	mƒ_öodes
;

101 
	mƒ_unu£d
;

102 
	mdummy
[5];

106 
	#NR_FILE
 8192

	)

111 
	sfsx©å
 {

112 
__u32
 
	mfsx_xÊags
;

113 
__u32
 
	mfsx_extsize
;

114 
__u32
 
	mfsx_√xã¡s
;

115 
__u32
 
	mfsx_¥ojid
;

116 
__u32
 
	mfsx_cowextsize
;

117 
	mfsx_∑d
[8];

123 
	#FS_XFLAG_REALTIME
 0x00000001

	)

124 
	#FS_XFLAG_PREALLOC
 0x00000002

	)

125 
	#FS_XFLAG_IMMUTABLE
 0x00000008

	)

126 
	#FS_XFLAG_APPEND
 0x00000010

	)

127 
	#FS_XFLAG_SYNC
 0x00000020

	)

128 
	#FS_XFLAG_NOATIME
 0x00000040

	)

129 
	#FS_XFLAG_NODUMP
 0x00000080

	)

130 
	#FS_XFLAG_RTINHERIT
 0x00000100

	)

131 
	#FS_XFLAG_PROJINHERIT
 0x00000200

	)

132 
	#FS_XFLAG_NOSYMLINKS
 0x00000400

	)

133 
	#FS_XFLAG_EXTSIZE
 0x00000800

	)

134 
	#FS_XFLAG_EXTSZINHERIT
 0x00001000

	)

135 
	#FS_XFLAG_NODEFRAG
 0x00002000

	)

136 
	#FS_XFLAG_FILESTREAM
 0x00004000

	)

137 
	#FS_XFLAG_DAX
 0x00008000

	)

138 
	#FS_XFLAG_COWEXTSIZE
 0x00010000

	)

139 
	#FS_XFLAG_HASATTR
 0x80000000

	)

144 
	#BLKROSET
 
	`_IO
(0x12,93Ë

	)

145 
	#BLKROGET
 
	`_IO
(0x12,94Ë

	)

146 
	#BLKRRPART
 
	`_IO
(0x12,95Ë

	)

147 
	#BLKGETSIZE
 
	`_IO
(0x12,96Ë

	)

148 
	#BLKFLSBUF
 
	`_IO
(0x12,97Ë

	)

149 
	#BLKRASET
 
	`_IO
(0x12,98Ë

	)

150 
	#BLKRAGET
 
	`_IO
(0x12,99Ë

	)

151 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

152 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

153 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

154 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

155 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

157 
	#BLKPG
 
	`_IO
(0x12,105)

	)

161 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

162 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

167 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

168 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

169 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
Ë

	)

170 
	#BLKTRACESETUP
 
	`_IOWR
(0x12,115,
blk_u£r_åa˚_£tup
)

	)

171 
	#BLKTRACESTART
 
	`_IO
(0x12,116)

	)

172 
	#BLKTRACESTOP
 
	`_IO
(0x12,117)

	)

173 
	#BLKTRACETEARDOWN
 
	`_IO
(0x12,118)

	)

174 
	#BLKDISCARD
 
	`_IO
(0x12,119)

	)

175 
	#BLKIOMIN
 
	`_IO
(0x12,120)

	)

176 
	#BLKIOOPT
 
	`_IO
(0x12,121)

	)

177 
	#BLKALIGNOFF
 
	`_IO
(0x12,122)

	)

178 
	#BLKPBSZGET
 
	`_IO
(0x12,123)

	)

179 
	#BLKDISCARDZEROES
 
	`_IO
(0x12,124)

	)

180 
	#BLKSECDISCARD
 
	`_IO
(0x12,125)

	)

181 
	#BLKROTATIONAL
 
	`_IO
(0x12,126)

	)

182 
	#BLKZEROOUT
 
	`_IO
(0x12,127)

	)

188 
	#BMAP_IOCTL
 1

	)

189 
	#FIBMAP
 
	`_IO
(0x00,1Ë

	)

190 
	#FIGETBSZ
 
	`_IO
(0x00,2Ë

	)

191 
	#FIFREEZE
 
	`_IOWR
('X', 119, Ë

	)

192 
	#FITHAW
 
	`_IOWR
('X', 120, Ë

	)

193 
	#FITRIM
 
	`_IOWR
('X', 121, 
f°rim_ønge
Ë

	)

194 
	#FICLONE
 
	`_IOW
(0x94, 9, )

	)

195 
	#FICLONERANGE
 
	`_IOW
(0x94, 13, 
fûe_˛⁄e_ønge
)

	)

196 
	#FIDEDUPERANGE
 
	`_IOWR
(0x94, 54, 
fûe_dedu≥_ønge
)

	)

198 
	#FSLABEL_MAX
 256

	)

200 
	#FS_IOC_GETFLAGS
 
	`_IOR
('f', 1, )

	)

201 
	#FS_IOC_SETFLAGS
 
	`_IOW
('f', 2, )

	)

202 
	#FS_IOC_GETVERSION
 
	`_IOR
('v', 1, )

	)

203 
	#FS_IOC_SETVERSION
 
	`_IOW
('v', 2, )

	)

204 
	#FS_IOC_FIEMAP
 
	`_IOWR
('f', 11, 
fõm≠
)

	)

205 
	#FS_IOC32_GETFLAGS
 
	`_IOR
('f', 1, )

	)

206 
	#FS_IOC32_SETFLAGS
 
	`_IOW
('f', 2, )

	)

207 
	#FS_IOC32_GETVERSION
 
	`_IOR
('v', 1, )

	)

208 
	#FS_IOC32_SETVERSION
 
	`_IOW
('v', 2, )

	)

209 
	#FS_IOC_FSGETXATTR
 
	`_IOR
('X', 31, 
fsx©å
)

	)

210 
	#FS_IOC_FSSETXATTR
 
	`_IOW
('X', 32, 
fsx©å
)

	)

211 
	#FS_IOC_GETFSLABEL
 
	`_IOR
(0x94, 49, [
FSLABEL_MAX
])

	)

212 
	#FS_IOC_SETFSLABEL
 
	`_IOW
(0x94, 50, [
FSLABEL_MAX
])

	)

234 
	#FS_SECRM_FL
 0x00000001

	)

235 
	#FS_UNRM_FL
 0x00000002

	)

236 
	#FS_COMPR_FL
 0x00000004

	)

237 
	#FS_SYNC_FL
 0x00000008

	)

238 
	#FS_IMMUTABLE_FL
 0x00000010

	)

239 
	#FS_APPEND_FL
 0x00000020

	)

240 
	#FS_NODUMP_FL
 0x00000040

	)

241 
	#FS_NOATIME_FL
 0x00000080

	)

243 
	#FS_DIRTY_FL
 0x00000100

	)

244 
	#FS_COMPRBLK_FL
 0x00000200

	)

245 
	#FS_NOCOMP_FL
 0x00000400

	)

247 
	#FS_ENCRYPT_FL
 0x00000800

	)

248 
	#FS_BTREE_FL
 0x00001000

	)

249 
	#FS_INDEX_FL
 0x00001000

	)

250 
	#FS_IMAGIC_FL
 0x00002000

	)

251 
	#FS_JOURNAL_DATA_FL
 0x00004000

	)

252 
	#FS_NOTAIL_FL
 0x00008000

	)

253 
	#FS_DIRSYNC_FL
 0x00010000

	)

254 
	#FS_TOPDIR_FL
 0x00020000

	)

255 
	#FS_HUGE_FILE_FL
 0x00040000

	)

256 
	#FS_EXTENT_FL
 0x00080000

	)

257 
	#FS_VERITY_FL
 0x00100000

	)

258 
	#FS_EA_INODE_FL
 0x00200000

	)

259 
	#FS_EOFBLOCKS_FL
 0x00400000

	)

260 
	#FS_NOCOW_FL
 0x00800000

	)

261 
	#FS_INLINE_DATA_FL
 0x10000000

	)

262 
	#FS_PROJINHERIT_FL
 0x20000000

	)

263 
	#FS_CASEFOLD_FL
 0x40000000

	)

264 
	#FS_RESERVED_FL
 0x80000000

	)

266 
	#FS_FL_USER_VISIBLE
 0x0003DFFF

	)

267 
	#FS_FL_USER_MODIFIABLE
 0x000380FF

	)

270 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

271 
	#SYNC_FILE_RANGE_WRITE
 2

	)

272 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

273 
	#SYNC_FILE_RANGE_WRITE_AND_WAIT
 (
SYNC_FILE_RANGE_WRITE
 | \

274 
SYNC_FILE_RANGE_WAIT_BEFORE
 | \

275 
SYNC_FILE_RANGE_WAIT_AFTER
)

	)

281 
	t__bôwi£
 
	t__kî√l_rwf_t
;

284 
	#RWF_HIPRI
 ((
__kî√l_rwf_t
)0x00000001)

	)

287 
	#RWF_DSYNC
 ((
__kî√l_rwf_t
)0x00000002)

	)

290 
	#RWF_SYNC
 ((
__kî√l_rwf_t
)0x00000004)

	)

293 
	#RWF_NOWAIT
 ((
__kî√l_rwf_t
)0x00000008)

	)

296 
	#RWF_APPEND
 ((
__kî√l_rwf_t
)0x00000010)

	)

299 
	#RWF_SUPPORTED
 (
RWF_HIPRI
 | 
RWF_DSYNC
 | 
RWF_SYNC
 | 
RWF_NOWAIT
 |\

300 
RWF_APPEND
)

	)

	@/usr/include/linux/module.h

2 #i‚de‡
_LINUX_MODULE_H


3 
	#_LINUX_MODULE_H


	)

6 
	#MODULE_INIT_IGNORE_MODVERSIONS
 1

	)

7 
	#MODULE_INIT_IGNORE_VERMAGIC
 2

	)

	@/usr/include/linux/netdevice.h

26 #i‚de‡
_LINUX_NETDEVICE_H


27 
	#_LINUX_NETDEVICE_H


	)

29 
	~<löux/if.h
>

30 
	~<löux/if_ëhî.h
>

31 
	~<löux/if_∑ckë.h
>

32 
	~<löux/if_lök.h
>

35 
	#MAX_ADDR_LEN
 32

	)

38 
	#INIT_NETDEV_GROUP
 0

	)

42 
	#NET_NAME_UNKNOWN
 0

	)

43 
	#NET_NAME_ENUM
 1

	)

44 
	#NET_NAME_PREDICTABLE
 2

	)

45 
	#NET_NAME_USER
 3

	)

46 
	#NET_NAME_RENAMED
 4

	)

50 
	mIF_PORT_UNKNOWN
 = 0,

51 
	mIF_PORT_10BASE2
,

52 
	mIF_PORT_10BASET
,

53 
	mIF_PORT_AUI
,

54 
	mIF_PORT_100BASET
,

55 
	mIF_PORT_100BASETX
,

56 
	mIF_PORT_100BASEFX


60 
	#NET_ADDR_PERM
 0

	)

61 
	#NET_ADDR_RANDOM
 1

	)

62 
	#NET_ADDR_STOLEN
 2

	)

63 
	#NET_ADDR_SET
 3

	)

	@/usr/include/linux/pci.h

18 #i‚de‡
LINUX_PCI_H


19 
	#LINUX_PCI_H


	)

21 
	~<löux/pci_ªgs.h
>

31 
	#PCI_DEVFN
(
¶Ÿ
, 
func
Ë((((¶ŸË& 0x1fË<< 3Ë| ((funcË& 0x07))

	)

32 
	#PCI_SLOT
(
dev‚
Ë(((dev‚Ë>> 3Ë& 0x1f)

	)

33 
	#PCI_FUNC
(
dev‚
Ë((dev‚Ë& 0x07)

	)

36 
	#PCIIOC_BASE
 ('P' << 24 | 'C' << 16 | 'I' << 8)

	)

37 
	#PCIIOC_CONTROLLER
 (
PCIIOC_BASE
 | 0x00Ë

	)

38 
	#PCIIOC_MMAP_IS_IO
 (
PCIIOC_BASE
 | 0x01Ë

	)

39 
	#PCIIOC_MMAP_IS_MEM
 (
PCIIOC_BASE
 | 0x02Ë

	)

40 
	#PCIIOC_WRITE_COMBINE
 (
PCIIOC_BASE
 | 0x03Ë

	)

	@/usr/include/linux/stddef.h

4 #i‚de‡
__Æways_ölöe


5 
	#__Æways_ölöe
 
__ölöe__


	)

	@/usr/include/linux/types.h

2 #i‚de‡
_LINUX_TYPES_H


3 
	#_LINUX_TYPES_H


	)

5 
	~<asm/ty≥s.h
>

7 #i‚de‡
__ASSEMBLY__


9 
	~<löux/posix_ty≥s.h
>

17 #ifde‡
__CHECKER__


18 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

20 
	#__bôwi£__


	)

22 
	#__bôwi£
 
__bôwi£__


	)

24 
__u16
 
	t__bôwi£
 
	t__À16
;

25 
__u16
 
	t__bôwi£
 
	t__be16
;

26 
__u32
 
	t__bôwi£
 
	t__À32
;

27 
__u32
 
	t__bôwi£
 
	t__be32
;

28 
__u64
 
	t__bôwi£
 
	t__À64
;

29 
__u64
 
	t__bôwi£
 
	t__be64
;

31 
__u16
 
	t__bôwi£
 
	t__sum16
;

32 
__u32
 
	t__bôwi£
 
	t__wsum
;

43 
	#__Æig√d_u64
 
__u64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

44 
	#__Æig√d_be64
 
__be64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

45 
	#__Æig√d_À64
 
__À64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

47 
	t__bôwi£
 
	t__pﬁl_t
;

	@/usr/include/asm/types.h

1 
	~<asm-gíîic/ty≥s.h
>

	@/usr/include/limits.h

22 #i‚de‡
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<bôs/libc-hódî-°¨t.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

42 #i‚de‡
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<bôs/w‹dsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifde‡
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #i‡
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #i‡
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifde‡
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #i‡
deföed
 
__GNUC__
 && !deföed 
_GCC_LIMITS_H_


124 #ö˛ude_√xà<
limôs
.
h
>

130 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__


131 #i‚de‡
LLONG_MIN


132 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

134 #i‚de‡
LLONG_MAX


135 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

137 #i‚de‡
ULLONG_MAX


138 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

145 #i‡
__GLIBC_USE
 (
IEC_60559_BFP_EXT_C2X
)

146 #i‚de‡
CHAR_WIDTH


147 
	#CHAR_WIDTH
 8

	)

149 #i‚de‡
SCHAR_WIDTH


150 
	#SCHAR_WIDTH
 8

	)

152 #i‚de‡
UCHAR_WIDTH


153 
	#UCHAR_WIDTH
 8

	)

155 #i‚de‡
SHRT_WIDTH


156 
	#SHRT_WIDTH
 16

	)

158 #i‚de‡
USHRT_WIDTH


159 
	#USHRT_WIDTH
 16

	)

161 #i‚de‡
INT_WIDTH


162 
	#INT_WIDTH
 32

	)

164 #i‚de‡
UINT_WIDTH


165 
	#UINT_WIDTH
 32

	)

167 #i‚de‡
LONG_WIDTH


168 
	#LONG_WIDTH
 
__WORDSIZE


	)

170 #i‚de‡
ULONG_WIDTH


171 
	#ULONG_WIDTH
 
__WORDSIZE


	)

173 #i‚de‡
LLONG_WIDTH


174 
	#LLONG_WIDTH
 64

	)

176 #i‚de‡
ULLONG_WIDTH


177 
	#ULLONG_WIDTH
 64

	)

181 #ifdef 
__USE_POSIX


183 
	~<bôs/posix1_lim.h
>

186 #ifdef 
__USE_POSIX2


187 
	~<bôs/posix2_lim.h
>

190 #ifdef 
__USE_XOPEN


191 
	~<bôs/x›í_lim.h
>

	@/usr/include/linux/const.h

4 #i‚de‡
_LINUX_CONST_H


5 
	#_LINUX_CONST_H


	)

16 #ifde‡
__ASSEMBLY__


17 
	#_AC
(
X
,
Y
Ë
	)
X

18 
	#_AT
(
T
,
X
Ë
	)
X

20 
	#__AC
(
X
,
Y
Ë(X##Y)

	)

21 
	#_AC
(
X
,
Y
Ë
	`__AC
(X,Y)

	)

22 
	#_AT
(
T
,
X
Ë((T)(X))

	)

25 
	#_UL
(
x
Ë(
	`_AC
(x, 
UL
))

	)

26 
	#_ULL
(
x
Ë(
	`_AC
(x, 
ULL
))

	)

28 
	#_BITUL
(
x
Ë(
	`_UL
(1Ë<< (x))

	)

29 
	#_BITULL
(
x
Ë(
	`_ULL
(1Ë<< (x))

	)

31 
	#__ALIGN_KERNEL
(
x
, 
a
Ë
	`__ALIGN_KERNEL_MASK
(x, (
	`ty≥of
(x))◊Ë- 1)

	)

32 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
Ë(((xË+ (mask)Ë& ~(mask))

	)

34 
	#__KERNEL_DIV_ROUND_UP
(
n
, 
d
Ë((“Ë+ (dË- 1Ë/ (d))

	)

	@/usr/include/linux/fscrypt.h

8 #i‚de‡
_LINUX_FSCRYPT_H


9 
	#_LINUX_FSCRYPT_H


	)

11 
	~<löux/ty≥s.h
>

14 
	#FSCRYPT_POLICY_FLAGS_PAD_4
 0x00

	)

15 
	#FSCRYPT_POLICY_FLAGS_PAD_8
 0x01

	)

16 
	#FSCRYPT_POLICY_FLAGS_PAD_16
 0x02

	)

17 
	#FSCRYPT_POLICY_FLAGS_PAD_32
 0x03

	)

18 
	#FSCRYPT_POLICY_FLAGS_PAD_MASK
 0x03

	)

19 
	#FSCRYPT_POLICY_FLAG_DIRECT_KEY
 0x04

	)

22 
	#FSCRYPT_MODE_AES_256_XTS
 1

	)

23 
	#FSCRYPT_MODE_AES_256_CTS
 4

	)

24 
	#FSCRYPT_MODE_AES_128_CBC
 5

	)

25 
	#FSCRYPT_MODE_AES_128_CTS
 6

	)

26 
	#FSCRYPT_MODE_ADIANTUM
 9

	)

35 
	#FSCRYPT_POLICY_V1
 0

	)

36 
	#FSCRYPT_KEY_DESCRIPTOR_SIZE
 8

	)

37 
	sfs¸y±_pﬁicy_v1
 {

38 
__u8
 
	mvîsi⁄
;

39 
__u8
 
	mc⁄ã¡s_í¸y±i⁄_mode
;

40 
__u8
 
	mfûíames_í¸y±i⁄_mode
;

41 
__u8
 
	mÊags
;

42 
__u8
 
	mma°î_key_des¸ùt‹
[
FSCRYPT_KEY_DESCRIPTOR_SIZE
];

44 
	#fs¸y±_pﬁicy
 
fs¸y±_pﬁicy_v1


	)

50 
	#FSCRYPT_KEY_DESC_PREFIX
 "fs¸y±:"

	)

51 
	#FSCRYPT_KEY_DESC_PREFIX_SIZE
 8

	)

52 
	#FSCRYPT_MAX_KEY_SIZE
 64

	)

53 
	sfs¸y±_key
 {

54 
__u32
 
	mmode
;

55 
__u8
 
	møw
[
FSCRYPT_MAX_KEY_SIZE
];

56 
__u32
 
	msize
;

62 
	#FSCRYPT_POLICY_V2
 2

	)

63 
	#FSCRYPT_KEY_IDENTIFIER_SIZE
 16

	)

64 
	sfs¸y±_pﬁicy_v2
 {

65 
__u8
 
	mvîsi⁄
;

66 
__u8
 
	mc⁄ã¡s_í¸y±i⁄_mode
;

67 
__u8
 
	mfûíames_í¸y±i⁄_mode
;

68 
__u8
 
	mÊags
;

69 
__u8
 
	m__ª£rved
[4];

70 
__u8
 
	mma°î_key_idítifõr
[
FSCRYPT_KEY_IDENTIFIER_SIZE
];

74 
	sfs¸y±_gë_pﬁicy_ex_¨g
 {

75 
__u64
 
	mpﬁicy_size
;

77 
__u8
 
	mvîsi⁄
;

78 
fs¸y±_pﬁicy_v1
 
	mv1
;

79 
fs¸y±_pﬁicy_v2
 
	mv2
;

80 } 
	mpﬁicy
;

87 
	#FSCRYPT_KEY_SPEC_TYPE_DESCRIPTOR
 1

	)

94 
	#FSCRYPT_KEY_SPEC_TYPE_IDENTIFIER
 2

	)

100 
	sfs¸y±_key_•ecifõr
 {

101 
__u32
 
	mty≥
;

102 
__u32
 
	m__ª£rved
;

104 
__u8
 
	m__ª£rved
[32];

105 
__u8
 
	mdes¸ùt‹
[
FSCRYPT_KEY_DESCRIPTOR_SIZE
];

106 
__u8
 
	midítifõr
[
FSCRYPT_KEY_IDENTIFIER_SIZE
];

107 } 
	mu
;

111 
	sfs¸y±_add_key_¨g
 {

112 
fs¸y±_key_•ecifõr
 
	mkey_•ec
;

113 
__u32
 
	møw_size
;

114 
__u32
 
	m__ª£rved
[9];

115 
__u8
 
	møw
[];

119 
	sfs¸y±_ªmove_key_¨g
 {

120 
fs¸y±_key_•ecifõr
 
	mkey_•ec
;

121 
	#FSCRYPT_KEY_REMOVAL_STATUS_FLAG_FILES_BUSY
 0x00000001

	)

122 
	#FSCRYPT_KEY_REMOVAL_STATUS_FLAG_OTHER_USERS
 0x00000002

	)

123 
__u32
 
	mªmovÆ_°©us_Êags
;

124 
__u32
 
	m__ª£rved
[5];

128 
	sfs¸y±_gë_key_°©us_¨g
 {

130 
fs¸y±_key_•ecifõr
 
	mkey_•ec
;

131 
__u32
 
	m__ª£rved
[6];

134 
	#FSCRYPT_KEY_STATUS_ABSENT
 1

	)

135 
	#FSCRYPT_KEY_STATUS_PRESENT
 2

	)

136 
	#FSCRYPT_KEY_STATUS_INCOMPLETELY_REMOVED
 3

	)

137 
__u32
 
	m°©us
;

138 
	#FSCRYPT_KEY_STATUS_FLAG_ADDED_BY_SELF
 0x00000001

	)

139 
__u32
 
	m°©us_Êags
;

140 
__u32
 
	mu£r_cou¡
;

141 
__u32
 
	m__out_ª£rved
[13];

144 
	#FS_IOC_SET_ENCRYPTION_POLICY
 
	`_IOR
('f', 19, 
fs¸y±_pﬁicy
)

	)

145 
	#FS_IOC_GET_ENCRYPTION_PWSALT
 
	`_IOW
('f', 20, 
__u8
[16])

	)

146 
	#FS_IOC_GET_ENCRYPTION_POLICY
 
	`_IOW
('f', 21, 
fs¸y±_pﬁicy
)

	)

147 
	#FS_IOC_GET_ENCRYPTION_POLICY_EX
 
	`_IOWR
('f', 22, 
__u8
[9]Ë

	)

148 
	#FS_IOC_ADD_ENCRYPTION_KEY
 
	`_IOWR
('f', 23, 
fs¸y±_add_key_¨g
)

	)

149 
	#FS_IOC_REMOVE_ENCRYPTION_KEY
 
	`_IOWR
('f', 24, 
fs¸y±_ªmove_key_¨g
)

	)

150 
	#FS_IOC_REMOVE_ENCRYPTION_KEY_ALL_USERS
 
	`_IOWR
('f', 25, 
fs¸y±_ªmove_key_¨g
)

	)

151 
	#FS_IOC_GET_ENCRYPTION_KEY_STATUS
 
	`_IOWR
('f', 26, 
fs¸y±_gë_key_°©us_¨g
)

	)

156 
	#FS_KEY_DESCRIPTOR_SIZE
 
FSCRYPT_KEY_DESCRIPTOR_SIZE


	)

157 
	#FS_POLICY_FLAGS_PAD_4
 
FSCRYPT_POLICY_FLAGS_PAD_4


	)

158 
	#FS_POLICY_FLAGS_PAD_8
 
FSCRYPT_POLICY_FLAGS_PAD_8


	)

159 
	#FS_POLICY_FLAGS_PAD_16
 
FSCRYPT_POLICY_FLAGS_PAD_16


	)

160 
	#FS_POLICY_FLAGS_PAD_32
 
FSCRYPT_POLICY_FLAGS_PAD_32


	)

161 
	#FS_POLICY_FLAGS_PAD_MASK
 
FSCRYPT_POLICY_FLAGS_PAD_MASK


	)

162 
	#FS_POLICY_FLAG_DIRECT_KEY
 
FSCRYPT_POLICY_FLAG_DIRECT_KEY


	)

163 
	#FS_POLICY_FLAGS_VALID
 0x07

	)

164 
	#FS_ENCRYPTION_MODE_INVALID
 0

	)

165 
	#FS_ENCRYPTION_MODE_AES_256_XTS
 
FSCRYPT_MODE_AES_256_XTS


	)

166 
	#FS_ENCRYPTION_MODE_AES_256_GCM
 2

	)

167 
	#FS_ENCRYPTION_MODE_AES_256_CBC
 3

	)

168 
	#FS_ENCRYPTION_MODE_AES_256_CTS
 
FSCRYPT_MODE_AES_256_CTS


	)

169 
	#FS_ENCRYPTION_MODE_AES_128_CBC
 
FSCRYPT_MODE_AES_128_CBC


	)

170 
	#FS_ENCRYPTION_MODE_AES_128_CTS
 
FSCRYPT_MODE_AES_128_CTS


	)

171 
	#FS_ENCRYPTION_MODE_SPECK128_256_XTS
 7

	)

172 
	#FS_ENCRYPTION_MODE_SPECK128_256_CTS
 8

	)

173 
	#FS_ENCRYPTION_MODE_ADIANTUM
 
FSCRYPT_MODE_ADIANTUM


	)

174 
	#FS_KEY_DESC_PREFIX
 
FSCRYPT_KEY_DESC_PREFIX


	)

175 
	#FS_KEY_DESC_PREFIX_SIZE
 
FSCRYPT_KEY_DESC_PREFIX_SIZE


	)

176 
	#FS_MAX_KEY_SIZE
 
FSCRYPT_MAX_KEY_SIZE


	)

	@/usr/include/linux/if.h

20 #i‚de‡
_LINUX_IF_H


21 
	#_LINUX_IF_H


	)

23 
	~<löux/libc-com∑t.h
>

24 
	~<löux/ty≥s.h
>

25 
	~<löux/sockë.h
>

28 
	~<sys/sockë.h
>

30 #i‡
__UAPI_DEF_IF_IFNAMSIZ


31 
	#IFNAMSIZ
 16

	)

33 
	#IFALIASZ
 256

	)

34 
	~<löux/hdlc/io˘l.h
>

37 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 != 0 || \

38 
	g__UAPI_DEF_IF_NET_DEVICE_FLAGS
 != 0

79 
	e√t_devi˚_Êags
 {

81 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS


82 
IFF_UP
 = 1<<0,

83 
	mIFF_BROADCAST
 = 1<<1,

84 
	mIFF_DEBUG
 = 1<<2,

85 
	mIFF_LOOPBACK
 = 1<<3,

86 
	mIFF_POINTOPOINT
 = 1<<4,

87 
	mIFF_NOTRAILERS
 = 1<<5,

88 
	mIFF_RUNNING
 = 1<<6,

89 
	mIFF_NOARP
 = 1<<7,

90 
	mIFF_PROMISC
 = 1<<8,

91 
	mIFF_ALLMULTI
 = 1<<9,

92 
	mIFF_MASTER
 = 1<<10,

93 
	mIFF_SLAVE
 = 1<<11,

94 
	mIFF_MULTICAST
 = 1<<12,

95 
	mIFF_PORTSEL
 = 1<<13,

96 
	mIFF_AUTOMEDIA
 = 1<<14,

97 
	mIFF_DYNAMIC
 = 1<<15,

99 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


100 
	mIFF_LOWER_UP
 = 1<<16,

101 
	mIFF_DORMANT
 = 1<<17,

102 
	mIFF_ECHO
 = 1<<18,

108 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS


109 
	#IFF_UP
 
IFF_UP


	)

110 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

111 
	#IFF_DEBUG
 
IFF_DEBUG


	)

112 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

113 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

114 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

115 
	#IFF_RUNNING
 
IFF_RUNNING


	)

116 
	#IFF_NOARP
 
IFF_NOARP


	)

117 
	#IFF_PROMISC
 
IFF_PROMISC


	)

118 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

119 
	#IFF_MASTER
 
IFF_MASTER


	)

120 
	#IFF_SLAVE
 
IFF_SLAVE


	)

121 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

122 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

123 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

124 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

127 #i‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


128 
	#IFF_LOWER_UP
 
IFF_LOWER_UP


	)

129 
	#IFF_DORMANT
 
IFF_DORMANT


	)

130 
	#IFF_ECHO
 
IFF_ECHO


	)

133 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

134 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

136 
	#IF_GET_IFACE
 0x0001

	)

137 
	#IF_GET_PROTO
 0x0002

	)

140 
	#IF_IFACE_V35
 0x1000

	)

141 
	#IF_IFACE_V24
 0x1001

	)

142 
	#IF_IFACE_X21
 0x1002

	)

143 
	#IF_IFACE_T1
 0x1003

	)

144 
	#IF_IFACE_E1
 0x1004

	)

145 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

146 
	#IF_IFACE_X21D
 0x1006

	)

149 
	#IF_PROTO_HDLC
 0x2000

	)

150 
	#IF_PROTO_PPP
 0x2001

	)

151 
	#IF_PROTO_CISCO
 0x2002

	)

152 
	#IF_PROTO_FR
 0x2003

	)

153 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

154 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

155 
	#IF_PROTO_X25
 0x2006

	)

156 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

157 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

158 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

159 
	#IF_PROTO_FR_PVC
 0x200A

	)

160 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

161 
	#IF_PROTO_RAW
 0x200C

	)

165 
	mIF_OPER_UNKNOWN
,

166 
	mIF_OPER_NOTPRESENT
,

167 
	mIF_OPER_DOWN
,

168 
	mIF_OPER_LOWERLAYERDOWN
,

169 
	mIF_OPER_TESTING
,

170 
	mIF_OPER_DORMANT
,

171 
	mIF_OPER_UP
,

176 
	mIF_LINK_MODE_DEFAULT
,

177 
	mIF_LINK_MODE_DORMANT
,

191 #i‡
__UAPI_DEF_IF_IFMAP


192 
	sifm≠
 {

193 
	mmem_°¨t
;

194 
	mmem_íd
;

195 
	mba£_addr
;

196 
	múq
;

197 
	mdma
;

198 
	mp‹t
;

203 
	sif_£âögs
 {

204 
	mty≥
;

205 
	msize
;

208 
øw_hdlc_¥Ÿo
 *
	møw_hdlc
;

209 
cisco_¥Ÿo
 *
	mcisco
;

210 
‰_¥Ÿo
 *
	m‰
;

211 
‰_¥Ÿo_pvc
 *
	m‰_pvc
;

212 
‰_¥Ÿo_pvc_öfo
 *
	m‰_pvc_öfo
;

215 
sync_£rül_£âögs
 *
	msync
;

216 
ã1_£âögs
 *
	mã1
;

217 } 
	mifs_ifsu
;

228 #i‡
__UAPI_DEF_IF_IFREQ


229 
	si‰eq
 {

230 
	#IFHWADDRLEN
 6

	)

233 
	mi‰n_«me
[
IFNAMSIZ
];

234 } 
	mi‰_i‰n
;

237 
sockaddr
 
	mi‰u_addr
;

238 
sockaddr
 
	mi‰u_d°addr
;

239 
sockaddr
 
	mi‰u_brﬂdaddr
;

240 
sockaddr
 
	mi‰u_√tmask
;

241 
sockaddr
 
	mi‰u_hwaddr
;

242 
	mi‰u_Êags
;

243 
	mi‰u_ivÆue
;

244 
	mi‰u_mtu
;

245 
ifm≠
 
	mi‰u_m≠
;

246 
	mi‰u_¶ave
[
IFNAMSIZ
];

247 
	mi‰u_√w«me
[
IFNAMSIZ
];

248 * 
	mi‰u_d©a
;

249 
if_£âögs
 
	mi‰u_£âögs
;

250 } 
	mi‰_i‰u
;

254 
	#i‰_«me
 
i‰_i‰n
.
i‰n_«me


	)

255 
	#i‰_hwaddr
 
i‰_i‰u
.
i‰u_hwaddr


	)

256 
	#i‰_addr
 
i‰_i‰u
.
i‰u_addr


	)

257 
	#i‰_d°addr
 
i‰_i‰u
.
i‰u_d°addr


	)

258 
	#i‰_brﬂdaddr
 
i‰_i‰u
.
i‰u_brﬂdaddr


	)

259 
	#i‰_√tmask
 
i‰_i‰u
.
i‰u_√tmask


	)

260 
	#i‰_Êags
 
i‰_i‰u
.
i‰u_Êags


	)

261 
	#i‰_mëric
 
i‰_i‰u
.
i‰u_ivÆue


	)

262 
	#i‰_mtu
 
i‰_i‰u
.
i‰u_mtu


	)

263 
	#i‰_m≠
 
i‰_i‰u
.
i‰u_m≠


	)

264 
	#i‰_¶ave
 
i‰_i‰u
.
i‰u_¶ave


	)

265 
	#i‰_d©a
 
i‰_i‰u
.
i‰u_d©a


	)

266 
	#i‰_ifödex
 
i‰_i‰u
.
i‰u_ivÆue


	)

267 
	#i‰_b™dwidth
 
i‰_i‰u
.
i‰u_ivÆue


	)

268 
	#i‰_qÀn
 
i‰_i‰u
.
i‰u_ivÆue


	)

269 
	#i‰_√w«me
 
i‰_i‰u
.
i‰u_√w«me


	)

270 
	#i‰_£âögs
 
i‰_i‰u
.
i‰u_£âögs


	)

280 #i‡
__UAPI_DEF_IF_IFCONF


281 
	sifc⁄f
 {

282 
	mifc_Àn
;

284 *
	mifcu_buf
;

285 
i‰eq
 *
	mifcu_ªq
;

286 } 
	mifc_ifcu
;

290 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

291 
	#ifc_ªq
 
ifc_ifcu
.
ifcu_ªq


	)

	@/usr/include/linux/if_ether.h

22 #i‚de‡
_LINUX_IF_ETHER_H


23 
	#_LINUX_IF_ETHER_H


	)

25 
	~<löux/ty≥s.h
>

32 
	#ETH_ALEN
 6

	)

33 
	#ETH_TLEN
 2

	)

34 
	#ETH_HLEN
 14

	)

35 
	#ETH_ZLEN
 60

	)

36 
	#ETH_DATA_LEN
 1500

	)

37 
	#ETH_FRAME_LEN
 1514

	)

38 
	#ETH_FCS_LEN
 4

	)

40 
	#ETH_MIN_MTU
 68

	)

41 
	#ETH_MAX_MTU
 0xFFFFU

	)

47 
	#ETH_P_LOOP
 0x0060

	)

48 
	#ETH_P_PUP
 0x0200

	)

49 
	#ETH_P_PUPAT
 0x0201

	)

50 
	#ETH_P_TSN
 0x22F0

	)

51 
	#ETH_P_ERSPAN2
 0x22EB

	)

52 
	#ETH_P_IP
 0x0800

	)

53 
	#ETH_P_X25
 0x0805

	)

54 
	#ETH_P_ARP
 0x0806

	)

55 
	#ETH_P_BPQ
 0x08FF

	)

56 
	#ETH_P_IEEEPUP
 0x0a00

	)

57 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

58 
	#ETH_P_BATMAN
 0x4305

	)

59 
	#ETH_P_DEC
 0x6000

	)

60 
	#ETH_P_DNA_DL
 0x6001

	)

61 
	#ETH_P_DNA_RC
 0x6002

	)

62 
	#ETH_P_DNA_RT
 0x6003

	)

63 
	#ETH_P_LAT
 0x6004

	)

64 
	#ETH_P_DIAG
 0x6005

	)

65 
	#ETH_P_CUST
 0x6006

	)

66 
	#ETH_P_SCA
 0x6007

	)

67 
	#ETH_P_TEB
 0x6558

	)

68 
	#ETH_P_RARP
 0x8035

	)

69 
	#ETH_P_ATALK
 0x809B

	)

70 
	#ETH_P_AARP
 0x80F3

	)

71 
	#ETH_P_8021Q
 0x8100

	)

72 
	#ETH_P_ERSPAN
 0x88BE

	)

73 
	#ETH_P_IPX
 0x8137

	)

74 
	#ETH_P_IPV6
 0x86DD

	)

75 
	#ETH_P_PAUSE
 0x8808

	)

76 
	#ETH_P_SLOW
 0x8809

	)

77 
	#ETH_P_WCCP
 0x883E

	)

79 
	#ETH_P_MPLS_UC
 0x8847

	)

80 
	#ETH_P_MPLS_MC
 0x8848

	)

81 
	#ETH_P_ATMMPOA
 0x884¯

	)

82 
	#ETH_P_PPP_DISC
 0x8863

	)

83 
	#ETH_P_PPP_SES
 0x8864

	)

84 
	#ETH_P_LINK_CTL
 0x886¯

	)

85 
	#ETH_P_ATMFATE
 0x8884

	)

88 
	#ETH_P_PAE
 0x888E

	)

89 
	#ETH_P_AOE
 0x88A2

	)

90 
	#ETH_P_8021AD
 0x88A8

	)

91 
	#ETH_P_802_EX1
 0x88B5

	)

92 
	#ETH_P_PREAUTH
 0x88C7

	)

93 
	#ETH_P_TIPC
 0x88CA

	)

94 
	#ETH_P_LLDP
 0x88CC

	)

95 
	#ETH_P_MACSEC
 0x88E5

	)

96 
	#ETH_P_8021AH
 0x88E7

	)

97 
	#ETH_P_MVRP
 0x88F5

	)

98 
	#ETH_P_1588
 0x88F7

	)

99 
	#ETH_P_NCSI
 0x88F8

	)

100 
	#ETH_P_PRP
 0x88FB

	)

101 
	#ETH_P_FCOE
 0x8906

	)

102 
	#ETH_P_IBOE
 0x8915

	)

103 
	#ETH_P_TDLS
 0x890D

	)

104 
	#ETH_P_FIP
 0x8914

	)

105 
	#ETH_P_80221
 0x8917

	)

106 
	#ETH_P_HSR
 0x892F

	)

107 
	#ETH_P_NSH
 0x894F

	)

108 
	#ETH_P_LOOPBACK
 0x9000

	)

109 
	#ETH_P_QINQ1
 0x9100

	)

110 
	#ETH_P_QINQ2
 0x9200

	)

111 
	#ETH_P_QINQ3
 0x9300

	)

112 
	#ETH_P_EDSA
 0xDADA

	)

113 
	#ETH_P_DSA_8021Q
 0xDADB

	)

114 
	#ETH_P_IFE
 0xED3E

	)

115 
	#ETH_P_AF_IUCV
 0xFBFB

	)

117 
	#ETH_P_802_3_MIN
 0x0600

	)

124 
	#ETH_P_802_3
 0x0001

	)

125 
	#ETH_P_AX25
 0x0002

	)

126 
	#ETH_P_ALL
 0x0003

	)

127 
	#ETH_P_802_2
 0x0004

	)

128 
	#ETH_P_SNAP
 0x0005

	)

129 
	#ETH_P_DDCMP
 0x0006

	)

130 
	#ETH_P_WAN_PPP
 0x0007

	)

131 
	#ETH_P_PPP_MP
 0x0008

	)

132 
	#ETH_P_LOCALTALK
 0x0009

	)

133 
	#ETH_P_CAN
 0x000C

	)

134 
	#ETH_P_CANFD
 0x000D

	)

135 
	#ETH_P_PPPTALK
 0x0010

	)

136 
	#ETH_P_TR_802_2
 0x0011

	)

137 
	#ETH_P_MOBITEX
 0x0015

	)

138 
	#ETH_P_CONTROL
 0x0016

	)

139 
	#ETH_P_IRDA
 0x0017

	)

140 
	#ETH_P_ECONET
 0x0018

	)

141 
	#ETH_P_HDLC
 0x0019

	)

142 
	#ETH_P_ARCNET
 0x001A

	)

143 
	#ETH_P_DSA
 0x001B

	)

144 
	#ETH_P_TRAILER
 0x001C

	)

145 
	#ETH_P_PHONET
 0x00F5

	)

146 
	#ETH_P_IEEE802154
 0x00F6

	)

147 
	#ETH_P_CAIF
 0x00F7

	)

148 
	#ETH_P_XDSA
 0x00F8

	)

149 
	#ETH_P_MAP
 0x00F9

	)

158 #i‚de‡
__UAPI_DEF_ETHHDR


159 
	#__UAPI_DEF_ETHHDR
 1

	)

162 #i‡
__UAPI_DEF_ETHHDR


163 
	sëhhdr
 {

164 
	mh_de°
[
ETH_ALEN
];

165 
	mh_sour˚
[
ETH_ALEN
];

166 
__be16
 
	mh_¥Ÿo
;

167 } 
__©åibuã__
((
∑cked
));

	@/usr/include/linux/if_link.h

2 #i‚de‡
_LINUX_IF_LINK_H


3 
	#_LINUX_IF_LINK_H


	)

5 
	~<löux/ty≥s.h
>

6 
	~<löux/√éök.h
>

9 
	sπ∆_lök_°©s
 {

10 
__u32
 
	mrx_∑ckës
;

11 
__u32
 
	mtx_∑ckës
;

12 
__u32
 
	mrx_byãs
;

13 
__u32
 
	mtx_byãs
;

14 
__u32
 
	mrx_îr‹s
;

15 
__u32
 
	mtx_îr‹s
;

16 
__u32
 
	mrx_dr›≥d
;

17 
__u32
 
	mtx_dr›≥d
;

18 
__u32
 
	mmu…iˇ°
;

19 
__u32
 
	mcﬁlisi⁄s
;

22 
__u32
 
	mrx_Àngth_îr‹s
;

23 
__u32
 
	mrx_ovî_îr‹s
;

24 
__u32
 
	mrx_¸c_îr‹s
;

25 
__u32
 
	mrx_‰ame_îr‹s
;

26 
__u32
 
	mrx_fifo_îr‹s
;

27 
__u32
 
	mrx_mis£d_îr‹s
;

30 
__u32
 
	mtx_ab‹ãd_îr‹s
;

31 
__u32
 
	mtx_ˇºõr_îr‹s
;

32 
__u32
 
	mtx_fifo_îr‹s
;

33 
__u32
 
	mtx_hóπbót_îr‹s
;

34 
__u32
 
	mtx_wödow_îr‹s
;

37 
__u32
 
	mrx_com¥es£d
;

38 
__u32
 
	mtx_com¥es£d
;

40 
__u32
 
	mrx_noh™dÀr
;

44 
	sπ∆_lök_°©s64
 {

45 
__u64
 
	mrx_∑ckës
;

46 
__u64
 
	mtx_∑ckës
;

47 
__u64
 
	mrx_byãs
;

48 
__u64
 
	mtx_byãs
;

49 
__u64
 
	mrx_îr‹s
;

50 
__u64
 
	mtx_îr‹s
;

51 
__u64
 
	mrx_dr›≥d
;

52 
__u64
 
	mtx_dr›≥d
;

53 
__u64
 
	mmu…iˇ°
;

54 
__u64
 
	mcﬁlisi⁄s
;

57 
__u64
 
	mrx_Àngth_îr‹s
;

58 
__u64
 
	mrx_ovî_îr‹s
;

59 
__u64
 
	mrx_¸c_îr‹s
;

60 
__u64
 
	mrx_‰ame_îr‹s
;

61 
__u64
 
	mrx_fifo_îr‹s
;

62 
__u64
 
	mrx_mis£d_îr‹s
;

65 
__u64
 
	mtx_ab‹ãd_îr‹s
;

66 
__u64
 
	mtx_ˇºõr_îr‹s
;

67 
__u64
 
	mtx_fifo_îr‹s
;

68 
__u64
 
	mtx_hóπbót_îr‹s
;

69 
__u64
 
	mtx_wödow_îr‹s
;

72 
__u64
 
	mrx_com¥es£d
;

73 
__u64
 
	mtx_com¥es£d
;

75 
__u64
 
	mrx_noh™dÀr
;

79 
	sπ∆_lök_ifm≠
 {

80 
__u64
 
	mmem_°¨t
;

81 
__u64
 
	mmem_íd
;

82 
__u64
 
	mba£_addr
;

83 
__u16
 
	múq
;

84 
__u8
 
	mdma
;

85 
__u8
 
	mp‹t
;

107 
	mIFLA_UNSPEC
,

108 
	mIFLA_ADDRESS
,

109 
	mIFLA_BROADCAST
,

110 
	mIFLA_IFNAME
,

111 
	mIFLA_MTU
,

112 
	mIFLA_LINK
,

113 
	mIFLA_QDISC
,

114 
	mIFLA_STATS
,

115 
	mIFLA_COST
,

116 
	#IFLA_COST
 
IFLA_COST


	)

117 
	mIFLA_PRIORITY
,

118 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

119 
	mIFLA_MASTER
,

120 
	#IFLA_MASTER
 
IFLA_MASTER


	)

121 
	mIFLA_WIRELESS
,

122 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

123 
	mIFLA_PROTINFO
,

124 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

125 
	mIFLA_TXQLEN
,

126 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

127 
	mIFLA_MAP
,

128 
	#IFLA_MAP
 
IFLA_MAP


	)

129 
	mIFLA_WEIGHT
,

130 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

131 
	mIFLA_OPERSTATE
,

132 
	mIFLA_LINKMODE
,

133 
	mIFLA_LINKINFO
,

134 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

135 
	mIFLA_NET_NS_PID
,

136 
	mIFLA_IFALIAS
,

137 
	mIFLA_NUM_VF
,

138 
	mIFLA_VFINFO_LIST
,

139 
	mIFLA_STATS64
,

140 
	mIFLA_VF_PORTS
,

141 
	mIFLA_PORT_SELF
,

142 
	mIFLA_AF_SPEC
,

143 
	mIFLA_GROUP
,

144 
	mIFLA_NET_NS_FD
,

145 
	mIFLA_EXT_MASK
,

146 
	mIFLA_PROMISCUITY
,

147 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

148 
	mIFLA_NUM_TX_QUEUES
,

149 
	mIFLA_NUM_RX_QUEUES
,

150 
	mIFLA_CARRIER
,

151 
	mIFLA_PHYS_PORT_ID
,

152 
	mIFLA_CARRIER_CHANGES
,

153 
	mIFLA_PHYS_SWITCH_ID
,

154 
	mIFLA_LINK_NETNSID
,

155 
	mIFLA_PHYS_PORT_NAME
,

156 
	mIFLA_PROTO_DOWN
,

157 
	mIFLA_GSO_MAX_SEGS
,

158 
	mIFLA_GSO_MAX_SIZE
,

159 
	mIFLA_PAD
,

160 
	mIFLA_XDP
,

161 
	mIFLA_EVENT
,

162 
	mIFLA_NEW_NETNSID
,

163 
	mIFLA_IF_NETNSID
,

164 
	mIFLA_TARGET_NETNSID
 = 
IFLA_IF_NETNSID
,

165 
	mIFLA_CARRIER_UP_COUNT
,

166 
	mIFLA_CARRIER_DOWN_COUNT
,

167 
	mIFLA_NEW_IFINDEX
,

168 
	mIFLA_MIN_MTU
,

169 
	mIFLA_MAX_MTU
,

170 
	m__IFLA_MAX


174 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

177 
	#IFLA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
iföfomsg
))))

	)

178 
	#IFLA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
iföfomsg
))

	)

181 
	mIFLA_INET_UNSPEC
,

182 
	mIFLA_INET_CONF
,

183 
	m__IFLA_INET_MAX
,

186 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

219 
	mIFLA_INET6_UNSPEC
,

220 
	mIFLA_INET6_FLAGS
,

221 
	mIFLA_INET6_CONF
,

222 
	mIFLA_INET6_STATS
,

223 
	mIFLA_INET6_MCAST
,

224 
	mIFLA_INET6_CACHEINFO
,

225 
	mIFLA_INET6_ICMP6STATS
,

226 
	mIFLA_INET6_TOKEN
,

227 
	mIFLA_INET6_ADDR_GEN_MODE
,

228 
	m__IFLA_INET6_MAX


231 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

233 
	eö6_addr_gí_mode
 {

234 
	mIN6_ADDR_GEN_MODE_EUI64
,

235 
	mIN6_ADDR_GEN_MODE_NONE
,

236 
	mIN6_ADDR_GEN_MODE_STABLE_PRIVACY
,

237 
	mIN6_ADDR_GEN_MODE_RANDOM
,

243 
	mIFLA_BR_UNSPEC
,

244 
	mIFLA_BR_FORWARD_DELAY
,

245 
	mIFLA_BR_HELLO_TIME
,

246 
	mIFLA_BR_MAX_AGE
,

247 
	mIFLA_BR_AGEING_TIME
,

248 
	mIFLA_BR_STP_STATE
,

249 
	mIFLA_BR_PRIORITY
,

250 
	mIFLA_BR_VLAN_FILTERING
,

251 
	mIFLA_BR_VLAN_PROTOCOL
,

252 
	mIFLA_BR_GROUP_FWD_MASK
,

253 
	mIFLA_BR_ROOT_ID
,

254 
	mIFLA_BR_BRIDGE_ID
,

255 
	mIFLA_BR_ROOT_PORT
,

256 
	mIFLA_BR_ROOT_PATH_COST
,

257 
	mIFLA_BR_TOPOLOGY_CHANGE
,

258 
	mIFLA_BR_TOPOLOGY_CHANGE_DETECTED
,

259 
	mIFLA_BR_HELLO_TIMER
,

260 
	mIFLA_BR_TCN_TIMER
,

261 
	mIFLA_BR_TOPOLOGY_CHANGE_TIMER
,

262 
	mIFLA_BR_GC_TIMER
,

263 
	mIFLA_BR_GROUP_ADDR
,

264 
	mIFLA_BR_FDB_FLUSH
,

265 
	mIFLA_BR_MCAST_ROUTER
,

266 
	mIFLA_BR_MCAST_SNOOPING
,

267 
	mIFLA_BR_MCAST_QUERY_USE_IFADDR
,

268 
	mIFLA_BR_MCAST_QUERIER
,

269 
	mIFLA_BR_MCAST_HASH_ELASTICITY
,

270 
	mIFLA_BR_MCAST_HASH_MAX
,

271 
	mIFLA_BR_MCAST_LAST_MEMBER_CNT
,

272 
	mIFLA_BR_MCAST_STARTUP_QUERY_CNT
,

273 
	mIFLA_BR_MCAST_LAST_MEMBER_INTVL
,

274 
	mIFLA_BR_MCAST_MEMBERSHIP_INTVL
,

275 
	mIFLA_BR_MCAST_QUERIER_INTVL
,

276 
	mIFLA_BR_MCAST_QUERY_INTVL
,

277 
	mIFLA_BR_MCAST_QUERY_RESPONSE_INTVL
,

278 
	mIFLA_BR_MCAST_STARTUP_QUERY_INTVL
,

279 
	mIFLA_BR_NF_CALL_IPTABLES
,

280 
	mIFLA_BR_NF_CALL_IP6TABLES
,

281 
	mIFLA_BR_NF_CALL_ARPTABLES
,

282 
	mIFLA_BR_VLAN_DEFAULT_PVID
,

283 
	mIFLA_BR_PAD
,

284 
	mIFLA_BR_VLAN_STATS_ENABLED
,

285 
	mIFLA_BR_MCAST_STATS_ENABLED
,

286 
	mIFLA_BR_MCAST_IGMP_VERSION
,

287 
	mIFLA_BR_MCAST_MLD_VERSION
,

288 
	mIFLA_BR_VLAN_STATS_PER_PORT
,

289 
	mIFLA_BR_MULTI_BOOLOPT
,

290 
	m__IFLA_BR_MAX
,

293 
	#IFLA_BR_MAX
 (
__IFLA_BR_MAX
 - 1)

	)

295 
	siÊa_bridge_id
 {

296 
__u8
 
	m¥io
[2];

297 
__u8
 
	maddr
[6];

301 
	mBRIDGE_MODE_UNSPEC
,

302 
	mBRIDGE_MODE_HAIRPIN
,

306 
	mIFLA_BRPORT_UNSPEC
,

307 
	mIFLA_BRPORT_STATE
,

308 
	mIFLA_BRPORT_PRIORITY
,

309 
	mIFLA_BRPORT_COST
,

310 
	mIFLA_BRPORT_MODE
,

311 
	mIFLA_BRPORT_GUARD
,

312 
	mIFLA_BRPORT_PROTECT
,

313 
	mIFLA_BRPORT_FAST_LEAVE
,

314 
	mIFLA_BRPORT_LEARNING
,

315 
	mIFLA_BRPORT_UNICAST_FLOOD
,

316 
	mIFLA_BRPORT_PROXYARP
,

317 
	mIFLA_BRPORT_LEARNING_SYNC
,

318 
	mIFLA_BRPORT_PROXYARP_WIFI
,

319 
	mIFLA_BRPORT_ROOT_ID
,

320 
	mIFLA_BRPORT_BRIDGE_ID
,

321 
	mIFLA_BRPORT_DESIGNATED_PORT
,

322 
	mIFLA_BRPORT_DESIGNATED_COST
,

323 
	mIFLA_BRPORT_ID
,

324 
	mIFLA_BRPORT_NO
,

325 
	mIFLA_BRPORT_TOPOLOGY_CHANGE_ACK
,

326 
	mIFLA_BRPORT_CONFIG_PENDING
,

327 
	mIFLA_BRPORT_MESSAGE_AGE_TIMER
,

328 
	mIFLA_BRPORT_FORWARD_DELAY_TIMER
,

329 
	mIFLA_BRPORT_HOLD_TIMER
,

330 
	mIFLA_BRPORT_FLUSH
,

331 
	mIFLA_BRPORT_MULTICAST_ROUTER
,

332 
	mIFLA_BRPORT_PAD
,

333 
	mIFLA_BRPORT_MCAST_FLOOD
,

334 
	mIFLA_BRPORT_MCAST_TO_UCAST
,

335 
	mIFLA_BRPORT_VLAN_TUNNEL
,

336 
	mIFLA_BRPORT_BCAST_FLOOD
,

337 
	mIFLA_BRPORT_GROUP_FWD_MASK
,

338 
	mIFLA_BRPORT_NEIGH_SUPPRESS
,

339 
	mIFLA_BRPORT_ISOLATED
,

340 
	mIFLA_BRPORT_BACKUP_PORT
,

341 
	m__IFLA_BRPORT_MAX


343 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

345 
	siÊa_ˇcheöfo
 {

346 
__u32
 
	mmax_ªasm_Àn
;

347 
__u32
 
	mt°amp
;

348 
__u32
 
	mªachabÀ_time
;

349 
__u32
 
	mªå™s_time
;

353 
	mIFLA_INFO_UNSPEC
,

354 
	mIFLA_INFO_KIND
,

355 
	mIFLA_INFO_DATA
,

356 
	mIFLA_INFO_XSTATS
,

357 
	mIFLA_INFO_SLAVE_KIND
,

358 
	mIFLA_INFO_SLAVE_DATA
,

359 
	m__IFLA_INFO_MAX
,

362 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

367 
	mIFLA_VLAN_UNSPEC
,

368 
	mIFLA_VLAN_ID
,

369 
	mIFLA_VLAN_FLAGS
,

370 
	mIFLA_VLAN_EGRESS_QOS
,

371 
	mIFLA_VLAN_INGRESS_QOS
,

372 
	mIFLA_VLAN_PROTOCOL
,

373 
	m__IFLA_VLAN_MAX
,

376 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

378 
	siÊa_vœn_Êags
 {

379 
__u32
 
	mÊags
;

380 
__u32
 
	mmask
;

384 
	mIFLA_VLAN_QOS_UNSPEC
,

385 
	mIFLA_VLAN_QOS_MAPPING
,

386 
	m__IFLA_VLAN_QOS_MAX


389 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

391 
	siÊa_vœn_qos_m≠pög
 {

392 
__u32
 
	m‰om
;

393 
__u32
 
	mto
;

398 
	mIFLA_MACVLAN_UNSPEC
,

399 
	mIFLA_MACVLAN_MODE
,

400 
	mIFLA_MACVLAN_FLAGS
,

401 
	mIFLA_MACVLAN_MACADDR_MODE
,

402 
	mIFLA_MACVLAN_MACADDR
,

403 
	mIFLA_MACVLAN_MACADDR_DATA
,

404 
	mIFLA_MACVLAN_MACADDR_COUNT
,

405 
	m__IFLA_MACVLAN_MAX
,

408 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

410 
	emacvœn_mode
 {

411 
	mMACVLAN_MODE_PRIVATE
 = 1,

412 
	mMACVLAN_MODE_VEPA
 = 2,

413 
	mMACVLAN_MODE_BRIDGE
 = 4,

414 
	mMACVLAN_MODE_PASSTHRU
 = 8,

415 
	mMACVLAN_MODE_SOURCE
 = 16,

418 
	emacvœn_maˇddr_mode
 {

419 
	mMACVLAN_MACADDR_ADD
,

420 
	mMACVLAN_MACADDR_DEL
,

421 
	mMACVLAN_MACADDR_FLUSH
,

422 
	mMACVLAN_MACADDR_SET
,

425 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

429 
	mIFLA_VRF_UNSPEC
,

430 
	mIFLA_VRF_TABLE
,

431 
	m__IFLA_VRF_MAX


434 
	#IFLA_VRF_MAX
 (
__IFLA_VRF_MAX
 - 1)

	)

437 
	mIFLA_VRF_PORT_UNSPEC
,

438 
	mIFLA_VRF_PORT_TABLE
,

439 
	m__IFLA_VRF_PORT_MAX


442 
	#IFLA_VRF_PORT_MAX
 (
__IFLA_VRF_PORT_MAX
 - 1)

	)

446 
	mIFLA_MACSEC_UNSPEC
,

447 
	mIFLA_MACSEC_SCI
,

448 
	mIFLA_MACSEC_PORT
,

449 
	mIFLA_MACSEC_ICV_LEN
,

450 
	mIFLA_MACSEC_CIPHER_SUITE
,

451 
	mIFLA_MACSEC_WINDOW
,

452 
	mIFLA_MACSEC_ENCODING_SA
,

453 
	mIFLA_MACSEC_ENCRYPT
,

454 
	mIFLA_MACSEC_PROTECT
,

455 
	mIFLA_MACSEC_INC_SCI
,

456 
	mIFLA_MACSEC_ES
,

457 
	mIFLA_MACSEC_SCB
,

458 
	mIFLA_MACSEC_REPLAY_PROTECT
,

459 
	mIFLA_MACSEC_VALIDATION
,

460 
	mIFLA_MACSEC_PAD
,

461 
	m__IFLA_MACSEC_MAX
,

464 
	#IFLA_MACSEC_MAX
 (
__IFLA_MACSEC_MAX
 - 1)

	)

468 
	mIFLA_XFRM_UNSPEC
,

469 
	mIFLA_XFRM_LINK
,

470 
	mIFLA_XFRM_IF_ID
,

471 
	m__IFLA_XFRM_MAX


474 
	#IFLA_XFRM_MAX
 (
__IFLA_XFRM_MAX
 - 1)

	)

476 
	emac£c_vÆid©i⁄_ty≥
 {

477 
	mMACSEC_VALIDATE_DISABLED
 = 0,

478 
	mMACSEC_VALIDATE_CHECK
 = 1,

479 
	mMACSEC_VALIDATE_STRICT
 = 2,

480 
	m__MACSEC_VALIDATE_END
,

481 
	mMACSEC_VALIDATE_MAX
 = 
__MACSEC_VALIDATE_END
 - 1,

486 
	mIFLA_IPVLAN_UNSPEC
,

487 
	mIFLA_IPVLAN_MODE
,

488 
	mIFLA_IPVLAN_FLAGS
,

489 
	m__IFLA_IPVLAN_MAX


492 
	#IFLA_IPVLAN_MAX
 (
__IFLA_IPVLAN_MAX
 - 1)

	)

494 
	eùvœn_mode
 {

495 
	mIPVLAN_MODE_L2
 = 0,

496 
	mIPVLAN_MODE_L3
,

497 
	mIPVLAN_MODE_L3S
,

498 
	mIPVLAN_MODE_MAX


501 
	#IPVLAN_F_PRIVATE
 0x01

	)

502 
	#IPVLAN_F_VEPA
 0x02

	)

506 
	mIFLA_VXLAN_UNSPEC
,

507 
	mIFLA_VXLAN_ID
,

508 
	mIFLA_VXLAN_GROUP
,

509 
	mIFLA_VXLAN_LINK
,

510 
	mIFLA_VXLAN_LOCAL
,

511 
	mIFLA_VXLAN_TTL
,

512 
	mIFLA_VXLAN_TOS
,

513 
	mIFLA_VXLAN_LEARNING
,

514 
	mIFLA_VXLAN_AGEING
,

515 
	mIFLA_VXLAN_LIMIT
,

516 
	mIFLA_VXLAN_PORT_RANGE
,

517 
	mIFLA_VXLAN_PROXY
,

518 
	mIFLA_VXLAN_RSC
,

519 
	mIFLA_VXLAN_L2MISS
,

520 
	mIFLA_VXLAN_L3MISS
,

521 
	mIFLA_VXLAN_PORT
,

522 
	mIFLA_VXLAN_GROUP6
,

523 
	mIFLA_VXLAN_LOCAL6
,

524 
	mIFLA_VXLAN_UDP_CSUM
,

525 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_TX
,

526 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_RX
,

527 
	mIFLA_VXLAN_REMCSUM_TX
,

528 
	mIFLA_VXLAN_REMCSUM_RX
,

529 
	mIFLA_VXLAN_GBP
,

530 
	mIFLA_VXLAN_REMCSUM_NOPARTIAL
,

531 
	mIFLA_VXLAN_COLLECT_METADATA
,

532 
	mIFLA_VXLAN_LABEL
,

533 
	mIFLA_VXLAN_GPE
,

534 
	mIFLA_VXLAN_TTL_INHERIT
,

535 
	mIFLA_VXLAN_DF
,

536 
	mIFLA_VXLAN_FAN_MAP
 = 33,

537 
	m__IFLA_VXLAN_MAX


539 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

541 
	siÊa_vxœn_p‹t_ønge
 {

542 
__be16
 
	mlow
;

543 
__be16
 
	mhigh
;

546 
	eiÊa_vxœn_df
 {

547 
	mVXLAN_DF_UNSET
 = 0,

548 
	mVXLAN_DF_SET
,

549 
	mVXLAN_DF_INHERIT
,

550 
	m__VXLAN_DF_END
,

551 
	mVXLAN_DF_MAX
 = 
__VXLAN_DF_END
 - 1,

556 
	mIFLA_GENEVE_UNSPEC
,

557 
	mIFLA_GENEVE_ID
,

558 
	mIFLA_GENEVE_REMOTE
,

559 
	mIFLA_GENEVE_TTL
,

560 
	mIFLA_GENEVE_TOS
,

561 
	mIFLA_GENEVE_PORT
,

562 
	mIFLA_GENEVE_COLLECT_METADATA
,

563 
	mIFLA_GENEVE_REMOTE6
,

564 
	mIFLA_GENEVE_UDP_CSUM
,

565 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_TX
,

566 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_RX
,

567 
	mIFLA_GENEVE_LABEL
,

568 
	mIFLA_GENEVE_TTL_INHERIT
,

569 
	mIFLA_GENEVE_DF
,

570 
	m__IFLA_GENEVE_MAX


572 
	#IFLA_GENEVE_MAX
 (
__IFLA_GENEVE_MAX
 - 1)

	)

574 
	eiÊa_gíeve_df
 {

575 
	mGENEVE_DF_UNSET
 = 0,

576 
	mGENEVE_DF_SET
,

577 
	mGENEVE_DF_INHERIT
,

578 
	m__GENEVE_DF_END
,

579 
	mGENEVE_DF_MAX
 = 
__GENEVE_DF_END
 - 1,

584 
	mIFLA_PPP_UNSPEC
,

585 
	mIFLA_PPP_DEV_FD
,

586 
	m__IFLA_PPP_MAX


588 
	#IFLA_PPP_MAX
 (
__IFLA_PPP_MAX
 - 1)

	)

592 
	eiÊa_gç_rﬁe
 {

593 
	mGTP_ROLE_GGSN
 = 0,

594 
	mGTP_ROLE_SGSN
,

598 
	mIFLA_GTP_UNSPEC
,

599 
	mIFLA_GTP_FD0
,

600 
	mIFLA_GTP_FD1
,

601 
	mIFLA_GTP_PDP_HASHSIZE
,

602 
	mIFLA_GTP_ROLE
,

603 
	m__IFLA_GTP_MAX
,

605 
	#IFLA_GTP_MAX
 (
__IFLA_GTP_MAX
 - 1)

	)

610 
	mIFLA_BOND_UNSPEC
,

611 
	mIFLA_BOND_MODE
,

612 
	mIFLA_BOND_ACTIVE_SLAVE
,

613 
	mIFLA_BOND_MIIMON
,

614 
	mIFLA_BOND_UPDELAY
,

615 
	mIFLA_BOND_DOWNDELAY
,

616 
	mIFLA_BOND_USE_CARRIER
,

617 
	mIFLA_BOND_ARP_INTERVAL
,

618 
	mIFLA_BOND_ARP_IP_TARGET
,

619 
	mIFLA_BOND_ARP_VALIDATE
,

620 
	mIFLA_BOND_ARP_ALL_TARGETS
,

621 
	mIFLA_BOND_PRIMARY
,

622 
	mIFLA_BOND_PRIMARY_RESELECT
,

623 
	mIFLA_BOND_FAIL_OVER_MAC
,

624 
	mIFLA_BOND_XMIT_HASH_POLICY
,

625 
	mIFLA_BOND_RESEND_IGMP
,

626 
	mIFLA_BOND_NUM_PEER_NOTIF
,

627 
	mIFLA_BOND_ALL_SLAVES_ACTIVE
,

628 
	mIFLA_BOND_MIN_LINKS
,

629 
	mIFLA_BOND_LP_INTERVAL
,

630 
	mIFLA_BOND_PACKETS_PER_SLAVE
,

631 
	mIFLA_BOND_AD_LACP_RATE
,

632 
	mIFLA_BOND_AD_SELECT
,

633 
	mIFLA_BOND_AD_INFO
,

634 
	mIFLA_BOND_AD_ACTOR_SYS_PRIO
,

635 
	mIFLA_BOND_AD_USER_PORT_KEY
,

636 
	mIFLA_BOND_AD_ACTOR_SYSTEM
,

637 
	mIFLA_BOND_TLB_DYNAMIC_LB
,

638 
	mIFLA_BOND_PEER_NOTIF_DELAY
,

639 
	m__IFLA_BOND_MAX
,

642 
	#IFLA_BOND_MAX
 (
__IFLA_BOND_MAX
 - 1)

	)

645 
	mIFLA_BOND_AD_INFO_UNSPEC
,

646 
	mIFLA_BOND_AD_INFO_AGGREGATOR
,

647 
	mIFLA_BOND_AD_INFO_NUM_PORTS
,

648 
	mIFLA_BOND_AD_INFO_ACTOR_KEY
,

649 
	mIFLA_BOND_AD_INFO_PARTNER_KEY
,

650 
	mIFLA_BOND_AD_INFO_PARTNER_MAC
,

651 
	m__IFLA_BOND_AD_INFO_MAX
,

654 
	#IFLA_BOND_AD_INFO_MAX
 (
__IFLA_BOND_AD_INFO_MAX
 - 1)

	)

657 
	mIFLA_BOND_SLAVE_UNSPEC
,

658 
	mIFLA_BOND_SLAVE_STATE
,

659 
	mIFLA_BOND_SLAVE_MII_STATUS
,

660 
	mIFLA_BOND_SLAVE_LINK_FAILURE_COUNT
,

661 
	mIFLA_BOND_SLAVE_PERM_HWADDR
,

662 
	mIFLA_BOND_SLAVE_QUEUE_ID
,

663 
	mIFLA_BOND_SLAVE_AD_AGGREGATOR_ID
,

664 
	mIFLA_BOND_SLAVE_AD_ACTOR_OPER_PORT_STATE
,

665 
	mIFLA_BOND_SLAVE_AD_PARTNER_OPER_PORT_STATE
,

666 
	m__IFLA_BOND_SLAVE_MAX
,

669 
	#IFLA_BOND_SLAVE_MAX
 (
__IFLA_BOND_SLAVE_MAX
 - 1)

	)

674 
	mIFLA_VF_INFO_UNSPEC
,

675 
	mIFLA_VF_INFO
,

676 
	m__IFLA_VF_INFO_MAX
,

679 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

682 
	mIFLA_VF_UNSPEC
,

683 
	mIFLA_VF_MAC
,

684 
	mIFLA_VF_VLAN
,

685 
	mIFLA_VF_TX_RATE
,

686 
	mIFLA_VF_SPOOFCHK
,

687 
	mIFLA_VF_LINK_STATE
,

688 
	mIFLA_VF_RATE
,

689 
	mIFLA_VF_RSS_QUERY_EN
,

692 
	mIFLA_VF_STATS
,

693 
	mIFLA_VF_TRUST
,

694 
	mIFLA_VF_IB_NODE_GUID
,

695 
	mIFLA_VF_IB_PORT_GUID
,

696 
	mIFLA_VF_VLAN_LIST
,

697 
	mIFLA_VF_BROADCAST
,

698 
	m__IFLA_VF_MAX
,

701 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

703 
	siÊa_vf_mac
 {

704 
__u32
 
	mvf
;

705 
__u8
 
	mmac
[32];

708 
	siÊa_vf_brﬂdˇ°
 {

709 
__u8
 
	mbrﬂdˇ°
[32];

712 
	siÊa_vf_vœn
 {

713 
__u32
 
	mvf
;

714 
__u32
 
	mvœn
;

715 
__u32
 
	mqos
;

719 
	mIFLA_VF_VLAN_INFO_UNSPEC
,

720 
	mIFLA_VF_VLAN_INFO
,

721 
	m__IFLA_VF_VLAN_INFO_MAX
,

724 
	#IFLA_VF_VLAN_INFO_MAX
 (
__IFLA_VF_VLAN_INFO_MAX
 - 1)

	)

725 
	#MAX_VLAN_LIST_LEN
 1

	)

727 
	siÊa_vf_vœn_öfo
 {

728 
__u32
 
	mvf
;

729 
__u32
 
	mvœn
;

730 
__u32
 
	mqos
;

731 
__be16
 
	mvœn_¥Ÿo
;

734 
	siÊa_vf_tx_øã
 {

735 
__u32
 
	mvf
;

736 
__u32
 
	møã
;

739 
	siÊa_vf_øã
 {

740 
__u32
 
	mvf
;

741 
__u32
 
	mmö_tx_øã
;

742 
__u32
 
	mmax_tx_øã
;

745 
	siÊa_vf_•oofchk
 {

746 
__u32
 
	mvf
;

747 
__u32
 
	m£âög
;

750 
	siÊa_vf_guid
 {

751 
__u32
 
	mvf
;

752 
__u64
 
	mguid
;

756 
	mIFLA_VF_LINK_STATE_AUTO
,

757 
	mIFLA_VF_LINK_STATE_ENABLE
,

758 
	mIFLA_VF_LINK_STATE_DISABLE
,

759 
	m__IFLA_VF_LINK_STATE_MAX
,

762 
	siÊa_vf_lök_°©e
 {

763 
__u32
 
	mvf
;

764 
__u32
 
	mlök_°©e
;

767 
	siÊa_vf_rss_quîy_í
 {

768 
__u32
 
	mvf
;

769 
__u32
 
	m£âög
;

773 
	mIFLA_VF_STATS_RX_PACKETS
,

774 
	mIFLA_VF_STATS_TX_PACKETS
,

775 
	mIFLA_VF_STATS_RX_BYTES
,

776 
	mIFLA_VF_STATS_TX_BYTES
,

777 
	mIFLA_VF_STATS_BROADCAST
,

778 
	mIFLA_VF_STATS_MULTICAST
,

779 
	mIFLA_VF_STATS_PAD
,

780 
	mIFLA_VF_STATS_RX_DROPPED
,

781 
	mIFLA_VF_STATS_TX_DROPPED
,

782 
	m__IFLA_VF_STATS_MAX
,

785 
	#IFLA_VF_STATS_MAX
 (
__IFLA_VF_STATS_MAX
 - 1)

	)

787 
	siÊa_vf_åu°
 {

788 
__u32
 
	mvf
;

789 
__u32
 
	m£âög
;

808 
	mIFLA_VF_PORT_UNSPEC
,

809 
	mIFLA_VF_PORT
,

810 
	m__IFLA_VF_PORT_MAX
,

813 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

816 
	mIFLA_PORT_UNSPEC
,

817 
	mIFLA_PORT_VF
,

818 
	mIFLA_PORT_PROFILE
,

819 
	mIFLA_PORT_VSI_TYPE
,

820 
	mIFLA_PORT_INSTANCE_UUID
,

821 
	mIFLA_PORT_HOST_UUID
,

822 
	mIFLA_PORT_REQUEST
,

823 
	mIFLA_PORT_RESPONSE
,

824 
	m__IFLA_PORT_MAX
,

827 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

829 
	#PORT_PROFILE_MAX
 40

	)

830 
	#PORT_UUID_MAX
 16

	)

831 
	#PORT_SELF_VF
 -1

	)

834 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

835 
	mPORT_REQUEST_PREASSOCIATE_RR
,

836 
	mPORT_REQUEST_ASSOCIATE
,

837 
	mPORT_REQUEST_DISASSOCIATE
,

841 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

842 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

843 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

844 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

845 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

846 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

847 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

849 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

850 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

851 
	mPORT_PROFILE_RESPONSE_INVALID
,

852 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

853 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

854 
	mPORT_PROFILE_RESPONSE_ERROR
,

857 
	siÊa_p‹t_vsi
 {

858 
__u8
 
	mvsi_mgr_id
;

859 
__u8
 
	mvsi_ty≥_id
[3];

860 
__u8
 
	mvsi_ty≥_vîsi⁄
;

861 
__u8
 
	m∑d
[3];

868 
	mIFLA_IPOIB_UNSPEC
,

869 
	mIFLA_IPOIB_PKEY
,

870 
	mIFLA_IPOIB_MODE
,

871 
	mIFLA_IPOIB_UMCAST
,

872 
	m__IFLA_IPOIB_MAX


876 
	mIPOIB_MODE_DATAGRAM
 = 0,

877 
	mIPOIB_MODE_CONNECTED
 = 1,

880 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

886 
	mIFLA_HSR_UNSPEC
,

887 
	mIFLA_HSR_SLAVE1
,

888 
	mIFLA_HSR_SLAVE2
,

889 
	mIFLA_HSR_MULTICAST_SPEC
,

890 
	mIFLA_HSR_SUPERVISION_ADDR
,

891 
	mIFLA_HSR_SEQ_NR
,

892 
	mIFLA_HSR_VERSION
,

893 
	m__IFLA_HSR_MAX
,

896 
	#IFLA_HSR_MAX
 (
__IFLA_HSR_MAX
 - 1)

	)

900 
	sif_°©s_msg
 {

901 
__u8
 
	mÁmûy
;

902 
__u8
 
	m∑d1
;

903 
__u16
 
	m∑d2
;

904 
__u32
 
	mifödex
;

905 
__u32
 
	mfûãr_mask
;

912 
	mIFLA_STATS_UNSPEC
,

913 
	mIFLA_STATS_LINK_64
,

914 
	mIFLA_STATS_LINK_XSTATS
,

915 
	mIFLA_STATS_LINK_XSTATS_SLAVE
,

916 
	mIFLA_STATS_LINK_OFFLOAD_XSTATS
,

917 
	mIFLA_STATS_AF_SPEC
,

918 
	m__IFLA_STATS_MAX
,

921 
	#IFLA_STATS_MAX
 (
__IFLA_STATS_MAX
 - 1)

	)

923 
	#IFLA_STATS_FILTER_BIT
(
ATTR
Ë(1 << (ATTR - 1))

	)

931 
	mLINK_XSTATS_TYPE_UNSPEC
,

932 
	mLINK_XSTATS_TYPE_BRIDGE
,

933 
	mLINK_XSTATS_TYPE_BOND
,

934 
	m__LINK_XSTATS_TYPE_MAX


936 
	#LINK_XSTATS_TYPE_MAX
 (
__LINK_XSTATS_TYPE_MAX
 - 1)

	)

940 
	mIFLA_OFFLOAD_XSTATS_UNSPEC
,

941 
	mIFLA_OFFLOAD_XSTATS_CPU_HIT
,

942 
	m__IFLA_OFFLOAD_XSTATS_MAX


944 
	#IFLA_OFFLOAD_XSTATS_MAX
 (
__IFLA_OFFLOAD_XSTATS_MAX
 - 1)

	)

948 
	#XDP_FLAGS_UPDATE_IF_NOEXIST
 (1U << 0)

	)

949 
	#XDP_FLAGS_SKB_MODE
 (1U << 1)

	)

950 
	#XDP_FLAGS_DRV_MODE
 (1U << 2)

	)

951 
	#XDP_FLAGS_HW_MODE
 (1U << 3)

	)

952 
	#XDP_FLAGS_MODES
 (
XDP_FLAGS_SKB_MODE
 | \

953 
XDP_FLAGS_DRV_MODE
 | \

954 
XDP_FLAGS_HW_MODE
)

	)

955 
	#XDP_FLAGS_MASK
 (
XDP_FLAGS_UPDATE_IF_NOEXIST
 | \

956 
XDP_FLAGS_MODES
)

	)

960 
	mXDP_ATTACHED_NONE
 = 0,

961 
	mXDP_ATTACHED_DRV
,

962 
	mXDP_ATTACHED_SKB
,

963 
	mXDP_ATTACHED_HW
,

964 
	mXDP_ATTACHED_MULTI
,

968 
	mIFLA_XDP_UNSPEC
,

969 
	mIFLA_XDP_FD
,

970 
	mIFLA_XDP_ATTACHED
,

971 
	mIFLA_XDP_FLAGS
,

972 
	mIFLA_XDP_PROG_ID
,

973 
	mIFLA_XDP_DRV_PROG_ID
,

974 
	mIFLA_XDP_SKB_PROG_ID
,

975 
	mIFLA_XDP_HW_PROG_ID
,

976 
	m__IFLA_XDP_MAX
,

979 
	#IFLA_XDP_MAX
 (
__IFLA_XDP_MAX
 - 1)

	)

982 
	mIFLA_EVENT_NONE
,

983 
	mIFLA_EVENT_REBOOT
,

984 
	mIFLA_EVENT_FEATURES
,

985 
	mIFLA_EVENT_BONDING_FAILOVER
,

986 
	mIFLA_EVENT_NOTIFY_PEERS
,

987 
	mIFLA_EVENT_IGMP_RESEND
,

988 
	mIFLA_EVENT_BONDING_OPTIONS
,

994 
	mIFLA_TUN_UNSPEC
,

995 
	mIFLA_TUN_OWNER
,

996 
	mIFLA_TUN_GROUP
,

997 
	mIFLA_TUN_TYPE
,

998 
	mIFLA_TUN_PI
,

999 
	mIFLA_TUN_VNET_HDR
,

1000 
	mIFLA_TUN_PERSIST
,

1001 
	mIFLA_TUN_MULTI_QUEUE
,

1002 
	mIFLA_TUN_NUM_QUEUES
,

1003 
	mIFLA_TUN_NUM_DISABLED_QUEUES
,

1004 
	m__IFLA_TUN_MAX
,

1007 
	#IFLA_TUN_MAX
 (
__IFLA_TUN_MAX
 - 1)

	)

1011 
	#RMNET_FLAGS_INGRESS_DEAGGREGATION
 (1U << 0)

	)

1012 
	#RMNET_FLAGS_INGRESS_MAP_COMMANDS
 (1U << 1)

	)

1013 
	#RMNET_FLAGS_INGRESS_MAP_CKSUMV4
 (1U << 2)

	)

1014 
	#RMNET_FLAGS_EGRESS_MAP_CKSUMV4
 (1U << 3)

	)

1017 
	mIFLA_RMNET_UNSPEC
,

1018 
	mIFLA_RMNET_MUX_ID
,

1019 
	mIFLA_RMNET_FLAGS
,

1020 
	m__IFLA_RMNET_MAX
,

1023 
	#IFLA_RMNET_MAX
 (
__IFLA_RMNET_MAX
 - 1)

	)

1025 
	siÊa_rm√t_Êags
 {

1026 
__u32
 
	mÊags
;

1027 
__u32
 
	mmask
;

	@/usr/include/linux/if_packet.h

2 #i‚de‡
__LINUX_IF_PACKET_H


3 
	#__LINUX_IF_PACKET_H


	)

5 
	~<löux/ty≥s.h
>

7 
	ssockaddr_pkt
 {

8 
	m•kt_Ámûy
;

9 
	m•kt_devi˚
[14];

10 
__be16
 
	m•kt_¥Ÿocﬁ
;

13 
	ssockaddr_Œ
 {

14 
	m¶l_Ámûy
;

15 
__be16
 
	m¶l_¥Ÿocﬁ
;

16 
	m¶l_ifödex
;

17 
	m¶l_h©y≥
;

18 
	m¶l_pkây≥
;

19 
	m¶l_hÆí
;

20 
	m¶l_addr
[8];

25 
	#PACKET_HOST
 0

	)

26 
	#PACKET_BROADCAST
 1

	)

27 
	#PACKET_MULTICAST
 2

	)

28 
	#PACKET_OTHERHOST
 3

	)

29 
	#PACKET_OUTGOING
 4

	)

30 
	#PACKET_LOOPBACK
 5

	)

31 
	#PACKET_USER
 6

	)

32 
	#PACKET_KERNEL
 7

	)

34 
	#PACKET_FASTROUTE
 6

	)

38 
	#PACKET_ADD_MEMBERSHIP
 1

	)

39 
	#PACKET_DROP_MEMBERSHIP
 2

	)

40 
	#PACKET_RECV_OUTPUT
 3

	)

42 
	#PACKET_RX_RING
 5

	)

43 
	#PACKET_STATISTICS
 6

	)

44 
	#PACKET_COPY_THRESH
 7

	)

45 
	#PACKET_AUXDATA
 8

	)

46 
	#PACKET_ORIGDEV
 9

	)

47 
	#PACKET_VERSION
 10

	)

48 
	#PACKET_HDRLEN
 11

	)

49 
	#PACKET_RESERVE
 12

	)

50 
	#PACKET_TX_RING
 13

	)

51 
	#PACKET_LOSS
 14

	)

52 
	#PACKET_VNET_HDR
 15

	)

53 
	#PACKET_TX_TIMESTAMP
 16

	)

54 
	#PACKET_TIMESTAMP
 17

	)

55 
	#PACKET_FANOUT
 18

	)

56 
	#PACKET_TX_HAS_OFF
 19

	)

57 
	#PACKET_QDISC_BYPASS
 20

	)

58 
	#PACKET_ROLLOVER_STATS
 21

	)

59 
	#PACKET_FANOUT_DATA
 22

	)

60 
	#PACKET_IGNORE_OUTGOING
 23

	)

62 
	#PACKET_FANOUT_HASH
 0

	)

63 
	#PACKET_FANOUT_LB
 1

	)

64 
	#PACKET_FANOUT_CPU
 2

	)

65 
	#PACKET_FANOUT_ROLLOVER
 3

	)

66 
	#PACKET_FANOUT_RND
 4

	)

67 
	#PACKET_FANOUT_QM
 5

	)

68 
	#PACKET_FANOUT_CBPF
 6

	)

69 
	#PACKET_FANOUT_EBPF
 7

	)

70 
	#PACKET_FANOUT_FLAG_ROLLOVER
 0x1000

	)

71 
	#PACKET_FANOUT_FLAG_UNIQUEID
 0x2000

	)

72 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

74 
	sçackë_°©s
 {

75 
	mç_∑ckës
;

76 
	mç_dr›s
;

79 
	sçackë_°©s_v3
 {

80 
	mç_∑ckës
;

81 
	mç_dr›s
;

82 
	mç_‰ìze_q_˙t
;

85 
	sçackë_rﬁlovî_°©s
 {

86 
__Æig√d_u64
 
	mç_Æl
;

87 
__Æig√d_u64
 
	mç_huge
;

88 
__Æig√d_u64
 
	mç_Áûed
;

91 
	uçackë_°©s_u
 {

92 
çackë_°©s
 
	m°©s1
;

93 
çackë_°©s_v3
 
	m°©s3
;

96 
	sçackë_auxd©a
 {

97 
__u32
 
	mç_°©us
;

98 
__u32
 
	mç_Àn
;

99 
__u32
 
	mç_¢≠Àn
;

100 
__u16
 
	mç_mac
;

101 
__u16
 
	mç_√t
;

102 
__u16
 
	mç_vœn_tci
;

103 
__u16
 
	mç_vœn_çid
;

107 
	#TP_STATUS_KERNEL
 0

	)

108 
	#TP_STATUS_USER
 (1 << 0)

	)

109 
	#TP_STATUS_COPY
 (1 << 1)

	)

110 
	#TP_STATUS_LOSING
 (1 << 2)

	)

111 
	#TP_STATUS_CSUMNOTREADY
 (1 << 3)

	)

112 
	#TP_STATUS_VLAN_VALID
 (1 << 4Ë

	)

113 
	#TP_STATUS_BLK_TMO
 (1 << 5)

	)

114 
	#TP_STATUS_VLAN_TPID_VALID
 (1 << 6Ë

	)

115 
	#TP_STATUS_CSUM_VALID
 (1 << 7)

	)

118 
	#TP_STATUS_AVAILABLE
 0

	)

119 
	#TP_STATUS_SEND_REQUEST
 (1 << 0)

	)

120 
	#TP_STATUS_SENDING
 (1 << 1)

	)

121 
	#TP_STATUS_WRONG_FORMAT
 (1 << 2)

	)

124 
	#TP_STATUS_TS_SOFTWARE
 (1 << 29)

	)

125 
	#TP_STATUS_TS_SYS_HARDWARE
 (1 << 30Ë

	)

126 
	#TP_STATUS_TS_RAW_HARDWARE
 (1U << 31)

	)

129 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

131 
	sçackë_hdr
 {

132 
	mç_°©us
;

133 
	mç_Àn
;

134 
	mç_¢≠Àn
;

135 
	mç_mac
;

136 
	mç_√t
;

137 
	mç_£c
;

138 
	mç_u£c
;

141 
	#TPACKET_ALIGNMENT
 16

	)

142 
	#TPACKET_ALIGN
(
x
Ë(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

143 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë_hdr
)Ë+ (
sockaddr_Œ
))

	)

145 
	sçackë2_hdr
 {

146 
__u32
 
	mç_°©us
;

147 
__u32
 
	mç_Àn
;

148 
__u32
 
	mç_¢≠Àn
;

149 
__u16
 
	mç_mac
;

150 
__u16
 
	mç_√t
;

151 
__u32
 
	mç_£c
;

152 
__u32
 
	mç_n£c
;

153 
__u16
 
	mç_vœn_tci
;

154 
__u16
 
	mç_vœn_çid
;

155 
__u8
 
	mç_∑ddög
[4];

158 
	sçackë_hdr_v¨ü¡1
 {

159 
__u32
 
	mç_rxhash
;

160 
__u32
 
	mç_vœn_tci
;

161 
__u16
 
	mç_vœn_çid
;

162 
__u16
 
	mç_∑ddög
;

165 
	sçackë3_hdr
 {

166 
__u32
 
	mç_√xt_off£t
;

167 
__u32
 
	mç_£c
;

168 
__u32
 
	mç_n£c
;

169 
__u32
 
	mç_¢≠Àn
;

170 
__u32
 
	mç_Àn
;

171 
__u32
 
	mç_°©us
;

172 
__u16
 
	mç_mac
;

173 
__u16
 
	mç_√t
;

176 
çackë_hdr_v¨ü¡1
 
	mhv1
;

178 
__u8
 
	mç_∑ddög
[8];

181 
	sçackë_bd_ts
 {

182 
	mts_£c
;

184 
	mts_u£c
;

185 
	mts_n£c
;

189 
	sçackë_hdr_v1
 {

190 
__u32
 
	mblock_°©us
;

191 
__u32
 
	mnum_pkts
;

192 
__u32
 
	moff£t_to_fú°_pkt
;

197 
__u32
 
	mblk_Àn
;

208 
__Æig√d_u64
 
	m£q_num
;

235 
çackë_bd_ts
 
	mts_fú°_pkt
, 
	mts_œ°_pkt
;

238 
	uçackë_bd_hódî_u
 {

239 
çackë_hdr_v1
 
	mbh1
;

242 
	sçackë_block_desc
 {

243 
__u32
 
	mvîsi⁄
;

244 
__u32
 
	moff£t_to_¥iv
;

245 
çackë_bd_hódî_u
 
	mhdr
;

248 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë2_hdr
)Ë+ (
sockaddr_Œ
))

	)

249 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë3_hdr
)Ë+ (
sockaddr_Œ
))

	)

251 
	eçackë_vîsi⁄s
 {

252 
	mTPACKET_V1
,

253 
	mTPACKET_V2
,

254 
	mTPACKET_V3


270 
	sçackë_ªq
 {

271 
	mç_block_size
;

272 
	mç_block_ƒ
;

273 
	mç_‰ame_size
;

274 
	mç_‰ame_ƒ
;

277 
	sçackë_ªq3
 {

278 
	mç_block_size
;

279 
	mç_block_ƒ
;

280 
	mç_‰ame_size
;

281 
	mç_‰ame_ƒ
;

282 
	mç_ªtúe_blk_tov
;

283 
	mç_sizeof_¥iv
;

284 
	mç_„©uª_ªq_w‹d
;

287 
	uçackë_ªq_u
 {

288 
çackë_ªq
 
	mªq
;

289 
çackë_ªq3
 
	mªq3
;

292 
	s∑ckë_mªq
 {

293 
	mmr_ifödex
;

294 
	mmr_ty≥
;

295 
	mmr_Æí
;

296 
	mmr_addªss
[8];

299 
	#PACKET_MR_MULTICAST
 0

	)

300 
	#PACKET_MR_PROMISC
 1

	)

301 
	#PACKET_MR_ALLMULTI
 2

	)

302 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/ioctl.h

2 #i‚de‡
_LINUX_IOCTL_H


3 
	#_LINUX_IOCTL_H


	)

5 
	~<asm/io˘l.h
>

	@/usr/include/linux/limits.h

2 #i‚de‡
_LINUX_LIMITS_H


3 
	#_LINUX_LIMITS_H


	)

5 
	#NR_OPEN
 1024

	)

7 
	#NGROUPS_MAX
 65536

	)

8 
	#ARG_MAX
 131072

	)

9 
	#LINK_MAX
 127

	)

10 
	#MAX_CANON
 255

	)

11 
	#MAX_INPUT
 255

	)

12 
	#NAME_MAX
 255

	)

13 
	#PATH_MAX
 4096

	)

14 
	#PIPE_BUF
 4096

	)

15 
	#XATTR_NAME_MAX
 255

	)

16 
	#XATTR_SIZE_MAX
 65536

	)

17 
	#XATTR_LIST_MAX
 65536

	)

19 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/mount.h

1 #i‚de‡
_LINUX_MOUNT_H


2 
	#_LINUX_MOUNT_H


	)

11 
	#MS_RDONLY
 1

	)

12 
	#MS_NOSUID
 2

	)

13 
	#MS_NODEV
 4

	)

14 
	#MS_NOEXEC
 8

	)

15 
	#MS_SYNCHRONOUS
 16

	)

16 
	#MS_REMOUNT
 32

	)

17 
	#MS_MANDLOCK
 64

	)

18 
	#MS_DIRSYNC
 128

	)

19 
	#MS_NOATIME
 1024

	)

20 
	#MS_NODIRATIME
 2048

	)

21 
	#MS_BIND
 4096

	)

22 
	#MS_MOVE
 8192

	)

23 
	#MS_REC
 16384

	)

24 
	#MS_VERBOSE
 32768

	)

26 
	#MS_SILENT
 32768

	)

27 
	#MS_POSIXACL
 (1<<16Ë

	)

28 
	#MS_UNBINDABLE
 (1<<17Ë

	)

29 
	#MS_PRIVATE
 (1<<18Ë

	)

30 
	#MS_SLAVE
 (1<<19Ë

	)

31 
	#MS_SHARED
 (1<<20Ë

	)

32 
	#MS_RELATIME
 (1<<21Ë

	)

33 
	#MS_KERNMOUNT
 (1<<22Ë

	)

34 
	#MS_I_VERSION
 (1<<23Ë

	)

35 
	#MS_STRICTATIME
 (1<<24Ë

	)

36 
	#MS_LAZYTIME
 (1<<25Ë

	)

39 
	#MS_SUBMOUNT
 (1<<26)

	)

40 
	#MS_NOREMOTELOCK
 (1<<27)

	)

41 
	#MS_NOSEC
 (1<<28)

	)

42 
	#MS_BORN
 (1<<29)

	)

43 
	#MS_ACTIVE
 (1<<30)

	)

44 
	#MS_NOUSER
 (1<<31)

	)

49 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
|\

50 
MS_LAZYTIME
)

	)

55 
	#MS_MGC_VAL
 0xC0ED0000

	)

56 
	#MS_MGC_MSK
 0xffff0000

	)

61 
	#OPEN_TREE_CLONE
 1

	)

62 
	#OPEN_TREE_CLOEXEC
 
O_CLOEXEC


	)

67 
	#MOVE_MOUNT_F_SYMLINKS
 0x00000001

	)

68 
	#MOVE_MOUNT_F_AUTOMOUNTS
 0x00000002

	)

69 
	#MOVE_MOUNT_F_EMPTY_PATH
 0x00000004

	)

70 
	#MOVE_MOUNT_T_SYMLINKS
 0x00000010

	)

71 
	#MOVE_MOUNT_T_AUTOMOUNTS
 0x00000020

	)

72 
	#MOVE_MOUNT_T_EMPTY_PATH
 0x00000040

	)

73 
	#MOVE_MOUNT__MASK
 0x00000077

	)

78 
	#FSOPEN_CLOEXEC
 0x00000001

	)

83 
	#FSPICK_CLOEXEC
 0x00000001

	)

84 
	#FSPICK_SYMLINK_NOFOLLOW
 0x00000002

	)

85 
	#FSPICK_NO_AUTOMOUNT
 0x00000004

	)

86 
	#FSPICK_EMPTY_PATH
 0x00000008

	)

91 
	efsc⁄fig_comm™d
 {

92 
	mFSCONFIG_SET_FLAG
 = 0,

93 
	mFSCONFIG_SET_STRING
 = 1,

94 
	mFSCONFIG_SET_BINARY
 = 2,

95 
	mFSCONFIG_SET_PATH
 = 3,

96 
	mFSCONFIG_SET_PATH_EMPTY
 = 4,

97 
	mFSCONFIG_SET_FD
 = 5,

98 
	mFSCONFIG_CMD_CREATE
 = 6,

99 
	mFSCONFIG_CMD_RECONFIGURE
 = 7,

105 
	#FSMOUNT_CLOEXEC
 0x00000001

	)

110 
	#MOUNT_ATTR_RDONLY
 0x00000001

	)

111 
	#MOUNT_ATTR_NOSUID
 0x00000002

	)

112 
	#MOUNT_ATTR_NODEV
 0x00000004

	)

113 
	#MOUNT_ATTR_NOEXEC
 0x00000008

	)

114 
	#MOUNT_ATTR__ATIME
 0x00000070

	)

115 
	#MOUNT_ATTR_RELATIME
 0x00000000

	)

116 
	#MOUNT_ATTR_NOATIME
 0x00000010

	)

117 
	#MOUNT_ATTR_STRICTATIME
 0x00000020

	)

118 
	#MOUNT_ATTR_NODIRATIME
 0x00000080

	)

	@/usr/include/linux/pci_regs.h

21 #i‚de‡
LINUX_PCI_REGS_H


22 
	#LINUX_PCI_REGS_H


	)

29 
	#PCI_CFG_SPACE_SIZE
 256

	)

30 
	#PCI_CFG_SPACE_EXP_SIZE
 4096

	)

36 
	#PCI_STD_HEADER_SIZEOF
 64

	)

37 
	#PCI_VENDOR_ID
 0x00

	)

38 
	#PCI_DEVICE_ID
 0x02

	)

39 
	#PCI_COMMAND
 0x04

	)

40 
	#PCI_COMMAND_IO
 0x1

	)

41 
	#PCI_COMMAND_MEMORY
 0x2

	)

42 
	#PCI_COMMAND_MASTER
 0x4

	)

43 
	#PCI_COMMAND_SPECIAL
 0x8

	)

44 
	#PCI_COMMAND_INVALIDATE
 0x10

	)

45 
	#PCI_COMMAND_VGA_PALETTE
 0x20

	)

46 
	#PCI_COMMAND_PARITY
 0x40

	)

47 
	#PCI_COMMAND_WAIT
 0x80

	)

48 
	#PCI_COMMAND_SERR
 0x100

	)

49 
	#PCI_COMMAND_FAST_BACK
 0x200

	)

50 
	#PCI_COMMAND_INTX_DISABLE
 0x400

	)

52 
	#PCI_STATUS
 0x06

	)

53 
	#PCI_STATUS_IMM_READY
 0x01

	)

54 
	#PCI_STATUS_INTERRUPT
 0x08

	)

55 
	#PCI_STATUS_CAP_LIST
 0x10

	)

56 
	#PCI_STATUS_66MHZ
 0x20

	)

57 
	#PCI_STATUS_UDF
 0x40

	)

58 
	#PCI_STATUS_FAST_BACK
 0x80

	)

59 
	#PCI_STATUS_PARITY
 0x100

	)

60 
	#PCI_STATUS_DEVSEL_MASK
 0x600

	)

61 
	#PCI_STATUS_DEVSEL_FAST
 0x000

	)

62 
	#PCI_STATUS_DEVSEL_MEDIUM
 0x200

	)

63 
	#PCI_STATUS_DEVSEL_SLOW
 0x400

	)

64 
	#PCI_STATUS_SIG_TARGET_ABORT
 0x800

	)

65 
	#PCI_STATUS_REC_TARGET_ABORT
 0x1000

	)

66 
	#PCI_STATUS_REC_MASTER_ABORT
 0x2000

	)

67 
	#PCI_STATUS_SIG_SYSTEM_ERROR
 0x4000

	)

68 
	#PCI_STATUS_DETECTED_PARITY
 0x8000

	)

70 
	#PCI_CLASS_REVISION
 0x08

	)

71 
	#PCI_REVISION_ID
 0x08

	)

72 
	#PCI_CLASS_PROG
 0x09

	)

73 
	#PCI_CLASS_DEVICE
 0x0®

	)

75 
	#PCI_CACHE_LINE_SIZE
 0x0¯

	)

76 
	#PCI_LATENCY_TIMER
 0x0d

	)

77 
	#PCI_HEADER_TYPE
 0x0ê

	)

78 
	#PCI_HEADER_TYPE_NORMAL
 0

	)

79 
	#PCI_HEADER_TYPE_BRIDGE
 1

	)

80 
	#PCI_HEADER_TYPE_CARDBUS
 2

	)

82 
	#PCI_BIST
 0x0‡

	)

83 
	#PCI_BIST_CODE_MASK
 0x0‡

	)

84 
	#PCI_BIST_START
 0x40

	)

85 
	#PCI_BIST_CAPABLE
 0x80

	)

93 
	#PCI_BASE_ADDRESS_0
 0x10

	)

94 
	#PCI_BASE_ADDRESS_1
 0x14

	)

95 
	#PCI_BASE_ADDRESS_2
 0x18

	)

96 
	#PCI_BASE_ADDRESS_3
 0x1¯

	)

97 
	#PCI_BASE_ADDRESS_4
 0x20

	)

98 
	#PCI_BASE_ADDRESS_5
 0x24

	)

99 
	#PCI_BASE_ADDRESS_SPACE
 0x01

	)

100 
	#PCI_BASE_ADDRESS_SPACE_IO
 0x01

	)

101 
	#PCI_BASE_ADDRESS_SPACE_MEMORY
 0x00

	)

102 
	#PCI_BASE_ADDRESS_MEM_TYPE_MASK
 0x06

	)

103 
	#PCI_BASE_ADDRESS_MEM_TYPE_32
 0x00

	)

104 
	#PCI_BASE_ADDRESS_MEM_TYPE_1M
 0x02

	)

105 
	#PCI_BASE_ADDRESS_MEM_TYPE_64
 0x04

	)

106 
	#PCI_BASE_ADDRESS_MEM_PREFETCH
 0x08

	)

107 
	#PCI_BASE_ADDRESS_MEM_MASK
 (~0x0fUL)

	)

108 
	#PCI_BASE_ADDRESS_IO_MASK
 (~0x03UL)

	)

112 
	#PCI_CARDBUS_CIS
 0x28

	)

113 
	#PCI_SUBSYSTEM_VENDOR_ID
 0x2c

	)

114 
	#PCI_SUBSYSTEM_ID
 0x2e

	)

115 
	#PCI_ROM_ADDRESS
 0x30

	)

116 
	#PCI_ROM_ADDRESS_ENABLE
 0x01

	)

117 
	#PCI_ROM_ADDRESS_MASK
 (~0x7ffU)

	)

119 
	#PCI_CAPABILITY_LIST
 0x34

	)

122 
	#PCI_INTERRUPT_LINE
 0x3¯

	)

123 
	#PCI_INTERRUPT_PIN
 0x3d

	)

124 
	#PCI_MIN_GNT
 0x3ê

	)

125 
	#PCI_MAX_LAT
 0x3‡

	)

128 
	#PCI_PRIMARY_BUS
 0x18

	)

129 
	#PCI_SECONDARY_BUS
 0x19

	)

130 
	#PCI_SUBORDINATE_BUS
 0x1®

	)

131 
	#PCI_SEC_LATENCY_TIMER
 0x1b

	)

132 
	#PCI_IO_BASE
 0x1¯

	)

133 
	#PCI_IO_LIMIT
 0x1d

	)

134 
	#PCI_IO_RANGE_TYPE_MASK
 0x0fUL

	)

135 
	#PCI_IO_RANGE_TYPE_16
 0x00

	)

136 
	#PCI_IO_RANGE_TYPE_32
 0x01

	)

137 
	#PCI_IO_RANGE_MASK
 (~0x0fULË

	)

138 
	#PCI_IO_1K_RANGE_MASK
 (~0x03ULË

	)

139 
	#PCI_SEC_STATUS
 0x1ê

	)

140 
	#PCI_MEMORY_BASE
 0x20

	)

141 
	#PCI_MEMORY_LIMIT
 0x22

	)

142 
	#PCI_MEMORY_RANGE_TYPE_MASK
 0x0fUL

	)

143 
	#PCI_MEMORY_RANGE_MASK
 (~0x0fUL)

	)

144 
	#PCI_PREF_MEMORY_BASE
 0x24

	)

145 
	#PCI_PREF_MEMORY_LIMIT
 0x26

	)

146 
	#PCI_PREF_RANGE_TYPE_MASK
 0x0fUL

	)

147 
	#PCI_PREF_RANGE_TYPE_32
 0x00

	)

148 
	#PCI_PREF_RANGE_TYPE_64
 0x01

	)

149 
	#PCI_PREF_RANGE_MASK
 (~0x0fUL)

	)

150 
	#PCI_PREF_BASE_UPPER32
 0x28

	)

151 
	#PCI_PREF_LIMIT_UPPER32
 0x2c

	)

152 
	#PCI_IO_BASE_UPPER16
 0x30

	)

153 
	#PCI_IO_LIMIT_UPPER16
 0x32

	)

156 
	#PCI_ROM_ADDRESS1
 0x38

	)

158 
	#PCI_BRIDGE_CONTROL
 0x3e

	)

159 
	#PCI_BRIDGE_CTL_PARITY
 0x01

	)

160 
	#PCI_BRIDGE_CTL_SERR
 0x02

	)

161 
	#PCI_BRIDGE_CTL_ISA
 0x04

	)

162 
	#PCI_BRIDGE_CTL_VGA
 0x08

	)

163 
	#PCI_BRIDGE_CTL_MASTER_ABORT
 0x20

	)

164 
	#PCI_BRIDGE_CTL_BUS_RESET
 0x40

	)

165 
	#PCI_BRIDGE_CTL_FAST_BACK
 0x80

	)

168 
	#PCI_CB_CAPABILITY_LIST
 0x14

	)

170 
	#PCI_CB_SEC_STATUS
 0x16

	)

171 
	#PCI_CB_PRIMARY_BUS
 0x18

	)

172 
	#PCI_CB_CARD_BUS
 0x19

	)

173 
	#PCI_CB_SUBORDINATE_BUS
 0x1®

	)

174 
	#PCI_CB_LATENCY_TIMER
 0x1b

	)

175 
	#PCI_CB_MEMORY_BASE_0
 0x1c

	)

176 
	#PCI_CB_MEMORY_LIMIT_0
 0x20

	)

177 
	#PCI_CB_MEMORY_BASE_1
 0x24

	)

178 
	#PCI_CB_MEMORY_LIMIT_1
 0x28

	)

179 
	#PCI_CB_IO_BASE_0
 0x2c

	)

180 
	#PCI_CB_IO_BASE_0_HI
 0x2e

	)

181 
	#PCI_CB_IO_LIMIT_0
 0x30

	)

182 
	#PCI_CB_IO_LIMIT_0_HI
 0x32

	)

183 
	#PCI_CB_IO_BASE_1
 0x34

	)

184 
	#PCI_CB_IO_BASE_1_HI
 0x36

	)

185 
	#PCI_CB_IO_LIMIT_1
 0x38

	)

186 
	#PCI_CB_IO_LIMIT_1_HI
 0x3a

	)

187 
	#PCI_CB_IO_RANGE_MASK
 (~0x03UL)

	)

189 
	#PCI_CB_BRIDGE_CONTROL
 0x3e

	)

190 
	#PCI_CB_BRIDGE_CTL_PARITY
 0x01

	)

191 
	#PCI_CB_BRIDGE_CTL_SERR
 0x02

	)

192 
	#PCI_CB_BRIDGE_CTL_ISA
 0x04

	)

193 
	#PCI_CB_BRIDGE_CTL_VGA
 0x08

	)

194 
	#PCI_CB_BRIDGE_CTL_MASTER_ABORT
 0x20

	)

195 
	#PCI_CB_BRIDGE_CTL_CB_RESET
 0x40

	)

196 
	#PCI_CB_BRIDGE_CTL_16BIT_INT
 0x80

	)

197 
	#PCI_CB_BRIDGE_CTL_PREFETCH_MEM0
 0x100

	)

198 
	#PCI_CB_BRIDGE_CTL_PREFETCH_MEM1
 0x200

	)

199 
	#PCI_CB_BRIDGE_CTL_POST_WRITES
 0x400

	)

200 
	#PCI_CB_SUBSYSTEM_VENDOR_ID
 0x40

	)

201 
	#PCI_CB_SUBSYSTEM_ID
 0x42

	)

202 
	#PCI_CB_LEGACY_MODE_BASE
 0x44

	)

207 
	#PCI_CAP_LIST_ID
 0

	)

208 
	#PCI_CAP_ID_PM
 0x01

	)

209 
	#PCI_CAP_ID_AGP
 0x02

	)

210 
	#PCI_CAP_ID_VPD
 0x03

	)

211 
	#PCI_CAP_ID_SLOTID
 0x04

	)

212 
	#PCI_CAP_ID_MSI
 0x05

	)

213 
	#PCI_CAP_ID_CHSWP
 0x06

	)

214 
	#PCI_CAP_ID_PCIX
 0x07

	)

215 
	#PCI_CAP_ID_HT
 0x08

	)

216 
	#PCI_CAP_ID_VNDR
 0x09

	)

217 
	#PCI_CAP_ID_DBG
 0x0A

	)

218 
	#PCI_CAP_ID_CCRC
 0x0B

	)

219 
	#PCI_CAP_ID_SHPC
 0x0C

	)

220 
	#PCI_CAP_ID_SSVID
 0x0D

	)

221 
	#PCI_CAP_ID_AGP3
 0x0E

	)

222 
	#PCI_CAP_ID_SECDEV
 0x0F

	)

223 
	#PCI_CAP_ID_EXP
 0x10

	)

224 
	#PCI_CAP_ID_MSIX
 0x11

	)

225 
	#PCI_CAP_ID_SATA
 0x12

	)

226 
	#PCI_CAP_ID_AF
 0x13

	)

227 
	#PCI_CAP_ID_EA
 0x14

	)

228 
	#PCI_CAP_ID_MAX
 
PCI_CAP_ID_EA


	)

229 
	#PCI_CAP_LIST_NEXT
 1

	)

230 
	#PCI_CAP_FLAGS
 2

	)

231 
	#PCI_CAP_SIZEOF
 4

	)

235 
	#PCI_PM_PMC
 2

	)

236 
	#PCI_PM_CAP_VER_MASK
 0x0007

	)

237 
	#PCI_PM_CAP_PME_CLOCK
 0x0008

	)

238 
	#PCI_PM_CAP_RESERVED
 0x0010

	)

239 
	#PCI_PM_CAP_DSI
 0x0020

	)

240 
	#PCI_PM_CAP_AUX_POWER
 0x01C0

	)

241 
	#PCI_PM_CAP_D1
 0x0200

	)

242 
	#PCI_PM_CAP_D2
 0x0400

	)

243 
	#PCI_PM_CAP_PME
 0x0800

	)

244 
	#PCI_PM_CAP_PME_MASK
 0xF800

	)

245 
	#PCI_PM_CAP_PME_D0
 0x0800

	)

246 
	#PCI_PM_CAP_PME_D1
 0x1000

	)

247 
	#PCI_PM_CAP_PME_D2
 0x2000

	)

248 
	#PCI_PM_CAP_PME_D3
 0x4000

	)

249 
	#PCI_PM_CAP_PME_D3cﬁd
 0x8000

	)

250 
	#PCI_PM_CAP_PME_SHIFT
 11

	)

251 
	#PCI_PM_CTRL
 4

	)

252 
	#PCI_PM_CTRL_STATE_MASK
 0x0003

	)

253 
	#PCI_PM_CTRL_NO_SOFT_RESET
 0x0008

	)

254 
	#PCI_PM_CTRL_PME_ENABLE
 0x0100

	)

255 
	#PCI_PM_CTRL_DATA_SEL_MASK
 0x1e00

	)

256 
	#PCI_PM_CTRL_DATA_SCALE_MASK
 0x6000

	)

257 
	#PCI_PM_CTRL_PME_STATUS
 0x8000

	)

258 
	#PCI_PM_PPB_EXTENSIONS
 6

	)

259 
	#PCI_PM_PPB_B2_B3
 0x40

	)

260 
	#PCI_PM_BPCC_ENABLE
 0x80

	)

261 
	#PCI_PM_DATA_REGISTER
 7

	)

262 
	#PCI_PM_SIZEOF
 8

	)

266 
	#PCI_AGP_VERSION
 2

	)

267 
	#PCI_AGP_RFU
 3

	)

268 
	#PCI_AGP_STATUS
 4

	)

269 
	#PCI_AGP_STATUS_RQ_MASK
 0xff000000

	)

270 
	#PCI_AGP_STATUS_SBA
 0x0200

	)

271 
	#PCI_AGP_STATUS_64BIT
 0x0020

	)

272 
	#PCI_AGP_STATUS_FW
 0x0010

	)

273 
	#PCI_AGP_STATUS_RATE4
 0x0004

	)

274 
	#PCI_AGP_STATUS_RATE2
 0x0002

	)

275 
	#PCI_AGP_STATUS_RATE1
 0x0001

	)

276 
	#PCI_AGP_COMMAND
 8

	)

277 
	#PCI_AGP_COMMAND_RQ_MASK
 0xff000000

	)

278 
	#PCI_AGP_COMMAND_SBA
 0x0200

	)

279 
	#PCI_AGP_COMMAND_AGP
 0x0100

	)

280 
	#PCI_AGP_COMMAND_64BIT
 0x0020

	)

281 
	#PCI_AGP_COMMAND_FW
 0x0010

	)

282 
	#PCI_AGP_COMMAND_RATE4
 0x0004

	)

283 
	#PCI_AGP_COMMAND_RATE2
 0x0002

	)

284 
	#PCI_AGP_COMMAND_RATE1
 0x0001

	)

285 
	#PCI_AGP_SIZEOF
 12

	)

289 
	#PCI_VPD_ADDR
 2

	)

290 
	#PCI_VPD_ADDR_MASK
 0x7ff‡

	)

291 
	#PCI_VPD_ADDR_F
 0x8000

	)

292 
	#PCI_VPD_DATA
 4

	)

293 
	#PCI_CAP_VPD_SIZEOF
 8

	)

297 
	#PCI_SID_ESR
 2

	)

298 
	#PCI_SID_ESR_NSLOTS
 0x1‡

	)

299 
	#PCI_SID_ESR_FIC
 0x20

	)

300 
	#PCI_SID_CHASSIS_NR
 3

	)

304 
	#PCI_MSI_FLAGS
 2

	)

305 
	#PCI_MSI_FLAGS_ENABLE
 0x0001

	)

306 
	#PCI_MSI_FLAGS_QMASK
 0x000ê

	)

307 
	#PCI_MSI_FLAGS_QSIZE
 0x0070

	)

308 
	#PCI_MSI_FLAGS_64BIT
 0x0080

	)

309 
	#PCI_MSI_FLAGS_MASKBIT
 0x0100

	)

310 
	#PCI_MSI_RFU
 3

	)

311 
	#PCI_MSI_ADDRESS_LO
 4

	)

312 
	#PCI_MSI_ADDRESS_HI
 8

	)

313 
	#PCI_MSI_DATA_32
 8

	)

314 
	#PCI_MSI_MASK_32
 12

	)

315 
	#PCI_MSI_PENDING_32
 16

	)

316 
	#PCI_MSI_DATA_64
 12

	)

317 
	#PCI_MSI_MASK_64
 16

	)

318 
	#PCI_MSI_PENDING_64
 20

	)

321 
	#PCI_MSIX_FLAGS
 2

	)

322 
	#PCI_MSIX_FLAGS_QSIZE
 0x07FF

	)

323 
	#PCI_MSIX_FLAGS_MASKALL
 0x4000

	)

324 
	#PCI_MSIX_FLAGS_ENABLE
 0x8000

	)

325 
	#PCI_MSIX_TABLE
 4

	)

326 
	#PCI_MSIX_TABLE_BIR
 0x00000007

	)

327 
	#PCI_MSIX_TABLE_OFFSET
 0xfffffff8

	)

328 
	#PCI_MSIX_PBA
 8

	)

329 
	#PCI_MSIX_PBA_BIR
 0x00000007

	)

330 
	#PCI_MSIX_PBA_OFFSET
 0xfffffff8

	)

331 
	#PCI_MSIX_FLAGS_BIRMASK
 
PCI_MSIX_PBA_BIR


	)

332 
	#PCI_CAP_MSIX_SIZEOF
 12

	)

335 
	#PCI_MSIX_ENTRY_SIZE
 16

	)

336 
	#PCI_MSIX_ENTRY_LOWER_ADDR
 0

	)

337 
	#PCI_MSIX_ENTRY_UPPER_ADDR
 4

	)

338 
	#PCI_MSIX_ENTRY_DATA
 8

	)

339 
	#PCI_MSIX_ENTRY_VECTOR_CTRL
 12

	)

340 
	#PCI_MSIX_ENTRY_CTRL_MASKBIT
 0x00000001

	)

344 
	#PCI_CHSWP_CSR
 2

	)

345 
	#PCI_CHSWP_DHA
 0x01

	)

346 
	#PCI_CHSWP_EIM
 0x02

	)

347 
	#PCI_CHSWP_PIE
 0x04

	)

348 
	#PCI_CHSWP_LOO
 0x08

	)

349 
	#PCI_CHSWP_PI
 0x30

	)

350 
	#PCI_CHSWP_EXT
 0x40

	)

351 
	#PCI_CHSWP_INS
 0x80

	)

355 
	#PCI_AF_LENGTH
 2

	)

356 
	#PCI_AF_CAP
 3

	)

357 
	#PCI_AF_CAP_TP
 0x01

	)

358 
	#PCI_AF_CAP_FLR
 0x02

	)

359 
	#PCI_AF_CTRL
 4

	)

360 
	#PCI_AF_CTRL_FLR
 0x01

	)

361 
	#PCI_AF_STATUS
 5

	)

362 
	#PCI_AF_STATUS_TP
 0x01

	)

363 
	#PCI_CAP_AF_SIZEOF
 6

	)

367 
	#PCI_EA_NUM_ENT
 2

	)

368 
	#PCI_EA_NUM_ENT_MASK
 0x3‡

	)

369 
	#PCI_EA_FIRST_ENT
 4

	)

370 
	#PCI_EA_FIRST_ENT_BRIDGE
 8

	)

371 
	#PCI_EA_ES
 0x00000007

	)

372 
	#PCI_EA_BEI
 0x000000f0

	)

375 
	#PCI_EA_SEC_BUS_MASK
 0xff

	)

376 
	#PCI_EA_SUB_BUS_MASK
 0xff00

	)

377 
	#PCI_EA_SUB_BUS_SHIFT
 8

	)

380 
	#PCI_EA_BEI_BAR0
 0

	)

381 
	#PCI_EA_BEI_BAR5
 5

	)

382 
	#PCI_EA_BEI_BRIDGE
 6

	)

383 
	#PCI_EA_BEI_ENI
 7

	)

384 
	#PCI_EA_BEI_ROM
 8

	)

386 
	#PCI_EA_BEI_VF_BAR0
 9

	)

387 
	#PCI_EA_BEI_VF_BAR5
 14

	)

388 
	#PCI_EA_BEI_RESERVED
 15

	)

389 
	#PCI_EA_PP
 0x0000ff00

	)

390 
	#PCI_EA_SP
 0x00ff0000

	)

391 
	#PCI_EA_P_MEM
 0x00

	)

392 
	#PCI_EA_P_MEM_PREFETCH
 0x01

	)

393 
	#PCI_EA_P_IO
 0x02

	)

394 
	#PCI_EA_P_VF_MEM_PREFETCH
 0x03

	)

395 
	#PCI_EA_P_VF_MEM
 0x04

	)

396 
	#PCI_EA_P_BRIDGE_MEM
 0x05

	)

397 
	#PCI_EA_P_BRIDGE_MEM_PREFETCH
 0x06

	)

398 
	#PCI_EA_P_BRIDGE_IO
 0x07

	)

400 
	#PCI_EA_P_MEM_RESERVED
 0xfd

	)

401 
	#PCI_EA_P_IO_RESERVED
 0x„

	)

402 
	#PCI_EA_P_UNAVAILABLE
 0xf‡

	)

403 
	#PCI_EA_WRITABLE
 0x40000000

	)

404 
	#PCI_EA_ENABLE
 0x80000000

	)

405 
	#PCI_EA_BASE
 4

	)

406 
	#PCI_EA_MAX_OFFSET
 8

	)

408 
	#PCI_EA_IS_64
 0x00000002

	)

409 
	#PCI_EA_FIELD_MASK
 0xfffffff¯

	)

413 
	#PCI_X_CMD
 2

	)

414 
	#PCI_X_CMD_DPERR_E
 0x0001

	)

415 
	#PCI_X_CMD_ERO
 0x0002

	)

416 
	#PCI_X_CMD_READ_512
 0x0000

	)

417 
	#PCI_X_CMD_READ_1K
 0x0004

	)

418 
	#PCI_X_CMD_READ_2K
 0x0008

	)

419 
	#PCI_X_CMD_READ_4K
 0x000¯

	)

420 
	#PCI_X_CMD_MAX_READ
 0x000¯

	)

422 
	#PCI_X_CMD_SPLIT_1
 0x0000

	)

423 
	#PCI_X_CMD_SPLIT_2
 0x0010

	)

424 
	#PCI_X_CMD_SPLIT_3
 0x0020

	)

425 
	#PCI_X_CMD_SPLIT_4
 0x0030

	)

426 
	#PCI_X_CMD_SPLIT_8
 0x0040

	)

427 
	#PCI_X_CMD_SPLIT_12
 0x0050

	)

428 
	#PCI_X_CMD_SPLIT_16
 0x0060

	)

429 
	#PCI_X_CMD_SPLIT_32
 0x0070

	)

430 
	#PCI_X_CMD_MAX_SPLIT
 0x0070

	)

431 
	#PCI_X_CMD_VERSION
(
x
Ë(((xË>> 12Ë& 3Ë

	)

432 
	#PCI_X_STATUS
 4

	)

433 
	#PCI_X_STATUS_DEVFN
 0x000000f‡

	)

434 
	#PCI_X_STATUS_BUS
 0x0000ff00

	)

435 
	#PCI_X_STATUS_64BIT
 0x00010000

	)

436 
	#PCI_X_STATUS_133MHZ
 0x00020000

	)

437 
	#PCI_X_STATUS_SPL_DISC
 0x00040000

	)

438 
	#PCI_X_STATUS_UNX_SPL
 0x00080000

	)

439 
	#PCI_X_STATUS_COMPLEX
 0x00100000

	)

440 
	#PCI_X_STATUS_MAX_READ
 0x00600000

	)

441 
	#PCI_X_STATUS_MAX_SPLIT
 0x03800000

	)

442 
	#PCI_X_STATUS_MAX_CUM
 0x1c000000

	)

443 
	#PCI_X_STATUS_SPL_ERR
 0x20000000

	)

444 
	#PCI_X_STATUS_266MHZ
 0x40000000

	)

445 
	#PCI_X_STATUS_533MHZ
 0x80000000

	)

446 
	#PCI_X_ECC_CSR
 8

	)

447 
	#PCI_CAP_PCIX_SIZEOF_V0
 8

	)

448 
	#PCI_CAP_PCIX_SIZEOF_V1
 24

	)

449 
	#PCI_CAP_PCIX_SIZEOF_V2
 
PCI_CAP_PCIX_SIZEOF_V1


	)

453 
	#PCI_X_BRIDGE_SSTATUS
 2

	)

454 
	#PCI_X_SSTATUS_64BIT
 0x0001

	)

455 
	#PCI_X_SSTATUS_133MHZ
 0x0002

	)

456 
	#PCI_X_SSTATUS_FREQ
 0x03c0

	)

457 
	#PCI_X_SSTATUS_VERS
 0x3000

	)

458 
	#PCI_X_SSTATUS_V1
 0x1000

	)

459 
	#PCI_X_SSTATUS_V2
 0x2000

	)

460 
	#PCI_X_SSTATUS_266MHZ
 0x4000

	)

461 
	#PCI_X_SSTATUS_533MHZ
 0x8000

	)

462 
	#PCI_X_BRIDGE_STATUS
 4

	)

466 
	#PCI_SSVID_VENDOR_ID
 4

	)

467 
	#PCI_SSVID_DEVICE_ID
 6

	)

471 
	#PCI_EXP_FLAGS
 2

	)

472 
	#PCI_EXP_FLAGS_VERS
 0x000‡

	)

473 
	#PCI_EXP_FLAGS_TYPE
 0x00f0

	)

474 
	#PCI_EXP_TYPE_ENDPOINT
 0x0

	)

475 
	#PCI_EXP_TYPE_LEG_END
 0x1

	)

476 
	#PCI_EXP_TYPE_ROOT_PORT
 0x4

	)

477 
	#PCI_EXP_TYPE_UPSTREAM
 0x5

	)

478 
	#PCI_EXP_TYPE_DOWNSTREAM
 0x6

	)

479 
	#PCI_EXP_TYPE_PCI_BRIDGE
 0x7

	)

480 
	#PCI_EXP_TYPE_PCIE_BRIDGE
 0x8

	)

481 
	#PCI_EXP_TYPE_RC_END
 0x9

	)

482 
	#PCI_EXP_TYPE_RC_EC
 0x®

	)

483 
	#PCI_EXP_FLAGS_SLOT
 0x0100

	)

484 
	#PCI_EXP_FLAGS_IRQ
 0x3e00

	)

485 
	#PCI_EXP_DEVCAP
 4

	)

486 
	#PCI_EXP_DEVCAP_PAYLOAD
 0x00000007

	)

487 
	#PCI_EXP_DEVCAP_PHANTOM
 0x00000018

	)

488 
	#PCI_EXP_DEVCAP_EXT_TAG
 0x00000020

	)

489 
	#PCI_EXP_DEVCAP_L0S
 0x000001c0

	)

490 
	#PCI_EXP_DEVCAP_L1
 0x00000e00

	)

491 
	#PCI_EXP_DEVCAP_ATN_BUT
 0x00001000

	)

492 
	#PCI_EXP_DEVCAP_ATN_IND
 0x00002000

	)

493 
	#PCI_EXP_DEVCAP_PWR_IND
 0x00004000

	)

494 
	#PCI_EXP_DEVCAP_RBER
 0x00008000

	)

495 
	#PCI_EXP_DEVCAP_PWR_VAL
 0x03fc0000

	)

496 
	#PCI_EXP_DEVCAP_PWR_SCL
 0x0c000000

	)

497 
	#PCI_EXP_DEVCAP_FLR
 0x10000000

	)

498 
	#PCI_EXP_DEVCTL
 8

	)

499 
	#PCI_EXP_DEVCTL_CERE
 0x0001

	)

500 
	#PCI_EXP_DEVCTL_NFERE
 0x0002

	)

501 
	#PCI_EXP_DEVCTL_FERE
 0x0004

	)

502 
	#PCI_EXP_DEVCTL_URRE
 0x0008

	)

503 
	#PCI_EXP_DEVCTL_RELAX_EN
 0x0010

	)

504 
	#PCI_EXP_DEVCTL_PAYLOAD
 0x00e0

	)

505 
	#PCI_EXP_DEVCTL_PAYLOAD_128B
 0x0000

	)

506 
	#PCI_EXP_DEVCTL_PAYLOAD_256B
 0x0020

	)

507 
	#PCI_EXP_DEVCTL_PAYLOAD_512B
 0x0040

	)

508 
	#PCI_EXP_DEVCTL_PAYLOAD_1024B
 0x0060

	)

509 
	#PCI_EXP_DEVCTL_PAYLOAD_2048B
 0x0080

	)

510 
	#PCI_EXP_DEVCTL_PAYLOAD_4096B
 0x00a0

	)

511 
	#PCI_EXP_DEVCTL_EXT_TAG
 0x0100

	)

512 
	#PCI_EXP_DEVCTL_PHANTOM
 0x0200

	)

513 
	#PCI_EXP_DEVCTL_AUX_PME
 0x0400

	)

514 
	#PCI_EXP_DEVCTL_NOSNOOP_EN
 0x0800

	)

515 
	#PCI_EXP_DEVCTL_READRQ
 0x7000

	)

516 
	#PCI_EXP_DEVCTL_READRQ_128B
 0x0000

	)

517 
	#PCI_EXP_DEVCTL_READRQ_256B
 0x1000

	)

518 
	#PCI_EXP_DEVCTL_READRQ_512B
 0x2000

	)

519 
	#PCI_EXP_DEVCTL_READRQ_1024B
 0x3000

	)

520 
	#PCI_EXP_DEVCTL_READRQ_2048B
 0x4000

	)

521 
	#PCI_EXP_DEVCTL_READRQ_4096B
 0x5000

	)

522 
	#PCI_EXP_DEVCTL_BCR_FLR
 0x8000

	)

523 
	#PCI_EXP_DEVSTA
 10

	)

524 
	#PCI_EXP_DEVSTA_CED
 0x0001

	)

525 
	#PCI_EXP_DEVSTA_NFED
 0x0002

	)

526 
	#PCI_EXP_DEVSTA_FED
 0x0004

	)

527 
	#PCI_EXP_DEVSTA_URD
 0x0008

	)

528 
	#PCI_EXP_DEVSTA_AUXPD
 0x0010

	)

529 
	#PCI_EXP_DEVSTA_TRPND
 0x0020

	)

530 
	#PCI_CAP_EXP_RC_ENDPOINT_SIZEOF_V1
 12

	)

531 
	#PCI_EXP_LNKCAP
 12

	)

532 
	#PCI_EXP_LNKCAP_SLS
 0x0000000‡

	)

533 
	#PCI_EXP_LNKCAP_SLS_2_5GB
 0x00000001

	)

534 
	#PCI_EXP_LNKCAP_SLS_5_0GB
 0x00000002

	)

535 
	#PCI_EXP_LNKCAP_SLS_8_0GB
 0x00000003

	)

536 
	#PCI_EXP_LNKCAP_SLS_16_0GB
 0x00000004

	)

537 
	#PCI_EXP_LNKCAP_SLS_32_0GB
 0x00000005

	)

538 
	#PCI_EXP_LNKCAP_MLW
 0x000003f0

	)

539 
	#PCI_EXP_LNKCAP_ASPMS
 0x00000c00

	)

540 
	#PCI_EXP_LNKCAP_L0SEL
 0x00007000

	)

541 
	#PCI_EXP_LNKCAP_L1EL
 0x00038000

	)

542 
	#PCI_EXP_LNKCAP_CLKPM
 0x00040000

	)

543 
	#PCI_EXP_LNKCAP_SDERC
 0x00080000

	)

544 
	#PCI_EXP_LNKCAP_DLLLARC
 0x00100000

	)

545 
	#PCI_EXP_LNKCAP_LBNC
 0x00200000

	)

546 
	#PCI_EXP_LNKCAP_PN
 0xff000000

	)

547 
	#PCI_EXP_LNKCTL
 16

	)

548 
	#PCI_EXP_LNKCTL_ASPMC
 0x0003

	)

549 
	#PCI_EXP_LNKCTL_ASPM_L0S
 0x0001

	)

550 
	#PCI_EXP_LNKCTL_ASPM_L1
 0x0002

	)

551 
	#PCI_EXP_LNKCTL_RCB
 0x0008

	)

552 
	#PCI_EXP_LNKCTL_LD
 0x0010

	)

553 
	#PCI_EXP_LNKCTL_RL
 0x0020

	)

554 
	#PCI_EXP_LNKCTL_CCC
 0x0040

	)

555 
	#PCI_EXP_LNKCTL_ES
 0x0080

	)

556 
	#PCI_EXP_LNKCTL_CLKREQ_EN
 0x0100

	)

557 
	#PCI_EXP_LNKCTL_HAWD
 0x0200

	)

558 
	#PCI_EXP_LNKCTL_LBMIE
 0x0400

	)

559 
	#PCI_EXP_LNKCTL_LABIE
 0x0800

	)

560 
	#PCI_EXP_LNKSTA
 18

	)

561 
	#PCI_EXP_LNKSTA_CLS
 0x000‡

	)

562 
	#PCI_EXP_LNKSTA_CLS_2_5GB
 0x0001

	)

563 
	#PCI_EXP_LNKSTA_CLS_5_0GB
 0x0002

	)

564 
	#PCI_EXP_LNKSTA_CLS_8_0GB
 0x0003

	)

565 
	#PCI_EXP_LNKSTA_CLS_16_0GB
 0x0004

	)

566 
	#PCI_EXP_LNKSTA_CLS_32_0GB
 0x0005

	)

567 
	#PCI_EXP_LNKSTA_NLW
 0x03f0

	)

568 
	#PCI_EXP_LNKSTA_NLW_X1
 0x0010

	)

569 
	#PCI_EXP_LNKSTA_NLW_X2
 0x0020

	)

570 
	#PCI_EXP_LNKSTA_NLW_X4
 0x0040

	)

571 
	#PCI_EXP_LNKSTA_NLW_X8
 0x0080

	)

572 
	#PCI_EXP_LNKSTA_NLW_SHIFT
 4

	)

573 
	#PCI_EXP_LNKSTA_LT
 0x0800

	)

574 
	#PCI_EXP_LNKSTA_SLC
 0x1000

	)

575 
	#PCI_EXP_LNKSTA_DLLLA
 0x2000

	)

576 
	#PCI_EXP_LNKSTA_LBMS
 0x4000

	)

577 
	#PCI_EXP_LNKSTA_LABS
 0x8000

	)

578 
	#PCI_CAP_EXP_ENDPOINT_SIZEOF_V1
 20

	)

579 
	#PCI_EXP_SLTCAP
 20

	)

580 
	#PCI_EXP_SLTCAP_ABP
 0x00000001

	)

581 
	#PCI_EXP_SLTCAP_PCP
 0x00000002

	)

582 
	#PCI_EXP_SLTCAP_MRLSP
 0x00000004

	)

583 
	#PCI_EXP_SLTCAP_AIP
 0x00000008

	)

584 
	#PCI_EXP_SLTCAP_PIP
 0x00000010

	)

585 
	#PCI_EXP_SLTCAP_HPS
 0x00000020

	)

586 
	#PCI_EXP_SLTCAP_HPC
 0x00000040

	)

587 
	#PCI_EXP_SLTCAP_SPLV
 0x00007f80

	)

588 
	#PCI_EXP_SLTCAP_SPLS
 0x00018000

	)

589 
	#PCI_EXP_SLTCAP_EIP
 0x00020000

	)

590 
	#PCI_EXP_SLTCAP_NCCS
 0x00040000

	)

591 
	#PCI_EXP_SLTCAP_PSN
 0xfff80000

	)

592 
	#PCI_EXP_SLTCTL
 24

	)

593 
	#PCI_EXP_SLTCTL_ABPE
 0x0001

	)

594 
	#PCI_EXP_SLTCTL_PFDE
 0x0002

	)

595 
	#PCI_EXP_SLTCTL_MRLSCE
 0x0004

	)

596 
	#PCI_EXP_SLTCTL_PDCE
 0x0008

	)

597 
	#PCI_EXP_SLTCTL_CCIE
 0x0010

	)

598 
	#PCI_EXP_SLTCTL_HPIE
 0x0020

	)

599 
	#PCI_EXP_SLTCTL_AIC
 0x00c0

	)

600 
	#PCI_EXP_SLTCTL_ATTN_IND_SHIFT
 6

	)

601 
	#PCI_EXP_SLTCTL_ATTN_IND_ON
 0x0040

	)

602 
	#PCI_EXP_SLTCTL_ATTN_IND_BLINK
 0x0080

	)

603 
	#PCI_EXP_SLTCTL_ATTN_IND_OFF
 0x00c0

	)

604 
	#PCI_EXP_SLTCTL_PIC
 0x0300

	)

605 
	#PCI_EXP_SLTCTL_PWR_IND_ON
 0x0100

	)

606 
	#PCI_EXP_SLTCTL_PWR_IND_BLINK
 0x0200

	)

607 
	#PCI_EXP_SLTCTL_PWR_IND_OFF
 0x0300

	)

608 
	#PCI_EXP_SLTCTL_PCC
 0x0400

	)

609 
	#PCI_EXP_SLTCTL_PWR_ON
 0x0000

	)

610 
	#PCI_EXP_SLTCTL_PWR_OFF
 0x0400

	)

611 
	#PCI_EXP_SLTCTL_EIC
 0x0800

	)

612 
	#PCI_EXP_SLTCTL_DLLSCE
 0x1000

	)

613 
	#PCI_EXP_SLTSTA
 26

	)

614 
	#PCI_EXP_SLTSTA_ABP
 0x0001

	)

615 
	#PCI_EXP_SLTSTA_PFD
 0x0002

	)

616 
	#PCI_EXP_SLTSTA_MRLSC
 0x0004

	)

617 
	#PCI_EXP_SLTSTA_PDC
 0x0008

	)

618 
	#PCI_EXP_SLTSTA_CC
 0x0010

	)

619 
	#PCI_EXP_SLTSTA_MRLSS
 0x0020

	)

620 
	#PCI_EXP_SLTSTA_PDS
 0x0040

	)

621 
	#PCI_EXP_SLTSTA_EIS
 0x0080

	)

622 
	#PCI_EXP_SLTSTA_DLLSC
 0x0100

	)

623 
	#PCI_EXP_RTCTL
 28

	)

624 
	#PCI_EXP_RTCTL_SECEE
 0x0001

	)

625 
	#PCI_EXP_RTCTL_SENFEE
 0x0002

	)

626 
	#PCI_EXP_RTCTL_SEFEE
 0x0004

	)

627 
	#PCI_EXP_RTCTL_PMEIE
 0x0008

	)

628 
	#PCI_EXP_RTCTL_CRSSVE
 0x0010

	)

629 
	#PCI_EXP_RTCAP
 30

	)

630 
	#PCI_EXP_RTCAP_CRSVIS
 0x0001

	)

631 
	#PCI_EXP_RTSTA
 32

	)

632 
	#PCI_EXP_RTSTA_PME
 0x00010000

	)

633 
	#PCI_EXP_RTSTA_PENDING
 0x00020000

	)

642 
	#PCI_EXP_DEVCAP2
 36

	)

643 
	#PCI_EXP_DEVCAP2_COMP_TMOUT_DIS
 0x00000010

	)

644 
	#PCI_EXP_DEVCAP2_ARI
 0x00000020

	)

645 
	#PCI_EXP_DEVCAP2_ATOMIC_ROUTE
 0x00000040

	)

646 
	#PCI_EXP_DEVCAP2_ATOMIC_COMP32
 0x00000080

	)

647 
	#PCI_EXP_DEVCAP2_ATOMIC_COMP64
 0x00000100

	)

648 
	#PCI_EXP_DEVCAP2_ATOMIC_COMP128
 0x00000200

	)

649 
	#PCI_EXP_DEVCAP2_LTR
 0x00000800

	)

650 
	#PCI_EXP_DEVCAP2_OBFF_MASK
 0x000c0000

	)

651 
	#PCI_EXP_DEVCAP2_OBFF_MSG
 0x00040000

	)

652 
	#PCI_EXP_DEVCAP2_OBFF_WAKE
 0x00080000

	)

653 
	#PCI_EXP_DEVCAP2_EE_PREFIX
 0x00200000

	)

654 
	#PCI_EXP_DEVCTL2
 40

	)

655 
	#PCI_EXP_DEVCTL2_COMP_TIMEOUT
 0x000‡

	)

656 
	#PCI_EXP_DEVCTL2_COMP_TMOUT_DIS
 0x0010

	)

657 
	#PCI_EXP_DEVCTL2_ARI
 0x0020

	)

658 
	#PCI_EXP_DEVCTL2_ATOMIC_REQ
 0x0040

	)

659 
	#PCI_EXP_DEVCTL2_ATOMIC_EGRESS_BLOCK
 0x0080

	)

660 
	#PCI_EXP_DEVCTL2_IDO_REQ_EN
 0x0100

	)

661 
	#PCI_EXP_DEVCTL2_IDO_CMP_EN
 0x0200

	)

662 
	#PCI_EXP_DEVCTL2_LTR_EN
 0x0400

	)

663 
	#PCI_EXP_DEVCTL2_OBFF_MSGA_EN
 0x2000

	)

664 
	#PCI_EXP_DEVCTL2_OBFF_MSGB_EN
 0x4000

	)

665 
	#PCI_EXP_DEVCTL2_OBFF_WAKE_EN
 0x6000

	)

666 
	#PCI_EXP_DEVSTA2
 42

	)

667 
	#PCI_CAP_EXP_RC_ENDPOINT_SIZEOF_V2
 44

	)

668 
	#PCI_EXP_LNKCAP2
 44

	)

669 
	#PCI_EXP_LNKCAP2_SLS_2_5GB
 0x00000002

	)

670 
	#PCI_EXP_LNKCAP2_SLS_5_0GB
 0x00000004

	)

671 
	#PCI_EXP_LNKCAP2_SLS_8_0GB
 0x00000008

	)

672 
	#PCI_EXP_LNKCAP2_SLS_16_0GB
 0x00000010

	)

673 
	#PCI_EXP_LNKCAP2_SLS_32_0GB
 0x00000020

	)

674 
	#PCI_EXP_LNKCAP2_CROSSLINK
 0x00000100

	)

675 
	#PCI_EXP_LNKCTL2
 48

	)

676 
	#PCI_EXP_LNKCTL2_TLS
 0x000f

	)

677 
	#PCI_EXP_LNKCTL2_TLS_2_5GT
 0x0001

	)

678 
	#PCI_EXP_LNKCTL2_TLS_5_0GT
 0x0002

	)

679 
	#PCI_EXP_LNKCTL2_TLS_8_0GT
 0x0003

	)

680 
	#PCI_EXP_LNKCTL2_TLS_16_0GT
 0x0004

	)

681 
	#PCI_EXP_LNKCTL2_TLS_32_0GT
 0x0005

	)

682 
	#PCI_EXP_LNKSTA2
 50

	)

683 
	#PCI_CAP_EXP_ENDPOINT_SIZEOF_V2
 52

	)

684 
	#PCI_EXP_SLTCAP2
 52

	)

685 
	#PCI_EXP_SLTCTL2
 56

	)

686 
	#PCI_EXP_SLTSTA2
 58

	)

689 
	#PCI_EXT_CAP_ID
(
hódî
Ë(hódî & 0x0000ffff)

	)

690 
	#PCI_EXT_CAP_VER
(
hódî
Ë((hódî >> 16Ë& 0xf)

	)

691 
	#PCI_EXT_CAP_NEXT
(
hódî
Ë((hódî >> 20Ë& 0xffc)

	)

693 
	#PCI_EXT_CAP_ID_ERR
 0x01

	)

694 
	#PCI_EXT_CAP_ID_VC
 0x02

	)

695 
	#PCI_EXT_CAP_ID_DSN
 0x03

	)

696 
	#PCI_EXT_CAP_ID_PWR
 0x04

	)

697 
	#PCI_EXT_CAP_ID_RCLD
 0x05

	)

698 
	#PCI_EXT_CAP_ID_RCILC
 0x06

	)

699 
	#PCI_EXT_CAP_ID_RCEC
 0x07

	)

700 
	#PCI_EXT_CAP_ID_MFVC
 0x08

	)

701 
	#PCI_EXT_CAP_ID_VC9
 0x09

	)

702 
	#PCI_EXT_CAP_ID_RCRB
 0x0A

	)

703 
	#PCI_EXT_CAP_ID_VNDR
 0x0B

	)

704 
	#PCI_EXT_CAP_ID_CAC
 0x0C

	)

705 
	#PCI_EXT_CAP_ID_ACS
 0x0D

	)

706 
	#PCI_EXT_CAP_ID_ARI
 0x0E

	)

707 
	#PCI_EXT_CAP_ID_ATS
 0x0F

	)

708 
	#PCI_EXT_CAP_ID_SRIOV
 0x10

	)

709 
	#PCI_EXT_CAP_ID_MRIOV
 0x11

	)

710 
	#PCI_EXT_CAP_ID_MCAST
 0x12

	)

711 
	#PCI_EXT_CAP_ID_PRI
 0x13

	)

712 
	#PCI_EXT_CAP_ID_AMD_XXX
 0x14

	)

713 
	#PCI_EXT_CAP_ID_REBAR
 0x15

	)

714 
	#PCI_EXT_CAP_ID_DPA
 0x16

	)

715 
	#PCI_EXT_CAP_ID_TPH
 0x17

	)

716 
	#PCI_EXT_CAP_ID_LTR
 0x18

	)

717 
	#PCI_EXT_CAP_ID_SECPCI
 0x19

	)

718 
	#PCI_EXT_CAP_ID_PMUX
 0x1A

	)

719 
	#PCI_EXT_CAP_ID_PASID
 0x1B

	)

720 
	#PCI_EXT_CAP_ID_DPC
 0x1D

	)

721 
	#PCI_EXT_CAP_ID_L1SS
 0x1E

	)

722 
	#PCI_EXT_CAP_ID_PTM
 0x1F

	)

723 
	#PCI_EXT_CAP_ID_DLF
 0x25

	)

724 
	#PCI_EXT_CAP_ID_PL_16GT
 0x26

	)

725 
	#PCI_EXT_CAP_ID_MAX
 
PCI_EXT_CAP_ID_PL_16GT


	)

727 
	#PCI_EXT_CAP_DSN_SIZEOF
 12

	)

728 
	#PCI_EXT_CAP_MCAST_ENDPOINT_SIZEOF
 40

	)

731 
	#PCI_ERR_UNCOR_STATUS
 4

	)

732 
	#PCI_ERR_UNC_UND
 0x00000001

	)

733 
	#PCI_ERR_UNC_DLP
 0x00000010

	)

734 
	#PCI_ERR_UNC_SURPDN
 0x00000020

	)

735 
	#PCI_ERR_UNC_POISON_TLP
 0x00001000

	)

736 
	#PCI_ERR_UNC_FCP
 0x00002000

	)

737 
	#PCI_ERR_UNC_COMP_TIME
 0x00004000

	)

738 
	#PCI_ERR_UNC_COMP_ABORT
 0x00008000

	)

739 
	#PCI_ERR_UNC_UNX_COMP
 0x00010000

	)

740 
	#PCI_ERR_UNC_RX_OVER
 0x00020000

	)

741 
	#PCI_ERR_UNC_MALF_TLP
 0x00040000

	)

742 
	#PCI_ERR_UNC_ECRC
 0x00080000

	)

743 
	#PCI_ERR_UNC_UNSUP
 0x00100000

	)

744 
	#PCI_ERR_UNC_ACSV
 0x00200000

	)

745 
	#PCI_ERR_UNC_INTN
 0x00400000

	)

746 
	#PCI_ERR_UNC_MCBTLP
 0x00800000

	)

747 
	#PCI_ERR_UNC_ATOMEG
 0x01000000

	)

748 
	#PCI_ERR_UNC_TLPPRE
 0x02000000

	)

749 
	#PCI_ERR_UNCOR_MASK
 8

	)

751 
	#PCI_ERR_UNCOR_SEVER
 12

	)

753 
	#PCI_ERR_COR_STATUS
 16

	)

754 
	#PCI_ERR_COR_RCVR
 0x00000001

	)

755 
	#PCI_ERR_COR_BAD_TLP
 0x00000040

	)

756 
	#PCI_ERR_COR_BAD_DLLP
 0x00000080

	)

757 
	#PCI_ERR_COR_REP_ROLL
 0x00000100

	)

758 
	#PCI_ERR_COR_REP_TIMER
 0x00001000

	)

759 
	#PCI_ERR_COR_ADV_NFAT
 0x00002000

	)

760 
	#PCI_ERR_COR_INTERNAL
 0x00004000

	)

761 
	#PCI_ERR_COR_LOG_OVER
 0x00008000

	)

762 
	#PCI_ERR_COR_MASK
 20

	)

764 
	#PCI_ERR_CAP
 24

	)

765 
	#PCI_ERR_CAP_FEP
(
x
Ë((xË& 31Ë

	)

766 
	#PCI_ERR_CAP_ECRC_GENC
 0x00000020

	)

767 
	#PCI_ERR_CAP_ECRC_GENE
 0x00000040

	)

768 
	#PCI_ERR_CAP_ECRC_CHKC
 0x00000080

	)

769 
	#PCI_ERR_CAP_ECRC_CHKE
 0x00000100

	)

770 
	#PCI_ERR_HEADER_LOG
 28

	)

771 
	#PCI_ERR_ROOT_COMMAND
 44

	)

772 
	#PCI_ERR_ROOT_CMD_COR_EN
 0x00000001

	)

773 
	#PCI_ERR_ROOT_CMD_NONFATAL_EN
 0x00000002

	)

774 
	#PCI_ERR_ROOT_CMD_FATAL_EN
 0x00000004

	)

775 
	#PCI_ERR_ROOT_STATUS
 48

	)

776 
	#PCI_ERR_ROOT_COR_RCV
 0x00000001

	)

777 
	#PCI_ERR_ROOT_MULTI_COR_RCV
 0x00000002

	)

778 
	#PCI_ERR_ROOT_UNCOR_RCV
 0x00000004

	)

779 
	#PCI_ERR_ROOT_MULTI_UNCOR_RCV
 0x00000008

	)

780 
	#PCI_ERR_ROOT_FIRST_FATAL
 0x00000010

	)

781 
	#PCI_ERR_ROOT_NONFATAL_RCV
 0x00000020

	)

782 
	#PCI_ERR_ROOT_FATAL_RCV
 0x00000040

	)

783 
	#PCI_ERR_ROOT_AER_IRQ
 0xf8000000

	)

784 
	#PCI_ERR_ROOT_ERR_SRC
 52

	)

787 
	#PCI_VC_PORT_CAP1
 4

	)

788 
	#PCI_VC_CAP1_EVCC
 0x00000007

	)

789 
	#PCI_VC_CAP1_LPEVCC
 0x00000070

	)

790 
	#PCI_VC_CAP1_ARB_SIZE
 0x00000c00

	)

791 
	#PCI_VC_PORT_CAP2
 8

	)

792 
	#PCI_VC_CAP2_32_PHASE
 0x00000002

	)

793 
	#PCI_VC_CAP2_64_PHASE
 0x00000004

	)

794 
	#PCI_VC_CAP2_128_PHASE
 0x00000008

	)

795 
	#PCI_VC_CAP2_ARB_OFF
 0xff000000

	)

796 
	#PCI_VC_PORT_CTRL
 12

	)

797 
	#PCI_VC_PORT_CTRL_LOAD_TABLE
 0x00000001

	)

798 
	#PCI_VC_PORT_STATUS
 14

	)

799 
	#PCI_VC_PORT_STATUS_TABLE
 0x00000001

	)

800 
	#PCI_VC_RES_CAP
 16

	)

801 
	#PCI_VC_RES_CAP_32_PHASE
 0x00000002

	)

802 
	#PCI_VC_RES_CAP_64_PHASE
 0x00000004

	)

803 
	#PCI_VC_RES_CAP_128_PHASE
 0x00000008

	)

804 
	#PCI_VC_RES_CAP_128_PHASE_TB
 0x00000010

	)

805 
	#PCI_VC_RES_CAP_256_PHASE
 0x00000020

	)

806 
	#PCI_VC_RES_CAP_ARB_OFF
 0xff000000

	)

807 
	#PCI_VC_RES_CTRL
 20

	)

808 
	#PCI_VC_RES_CTRL_LOAD_TABLE
 0x00010000

	)

809 
	#PCI_VC_RES_CTRL_ARB_SELECT
 0x000e0000

	)

810 
	#PCI_VC_RES_CTRL_ID
 0x07000000

	)

811 
	#PCI_VC_RES_CTRL_ENABLE
 0x80000000

	)

812 
	#PCI_VC_RES_STATUS
 26

	)

813 
	#PCI_VC_RES_STATUS_TABLE
 0x00000001

	)

814 
	#PCI_VC_RES_STATUS_NEGO
 0x00000002

	)

815 
	#PCI_CAP_VC_BASE_SIZEOF
 0x10

	)

816 
	#PCI_CAP_VC_PER_VC_SIZEOF
 0x0C

	)

819 
	#PCI_PWR_DSR
 4

	)

820 
	#PCI_PWR_DATA
 8

	)

821 
	#PCI_PWR_DATA_BASE
(
x
Ë((xË& 0xffË

	)

822 
	#PCI_PWR_DATA_SCALE
(
x
Ë(((xË>> 8Ë& 3Ë

	)

823 
	#PCI_PWR_DATA_PM_SUB
(
x
Ë(((xË>> 10Ë& 7Ë

	)

824 
	#PCI_PWR_DATA_PM_STATE
(
x
Ë(((xË>> 13Ë& 3Ë

	)

825 
	#PCI_PWR_DATA_TYPE
(
x
Ë(((xË>> 15Ë& 7Ë

	)

826 
	#PCI_PWR_DATA_RAIL
(
x
Ë(((xË>> 18Ë& 7Ë

	)

827 
	#PCI_PWR_CAP
 12

	)

828 
	#PCI_PWR_CAP_BUDGET
(
x
Ë((xË& 1Ë

	)

829 
	#PCI_EXT_CAP_PWR_SIZEOF
 16

	)

832 
	#PCI_VNDR_HEADER
 4

	)

833 
	#PCI_VNDR_HEADER_ID
(
x
Ë((xË& 0xffff)

	)

834 
	#PCI_VNDR_HEADER_REV
(
x
Ë(((xË>> 16Ë& 0xf)

	)

835 
	#PCI_VNDR_HEADER_LEN
(
x
Ë(((xË>> 20Ë& 0xfff)

	)

845 
	#HT_3BIT_CAP_MASK
 0xE0

	)

846 
	#HT_CAPTYPE_SLAVE
 0x00

	)

847 
	#HT_CAPTYPE_HOST
 0x20

	)

849 
	#HT_5BIT_CAP_MASK
 0xF8

	)

850 
	#HT_CAPTYPE_IRQ
 0x80

	)

851 
	#HT_CAPTYPE_REMAPPING_40
 0xA0

	)

852 
	#HT_CAPTYPE_REMAPPING_64
 0xA2

	)

853 
	#HT_CAPTYPE_UNITID_CLUMP
 0x90

	)

854 
	#HT_CAPTYPE_EXTCONF
 0x98

	)

855 
	#HT_CAPTYPE_MSI_MAPPING
 0xA8

	)

856 
	#HT_MSI_FLAGS
 0x02

	)

857 
	#HT_MSI_FLAGS_ENABLE
 0x1

	)

858 
	#HT_MSI_FLAGS_FIXED
 0x2

	)

859 
	#HT_MSI_FIXED_ADDR
 0x00000000FEE00000ULL

	)

860 
	#HT_MSI_ADDR_LO
 0x04

	)

861 
	#HT_MSI_ADDR_LO_MASK
 0xFFF00000

	)

862 
	#HT_MSI_ADDR_HI
 0x08

	)

863 
	#HT_CAPTYPE_DIRECT_ROUTE
 0xB0

	)

864 
	#HT_CAPTYPE_VCSET
 0xB8

	)

865 
	#HT_CAPTYPE_ERROR_RETRY
 0xC0

	)

866 
	#HT_CAPTYPE_GEN3
 0xD0

	)

867 
	#HT_CAPTYPE_PM
 0xE0

	)

868 
	#HT_CAP_SIZEOF_LONG
 28

	)

869 
	#HT_CAP_SIZEOF_SHORT
 24

	)

872 
	#PCI_ARI_CAP
 0x04

	)

873 
	#PCI_ARI_CAP_MFVC
 0x0001

	)

874 
	#PCI_ARI_CAP_ACS
 0x0002

	)

875 
	#PCI_ARI_CAP_NFN
(
x
Ë(((xË>> 8Ë& 0xffË

	)

876 
	#PCI_ARI_CTRL
 0x06

	)

877 
	#PCI_ARI_CTRL_MFVC
 0x0001

	)

878 
	#PCI_ARI_CTRL_ACS
 0x0002

	)

879 
	#PCI_ARI_CTRL_FG
(
x
Ë(((xË>> 4Ë& 7Ë

	)

880 
	#PCI_EXT_CAP_ARI_SIZEOF
 8

	)

883 
	#PCI_ATS_CAP
 0x04

	)

884 
	#PCI_ATS_CAP_QDEP
(
x
Ë((xË& 0x1fË

	)

885 
	#PCI_ATS_MAX_QDEP
 32

	)

886 
	#PCI_ATS_CAP_PAGE_ALIGNED
 0x0020

	)

887 
	#PCI_ATS_CTRL
 0x06

	)

888 
	#PCI_ATS_CTRL_ENABLE
 0x8000

	)

889 
	#PCI_ATS_CTRL_STU
(
x
Ë((xË& 0x1fË

	)

890 
	#PCI_ATS_MIN_STU
 12

	)

891 
	#PCI_EXT_CAP_ATS_SIZEOF
 8

	)

894 
	#PCI_PRI_CTRL
 0x04

	)

895 
	#PCI_PRI_CTRL_ENABLE
 0x0001

	)

896 
	#PCI_PRI_CTRL_RESET
 0x0002

	)

897 
	#PCI_PRI_STATUS
 0x06

	)

898 
	#PCI_PRI_STATUS_RF
 0x0001

	)

899 
	#PCI_PRI_STATUS_UPRGI
 0x0002

	)

900 
	#PCI_PRI_STATUS_STOPPED
 0x0100

	)

901 
	#PCI_PRI_STATUS_PASID
 0x8000

	)

902 
	#PCI_PRI_MAX_REQ
 0x08

	)

903 
	#PCI_PRI_ALLOC_REQ
 0x0¯

	)

904 
	#PCI_EXT_CAP_PRI_SIZEOF
 16

	)

907 
	#PCI_PASID_CAP
 0x04

	)

908 
	#PCI_PASID_CAP_EXEC
 0x02

	)

909 
	#PCI_PASID_CAP_PRIV
 0x04

	)

910 
	#PCI_PASID_CTRL
 0x06

	)

911 
	#PCI_PASID_CTRL_ENABLE
 0x01

	)

912 
	#PCI_PASID_CTRL_EXEC
 0x02

	)

913 
	#PCI_PASID_CTRL_PRIV
 0x04

	)

914 
	#PCI_EXT_CAP_PASID_SIZEOF
 8

	)

917 
	#PCI_SRIOV_CAP
 0x04

	)

918 
	#PCI_SRIOV_CAP_VFM
 0x00000001

	)

919 
	#PCI_SRIOV_CAP_INTR
(
x
Ë((xË>> 21Ë

	)

920 
	#PCI_SRIOV_CTRL
 0x08

	)

921 
	#PCI_SRIOV_CTRL_VFE
 0x0001

	)

922 
	#PCI_SRIOV_CTRL_VFM
 0x0002

	)

923 
	#PCI_SRIOV_CTRL_INTR
 0x0004

	)

924 
	#PCI_SRIOV_CTRL_MSE
 0x0008

	)

925 
	#PCI_SRIOV_CTRL_ARI
 0x0010

	)

926 
	#PCI_SRIOV_STATUS
 0x0®

	)

927 
	#PCI_SRIOV_STATUS_VFM
 0x0001

	)

928 
	#PCI_SRIOV_INITIAL_VF
 0x0¯

	)

929 
	#PCI_SRIOV_TOTAL_VF
 0x0ê

	)

930 
	#PCI_SRIOV_NUM_VF
 0x10

	)

931 
	#PCI_SRIOV_FUNC_LINK
 0x12

	)

932 
	#PCI_SRIOV_VF_OFFSET
 0x14

	)

933 
	#PCI_SRIOV_VF_STRIDE
 0x16

	)

934 
	#PCI_SRIOV_VF_DID
 0x1®

	)

935 
	#PCI_SRIOV_SUP_PGSIZE
 0x1¯

	)

936 
	#PCI_SRIOV_SYS_PGSIZE
 0x20

	)

937 
	#PCI_SRIOV_BAR
 0x24

	)

938 
	#PCI_SRIOV_NUM_BARS
 6

	)

939 
	#PCI_SRIOV_VFM
 0x3¯

	)

940 
	#PCI_SRIOV_VFM_BIR
(
x
Ë((xË& 7Ë

	)

941 
	#PCI_SRIOV_VFM_OFFSET
(
x
Ë((xË& ~7Ë

	)

942 
	#PCI_SRIOV_VFM_UA
 0x0

	)

943 
	#PCI_SRIOV_VFM_MI
 0x1

	)

944 
	#PCI_SRIOV_VFM_MO
 0x2

	)

945 
	#PCI_SRIOV_VFM_AV
 0x3

	)

946 
	#PCI_EXT_CAP_SRIOV_SIZEOF
 64

	)

948 
	#PCI_LTR_MAX_SNOOP_LAT
 0x4

	)

949 
	#PCI_LTR_MAX_NOSNOOP_LAT
 0x6

	)

950 
	#PCI_LTR_VALUE_MASK
 0x000003ff

	)

951 
	#PCI_LTR_SCALE_MASK
 0x00001c00

	)

952 
	#PCI_LTR_SCALE_SHIFT
 10

	)

953 
	#PCI_EXT_CAP_LTR_SIZEOF
 8

	)

956 
	#PCI_ACS_CAP
 0x04

	)

957 
	#PCI_ACS_SV
 0x0001

	)

958 
	#PCI_ACS_TB
 0x0002

	)

959 
	#PCI_ACS_RR
 0x0004

	)

960 
	#PCI_ACS_CR
 0x0008

	)

961 
	#PCI_ACS_UF
 0x0010

	)

962 
	#PCI_ACS_EC
 0x0020

	)

963 
	#PCI_ACS_DT
 0x0040

	)

964 
	#PCI_ACS_EGRESS_BITS
 0x05

	)

965 
	#PCI_ACS_CTRL
 0x06

	)

966 
	#PCI_ACS_EGRESS_CTL_V
 0x08

	)

968 
	#PCI_VSEC_HDR
 4

	)

969 
	#PCI_VSEC_HDR_LEN_SHIFT
 20

	)

972 
	#PCI_SATA_REGS
 4

	)

973 
	#PCI_SATA_REGS_MASK
 0xF

	)

974 
	#PCI_SATA_REGS_INLINE
 0xF

	)

975 
	#PCI_SATA_SIZEOF_SHORT
 8

	)

976 
	#PCI_SATA_SIZEOF_LONG
 16

	)

979 
	#PCI_REBAR_CAP
 4

	)

980 
	#PCI_REBAR_CAP_SIZES
 0x00FFFFF0

	)

981 
	#PCI_REBAR_CTRL
 8

	)

982 
	#PCI_REBAR_CTRL_BAR_IDX
 0x00000007

	)

983 
	#PCI_REBAR_CTRL_NBAR_MASK
 0x000000E0

	)

984 
	#PCI_REBAR_CTRL_NBAR_SHIFT
 5

	)

985 
	#PCI_REBAR_CTRL_BAR_SIZE
 0x00001F00

	)

986 
	#PCI_REBAR_CTRL_BAR_SHIFT
 8

	)

989 
	#PCI_DPA_CAP
 4

	)

990 
	#PCI_DPA_CAP_SUBSTATE_MASK
 0x1F

	)

991 
	#PCI_DPA_BASE_SIZEOF
 16

	)

994 
	#PCI_TPH_CAP
 4

	)

995 
	#PCI_TPH_CAP_LOC_MASK
 0x600

	)

996 
	#PCI_TPH_LOC_NONE
 0x000

	)

997 
	#PCI_TPH_LOC_CAP
 0x200

	)

998 
	#PCI_TPH_LOC_MSIX
 0x400

	)

999 
	#PCI_TPH_CAP_ST_MASK
 0x07FF0000

	)

1000 
	#PCI_TPH_CAP_ST_SHIFT
 16

	)

1001 
	#PCI_TPH_BASE_SIZEOF
 12

	)

1004 
	#PCI_EXP_DPC_CAP
 4

	)

1005 
	#PCI_EXP_DPC_IRQ
 0x001F

	)

1006 
	#PCI_EXP_DPC_CAP_RP_EXT
 0x0020

	)

1007 
	#PCI_EXP_DPC_CAP_POISONED_TLP
 0x0040

	)

1008 
	#PCI_EXP_DPC_CAP_SW_TRIGGER
 0x0080

	)

1009 
	#PCI_EXP_DPC_RP_PIO_LOG_SIZE
 0x0F00

	)

1010 
	#PCI_EXP_DPC_CAP_DL_ACTIVE
 0x1000

	)

1012 
	#PCI_EXP_DPC_CTL
 6

	)

1013 
	#PCI_EXP_DPC_CTL_EN_FATAL
 0x0001

	)

1014 
	#PCI_EXP_DPC_CTL_EN_NONFATAL
 0x0002

	)

1015 
	#PCI_EXP_DPC_CTL_INT_EN
 0x0008

	)

1017 
	#PCI_EXP_DPC_STATUS
 8

	)

1018 
	#PCI_EXP_DPC_STATUS_TRIGGER
 0x0001

	)

1019 
	#PCI_EXP_DPC_STATUS_TRIGGER_RSN
 0x0006

	)

1020 
	#PCI_EXP_DPC_STATUS_INTERRUPT
 0x0008

	)

1021 
	#PCI_EXP_DPC_RP_BUSY
 0x0010

	)

1022 
	#PCI_EXP_DPC_STATUS_TRIGGER_RSN_EXT
 0x0060

	)

1024 
	#PCI_EXP_DPC_SOURCE_ID
 10

	)

1026 
	#PCI_EXP_DPC_RP_PIO_STATUS
 0x0C

	)

1027 
	#PCI_EXP_DPC_RP_PIO_MASK
 0x10

	)

1028 
	#PCI_EXP_DPC_RP_PIO_SEVERITY
 0x14

	)

1029 
	#PCI_EXP_DPC_RP_PIO_SYSERROR
 0x18

	)

1030 
	#PCI_EXP_DPC_RP_PIO_EXCEPTION
 0x1C

	)

1031 
	#PCI_EXP_DPC_RP_PIO_HEADER_LOG
 0x20

	)

1032 
	#PCI_EXP_DPC_RP_PIO_IMPSPEC_LOG
 0x30

	)

1033 
	#PCI_EXP_DPC_RP_PIO_TLPPREFIX_LOG
 0x34

	)

1036 
	#PCI_PTM_CAP
 0x04

	)

1037 
	#PCI_PTM_CAP_REQ
 0x00000001

	)

1038 
	#PCI_PTM_CAP_ROOT
 0x00000004

	)

1039 
	#PCI_PTM_GRANULARITY_MASK
 0x0000FF00

	)

1040 
	#PCI_PTM_CTRL
 0x08

	)

1041 
	#PCI_PTM_CTRL_ENABLE
 0x00000001

	)

1042 
	#PCI_PTM_CTRL_ROOT
 0x00000002

	)

1045 
	#PCI_L1SS_CAP
 0x04

	)

1046 
	#PCI_L1SS_CAP_PCIPM_L1_2
 0x00000001

	)

1047 
	#PCI_L1SS_CAP_PCIPM_L1_1
 0x00000002

	)

1048 
	#PCI_L1SS_CAP_ASPM_L1_2
 0x00000004

	)

1049 
	#PCI_L1SS_CAP_ASPM_L1_1
 0x00000008

	)

1050 
	#PCI_L1SS_CAP_L1_PM_SS
 0x00000010

	)

1051 
	#PCI_L1SS_CAP_CM_RESTORE_TIME
 0x0000ff00

	)

1052 
	#PCI_L1SS_CAP_P_PWR_ON_SCALE
 0x00030000

	)

1053 
	#PCI_L1SS_CAP_P_PWR_ON_VALUE
 0x00f80000

	)

1054 
	#PCI_L1SS_CTL1
 0x08

	)

1055 
	#PCI_L1SS_CTL1_PCIPM_L1_2
 0x00000001

	)

1056 
	#PCI_L1SS_CTL1_PCIPM_L1_1
 0x00000002

	)

1057 
	#PCI_L1SS_CTL1_ASPM_L1_2
 0x00000004

	)

1058 
	#PCI_L1SS_CTL1_ASPM_L1_1
 0x00000008

	)

1059 
	#PCI_L1SS_CTL1_L1SS_MASK
 0x0000000f

	)

1060 
	#PCI_L1SS_CTL1_CM_RESTORE_TIME
 0x0000ff00

	)

1061 
	#PCI_L1SS_CTL1_LTR_L12_TH_VALUE
 0x03ff0000

	)

1062 
	#PCI_L1SS_CTL1_LTR_L12_TH_SCALE
 0xe0000000

	)

1063 
	#PCI_L1SS_CTL2
 0x0¯

	)

1066 
	#PCI_DLF_CAP
 0x04

	)

1067 
	#PCI_DLF_EXCHANGE_ENABLE
 0x80000000

	)

1070 
	#PCI_PL_16GT_LE_CTRL
 0x20

	)

1071 
	#PCI_PL_16GT_LE_CTRL_DSP_TX_PRESET_MASK
 0x0000000F

	)

1072 
	#PCI_PL_16GT_LE_CTRL_USP_TX_PRESET_MASK
 0x000000F0

	)

1073 
	#PCI_PL_16GT_LE_CTRL_USP_TX_PRESET_SHIFT
 4

	)

	@/usr/include/linux/posix_types.h

2 #i‚de‡
_LINUX_POSIX_TYPES_H


3 
	#_LINUX_POSIX_TYPES_H


	)

5 
	~<löux/°ddef.h
>

22 #unde‡
__FD_SETSIZE


23 
	#__FD_SETSIZE
 1024

	)

26 
	mfds_bôs
[
__FD_SETSIZE
 / (8 * ())];

27 } 
	t__kî√l_fd_£t
;

30 (*
	t__kî√l_sigh™dÀr_t
)();

33 
	t__kî√l_key_t
;

34 
	t__kî√l_mqd_t
;

36 
	~<asm/posix_ty≥s.h
>

	@/usr/include/asm-generic/types.h

2 #i‚de‡
_ASM_GENERIC_TYPES_H


3 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-gíîic/öt-Œ64.h
>

	@/usr/include/asm/ioctl.h

1 
	~<asm-gíîic/io˘l.h
>

	@/usr/include/asm/posix_types.h

2 #ifde‡
__i386__


3 
	~<asm/posix_ty≥s_32.h
>

4 #ñi‡
deföed
(
__ILP32__
)

5 
	~<asm/posix_ty≥s_x32.h
>

7 
	~<asm/posix_ty≥s_64.h
>

	@/usr/include/bits/libc-header-start.h

27 #i‚de‡
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


31 #unde‡
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


33 
	~<„©uªs.h
>

37 #unde‡
__GLIBC_USE_LIB_EXT2


38 #i‡(
deföed
 
__USE_GNU
 \

39 || (
deföed
 
	g__STDC_WANT_LIB_EXT2__
 && __STDC_WANT_LIB_EXT2__ > 0))

40 
	#__GLIBC_USE_LIB_EXT2
 1

	)

42 
	#__GLIBC_USE_LIB_EXT2
 0

	)

49 #unde‡
__GLIBC_USE_IEC_60559_BFP_EXT


50 #i‡
deföed
 
__USE_GNU
 || deföed 
__STDC_WANT_IEC_60559_BFP_EXT__


51 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 1

	)

53 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 0

	)

55 #unde‡
__GLIBC_USE_IEC_60559_BFP_EXT_C2X


56 #i‡
__GLIBC_USE
 (
IEC_60559_BFP_EXT
Ë|| __GLIBC_USE (
ISOC2X
)

57 
	#__GLIBC_USE_IEC_60559_BFP_EXT_C2X
 1

	)

59 
	#__GLIBC_USE_IEC_60559_BFP_EXT_C2X
 0

	)

66 #unde‡
__GLIBC_USE_IEC_60559_FUNCS_EXT


67 #i‡
deföed
 
__USE_GNU
 || deföed 
__STDC_WANT_IEC_60559_FUNCS_EXT__


68 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 1

	)

70 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 0

	)

72 #unde‡
__GLIBC_USE_IEC_60559_FUNCS_EXT_C2X


73 #i‡
__GLIBC_USE
 (
IEC_60559_FUNCS_EXT
Ë|| __GLIBC_USE (
ISOC2X
)

74 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT_C2X
 1

	)

76 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT_C2X
 0

	)

81 #unde‡
__GLIBC_USE_IEC_60559_TYPES_EXT


82 #i‡
deföed
 
__USE_GNU
 || deföed 
__STDC_WANT_IEC_60559_TYPES_EXT__


83 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 1

	)

85 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 0

	)

	@/usr/include/bits/posix1_lim.h

24 #i‚def 
_BITS_POSIX1_LIM_H


25 
	#_BITS_POSIX1_LIM_H
 1

	)

27 
	~<bôs/w‹dsize.h
>

32 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

35 
	#_POSIX_AIO_MAX
 1

	)

38 
	#_POSIX_ARG_MAX
 4096

	)

41 #ifde‡
__USE_XOPEN2K


42 
	#_POSIX_CHILD_MAX
 25

	)

44 
	#_POSIX_CHILD_MAX
 6

	)

48 
	#_POSIX_DELAYTIMER_MAX
 32

	)

52 
	#_POSIX_HOST_NAME_MAX
 255

	)

55 
	#_POSIX_LINK_MAX
 8

	)

58 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

61 
	#_POSIX_MAX_CANON
 255

	)

65 
	#_POSIX_MAX_INPUT
 255

	)

68 
	#_POSIX_MQ_OPEN_MAX
 8

	)

71 
	#_POSIX_MQ_PRIO_MAX
 32

	)

74 
	#_POSIX_NAME_MAX
 14

	)

77 #ifde‡
__USE_XOPEN2K


78 
	#_POSIX_NGROUPS_MAX
 8

	)

80 
	#_POSIX_NGROUPS_MAX
 0

	)

84 #ifde‡
__USE_XOPEN2K


85 
	#_POSIX_OPEN_MAX
 20

	)

87 
	#_POSIX_OPEN_MAX
 16

	)

90 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


93 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

97 
	#_POSIX_PATH_MAX
 256

	)

100 
	#_POSIX_PIPE_BUF
 512

	)

104 
	#_POSIX_RE_DUP_MAX
 255

	)

107 
	#_POSIX_RTSIG_MAX
 8

	)

110 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

113 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

116 
	#_POSIX_SIGQUEUE_MAX
 32

	)

119 
	#_POSIX_SSIZE_MAX
 32767

	)

122 
	#_POSIX_STREAM_MAX
 8

	)

125 
	#_POSIX_SYMLINK_MAX
 255

	)

129 
	#_POSIX_SYMLOOP_MAX
 8

	)

132 
	#_POSIX_TIMER_MAX
 32

	)

135 
	#_POSIX_TTY_NAME_MAX
 9

	)

138 #ifde‡
__USE_XOPEN2K


139 
	#_POSIX_TZNAME_MAX
 6

	)

141 
	#_POSIX_TZNAME_MAX
 3

	)

144 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


146 
	#_POSIX_QLIMIT
 1

	)

150 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

153 
	#_POSIX_UIO_MAXIOV
 16

	)

157 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

161 
	~<bôs/loˇl_lim.h
>

164 #i‚def 
SSIZE_MAX


168 #i‡
__WORDSIZE
 =64 || 
__WORDSIZE32_SIZE_ULONG


169 
	#SSIZE_MAX
 
LONG_MAX


	)

171 
	#SSIZE_MAX
 
INT_MAX


	)

179 #i‚def 
NGROUPS_MAX


180 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix2_lim.h

22 #i‚def 
_BITS_POSIX2_LIM_H


23 
	#_BITS_POSIX2_LIM_H
 1

	)

27 
	#_POSIX2_BC_BASE_MAX
 99

	)

30 
	#_POSIX2_BC_DIM_MAX
 2048

	)

33 
	#_POSIX2_BC_SCALE_MAX
 99

	)

36 
	#_POSIX2_BC_STRING_MAX
 1000

	)

40 
	#_POSIX2_COLL_WEIGHTS_MAX
 2

	)

44 
	#_POSIX2_EXPR_NEST_MAX
 32

	)

47 
	#_POSIX2_LINE_MAX
 2048

	)

51 
	#_POSIX2_RE_DUP_MAX
 255

	)

55 
	#_POSIX2_CHARCLASS_NAME_MAX
 14

	)

62 #i‚def 
BC_BASE_MAX


63 
	#BC_BASE_MAX
 
_POSIX2_BC_BASE_MAX


	)

65 #i‚def 
BC_DIM_MAX


66 
	#BC_DIM_MAX
 
_POSIX2_BC_DIM_MAX


	)

68 #i‚def 
BC_SCALE_MAX


69 
	#BC_SCALE_MAX
 
_POSIX2_BC_SCALE_MAX


	)

71 #i‚def 
BC_STRING_MAX


72 
	#BC_STRING_MAX
 
_POSIX2_BC_STRING_MAX


	)

74 #i‚def 
COLL_WEIGHTS_MAX


75 
	#COLL_WEIGHTS_MAX
 255

	)

77 #i‚def 
EXPR_NEST_MAX


78 
	#EXPR_NEST_MAX
 
_POSIX2_EXPR_NEST_MAX


	)

80 #i‚def 
LINE_MAX


81 
	#LINE_MAX
 
_POSIX2_LINE_MAX


	)

83 #i‚def 
CHARCLASS_NAME_MAX


84 
	#CHARCLASS_NAME_MAX
 2048

	)

88 
	#RE_DUP_MAX
 (0x7fff)

	)

	@/usr/include/bits/wordsize.h

3 #i‡
deföed
 
__x86_64__
 && !deföed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

7 
	#__WORDSIZE32_SIZE_ULONG
 0

	)

8 
	#__WORDSIZE32_PTRDIFF_LONG
 0

	)

11 #ifde‡
__x86_64__


12 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

14 
	#__SYSCALL_WORDSIZE
 64

	)

16 
	#__WORDSIZE_TIME64_COMPAT32
 0

	)

	@/usr/include/bits/xopen_lim.h

29 #i‚de‡
_XOPEN_LIM_H


30 
	#_XOPEN_LIM_H
 1

	)

62 
	#_XOPEN_IOV_MAX
 
_POSIX_UIO_MAXIOV


	)

64 
	~<bôs/uio_lim.h
>

65 #ifde‡
__IOV_MAX


66 
	#IOV_MAX
 
__IOV_MAX


	)

68 #unde‡
IOV_MAX


73 
	#NL_ARGMAX
 
_POSIX_ARG_MAX


	)

76 
	#NL_LANGMAX
 
_POSIX2_LINE_MAX


	)

79 
	#NL_MSGMAX
 
INT_MAX


	)

83 #i‡
deföed
 
__USE_GNU
 || !deföed 
__USE_XOPEN2K8


84 
	#NL_NMAX
 
INT_MAX


	)

88 
	#NL_SETMAX
 
INT_MAX


	)

91 
	#NL_TEXTMAX
 
INT_MAX


	)

94 
	#NZERO
 20

	)

98 #ifde‡
INT_MAX


99 #i‡
INT_MAX
 == 32767

100 
	#WORD_BIT
 16

	)

102 #i‡
INT_MAX
 == 2147483647

103 
	#WORD_BIT
 32

	)

106 
	#WORD_BIT
 64

	)

109 #ñi‡
deföed
 
__INT_MAX__


110 #i‡
__INT_MAX__
 == 32767

111 
	#WORD_BIT
 16

	)

113 #i‡
__INT_MAX__
 == 2147483647

114 
	#WORD_BIT
 32

	)

117 
	#WORD_BIT
 64

	)

121 
	#WORD_BIT
 32

	)

125 #ifde‡
LONG_MAX


126 #i‡
LONG_MAX
 == 2147483647

127 
	#LONG_BIT
 32

	)

130 
	#LONG_BIT
 64

	)

132 #ñi‡
deföed
 
__LONG_MAX__


133 #i‡
__LONG_MAX__
 == 2147483647

134 
	#LONG_BIT
 32

	)

137 
	#LONG_BIT
 64

	)

140 
	~<bôs/w‹dsize.h
>

141 #i‡
__WORDSIZE
 == 64

142 
	#LONG_BIT
 64

	)

144 
	#LONG_BIT
 32

	)

	@/usr/include/linux/hdlc/ioctl.h

2 #i‚de‡
__HDLC_IOCTL_H__


3 
	#__HDLC_IOCTL_H__


	)

6 
	#GENERIC_HDLC_VERSION
 4

	)

8 
	#CLOCK_DEFAULT
 0

	)

9 
	#CLOCK_EXT
 1

	)

10 
	#CLOCK_INT
 2

	)

11 
	#CLOCK_TXINT
 3

	)

12 
	#CLOCK_TXFROMRX
 4

	)

15 
	#ENCODING_DEFAULT
 0

	)

16 
	#ENCODING_NRZ
 1

	)

17 
	#ENCODING_NRZI
 2

	)

18 
	#ENCODING_FM_MARK
 3

	)

19 
	#ENCODING_FM_SPACE
 4

	)

20 
	#ENCODING_MANCHESTER
 5

	)

23 
	#PARITY_DEFAULT
 0

	)

24 
	#PARITY_NONE
 1

	)

25 
	#PARITY_CRC16_PR0
 2

	)

26 
	#PARITY_CRC16_PR1
 3

	)

27 
	#PARITY_CRC16_PR0_CCITT
 4

	)

28 
	#PARITY_CRC16_PR1_CCITT
 5

	)

29 
	#PARITY_CRC32_PR0_CCITT
 6

	)

30 
	#PARITY_CRC32_PR1_CCITT
 7

	)

32 
	#LMI_DEFAULT
 0

	)

33 
	#LMI_NONE
 1

	)

34 
	#LMI_ANSI
 2

	)

35 
	#LMI_CCITT
 3

	)

36 
	#LMI_CISCO
 4

	)

38 #i‚de‡
__ASSEMBLY__


41 
	m˛ock_øã
;

42 
	m˛ock_ty≥
;

43 
	mlo›back
;

44 } 
	tsync_£rül_£âögs
;

47 
	m˛ock_øã
;

48 
	m˛ock_ty≥
;

49 
	mlo›back
;

50 
	m¶Ÿ_m≠
;

51 } 
	tã1_£âögs
;

54 
	mícodög
;

55 
	m∑rôy
;

56 } 
	tøw_hdlc_¥Ÿo
;

59 
	mt391
;

60 
	mt392
;

61 
	mn391
;

62 
	mn392
;

63 
	mn393
;

64 
	mlmi
;

65 
	md˚
;

66 } 
	t‰_¥Ÿo
;

69 
	mdlci
;

70 } 
	t‰_¥Ÿo_pvc
;

73 
	mdlci
;

74 
	mma°î
[
IFNAMSIZ
];

75 }
	t‰_¥Ÿo_pvc_öfo
;

78 
	möãrvÆ
;

79 
	mtimeout
;

80 } 
	tcisco_¥Ÿo
;

	@/usr/include/linux/libc-compat.h

49 #i‚de‡
_LIBC_COMPAT_H


50 
	#_LIBC_COMPAT_H


	)

53 #i‡
deföed
(
__GLIBC__
)

56 #i‡
deföed
(
_NET_IF_H
Ë&& deföed(
__USE_MISC
)

61 
	#__UAPI_DEF_IF_IFCONF
 0

	)

62 
	#__UAPI_DEF_IF_IFMAP
 0

	)

63 
	#__UAPI_DEF_IF_IFNAMSIZ
 0

	)

64 
	#__UAPI_DEF_IF_IFREQ
 0

	)

66 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 0

	)

68 #i‚de‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


69 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

78 
	#__UAPI_DEF_IF_IFCONF
 1

	)

79 
	#__UAPI_DEF_IF_IFMAP
 1

	)

80 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

81 
	#__UAPI_DEF_IF_IFREQ
 1

	)

83 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

85 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

90 #i‡
deföed
(
_NETINET_IN_H
)

94 
	#__UAPI_DEF_IN_ADDR
 0

	)

95 
	#__UAPI_DEF_IN_IPPROTO
 0

	)

96 
	#__UAPI_DEF_IN_PKTINFO
 0

	)

97 
	#__UAPI_DEF_IP_MREQ
 0

	)

98 
	#__UAPI_DEF_SOCKADDR_IN
 0

	)

99 
	#__UAPI_DEF_IN_CLASS
 0

	)

101 
	#__UAPI_DEF_IN6_ADDR
 0

	)

106 #i‡
deföed
(
__USE_MISC
Ë|| deföed (
__USE_GNU
)

107 
	#__UAPI_DEF_IN6_ADDR_ALT
 0

	)

109 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

111 
	#__UAPI_DEF_SOCKADDR_IN6
 0

	)

112 
	#__UAPI_DEF_IPV6_MREQ
 0

	)

113 
	#__UAPI_DEF_IPPROTO_V6
 0

	)

114 
	#__UAPI_DEF_IPV6_OPTIONS
 0

	)

115 
	#__UAPI_DEF_IN6_PKTINFO
 0

	)

116 
	#__UAPI_DEF_IP6_MTUINFO
 0

	)

123 
	#__UAPI_DEF_IN_ADDR
 1

	)

124 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

125 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

126 
	#__UAPI_DEF_IP_MREQ
 1

	)

127 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

128 
	#__UAPI_DEF_IN_CLASS
 1

	)

130 
	#__UAPI_DEF_IN6_ADDR
 1

	)

133 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

134 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

135 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

136 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

137 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

138 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

139 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

144 #i‡
deföed
(
__NETIPX_IPX_H
)

146 
	#__UAPI_DEF_SOCKADDR_IPX
 0

	)

147 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 0

	)

148 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 0

	)

149 
	#__UAPI_DEF_IPX_CONFIG_DATA
 0

	)

150 
	#__UAPI_DEF_IPX_ROUTE_DEF
 0

	)

154 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

155 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

156 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

157 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

158 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

163 #i‡
deföed
(
_SYS_XATTR_H
)

164 
	#__UAPI_DEF_XATTR
 0

	)

166 
	#__UAPI_DEF_XATTR
 1

	)

176 #i‚de‡
__UAPI_DEF_IF_IFCONF


177 
	#__UAPI_DEF_IF_IFCONF
 1

	)

179 #i‚de‡
__UAPI_DEF_IF_IFMAP


180 
	#__UAPI_DEF_IF_IFMAP
 1

	)

182 #i‚de‡
__UAPI_DEF_IF_IFNAMSIZ


183 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

185 #i‚de‡
__UAPI_DEF_IF_IFREQ


186 
	#__UAPI_DEF_IF_IFREQ
 1

	)

189 #i‚de‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS


190 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

193 #i‚de‡
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


194 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

198 #i‚de‡
__UAPI_DEF_IN_ADDR


199 
	#__UAPI_DEF_IN_ADDR
 1

	)

201 #i‚de‡
__UAPI_DEF_IN_IPPROTO


202 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

204 #i‚de‡
__UAPI_DEF_IN_PKTINFO


205 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

207 #i‚de‡
__UAPI_DEF_IP_MREQ


208 
	#__UAPI_DEF_IP_MREQ
 1

	)

210 #i‚de‡
__UAPI_DEF_SOCKADDR_IN


211 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

213 #i‚de‡
__UAPI_DEF_IN_CLASS


214 
	#__UAPI_DEF_IN_CLASS
 1

	)

218 #i‚de‡
__UAPI_DEF_IN6_ADDR


219 
	#__UAPI_DEF_IN6_ADDR
 1

	)

221 #i‚de‡
__UAPI_DEF_IN6_ADDR_ALT


222 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

224 #i‚de‡
__UAPI_DEF_SOCKADDR_IN6


225 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

227 #i‚de‡
__UAPI_DEF_IPV6_MREQ


228 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

230 #i‚de‡
__UAPI_DEF_IPPROTO_V6


231 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

233 #i‚de‡
__UAPI_DEF_IPV6_OPTIONS


234 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

236 #i‚de‡
__UAPI_DEF_IN6_PKTINFO


237 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

239 #i‚de‡
__UAPI_DEF_IP6_MTUINFO


240 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

244 #i‚de‡
__UAPI_DEF_SOCKADDR_IPX


245 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

247 #i‚de‡
__UAPI_DEF_IPX_ROUTE_DEFINITION


248 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

250 #i‚de‡
__UAPI_DEF_IPX_INTERFACE_DEFINITION


251 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

253 #i‚de‡
__UAPI_DEF_IPX_CONFIG_DATA


254 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

256 #i‚de‡
__UAPI_DEF_IPX_ROUTE_DEF


257 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

261 #i‚de‡
__UAPI_DEF_XATTR


262 
	#__UAPI_DEF_XATTR
 1

	)

	@/usr/include/linux/netlink.h

2 #i‚de‡
__LINUX_NETLINK_H


3 
	#__LINUX_NETLINK_H


	)

5 
	~<löux/c⁄°.h
>

6 
	~<löux/sockë.h
>

7 
	~<löux/ty≥s.h
>

9 
	#NETLINK_ROUTE
 0

	)

10 
	#NETLINK_UNUSED
 1

	)

11 
	#NETLINK_USERSOCK
 2

	)

12 
	#NETLINK_FIREWALL
 3

	)

13 
	#NETLINK_SOCK_DIAG
 4

	)

14 
	#NETLINK_NFLOG
 5

	)

15 
	#NETLINK_XFRM
 6

	)

16 
	#NETLINK_SELINUX
 7

	)

17 
	#NETLINK_ISCSI
 8

	)

18 
	#NETLINK_AUDIT
 9

	)

19 
	#NETLINK_FIB_LOOKUP
 10

	)

20 
	#NETLINK_CONNECTOR
 11

	)

21 
	#NETLINK_NETFILTER
 12

	)

22 
	#NETLINK_IP6_FW
 13

	)

23 
	#NETLINK_DNRTMSG
 14

	)

24 
	#NETLINK_KOBJECT_UEVENT
 15

	)

25 
	#NETLINK_GENERIC
 16

	)

27 
	#NETLINK_SCSITRANSPORT
 18

	)

28 
	#NETLINK_ECRYPTFS
 19

	)

29 
	#NETLINK_RDMA
 20

	)

30 
	#NETLINK_CRYPTO
 21

	)

31 
	#NETLINK_SMC
 22

	)

33 
	#NETLINK_INET_DIAG
 
NETLINK_SOCK_DIAG


	)

35 
	#MAX_LINKS
 32

	)

37 
	ssockaddr_∆
 {

38 
__kî√l_ß_Ámûy_t
 
	m∆_Ámûy
;

39 
	m∆_∑d
;

40 
__u32
 
	m∆_pid
;

41 
__u32
 
	m∆_groups
;

44 
	s∆msghdr
 {

45 
__u32
 
	m∆msg_Àn
;

46 
__u16
 
	m∆msg_ty≥
;

47 
__u16
 
	m∆msg_Êags
;

48 
__u32
 
	m∆msg_£q
;

49 
__u32
 
	m∆msg_pid
;

54 
	#NLM_F_REQUEST
 0x01

	)

55 
	#NLM_F_MULTI
 0x02

	)

56 
	#NLM_F_ACK
 0x04

	)

57 
	#NLM_F_ECHO
 0x08

	)

58 
	#NLM_F_DUMP_INTR
 0x10

	)

59 
	#NLM_F_DUMP_FILTERED
 0x20

	)

62 
	#NLM_F_ROOT
 0x100

	)

63 
	#NLM_F_MATCH
 0x200

	)

64 
	#NLM_F_ATOMIC
 0x400

	)

65 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

68 
	#NLM_F_REPLACE
 0x100

	)

69 
	#NLM_F_EXCL
 0x200

	)

70 
	#NLM_F_CREATE
 0x400

	)

71 
	#NLM_F_APPEND
 0x800

	)

74 
	#NLM_F_NONREC
 0x100

	)

77 
	#NLM_F_CAPPED
 0x100

	)

78 
	#NLM_F_ACK_TLVS
 0x200

	)

89 
	#NLMSG_ALIGNTO
 4U

	)

90 
	#NLMSG_ALIGN
(
Àn
Ë–(÷í)+
NLMSG_ALIGNTO
-1Ë& ~(NLMSG_ALIGNTO-1Ë)

	)

91 
	#NLMSG_HDRLEN
 ((Ë
	`NLMSG_ALIGN
((
∆msghdr
)))

	)

92 
	#NLMSG_LENGTH
(
Àn
Ë(÷íË+ 
NLMSG_HDRLEN
)

	)

93 
	#NLMSG_SPACE
(
Àn
Ë
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
÷í))

	)

94 
	#NLMSG_DATA
(
∆h
Ë((*)(((*ÍlhË+ 
	`NLMSG_LENGTH
(0)))

	)

95 
	#NLMSG_NEXT
(
∆h
,
Àn
Ë(÷íË-
	`NLMSG_ALIGN
(“lh)->
∆msg_Àn
), \

96 (
∆msghdr
*)(((*)(
∆h
)Ë+ 
	`NLMSG_ALIGN
(“lh)->
∆msg_Àn
)))

	)

97 
	#NLMSG_OK
(
∆h
,
Àn
Ë(÷íË>()(
∆msghdr
) && \

98 (
∆h
)->
∆msg_Àn
 >(
∆msghdr
) && \

99 (
∆h
)->
∆msg_Àn
 <(
Àn
))

	)

100 
	#NLMSG_PAYLOAD
(
∆h
,
Àn
Ë(“lh)->
∆msg_Àn
 - 
	`NLMSG_SPACE
(÷í)))

	)

102 
	#NLMSG_NOOP
 0x1

	)

103 
	#NLMSG_ERROR
 0x2

	)

104 
	#NLMSG_DONE
 0x3

	)

105 
	#NLMSG_OVERRUN
 0x4

	)

107 
	#NLMSG_MIN_TYPE
 0x10

	)

109 
	s∆msgîr
 {

110 
	mîr‹
;

111 
∆msghdr
 
	mmsg
;

135 
	e∆msgîr_©ås
 {

136 
	mNLMSGERR_ATTR_UNUSED
,

137 
	mNLMSGERR_ATTR_MSG
,

138 
	mNLMSGERR_ATTR_OFFS
,

139 
	mNLMSGERR_ATTR_COOKIE
,

141 
	m__NLMSGERR_ATTR_MAX
,

142 
	mNLMSGERR_ATTR_MAX
 = 
__NLMSGERR_ATTR_MAX
 - 1

145 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

146 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

147 
	#NETLINK_PKTINFO
 3

	)

148 
	#NETLINK_BROADCAST_ERROR
 4

	)

149 
	#NETLINK_NO_ENOBUFS
 5

	)

150 
	#NETLINK_RX_RING
 6

	)

151 
	#NETLINK_TX_RING
 7

	)

152 
	#NETLINK_LISTEN_ALL_NSID
 8

	)

153 
	#NETLINK_LIST_MEMBERSHIPS
 9

	)

154 
	#NETLINK_CAP_ACK
 10

	)

155 
	#NETLINK_EXT_ACK
 11

	)

156 
	#NETLINK_GET_STRICT_CHK
 12

	)

158 
	s∆_pktöfo
 {

159 
__u32
 
	mgroup
;

162 
	s∆_mm≠_ªq
 {

163 
	mnm_block_size
;

164 
	mnm_block_ƒ
;

165 
	mnm_‰ame_size
;

166 
	mnm_‰ame_ƒ
;

169 
	s∆_mm≠_hdr
 {

170 
	mnm_°©us
;

171 
	mnm_Àn
;

172 
__u32
 
	mnm_group
;

174 
__u32
 
	mnm_pid
;

175 
__u32
 
	mnm_uid
;

176 
__u32
 
	mnm_gid
;

179 
	e∆_mm≠_°©us
 {

180 
	mNL_MMAP_STATUS_UNUSED
,

181 
	mNL_MMAP_STATUS_RESERVED
,

182 
	mNL_MMAP_STATUS_VALID
,

183 
	mNL_MMAP_STATUS_COPY
,

184 
	mNL_MMAP_STATUS_SKIP
,

187 
	#NL_MMAP_MSG_ALIGNMENT
 
NLMSG_ALIGNTO


	)

188 
	#NL_MMAP_MSG_ALIGN
(
sz
Ë
	`__ALIGN_KERNEL
(sz, 
NL_MMAP_MSG_ALIGNMENT
)

	)

189 
	#NL_MMAP_HDRLEN
 
	`NL_MMAP_MSG_ALIGN
((
∆_mm≠_hdr
))

	)

191 
	#NET_MAJOR
 36

	)

194 
	mNETLINK_UNCONNECTED
 = 0,

195 
	mNETLINK_CONNECTED
,

207 
	s∆©å
 {

208 
__u16
 
	m∆a_Àn
;

209 
__u16
 
	m∆a_ty≥
;

222 
	#NLA_F_NESTED
 (1 << 15)

	)

223 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

224 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

226 
	#NLA_ALIGNTO
 4

	)

227 
	#NLA_ALIGN
(
Àn
Ë((÷íË+ 
NLA_ALIGNTO
 - 1Ë& ~(NLA_ALIGNTO - 1))

	)

228 
	#NLA_HDRLEN
 ((Ë
	`NLA_ALIGN
((
∆©å
)))

	)

243 
	s∆a_bôfõld32
 {

244 
__u32
 
	mvÆue
;

245 
__u32
 
	m£À˘‹
;

	@/usr/include/linux/socket.h

2 #i‚de‡
_LINUX_SOCKET_H


3 
	#_LINUX_SOCKET_H


	)

8 
	#_K_SS_MAXSIZE
 128

	)

10 
	t__kî√l_ß_Ámûy_t
;

16 
	s__kî√l_sockaddr_°‹age
 {

19 
__kî√l_ß_Ámûy_t
 
	mss_Ámûy
;

21 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

25 *
	m__Æign
;

	@/usr/include/sys/socket.h

19 #i‚def 
_SYS_SOCKET_H


20 
	#_SYS_SOCKET_H
 1

	)

22 
	~<„©uªs.h
>

24 
	g__BEGIN_DECLS


26 
	~<bôs/ty≥s/°ru˘_iovec.h
>

27 
	#__√ed_size_t


	)

28 
	~<°ddef.h
>

33 
	~<bôs/sockë.h
>

35 #ifde‡
__USE_MISC


36 
	~<bôs/ty≥s/°ru˘_osockaddr.h
>

43 
	mSHUT_RD
 = 0,

44 
	#SHUT_RD
 
SHUT_RD


	)

45 
	mSHUT_WR
,

46 
	#SHUT_WR
 
SHUT_WR


	)

47 
	mSHUT_RDWR


48 
	#SHUT_RDWR
 
SHUT_RDWR


	)

57 #i‡
deföed
 
__˝lu•lus
 || !
__GNUC_PREREQ
 (2, 7Ë|| !deföed 
__USE_GNU


58 
	#__SOCKADDR_ARG
 
sockaddr
 *
__ª°ri˘


	)

59 
	#__CONST_SOCKADDR_ARG
 c⁄° 
sockaddr
 *

	)

63 
	#__SOCKADDR_ALLTYPES
 \

64 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

65 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

66 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

67 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

68 
	`__SOCKADDR_ONETYPE
 (
sockaddr_e⁄
) \

69 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö
) \

70 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö6
) \

71 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö¨p
) \

72 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ùx
) \

73 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

74 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

75 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

76 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

78 
	#__SOCKADDR_ONETYPE
(
ty≥
Ëty≥ *
__ª°ri˘
 
__
##ty≥##__;

	)

79 uni⁄ { 
	m__SOCKADDR_ALLTYPES


80 } 
	t__SOCKADDR_ARG
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

81 #unde‡
__SOCKADDR_ONETYPE


82 
	#__SOCKADDR_ONETYPE
(
ty≥
Ëc⁄° ty≥ *
__ª°ri˘
 
__
##ty≥##__;

	)

83 uni⁄ { 
	m__SOCKADDR_ALLTYPES


84 } 
	t__CONST_SOCKADDR_ARG
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

85 #unde‡
__SOCKADDR_ONETYPE


88 #ifde‡
__USE_GNU


90 
	smmsghdr


92 
msghdr
 
	mmsg_hdr
;

93 
	mmsg_Àn
;

102 
	$sockë
 (
__domaö
, 
__ty≥
, 
__¥Ÿocﬁ
Ë
__THROW
;

108 
	$sockë∑ú
 (
__domaö
, 
__ty≥
, 
__¥Ÿocﬁ
,

109 
__fds
[2]Ë
__THROW
;

112 
	$böd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 
__Àn
)

113 
__THROW
;

116 
	$gësock«me
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

117 
sockÀn_t
 *
__ª°ri˘
 
__Àn
Ë
__THROW
;

126 
	`c⁄√˘
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 
__Àn
);

130 
	$gë≥î«me
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

131 
sockÀn_t
 *
__ª°ri˘
 
__Àn
Ë
__THROW
;

138 
ssize_t
 
	`£nd
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
, 
__Êags
);

145 
ssize_t
 
	`ªcv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__Êags
);

152 
ssize_t
 
	`£ndto
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

153 
__Êags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

154 
sockÀn_t
 
__addr_Àn
);

163 
ssize_t
 
	`ªcv‰om
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

164 
__Êags
, 
__SOCKADDR_ARG
 
__addr
,

165 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

173 
ssize_t
 
	`£ndmsg
 (
__fd
, c⁄° 
msghdr
 *
__mesßge
,

174 
__Êags
);

176 #ifde‡
__USE_GNU


182 
	`£ndmmsg
 (
__fd
, 
mmsghdr
 *
__vmesßges
,

183 
__vÀn
, 
__Êags
);

191 
ssize_t
 
	`ªcvmsg
 (
__fd
, 
msghdr
 *
__mesßge
, 
__Êags
);

193 #ifde‡
__USE_GNU


199 
	`ªcvmmsg
 (
__fd
, 
mmsghdr
 *
__vmesßges
,

200 
__vÀn
, 
__Êags
,

201 
time•ec
 *
__tmo
);

208 
	$gësock›t
 (
__fd
, 
__Àvñ
, 
__›äame
,

209 *
__ª°ri˘
 
__›tvÆ
,

210 
sockÀn_t
 *
__ª°ri˘
 
__›éí
Ë
__THROW
;

215 
	$£tsock›t
 (
__fd
, 
__Àvñ
, 
__›äame
,

216 c⁄° *
__›tvÆ
, 
sockÀn_t
 
__›éí
Ë
__THROW
;

222 
	$li°í
 (
__fd
, 
__n
Ë
__THROW
;

232 
	`ac˚±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

233 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

235 #ifde‡
__USE_GNU


240 
	`ac˚±4
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

241 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
, 
__Êags
);

250 
	$shutdown
 (
__fd
, 
__how
Ë
__THROW
;

253 #ifde‡
__USE_XOPEN2K


255 
	$sock©m¨k
 (
__fd
Ë
__THROW
;

259 #ifde‡
__USE_MISC


263 
	$isfdty≥
 (
__fd
, 
__fdty≥
Ë
__THROW
;

268 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


269 
	~<bôs/sockë2.h
>

272 
__END_DECLS


	@/usr/include/asm-generic/int-ll64.h

9 #i‚de‡
_ASM_GENERIC_INT_LL64_H


10 
	#_ASM_GENERIC_INT_LL64_H


	)

12 
	~<asm/bô•îl⁄g.h
>

14 #i‚de‡
__ASSEMBLY__


20 
__sig√d__
 
	t__s8
;

21 
	t__u8
;

23 
__sig√d__
 
	t__s16
;

24 
	t__u16
;

26 
__sig√d__
 
	t__s32
;

27 
	t__u32
;

29 #ifde‡
__GNUC__


30 
__exãnsi⁄__
 
__sig√d__
 
	t__s64
;

31 
__exãnsi⁄__
 
	t__u64
;

33 
__sig√d__
 
	t__s64
;

34 
	t__u64
;

	@/usr/include/asm-generic/ioctl.h

2 #i‚de‡
_ASM_GENERIC_IOCTL_H


3 
	#_ASM_GENERIC_IOCTL_H


	)

23 
	#_IOC_NRBITS
 8

	)

24 
	#_IOC_TYPEBITS
 8

	)

31 #i‚de‡
_IOC_SIZEBITS


32 
	#_IOC_SIZEBITS
 14

	)

35 #i‚de‡
_IOC_DIRBITS


36 
	#_IOC_DIRBITS
 2

	)

39 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

40 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

41 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

42 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

44 
	#_IOC_NRSHIFT
 0

	)

45 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

46 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

47 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

57 #i‚de‡
_IOC_NONE


58 
	#_IOC_NONE
 0U

	)

61 #i‚de‡
_IOC_WRITE


62 
	#_IOC_WRITE
 1U

	)

65 #i‚de‡
_IOC_READ


66 
	#_IOC_READ
 2U

	)

69 
	#_IOC
(
dú
,
ty≥
,
ƒ
,
size
) \

70 (((
dú
Ë<< 
_IOC_DIRSHIFT
) | \

71 ((
ty≥
Ë<< 
_IOC_TYPESHIFT
) | \

72 ((
ƒ
Ë<< 
_IOC_NRSHIFT
) | \

73 ((
size
Ë<< 
_IOC_SIZESHIFT
))

	)

75 
	#_IOC_TYPECHECK
(
t
Ë(—))

	)

83 
	#_IO
(
ty≥
,
ƒ
Ë
	`_IOC
(
_IOC_NONE
,—y≥),“r),0)

	)

84 
	#_IOR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

85 
	#_IOW
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

86 
	#_IOWR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

87 
	#_IOR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(size))

	)

88 
	#_IOW_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(size))

	)

89 
	#_IOWR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(size))

	)

92 
	#_IOC_DIR
(
ƒ
Ë((“rË>> 
_IOC_DIRSHIFT
Ë& 
_IOC_DIRMASK
)

	)

93 
	#_IOC_TYPE
(
ƒ
Ë((“rË>> 
_IOC_TYPESHIFT
Ë& 
_IOC_TYPEMASK
)

	)

94 
	#_IOC_NR
(
ƒ
Ë((“rË>> 
_IOC_NRSHIFT
Ë& 
_IOC_NRMASK
)

	)

95 
	#_IOC_SIZE
(
ƒ
Ë((“rË>> 
_IOC_SIZESHIFT
Ë& 
_IOC_SIZEMASK
)

	)

99 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

100 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

101 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
Ë<< 
_IOC_DIRSHIFT
)

	)

102 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

103 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm/posix_types_32.h

2 #i‚de‡
_ASM_X86_POSIX_TYPES_32_H


3 
	#_ASM_X86_POSIX_TYPES_32_H


	)

11 
	t__kî√l_mode_t
;

12 
	#__kî√l_mode_t
 
__kî√l_mode_t


	)

14 
	t__kî√l_ùc_pid_t
;

15 
	#__kî√l_ùc_pid_t
 
__kî√l_ùc_pid_t


	)

17 
	t__kî√l_uid_t
;

18 
	t__kî√l_gid_t
;

19 
	#__kî√l_uid_t
 
__kî√l_uid_t


	)

21 
	t__kî√l_ﬁd_dev_t
;

22 
	#__kî√l_ﬁd_dev_t
 
__kî√l_ﬁd_dev_t


	)

24 
	~<asm-gíîic/posix_ty≥s.h
>

	@/usr/include/asm/posix_types_64.h

2 #i‚de‡
_ASM_X86_POSIX_TYPES_64_H


3 
	#_ASM_X86_POSIX_TYPES_64_H


	)

11 
	t__kî√l_ﬁd_uid_t
;

12 
	t__kî√l_ﬁd_gid_t
;

13 
	#__kî√l_ﬁd_uid_t
 
__kî√l_ﬁd_uid_t


	)

15 
	t__kî√l_ﬁd_dev_t
;

16 
	#__kî√l_ﬁd_dev_t
 
__kî√l_ﬁd_dev_t


	)

18 
	~<asm-gíîic/posix_ty≥s.h
>

	@/usr/include/asm/posix_types_x32.h

2 #i‚de‡
_ASM_X86_POSIX_TYPES_X32_H


3 
	#_ASM_X86_POSIX_TYPES_X32_H


	)

14 
	t__kî√l_l⁄g_t
;

15 
	t__kî√l_ul⁄g_t
;

16 
	#__kî√l_l⁄g_t
 
__kî√l_l⁄g_t


	)

18 
	~<asm/posix_ty≥s_64.h
>

	@/usr/include/bits/local_lim.h

24 #i‚de‡
NR_OPEN


25 
	#__undef_NR_OPEN


	)

27 #i‚de‡
LINK_MAX


28 
	#__undef_LINK_MAX


	)

30 #i‚de‡
OPEN_MAX


31 
	#__undef_OPEN_MAX


	)

33 #i‚de‡
ARG_MAX


34 
	#__undef_ARG_MAX


	)

38 
	~<löux/limôs.h
>

41 #ifde‡
__undef_NR_OPEN


42 #unde‡
NR_OPEN


43 #unde‡
__undef_NR_OPEN


46 #ifde‡
__undef_LINK_MAX


47 #unde‡
LINK_MAX


48 #unde‡
__undef_LINK_MAX


51 #ifde‡
__undef_OPEN_MAX


52 #unde‡
OPEN_MAX


53 #unde‡
__undef_OPEN_MAX


56 #ifde‡
__undef_ARG_MAX


57 #unde‡
ARG_MAX


58 #unde‡
__undef_ARG_MAX


62 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

64 
	#PTHREAD_KEYS_MAX
 1024

	)

67 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

69 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

72 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

74 #unde‡
PTHREAD_THREADS_MAX


78 
	#AIO_PRIO_DELTA_MAX
 20

	)

81 
	#PTHREAD_STACK_MIN
 16384

	)

84 
	#DELAYTIMER_MAX
 2147483647

	)

87 
	#TTY_NAME_MAX
 32

	)

90 
	#LOGIN_NAME_MAX
 256

	)

93 
	#HOST_NAME_MAX
 64

	)

96 
	#MQ_PRIO_MAX
 32768

	)

99 
	#SEM_VALUE_MAX
 (2147483647)

	)

	@/usr/include/bits/socket.h

19 #i‚de‡
__BITS_SOCKET_H


20 
	#__BITS_SOCKET_H


	)

22 #i‚de‡
_SYS_SOCKET_H


26 
	#__√ed_size_t


	)

27 
	~<°ddef.h
>

29 
	~<sys/ty≥s.h
>

32 #i‚de‡
__sockÀn_t_deföed


33 
__sockÀn_t
 
	tsockÀn_t
;

34 
	#__sockÀn_t_deföed


	)

38 
	~<bôs/sockë_ty≥.h
>

41 
	#PF_UNSPEC
 0

	)

42 
	#PF_LOCAL
 1

	)

43 
	#PF_UNIX
 
PF_LOCAL


	)

44 
	#PF_FILE
 
PF_LOCAL


	)

45 
	#PF_INET
 2

	)

46 
	#PF_AX25
 3

	)

47 
	#PF_IPX
 4

	)

48 
	#PF_APPLETALK
 5

	)

49 
	#PF_NETROM
 6

	)

50 
	#PF_BRIDGE
 7

	)

51 
	#PF_ATMPVC
 8

	)

52 
	#PF_X25
 9

	)

53 
	#PF_INET6
 10

	)

54 
	#PF_ROSE
 11

	)

55 
	#PF_DEC√t
 12

	)

56 
	#PF_NETBEUI
 13

	)

57 
	#PF_SECURITY
 14

	)

58 
	#PF_KEY
 15

	)

59 
	#PF_NETLINK
 16

	)

60 
	#PF_ROUTE
 
PF_NETLINK


	)

61 
	#PF_PACKET
 17

	)

62 
	#PF_ASH
 18

	)

63 
	#PF_ECONET
 19

	)

64 
	#PF_ATMSVC
 20

	)

65 
	#PF_RDS
 21

	)

66 
	#PF_SNA
 22

	)

67 
	#PF_IRDA
 23

	)

68 
	#PF_PPPOX
 24

	)

69 
	#PF_WANPIPE
 25

	)

70 
	#PF_LLC
 26

	)

71 
	#PF_IB
 27

	)

72 
	#PF_MPLS
 28

	)

73 
	#PF_CAN
 29

	)

74 
	#PF_TIPC
 30

	)

75 
	#PF_BLUETOOTH
 31

	)

76 
	#PF_IUCV
 32

	)

77 
	#PF_RXRPC
 33

	)

78 
	#PF_ISDN
 34

	)

79 
	#PF_PHONET
 35

	)

80 
	#PF_IEEE802154
 36

	)

81 
	#PF_CAIF
 37

	)

82 
	#PF_ALG
 38

	)

83 
	#PF_NFC
 39

	)

84 
	#PF_VSOCK
 40

	)

85 
	#PF_KCM
 41

	)

86 
	#PF_QIPCRTR
 42

	)

87 
	#PF_SMC
 43

	)

88 
	#PF_XDP
 44

	)

89 
	#PF_MAX
 45

	)

92 
	#AF_UNSPEC
 
PF_UNSPEC


	)

93 
	#AF_LOCAL
 
PF_LOCAL


	)

94 
	#AF_UNIX
 
PF_UNIX


	)

95 
	#AF_FILE
 
PF_FILE


	)

96 
	#AF_INET
 
PF_INET


	)

97 
	#AF_AX25
 
PF_AX25


	)

98 
	#AF_IPX
 
PF_IPX


	)

99 
	#AF_APPLETALK
 
PF_APPLETALK


	)

100 
	#AF_NETROM
 
PF_NETROM


	)

101 
	#AF_BRIDGE
 
PF_BRIDGE


	)

102 
	#AF_ATMPVC
 
PF_ATMPVC


	)

103 
	#AF_X25
 
PF_X25


	)

104 
	#AF_INET6
 
PF_INET6


	)

105 
	#AF_ROSE
 
PF_ROSE


	)

106 
	#AF_DEC√t
 
PF_DEC√t


	)

107 
	#AF_NETBEUI
 
PF_NETBEUI


	)

108 
	#AF_SECURITY
 
PF_SECURITY


	)

109 
	#AF_KEY
 
PF_KEY


	)

110 
	#AF_NETLINK
 
PF_NETLINK


	)

111 
	#AF_ROUTE
 
PF_ROUTE


	)

112 
	#AF_PACKET
 
PF_PACKET


	)

113 
	#AF_ASH
 
PF_ASH


	)

114 
	#AF_ECONET
 
PF_ECONET


	)

115 
	#AF_ATMSVC
 
PF_ATMSVC


	)

116 
	#AF_RDS
 
PF_RDS


	)

117 
	#AF_SNA
 
PF_SNA


	)

118 
	#AF_IRDA
 
PF_IRDA


	)

119 
	#AF_PPPOX
 
PF_PPPOX


	)

120 
	#AF_WANPIPE
 
PF_WANPIPE


	)

121 
	#AF_LLC
 
PF_LLC


	)

122 
	#AF_IB
 
PF_IB


	)

123 
	#AF_MPLS
 
PF_MPLS


	)

124 
	#AF_CAN
 
PF_CAN


	)

125 
	#AF_TIPC
 
PF_TIPC


	)

126 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

127 
	#AF_IUCV
 
PF_IUCV


	)

128 
	#AF_RXRPC
 
PF_RXRPC


	)

129 
	#AF_ISDN
 
PF_ISDN


	)

130 
	#AF_PHONET
 
PF_PHONET


	)

131 
	#AF_IEEE802154
 
PF_IEEE802154


	)

132 
	#AF_CAIF
 
PF_CAIF


	)

133 
	#AF_ALG
 
PF_ALG


	)

134 
	#AF_NFC
 
PF_NFC


	)

135 
	#AF_VSOCK
 
PF_VSOCK


	)

136 
	#AF_KCM
 
PF_KCM


	)

137 
	#AF_QIPCRTR
 
PF_QIPCRTR


	)

138 
	#AF_SMC
 
PF_SMC


	)

139 
	#AF_XDP
 
PF_XDP


	)

140 
	#AF_MAX
 
PF_MAX


	)

146 
	#SOL_RAW
 255

	)

147 
	#SOL_DECNET
 261

	)

148 
	#SOL_X25
 262

	)

149 
	#SOL_PACKET
 263

	)

150 
	#SOL_ATM
 264

	)

151 
	#SOL_AAL
 265

	)

152 
	#SOL_IRDA
 266

	)

153 
	#SOL_NETBEUI
 267

	)

154 
	#SOL_LLC
 268

	)

155 
	#SOL_DCCP
 269

	)

156 
	#SOL_NETLINK
 270

	)

157 
	#SOL_TIPC
 271

	)

158 
	#SOL_RXRPC
 272

	)

159 
	#SOL_PPPOL2TP
 273

	)

160 
	#SOL_BLUETOOTH
 274

	)

161 
	#SOL_PNPIPE
 275

	)

162 
	#SOL_RDS
 276

	)

163 
	#SOL_IUCV
 277

	)

164 
	#SOL_CAIF
 278

	)

165 
	#SOL_ALG
 279

	)

166 
	#SOL_NFC
 280

	)

167 
	#SOL_KCM
 281

	)

168 
	#SOL_TLS
 282

	)

169 
	#SOL_XDP
 283

	)

172 
	#SOMAXCONN
 4096

	)

175 
	~<bôs/sockaddr.h
>

178 
	ssockaddr


180 
__SOCKADDR_COMMON
 (
ß_
);

181 
	mß_d©a
[14];

187 
	#__ss_Æig¡y≥
 

	)

188 
	#_SS_PADSIZE
 \

189 (
_SS_SIZE
 - 
__SOCKADDR_COMMON_SIZE
 -  (
__ss_Æig¡y≥
))

	)

191 
	ssockaddr_°‹age


193 
__SOCKADDR_COMMON
 (
ss_
);

194 
	m__ss_∑ddög
[
_SS_PADSIZE
];

195 
__ss_Æig¡y≥
 
	m__ss_Æign
;

202 
	mMSG_OOB
 = 0x01,

203 
	#MSG_OOB
 
MSG_OOB


	)

204 
	mMSG_PEEK
 = 0x02,

205 
	#MSG_PEEK
 
MSG_PEEK


	)

206 
	mMSG_DONTROUTE
 = 0x04,

207 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

208 #ifde‡
__USE_GNU


210 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

211 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

213 
	mMSG_CTRUNC
 = 0x08,

214 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

215 
	mMSG_PROXY
 = 0x10,

216 
	#MSG_PROXY
 
MSG_PROXY


	)

217 
	mMSG_TRUNC
 = 0x20,

218 
	#MSG_TRUNC
 
MSG_TRUNC


	)

219 
	mMSG_DONTWAIT
 = 0x40,

220 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

221 
	mMSG_EOR
 = 0x80,

222 
	#MSG_EOR
 
MSG_EOR


	)

223 
	mMSG_WAITALL
 = 0x100,

224 
	#MSG_WAITALL
 
MSG_WAITALL


	)

225 
	mMSG_FIN
 = 0x200,

226 
	#MSG_FIN
 
MSG_FIN


	)

227 
	mMSG_SYN
 = 0x400,

228 
	#MSG_SYN
 
MSG_SYN


	)

229 
	mMSG_CONFIRM
 = 0x800,

230 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

231 
	mMSG_RST
 = 0x1000,

232 
	#MSG_RST
 
MSG_RST


	)

233 
	mMSG_ERRQUEUE
 = 0x2000,

234 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

235 
	mMSG_NOSIGNAL
 = 0x4000,

236 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

237 
	mMSG_MORE
 = 0x8000,

238 
	#MSG_MORE
 
MSG_MORE


	)

239 
	mMSG_WAITFORONE
 = 0x10000,

240 
	#MSG_WAITFORONE
 
MSG_WAITFORONE


	)

241 
	mMSG_BATCH
 = 0x40000,

242 
	#MSG_BATCH
 
MSG_BATCH


	)

243 
	mMSG_ZEROCOPY
 = 0x4000000,

244 
	#MSG_ZEROCOPY
 
MSG_ZEROCOPY


	)

245 
	mMSG_FASTOPEN
 = 0x20000000,

246 
	#MSG_FASTOPEN
 
MSG_FASTOPEN


	)

248 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

251 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

257 
	smsghdr


259 *
	mmsg_«me
;

260 
sockÀn_t
 
	mmsg_«mñí
;

262 
iovec
 *
	mmsg_iov
;

263 
size_t
 
	mmsg_iovÀn
;

265 *
	mmsg_c⁄åﬁ
;

266 
size_t
 
	mmsg_c⁄åﬁÀn
;

271 
	mmsg_Êags
;

275 
	scmsghdr


277 
size_t
 
	mcmsg_Àn
;

282 
	mcmsg_Àvñ
;

283 
	mcmsg_ty≥
;

284 #i‡
__glibc_c99_Êex¨r_avaûabÀ


285 
__exãnsi⁄__
 
__cmsg_d©a
 
	m__Êex¨r
;

290 #i‡
__glibc_c99_Êex¨r_avaûabÀ


291 
	#CMSG_DATA
(
cmsg
Ë((cmsg)->
__cmsg_d©a
)

	)

293 
	#CMSG_DATA
(
cmsg
Ë((*Ë((
cmsghdr
 *Ë(cmsgË+ 1))

	)

295 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
Ë
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

296 
	#CMSG_FIRSTHDR
(
mhdr
) \

297 ((
size_t
Ë(
mhdr
)->
msg_c⁄åﬁÀn
 > (
cmsghdr
) \

298 ? (
cmsghdr
 *Ë(
mhdr
)->
msg_c⁄åﬁ
 : (cmsghd∏*Ë0)

	)

299 
	#CMSG_ALIGN
(
Àn
Ë((÷íË+  (
size_t
) - 1) \

300 & (
size_t
Ë~( (size_tË- 1))

	)

301 
	#CMSG_SPACE
(
Àn
Ë(
	`CMSG_ALIGN
 (len) \

302 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

303 
	#CMSG_LEN
(
Àn
Ë(
	`CMSG_ALIGN
 ( (
cmsghdr
)Ë+ (Àn))

	)

305 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

306 
cmsghdr
 *
__cmsg
Ë
__THROW
;

307 #ifde‡
__USE_EXTERN_INLINES


308 #i‚de‡
_EXTERN_INLINE


309 
	#_EXTERN_INLINE
 
__exã∫_ölöe


	)

311 
_EXTERN_INLINE
 
cmsghdr
 *

312 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

314 i‡((
size_t
Ë
__cmsg
->
cmsg_Àn
 <  (
cmsghdr
))

316  (
cmsghdr
 *) 0;

318 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

319 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Àn
));

320 i‡((*Ë(
__cmsg
 + 1Ë> ((*Ë
__mhdr
->
msg_c⁄åﬁ


321 + 
__mhdr
->
msg_c⁄åﬁÀn
)

322 || ((*Ë
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Àn
)

323 > ((*Ë
__mhdr
->
msg_c⁄åﬁ
 + __mhdr->
msg_c⁄åﬁÀn
)))

325  (
cmsghdr
 *) 0;

326  
__cmsg
;

327 
	}
}

334 
	mSCM_RIGHTS
 = 0x01

335 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

336 #ifde‡
__USE_GNU


337 , 
	mSCM_CREDENTIALS
 = 0x02

338 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

342 #ifde‡
__USE_GNU


344 
	su¸ed


346 
pid_t
 
	mpid
;

347 
uid_t
 
	muid
;

348 
gid_t
 
	mgid
;

352 #ifde‡
__USE_MISC


353 
	~<bôs/ty≥s/time_t.h
>

354 
	~<asm/sockë.h
>

356 
	#SO_DEBUG
 1

	)

357 
	~<bôs/sockë-c⁄°™ts.h
>

361 
	slögî


363 
	ml_⁄off
;

364 
	ml_lögî
;

	@/usr/include/bits/socket2.h

19 #i‚de‡
_SYS_SOCKET_H


23 
ssize_t
 
__ªcv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_à
__buÊí
,

24 
__Êags
);

25 
ssize_t
 
__REDIRECT
 (
__ªcv_Æüs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

26 
__Êags
), 
ªcv
);

27 
ssize_t
 
__REDIRECT
 (
__ªcv_chk_w¨n
,

28 (
__fd
, *
__buf
, 
size_t
 
__n
, size_à
__buÊí
,

29 
__Êags
), 
__ªcv_chk
)

30 
__w¨«âr
 ("recv called with biggerÜengthÅhan size of destination "

33 
__f‹tify_fun˘i⁄
 
ssize_t


34 
	$ªcv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__Êags
)

36 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

38 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

39  
	`__ªcv_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
);

41 i‡(
__n
 > 
	`__bos0
 (
__buf
))

42  
	`__ªcv_chk_w¨n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
);

44  
	`__ªcv_Æüs
 (
__fd
, 
__buf
, 
__n
, 
__Êags
);

45 
	}
}

47 
ssize_t
 
__ªcv‰om_chk
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

48 
size_t
 
__buÊí
, 
__Êags
,

49 
__SOCKADDR_ARG
 
__addr
,

50 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

51 
ssize_t
 
__REDIRECT
 (
__ªcv‰om_Æüs
,

52 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

53 
__Êags
, 
__SOCKADDR_ARG
 
__addr
,

54 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
), 
ªcv‰om
);

55 
ssize_t
 
__REDIRECT
 (
__ªcv‰om_chk_w¨n
,

56 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

57 
size_t
 
__buÊí
, 
__Êags
,

58 
__SOCKADDR_ARG
 
__addr
,

59 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
), 
__ªcv‰om_chk
)

60 
__w¨«âr
 ("recvfrom called with biggerÜengthÅhan size of "

63 
__f‹tify_fun˘i⁄
 
ssize_t


64 
	$ªcv‰om
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
, 
__Êags
,

65 
__SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
)

67 i‡(
	`__bos0
 (
__buf
Ë!(
size_t
) -1)

69 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

70  
	`__ªcv‰om_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
,

71 
__addr
, 
__addr_Àn
);

72 i‡(
__n
 > 
	`__bos0
 (
__buf
))

73  
	`__ªcv‰om_chk_w¨n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__Êags
,

74 
__addr
, 
__addr_Àn
);

76  
	`__ªcv‰om_Æüs
 (
__fd
, 
__buf
, 
__n
, 
__Êags
, 
__addr
, 
__addr_Àn
);

77 
	}
}

	@/usr/include/bits/types/struct_iovec.h

19 #i‚de‡
__iovec_deföed


20 
	#__iovec_deföed
 1

	)

22 
	#__√ed_size_t


	)

23 
	~<°ddef.h
>

26 
	siovec


28 *
	miov_ba£
;

29 
size_t
 
	miov_Àn
;

	@/usr/include/bits/types/struct_osockaddr.h

1 #i‚de‡
__osockaddr_deföed


2 
	#__osockaddr_deföed
 1

	)

6 
	sosockaddr


8 
	mß_Ámûy
;

9 
	mß_d©a
[14];

	@/usr/include/bits/uio_lim.h

19 #i‚de‡
_BITS_UIO_LIM_H


20 
	#_BITS_UIO_LIM_H
 1

	)

30 
	#__IOV_MAX
 1024

	)

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

120 #unde‡
__USE_ISOC11


121 #unde‡
__USE_ISOC99


122 #unde‡
__USE_ISOC95


123 #unde‡
__USE_ISOCXX11


124 #unde‡
__USE_POSIX


125 #unde‡
__USE_POSIX2


126 #unde‡
__USE_POSIX199309


127 #unde‡
__USE_POSIX199506


128 #unde‡
__USE_XOPEN


129 #unde‡
__USE_XOPEN_EXTENDED


130 #unde‡
__USE_UNIX98


131 #unde‡
__USE_XOPEN2K


132 #unde‡
__USE_XOPEN2KXSI


133 #unde‡
__USE_XOPEN2K8


134 #unde‡
__USE_XOPEN2K8XSI


135 #unde‡
__USE_LARGEFILE


136 #unde‡
__USE_LARGEFILE64


137 #unde‡
__USE_FILE_OFFSET64


138 #unde‡
__USE_MISC


139 #unde‡
__USE_ATFILE


140 #unde‡
__USE_GNU


141 #unde‡
__USE_FORTIFY_LEVEL


142 #unde‡
__KERNEL_STRICT_NAMES


143 #unde‡
__GLIBC_USE_ISOC2X


144 #unde‡
__GLIBC_USE_DEPRECATED_GETS


145 #unde‡
__GLIBC_USE_DEPRECATED_SCANF


149 #i‚de‡
_LOOSE_KERNEL_NAMES


150 
	#__KERNEL_STRICT_NAMES


	)

160 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


161 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

162 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

164 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

171 #i‡
deföed
 
__˛™g_maj‹__
 && deföed 
__˛™g_mö‹__


172 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
) \

173 ((
__˛™g_maj‹__
 << 16Ë+ 
__˛™g_mö‹__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

175 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
Ë0

	)

179 
	#__GLIBC_USE
(
F
Ë
__GLIBC_USE_
 ## 
	)
F

185 #i‡(
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE
) \

186 && !
deföed
 
	g_DEFAULT_SOURCE


188 #unde‡
_DEFAULT_SOURCE


189 
	#_DEFAULT_SOURCE
 1

	)

193 #ifde‡
_GNU_SOURCE


194 #unde‡
_ISOC95_SOURCE


195 
	#_ISOC95_SOURCE
 1

	)

196 #unde‡
_ISOC99_SOURCE


197 
	#_ISOC99_SOURCE
 1

	)

198 #unde‡
_ISOC11_SOURCE


199 
	#_ISOC11_SOURCE
 1

	)

200 #unde‡
_ISOC2X_SOURCE


201 
	#_ISOC2X_SOURCE
 1

	)

202 #unde‡
_POSIX_SOURCE


203 
	#_POSIX_SOURCE
 1

	)

204 #unde‡
_POSIX_C_SOURCE


205 
	#_POSIX_C_SOURCE
 200809L

	)

206 #unde‡
_XOPEN_SOURCE


207 
	#_XOPEN_SOURCE
 700

	)

208 #unde‡
_XOPEN_SOURCE_EXTENDED


209 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

210 #unde‡
_LARGEFILE64_SOURCE


211 
	#_LARGEFILE64_SOURCE
 1

	)

212 #unde‡
_DEFAULT_SOURCE


213 
	#_DEFAULT_SOURCE
 1

	)

214 #unde‡
_ATFILE_SOURCE


215 
	#_ATFILE_SOURCE
 1

	)

220 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

221 || (!
deföed
 
	g__STRICT_ANSI__
 \

222 && !
deföed
 
	g_ISOC99_SOURCE
 && !deföed 
	g_ISOC11_SOURCE
 \

223 && !
deföed
 
	g_ISOC2X_SOURCE
 \

224 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

225 && !
deföed
 
	g_XOPEN_SOURCE
))

226 #unde‡
_DEFAULT_SOURCE


227 
	#_DEFAULT_SOURCE
 1

	)

231 #i‡(
deföed
 
_ISOC2X_SOURCE
 \

232 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ > 201710L))

233 
	#__GLIBC_USE_ISOC2X
 1

	)

235 
	#__GLIBC_USE_ISOC2X
 0

	)

239 #i‡(
deföed
 
_ISOC11_SOURCE
 || deföed 
_ISOC2X_SOURCE
 \

240 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

241 
	#__USE_ISOC11
 1

	)

245 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

246 || 
deföed
 
_ISOC2X_SOURCE
 \

247 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

248 
	#__USE_ISOC99
 1

	)

252 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

253 || 
deföed
 
_ISOC2X_SOURCE
 \

254 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

255 
	#__USE_ISOC95
 1

	)

258 #ifde‡
__˝lu•lus


260 #i‡
__˝lu•lus
 >= 201703L

261 
	#__USE_ISOC11
 1

	)

265 #i‡
__˝lu•lus
 >201103L || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__


266 
	#__USE_ISOCXX11
 1

	)

267 
	#__USE_ISOC99
 1

	)

274 #ifde‡
_DEFAULT_SOURCE


275 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


276 
	#__USE_POSIX_IMPLICITLY
 1

	)

278 #unde‡
_POSIX_SOURCE


279 
	#_POSIX_SOURCE
 1

	)

280 #unde‡
_POSIX_C_SOURCE


281 
	#_POSIX_C_SOURCE
 200809L

	)

284 #i‡((!
deföed
 
__STRICT_ANSI__
 \

285 || (
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

286 && !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

287 
	#_POSIX_SOURCE
 1

	)

288 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

289 
	#_POSIX_C_SOURCE
 2

	)

290 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

291 
	#_POSIX_C_SOURCE
 199506L

	)

292 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

293 
	#_POSIX_C_SOURCE
 200112L

	)

295 
	#_POSIX_C_SOURCE
 200809L

	)

297 
	#__USE_POSIX_IMPLICITLY
 1

	)

306 #i‡((!
deföed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

307 && (
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE
))

308 
	#_POSIX_SOURCE
 1

	)

309 #unde‡
_POSIX_C_SOURCE


310 
	#_POSIX_C_SOURCE
 199506L

	)

313 #i‡(
deföed
 
_POSIX_SOURCE
 \

314 || (
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

315 || 
deföed
 
_XOPEN_SOURCE
)

316 
	#__USE_POSIX
 1

	)

319 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


320 
	#__USE_POSIX2
 1

	)

323 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

324 
	#__USE_POSIX199309
 1

	)

327 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

328 
	#__USE_POSIX199506
 1

	)

331 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

332 
	#__USE_XOPEN2K
 1

	)

333 #unde‡
__USE_ISOC95


334 
	#__USE_ISOC95
 1

	)

335 #unde‡
__USE_ISOC99


336 
	#__USE_ISOC99
 1

	)

339 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

340 
	#__USE_XOPEN2K8
 1

	)

341 #unde‡
_ATFILE_SOURCE


342 
	#_ATFILE_SOURCE
 1

	)

345 #ifdef 
_XOPEN_SOURCE


346 
	#__USE_XOPEN
 1

	)

347 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

348 
	#__USE_XOPEN_EXTENDED
 1

	)

349 
	#__USE_UNIX98
 1

	)

350 #unde‡
_LARGEFILE_SOURCE


351 
	#_LARGEFILE_SOURCE
 1

	)

352 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

353 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

354 
	#__USE_XOPEN2K8
 1

	)

355 
	#__USE_XOPEN2K8XSI
 1

	)

357 
	#__USE_XOPEN2K
 1

	)

358 
	#__USE_XOPEN2KXSI
 1

	)

359 #unde‡
__USE_ISOC95


360 
	#__USE_ISOC95
 1

	)

361 #unde‡
__USE_ISOC99


362 
	#__USE_ISOC99
 1

	)

365 #ifde‡
_XOPEN_SOURCE_EXTENDED


366 
	#__USE_XOPEN_EXTENDED
 1

	)

371 #ifde‡
_LARGEFILE_SOURCE


372 
	#__USE_LARGEFILE
 1

	)

375 #ifde‡
_LARGEFILE64_SOURCE


376 
	#__USE_LARGEFILE64
 1

	)

379 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

380 
	#__USE_FILE_OFFSET64
 1

	)

383 #i‡
deföed
 
_DEFAULT_SOURCE


384 
	#__USE_MISC
 1

	)

387 #ifdef 
_ATFILE_SOURCE


388 
	#__USE_ATFILE
 1

	)

391 #ifdef 
_GNU_SOURCE


392 
	#__USE_GNU
 1

	)

395 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

396 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

397 #i‡
_FORTIFY_SOURCE
 > 1

398 
	#__USE_FORTIFY_LEVEL
 2

	)

400 
	#__USE_FORTIFY_LEVEL
 1

	)

403 
	#__USE_FORTIFY_LEVEL
 0

	)

410 #i‡
deföed
 
__˝lu•lus
 ? __˝lu•lu†>201402L : deföed 
__USE_ISOC11


411 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

413 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

428 #i‡(
deföed
 
__USE_GNU
 \

429 && (
deföed
 
	g__˝lu•lus
 \

430 ? (
	g__˝lu•lus
 < 201103L && !
deföed
 
	g__GXX_EXPERIMENTAL_CXX0X__
) \

431 : (!
deföed
 
__STDC_VERSION__
 || __STDC_VERSION__ < 199901L)))

432 
	#__GLIBC_USE_DEPRECATED_SCANF
 1

	)

434 
	#__GLIBC_USE_DEPRECATED_SCANF
 0

	)

439 
	~<°dc-¥edef.h
>

447 #unde‡
__GNU_LIBRARY__


448 
	#__GNU_LIBRARY__
 6

	)

452 
	#__GLIBC__
 2

	)

453 
	#__GLIBC_MINOR__
 31

	)

455 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

456 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

459 #i‚de‡
__ASSEMBLER__


460 #i‚de‡
_SYS_CDEFS_H


461 
	~<sys/cdefs.h
>

466 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


467 
	#__USE_LARGEFILE
 1

	)

468 
	#__USE_LARGEFILE64
 1

	)

474 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

475 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

476 && 
deföed
 
	g__exã∫_ölöe


477 
	#__USE_EXTERN_INLINES
 1

	)

485 
	~<gnu/°ubs.h
>

	@/usr/include/asm-generic/posix_types.h

2 #i‚de‡
__ASM_GENERIC_POSIX_TYPES_H


3 
	#__ASM_GENERIC_POSIX_TYPES_H


	)

5 
	~<asm/bô•îl⁄g.h
>

14 #i‚de‡
__kî√l_l⁄g_t


15 
	t__kî√l_l⁄g_t
;

16 
	t__kî√l_ul⁄g_t
;

19 #i‚de‡
__kî√l_öo_t


20 
__kî√l_ul⁄g_t
 
	t__kî√l_öo_t
;

23 #i‚de‡
__kî√l_mode_t


24 
	t__kî√l_mode_t
;

27 #i‚de‡
__kî√l_pid_t


28 
	t__kî√l_pid_t
;

31 #i‚de‡
__kî√l_ùc_pid_t


32 
	t__kî√l_ùc_pid_t
;

35 #i‚de‡
__kî√l_uid_t


36 
	t__kî√l_uid_t
;

37 
	t__kî√l_gid_t
;

40 #i‚de‡
__kî√l_su£c⁄ds_t


41 
__kî√l_l⁄g_t
 
	t__kî√l_su£c⁄ds_t
;

44 #i‚de‡
__kî√l_daddr_t


45 
	t__kî√l_daddr_t
;

48 #i‚de‡
__kî√l_uid32_t


49 
	t__kî√l_uid32_t
;

50 
	t__kî√l_gid32_t
;

53 #i‚de‡
__kî√l_ﬁd_uid_t


54 
__kî√l_uid_t
 
	t__kî√l_ﬁd_uid_t
;

55 
__kî√l_gid_t
 
	t__kî√l_ﬁd_gid_t
;

58 #i‚de‡
__kî√l_ﬁd_dev_t


59 
	t__kî√l_ﬁd_dev_t
;

66 #i‚de‡
__kî√l_size_t


67 #i‡
__BITS_PER_LONG
 != 64

68 
	t__kî√l_size_t
;

69 
	t__kî√l_ssize_t
;

70 
	t__kî√l_±rdiff_t
;

72 
__kî√l_ul⁄g_t
 
	t__kî√l_size_t
;

73 
__kî√l_l⁄g_t
 
	t__kî√l_ssize_t
;

74 
__kî√l_l⁄g_t
 
	t__kî√l_±rdiff_t
;

78 #i‚de‡
__kî√l_fsid_t


80 
	mvÆ
[2];

81 } 
	t__kî√l_fsid_t
;

87 
__kî√l_l⁄g_t
 
	t__kî√l_off_t
;

88 
	t__kî√l_loff_t
;

89 
__kî√l_l⁄g_t
 
	t__kî√l_time_t
;

90 
	t__kî√l_time64_t
;

91 
__kî√l_l⁄g_t
 
	t__kî√l_˛ock_t
;

92 
	t__kî√l_timî_t
;

93 
	t__kî√l_˛ockid_t
;

94 * 
	t__kî√l_ˇddr_t
;

95 
	t__kî√l_uid16_t
;

96 
	t__kî√l_gid16_t
;

	@/usr/include/asm/bitsperlong.h

2 #i‚de‡
__ASM_X86_BITSPERLONG_H


3 
	#__ASM_X86_BITSPERLONG_H


	)

5 #i‡
deföed
(
__x86_64__
Ë&& !deföed(
__ILP32__
)

6 
	#__BITS_PER_LONG
 64

	)

8 
	#__BITS_PER_LONG
 32

	)

11 
	~<asm-gíîic/bô•îl⁄g.h
>

	@/usr/include/asm/socket.h

1 
	~<asm-gíîic/sockë.h
>

	@/usr/include/bits/sockaddr.h

23 #i‚de‡
_BITS_SOCKADDR_H


24 
	#_BITS_SOCKADDR_H
 1

	)

28 
	tß_Ámûy_t
;

34 
	#__SOCKADDR_COMMON
(
ß_¥efix
) \

35 
ß_Ámûy_t
 
ß_¥efix
##
Ámûy


	)

37 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

40 
	#_SS_SIZE
 128

	)

	@/usr/include/bits/socket-constants.h

19 #i‚de‡
_SYS_SOCKET_H


23 
	#SOL_SOCKET
 1

	)

24 
	#SO_ACCEPTCONN
 30

	)

25 
	#SO_BROADCAST
 6

	)

26 
	#SO_DONTROUTE
 5

	)

27 
	#SO_ERROR
 4

	)

28 
	#SO_KEEPALIVE
 9

	)

29 
	#SO_LINGER
 13

	)

30 
	#SO_OOBINLINE
 10

	)

31 
	#SO_RCVBUF
 8

	)

32 
	#SO_RCVLOWAT
 18

	)

33 
	#SO_RCVTIMEO
 20

	)

34 
	#SO_REUSEADDR
 2

	)

35 
	#SO_SNDBUF
 7

	)

36 
	#SO_SNDLOWAT
 19

	)

37 
	#SO_SNDTIMEO
 21

	)

38 
	#SO_TYPE
 3

	)

	@/usr/include/bits/socket_type.h

19 #i‚de‡
_SYS_SOCKET_H


24 
	e__sockë_ty≥


26 
	mSOCK_STREAM
 = 1,

28 
	#SOCK_STREAM
 
SOCK_STREAM


	)

29 
	mSOCK_DGRAM
 = 2,

31 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

32 
	mSOCK_RAW
 = 3,

33 
	#SOCK_RAW
 
SOCK_RAW


	)

34 
	mSOCK_RDM
 = 4,

35 
	#SOCK_RDM
 
SOCK_RDM


	)

36 
	mSOCK_SEQPACKET
 = 5,

38 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

39 
	mSOCK_DCCP
 = 6,

40 
	#SOCK_DCCP
 
SOCK_DCCP


	)

41 
	mSOCK_PACKET
 = 10,

44 
	#SOCK_PACKET
 
SOCK_PACKET


	)

49 
	mSOCK_CLOEXEC
 = 02000000,

51 
	#SOCK_CLOEXEC
 
SOCK_CLOEXEC


	)

52 
	mSOCK_NONBLOCK
 = 00004000

54 
	#SOCK_NONBLOCK
 
SOCK_NONBLOCK


	)

	@/usr/include/bits/types/time_t.h

1 #i‚de‡
__time_t_deföed


2 
	#__time_t_deföed
 1

	)

4 
	~<bôs/ty≥s.h
>

7 
__time_t
 
	ttime_t
;

	@/usr/include/gnu/stubs.h

6 #i‡!
deföed
 
__x86_64__


7 
	~<gnu/°ubs-32.h
>

9 #i‡
deföed
 
__x86_64__
 && deföed 
__LP64__


10 
	~<gnu/°ubs-64.h
>

12 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


13 
	~<gnu/°ubs-x32.h
>

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

	@/usr/include/sys/cdefs.h

18 #i‚def 
_SYS_CDEFS_H


19 
	#_SYS_CDEFS_H
 1

	)

22 #i‚de‡
_FEATURES_H


23 
	~<„©uªs.h
>

29 #i‡
deföed
 
__GNUC__
 && !deföed 
__STDC__


34 #unde‡
__P


35 #unde‡
__PMT


37 #ifde‡
__GNUC__


41 #i‡
__GNUC_PREREQ
 (4, 6Ë&& !
deföed
 
_LIBC


42 
	#__LEAF
 , 
__Àaf__


	)

43 
	#__LEAF_ATTR
 
	`__©åibuã__
 ((
__Àaf__
))

	)

45 
	#__LEAF


	)

46 
	#__LEAF_ATTR


	)

54 #i‡!
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (3, 3)

55 
	#__THROW
 
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
))

	)

56 
	#__THROWNL
 
	`__©åibuã__
 ((
__nŸhrow__
))

	)

57 
	#__NTH
(
f˘
Ë
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
)Ë
	)
fct

58 
	#__NTHNL
(
f˘
Ë
	`__©åibuã__
 ((
__nŸhrow__
)Ë
	)
fct

60 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

61 
	#__THROW
 
	`throw
 ()

	)

62 
	#__THROWNL
 
	`throw
 ()

	)

63 
	#__NTH
(
f˘
Ë
__LEAF_ATTR
 f˘ 
	`throw
 ()

	)

64 
	#__NTHNL
(
f˘
Ëf˘ 
	`throw
 ()

	)

66 
	#__THROW


	)

67 
	#__THROWNL


	)

68 
	#__NTH
(
f˘
Ë
	)
fct

69 
	#__NTHNL
(
f˘
Ë
	)
fct

75 #i‡(
deföed
 
__˝lu•lus
 \

76 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

77 
	#__ölöe
 
ölöe


	)

79 
	#__ölöe


	)

82 
	#__THROW


	)

83 
	#__THROWNL


	)

84 
	#__NTH
(
f˘
Ë
	)
fct

91 #i‡
deföed
 
__˛™g__
 && deföed 
__has_exãnsi⁄


92 
	#__glibc_˛™g_has_exãnsi⁄
(
ext
Ë
	`__has_exãnsi⁄
 (ext)

	)

94 
	#__glibc_˛™g_has_exãnsi⁄
(
ext
Ë0

	)

99 
	#__P
(
¨gs
Ë
	)
args

100 
	#__PMT
(
¨gs
Ë
	)
args

105 
	#__CONCAT
(
x
,
y
Ëx ## 
	)
y

106 
	#__STRING
(
x
Ë#x

	)

109 
	#__±r_t
 *

	)

113 #ifdef 
__˝lu•lus


114 
	#__BEGIN_DECLS
 "C" {

	)

115 
	#__END_DECLS
 }

	)

117 
	#__BEGIN_DECLS


	)

118 
	#__END_DECLS


	)

123 
	#__bos
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

124 
	#__bos0
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 0)

	)

126 #i‡
__GNUC_PREREQ
 (4,3)

127 
	#__w¨nde˛
(
«me
, 
msg
) \

128 
	`«me
 (Ë
	`__©åibuã__
((
	`__w¨nög__
 (
msg
)))

	)

129 
	#__w¨«âr
(
msg
Ë
	`__©åibuã__
((
	`__w¨nög__
 (msg)))

	)

130 
	#__îr‹de˛
(
«me
, 
msg
) \

131 
	`«me
 (Ë
	`__©åibuã__
((
	`__îr‹__
 (
msg
)))

	)

133 
	#__w¨nde˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

134 
	#__w¨«âr
(
msg
)

	)

135 
	#__îr‹de˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

142 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

143 
	#__Êex¨r
 []

	)

144 
	#__glibc_c99_Êex¨r_avaûabÀ
 1

	)

145 #ñi‡
__GNUC_PREREQ
 (2,97)

148 
	#__Êex¨r
 []

	)

149 
	#__glibc_c99_Êex¨r_avaûabÀ
 1

	)

150 #ñi‡
deföed
 
__GNUC__


153 
	#__Êex¨r
 [0]

	)

154 
	#__glibc_c99_Êex¨r_avaûabÀ
 1

	)

157 
	#__Êex¨r
 [1]

	)

158 
	#__glibc_c99_Êex¨r_avaûabÀ
 0

	)

172 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

174 
	#__REDIRECT
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

175 #ifde‡
__˝lu•lus


176 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

177 
«me
 
¥Ÿo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

178 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

179 
«me
 
¥Ÿo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

181 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

182 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROW


	)

183 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

184 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROWNL


	)

186 
	#__ASMNAME
(
˙ame
Ë
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, c«me)

	)

187 
	#__ASMNAME2
(
¥efix
, 
˙ame
Ë
	`__STRING
 (¥efixË
	)
cname

200 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

201 
	#__©åibuã__
(
xyz
Ë

	)

207 #i‡
__GNUC_PREREQ
 (2,96)

208 
	#__©åibuã_mÆloc__
 
	`__©åibuã__
 ((
__mÆloc__
))

	)

210 
	#__©åibuã_mÆloc__


	)

215 #i‡
__GNUC_PREREQ
 (4, 3)

216 
	#__©åibuã_Æloc_size__
(
∑øms
) \

217 
	`__©åibuã__
 ((
__Æloc_size__
 
∑øms
))

	)

219 
	#__©åibuã_Æloc_size__
(
∑øms
Ë

	)

225 #i‡
__GNUC_PREREQ
 (2,96)

226 
	#__©åibuã_puª__
 
	`__©åibuã__
 ((
__puª__
))

	)

228 
	#__©åibuã_puª__


	)

232 #i‡
__GNUC_PREREQ
 (2,5)

233 
	#__©åibuã_c⁄°__
 
	`__©åibuã__
 ((
__c⁄°__
))

	)

235 
	#__©åibuã_c⁄°__


	)

241 #i‡
__GNUC_PREREQ
 (3,1)

242 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__u£d__
))

	)

243 
	#__©åibuã_noölöe__
 
	`__©åibuã__
 ((
__noölöe__
))

	)

245 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__unu£d__
))

	)

246 
	#__©åibuã_noölöe__


	)

250 #i‡
__GNUC_PREREQ
 (3,2)

251 
	#__©åibuã_dïªˇãd__
 
	`__©åibuã__
 ((
__dïªˇãd__
))

	)

253 
	#__©åibuã_dïªˇãd__


	)

259 #i‡
__GNUC_PREREQ
 (4,5) \

260 || 
	$__glibc_˛™g_has_exãnsi⁄
 (
__©åibuã_dïªˇãd_wôh_mesßge__
)

261 
	#__©åibuã_dïªˇãd_msg__
(
msg
) \

262 
	`__©åibuã__
 ((
	`__dïªˇãd__
 (
msg
)))

	)

264 
	#__©åibuã_dïªˇãd_msg__
(
msg
Ë
__©åibuã_dïªˇãd__


	)

273 #i‡
	`__GNUC_PREREQ
 (2,8)

274 
	#__©åibuã_f‹m©_¨g__
(
x
Ë
	`__©åibuã__
 ((
	`__f‹m©_¨g__
 (x)))

	)

276 
	#__©åibuã_f‹m©_¨g__
(
x
Ë

	)

283 #i‡
	`__GNUC_PREREQ
 (2,97)

284 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
) \

285 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__°rfm⁄__
, 
a
, 
b
)))

	)

287 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
Ë

	)

292 #i‡
	`__GNUC_PREREQ
 (3,3)

293 
	#__n⁄nuŒ
(
∑øms
Ë
	`__©åibuã__
 ((
__n⁄nuŒ__
Ö¨ams))

	)

295 
	#__n⁄nuŒ
(
∑øms
)

	)

300 #i‡
	`__GNUC_PREREQ
 (3,4)

301 
	#__©åibuã_w¨n_unu£d_ªsu…__
 \

302 
	`__©åibuã__
 ((
__w¨n_unu£d_ªsu…__
))

	)

303 #i‡
__USE_FORTIFY_LEVEL
 > 0

304 
	#__wur
 
__©åibuã_w¨n_unu£d_ªsu…__


	)

307 
	#__©åibuã_w¨n_unu£d_ªsu…__


	)

309 #i‚de‡
__wur


310 
	#__wur


	)

314 #i‡
	`__GNUC_PREREQ
 (3,2)

318 #unde‡
__Æways_ölöe


319 
	#__Æways_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__Æways_ölöe__
))

	)

321 #unde‡
__Æways_ölöe


322 
	#__Æways_ölöe
 
__ölöe


	)

327 #i‡
	`__GNUC_PREREQ
 (4,3)

328 
	#__©åibuã_¨tificül__
 
	`__©åibuã__
 ((
__¨tificül__
))

	)

330 
	#__©åibuã_¨tificül__


	)

342 #i‡(!
deföed
 
__˝lu•lus
 || 
	`__GNUC_PREREQ
 (4,3) \

343 || (
deföed
 
__˛™g__
 && (deföed 
__GNUC_STDC_INLINE__
 \

344 || 
deföed
 
__GNUC_GNU_INLINE__
)))

345 #i‡
deföed
 
__GNUC_STDC_INLINE__
 || deföed 
__˝lu•lus


346 
	#__exã∫_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

347 
	#__exã∫_Æways_ölöe
 \

348 
__Æways_ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

350 
	#__exã∫_ölöe
 
__ölöe


	)

351 
	#__exã∫_Æways_ölöe
 
__Æways_ölöe


	)

355 #ifde‡
__exã∫_Æways_ölöe


356 
	#__f‹tify_fun˘i⁄
 
__exã∫_Æways_ölöe
 
__©åibuã_¨tificül__


	)

361 #i‡
	`__GNUC_PREREQ
 (4,3)

362 
	#__va_¨g_∑ck
(Ë
	`__buûtö_va_¨g_∑ck
 ()

	)

363 
	#__va_¨g_∑ck_Àn
(Ë
	`__buûtö_va_¨g_∑ck_Àn
 ()

	)

370 #i‡!
	`__GNUC_PREREQ
 (2,8)

371 
	#__exãnsi⁄__


	)

375 #i‡!
	`__GNUC_PREREQ
 (2,92)

376 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

377 
	#__ª°ri˘
 
ª°ri˘


	)

379 
	#__ª°ri˘


	)

386 #i‡
	`__GNUC_PREREQ
 (3,1Ë&& !
deföed
 
__GNUG__


387 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

389 #ifde‡
__GNUC__


390 
	#__ª°ri˘_¨r


	)

392 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

393 
	#__ª°ri˘_¨r
 
ª°ri˘


	)

396 
	#__ª°ri˘_¨r


	)

401 #i‡
__GNUC__
 >= 3

402 
	#__glibc_u∆ikñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
 ((c⁄d), 0)

	)

403 
	#__glibc_likñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
 ((c⁄d), 1)

	)

405 
	#__glibc_u∆ikñy
(
c⁄d
Ë(c⁄d)

	)

406 
	#__glibc_likñy
(
c⁄d
Ë(c⁄d)

	)

409 #ifde‡
__has_©åibuã


410 
	#__glibc_has_©åibuã
(
©å
Ë
	`__has_©åibuã
 (©å)

	)

412 
	#__glibc_has_©åibuã
(
©å
Ë0

	)

415 #i‡(!
deföed
 
_N‹ëu∫
 \

416 && (
deföed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

417 && !
	$__GNUC_PREREQ
 (4,7))

418 #i‡
	`__GNUC_PREREQ
 (2,8)

419 
	#_N‹ëu∫
 
	`__©åibuã__
 ((
__n‹ëu∫__
))

	)

421 
	#_N‹ëu∫


	)

425 #i‡
	`__GNUC_PREREQ
 (8, 0)

429 
	#__©åibuã_n⁄°rög__
 
	`__©åibuã__
 ((
__n⁄°rög__
))

	)

431 
	#__©åibuã_n⁄°rög__


	)

435 #unde‡
__©åibuã_c›y__


436 #i‡
	`__GNUC_PREREQ
 (9, 0)

439 
	#__©åibuã_c›y__
(
¨g
Ë
	`__©åibuã__
 ((
	`__c›y__
 (¨g)))

	)

441 
	#__©åibuã_c›y__
(
¨g
)

	)

444 #i‡(!
deföed
 
_Sètic_as£π
 && !deföed 
__˝lu•lus
 \

445 && (
deföed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

446 && (!
	`__GNUC_PREREQ
 (4, 6Ë|| 
deföed
 
__STRICT_ANSI__
))

447 
	#_Sètic_as£π
(
ex¥
, 
dügno°ic
) \

448 (*
	`__Sètic_as£π_fun˘i⁄
 ()) \

449 [!! (°ru˘ { 
__îr‹_if_√g©ive
: (
ex¥
Ë? 2 : -1; })]

	)

452 
	~<bôs/w‹dsize.h
>

453 
	~<bôs/l⁄g-doubÀ.h
>

455 #i‡
deföed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && deföed 
__NO_LONG_DOUBLE_MATH


456 
	#__LDBL_COMPAT
 1

	)

457 #ifde‡
__REDIRECT


458 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

459 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
) \

460 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

461 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT_NTH
 («me,ÖrŸo,álüs)

	)

462 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
) \

463 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

464 
	#__LDBL_REDIR1_DECL
(
«me
, 
Æüs
) \

465 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 (#Æüs));

	)

466 
	#__LDBL_REDIR_DECL
(
«me
) \

467 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 ("__∆dbl_" #«me));

	)

468 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

469 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

470 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

471 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

474 #i‡!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT


475 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê
	)
proto

476 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
Ë«mê
	)
proto

477 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
__THROW


	)

478 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
Ë«mê¥Ÿÿ
__THROW


	)

479 
	#__LDBL_REDIR_DECL
(
«me
)

	)

480 #ifde‡
__REDIRECT


481 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

482 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

483 
	`__REDIRECT_NTH
 (
«me
, 
¥Ÿo
, 
Æüs
)

	)

492 #i‡
	`__GNUC_PREREQ
 (4,8Ë|| 
	`__glibc_˛™g_¥îeq
 (3,5)

493 
	#__glibc_ma¸o_w¨nög1
(
mesßge
Ë
	`_Pøgma
 (#mesßge)

	)

494 
	#__glibc_ma¸o_w¨nög
(
mesßge
) \

495 
	`__glibc_ma¸o_w¨nög1
 (
GCC
 
w¨nög
 
mesßge
)

	)

497 
	#__glibc_ma¸o_w¨nög
(
msg
)

	)

507 #i‡!
deföed
 
__˝lu•lus
 \

508 && (
	`__GNUC_PREREQ
 (4, 9) \

509 || 
	`__glibc_˛™g_has_exãnsi⁄
 (
c_gíîic_£À˘i⁄s
) \

510 || (!
deföed
 
__GNUC__
 && deföed 
__STDC_VERSION__
 \

511 && 
__STDC_VERSION__
 >= 201112L))

512 
	#__HAVE_GENERIC_SELECTION
 1

	)

514 
	#__HAVE_GENERIC_SELECTION
 0

	)

	@/usr/include/sys/types.h

22 #i‚def 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ty≥s.h
>

31 #ifdef 
__USE_MISC


32 #i‚de‡
__u_ch¨_deföed


33 
__u_ch¨
 
	tu_ch¨
;

34 
__u_sh‹t
 
	tu_sh‹t
;

35 
__u_öt
 
	tu_öt
;

36 
__u_l⁄g
 
	tu_l⁄g
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¨_deföed


	)

42 
__loff_t
 
	tloff_t
;

45 #i‚de‡
__öo_t_deföed


46 #i‚de‡
__USE_FILE_OFFSET64


47 
__öo_t
 
	töo_t
;

49 
__öo64_t
 
	töo_t
;

51 
	#__öo_t_deföed


	)

53 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


54 
__öo64_t
 
	töo64_t
;

55 
	#__öo64_t_deföed


	)

58 #i‚de‡
__dev_t_deföed


59 
__dev_t
 
	tdev_t
;

60 
	#__dev_t_deföed


	)

63 #i‚de‡
__gid_t_deföed


64 
__gid_t
 
	tgid_t
;

65 
	#__gid_t_deföed


	)

68 #i‚de‡
__mode_t_deföed


69 
__mode_t
 
	tmode_t
;

70 
	#__mode_t_deföed


	)

73 #i‚de‡
__∆ök_t_deföed


74 
__∆ök_t
 
	t∆ök_t
;

75 
	#__∆ök_t_deföed


	)

78 #i‚de‡
__uid_t_deföed


79 
__uid_t
 
	tuid_t
;

80 
	#__uid_t_deföed


	)

83 #i‚de‡
__off_t_deföed


84 #i‚de‡
__USE_FILE_OFFSET64


85 
__off_t
 
	toff_t
;

87 
__off64_t
 
	toff_t
;

89 
	#__off_t_deföed


	)

91 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


92 
__off64_t
 
	toff64_t
;

93 
	#__off64_t_deföed


	)

96 #i‚de‡
__pid_t_deföed


97 
__pid_t
 
	tpid_t
;

98 
	#__pid_t_deföed


	)

101 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
) \

102 && !
deföed
 
__id_t_deföed


103 
__id_t
 
	tid_t
;

104 
	#__id_t_deföed


	)

107 #i‚de‡
__ssize_t_deföed


108 
__ssize_t
 
	tssize_t
;

109 
	#__ssize_t_deföed


	)

112 #ifdef 
__USE_MISC


113 #i‚de‡
__daddr_t_deföed


114 
__daddr_t
 
	tdaddr_t
;

115 
__ˇddr_t
 
	tˇddr_t
;

116 
	#__daddr_t_deföed


	)

120 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
Ë&& !deföed 
__key_t_deföed


121 
__key_t
 
	tkey_t
;

122 
	#__key_t_deföed


	)

125 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


126 
	~<bôs/ty≥s/˛ock_t.h
>

128 
	~<bôs/ty≥s/˛ockid_t.h
>

129 
	~<bôs/ty≥s/time_t.h
>

130 
	~<bôs/ty≥s/timî_t.h
>

132 #ifde‡
__USE_XOPEN


133 #i‚de‡
__u£c⁄ds_t_deföed


134 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

135 
	#__u£c⁄ds_t_deföed


	)

137 #i‚de‡
__su£c⁄ds_t_deföed


138 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

139 
	#__su£c⁄ds_t_deföed


	)

143 
	#__√ed_size_t


	)

144 
	~<°ddef.h
>

146 #ifde‡
__USE_MISC


148 
	tul⁄g
;

149 
	tush‹t
;

150 
	tuöt
;

155 
	~<bôs/°döt-öä.h
>

158 
__uöt8_t
 
	tu_öt8_t
;

159 
__uöt16_t
 
	tu_öt16_t
;

160 
__uöt32_t
 
	tu_öt32_t
;

161 
__uöt64_t
 
	tu_öt64_t
;

163 #i‡
__GNUC_PREREQ
 (2, 7)

164 
	tªgi°î_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__w‹d__
)));

166 
	tªgi°î_t
;

171 
	#__BIT_TYPES_DEFINED__
 1

	)

174 #ifdef 
__USE_MISC


176 
	~<ídün.h
>

179 
	~<sys/£À˘.h
>

183 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
) \

184 && !
deföed
 
__blksize_t_deföed


185 
__blksize_t
 
	tblksize_t
;

186 
	#__blksize_t_deföed


	)

190 #i‚de‡
__USE_FILE_OFFSET64


191 #i‚de‡
__blk˙t_t_deföed


192 
__blk˙t_t
 
	tblk˙t_t
;

193 
	#__blk˙t_t_deföed


	)

195 #i‚de‡
__fsblk˙t_t_deföed


196 
__fsblk˙t_t
 
	tfsblk˙t_t
;

197 
	#__fsblk˙t_t_deföed


	)

199 #i‚de‡
__fsfû˙t_t_deföed


200 
__fsfû˙t_t
 
	tfsfû˙t_t
;

201 
	#__fsfû˙t_t_deföed


	)

204 #i‚de‡
__blk˙t_t_deföed


205 
__blk˙t64_t
 
	tblk˙t_t
;

206 
	#__blk˙t_t_deföed


	)

208 #i‚de‡
__fsblk˙t_t_deföed


209 
__fsblk˙t64_t
 
	tfsblk˙t_t
;

210 
	#__fsblk˙t_t_deföed


	)

212 #i‚de‡
__fsfû˙t_t_deföed


213 
__fsfû˙t64_t
 
	tfsfû˙t_t
;

214 
	#__fsfû˙t_t_deföed


	)

218 #ifde‡
__USE_LARGEFILE64


219 
__blk˙t64_t
 
	tblk˙t64_t
;

220 
__fsblk˙t64_t
 
	tfsblk˙t64_t
;

221 
__fsfû˙t64_t
 
	tfsfû˙t64_t
;

226 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


227 
	~<bôs/±hªadty≥s.h
>

230 
	g__END_DECLS


	@/usr/include/asm-generic/bitsperlong.h

2 #i‚de‡
__ASM_GENERIC_BITS_PER_LONG


3 
	#__ASM_GENERIC_BITS_PER_LONG


	)

12 #i‚de‡
__BITS_PER_LONG


13 
	#__BITS_PER_LONG
 32

	)

	@/usr/include/asm-generic/socket.h

2 #i‚de‡
__ASM_GENERIC_SOCKET_H


3 
	#__ASM_GENERIC_SOCKET_H


	)

5 
	~<löux/posix_ty≥s.h
>

6 
	~<asm/sockios.h
>

9 
	#SOL_SOCKET
 1

	)

11 
	#SO_DEBUG
 1

	)

12 
	#SO_REUSEADDR
 2

	)

13 
	#SO_TYPE
 3

	)

14 
	#SO_ERROR
 4

	)

15 
	#SO_DONTROUTE
 5

	)

16 
	#SO_BROADCAST
 6

	)

17 
	#SO_SNDBUF
 7

	)

18 
	#SO_RCVBUF
 8

	)

19 
	#SO_SNDBUFFORCE
 32

	)

20 
	#SO_RCVBUFFORCE
 33

	)

21 
	#SO_KEEPALIVE
 9

	)

22 
	#SO_OOBINLINE
 10

	)

23 
	#SO_NO_CHECK
 11

	)

24 
	#SO_PRIORITY
 12

	)

25 
	#SO_LINGER
 13

	)

26 
	#SO_BSDCOMPAT
 14

	)

27 
	#SO_REUSEPORT
 15

	)

28 #i‚de‡
SO_PASSCRED


29 
	#SO_PASSCRED
 16

	)

30 
	#SO_PEERCRED
 17

	)

31 
	#SO_RCVLOWAT
 18

	)

32 
	#SO_SNDLOWAT
 19

	)

33 
	#SO_RCVTIMEO_OLD
 20

	)

34 
	#SO_SNDTIMEO_OLD
 21

	)

38 
	#SO_SECURITY_AUTHENTICATION
 22

	)

39 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

40 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

42 
	#SO_BINDTODEVICE
 25

	)

45 
	#SO_ATTACH_FILTER
 26

	)

46 
	#SO_DETACH_FILTER
 27

	)

47 
	#SO_GET_FILTER
 
SO_ATTACH_FILTER


	)

49 
	#SO_PEERNAME
 28

	)

51 
	#SO_ACCEPTCONN
 30

	)

53 
	#SO_PEERSEC
 31

	)

54 
	#SO_PASSSEC
 34

	)

56 
	#SO_MARK
 36

	)

58 
	#SO_PROTOCOL
 38

	)

59 
	#SO_DOMAIN
 39

	)

61 
	#SO_RXQ_OVFL
 40

	)

63 
	#SO_WIFI_STATUS
 41

	)

64 
	#SCM_WIFI_STATUS
 
SO_WIFI_STATUS


	)

65 
	#SO_PEEK_OFF
 42

	)

68 
	#SO_NOFCS
 43

	)

70 
	#SO_LOCK_FILTER
 44

	)

72 
	#SO_SELECT_ERR_QUEUE
 45

	)

74 
	#SO_BUSY_POLL
 46

	)

76 
	#SO_MAX_PACING_RATE
 47

	)

78 
	#SO_BPF_EXTENSIONS
 48

	)

80 
	#SO_INCOMING_CPU
 49

	)

82 
	#SO_ATTACH_BPF
 50

	)

83 
	#SO_DETACH_BPF
 
SO_DETACH_FILTER


	)

85 
	#SO_ATTACH_REUSEPORT_CBPF
 51

	)

86 
	#SO_ATTACH_REUSEPORT_EBPF
 52

	)

88 
	#SO_CNX_ADVICE
 53

	)

90 
	#SCM_TIMESTAMPING_OPT_STATS
 54

	)

92 
	#SO_MEMINFO
 55

	)

94 
	#SO_INCOMING_NAPI_ID
 56

	)

96 
	#SO_COOKIE
 57

	)

98 
	#SCM_TIMESTAMPING_PKTINFO
 58

	)

100 
	#SO_PEERGROUPS
 59

	)

102 
	#SO_ZEROCOPY
 60

	)

104 
	#SO_TXTIME
 61

	)

105 
	#SCM_TXTIME
 
SO_TXTIME


	)

107 
	#SO_BINDTOIFINDEX
 62

	)

109 
	#SO_TIMESTAMP_OLD
 29

	)

110 
	#SO_TIMESTAMPNS_OLD
 35

	)

111 
	#SO_TIMESTAMPING_OLD
 37

	)

113 
	#SO_TIMESTAMP_NEW
 63

	)

114 
	#SO_TIMESTAMPNS_NEW
 64

	)

115 
	#SO_TIMESTAMPING_NEW
 65

	)

117 
	#SO_RCVTIMEO_NEW
 66

	)

118 
	#SO_SNDTIMEO_NEW
 67

	)

120 
	#SO_DETACH_REUSEPORT_BPF
 68

	)

123 #i‡
__BITS_PER_LONG
 =64 || (
deföed
(
__x86_64__
Ë&& deföed(
__ILP32__
))

125 
	#SO_TIMESTAMP
 
SO_TIMESTAMP_OLD


	)

126 
	#SO_TIMESTAMPNS
 
SO_TIMESTAMPNS_OLD


	)

127 
	#SO_TIMESTAMPING
 
SO_TIMESTAMPING_OLD


	)

129 
	#SO_RCVTIMEO
 
SO_RCVTIMEO_OLD


	)

130 
	#SO_SNDTIMEO
 
SO_SNDTIMEO_OLD


	)

132 
	#SO_TIMESTAMP
 ((
time_t
Ë=(
__kî√l_l⁄g_t
Ë? 
SO_TIMESTAMP_OLD
 : 
SO_TIMESTAMP_NEW
)

	)

133 
	#SO_TIMESTAMPNS
 ((
time_t
Ë=(
__kî√l_l⁄g_t
Ë? 
SO_TIMESTAMPNS_OLD
 : 
SO_TIMESTAMPNS_NEW
)

	)

134 
	#SO_TIMESTAMPING
 ((
time_t
Ë=(
__kî√l_l⁄g_t
Ë? 
SO_TIMESTAMPING_OLD
 : 
SO_TIMESTAMPING_NEW
)

	)

136 
	#SO_RCVTIMEO
 ((
time_t
Ë=(
__kî√l_l⁄g_t
Ë? 
SO_RCVTIMEO_OLD
 : 
SO_RCVTIMEO_NEW
)

	)

137 
	#SO_SNDTIMEO
 ((
time_t
Ë=(
__kî√l_l⁄g_t
Ë? 
SO_SNDTIMEO_OLD
 : 
SO_SNDTIMEO_NEW
)

	)

140 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

141 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

142 
	#SCM_TIMESTAMPING
 
SO_TIMESTAMPING


	)

	@/usr/include/bits/long-double.h

21 
	#__LONG_DOUBLE_USES_FLOAT128
 0

	)

	@/usr/include/bits/pthreadtypes.h

19 #i‚de‡
_BITS_PTHREADTYPES_COMMON_H


20 
	#_BITS_PTHREADTYPES_COMMON_H
 1

	)

23 
	~<bôs/thªad-sh¨ed-ty≥s.h
>

27 
	t±hªad_t
;

34 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

35 
	m__Æign
;

36 } 
	t±hªad_muãx©å_t
;

43 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

44 
	m__Æign
;

45 } 
	t±hªad_c⁄d©å_t
;

49 
	t±hªad_key_t
;

53 
	t__ONCE_ALIGNMENT
 
	t±hªad_⁄˚_t
;

56 
	u±hªad_©å_t


58 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

59 
	m__Æign
;

61 #i‚de‡
__have_±hªad_©å_t


62 
±hªad_©å_t
 
	t±hªad_©å_t
;

63 
	#__have_±hªad_©å_t
 1

	)

69 
__±hªad_muãx_s
 
	m__d©a
;

70 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

71 
	m__Æign
;

72 } 
	t±hªad_muãx_t
;

77 
__±hªad_c⁄d_s
 
	m__d©a
;

78 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

79 
__exãnsi⁄__
 
	m__Æign
;

80 } 
	t±hªad_c⁄d_t
;

83 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


88 
__±hªad_rwlock_¨ch_t
 
	m__d©a
;

89 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

90 
	m__Æign
;

91 } 
	t±hªad_rwlock_t
;

95 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

96 
	m__Æign
;

97 } 
	t±hªad_rwlock©å_t
;

101 #ifde‡
__USE_XOPEN2K


103 vﬁ©ûê
	t±hªad_•ölock_t
;

110 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

111 
	m__Æign
;

112 } 
	t±hªad_b¨rõr_t
;

116 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

117 
	m__Æign
;

118 } 
	t±hªad_b¨rõøâr_t
;

	@/usr/include/bits/stdint-intn.h

19 #i‚de‡
_BITS_STDINT_INTN_H


20 
	#_BITS_STDINT_INTN_H
 1

	)

22 
	~<bôs/ty≥s.h
>

24 
__öt8_t
 
	töt8_t
;

25 
__öt16_t
 
	töt16_t
;

26 
__öt32_t
 
	töt32_t
;

27 
__öt64_t
 
	töt64_t
;

	@/usr/include/bits/types.h

23 #i‚def 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/w‹dsize.h
>

28 
	~<bôs/timesize.h
>

31 
	t__u_ch¨
;

32 
	t__u_sh‹t
;

33 
	t__u_öt
;

34 
	t__u_l⁄g
;

37 sig√d 
	t__öt8_t
;

38 
	t__uöt8_t
;

39 sig√d 
	t__öt16_t
;

40 
	t__uöt16_t
;

41 sig√d 
	t__öt32_t
;

42 
	t__uöt32_t
;

43 #i‡
__WORDSIZE
 == 64

44 sig√d 
	t__öt64_t
;

45 
	t__uöt64_t
;

47 
__exãnsi⁄__
 sig√d 
	t__öt64_t
;

48 
__exãnsi⁄__
 
	t__uöt64_t
;

52 
__öt8_t
 
	t__öt_Àa°8_t
;

53 
__uöt8_t
 
	t__uöt_Àa°8_t
;

54 
__öt16_t
 
	t__öt_Àa°16_t
;

55 
__uöt16_t
 
	t__uöt_Àa°16_t
;

56 
__öt32_t
 
	t__öt_Àa°32_t
;

57 
__uöt32_t
 
	t__uöt_Àa°32_t
;

58 
__öt64_t
 
	t__öt_Àa°64_t
;

59 
__uöt64_t
 
	t__uöt_Àa°64_t
;

62 #i‡
__WORDSIZE
 == 64

63 
	t__quad_t
;

64 
	t__u_quad_t
;

66 
__exãnsi⁄__
 
	t__quad_t
;

67 
__exãnsi⁄__
 
	t__u_quad_t
;

71 #i‡
__WORDSIZE
 == 64

72 
	t__ötmax_t
;

73 
	t__uötmax_t
;

75 
__exãnsi⁄__
 
	t__ötmax_t
;

76 
__exãnsi⁄__
 
	t__uötmax_t
;

109 
	#__S16_TYPE
 

	)

110 
	#__U16_TYPE
 

	)

111 
	#__S32_TYPE
 

	)

112 
	#__U32_TYPE
 

	)

113 
	#__SLONGWORD_TYPE
 

	)

114 
	#__ULONGWORD_TYPE
 

	)

115 #i‡
__WORDSIZE
 == 32

116 
	#__SQUAD_TYPE
 
__öt64_t


	)

117 
	#__UQUAD_TYPE
 
__uöt64_t


	)

118 
	#__SWORD_TYPE
 

	)

119 
	#__UWORD_TYPE
 

	)

120 
	#__SLONG32_TYPE
 

	)

121 
	#__ULONG32_TYPE
 

	)

122 
	#__S64_TYPE
 
__öt64_t


	)

123 
	#__U64_TYPE
 
__uöt64_t


	)

126 
	#__STD_TYPE
 
__exãnsi⁄__
 

	)

127 #ñi‡
__WORDSIZE
 == 64

128 
	t__SQUAD_TYPE
 

	)

129 
	t__UQUAD_TYPE
 

	)

130 
	t__SWORD_TYPE
 

	)

131 
	t__UWORD_TYPE
 

	)

132 
	t__SLONG32_TYPE
 

	)

133 
	t__ULONG32_TYPE
 

	)

134 
	t__S64_TYPE
 

	)

135 
	t__U64_TYPE
 

	)

137 
	t__STD_TYPE
 

	)

141 
	~<bôs/ty≥sizes.h
>

142 
	~<bôs/time64.h
>

145 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

146 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

147 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

148 
__STD_TYPE
 
__INO_T_TYPE
 
	g__öo_t
;

149 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__öo64_t
;

150 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

151 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__∆ök_t
;

152 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

153 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

154 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

155 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

156 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__˛ock_t
;

157 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__æim_t
;

158 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__æim64_t
;

159 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

160 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

161 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£c⁄ds_t
;

162 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£c⁄ds_t
;

164 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

165 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

168 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__˛ockid_t
;

171 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__timî_t
;

174 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

179 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blk˙t_t
;

180 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blk˙t64_t
;

183 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblk˙t_t
;

184 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblk˙t64_t
;

187 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfû˙t_t
;

188 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfû˙t64_t
;

191 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fsw‹d_t
;

193 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

196 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysˇŒ_¶⁄g_t
;

198 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysˇŒ_ul⁄g_t
;

202 
__off64_t
 
	t__loff_t
;

203 *
	t__ˇddr_t
;

206 
__STD_TYPE
 
__SWORD_TYPE
 
	g__öçå_t
;

209 
__STD_TYPE
 
__U32_TYPE
 
	g__sockÀn_t
;

214 
	t__sig_©omic_t
;

219 #i‡
__TIMESIZE
 =64 && 
deföed
 
__LIBC


220 
	#__time64_t
 
__time_t


	)

221 #ñi‡
__TIMESIZE
 != 64

222 
__STD_TYPE
 
__TIME64_T_TYPE
 
	g__time64_t
;

225 #unde‡
__STD_TYPE


	@/usr/include/bits/types/clock_t.h

1 #i‚de‡
__˛ock_t_deföed


2 
	#__˛ock_t_deföed
 1

	)

4 
	~<bôs/ty≥s.h
>

7 
__˛ock_t
 
	t˛ock_t
;

	@/usr/include/bits/types/clockid_t.h

1 #i‚de‡
__˛ockid_t_deföed


2 
	#__˛ockid_t_deföed
 1

	)

4 
	~<bôs/ty≥s.h
>

7 
__˛ockid_t
 
	t˛ockid_t
;

	@/usr/include/bits/types/timer_t.h

1 #i‚de‡
__timî_t_deföed


2 
	#__timî_t_deföed
 1

	)

4 
	~<bôs/ty≥s.h
>

7 
__timî_t
 
	ttimî_t
;

	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

24 
	~<bôs/ídün.h
>

26 #ifde‡
__USE_MISC


27 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

28 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

29 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

30 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

33 #i‡
deföed
 
__USE_MISC
 && !deföed 
__ASSEMBLER__


35 
	~<bôs/byãsw≠.h
>

36 
	~<bôs/uöä-idítôy.h
>

38 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


39 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

40 
	#htﬁe16
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

41 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

42 
	#À16toh
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

44 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

45 
	#htﬁe32
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

46 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

47 
	#À32toh
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

49 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

50 
	#htﬁe64
(
x
Ë
	`__uöt64_idítôy
 (x)

	)

51 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

52 
	#À64toh
(
x
Ë
	`__uöt64_idítôy
 (x)

	)

55 
	#htobe16
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

56 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

57 
	#be16toh
(
x
Ë
	`__uöt16_idítôy
 (x)

	)

58 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

60 
	#htobe32
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

61 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

62 
	#be32toh
(
x
Ë
	`__uöt32_idítôy
 (x)

	)

63 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

65 
	#htobe64
(
x
Ë
	`__uöt64_idítôy
 (x)

	)

66 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

67 
	#be64toh
(
x
Ë
	`__uöt64_idítôy
 (x)

	)

68 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/gnu/stubs-32.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_chÊags


	)

11 
	#__°ub_fchÊags


	)

12 
	#__°ub_gây


	)

13 
	#__°ub_lchmod


	)

14 
	#__°ub_ªvoke


	)

15 
	#__°ub_£éogö


	)

16 
	#__°ub_sigªtu∫


	)

17 
	#__°ub_s°k


	)

18 
	#__°ub_°ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub___com∑t_bdÊush


	)

11 
	#__°ub_chÊags


	)

12 
	#__°ub_fchÊags


	)

13 
	#__°ub_gây


	)

14 
	#__°ub_lchmod


	)

15 
	#__°ub_ªvoke


	)

16 
	#__°ub_£éogö


	)

17 
	#__°ub_sigªtu∫


	)

18 
	#__°ub_s°k


	)

19 
	#__°ub_°ty


	)

	@/usr/include/gnu/stubs-x32.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub___com∑t_bdÊush


	)

11 
	#__°ub___com∑t_¸óã_moduÀ


	)

12 
	#__°ub___com∑t_gë_kî√l_syms


	)

13 
	#__°ub___com∑t_nfs£rv˘l


	)

14 
	#__°ub___com∑t_quîy_moduÀ


	)

15 
	#__°ub___com∑t_u£lib


	)

16 
	#__°ub_chÊags


	)

17 
	#__°ub_fchÊags


	)

18 
	#__°ub_gây


	)

19 
	#__°ub_lchmod


	)

20 
	#__°ub_ªvoke


	)

21 
	#__°ub_£éogö


	)

22 
	#__°ub_sigªtu∫


	)

23 
	#__°ub_s°k


	)

24 
	#__°ub_°ty


	)

	@/usr/include/sys/select.h

21 #i‚de‡
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

30 
	~<bôs/£À˘.h
>

33 
	~<bôs/ty≥s/sig£t_t.h
>

36 
	~<bôs/ty≥s/time_t.h
>

37 
	~<bôs/ty≥s/°ru˘_timevÆ.h
>

38 #ifde‡
__USE_XOPEN2K


39 
	~<bôs/ty≥s/°ru˘_time•ec.h
>

42 #i‚de‡
__su£c⁄ds_t_deföed


43 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

44 
	#__su£c⁄ds_t_deföed


	)

49 
	t__fd_mask
;

52 #unde‡
__NFDBITS


54 
	#__NFDBITS
 (8 * (Ë (
__fd_mask
))

	)

55 
	#__FD_ELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

56 
	#__FD_MASK
(
d
Ë((
__fd_mask
Ë(1UL << ((dË% 
__NFDBITS
)))

	)

63 #ifde‡
__USE_XOPEN


64 
__fd_mask
 
	mfds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

65 
	#__FDS_BITS
(
£t
Ë((£t)->
fds_bôs
)

	)

67 
__fd_mask
 
	m__fds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

68 
	#__FDS_BITS
(
£t
Ë((£t)->
__fds_bôs
)

	)

70 } 
	tfd_£t
;

73 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

75 #ifde‡
__USE_MISC


77 
__fd_mask
 
	tfd_mask
;

80 
	#NFDBITS
 
__NFDBITS


	)

85 
	#FD_SET
(
fd
, 
fd£ç
Ë
	`__FD_SET
 (fd, fd£ç)

	)

86 
	#FD_CLR
(
fd
, 
fd£ç
Ë
	`__FD_CLR
 (fd, fd£ç)

	)

87 
	#FD_ISSET
(
fd
, 
fd£ç
Ë
	`__FD_ISSET
 (fd, fd£ç)

	)

88 
	#FD_ZERO
(
fd£ç
Ë
	`__FD_ZERO
 (fd£ç)

	)

91 
__BEGIN_DECLS


101 
£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

102 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

103 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

104 
timevÆ
 *
__ª°ri˘
 
__timeout
);

106 #ifde‡
__USE_XOPEN2K


113 
p£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

114 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

115 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

116 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
,

117 c⁄° 
__sig£t_t
 *
__ª°ri˘
 
__sigmask
);

122 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__GNUC__


123 
	~<bôs/£À˘2.h
>

126 
	g__END_DECLS


	@/usr/include/asm/sockios.h

1 
	~<asm-gíîic/sockios.h
>

	@/usr/include/bits/byteswap.h

19 #i‡!
deföed
 
_BYTESWAP_H
 && !deföed 
_NETINET_IN_H
 && !deföed 
_ENDIAN_H


23 #i‚de‡
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

30 
	#__bsw≠_c⁄°™t_16
(
x
) \

31 ((
__uöt16_t
Ë((((
x
Ë>> 8Ë& 0xffË| (((xË& 0xffË<< 8)))

	)

33 
__ölöe
 
__uöt16_t


34 
	$__bsw≠_16
 (
__uöt16_t
 
__bsx
)

36 #i‡
	`__GNUC_PREREQ
 (4, 8)

37  
	`__buûtö_bsw≠16
 (
__bsx
);

39  
	`__bsw≠_c⁄°™t_16
 (
__bsx
);

41 
	}
}

44 
	#__bsw≠_c⁄°™t_32
(
x
) \

45 ((((
x
) & 0xff000000u) >> 24) | (((x) & 0x00ff0000u) >> 8) \

46 | (((
x
Ë& 0x0000ff00uË<< 8Ë| (((xË& 0x000000ffuË<< 24))

	)

48 
__ölöe
 
__uöt32_t


49 
	$__bsw≠_32
 (
__uöt32_t
 
__bsx
)

51 #i‡
	`__GNUC_PREREQ
 (4, 3)

52  
	`__buûtö_bsw≠32
 (
__bsx
);

54  
	`__bsw≠_c⁄°™t_32
 (
__bsx
);

56 
	}
}

59 
	#__bsw≠_c⁄°™t_64
(
x
) \

60 ((((
x
) & 0xff00000000000000ull) >> 56) \

61 | (((
x
) & 0x00ff000000000000ull) >> 40) \

62 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

63 | (((
x
) & 0x000000ff00000000ull) >> 8) \

64 | (((
x
) & 0x00000000ff000000ull) << 8) \

65 | (((
x
) & 0x0000000000ff0000ull) << 24) \

66 | (((
x
) & 0x000000000000ff00ull) << 40) \

67 | (((
x
Ë& 0x00000000000000ffuŒË<< 56))

	)

69 
__exãnsi⁄__
 
__ölöe
 
__uöt64_t


70 
	$__bsw≠_64
 (
__uöt64_t
 
__bsx
)

72 #i‡
	`__GNUC_PREREQ
 (4, 3)

73  
	`__buûtö_bsw≠64
 (
__bsx
);

75  
	`__bsw≠_c⁄°™t_64
 (
__bsx
);

77 
	}
}

	@/usr/include/bits/endian.h

19 #i‚de‡
_BITS_ENDIAN_H


20 
	#_BITS_ENDIAN_H
 1

	)

30 
	#__LITTLE_ENDIAN
 1234

	)

31 
	#__BIG_ENDIAN
 4321

	)

32 
	#__PDP_ENDIAN
 3412

	)

35 
	~<bôs/ídü¬ess.h
>

39 #i‚de‡
__FLOAT_WORD_ORDER


40 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

43 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


44 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

45 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


46 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

	@/usr/include/bits/select.h

18 #i‚de‡
_SYS_SELECT_H


22 
	~<bôs/w‹dsize.h
>

25 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

27 #i‡
__WORDSIZE
 == 64

28 
	#__FD_ZERO_STOS
 "°osq"

	)

30 
	#__FD_ZERO_STOS
 "°o¶"

	)

33 
	#__FD_ZERO
(
fd•
) \

35 
__d0
, 
__d1
; \

36 
__asm__
 
	`__vﬁ©ûe__
 ("˛d;Ñï; " 
__FD_ZERO_STOS
 \

37 : "=c" (
__d0
), "=D" (
__d1
) \

38 : "a" (0), "0" ( (
fd_£t
) \

39 /  (
__fd_mask
)), \

40 "1" (&
	`__FDS_BITS
 (
fd•
)[0]) \

42 } 0)

	)

48 
	#__FD_ZERO
(
£t
) \

50 
__i
; \

51 
fd_£t
 *
__¨r
 = (
£t
); \

52 
__i
 = 0; __ò<  (
fd_£t
Ë/  (
__fd_mask
); ++__i) \

53 
	`__FDS_BITS
 (
__¨r
)[
__i
] = 0; \

54 } 0)

	)

58 
	#__FD_SET
(
d
, 
£t
) \

59 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |
	`__FD_MASK
 (d)))

	)

60 
	#__FD_CLR
(
d
, 
£t
) \

61 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &~
	`__FD_MASK
 (d)))

	)

62 
	#__FD_ISSET
(
d
, 
£t
) \

63 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)Ë!0)

	)

	@/usr/include/bits/select2.h

19 #i‚de‡
_SYS_SELECT_H


24 
__fdñt_chk
 (
__d
);

25 
	$__fdñt_w¨n
 (
__d
)

26 
	`__w¨«âr
 ("bit outside of fd_set selected");

27 #unde‡
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__exãnsi⁄__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__buûtö_c⁄°™t_p
 (
__d
) \

32 ? (0 <
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fdñt_w¨n
 (
__d
)) \

35 : 
	`__fdñt_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/thread-shared-types.h

19 #i‚de‡
_THREAD_SHARED_TYPES_H


20 
	#_THREAD_SHARED_TYPES_H
 1

	)

44 
	~<bôs/±hªadty≥s-¨ch.h
>

49 
	s__±hªad_öã∫Æ_li°


51 
__±hªad_öã∫Æ_li°
 *
	m__¥ev
;

52 
__±hªad_öã∫Æ_li°
 *
	m__√xt
;

53 } 
	t__±hªad_li°_t
;

55 
	s__±hªad_öã∫Æ_¶i°


57 
__±hªad_öã∫Æ_¶i°
 *
	m__√xt
;

58 } 
	t__±hªad_¶i°_t
;

74 
	~<bôs/°ru˘_muãx.h
>

87 
	~<bôs/°ru˘_rwlock.h
>

92 
	s__±hªad_c⁄d_s


94 
__exãnsi⁄__
 union

96 
__exãnsi⁄__
 
	m__w£q
;

99 
	m__low
;

100 
	m__high
;

101 } 
	m__w£q32
;

103 
__exãnsi⁄__
 union

105 
__exãnsi⁄__
 
	m__g1_°¨t
;

108 
	m__low
;

109 
	m__high
;

110 } 
	m__g1_°¨t32
;

112 
	m__g_ªfs
[2] 
	m__LOCK_ALIGNMENT
;

113 
	m__g_size
[2];

114 
	m__g1_‹ig_size
;

115 
	m__wªfs
;

116 
	m__g_sig«ls
[2];

	@/usr/include/bits/time64.h

19 #i‚de‡
_BITS_TYPES_H


23 #i‚def 
_BITS_TIME64_H


24 
	#_BITS_TIME64_H
 1

	)

28 #i‡
__TIMESIZE
 == 64

30 
	#__TIME64_T_TYPE
 
__TIME_T_TYPE


	)

33 
	#__TIME64_T_TYPE
 
__SQUAD_TYPE


	)

	@/usr/include/bits/timesize.h

19 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


21 
	#__TIMESIZE
 64

	)

24 
	#__TIMESIZE
 
__WORDSIZE


	)

	@/usr/include/bits/types/sigset_t.h

1 #i‚de‡
__sig£t_t_deföed


2 
	#__sig£t_t_deföed
 1

	)

4 
	~<bôs/ty≥s/__sig£t_t.h
>

7 
__sig£t_t
 
	tsig£t_t
;

	@/usr/include/bits/types/struct_timespec.h

2 #i‚de‡
_STRUCT_TIMESPEC


3 
	#_STRUCT_TIMESPEC
 1

	)

5 
	~<bôs/ty≥s.h
>

6 
	~<bôs/ídün.h
>

10 
	stime•ec


12 
__time_t
 
	mtv_£c
;

13 #i‡
__WORDSIZE
 == 64 \

14 || (
deföed
 
	m__SYSCALL_WORDSIZE
 && __SYSCALL_WORDSIZE == 64) \

15 || 
__TIMESIZE
 == 32

16 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

18 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


20 
	mtv_n£c
;

22 
	mtv_n£c
;

	@/usr/include/bits/types/struct_timeval.h

1 #i‚de‡
__timevÆ_deföed


2 
	#__timevÆ_deföed
 1

	)

4 
	~<bôs/ty≥s.h
>

8 
	stimevÆ


10 
__time_t
 
	mtv_£c
;

11 
__su£c⁄ds_t
 
	mtv_u£c
;

	@/usr/include/bits/typesizes.h

19 #i‚de‡
_BITS_TYPES_H


23 #i‚def 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifde‡
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

68 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

69 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

70 
	#__TIMER_T_TYPE
 *

	)

71 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

72 
	#__FSID_T_TYPE
 såu˘ { 
__vÆ
[2]; }

	)

73 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

74 
	#__CPU_MASK_TYPE
 
__SYSCALL_ULONG_TYPE


	)

76 #ifde‡
__x86_64__


80 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

83 
	#__INO_T_MATCHES_INO64_T
 1

	)

86 
	#__RLIM_T_MATCHES_RLIM64_T
 1

	)

89 
	#__STATFS_MATCHES_STATFS64
 1

	)

91 
	#__RLIM_T_MATCHES_RLIM64_T
 0

	)

93 
	#__STATFS_MATCHES_STATFS64
 0

	)

97 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/uintn-identity.h

19 #i‡!
deföed
 
_NETINET_IN_H
 && !deföed 
_ENDIAN_H


23 #i‚de‡
_BITS_UINTN_IDENTITY_H


24 
	#_BITS_UINTN_IDENTITY_H
 1

	)

26 
	~<bôs/ty≥s.h
>

32 
__ölöe
 
__uöt16_t


33 
	$__uöt16_idítôy
 (
__uöt16_t
 
__x
)

35  
__x
;

36 
	}
}

38 
__ölöe
 
__uöt32_t


39 
	$__uöt32_idítôy
 (
__uöt32_t
 
__x
)

41  
__x
;

42 
	}
}

44 
__ölöe
 
__uöt64_t


45 
	$__uöt64_idítôy
 (
__uöt64_t
 
__x
)

47  
__x
;

48 
	}
}

	@/usr/include/asm-generic/sockios.h

2 #i‚de‡
__ASM_GENERIC_SOCKIOS_H


3 
	#__ASM_GENERIC_SOCKIOS_H


	)

6 
	#FIOSETOWN
 0x8901

	)

7 
	#SIOCSPGRP
 0x8902

	)

8 
	#FIOGETOWN
 0x8903

	)

9 
	#SIOCGPGRP
 0x8904

	)

10 
	#SIOCATMARK
 0x8905

	)

11 
	#SIOCGSTAMP_OLD
 0x8906

	)

12 
	#SIOCGSTAMPNS_OLD
 0x8907

	)

	@/usr/include/bits/endianness.h

1 #i‚de‡
_BITS_ENDIANNESS_H


2 
	#_BITS_ENDIANNESS_H
 1

	)

4 #i‚de‡
_BITS_ENDIAN_H


9 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/pthreadtypes-arch.h

18 #i‚de‡
_BITS_PTHREADTYPES_ARCH_H


19 
	#_BITS_PTHREADTYPES_ARCH_H
 1

	)

21 
	~<bôs/w‹dsize.h
>

23 #ifde‡
__x86_64__


24 #i‡
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

28 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

30 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

31 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

32 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

36 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

37 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

38 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

39 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

41 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

42 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

43 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

44 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

45 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

47 
	#__LOCK_ALIGNMENT


	)

48 
	#__ONCE_ALIGNMENT


	)

50 #i‚de‡
__x86_64__


52 
	#__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
	`__ªg∑rm__
 (1)))

	)

	@/usr/include/bits/struct_mutex.h

19 #i‚de‡
_THREAD_MUTEX_INTERNAL_H


20 
	#_THREAD_MUTEX_INTERNAL_H
 1

	)

22 
	s__±hªad_muãx_s


24 
	m__lock
;

25 
	m__cou¡
;

26 
	m__ow√r
;

27 #ifde‡
__x86_64__


28 
	m__nu£rs
;

32 
	m__köd
;

33 #ifde‡
__x86_64__


34 
	m__•ös
;

35 
	m__ñisi⁄
;

36 
__±hªad_li°_t
 
	m__li°
;

37 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

39 
	m__nu£rs
;

40 
__exãnsi⁄__
 union

44 
	m__e•ös
;

45 
	m__ìlisi⁄
;

46 
	#__•ös
 
__ñisi⁄_d©a
.
__e•ös


	)

47 
	#__ñisi⁄
 
__ñisi⁄_d©a
.
__ìlisi⁄


	)

48 } 
	m__ñisi⁄_d©a
;

49 
__±hªad_¶i°_t
 
	m__li°
;

51 
	#__PTHREAD_MUTEX_HAVE_PREV
 0

	)

55 #ifde‡
__x86_64__


56 
	#__PTHREAD_MUTEX_INITIALIZER
(
__köd
) \

57 0, 0, 0, 0, 
__köd
, 0, 0, { 0, 0 }

	)

59 
	#__PTHREAD_MUTEX_INITIALIZER
(
__köd
) \

60 0, 0, 0, 
__köd
, 0, { { 0, 0 } }

	)

	@/usr/include/bits/struct_rwlock.h

20 #i‚de‡
_RWLOCK_INTERNAL_H


21 
	#_RWLOCK_INTERNAL_H


	)

23 
	s__±hªad_rwlock_¨ch_t


25 
	m__ªadîs
;

26 
	m__wrôîs
;

27 
	m__wΩha£_fuãx
;

28 
	m__wrôîs_fuãx
;

29 
	m__∑d3
;

30 
	m__∑d4
;

31 #ifde‡
__x86_64__


32 
	m__cur_wrôî
;

33 
	m__sh¨ed
;

34 sig√d 
	m__rwñisi⁄
;

35 #ifde‡ 
__ILP32__


36 
	m__∑d1
[3];

37 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0 }

	)

39 
	m__∑d1
[7];

40 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0, 0, 0, 0, 0 }

	)

42 
	m__∑d2
;

45 
	m__Êags
;

49 
	m__Êags
;

50 
	m__sh¨ed
;

51 sig√d 
	m__rwñisi⁄
;

52 
	m__∑d2
;

53 
	m__cur_wrôî
;

57 #ifde‡
__x86_64__


58 
	#__PTHREAD_RWLOCK_INITIALIZER
(
__Êags
) \

59 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 
__Êags


	)

61 
	#__PTHREAD_RWLOCK_INITIALIZER
(
__Êags
) \

62 0, 0, 0, 0, 0, 0, 
__Êags
, 0, 0, 0, 0

	)

	@/usr/include/bits/types/__sigset_t.h

1 #i‚de‡
____sig£t_t_deföed


2 
	#____sig£t_t_deföed


	)

4 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

7 
	m__vÆ
[
_SIGSET_NWORDS
];

8 } 
	t__sig£t_t
;

	@
1
.
1
/usr/include
140
3278
cgx.c
cgx.h
cgx_fw_if.h
common.h
lmac_common.h
mbox.c
mbox.h
mcs.c
mcs.h
mcs_cnf10kb.c
mcs_fips.c
mcs_fips_mbox.h
mcs_fips_reg.h
mcs_reg.h
mcs_rvu_if.c
npc.h
npc_profile.h
ptp.c
ptp.h
rpm.c
rpm.h
rvu.c
rvu.h
rvu_cgx.c
rvu_cn10k.c
rvu_cpt.c
rvu_debugfs.c
rvu_devlink.c
rvu_devlink.h
rvu_fixes.c
rvu_fixes.h
rvu_nix.c
rvu_nix_spi.c
rvu_npa.c
rvu_npc.c
rvu_npc_fs.c
rvu_npc_fs.h
rvu_npc_hash.c
rvu_npc_hash.h
rvu_ree.c
rvu_reg.c
rvu_reg.h
rvu_sdp.c
rvu_sso.c
rvu_struct.h
rvu_switch.c
rvu_tim.c
rvu_trace.c
rvu_trace.h
rvu_validation.c
rvu_validation.h
/usr/include/linux/ethtool.h
/usr/include/linux/fs.h
/usr/include/linux/module.h
/usr/include/linux/netdevice.h
/usr/include/linux/pci.h
/usr/include/linux/stddef.h
/usr/include/linux/types.h
/usr/include/asm/types.h
/usr/include/limits.h
/usr/include/linux/const.h
/usr/include/linux/fscrypt.h
/usr/include/linux/if.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_link.h
/usr/include/linux/if_packet.h
/usr/include/linux/ioctl.h
/usr/include/linux/limits.h
/usr/include/linux/mount.h
/usr/include/linux/pci_regs.h
/usr/include/linux/posix_types.h
/usr/include/asm-generic/types.h
/usr/include/asm/ioctl.h
/usr/include/asm/posix_types.h
/usr/include/bits/libc-header-start.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix2_lim.h
/usr/include/bits/wordsize.h
/usr/include/bits/xopen_lim.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/libc-compat.h
/usr/include/linux/netlink.h
/usr/include/linux/socket.h
/usr/include/sys/socket.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm-generic/ioctl.h
/usr/include/asm/posix_types_32.h
/usr/include/asm/posix_types_64.h
/usr/include/asm/posix_types_x32.h
/usr/include/bits/local_lim.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/types/struct_iovec.h
/usr/include/bits/types/struct_osockaddr.h
/usr/include/bits/uio_lim.h
/usr/include/features.h
/usr/include/asm-generic/posix_types.h
/usr/include/asm/bitsperlong.h
/usr/include/asm/socket.h
/usr/include/bits/sockaddr.h
/usr/include/bits/socket-constants.h
/usr/include/bits/socket_type.h
/usr/include/bits/types/time_t.h
/usr/include/gnu/stubs.h
/usr/include/stdc-predef.h
/usr/include/sys/cdefs.h
/usr/include/sys/types.h
/usr/include/asm-generic/bitsperlong.h
/usr/include/asm-generic/socket.h
/usr/include/bits/long-double.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/stdint-intn.h
/usr/include/bits/types.h
/usr/include/bits/types/clock_t.h
/usr/include/bits/types/clockid_t.h
/usr/include/bits/types/timer_t.h
/usr/include/endian.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/gnu/stubs-x32.h
/usr/include/sys/select.h
/usr/include/asm/sockios.h
/usr/include/bits/byteswap.h
/usr/include/bits/endian.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/thread-shared-types.h
/usr/include/bits/time64.h
/usr/include/bits/timesize.h
/usr/include/bits/types/sigset_t.h
/usr/include/bits/types/struct_timespec.h
/usr/include/bits/types/struct_timeval.h
/usr/include/bits/typesizes.h
/usr/include/bits/uintn-identity.h
/usr/include/asm-generic/sockios.h
/usr/include/bits/endianness.h
/usr/include/bits/pthreadtypes-arch.h
/usr/include/bits/struct_mutex.h
/usr/include/bits/struct_rwlock.h
/usr/include/bits/types/__sigset_t.h
